<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Messages posted by "vinh_k5cna2"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/listByUser/163535.hva</link>
		<description><![CDATA[Messages posted by "vinh_k5cna2"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Khai thác và phòng chống file upload trong PHP Web Applications</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">seamoun wrote:</cite><br>
		<blockquote><font color='orange'><b>I. GIỚI THIỆU</b></font>
Ứng dụng Web hỗ trợ cho phép người sử dụng thực hiện upload file lên server hiện tại có rất nhiều. Ví dụ như upload image(*.gif, *.jpg), *.pdf, *.doc, ...
Trong bài này seamoun sẽ trình bày một số lỗi khi lập trình file upload mà kẻ xấu có thể lợi dụng để upload những mã độc lên server. Những phương thức khai thác mà seamoun trình bày chỉ mang tính tham khảo không ủng hộ các bạn khai thác đối với những server bị mắc lỗi.
 
<font color='orange'><b>II. KHAI THÁC LỖI UPLOAD FILE</b></font>
1) Trường hợp sử dụng JavaScript để kiểm tra file upload
Giả sử ta có kịch bản gồm 2 file như sau:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;html&gt;
&lt;title&gt;Secure file upload PHP Web Applications&lt;/title&gt;
&lt;head&gt;
&lt;script language=javascript&gt;
function chkFileExtension&#40;&#41;
{
	var str=document.upload.userfile.value;
	var ext=str.substring&#40;str.length,str.length-3&#41;;
	if &#40; ext != "gif"&#41;
	{
		alert&#40;"File is invalid"&#41;;
		return false;
	}
	else
	{
		return true;
	};
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form name="upload" action="upload1.php" method="POST" ENCTYPE="multipart/form-data"  onSubmit="return chkFileExtension&#40;&#41;"&gt;
Select the file to upload: &lt;input type="file" name="userfile"&gt;
&lt;input type="submit" name="upload" value="upload"&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
		</div>




<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?php

$uploaddir = 'uploads/';
$uploadfile = $uploaddir . basename&#40;$_FILES&#91;'userfile'&#93;&#91;'name'&#93;&#41;;

if &#40;move_uploaded_file&#40;$_FILES&#91;'userfile'&#93;&#91;'tmp_name'&#93;, $uploadfile&#41;&#41; {
    echo "File was successfully uploaded.\n";
} else {
    echo "File uploading failed.\n";
}
?&gt;</pre>
		</div>

Ví dụ trên cho thấy người lập trình kiểm tra phần mở rộng file cho phép file upload bằng cách sử dụng một đoạn mã Javascript trong file upload1.html. Chỉ chấp nhận những file có phần mở rộng là *.gif thì mới được phép upload, cách này một kẻ tấn công dễ dàng vượt qua bằng cách sử dụng một intercepting proxy hoặc có thể viết một đoạn mã bằng Perl, Python,... mà đệ trình trực tiếp đến file upload1.php với những tham số cần thiết.

Trong demo sau seamoun sử dụng Burp Suite là một tool rất mạnh khi thực hiện Web Application. Có thể download tại :<span class="link"> http://portswigger.net/</span>&nbsp;
		</blockquote>


---------------------------------------

 Các anh có thể cho em hỏi 1 chút đc ko ạ ?
Em mới tìm hiểu về các vấn đề ở trên các anh nói , em cũng muốn thực hiện xem khả năng tiếp thu của mình đến đâu , nhưng khi load toll Burp Suite về thì ko biết sử dụng ra sao ( vì thấy trong video demo toll này đã đc add luôn vào fifox rồi :( ) Vậy các anh có thể cho em biết , add Toll Burp Suite và Fifox như thế nào ,và hướng dẫn sử dụng PM cụ thể ra sao được ko ạ ? 
 Em cảm ơn các anh !]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/preList/25298/204321.hva#204321</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/preList/25298/204321.hva#204321</link>
				<pubDate><![CDATA[Sun, 31 Jan 2010 23:39:25]]> GMT</pubDate>
				<author><![CDATA[ vinh_k5cna2]]></author>
			</item>
	</channel>
</rss>
