<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Messages posted by "thanhinterpol"]]></title>
		<link>/hvaonline/posts/listByUser/216537.html</link>
		<description><![CDATA[Messages posted by "thanhinterpol"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Lập trình Hook trong Window</title>
				<description><![CDATA[ Tình hình là đã giải quyết được vấn đề này.
Tạo một project Dll bằng C#, bulit nó ra file .tlb sau đó tạo 1 file dll bằng C++, gọi lại các hàm trong file dll C#, &gt;&gt; built ra file .dll C++. Như vậy là có thể sử dụng được .dll C# trong việc Hook.
link: http://support.microsoft.com/kb/828736
p/s: cảm ơn mọi người đã giúp đỡ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/preList/45406/279530.html#279530</guid>
				<link>/hvaonline/posts/preList/45406/279530.html#279530</link>
				<pubDate><![CDATA[Wed, 22 Jan 2014 23:49:32]]> GMT</pubDate>
				<author><![CDATA[ thanhinterpol]]></author>
			</item>
			<item>
				<title>Lập trình Hook trong Window</title>
				<description><![CDATA[ @quygia128: thank bạn, vấn đề mình gặp là ko export đựoc function trong dll C#, nên ko lấy được ProAddress của nó
@Levis: mình đã thử cách bạn đưa, nhưng vẫn ko được]]></description>
				<guid isPermaLink="true">/hvaonline/posts/preList/45406/279510.html#279510</guid>
				<link>/hvaonline/posts/preList/45406/279510.html#279510</link>
				<pubDate><![CDATA[Mon, 20 Jan 2014 21:28:45]]> GMT</pubDate>
				<author><![CDATA[ thanhinterpol]]></author>
			</item>
			<item>
				<title>Lập trình Hook trong Window</title>
				<description><![CDATA[ Trong ví dụ trên là "System.Windows.Forms.dll", file này minh ko chỉnh sửa được. Còn trong bài của mình là dll tự tạo. Có thể export functions trong dll này ko?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/preList/45406/279481.html#279481</guid>
				<link>/hvaonline/posts/preList/45406/279481.html#279481</link>
				<pubDate><![CDATA[Fri, 17 Jan 2014 04:02:43]]> GMT</pubDate>
				<author><![CDATA[ thanhinterpol]]></author>
			</item>
			<item>
				<title>Lập trình Hook trong Window</title>
				<description><![CDATA[ Chào mọi người, mình là sinh viên năm cuối DHBK, đang thực tập tại cty LogiGear. Trong thời gian này tụi mình đang được training DEV, hiện tại đang làm một đề tài về Hook gặp một ít khó khăn mong được mọi người giúp đỡ.
Vào nội dung chính, Đề tài của mình là "Create a [Get .Net App Infor] program: This program is show all intormation of .Net application "
Với đề tài này có thể chia ra làm các giai đoạn:
- Lấy danh sách các ứng dụng .NET bằng win API: ở đây mình dùng hàm EnumWindows
- Cài file .dll vào ứng dụng đang chạy : cái này mình dùng remote thread (3)
- Bước tiếp theo là sử dụng SetWindowsHookEx để vài Hook procedure vào Hook chain. :
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&#91;DllImport&#40;"user32.dll", SetLastError = true&#41;&#93;
static extern IntPtr SetWindowsHookEx&#40;HookType hookType, HookProc lpfn, IntPtr hMod, uint dwThreadId&#41;;</pre>
		</div> 
  + tham số thứ nhất là loại Hook: mình dùng WH_CALLWNDPROC
  + tham số thứ 2 là địa chỉ của hàm trong file dll: dùng getProAddress() để lấy,(mình gặp rắc rối ở đây !)
  + tham số thứ 3 là handle của file dll được cài vào ứng dụng: dùng GetModuleHandle()
  + tham sô thứ 4: 0 (hook có phạm vi toàn hệ thống)

Cho mình hỏi là tại sao hàm getProAddress() ko thể lấy được "proceduce address" của "functions" trong file Dll được viết bằng C#, C++ thì lấy bình thường.
Mình đang đọc về cách export function trong dll nhưng vẫn chưa hiểu lắm (4)

Link tham khảo về hook:
(1)/hvaonline/posts/list/765.html
(2)http://msdn.microsoft.com/en-us/library/windows/desktop/ms644959(v=vs.85).aspx
(3)http://www.codeproject.com/Articles/37228/API-Hooking-LoadLibrary
(4)<span class="link"> http://msdn.microsoft.com/en-us/library/z4zxe9k8.aspx</span>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/preList/45406/279469.html#279469</guid>
				<link>/hvaonline/posts/preList/45406/279469.html#279469</link>
				<pubDate><![CDATA[Thu, 16 Jan 2014 01:22:02]]> GMT</pubDate>
				<author><![CDATA[ thanhinterpol]]></author>
			</item>
	</channel>
</rss>
