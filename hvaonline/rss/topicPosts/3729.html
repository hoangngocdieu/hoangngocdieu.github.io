<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Code for Fun: perl script GetIP"]]></title>
		<link>/hvaonline/posts/list/23.html</link>
		<description><![CDATA[Latest messages posted in the topic "Code for Fun: perl script GetIP"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Code for Fun: perl script GetIP</title>
				<description><![CDATA[ Đây là một đoạn code nho nhỏ sử dụng perl kết hợp với regex để lấy WAN IP của máy. Idea rất đơn giản: lấy file index.html từ whatismyip.com. Sau đó parse ra IP. Khoai dùng wget để lấy html code. Ai không thích có thể tuỳ ý thay thế bằng lynx/links để lấy luôn out-put, sau đó dump ra một file rồi tiến hành parse. Tuy nhiên khi dùng CLI browser thì regex sẽ phải thay đổi.
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/usr/bin/perl
# Get IP perl script
# Written By Mr.Khoai
# Sep 7, 2006
# Copyrights--You have the rights to copy
#########################################

# This script uses<span class="link"> http://whatismyip.com</span> to determine the real WAN IP.
#+It may not be absolutely corect if user goes throug a proxy server. 
#+This script requires:
#	1. PERL!!! This is perl script. No perl == No run
#	2. A working network. This includes proper configurations of
#+NICs and an internet connection.
#	3. wget. This is a handy tool to download any file on the 
#+line. wget also support ftp,sll, etc. For more information, please
#+refer to GNU wget @<span class="link"> http://www.gnu.org/software/wget</span>

my $tmp="/tmp/__GetIPtmp";							# temp
`wget<span class="link"> http://whatismyip.com</span> -q -O $tmp`;					# wget<span class="link"> http://www.whatismyip.com/index.html</span>
										# wwwected to $tmp
open&#40;$F, $tmp&#41;;
while &#40;my $line = &lt;$F&gt;&#41; {							# Get each line
	if &#40;$line =~ /&#40;^&lt;TITLE&gt;.+ &#41;&#40;\d{1,3}\.\d{1,3}\.\d{1,3}&#41;&#40;.+&lt;\/TITLE&gt;&#41;/&#41;
#		      |^^^^^^^^^^^||^^^^^^^^^^^^^^^^^^^^^^^^^||^^^^^^^^^^^^|
#		      |		  ||	 		     |+------------=====&gt; End with &lt;/TITLE&gt;
#		      |		  |+-------------------------===================&gt; Some thing look like IP
#		      +-----------==============================================&gt; Start with &lt;TITLE&gt;
	{	
		$line=$2;							# Only get the IP Part
		&printStuff&#40;$line&#41;;
		close &#40;$F&#41;;
		`rm $filename`;
		exit &#40;0&#41;;
	}
}
print "Opps, cant see your IP. Check all the requirements to see if you meet 'em all!\n";

sub printStuff&#40;&#41;{
	my $ip = shift;
	my $msg = "+-------------------------------------+\n";
	$msg   .= "|           GetIP perl script         |\n";
	$msg   .= "|          Written by Mr.Khoai        |\n";
	$msg   .= "+-------------------------------------+\n";
	$msg   .= "\nYour IP is: $ip\n";
	print $msg;
}</pre>
		</div>
Tuy đoạn code chả có gì to bự nhưng cũng giúp ta thấy được regular expression lợi hại thế nào. PerlRegEx dùng để parse text thì khỏi chê.
Bao nhiêu cảm xúc + bức xúc của tuần đầu tiên được đi học lập trình Khoai đã "nhét" vào đây cả.
Mr.Khoai]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3729.html#21759</guid>
				<link>/hvaonline/posts/list/3729.html#21759</link>
				<pubDate><![CDATA[Fri, 8 Sep 2006 10:08:47]]> GMT</pubDate>
				<author><![CDATA[ Mr.Khoai]]></author>
			</item>
	</channel>
</rss>
