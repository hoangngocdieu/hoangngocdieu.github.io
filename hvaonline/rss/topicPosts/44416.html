<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ."]]></title>
		<link>/hvaonline/posts/list/24.html</link>
		<description><![CDATA[Latest messages posted in the topic "Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ."]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Mọi người giúp mình, hiện tại mình đã config snort chạy ok, test bằng
<blockquote>snort -c /etc/snort/snort.conf -A console &nbsp;
		</blockquote>
có xuất alert ra màn hình, file log có luôn.
nhưng cái baryard2 không chịu update database.
trong file config của snort mình đã set 
<blockquote>output unified2: filename snort.log,limit 128&nbsp;
		</blockquote>
trong file config của baryard2 thì mình sửa lại như thế này
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>output database: log, mysql, user=snort password=snortpass dbname=snort host=localhost
input unified2
config waldo_file: /var/log/snort/barnyard2.waldo
enable daemon mode
config hostname:   localhost
config interface:  eth1
config logdir: /var/log/barnyard2</pre>
		</div>
user snort login mysql mình thường. grant all privileges rồi.
<blockquote>start snort : snort -c /etc/snort/snort.conf -A console
start baryard2: barnyard2 -c /etc/snort/barnyard2.conf -d /var/log/ -f snort.log -w /etc/snort/barnyard2.waldo -u snort -g snort -D&nbsp;
		</blockquote>

Mọi người giúp với, cảm ơn :)]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274111</guid>
				<link>/hvaonline/posts/list/44416.html#274111</link>
				<pubDate><![CDATA[Fri, 15 Mar 2013 20:42:53]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Trước tiên nên cho xem log của nó để biết nó bị lỗi ở chăng nào :)]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274151</guid>
				<link>/hvaonline/posts/list/44416.html#274151</link>
				<pubDate><![CDATA[Sun, 17 Mar 2013 21:57:41]]> GMT</pubDate>
				<author><![CDATA[ tranhuuphuoc]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Start Barryard2 có xuất hiện ra thông báo lỗi gì ko?

Thử kiểm tra lại một số thứ sau:

1. Khi build Baryard có tuỳ chọn --with-mysql chưa? đã tạo file barnyard2.waldo chưa? quyền cho các thư mục log ntn?


2. câu lệnh start Barnyard2 theo mình nhớ thì phải là &quot;-d /var/log/snort&quot; -&gt; trỏ đến chỗ snort chứa log chứ?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274164</guid>
				<link>/hvaonline/posts/list/44416.html#274164</link>
				<pubDate><![CDATA[Mon, 18 Mar 2013 09:22:00]]> GMT</pubDate>
				<author><![CDATA[ quangteospk]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Cảm ơn 2 bác đã giúp !
<p></p>
		<cite class="blockquote">tranhuuphuoc wrote:</cite><br>
		<blockquote>Trước tiên nên cho xem log của nó để biết nó bị lỗi ở chăng nào :)&nbsp;
		</blockquote>
<p></p>
		<cite class="blockquote">quangteospk wrote:</cite><br>
		<blockquote>Start Barryard2 có xuất hiện ra thông báo lỗi gì ko?

Thử kiểm tra lại một số thứ sau:

1. Khi build Baryard có tuỳ chọn --with-mysql chưa? đã tạo file barnyard2.waldo chưa? quyền cho các thư mục log ntn?


2. câu lệnh start Barnyard2 theo mình nhớ thì phải là -d /var/log/snort trỏ đến chỗ snort chứa log chứ?&nbsp;
		</blockquote>

Khi build có --with-mysql, đã tạo file barnyard.waldo, đã chmod -R 777 cho folder /var/log/snort
start đã sửa lại nhưng database vẫn không chịu update, table event vẫn trống trơn, không biết sao luôn. haizz
Hình chụp:
Đây là thông tin file snort.log.xxx<span class="link"> https://docs.google.com/file/d/0B7DI6ZtmiK_dVDZ2M2llekFVLUE/edit?usp=sharing&pli=1</span>

Cảm ơn, mong mọi người giúp mình tiếp.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274178</guid>
				<link>/hvaonline/posts/list/44416.html#274178</link>
				<pubDate><![CDATA[Mon, 18 Mar 2013 14:16:54]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Vấn đề là Snort đã bắt được cảnh báo nào chưa. Bồ kiểm tra trong thư mục /var/log/snort xem có file mới được tạo ra sau khi start Snort ko? Nếu ko, Snort của bạn chưa cảnh báo được -&gt; thì lấy đâu ra database để đọc lên.

Bồ có thử &quot;xâm nhập&quot; để Snort cảnh báo hay chưa? trong local.rules bồ có để rule nào để Snort cảnh báo hay chưa? 

Ngoài ra khi start Barnyard2 bồ bỏ option -D đi để xem các output khi start thế nào (nếu được bồ chụp lại output của Barnyard2 dùm) còn Snort bồ dùng option -i &lt;ethX&gt; để chỉ định card mạng mà bồ định bắt gói tin.
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274188</guid>
				<link>/hvaonline/posts/list/44416.html#274188</link>
				<pubDate><![CDATA[Mon, 18 Mar 2013 23:30:12]]> GMT</pubDate>
				<author><![CDATA[ quangteospk]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quangteospk wrote:</cite><br>
		<blockquote>Vấn đề là Snort đã bắt được cảnh báo nào chưa. Bồ kiểm tra trong thư mục /var/log/snort xem có file mới được tạo ra sau khi start Snort ko? Nếu ko, Snort của bạn chưa cảnh báo được -&gt; thì lấy đâu ra database để đọc lên.

Bồ có thử xâm nhập; để Snort cảnh báo hay chưa? trong local.rules bồ có để rule nào để Snort cảnh báo hay chưa? 

Ngoài ra khi start Barnyard2 bồ bỏ option -D đi để xem các output khi start thế nào (nếu được bồ chụp lại output của Barnyard2 dùm) còn Snort bồ dùng option -i &lt;ethX&gt; để chỉ định card mạng mà bồ định bắt gói tin.
&nbsp;
		</blockquote>

Nó đã có ghi vào file log là có máy ping.
Start snort :  snort -c /etc/snort/snort.conf -u snort -g snort  -A console
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>--== Initialization Complete ==--

   ,,_     -*&gt; Snort! &lt;*-
  o&quot;  &#41;~   Version 2.9.4.1 GRE &#40;Build 69&#41;
   ''''    By Martin Roesch & The Snort Team:<span class="link"> http://www.snort.org/snort/snort-team</span>
           Copyright &#40;C&#41; 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.3.0
           Using PCRE version: 8.21 2011-12-12
           Using ZLIB version: 1.2.7

           Rules Engine: SF_SNORT_DETECTION_ENGINE  Version 1.17  &lt;Build 18&gt;
           Preprocessor Object: SF_SSLPP  Version 1.1  &lt;Build 4&gt;
           Preprocessor Object: SF_SIP  Version 1.1  &lt;Build 1&gt;
           Preprocessor Object: SF_SMTP  Version 1.1  &lt;Build 9&gt;
           Preprocessor Object: SF_DCERPC2  Version 1.0  &lt;Build 3&gt;
           Preprocessor Object: SF_MODBUS  Version 1.1  &lt;Build 1&gt;
           Preprocessor Object: SF_REPUTATION  Version 1.1  &lt;Build 1&gt;
           Preprocessor Object: SF_IMAP  Version 1.0  &lt;Build 1&gt;
           Preprocessor Object: SF_DNP3  Version 1.1  &lt;Build 1&gt;
           Preprocessor Object: SF_POP  Version 1.0  &lt;Build 1&gt;
           Preprocessor Object: SF_GTP  Version 1.1  &lt;Build 1&gt;
           Preprocessor Object: SF_DNS  Version 1.1  &lt;Build 4&gt;
           Preprocessor Object: SF_SDF  Version 1.1  &lt;Build 1&gt;
           Preprocessor Object: SF_FTPTELNET  Version 1.2  &lt;Build 13&gt;
           Preprocessor Object: SF_SSH  Version 1.1  &lt;Build 3&gt;
Commencing packet processing &#40;pid=2239&#41;
03/20-07:47:48.048956  &#91;**&#93; &#91;1:10000001:1&#93; ICMP TEST &#91;**&#93; &#91;Priority: 0&#93; {ICMP} 192.168.10.10 -&gt; 192.168.10.1
03/20-07:47:48.049091  &#91;**&#93; &#91;1:10000001:1&#93; ICMP TEST &#91;**&#93; &#91;Priority: 0&#93; {ICMP} 192.168.10.1 -&gt; 192.168.10.10
03/20-07:47:49.052416  &#91;**&#93; &#91;1:10000001:1&#93; ICMP TEST &#91;**&#93; &#91;Priority: 0&#93; {ICMP} 192.168.10.10 -&gt; 192.168.10.1
03/20-07:47:49.052471  &#91;**&#93; &#91;1:10000001:1&#93; ICMP TEST &#91;**&#93; &#91;Priority: 0&#93; {ICMP} 192.168.10.1 -&gt; 192.168.10.10
03/20-07:47:50.053470  &#91;**&#93; &#91;1:10000001:1&#93; ICMP TEST &#91;**&#93; &#91;Priority: 0&#93; {ICMP} 192.168.10.10 -&gt; 192.168.10.1
03/20-07:47:50.053521  &#91;**&#93; &#91;1:10000001:1&#93; ICMP TEST &#91;**&#93; &#91;Priority: 0&#93; {ICMP} 192.168.10.1 -&gt; 192.168.10.10</pre>
		</div>
Sau khi start barnyard thì nó thông báo thế này 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&#91;root@localhost ~&#93;# barnyard2 -c /etc/snort/barnyard2.conf -d /var/log/snort -f snort.log -w /var/log/snort/barnyard2.waldo -u snort -g snort
Running in Continuous mode

        --== Initializing Barnyard2 ==--
Initializing Input Plugins!
Initializing Output Plugins!
Parsing config file &quot;/etc/snort/barnyard2.conf&quot;
Barnyard2 spooler: Event cache size set to &#91;2048&#93;
Log directory = /var/log/barnyard2
INFO database: Defaulting Reconnect/Transaction Error limit to 10
INFO database: Defaulting Reconnect sleep time to 5 second
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM data WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM event WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM icmphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM iphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM opt WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM tcphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM udphdr WHERE sid='1';&#93;
&#91;SignatureReferencePullDataStore&#40;&#41;&#93;: No Reference found in database ...
database: compiled support for &#40;mysql&#41;
database: configured to use mysql
database: schema version = 107
database:           host = localhost
database:           user = snort
database:  database name = snort
database:    sensor name = localhost:eth1
database:      sensor id = 1
database:     sensor cid = 1
database:  data encoding = hex
database:   detail level = full
database:     ignore_bpf = no
database: using the &quot;log&quot; facility

        --== Initialization Complete ==--

  ______   -*&gt; Barnyard2 &lt;*-
 / ,,_  \  Version 2.1.12 &#40;Build 321&#41;
 |o&quot;  &#41;~|  By Ian Firns &#40;SecurixLive&#41;:<span class="link"> http://www.securixlive.com/</span>
 + '''' +  &#40;C&#41; Copyright 2008-2013 Ian Firns &lt;firnsy@securixlive.com&gt;

Using waldo file '/var/log/snort/barnyard2.waldo':
    spool directory = /var/log/snort/
    spool filebase  = snort.log
    time_stamp      = 1363739796
    record_idx      = 0
Opened spool file '/var/log/snort//snort.log.1363739904'
Closing spool file '/var/log/snort//snort.log.1363739904'. Read 0 records
Opened spool file '/var/log/snort//snort.log.1363740050'
Waiting for new data
^Cdatabase: Closing connection to database &quot;snort&quot;
===============================================================================
Record Totals:
   Records:            0
    Events:            0 &#40;0.000%&#41;
   Packets:            0 &#40;0.000%&#41;
   Unknown:            0 &#40;0.000%&#41;
===============================================================================
Packet breakdown by protocol &#40;includes rebuilt packets&#41;:
      ETH: 0          &#40;0.000%&#41;
  ETHdisc: 0          &#40;0.000%&#41;
     VLAN: 0          &#40;0.000%&#41;
     IPV6: 0          &#40;0.000%&#41;
  IP6 EXT: 0          &#40;0.000%&#41;
  IP6opts: 0          &#40;0.000%&#41;
  IP6disc: 0          &#40;0.000%&#41;
      IP4: 0          &#40;0.000%&#41;
  IP4disc: 0          &#40;0.000%&#41;
    TCP 6: 0          &#40;0.000%&#41;
    UDP 6: 0          &#40;0.000%&#41;
    ICMP6: 0          &#40;0.000%&#41;
  ICMP-IP: 0          &#40;0.000%&#41;
      TCP: 0          &#40;0.000%&#41;
      UDP: 0          &#40;0.000%&#41;
     ICMP: 0          &#40;0.000%&#41;
  TCPdisc: 0          &#40;0.000%&#41;
  UDPdisc: 0          &#40;0.000%&#41;
  ICMPdis: 0          &#40;0.000%&#41;
     FRAG: 0          &#40;0.000%&#41;
   FRAG 6: 0          &#40;0.000%&#41;
      ARP: 0          &#40;0.000%&#41;
    EAPOL: 0          &#40;0.000%&#41;
  ETHLOOP: 0          &#40;0.000%&#41;
      IPX: 0          &#40;0.000%&#41;
    OTHER: 0          &#40;0.000%&#41;
  DISCARD: 0          &#40;0.000%&#41;
InvChkSum: 0          &#40;0.000%&#41;
   S5 G 1: 0          &#40;0.000%&#41;
   S5 G 2: 0          &#40;0.000%&#41;
    Total: 0
===============================================================================</pre>
		</div>
Còn đây là file snort.log.xxx
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&#91;root@localhost ~&#93;# snort -r /var/log/snort/snort.log.1363739904
Running in packet dump mode

        --== Initializing Snort ==--
Initializing Output Plugins!
pcap DAQ configured to read-file.
Acquiring network traffic from &quot;/var/log/snort/snort.log.1363739904&quot;.

        --== Initialization Complete ==--

   ,,_     -*&gt; Snort! &lt;*-
  o&quot;  &#41;~   Version 2.9.4.1 GRE &#40;Build 69&#41;
   ''''    By Martin Roesch & The Snort Team:<span class="link"> http://www.snort.org/snort/snort-team</span>
           Copyright &#40;C&#41; 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.3.0
           Using PCRE version: 8.21 2011-12-12
           Using ZLIB version: 1.2.7

Commencing packet processing &#40;pid=2226&#41;
03/20-07:39:40.225804 192.168.10.10:1324 -&gt; 192.168.10.1:22
TCP TTL:128 TOS:0x0 ID:5117 IpLen:20 DgmLen:92 DF
***AP*** Seq: 0x73665F38  Ack: 0xB1C69076  Win: 0xFD  TcpLen: 20
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/20-07:39:41.460150 192.168.10.10:1324 -&gt; 192.168.10.1:22
TCP TTL:128 TOS:0x0 ID:5124 IpLen:20 DgmLen:92 DF
***AP*** Seq: 0x73666008  Ack: 0xB1C69146  Win: 0xFC  TcpLen: 20
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/20-07:39:42.419903 192.168.10.10:1324 -&gt; 192.168.10.1:22
TCP TTL:128 TOS:0x0 ID:5131 IpLen:20 DgmLen:92 DF
***AP*** Seq: 0x736660D8  Ack: 0xB1C69216  Win: 0xFB  TcpLen: 20
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

===============================================================================
Run time for packet processing was 0.1784 seconds
Snort processed 3 packets.
Snort ran for 0 days 0 hours 0 minutes 0 seconds
   Pkts/sec:            3
===============================================================================
Packet I/O Totals:
   Received:            3
   Analyzed:            3 &#40;100.000%&#41;
    Dropped:            0 &#40;  0.000%&#41;
   Filtered:            0 &#40;  0.000%&#41;
Outstanding:            0 &#40;  0.000%&#41;
   Injected:            0
===============================================================================
Breakdown by protocol &#40;includes rebuilt packets&#41;:
        Eth:            3 &#40;100.000%&#41;
       VLAN:            0 &#40;  0.000%&#41;
        IP4:            3 &#40;100.000%&#41;
       Frag:            0 &#40;  0.000%&#41;
       ICMP:            0 &#40;  0.000%&#41;
        UDP:            0 &#40;  0.000%&#41;
        TCP:            3 &#40;100.000%&#41;
        IP6:            0 &#40;  0.000%&#41;
    IP6 Ext:            0 &#40;  0.000%&#41;
   IP6 Opts:            0 &#40;  0.000%&#41;
      Frag6:            0 &#40;  0.000%&#41;
      ICMP6:            0 &#40;  0.000%&#41;
       UDP6:            0 &#40;  0.000%&#41;
       TCP6:            0 &#40;  0.000%&#41;
     Teredo:            0 &#40;  0.000%&#41;
    ICMP-IP:            0 &#40;  0.000%&#41;
    IP4/IP4:            0 &#40;  0.000%&#41;
    IP4/IP6:            0 &#40;  0.000%&#41;
    IP6/IP4:            0 &#40;  0.000%&#41;
    IP6/IP6:            0 &#40;  0.000%&#41;
        GRE:            0 &#40;  0.000%&#41;
    GRE Eth:            0 &#40;  0.000%&#41;
   GRE VLAN:            0 &#40;  0.000%&#41;
    GRE IP4:            0 &#40;  0.000%&#41;
    GRE IP6:            0 &#40;  0.000%&#41;
GRE IP6 Ext:            0 &#40;  0.000%&#41;
   GRE PPTP:            0 &#40;  0.000%&#41;
    GRE ARP:            0 &#40;  0.000%&#41;
    GRE IPX:            0 &#40;  0.000%&#41;
   GRE Loop:            0 &#40;  0.000%&#41;
       MPLS:            0 &#40;  0.000%&#41;
        ARP:            0 &#40;  0.000%&#41;
        IPX:            0 &#40;  0.000%&#41;
   Eth Loop:            0 &#40;  0.000%&#41;
   Eth Disc:            0 &#40;  0.000%&#41;
   IP4 Disc:            0 &#40;  0.000%&#41;
   IP6 Disc:            0 &#40;  0.000%&#41;
   TCP Disc:            0 &#40;  0.000%&#41;
   UDP Disc:            0 &#40;  0.000%&#41;
  ICMP Disc:            0 &#40;  0.000%&#41;
All Discard:            0 &#40;  0.000%&#41;
      Other:            0 &#40;  0.000%&#41;
Bad Chk Sum:            0 &#40;  0.000%&#41;
    Bad TTL:            0 &#40;  0.000%&#41;
     S5 G 1:            0 &#40;  0.000%&#41;
     S5 G 2:            0 &#40;  0.000%&#41;
      Total:            3
===============================================================================
Snort exiting</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274206</guid>
				<link>/hvaonline/posts/list/44416.html#274206</link>
				<pubDate><![CDATA[Tue, 19 Mar 2013 11:47:33]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Không hiểu sao trong file snort.log.xxx có ghi mà sao barnyard read 0 records. haizz]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274209</guid>
				<link>/hvaonline/posts/list/44416.html#274209</link>
				<pubDate><![CDATA[Tue, 19 Mar 2013 12:40:41]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ <blockquote>
        --== Initialization Complete ==--

  ______   -*&gt; Barnyard2 &lt;*-
 / ,,_  \  Version 2.1.12 (Build 321)
 |o&quot;  )~|  By Ian Firns (SecurixLive):<span class="link"> http://www.securixlive.com/</span>
 + '''' +  (C) Copyright 2008-2013 Ian Firns &lt;firnsy@securixlive.com&gt;

Using waldo file '/var/log/snort/barnyard2.waldo':
    spool directory = /var/log/snort/
    spool filebase  = snort.log
    time_stamp      = 1363739796
    record_idx      = 0
<font color='red'>Opened spool file '/var/log/snort//snort.log.1363739904'
Closing spool file '/var/log/snort//snort.log.1363739904'. Read 0 records
Opened spool file '/var/log/snort//snort.log.1363740050'
Waiting for new data
^Cdatabase: Closing connection to database "snort"</font>
&nbsp;
		</blockquote>

Theo thông tin của bồ đưa ra thì Snort đã xử lý và cảnh báo các xâm nhập (gói ping) và theo output từ Barnyard2 thì Barnyard2 cũng đã đọc (<font color='red'>đoạn màu đỏ</font>) các log của Snort lên. 

Nhưng cho mình hỏi là bồ "ping" trước hay sau khi bật Snort và bật Barnyard2 lên. Theo như post của bồ thì bồ chạy Snort xong, ping xong, bồ mới chạy Barnyard2 phải ko?

P/S: Dạo này HVA khó truy cập quá, chỉnh sửa rối lung tung :'(]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274210</guid>
				<link>/hvaonline/posts/list/44416.html#274210</link>
				<pubDate><![CDATA[Tue, 19 Mar 2013 12:47:37]]> GMT</pubDate>
				<author><![CDATA[ quangteospk]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quangteospk wrote:</cite><br>
		<blockquote>

Theo thông tin của bồ đưa ra thì Snort đã xử lý và cảnh báo các xâm nhập (gói ping) và theo output từ Barnyard2 thì Barnyard2 cũng đã đọc (<font color='red'>đoạn màu đỏ</font>) các log của Snort lên. 

Nhưng cho mình hỏi là bồ "ping" trước hay sau khi bật Snort và bật Barnyard2 lên. Theo như post của bồ thì bồ chạy Snort xong, ping xong, bồ mới chạy Barnyard2 phải ko?

P/S: Dạo này HVA khó truy cập quá, chỉnh sửa rối lung tung :'(&nbsp;
		</blockquote>
start snort, start barnyard2 rồi mình ping -t, liên tục.
khi mình xem file snort.log.xxx thì có ghi cảnh báo của snort, nhưng theo output của barnyard2 thì lại là read 0 records, và không có update database. Không biết thế nào luôn. 
Mình thử start barnyard lại 1 lần nữa thì cũng vậy, read 0 records  #:S 
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274212</guid>
				<link>/hvaonline/posts/list/44416.html#274212</link>
				<pubDate><![CDATA[Tue, 19 Mar 2013 13:58:53]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Bạn cài đặt snort theo hướng dẫn nào? 
Bạn đã tạo database cho snort trên mysql chưa?

Bạn tử test lại bằng cách scan với nmap thử xem kết quả có sự khác biệt hay không :P]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274239</guid>
				<link>/hvaonline/posts/list/44416.html#274239</link>
				<pubDate><![CDATA[Wed, 20 Mar 2013 07:02:49]]> GMT</pubDate>
				<author><![CDATA[ Ky0]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Ky0 wrote:</cite><br>
		<blockquote>Bạn cài đặt snort theo hướng dẫn nào? 
Bạn đã tạo database cho snort trên mysql chưa?

Bạn tử test lại bằng cách scan với nmap thử xem kết quả có sự khác biệt hay không :P&nbsp;
		</blockquote>
Mình cài theo hướng dẫn này<span class="link"> http://quantrimang.edu.vn/he-thong/he-thong-mang-lan/trien-khai-snort-tren-centos.htm</span>
do bản mới 2.9.4.1 không output trực tiếp lên database mà phải thông qua barnyard2 2 nên trong file config của snort mình edit lại là output unified2 
và barnyard2 là input unified2
đã thử = nmap luôn, file log của snort có ghi, nhưng barnyard vẫn báo read 0 records
để up 2 file conf của snort với barnyard2 cho mọi người dễ giúp mình.
Snort: /etc/snort/snort.conf
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#--------------------------------------------------
#   VRT Rule Packages Snort.conf
#
#   For more information visit us at:
#    <span class="link"> http://www.snort.org</span>                   Snort Website
#    <span class="link"> http://vrt-blog.snort.org/</span>    Sourcefire VRT Blog
#
#     Mailing list Contact:      snort-sigs@lists.sourceforge.net
#     False Positive reports:    fp@sourcefire.com
#     Snort bugs:                bugs@snort.org
#
#     Compatible with Snort Versions:
#     VERSIONS : 2.9.3.1
#
#     Snort build options:
#     OPTIONS : --enable-ipv6 --enable-gre --enable-mpls --enable-targetbased --enable-decoder-preprocessor-rules --enable-ppm --enable-perfprofiling --enable-zlib --enable-active-response --enable-normalizer --enable-reload --enable-react --enable-flexresp3
#
#     Additional information:
#     This configuration file enables active response, to run snort in
#     test mode -T you are required to supply an interface -i &lt;interface&gt;
#     or test mode will fail to fully validate the configuration and
#     exit with a FATAL error
#--------------------------------------------------

###################################################
# This file contains a sample snort configuration. 
# You should take the following steps to create your own custom configuration:
#
#  1&#41; Set the network variables.
#  2&#41; Configure the decoder
#  3&#41; Configure the base detection engine
#  4&#41; Configure dynamic loaded libraries
#  5&#41; Configure preprocessors
#  6&#41; Configure output plugins
#  7&#41; Customize your rule set
#  8&#41; Customize preprocessor and decoder rule set
#  9&#41; Customize shared object rule set
###################################################

###################################################
# Step #1: Set the network variables.  For more information, see README.variables
###################################################

# Setup the network addresses you are protecting
ipvar HOME_NET 192.168.10.0/24

# Set up the external network addresses. Leave as &quot;any&quot; in most situations
ipvar EXTERNAL_NET !$HOME_NET

# List of DNS servers on your network 
ipvar DNS_SERVERS $HOME_NET

# List of SMTP servers on your network
ipvar SMTP_SERVERS $HOME_NET

# List of web servers on your network
ipvar HTTP_SERVERS $HOME_NET

# List of sql servers on your network 
ipvar SQL_SERVERS $HOME_NET

# List of telnet servers on your network
ipvar TELNET_SERVERS $HOME_NET

# List of ssh servers on your network
ipvar SSH_SERVERS $HOME_NET

# List of ftp servers on your network
ipvar FTP_SERVERS $HOME_NET

# List of sip servers on your network
ipvar SIP_SERVERS $HOME_NET

# List of ports you run web servers on
portvar HTTP_PORTS &#91;80,81,311,383,591,593,901,1220,1414,1741,1830,2301,2381,2809,3037,3128,3702,4343,4848,5250,6988,7000,7001,7144,7145,7510,7777,7779,8000,8008,8014,8028,8080,8085,8088,8090,8118,8123,8180,8181,8243,8280,8300,8800,8888,8899,9000,9060,9080,9090,9091,9443,9999,11371,34443,34444,41080,50002,55555&#93;

# List of ports you want to look for SHELLCODE on.
portvar SHELLCODE_PORTS !80

# List of ports you might see oracle attacks on
portvar ORACLE_PORTS 1024:

# List of ports you want to look for SSH connections on:
portvar SSH_PORTS 22

# List of ports you run ftp servers on
portvar FTP_PORTS &#91;21,2100,3535&#93;

# List of ports you run SIP servers on
portvar SIP_PORTS &#91;5060,5061,5600&#93;

# List of file data ports for file inspection
portvar FILE_DATA_PORTS &#91;$HTTP_PORTS,110,143&#93;

# List of GTP ports for GTP preprocessor
portvar GTP_PORTS &#91;2123,2152,3386&#93;

# other variables, these should not be modified
ipvar AIM_SERVERS &#91;64.12.24.0/23,64.12.28.0/23,64.12.161.0/24,64.12.163.0/24,64.12.200.0/24,205.188.3.0/24,205.188.5.0/24,205.188.7.0/24,205.188.9.0/24,205.188.153.0/24,205.188.179.0/24,205.188.248.0/24&#93;

# Path to your rules files &#40;this can be a relative path&#41;
# Note for Windows users:  You are advised to make this an absolute path,
# such as:  c:\snort\rules
var RULE_PATH /etc/snort/rules
var SO_RULE_PATH /etc/snort/so_rules
var PREPROC_RULE_PATH /etc/snort/preproc_rules

# If you are using reputation preprocessor set these
# Currently there is a bug with relative paths, they are relative to where snort is
# not relative to snort.conf like the above variables
# This is completely inconsistent with how other vars work, BUG 89986
# Set the absolute path appropriately
#var WHITE_LIST_PATH rules
#var BLACK_LIST_PATH rules

###################################################
# Step #2: Configure the decoder.  For more information, see README.decode
###################################################

# Stop generic decode events:
config disable_decode_alerts

# Stop Alerts on experimental TCP options
config disable_tcpopt_experimental_alerts

# Stop Alerts on obsolete TCP options
config disable_tcpopt_obsolete_alerts

# Stop Alerts on T/TCP alerts
config disable_tcpopt_ttcp_alerts

# Stop Alerts on all other TCPOption type events:
config disable_tcpopt_alerts

# Stop Alerts on invalid ip options
config disable_ipopt_alerts

# Alert if value in length field &#40;IP, TCP, UDP&#41; is greater th elength of the packet
# config enable_decode_oversized_alerts

# Same as above, but drop packet if in Inline mode &#40;requires enable_decode_oversized_alerts&#41;
# config enable_decode_oversized_drops

# Configure IP / TCP checksum mode
config checksum_mode: all

# Configure maximum number of flowbit references.  For more information, see README.flowbits
# config flowbits_size: 64

# Configure ports to ignore 
# config ignore_ports: tcp 21 6667:6671 1356
# config ignore_ports: udp 1:17 53

# Configure active response for non inline operation. For more information, see REAMDE.active
# config response: eth0 attempts 2

# Configure DAQ related options for inline operation. For more information, see README.daq
#
# config daq: &lt;type&gt;
# config daq_dir: &lt;dir&gt;
# config daq_mode: &lt;mode&gt;
# config daq_var: &lt;var&gt;
#
# &lt;type&gt; ::= pcap | afpacket | dump | nfq | ipq | ipfw
# &lt;mode&gt; ::= read-file | passive | inline
# &lt;var&gt; ::= arbitrary &lt;name&gt;=&lt;value passed to DAQ
# &gt;&lt;dir&gt; ::= path as to where to look for DAQ module so's

# Configure specific UID and GID to run snort as after dropping privs. For more information see snort -h command line options
#
# config set_gid:
# config set_uid:

# Configure default snaplen. Snort defaults to MTU of in use interface. For more information see README
#
# config snaplen:
#

# Configure default bpf_file to use for filtering what traffic reaches snort. For more information see snort -h command line options &#40;-F&#41;
#
# config bpf_file:
#

# Configure default log directory for snort to log to.  For more information see snort -h command line options &#40;-l&#41;
#
# config logdir:


###################################################
# Step #3: Configure the base detection engine.  For more information, see  README.decode
###################################################

# Configure PCRE match limitations
config pcre_match_limit: 3500
config pcre_match_limit_recursion: 1500

# Configure the detection engine  See the Snort Manual, Configuring Snort - Includes - Config
config detection: search-method ac-split search-optimize max-pattern-len 20

# Configure the event queue.  For more information, see README.event_queue
config event_queue: max_queue 8 log 5 order_events content_length

###################################################
## Configure GTP if it is to be used.
## For more information, see README.GTP
####################################################

# config enable_gtp

###################################################
# Per packet and rule latency enforcement
# For more information see README.ppm
###################################################

# Per Packet latency configuration
#config ppm: max-pkt-time 250, \
#   fastpath-expensive-packets, \
#   pkt-log

# Per Rule latency configuration
#config ppm: max-rule-time 200, \
#   threshold 3, \
#   suspend-expensive-rules, \
#   suspend-timeout 20, \
#   rule-log alert

###################################################
# Configure Perf Profiling for debugging
# For more information see README.PerfProfiling
###################################################

#config profile_rules: print all, sort avg_ticks
#config profile_preprocs: print all, sort avg_ticks

###################################################
# Configure protocol aware flushing
# For more information see README.stream5
###################################################
config paf_max: 16000

###################################################
# Step #4: Configure dynamic loaded libraries.  
# For more information, see Snort Manual, Configuring Snort - Dynamic Modules
###################################################

# path to dynamic preprocessor libraries
dynamicpreprocessor directory /usr/local/lib/snort_dynamicpreprocessor/

# path to base preprocessor engine
dynamicengine /usr/local/lib/snort_dynamicengine/libsf_engine.so

# path to dynamic rules libraries
dynamicdetection directory /usr/local/lib/snort_dynamicrules

###################################################
# Step #5: Configure preprocessors
# For more information, see the Snort Manual, Configuring Snort - Preprocessors
###################################################

# GTP Control Channle Preprocessor. For more information, see README.GTP
# preprocessor gtp: ports { 2123 3386 2152 }

# Inline packet normalization. For more information, see README.normalize
# Does nothing in IDS mode
preprocessor normalize_ip4
preprocessor normalize_tcp: ips ecn stream
preprocessor normalize_icmp4
preprocessor normalize_ip6
preprocessor normalize_icmp6

# Target-based IP defragmentation.  For more inforation, see README.frag3
preprocessor frag3_global: max_frags 65536
preprocessor frag3_engine: policy windows detect_anomalies overlap_limit 10 min_fragment_length 100 timeout 180

# Target-Based stateful inspection/stream reassembly.  For more inforation, see README.stream5
preprocessor stream5_global: track_tcp yes, \
   track_udp yes, \
   track_icmp no, \ 
   max_tcp 262144, \
   max_udp 131072, \
   max_active_responses 2, \
   min_response_seconds 5
preprocessor stream5_tcp: policy windows, detect_anomalies, require_3whs 180, \
   overlap_limit 10, small_segments 3 bytes 150, timeout 180, \
    ports client 21 22 23 25 42 53 79 109 110 111 113 119 135 136 137 139 143 \
        161 445 513 514 587 593 691 1433 1521 1741 2100 3306 6070 6665 6666 6667 6668 6669 \
        7000 8181 32770 32771 32772 32773 32774 32775 32776 32777 32778 32779, \
    ports both 80 81 311 383 443 465 563 591 593 636 901 989 992 993 994 995 1220 1414 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7907 7000 7001 7144 7145 7510 7802 7777 7779 \
        7801 7900 7901 7902 7903 7904 7905 7906 7908 7909 7910 7911 7912 7913 7914 7915 7916 \
        7917 7918 7919 7920 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090 9091 9443 9999 11371 34443 34444 41080 50002 55555
preprocessor stream5_udp: timeout 180

# performance statistics.  For more information, see the Snort Manual, Configuring Snort - Preprocessors - Performance Monitor
# preprocessor perfmonitor: time 300 file /var/snort/snort.stats pktcnt 10000

# HTTP normalization and anomaly detection.  For more information, see README.http_inspect
preprocessor http_inspect: global iis_unicode_map unicode.map 1252 compress_depth 65535 decompress_depth 65535
preprocessor http_inspect_server: server default \
    http_methods { GET POST PUT SEARCH MKCOL COPY MOVE LOCK UNLOCK NOTIFY POLL BCOPY BDELETE BMOVE LINK UNLINK OPTIONS HEAD DELETE TRACE TRACK CONNECT SOURCE SUBSCRIBE UNSUBSCRIBE PROPFIND PROPPATCH BPROPFIND BPROPPATCH RPC_CONNECT PROXY_SUCCESS BITS_POST CCM_POST SMS_POST RPC_IN_DATA RPC_OUT_DATA RPC_ECHO_DATA } \
    chunk_length 500000 \
    server_flow_depth 0 \
    client_flow_depth 0 \
    post_depth 65495 \
    oversize_dir_length 500 \
    max_header_length 750 \
    max_headers 100 \
    max_spaces 200 \
    small_chunk_length { 10 5 } \
    ports { 80 81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000 7001 7144 7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180 8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090 9091 9443 9999 11371 34443 34444 41080 50002 55555 } \
    non_rfc_char { 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 } \
    enable_cookie \
    extended_response_inspection \
    inspect_gzip \
    normalize_utf \
    unlimited_decompress \
    normalize_javascript \
    apache_whitespace no \
    ascii no \
    bare_byte no \
    directory no \
    double_decode no \
    iis_backslash no \
    iis_delimiter no \
    iis_unicode no \
    multi_slash no \
    utf_8 no \
    u_encode yes \
    webroot no

# ONC-RPC normalization and anomaly detection.  For more information, see the Snort Manual, Configuring Snort - Preprocessors - RPC Decode
preprocessor rpc_decode: 111 32770 32771 32772 32773 32774 32775 32776 32777 32778 32779 no_alert_multiple_requests no_alert_large_fragments no_alert_incomplete

# Back Orifice detection.
preprocessor bo

# FTP / Telnet normalization and anomaly detection.  For more information, see README.ftptelnet
preprocessor ftp_telnet: global inspection_type stateful encrypted_traffic no check_encrypted
preprocessor ftp_telnet_protocol: telnet \
    ayt_attack_thresh 20 \
    normalize ports { 23 } \
    detect_anomalies
preprocessor ftp_telnet_protocol: ftp server default \
    def_max_param_len 100 \
    ports { 21 2100 3535 } \
    telnet_cmds yes \
    ignore_telnet_erase_cmds yes \
    ftp_cmds { ABOR ACCT ADAT ALLO APPE AUTH CCC CDUP } \
    ftp_cmds { CEL CLNT CMD CONF CWD DELE ENC EPRT } \
    ftp_cmds { EPSV ESTA ESTP FEAT HELP LANG LIST LPRT } \
    ftp_cmds { LPSV MACB MAIL MDTM MIC MKD MLSD MLST } \
    ftp_cmds { MODE NLST NOOP OPTS PASS PASV PBSZ PORT } \
    ftp_cmds { PROT PWD QUIT REIN REST RETR RMD RNFR } \
    ftp_cmds { RNTO SDUP SITE SIZE SMNT STAT STOR STOU } \
    ftp_cmds { STRU SYST TEST TYPE USER XCUP XCRC XCWD } \
    ftp_cmds { XMAS XMD5 XMKD XPWD XRCP XRMD XRSQ XSEM } \
    ftp_cmds { XSEN XSHA1 XSHA256 } \
    alt_max_param_len 0 { ABOR CCC CDUP ESTA FEAT LPSV NOOP PASV PWD QUIT REIN STOU SYST XCUP XPWD } \
    alt_max_param_len 200 { ALLO APPE CMD HELP NLST RETR RNFR STOR STOU XMKD } \
    alt_max_param_len 256 { CWD RNTO } \
    alt_max_param_len 400 { PORT } \
    alt_max_param_len 512 { SIZE } \
    chk_str_fmt { ACCT ADAT ALLO APPE AUTH CEL CLNT CMD } \
    chk_str_fmt { CONF CWD DELE ENC EPRT EPSV ESTP HELP } \
    chk_str_fmt { LANG LIST LPRT MACB MAIL MDTM MIC MKD } \
    chk_str_fmt { MLSD MLST MODE NLST OPTS PASS PBSZ PORT } \
    chk_str_fmt { PROT REST RETR RMD RNFR RNTO SDUP SITE } \
    chk_str_fmt { SIZE SMNT STAT STOR STRU TEST TYPE USER } \
    chk_str_fmt { XCRC XCWD XMAS XMD5 XMKD XRCP XRMD XRSQ } \ 
    chk_str_fmt { XSEM XSEN XSHA1 XSHA256 } \
    cmd_validity ALLO &lt; int &#91; char R int &#93; &gt; \    
    cmd_validity EPSV &lt; &#91; { char 12 | char A char L char L } &#93; &gt; \
    cmd_validity MACB &lt; string &gt; \
    cmd_validity MDTM &lt; &#91; date nnnnnnnnnnnnnn&#91;.n&#91;n&#91;n&#93;&#93;&#93; &#93; string &gt; \
    cmd_validity MODE &lt; char ASBCZ &gt; \
    cmd_validity PORT &lt; host_port &gt; \
    cmd_validity PROT &lt; char CSEP &gt; \
    cmd_validity STRU &lt; char FRPO &#91; string &#93; &gt; \    
    cmd_validity TYPE &lt; { char AE &#91; char NTC &#93; | char I | char L &#91; number &#93; } &gt;
preprocessor ftp_telnet_protocol: ftp client default \
    max_resp_len 256 \
    bounce yes \
    ignore_telnet_erase_cmds yes \
    telnet_cmds yes


# SMTP normalization and anomaly detection.  For more information, see README.SMTP
preprocessor smtp: ports { 25 465 587 691 } \
    inspection_type stateful \
    b64_decode_depth 0 \
    qp_decode_depth 0 \
    bitenc_decode_depth 0 \
    uu_decode_depth 0 \
    log_mailfrom \
    log_rcptto \
    log_filename \
    log_email_hdrs \
    normalize cmds \
    normalize_cmds { ATRN AUTH BDAT CHUNKING DATA DEBUG EHLO EMAL ESAM ESND ESOM ETRN EVFY } \
    normalize_cmds { EXPN HELO HELP IDENT MAIL NOOP ONEX QUEU QUIT RCPT RSET SAML SEND SOML } \
    normalize_cmds { STARTTLS TICK TIME TURN TURNME VERB VRFY X-ADAT X-DRCP X-ERCP X-EXCH50 } \
    normalize_cmds { X-EXPS X-LINK2STATE XADR XAUTH XCIR XEXCH50 XGEN XLICENSE XQUE XSTA XTRN XUSR } \
    max_command_line_len 512 \
    max_header_line_len 1000 \
    max_response_line_len 512 \
    alt_max_command_line_len 260 { MAIL } \
    alt_max_command_line_len 300 { RCPT } \
    alt_max_command_line_len 500 { HELP HELO ETRN EHLO } \
    alt_max_command_line_len 255 { EXPN VRFY ATRN SIZE BDAT DEBUG EMAL ESAM ESND ESOM EVFY IDENT NOOP RSET } \
    alt_max_command_line_len 246 { SEND SAML SOML AUTH TURN ETRN DATA RSET QUIT ONEX QUEU STARTTLS TICK TIME TURNME VERB X-EXPS X-LINK2STATE XADR XAUTH XCIR XEXCH50 XGEN XLICENSE XQUE XSTA XTRN XUSR } \
    valid_cmds { ATRN AUTH BDAT CHUNKING DATA DEBUG EHLO EMAL ESAM ESND ESOM ETRN EVFY } \ 
    valid_cmds { EXPN HELO HELP IDENT MAIL NOOP ONEX QUEU QUIT RCPT RSET SAML SEND SOML } \
    valid_cmds { STARTTLS TICK TIME TURN TURNME VERB VRFY X-ADAT X-DRCP X-ERCP X-EXCH50 } \
    valid_cmds { X-EXPS X-LINK2STATE XADR XAUTH XCIR XEXCH50 XGEN XLICENSE XQUE XSTA XTRN XUSR } \
    xlink2state { enabled }

# Portscan detection.  For more information, see README.sfportscan
# preprocessor sfportscan: proto  { all } memcap { 10000000 } sense_level { low }

# ARP spoof detection.  For more information, see the Snort Manual - Configuring Snort - Preprocessors - ARP Spoof Preprocessor
# preprocessor arpspoof
# preprocessor arpspoof_detect_host: 192.168.40.1 f0:0f:00:f0:0f:00

# SSH anomaly detection.  For more information, see README.ssh
preprocessor ssh: server_ports { 22 } \
                  autodetect \
                  max_client_bytes 19600 \
                  max_encrypted_packets 20 \
                  max_server_version_len 100 \
                  enable_respoverflow enable_ssh1crc32 \
                  enable_srvoverflow enable_protomismatch

# SMB / DCE-RPC normalization and anomaly detection.  For more information, see README.dcerpc2
preprocessor dcerpc2: memcap 102400, events &#91;co &#93;
preprocessor dcerpc2_server: default, policy WinXP, \
    detect &#91;smb &#91;139,445&#93;, tcp 135, udp 135, rpc-over-http-server 593&#93;, \
    autodetect &#91;tcp 1025:, udp 1025:, rpc-over-http-server 1025:&#93;, \
    smb_max_chain 3, smb_invalid_shares &#91;&quot;C$&quot;, &quot;D$&quot;, &quot;ADMIN$&quot;&#93;

# DNS anomaly detection.  For more information, see README.dns
preprocessor dns: ports { 53 } enable_rdata_overflow

# SSL anomaly detection and traffic bypass.  For more information, see README.ssl
preprocessor ssl: ports { 443 465 563 636 989 992 993 994 995 7801 7802 7900 7901 7902 7903 7904 7905 7906 7907 7908 7909 7910 7911 7912 7913 7914 7915 7916 7917 7918 7919 7920 }, trustservers, noinspect_encrypted

# SDF sensitive data preprocessor.  For more information see README.sensitive_data
preprocessor sensitive_data: alert_threshold 25

# SIP Session Initiation Protocol preprocessor.  For more information see README.sip
preprocessor sip: max_sessions 40000, \
   ports { 5060 5061 5600 }, \
   methods { invite \
             cancel \
             ack \
             bye \
             register \
             options \
             refer \
             subscribe \
             update \
             join \
             info \
             message \
             notify \
             benotify \
             do \
             qauth \
             sprack \
             publish \
             service \
             unsubscribe \
             prack }, \
   max_uri_len 512, \
   max_call_id_len 80, \
   max_requestName_len 20, \
   max_from_len 256, \
   max_to_len 256, \
   max_via_len 1024, \
   max_contact_len 512, \
   max_content_len 2048 

# IMAP preprocessor.  For more information see README.imap
preprocessor imap: \
   ports { 143 } \
   b64_decode_depth 0 \
   qp_decode_depth 0 \
   bitenc_decode_depth 0 \
   uu_decode_depth 0

# POP preprocessor. For more information see README.pop
preprocessor pop: \
   ports { 110 } \
   b64_decode_depth 0 \
   qp_decode_depth 0 \
   bitenc_decode_depth 0 \
   uu_decode_depth 0

# Modbus preprocessor. For more information see README.modbus
preprocessor modbus: ports { 502 }

# DNP3 preprocessor. For more information see README.dnp3
preprocessor dnp3: ports { 20000 } \
   memcap 262144 \
   check_crc

# Reputation preprocessor. For more information see README.reputation
preprocessor reputation: \
   memcap 500, \
   priority whitelist, \
   nested_ip inner, \
#   whitelist $WHITE_LIST_PATH/white_list.rules, \
#   blacklist $BLACK_LIST_PATH/black_list.rules 

###################################################
# Step #6: Configure output plugins
# For more information, see Snort Manual, Configuring Snort - Output Modules
###################################################

# unified2 
# Recommended for most installs
# output unified2: filename merged.log, limit 128, nostamp, mpls_event_types, vlan_event_types
output unified2: filename snort.log,limit 24 
# Additional configuration for specific types of installs
#output alert_unified2: filename snort.alert, limit 128, nostamp
#output log_unified2: filename snort.log, limit 128, nostamp 

# syslog
# output alert_syslog: LOG_AUTH LOG_ALERT
# pcap
# output log_tcpdump: tcpdump.log

# metadata reference data.  do not modify these lines
include classification.config
include reference.config


###################################################
# Step #7: Customize your rule set
# For more information, see Snort Manual, Writing Snort Rules
#
# NOTE: All categories are enabled in this conf file
###################################################

# site specific rules
include $RULE_PATH/local.rules

include $RULE_PATH/app-detect.rules
include $RULE_PATH/attack-responses.rules
#include $RULE_PATH/backdoor.rules
include $RULE_PATH/bad-traffic.rules
include $RULE_PATH/blacklist.rules
include $RULE_PATH/botnet-cnc.rules
include $RULE_PATH/browser-chrome.rules
include $RULE_PATH/browser-firefox.rules
include $RULE_PATH/browser-ie.rules
include $RULE_PATH/browser-other.rules
include $RULE_PATH/browser-plugins.rules
include $RULE_PATH/browser-webkit.rules
include $RULE_PATH/chat.rules
include $RULE_PATH/content-replace.rules
include $RULE_PATH/ddos.rules
include $RULE_PATH/dns.rules
include $RULE_PATH/dos.rules
include $RULE_PATH/experimental.rules
include $RULE_PATH/exploit-kit.rules
#include $RULE_PATH/exploit.rules
include $RULE_PATH/file-executable.rules
include $RULE_PATH/file-flash.rules
include $RULE_PATH/file-identify.rules
include $RULE_PATH/file-image.rules
include $RULE_PATH/file-multimedia.rules
include $RULE_PATH/file-office.rules
include $RULE_PATH/file-other.rules
include $RULE_PATH/file-pdf.rules
include $RULE_PATH/finger.rules
include $RULE_PATH/ftp.rules
include $RULE_PATH/icmp-info.rules
include $RULE_PATH/icmp.rules
include $RULE_PATH/imap.rules
include $RULE_PATH/indicator-compromise.rules
include $RULE_PATH/indicator-obfuscation.rules
include $RULE_PATH/indicator-shellcode.rules
include $RULE_PATH/info.rules
include $RULE_PATH/malware-backdoor.rules
include $RULE_PATH/malware-cnc.rules
include $RULE_PATH/malware-other.rules
include $RULE_PATH/malware-tools.rules
include $RULE_PATH/misc.rules
include $RULE_PATH/multimedia.rules
include $RULE_PATH/mysql.rules
#include $RULE_PATH/netbios.rules
include $RULE_PATH/nntp.rules
include $RULE_PATH/oracle.rules
include $RULE_PATH/os-linux.rules
include $RULE_PATH/os-other.rules
include $RULE_PATH/os-solaris.rules
include $RULE_PATH/os-windows.rules
include $RULE_PATH/other-ids.rules
include $RULE_PATH/p2p.rules
include $RULE_PATH/phishing-spam.rules
include $RULE_PATH/policy-multimedia.rules
include $RULE_PATH/policy-other.rules
#include $RULE_PATH/policy.rules
include $RULE_PATH/policy-social.rules
include $RULE_PATH/policy-spam.rules
include $RULE_PATH/pop2.rules
include $RULE_PATH/pop3.rules
include $RULE_PATH/protocol-finger.rules
include $RULE_PATH/protocol-ftp.rules
include $RULE_PATH/protocol-icmp.rules
include $RULE_PATH/protocol-imap.rules
include $RULE_PATH/protocol-pop.rules
include $RULE_PATH/protocol-services.rules
include $RULE_PATH/protocol-voip.rules
include $RULE_PATH/pua-adware.rules
include $RULE_PATH/pua-other.rules
include $RULE_PATH/pua-p2p.rules
include $RULE_PATH/pua-toolbars.rules
include $RULE_PATH/rpc.rules
include $RULE_PATH/rservices.rules
include $RULE_PATH/scada.rules
include $RULE_PATH/scan.rules
include $RULE_PATH/server-apache.rules
include $RULE_PATH/server-iis.rules
include $RULE_PATH/server-mail.rules
include $RULE_PATH/server-mssql.rules
include $RULE_PATH/server-mysql.rules
include $RULE_PATH/server-oracle.rules
include $RULE_PATH/server-other.rules
include $RULE_PATH/server-webapp.rules
include $RULE_PATH/shellcode.rules
include $RULE_PATH/smtp.rules
include $RULE_PATH/snmp.rules
#include $RULE_PATH/specific-threats.rules
include $RULE_PATH/spyware-put.rules
include $RULE_PATH/sql.rules
include $RULE_PATH/telnet.rules
include $RULE_PATH/tftp.rules
include $RULE_PATH/virus.rules
include $RULE_PATH/voip.rules
#include $RULE_PATH/web-activex.rules
include $RULE_PATH/web-attacks.rules
include $RULE_PATH/web-cgi.rules
include $RULE_PATH/web-client.rules
#include $RULE_PATH/web-coldfusion.rules
#include $RULE_PATH/web-frontpage.rules
#include $RULE_PATH/web-iis.rules
#include $RULE_PATH/web-misc.rules
include $RULE_PATH/web-php.rules
include $RULE_PATH/x11.rules

###################################################
# Step #8: Customize your preprocessor and decoder alerts
# For more information, see README.decoder_preproc_rules
###################################################

# decoder and preprocessor event rules
 include $PREPROC_RULE_PATH/preprocessor.rules
 include $PREPROC_RULE_PATH/decoder.rules
 include $PREPROC_RULE_PATH/sensitive-data.rules

###################################################
# Step #9: Customize your Shared Object Snort Rules
# For more information, see<span class="link"> http://vrt-blog.snort.org/2009/01/using-vrt-certified-shared-object-rules.html</span>
###################################################

# dynamic library rules
# include $SO_RULE_PATH/bad-traffic.rules
# include $SO_RULE_PATH/chat.rules
# include $SO_RULE_PATH/dos.rules
# include $SO_RULE_PATH/exploit.rules
#include $SO_RULE_PATH/icmp.rules
# include $SO_RULE_PATH/imap.rules
# include $SO_RULE_PATH/misc.rules
# include $SO_RULE_PATH/multimedia.rules
# include $SO_RULE_PATH/netbios.rules
# include $SO_RULE_PATH/nntp.rules
# include $SO_RULE_PATH/p2p.rules
# include $SO_RULE_PATH/smtp.rules
# include $SO_RULE_PATH/snmp.rules
# include $SO_RULE_PATH/specific-threats.rules
# include $SO_RULE_PATH/web-activex.rules
# include $SO_RULE_PATH/web-client.rules
# include $SO_RULE_PATH/web-iis.rules
# include $SO_RULE_PATH/web-misc.rules

# Event thresholding or suppression commands. See threshold.conf 
include threshold.conf</pre>
		</div>
Barnyard2: /ect/snort/barnyard2.conf
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#
#  Barnyard2 example configuration file
#

#
# This file contains a sample barnyard2 configuration.
# You can take the following steps to create your own custom configuration:
#
#   1&#41; Configure the variable declarations
#   2&#41; Setup the input plugins
#   3&#41; Setup the output plugins
#

#
# Step 1: configure the variable declarations
#

# in order to keep from having a commandline that uses every letter in the
# alphabet most configuration options are set here.

# use UTC for timestamps
#
#config utc

# set the appropriate paths to the file&#40;s&#41; your Snort process is using.
#
config reference_file:      /etc/snort/reference.config
config classification_file: /etc/snort/classification.config
config gen_file:            /etc/snort/gen-msg.map
config sid_file:            /etc/snort/sid-msg.map

# Set the event cache size to defined max value before recycling of event occur.
#
#
#config event_cache_size: 4096

# define dedicated references similar to that of snort.
#
#config reference: mybugs<span class="link"> http://www.mybugs.com/?s=</span>

# define explicit classifications similar to that of snort.
#
#config classification: shortname, short description, priority

# set the directory for any output logging
#
config logdir: /var/log/barnyard2

# to ensure that any plugins requiring some level of uniqueness in their output
# the alert_with_interface_name, interface and hostname directives are provided.
# An example of usage would be to configure them to the values of the associated
# snort process whose unified files you are reading.
#
# Example:
#   For a snort process as follows:
#     snort -i eth0 -c /etc/snort.conf
#
#   Typical options would be:
#     config hostname:  thor
#     config interface: eth0
     config alert_with_interface_name
#
config hostname:   localhost
config interface:  eth1

# enable printing of the interface name when alerting.
#
#config alert_with_interface_name

# at times snort will alert on a packet within a stream and dump that stream to
# the unified output. barnyard2 can generate output on each packet of that
# stream or the first packet only.
#
#config alert_on_each_packet_in_stream

 enable daemon mode
#
#config daemon

# make barnyard2 process chroot to directory after initialisation.
#
#config chroot: /var/spool/barnyard2

# specifiy the group or GID for barnyard2 to run as after initialisation.
#
#config set_gid: 999

# specifiy the user or UID for barnyard2 to run as after initialisation.
#
#config set_uid: 999

# specify the directory for the barnyard2 PID file.
#
#config pidpath: /var/run/by2.pid

# enable decoding of the data link &#40;or second level headers&#41;.
#
#config decode_data_link

# dump the application data
#
#config dump_payload

# dump the application data as chars only
#
#config dump_chars_only

# enable verbose dumping of payload information in log style output plugins.
#
#config dump_payload_verbose

# enable obfuscation of logged IP addresses.
#
#config obfuscate

# enable the year being shown in timestamps
#
#config show_year

# set the umask for all files created by the barnyard2 process &#40;eg. log files&#41;.
#
#config umask: 066

# enable verbose logging
#
#config verbose

# quiet down some of the output
#
#config quiet

# define the full waldo filepath.
#
config waldo_file: /var/log/snort/barnyard2.waldo

# specificy the maximum length of the MPLS label chain
#
#config max_mpls_labelchain_len: 64

# specify the protocol &#40;ie ipv4, ipv6, ethernet&#41; that is encapsulated by MPLS.
#
#config mpls_payload_type: ipv4

# set the reference network or homenet which is predominantly used by the
# log_ascii plugin.
#
#config reference_net: 192.168.0.0/24

#
# CONTINOUS MODE
#

# set the archive directory for use with continous mode
#
#config archivedir: /tmp

# when in operating in continous mode, only process new records and ignore any
# existing unified files
#
#config process_new_records_only


#
# Step 2: setup the input plugins
#

# this is not hard, only unified2 is supported ;&#41;
input unified2


#
# Step 3: setup the output plugins
#

# alert_cef
# ----------------------------------------------------------------------------
#
# Purpose:
#  This output module provides the abilty to output alert information to a
# remote network host as well as the local host using the open standard
# Common Event Format &#40;CEF&#41;.
#
# Arguments: host=hostname&#91;:port&#93;, severity facility
#            arguments should be comma delimited.
#   host        - specify a remote hostname or IP with optional port number
#                 this is only specific to WIN32 &#40;and is not yet fully supported&#41;
#   severity    - as defined in RFC 3164 &#40;eg. LOG_WARN, LOG_INFO&#41;
#   facility    - as defined in RFC 3164 &#40;eg. LOG_AUTH, LOG_LOCAL0&#41;
#
# Examples:
#   output alert_cef
#   output alert_cef: host=192.168.10.1
#   output alert_cef: host=sysserver.com:1001
#   output alert_cef: LOG_AUTH LOG_INFO
#

# alert_bro
# ----------------------------------------------------------------------------
#
# Purpose: Send alerts to a Bro-IDS instance.
#
# Arguments: hostname:port
#
# Examples:
#   output alert_bro: 127.0.0.1:47757

# alert_fast
# ----------------------------------------------------------------------------
# Purpose: Converts data to an approximation of Snort's &quot;fast alert&quot; mode.
#
# Arguments: file &lt;file&gt;, stdout
#            arguments should be comma delimited.
#   file - specifiy alert file
#   stdout - no alert file, just print to screen
#
# Examples:
   output alert_fast
#   output alert_fast: stdout
#
#output alert_fast: stdout


# prelude: log to the Prelude Hybrid IDS system
# ----------------------------------------------------------------------------
#
# Purpose:
#  This output module provides logging to the Prelude Hybrid IDS system
#
# Arguments: profile=snort-profile
#   snort-profile   - name of the Prelude profile to use &#40;default is snort&#41;.
#
# Snort priority to IDMEF severity mappings:
# high &lt; medium &lt; low &lt; info
#
# These are the default mapped from classification.config:
# info   = 4
# low    = 3
# medium = 2
# high   = anything below medium
#
# Examples:
#   output alert_prelude
#   output alert_prelude: profile=snort-profile-name
#


# alert_syslog
# ----------------------------------------------------------------------------
#
# Purpose:
#  This output module provides the abilty to output alert information to local syslog
#
#   severity    - as defined in RFC 3164 &#40;eg. LOG_WARN, LOG_INFO&#41;
#   facility    - as defined in RFC 3164 &#40;eg. LOG_AUTH, LOG_LOCAL0&#41;
#
# Examples:
#   output alert_syslog
#   output alert_syslog: LOG_AUTH LOG_INFO
#

# syslog_full
#-------------------------------
# Available as both a log and alert output plugin.  Used to output data via TCP/UDP or LOCAL ie&#40;syslog&#40;&#41;&#41;
# Arguments:
#      sensor_name $sensor_name         - unique sensor name
#      server $server                   - server the device will report to
#      local                            - if defined, ignore all remote information and use syslog&#40;&#41; to send message.
#      protocol $protocol               - protocol device will report over &#40;tcp/udp&#41;
#      port $port                       - destination port device will report to &#40;default: 514&#41;
#      delimiters $delimiters           - define a character that will delimit message sections ex:  &quot;|&quot;, will use | as message section delimiters. &#40;default: |&#41;
#      separators $separators           - define field separator included in each message ex: &quot; &quot; ,  will use space as field separator.             &#40;default: &#91;:space:&#93;&#41;
#      operation_mode $operaion_mode    - default | complete : default mode is compatible with default snort syslog message, complete prints more information such as the raw packet &#40;hexed&#41;
#      log_priority   $log_priority     - used by local option for syslog priority call. &#40;man syslog&#40;3&#41; for supported options&#41; &#40;default: LOG_INFO&#41;
#      log_facility  $log_facility      - used by local option for syslog facility call. &#40;man syslog&#40;3&#41; for supported options&#41; &#40;default: LOG_USER&#41;
#      payload_encoding                 - &#40;default: hex&#41;  support hex/ascii/base64 for log_syslog_full using operation_mode complete only.

# Usage Examples:
# output alert_syslog_full: sensor_name snortIds1-eth2, server xxx.xxx.xxx.xxx, protocol udp, port 514, operation_mode default
# output alert_syslog_full: sensor_name snortIds1-eth2, server xxx.xxx.xxx.xxx, protocol udp, port 514, operation_mode complete
# output log_syslog_full: sensor_name snortIds1-eth2, server xxx.xxx.xxx.xxx, protocol udp, port 514, operation_mode default
# output log_syslog_full: sensor_name snortIds1-eth2, server xxx.xxx.xxx.xxx, protocol udp, port 514, operation_mode complete
# output alert_syslog_full: sensor_name snortIds1-eth2, server xxx.xxx.xxx.xxx, protocol udp, port 514
# output log_syslog_full: sensor_name snortIds1-eth2, server xxx.xxx.xxx.xxx, protocol udp, port 514
# output alert_syslog_full: sensor_name snortIds1-eth2, local
# output log_syslog_full: sensor_name snortIds1-eth2, local, log_priority LOG_CRIT,log_facility LOG_CRON

# log_ascii
# ----------------------------------------------------------------------------
#
# Purpose: This output module provides the default packet logging funtionality
#
# Arguments: None.
#
# Examples:
#   output log_ascii
#


# log_tcpdump
# ----------------------------------------------------------------------------
#
# Purpose
#  This output module logs packets in binary tcpdump format
#
# Arguments:
#   The only argument is the output file name.
#
# Examples:
#   output log_tcpdump: tcpdump.log
#


# sguil
# ----------------------------------------------------------------------------
#
# Purpose: This output module provides logging ability for the sguil interface
# See doc/README.sguil
#
# Arguments: agent_port &lt;port&gt;, sensor_name &lt;name&gt;
#            arguments should be comma delimited.
#   agent_port  - explicitly set the sguil agent listening port
#                 &#40;default: 7736&#41;
#   sensor_name - explicitly set the sensor name
#                 &#40;default: machine hostname&#41;
#
# Examples:
#   output sguil
#   output sguil: agent_port=7000
#   output sguil: sensor_name=argyle
#   output sguil: agent_port=7000, sensor_name=argyle
#


# database: log to a variety of databases
# ----------------------------------------------------------------------------
#
# Purpose: This output module provides logging ability to a variety of databases
# See doc/README.database for additional information.
#
# Examples:
output database: log, mysql, user=snort password=snortpass dbname=snort host=localhost
#   output database: alert, postgresql, user=snort dbname=snort
#   output database: log, odbc, user=snort dbname=snort
#   output database: log, mssql, dbname=snort user=snort password=test
#   output database: log, oracle, dbname=snort user=snort password=test
#


# alert_fwsam: allow blocking of IP's through remote services
# ----------------------------------------------------------------------------
# output alert_fwsam: &lt;SnortSam Station&gt;:&lt;port&gt;/&lt;key&gt;
#
#  &lt;FW Mgmt Station&gt;:  IP address or host name of the host running SnortSam.
#  &lt;port&gt;:         Port the remote SnortSam service listens on &#40;default 898&#41;.
#  &lt;key&gt;:              Key used for authentication &#40;encryption really&#41;
#              of the communication to the remote service.
#
# Examples:
#
# output alert_fwsam: snortsambox/idspassword
# output alert_fwsam: fw1.domain.tld:898/mykey
# output alert_fwsam: 192.168.0.1/borderfw  192.168.1.254/wanfw
#</pre>
		</div>
File /vả/log/snort/snort.log.xxx
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>03/21-07:37:14.267528 192.168.10.10 -&gt; 192.168.10.1
ICMP TTL:128 TOS:0x0 ID:9137 IpLen:20 DgmLen:60
Type:8  Code:0  ID:1   Seq:851  ECHO
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/21-07:37:14.267563 192.168.10.1 -&gt; 192.168.10.10
ICMP TTL:64 TOS:0x0 ID:47134 IpLen:20 DgmLen:60
Type:0  Code:0  ID:1  Seq:851  ECHO REPLY
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/21-07:37:15.269181 192.168.10.10 -&gt; 192.168.10.1
ICMP TTL:128 TOS:0x0 ID:9147 IpLen:20 DgmLen:60
Type:8  Code:0  ID:1   Seq:852  ECHO
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/21-07:37:15.269217 192.168.10.1 -&gt; 192.168.10.10
ICMP TTL:64 TOS:0x0 ID:47135 IpLen:20 DgmLen:60
Type:0  Code:0  ID:1  Seq:852  ECHO REPLY
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/21-07:37:16.270788 192.168.10.10 -&gt; 192.168.10.1
ICMP TTL:128 TOS:0x0 ID:9155 IpLen:20 DgmLen:60
Type:8  Code:0  ID:1   Seq:853  ECHO
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/21-07:37:16.270825 192.168.10.1 -&gt; 192.168.10.10
ICMP TTL:64 TOS:0x0 ID:47136 IpLen:20 DgmLen:60
Type:0  Code:0  ID:1  Seq:853  ECHO REPLY
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

03/21-07:37:17.272013 192.168.10.10 -&gt; 192.168.10.1
ICMP TTL:128 TOS:0x0 ID:9165 IpLen:20 DgmLen:60
Type:8  Code:0  ID:1   Seq:854  ECHO
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274247</guid>
				<link>/hvaonline/posts/list/44416.html#274247</link>
				<pubDate><![CDATA[Wed, 20 Mar 2013 11:38:41]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ Tốt nhất là lần sau bạn nên làm theo hướng dẫn theo tài liệu đi kèm.<span class="link"> http://www.snort.org/assets/159/Snort_2.9.1_CentOS_5.pdf</span>

Có thể vấn đề của bạn là ở đây: 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM data WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM event WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM icmphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM iphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM opt WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM tcphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM udphdr WHERE sid='1';&#93;</pre>
		</div>

Bạn vui lòng kiểm tra lại thư mục <font color='orange'>/var/log/barnyard2 </font>có những file nào?
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>ls -la /var/log/barnyard2</pre>
		</div>

Kiểm tra lại xem database của Snort đã được tạo hay chưa? 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$mysql -u snort -p
mysql&gt; SHOW DATABASES;
mysql&gt; use snort;
mysql&gt; SHOW TABLES;</pre>
		</div>

Các file cấu hình của bạn mình không thấy vấn đề gì hết. Không rõ bạn cài đặt và cấu hình barnyard bằng cách nào?


- Ky0 - 

PS: Đối mấy file cấu hình thì khi đưa lên diễn đàn thì bỏ các dòng có dấu # ở đầu đi cho dễ nhìn ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274250</guid>
				<link>/hvaonline/posts/list/44416.html#274250</link>
				<pubDate><![CDATA[Wed, 20 Mar 2013 13:28:49]]> GMT</pubDate>
				<author><![CDATA[ Ky0]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ bị double, xoá bớt 1 bài.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274253</guid>
				<link>/hvaonline/posts/list/44416.html#274253</link>
				<pubDate><![CDATA[Wed, 20 Mar 2013 18:02:23]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
			<item>
				<title>Snort 2.9.4.1 Baryard 2.1.12 CentOS 6.3 cần giúp đỡ.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Ky0 wrote:</cite><br>
		<blockquote>Tốt nhất là lần sau bạn nên làm theo hướng dẫn theo tài liệu đi kèm.<span class="link"> http://www.snort.org/assets/159/Snort_2.9.1_CentOS_5.pdf</span>

Có thể vấn đề của bạn là ở đây: 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM data WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM event WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM icmphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM iphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM opt WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM tcphdr WHERE sid='1';&#93;
database: &#91;SynchronizeEventId&#40;&#41;&#93;: Problems executing &#91;SELECT MAX&#40;cid&#41; FROM udphdr WHERE sid='1';&#93;</pre>
		</div>

Bạn vui lòng kiểm tra lại thư mục <font color='orange'>/var/log/barnyard2 </font>có những file nào?
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>ls -la /var/log/barnyard2</pre>
		</div>

Kiểm tra lại xem database của Snort đã được tạo hay chưa? 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$mysql -u snort -p
mysql&gt; SHOW DATABASES;
mysql&gt; use snort;
mysql&gt; SHOW TABLES;</pre>
		</div>

Các file cấu hình của bạn mình không thấy vấn đề gì hết. Không rõ bạn cài đặt và cấu hình barnyard bằng cách nào?


- Ky0 - 

PS: Đối mấy file cấu hình thì khi đưa lên diễn đàn thì bỏ các dòng có dấu # ở đầu đi cho dễ nhìn &nbsp;
		</blockquote>
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>login as: root
root@192.168.10.1's password:
Last login: Thu Mar 21 13:06:59 2013
&#91;root@localhost ~&#93;# ls -al /var/log/barnyard2/
total 8
drwxr-xr-x.  2 snort snort 4096 Mar 21 13:34 .
drwxr-xr-x. 13 root  root  4096 Mar 21 13:01 ..
-rw-r--r--.  1 snort snort    0 Mar 16 10:39 alert
-rw-r--r--.  1 snort snort    0 Mar 16 14:26 barnyard2.alert

&#91;root@localhost ~&#93;# mysql -u snort -p -e "use snort;show tables;"
Enter password:
+------------------+
| Tables_in_snort  |
+------------------+
| acid_ag          |
| acid_ag_alert    |
| acid_event       |
| acid_ip_cache    |
| base_roles       |
| base_users       |
| data             |
| detail           |
| encoding         |
| event            |
| icmphdr          |
| iphdr            |
| opt              |
| reference        |
| reference_system |
| schema           |
| sensor           |
| sig_class        |
| sig_reference    |
| signature        |
| tcphdr           |
| udphdr           |
+------------------+
&#91;root@localhost ~&#93;#</pre>
		</div>
Thanks mod.
Mình cài barnyard2 theo cách ở đây<span class="link"> http://polaris.umuc.edu/~sgantz/Barnyard.html</span>
Nếu sửa không được chắc phải làm lại từ đầu theo file pdf đó quá.  #:S ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/44416.html#274254</guid>
				<link>/hvaonline/posts/list/44416.html#274254</link>
				<pubDate><![CDATA[Wed, 20 Mar 2013 18:02:35]]> GMT</pubDate>
				<author><![CDATA[ boykissbaby]]></author>
			</item>
	</channel>
</rss>
