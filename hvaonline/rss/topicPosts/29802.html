<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Làm thế nào để gán TCP options khi inject packet bằng nemesis?"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/24.hva</link>
		<description><![CDATA[Latest messages posted in the topic "Làm thế nào để gán TCP options khi inject packet bằng nemesis?"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Làm thế nào để gán TCP options khi inject packet bằng nemesis?</title>
				<description><![CDATA[ Chào các bạn,

Mình đang thực hành nemesis. Bây giờ mình muốn tạo một packet với các TCP options: Maximum segment size (MSS) bằng x, Window Scale option (WSopt) bằng y, Timestamp option (TSopt) bằng z, ... Trong man page của nemesis-tcp cũng chỉ vẻn vẹn có thế này:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>-o TCP-options-file
              This  will  cause nemesis-dns to use the specified TCP-options-file as the options when
              building the TCP header for the injected packet.  TCP options can be up to 40 bytes  in
              length.   The TCP options file must be created manually based upon the desired options.
              TCP options can also be read from stdin by specifying '-o -' instead of a  TCP-options-
              file.</pre>
		</div>

Không hiểu cái TCP options file này có cấu trúc thế nào: ASCII, hex, raw, ...? 

Để thử, mình nghĩ ra một cách là: trong Wireshark, mình chọn <b>Follow TCP stream</b> options của một packet nào đó, rồi lưu lại dưới vài dạng như: ASCII, hex, ... Sau đó, dùng làm input cho nemesis như sau:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>sudo nemesis tcp -v -fS -D localhost -o /path/to/&lt;TCP_options_file&gt;</pre>
		</div>
thì gặp thông báo:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>TCP Packet Injection -=- The NEMESIS Project Version 1.4 &#40;Build 26&#41;

                &#91;IP&#93; 23.93.175.115 &gt; 127.0.0.1
             &#91;IP ID&#93; 63957
          &#91;IP Proto&#93; TCP &#40;6&#41;
            &#91;IP TTL&#93; 255
            &#91;IP TOS&#93; 0x00
    &#91;IP Frag offset&#93; 0x0000
     &#91;IP Frag flags&#93; 
         &#91;TCP Ports&#93; 9409 &gt; 8188
         &#91;TCP Flags&#93; SYN 
&#91;TCP Urgent Pointer&#93; 0
   &#91;TCP Window size&#93; 4096
    &#91;TCP Seq number&#93; 1020184460

Wrote 80 byte TCP packet.
*** glibc detected *** nemesis: double free or corruption &#40;out&#41;: 0x0805dc48 ***
======= Backtrace: =========
/lib/libc.so.6&#91;0xb7ec2564&#93;
/lib/libc.so.6&#40;cfree+0x90&#41;&#91;0xb7ec6010&#93;
nemesis&#91;0x8055d27&#93;
nemesis&#91;0x805379e&#93;
nemesis&#91;0x8054b59&#93;
/lib/libc.so.6&#40;__libc_start_main+0xe0&#41;&#91;0xb7e6d390&#93;
nemesis&#91;0x8048e51&#93;
======= Memory map: ========
08048000-0805c000 r-xp 00000000 08:03 1198419    /usr/local/bin/nemesis
0805c000-0805d000 rw-p 00014000 08:03 1198419    /usr/local/bin/nemesis
0805d000-0807e000 rw-p 0805d000 00:00 0          &#91;heap&#93;
b7c00000-b7c21000 rw-p b7c00000 00:00 0 
b7c21000-b7d00000 ---p b7c21000 00:00 0 
b7d49000-b7d4b000 rw-p b7d49000 00:00 0 
b7d4b000-b7d4f000 r-xp 00000000 08:03 1020182    /usr/lib/libXdmcp.so.6.0.0
b7d4f000-b7d50000 rw-p 00003000 08:03 1020182    /usr/lib/libXdmcp.so.6.0.0
b7d50000-b7d52000 r-xp 00000000 08:03 1020151    /usr/lib/libXau.so.6.0.0
b7d52000-b7d53000 rw-p 00001000 08:03 1020151    /usr/lib/libXau.so.6.0.0
b7d53000-b7d69000 r-xp 00000000 08:03 1020332    /usr/lib/libxcb.so.1.0.0
b7d69000-b7d6a000 rw-p 00015000 08:03 1020332    /usr/lib/libxcb.so.1.0.0
b7d6a000-b7d6b000 r-xp 00000000 08:03 1020345    /usr/lib/libxcb-xlib.so.0.0.0
b7d6b000-b7d6c000 rw-p 00000000 08:03 1020345    /usr/lib/libxcb-xlib.so.0.0.0
b7d6c000-b7e4f000 r-xp 00000000 08:03 1020134    /usr/lib/libX11.so.6.2.0
b7e4f000-b7e52000 rw-p 000e3000 08:03 1020134    /usr/lib/libX11.so.6.2.0
b7e52000-b7e53000 rw-p b7e52000 00:00 0 
b7e53000-b7e55000 r-xp 00000000 08:03 960416     /lib/libdl-2.7.so
b7e55000-b7e56000 r--p 00001000 08:03 960416     /lib/libdl-2.7.so
b7e56000-b7e57000 rw-p 00002000 08:03 960416     /lib/libdl-2.7.so
b7e57000-b7f9c000 r-xp 00000000 08:03 960413     /lib/libc-2.7.so
b7f9c000-b7f9d000 ---p 00145000 08:03 960413     /lib/libc-2.7.so
b7f9d000-b7f9f000 r--p 00145000 08:03 960413     /lib/libc-2.7.so
b7f9f000-b7fa0000 rw-p 00147000 08:03 960413     /lib/libc-2.7.so
b7fa0000-b7fa3000 rw-p b7fa0000 00:00 0 
b7fa3000-b7fc7000 r-xp 00000000 08:03 960417     /lib/libm-2.7.so
b7fc7000-b7fc8000 r--p 00023000 08:03 960417     /lib/libm-2.7.so
b7fc8000-b7fc9000 rw-p 00024000 08:03 960417     /lib/libm-2.7.so
b7fc9000-b7fdd000 r-xp 00000000 08:03 960419     /lib/libnsl-2.7.so
b7fdd000-b7fde000 r--p 00013000 08:03 960419     /lib/libnsl-2.7.so
b7fde000-b7fdf000 rw-p 00014000 08:03 960419     /lib/libnsl-2.7.so
b7fdf000-b7fe1000 rw-p b7fdf000 00:00 0 
b7fe1000-b7ff0000 r-xp 00000000 08:03 960428     /lib/libresolv-2.7.so
b7ff0000-b7ff1000 r--p 0000f000 08:03 960428     /lib/libresolv-2.7.so
b7ff1000-b7ff2000 rw-p 00010000 08:03 960428     /lib/libresolv-2.7.so
b7ff2000-b7ff4000 rw-p b7ff2000 00:00 0 
b7ffd000-b8007000 r-xp 00000000 08:03 394069     /usr/lib/libgcc_s.so.1
b8007000-b8008000 rw-p 00009000 08:03 394069     /usr/lib/libgcc_s.so.1
b8008000-b8011000 r-xp 00000000 08:03 960422     /lib/libnss_files-2.7.so
b8011000-b8012000 r--p 00008000 08:03 960422     /lib/libnss_files-2.7.so
b8012000-b8013000 rw-p 00009000 08:03 960422     /lib/libnss_files-2.7.so
b8013000-b8014000 rw-p b8013000 00:00 0 
b8014000-b801b000 r-xp 00000000 08:03 961954     /lib/xvnkb.so.0.2.9a-2
b801b000-b8021000 rw-p 00007000 08:03 961954     /lib/xvnkb.so.0.2.9a-2
b8021000-b8023000 rw-p b8021000 00:00 0 
b8023000-b803f000 r-xp 00000000 08:03 960455     /lib/ld-2.7.so
b803f000-b8040000 r--p 0001b000 08:03 960455     /lib/ld-2.7.so
b8040000-b8041000 rw-p 0001c000 08:03 960455     /lib/ld-2.7.so
bf92c000-bf941000 rw-p bffeb000 00:00 0          &#91;stack&#93;
ffffe000-fffff000 r-xp 00000000 00:00 0          &#91;vdso&#93;
Aborted</pre>
		</div>
Trên một cửa sổ khác đang chạy <b>sudo tcpdump -v -i lo tcp</b> mình thu được:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>16:57:12.231935 IP &#40;tos 0x0, ttl 255, id 63957, offset 0, flags &#91;none&#93;, proto TCP &#40;6&#41;, length 80&#41;
    23.93.175.115.9409 &gt; localhost.8188: Flags &#91;S&#93;, seq 1020184460, win 4096, options &#91;&#91;bad opt&#93;
16:57:12.231955 IP &#40;tos 0x0, ttl 64, id 0, offset 0, flags &#91;DF&#93;, proto TCP &#40;6&#41;, length 40&#41;
    localhost.8188 &gt; localhost.9409: Flags &#91;R.&#93;, cksum 0x20e6 &#40;incorrect -&gt; 0x68b5&#41;, seq 0, ack 1020184461, win 0, length 0</pre>
		</div>

Vậy là bị <font color='red'>bad options</font> rồi.

Mọi người giúp mình giải quyết chỗ này với?

Cảm ơn.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/29802.hva#183733</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/29802.hva#183733</link>
				<pubDate><![CDATA[Tue, 16 Jun 2009 19:04:07]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
	</channel>
</rss>
