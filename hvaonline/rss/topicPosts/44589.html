<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Cần giúp đỡ về Ragel"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/19.html</link>
		<description><![CDATA[Latest messages posted in the topic "Cần giúp đỡ về Ragel"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Cần giúp đỡ về Ragel</title>
				<description><![CDATA[ Chào mọi người,
mình mới bắt đầu học Ragel, tuy nhiên có phần này mình nghĩ cũng đơn giản, nhưng mò mẫm hàng tiếng mà vẫn chưa ra được

<font color='yellow'> module: microscript.rl  -- parse numbers from input</font>
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#include &lt;stdio.h&gt;
#include &lt;inttypes.h&gt;

%%{
	machine microscript;

	action clear_number {
		current_number = 0;
	}

	action record_digit {
		uint8_t digit = &#40;*p&#41; - '0';
		current_number = current_number*10 + digit;
	}

	action print_current_number {
		printf&#40;&quot;%d\n&quot;, current_number&#41;;
	}

	number = &#40;&#40;digit @record_digit&#41;+&#41; &gt;clear_number;
	whitespace = &#40;space&#41;+;

	main := number @ print_current_number &#40;whitespace number @ print_current_number&#41;*;
}%%


%% write data;

static uint8_t cs;
static uint8_t current_number;

void init_microscript&#40;void&#41; {
	%% write init;
}


void parse_microscript&#40;const char *p, uint16_t len, uint8_t is_eof&#41; {
	const char * pe = p + len;
	char * eof = is_eof? pe : &#40;&#40;char*&#41;0&#41;;

	%% write exec;
}</pre>
		</div>

<font color='yellow'>Chương trình C sử dụng module microscript.pl: main.c</font>
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>int 
main &#40;int argc, char *argv&#91;&#93;&#41;
{
	char * buffer = &quot;89 1 234  5|6 789a&quot;;
	init_microscript&#40;&#41;;
	parse_microscript&#40;buffer, 10, 0&#41;;
	return 0;
}</pre>
		</div> 

<font color='yellow'>Kêt quả mà mình mong muốn:</font>
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>89
1
234</pre>
		</div>

<font color='yellow'>Tuy nhiên, kết quả thực tế:</font>
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>8
89
1
2
23
234</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44589.html#274982</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44589.html#274982</link>
				<pubDate><![CDATA[Tue, 16 Apr 2013 13:37:08]]> GMT</pubDate>
				<author><![CDATA[ van7hu]]></author>
			</item>
	</channel>
</rss>
