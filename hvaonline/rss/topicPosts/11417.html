<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "phân trang trong asp"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/23.hva</link>
		<description><![CDATA[Latest messages posted in the topic "phân trang trong asp"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>phân trang trong asp</title>
				<description><![CDATA[ <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;%@LANGUAGE="VBSCRIPT" CODEPAGE="65001"%&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
&lt;!--#include  file="ql_sp.asp"--&gt;
&lt;% 
Const adCmdStoredProc    = 4
Const adInteger          = 3
Const adCurrency         = 6
Const adParamInput       = 1
Const adParamOutput      = 2
Const adExecuteNoRecords = 128
%&gt;
&lt;!--#include file="../xuly/ketnoi.asp"--&gt;
&lt;%
set cmdview=server.CreateObject&#40;"ADODB.command"&#41;
cmdview.activeconnection = cn
cmdview.CommandText = "view_san_pham"
cmdview.CommandType = adCmdStoredProc
set rs=cmdview.execute
%&gt;
&lt;%
	Dim lcurrentPage
	Dim lpageCount
	lcurrentPage = CLng&#40;request&#40;"page"&#41;&#41;
	if lcurrentPage&lt;1 then lcurrentPage=1
	end if
	rs.cursorlocation =3
' 15 mau tin trong 1 trang
rs.Pagesize=15
rs.open rs, cn, 0, 1
'Dinh vi pham vi trang
lPageCount = rs.PageCount
if lcurrentPage &gt; lpageCount then lcurrentpage=lpageCount
end if
if not rs.eof then
'dinh vi trang hien hanh
	rs.AbsolutePage = lcurrentpage
end if
%&gt;

&lt;/p&gt;
&lt;table width="780" border="1" align="center" cellpadding="0" cellspacing="0" bgcolor="#006C91"&gt;
  &lt;tr&gt;
    &lt;td width="28" align="center" class="tieude_sp"&gt;Mã  &lt;/td&gt;
    &lt;td width="118" align="center" class="tieude_sp"&gt;Tên sản phẩm&lt;/td&gt;
    &lt;td width="101" align="center" class="tieude_sp"&gt;Tên hãng&lt;/td&gt;
    &lt;td width="70" align="center" class="tieude_sp"&gt;Hình ảnh&lt;/td&gt;
    &lt;td width="144" align="center" class="tieude_sp"&gt;Giá &#40;VND&#41; &lt;/td&gt;
    &lt;td width="81" align="center" class="tieude_sp"&gt;Bảo hành &#40;Tháng&#41; &lt;/td&gt;
    &lt;td width="85" align="center" class="tieude_sp"&gt;Tình trạng&lt;/td&gt;
    &lt;td width="58" align="center" class="tieude_sp"&gt;Chi tiết&lt;/td&gt;
    &lt;td width="35" align="center" class="tieude_sp"&gt;Sửa&lt;/td&gt;
    &lt;td width="38" align="center" class="tieude_sp"&gt;Xoá&lt;/td&gt;
  &lt;/tr&gt;
  &lt;% 
	do while not rs.eof anh rs.AbsolutePage = lcurrentPage
  %&gt;
  &lt;tr&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"ma_sp"&#41;%&gt;&lt;/td&gt;
  	&lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"ten_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"tenhang_sx"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;img src="&lt;%=rs&#40;"hinhanh_sp"&#41;%&gt;" width="70" height="92"/&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"gia_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"baohanh_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"tinhtrang_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;a href="ql_sp_chitiet.asp?details=&lt;%=rs&#40;"ma_sp"&#41;%&gt;" &gt;Chi tiết&lt;/a&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;a href="sp_edit.asp?edit=&lt;%=rs&#40;"ma_sp"&#41;%&gt;" onclick="javascript:return confirm &#40;'Bạn có chắc chắn muốn sửa sản phẩm không?'&#41;"&gt;Sửa&lt;/a&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;a href="sp_delete.asp?delete=&lt;%=rs&#40;"ma_sp"&#41;%&gt;" onclick="javascript:return confirm &#40;'Bạn có chắc chắn muốn xoá sản phẩm không?'&#41;"&gt;Xoá&lt;/a&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;%  loop%&gt;
&lt;form name="vf"&gt;
	&lt;input type="hidden" name="page" /&gt;
&lt;/form&gt;
&lt;script language="javascript"&gt;
	function setvalue&#40;page&#41;
		{
		vf.page.value = page;
		vf.submit&#40;&#41;;
		}
&lt;/script&gt;

&lt;%
if lcurrentPage &lt;&gt; 1 and lcurrentPage &lt;&gt; 0 then 
%&gt;
&lt;a href="javascript:setvalue&#40;'&lt;%=lcurrentPage-1%&gt;'&#41;;"&gt;Trang truoc&lt;/a&gt;
&lt;%else %&gt;
	Trang truoc
&lt;% end if%&gt;
&lt;% if lcurrentpage &lt; lpagecount then %&gt;
&lt;a href="javascript:setvalue&#40;'&lt;%=lcurrentPage+1%&gt;'&#41;;"&gt;Trang tiep&lt;/a&gt;
&lt;% else %&gt;
	Trang tiep
&lt;% end if%&gt;

  &lt;% 
  rs.close
  cn.close
  set cn=nothing
  %&gt;  	
&lt;/table&gt;</pre>
		</div>

các cao thủ sửa giúp đc k, k biết sai ở đâu, sửa mãi mà khôg đc, đây là em viết về phân trang cho 1 phần quản lý sản phẩm (điện thoại), với cách viết là gọi thủ tục trong asp từ sql ra]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65764</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65764</link>
				<pubDate><![CDATA[Tue, 19 Jun 2007 19:31:26]]> GMT</pubDate>
				<author><![CDATA[ seekill]]></author>
			</item>
			<item>
				<title>phân trang trong asp</title>
				<description><![CDATA[ Mình đã đọc qua đoạn code của bạn rồi, về thuật toán thì bạn không sai nhưng mình nhìn thấy ở đây là bạn gõ nhầm về cú pháp nên có lẽ chương trình của bạn không chạy được. Mình có đọc và sửa qua một chút trên chương trình của bạn, bạn để ý và thay thế vào xem thế nào nhé.
Chúc bạn thành công.

Ps: Bạn hãy thử sửa những chỗ sai này xem chương trình có chạy được không? Nếu không chạy được thì chương trình báo lỗi như thế nào, và chương trình không chạy được (lỗi code) hay chương trình chạy được nhưng không đúng theo ý muốn (lỗi ý tưởng). Bạn nên post cụ thể thì mọi người có thể giúp bạn tốt hơn.



<p></p>
		<cite class="blockquote">seekill wrote:</cite><br>
		<blockquote><span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;%@LANGUAGE="VBSCRIPT" CODEPAGE="65001"%&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
&lt;!--#include  file="ql_sp.asp"--&gt;
&lt;% 
Const adCmdStoredProc    = 4
Const adInteger          = 3
Const adCurrency         = 6
Const adParamInput       = 1
Const adParamOutput      = 2
Const adExecuteNoRecords = 128
%&gt;
&lt;!--#include file="../xuly/ketnoi.asp"--&gt;
&lt;%
set cmdview=server.CreateObject&#40;"ADODB.command"&#41;
cmdview.activeconnection = cn
cmdview.CommandText = "view_san_pham"
cmdview.CommandType = adCmdStoredProc
set rs=cmdview.execute
%&gt;
&lt;%
	Dim lcurrentPage
	Dim lpageCount
	lcurrentPage = CLng&#40;request&#40;"page"&#41;&#41;
	if lcurrentPage&lt;1 then lcurrentPage=1
	end if                                                 '/// Khong can End If khi lenh thuc hien nam cung dong voi dieu kien IF ... THEN ///
	rs.cursorlocation =3
' 15 mau tin trong 1 trang
rs.Pagesize=15
rs.open rs, cn, 0, 1
'Dinh vi pham vi trang
lPageCount = rs.PageCount
if lcurrentPage &gt; lpageCount then lcurrentpage=lpageCount
end if                                    '/// Khong can End If ///
if not rs.eof then
'dinh vi trang hien hanh
	rs.AbsolutePage = lcurrentpage
end if
%&gt;

&lt;/p&gt;
&lt;table width="780" border="1" align="center" cellpadding="0" cellspacing="0" bgcolor="#006C91"&gt;
  &lt;tr&gt;
    &lt;td width="28" align="center" class="tieude_sp"&gt;Mã  &lt;/td&gt;
    &lt;td width="118" align="center" class="tieude_sp"&gt;Tên sản phẩm&lt;/td&gt;
    &lt;td width="101" align="center" class="tieude_sp"&gt;Tên hãng&lt;/td&gt;
    &lt;td width="70" align="center" class="tieude_sp"&gt;Hình ảnh&lt;/td&gt;
    &lt;td width="144" align="center" class="tieude_sp"&gt;Giá &#40;VND&#41; &lt;/td&gt;
    &lt;td width="81" align="center" class="tieude_sp"&gt;Bảo hành &#40;Tháng&#41; &lt;/td&gt;
    &lt;td width="85" align="center" class="tieude_sp"&gt;Tình trạng&lt;/td&gt;
    &lt;td width="58" align="center" class="tieude_sp"&gt;Chi tiết&lt;/td&gt;
    &lt;td width="35" align="center" class="tieude_sp"&gt;Sửa&lt;/td&gt;
    &lt;td width="38" align="center" class="tieude_sp"&gt;Xoá&lt;/td&gt;
  &lt;/tr&gt;
  &lt;% 
	do while not rs.eof anh rs.AbsolutePage = lcurrentPage   '/// Bạn cần sửa "anh" thành "AND"
  %&gt;
  &lt;tr&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"ma_sp"&#41;%&gt;&lt;/td&gt;
  	&lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"ten_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"tenhang_sx"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;img src="&lt;%=rs&#40;"hinhanh_sp"&#41;%&gt;" width="70" height="92"/&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"gia_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"baohanh_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;%=rs&#40;"tinhtrang_sp"&#41;%&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;a href="ql_sp_chitiet.asp?details=&lt;%=rs&#40;"ma_sp"&#41;%&gt;" &gt;Chi tiết&lt;/a&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;a href="sp_edit.asp?edit=&lt;%=rs&#40;"ma_sp"&#41;%&gt;" onclick="javascript:return confirm &#40;'Bạn có chắc chắn muốn sửa sản phẩm không?'&#41;"&gt;Sửa&lt;/a&gt;&lt;/td&gt;
    &lt;td align="center" class="link1"&gt;&lt;a href="sp_delete.asp?delete=&lt;%=rs&#40;"ma_sp"&#41;%&gt;" onclick="javascript:return confirm &#40;'Bạn có chắc chắn muốn xoá sản phẩm không?'&#41;"&gt;Xoá&lt;/a&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;%  loop%&gt;
&lt;form name="vf"&gt;
	&lt;input type="hidden" name="page" /&gt;
&lt;/form&gt;
&lt;script language="javascript"&gt;
	function setvalue&#40;page&#41;
		{
		vf.page.value = page;
		vf.submit&#40;&#41;;
		}
&lt;/script&gt;

&lt;%
if lcurrentPage &lt;&gt; 1 and lcurrentPage &lt;&gt; 0 then 
%&gt;
&lt;a href="javascript:setvalue&#40;'&lt;%=lcurrentPage-1%&gt;'&#41;;"&gt;Trang truoc&lt;/a&gt;
&lt;%else %&gt;
	Trang truoc
&lt;% end if%&gt;
&lt;% if lcurrentpage &lt; lpagecount then %&gt;
&lt;a href="javascript:setvalue&#40;'&lt;%=lcurrentPage+1%&gt;'&#41;;"&gt;Trang tiep&lt;/a&gt;
&lt;% else %&gt;
	Trang tiep
&lt;% end if%&gt;

  &lt;% 
  rs.close
  cn.close
  set cn=nothing
  %&gt;  	
&lt;/table&gt;</pre>
		</div>

các cao thủ sửa giúp đc k, k biết sai ở đâu, sửa mãi mà khôg đc, đây là em viết về phân trang cho 1 phần quản lý sản phẩm (điện thoại), với cách viết là gọi thủ tục trong asp từ sql ra&nbsp;
		</blockquote>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65819</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65819</link>
				<pubDate><![CDATA[Wed, 20 Jun 2007 03:26:26]]> GMT</pubDate>
				<author><![CDATA[ soccon]]></author>
			</item>
			<item>
				<title>phân trang trong asp</title>
				<description><![CDATA[ thanks soccon nhe, để mình thử lại xem!!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65845</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65845</link>
				<pubDate><![CDATA[Wed, 20 Jun 2007 11:31:50]]> GMT</pubDate>
				<author><![CDATA[ seekill]]></author>
			</item>
			<item>
				<title>phân trang trong asp</title>
				<description><![CDATA[ nó chạy và thông báo lỗi ở chỗ rs.cursorlocation =3 là biến rs không hỗ trợ
mình nghĩ có thể cái rs này khác cái rs ở cái set rs=cmdview.execute nên thay tên khác nhưng vẫn k đc]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65859</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11417.hva#65859</link>
				<pubDate><![CDATA[Wed, 20 Jun 2007 12:00:42]]> GMT</pubDate>
				<author><![CDATA[ seekill]]></author>
			</item>
	</channel>
</rss>
