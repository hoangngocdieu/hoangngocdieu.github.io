<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Giúp vấn để notify trong nagios"]]></title>
		<link>/hvaonline/posts/list/24.html</link>
		<description><![CDATA[Latest messages posted in the topic "Giúp vấn để notify trong nagios"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ Chào anh em HVA,

Hiện tại mình đã cấu hình Nagios notify qua email và sms được. Bây giờ mình muốn khi warning thì chỉ gửi email, khi critical thì mới gửi SMS. Mình nghĩ mãi mà không ra nên cần sự giúp đỡ.

Cám ơn!]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280015</guid>
				<link>/hvaonline/posts/list/45506.html#280015</link>
				<pubDate><![CDATA[Fri, 14 Mar 2014 06:22:37]]> GMT</pubDate>
				<author><![CDATA[ minhneo]]></author>
			</item>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ Cách đơn giản: 
- định nghĩa 2 contacts: minhneo và minhneo-sms
- host|service_notification_commands của minhneo trỏ đến lệnh gửi mail, còn host|service_notification_commands của minhneo-sms trỏ đến lệnh gửi sms
- host|service_notification_options của minhneo có cả `w` (warning) và `c` (critical), còn host|service_notification_options của minhneo-sms chỉ có `c` (critical) thôi.

Cách khác:
- viết một cái wrapper cho `host|service_notification_commands`
- trong đó, check $SERVICESTATE: WARNING thì gọi hàm gửi mail, CRITICAL thì gọi hàm gửi sms
- chú ý check $NOTIFICATIONTYPE xem là PROBLEM hay RECOVERY nữa. Nếu là RECOVERY thì có thể dựa trên $LASTSERVICESTATE để gửi cảnh báo.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280016</guid>
				<link>/hvaonline/posts/list/45506.html#280016</link>
				<pubDate><![CDATA[Fri, 14 Mar 2014 10:03:59]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Cách đơn giản: 
- định nghĩa 2 contacts: minhneo và minhneo-sms
- host|service_notification_commands của minhneo trỏ đến lệnh gửi mail, còn host|service_notification_commands của minhneo-sms trỏ đến lệnh gửi sms
- host|service_notification_options của minhneo có cả `w` (warning) và `c` (critical), còn host|service_notification_options của minhneo-sms chỉ có `c` (critical) thôi.

Cách khác:
- viết một cái wrapper cho `host|service_notification_commands`
- trong đó, check $SERVICESTATE: WARNING thì gọi hàm gửi mail, CRITICAL thì gọi hàm gửi sms
- chú ý check $NOTIFICATIONTYPE xem là PROBLEM hay RECOVERY nữa. Nếu là RECOVERY thì có thể dựa trên $LASTSERVICESTATE để gửi cảnh báo.&nbsp;
		</blockquote>

Cám ơn quanta. Cách đầu thì mình đã hiểu, còn cách 2 sẽ tìm hiểu dù sao có người chỉ cũng quý rồi. Còn 1 vấn đề nữa quanta giúp minhneo luôn nhé là check_load mình set là check_load!5.0,4.0,3.0!10.0,7.0,4.0 . Mình có tìm hiểu qua google nhưng không hiểu cho lắm, như mỗi giá trị nó có 3 tham số tương ứng 5 , 10, 15 phút. Mình đã thử test với câu lệnh trên cho hệ thống load &gt; 90% liên tục 20 phút nhưng không thấy cảnh báo gì?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280018</guid>
				<link>/hvaonline/posts/list/45506.html#280018</link>
				<pubDate><![CDATA[Fri, 14 Mar 2014 11:07:05]]> GMT</pubDate>
				<author><![CDATA[ minhneo]]></author>
			</item>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">minhneo wrote:</cite><br>
		<blockquote>
Cám ơn quanta. Cách đầu thì mình đã hiểu, còn cách 2 sẽ tìm hiểu dù sao có người chỉ cũng quý rồi. Còn 1 vấn đề nữa quanta giúp minhneo luôn nhé là check_load mình set là check_load!5.0,4.0,3.0!10.0,7.0,4.0 . Mình có tìm hiểu qua google nhưng không hiểu cho lắm, như mỗi giá trị nó có 3 tham số tương ứng 5 , 10, 15 phút. Mình đã thử test với câu lệnh trên cho hệ thống load &gt; 90% liên tục 20 phút nhưng không thấy cảnh báo gì?&nbsp;
		</blockquote>

Chào minhneo.

Công thức tính giá trị cho check_load như sau:

<b>nagios_value = CPUs * &lt;load average&gt; / 100</b>

Như vậy, nếu bạn có 4 CPUS, muốn cảnh báo nếu load 90%, thì giá trị truyền vào check_load phải là:

<b>4 * 90 / 100 = 3.6</b>

Làm tương tự với các giá trị load tiếp theo cho 10 và 15 phút.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280020</guid>
				<link>/hvaonline/posts/list/45506.html#280020</link>
				<pubDate><![CDATA[Fri, 14 Mar 2014 14:55:05]]> GMT</pubDate>
				<author><![CDATA[ bino1810]]></author>
			</item>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ Cám ơn bino1810. Mình muốn hỏi thêm vấn đề về active check và pasive check. Theo mình hiểu thì acctive check dùng để chủ động kiểm tra các dịch vụ chẳng hạn như:http,mysql,.. Còn passive check dùng để kiểm tra các thông số hệ thống như cpu, ram, disk và những thứ mà nagios không thể chủ động lấy dữ liệu. Như vậy để passive check hoạt động thì ta cần nrpe gửi thông tin về nagios. Ví dụ muốn check cpu client thì ở client cấu hình nrpe.cfg như sau:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>command&#91;check_load&#93;=/usr/lib64/nagios/plugins/check_load -w 0.7,0.6,0.5 -c 0.9,0.8,0.7</pre>
		</div>
và nagios chỉ cần check_command check_nrpe!check_load là xong, mình làm cái này báo lỗi "(No output on stdout) stderr: Could not resolve hostname #HOSTADDRESS#: Name or service not known" 

Hay cách 2 ở nagios ta chỉ cần khai báo trong command.cfg
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define command{
        command_name    check_local_load
        command_line    $USER1$/check_load -w $ARG1$ -c $ARG2$
        }</pre>
		</div>
và trong tenhost.cfg khai báo 
<blockquote>
check_command check_local_load!0.7,0.6,0.5!0.9,0.8,0.7
&nbsp;
		</blockquote>
Cái này thì không báo lỗi nhưng full load 100% mãi không thấy báo critical hay warning. cpu mình test chỉ có 1 core]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280027</guid>
				<link>/hvaonline/posts/list/45506.html#280027</link>
				<pubDate><![CDATA[Sat, 15 Mar 2014 03:17:33]]> GMT</pubDate>
				<author><![CDATA[ minhneo]]></author>
			</item>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ Cám ơn quanta và bino1810 đã giúp đỡ. Mọi thứ đã ok.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280030</guid>
				<link>/hvaonline/posts/list/45506.html#280030</link>
				<pubDate><![CDATA[Sat, 15 Mar 2014 08:37:26]]> GMT</pubDate>
				<author><![CDATA[ minhneo]]></author>
			</item>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">minhneo wrote:</cite><br>
		<blockquote>Cám ơn quanta và bino1810 đã giúp đỡ. Mọi thứ đã ok.&nbsp;
		</blockquote>
Theo tinh thần "open source": bạn giải quyết được lỗi trên như nào thì nên ghi lại để biết đâu có thể giúp được người khác nếu họ gặp vấn đề tương tự.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280039</guid>
				<link>/hvaonline/posts/list/45506.html#280039</link>
				<pubDate><![CDATA[Sun, 16 Mar 2014 00:25:21]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Giúp vấn để notify trong nagios</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">minhneo wrote:</cite><br>
		<blockquote>Cám ơn quanta và bino1810 đã giúp đỡ. Mọi thứ đã ok.&nbsp;
		</blockquote>
Theo tinh thần "open source": bạn giải quyết được lỗi trên như nào thì nên ghi lại để biết đâu có thể giúp được người khác nếu họ gặp vấn đề tương tự.&nbsp;
		</blockquote>

Thank quanta đã nhắc vì mình dạo này đang nghiên cứu Asterisk nên quên mất. Lỗi mình là do trong file command.cfg phần nrpe nó mặc định là #nrpe#. Bạn nào bị lỗi này thì tìm đến câu lệnh này đổi mấy dấu # thành dấu $ là ok. Chắc có lẽ đây là bản core nên nhà sản xuất troll mình chăng  :D ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/45506.html#280069</guid>
				<link>/hvaonline/posts/list/45506.html#280069</link>
				<pubDate><![CDATA[Wed, 19 Mar 2014 03:27:45]]> GMT</pubDate>
				<author><![CDATA[ minhneo]]></author>
			</item>
	</channel>
</rss>
