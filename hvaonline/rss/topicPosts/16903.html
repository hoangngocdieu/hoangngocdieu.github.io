<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Function Pointer trong C++"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/23.hva</link>
		<description><![CDATA[Latest messages posted in the topic "Function Pointer trong C++"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Function Pointer trong C++</title>
				<description><![CDATA[ Hi các bạn !

Có 1 vấn đề tớ thắc mắc, mà chưa giải quyết được, mặc dù đã google lỗi này, và làm theo nhưng ko thành công

Tớ có 1 file viết bằng C (constructive.c) với nội dung như sau:

<blockquote>/*constructive.c Constructive Solid Geometry*/

#include &lt;GL/glut.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;

<font color='orange'>void firstInsideSecond(void (*a) (void), void (*b) (void), GLenum face, GLenum test)</font>
{
  glEnable(GL_DEPTH_TEST);
  glColorMask(GL_FALSE, GL_FALSE, GL_FALSE, GL_FALSE);
  glCullFace(face);     /* controls which face of a to use */
  a();                  /* draw a face of a into depth buffer */

  /* use stencil plane to find parts of a in b */
  glDepthMask(GL_FALSE);
  glEnable(GL_STENCIL_TEST);
  glStencilFunc(GL_ALWAYS, 0, 0);
  glStencilOp(GL_KEEP, GL_KEEP, GL_INCR);
  glCullFace(GL_BACK);
  b();                  /* increment the stencil where the front face of b is drawn */

  glStencilOp(GL_KEEP, GL_KEEP, GL_DECR);
  glCullFace(GL_FRONT);
  b();                  /* decrement the stencil buffer where the back face
                           of b is drawn */
  glDepthMask(GL_TRUE);
  glColorMask(GL_TRUE, GL_TRUE, GL_TRUE, GL_TRUE);

  glStencilFunc(test, 0, 1);
  glDisable(GL_DEPTH_TEST);

  glCullFace(face);
  a();                  /* draw the part of a that's in b */
}


<font color='orange'>void fixDepth(void (*a) (void))</font>
{
    glColorMask(GL_FALSE, GL_FALSE, GL_FALSE, GL_FALSE);
    glEnable(GL_DEPTH_TEST);
    glDisable(GL_STENCIL_TEST);
    glDepthFunc(GL_ALWAYS);
    a();                  /* draw the front face of a, fixing the depth buffer */
    glDepthFunc(GL_LESS);
}

/* "and" two objects together */
<font color='orange'>void and(void (*a) (void), void (*b) (void))</font>
{
    firstInsideSecond(a, b, GL_BACK, GL_NOTEQUAL);
    fixDepth(b);
    firstInsideSecond(b, a, GL_BACK, GL_NOTEQUAL);
    glDisable(GL_STENCIL_TEST);  /* reset things */
}

/* subtract b from a */
<font color='orange'>void sub(void (*a) (void), void (*b) (void))</font>
{
    firstInsideSecond(a, b, GL_FRONT, GL_NOTEQUAL);
    fixDepth(b);
    firstInsideSecond(b, a, GL_BACK, GL_EQUAL);
    glDisable(GL_STENCIL_TEST);  /* reset things */
}
&nbsp;
		</blockquote>

Sau đó tớ include file này vào trong file <font color='yellow'>main.cpp</font> để sử dụng các hàm trong file đó. Nội dụng trong file main.cpp như sau:

<blockquote>
#include "constructive.c"

class CMaSim 
{
public:
...
   void	   Subtract();
   void	   RenderCutter();
   void	   RenderObject();
...
}

void CMaSim::Subtract()
{
   <font color='yellow'>sub( RenderCutter, RenderObject); // &lt;----- bi ba'o loi</font>
}&nbsp;
		</blockquote>

Sau khi chạy thì bị báo lỗi ở dòng màu vàng trên với nội dung lỗi là

<blockquote><font color='orange'>error C2664: 'sub' : cannot convert parameter 1 from 'void (void)' to 'void (__cdecl *)(void)</font>&nbsp;
		</blockquote>

Giờ ko biết sửa thế nào đây, mong các bạn đưa ra giải pháp giúp đỡ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101525</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101525</link>
				<pubDate><![CDATA[Sun, 2 Dec 2007 01:53:41]]> GMT</pubDate>
				<author><![CDATA[ havythoai]]></author>
			</item>
			<item>
				<title>Function Pointer trong C++</title>
				<description><![CDATA[ Double posts, Mod nào xóa hộ tớ post này nhé]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101527</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101527</link>
				<pubDate><![CDATA[Sun, 2 Dec 2007 02:00:47]]> GMT</pubDate>
				<author><![CDATA[ havythoai]]></author>
			</item>
			<item>
				<title>Re: Function Pointer trong C++</title>
				<description><![CDATA[ Thực ra bạn đã nhầm lẫn giữa <b>pointer-to-member-function</b> và <b>pointer-to-function</b>. Pointer-to-member-function có dạng (lấy ví dụ của bạn nhé):
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>void RenderCutter&#40;CMaSim::*&#41;&#40;void&#41;</pre>
		</div>
là một thành phần non-static của class CMaSim. Trong khi đó, nếu RenderCutter là một function đơn lẻ, nó sẽ có dạng:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>void RenderCutter&#40;*&#41;&#40;void&#41;</pre>
		</div>
Với đoạn code trên mình có 2 cách sửa:
<ul><li>
[*](Thông dụng) Thêm một member static, giả sử:
<span class="quotetxt"><b>Code:</b></span></li><li>
		<div class="coded"">
		<pre>class CMaSim
{
    public:
    void Subtract&#40;&#41;;
	void RenderCutter&#40;&#41;;
    static void staticRenderCutter&#40;&#41; {
    }
	void RenderObject&#40;&#41;;
    static void staticRenderObject&#40;&#41; {
    }
};</pre>
		</div>
Lúc đó bạn gọi
<span class="quotetxt"><b>Code:</b></span></li><li>
		<div class="coded"">
		<pre>sub&#40;staticRenderCutter, staticRenderObject&#41;;</pre>
		</div>
như bình thường
[*](Dễ dùng hơn) Dùng wrapper function, như thế này chẳng hạn
<span class="quotetxt"><b>Code:</b></span></li><li>
		<div class="coded"">
		<pre>CMaSim *wrapperObj;

void wrapperRenderCutter&#40;&#41; {
	return wrapperObj-&gt;RenderObject&#40;&#41;;
}

void wrapperRenderObject&#40;&#41; {
	return wrapperObj-&gt;RenderObject&#40;&#41;;
}</pre>
		</div>
Lúc đó, bạn gọi:
<span class="quotetxt"><b>Code:</b></span></li><li>
		<div class="coded"">
		<pre>sub&#40; wrapperRenderCutter, wrapperRenderObject &#41;;</pre>
		</div>
là ổn
</li></ul>
Chúc bạn thành công.
P.S: Mod sửa lại thẻ list giùm mình với :(, sao BBCode nó không lên nhỉ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101537</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101537</link>
				<pubDate><![CDATA[Sun, 2 Dec 2007 03:02:11]]> GMT</pubDate>
				<author><![CDATA[ Thomas_Black]]></author>
			</item>
			<item>
				<title>Re: Function Pointer trong C++</title>
				<description><![CDATA[ Cám ơn bạn.

Tớ đã thử trường hợp dùng static nhưng chương trình của tớ khá đồ sộ. Vì bên trong hàm RenderCutter() còn có đủ thứ hàm khác như RenderCylinder() chẳng hạn, nếu ta cho RenderCutter() là static, thì trình duyệt báo lỗi là hàm RenderCylinder() cũng phải để static... dẫn đến 1 dãy các hàm static, và chương trình của tớ làm viec ko đúng.

Nếu dùng cách thứ 2 thì hàm wrapperRenderCutter() , và wrapperRenderObject() tớ chả biết khai báo trong Class nào :(. nếu để trống trơn như thế thì bị báo lỗi. Nếu khai báo trong 1 class nào đó thì sẽ quay trở lại lỗi ban đầu. Hiện tại tớ dùng complier Visual C++ 6.0, lập trình trên MFC, dùng giao diện SDI.

Tớ đã nghĩ ra cách giải quyết, ko pro, nghĩa là gom tất cả những gì của các hàm trong file constructive.c vào 1 hàm member của Class MaSim, và đã chạy được, chỉ bị lỗi hiển thị phần đồ hoạ OpenGL (đang tìm cách khắc phục)

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>void CMaSimView:Subtract&#40;&#41;
{
  glEnable&#40;GL_DEPTH_TEST&#41;;
  glColorMask&#40;GL_FALSE, GL_FALSE, GL_FALSE, GL_FALSE&#41;;
  glCullFace&#40;GL_FRONT&#41;;     /* controls which face of a to use */
  RenderCutter&#40;&#41;;                  /* draw a face of a into depth buffer */

  /* use stencil plane to find parts of a in b */
  glDepthMask&#40;GL_FALSE&#41;;
  glEnable&#40;GL_STENCIL_TEST&#41;;
  glStencilFunc&#40;GL_ALWAYS, 0, 0&#41;;
  glStencilOp&#40;GL_KEEP, GL_KEEP, GL_INCR&#41;;
  glCullFace&#40;GL_BACK&#41;;
  RenderObject&#40;&#41;;             /* increment the stencil where the front face of b is 
                           drawn */
  glStencilOp&#40;GL_KEEP, GL_KEEP, GL_DECR&#41;;
  glCullFace&#40;GL_FRONT&#41;;
  RenderObject&#40;&#41;;             /* decrement the stencil buffer where the back face of b is drawn */

  glDepthMask&#40;GL_TRUE&#41;;
  glColorMask&#40;GL_TRUE, GL_TRUE, GL_TRUE, GL_TRUE&#41;;

  glStencilFunc&#40;GL_NOTEQUAL, 0, 1&#41;;
  glDisable&#40;GL_DEPTH_TEST&#41;;

  glCullFace&#40;GL_FRONT&#41;;
 RenderCutter&#40;&#41;;

  ////////////////////
  glColorMask&#40;GL_FALSE, GL_FALSE, GL_FALSE, GL_FALSE&#41;;
  glEnable&#40;GL_DEPTH_TEST&#41;;
  glDisable&#40;GL_STENCIL_TEST&#41;;
  glDepthFunc&#40;GL_ALWAYS&#41;;
  RenderObject&#40;&#41;;                  /* draw the front face of a, fixing the depth buffer */
  glDepthFunc&#40;GL_LESS&#41;;
  /////////////////

  glEnable&#40;GL_DEPTH_TEST&#41;;
  glColorMask&#40;GL_FALSE, GL_FALSE, GL_FALSE, GL_FALSE&#41;;
  glCullFace&#40;GL_BACK&#41;;     /* controls which face of a to use */
  RenderObject&#40;&#41;;                  /* draw a face of a into depth buffer */

  /* use stencil plane to find parts of a in b */
  glDepthMask&#40;GL_FALSE&#41;;
  glEnable&#40;GL_STENCIL_TEST&#41;;
  glStencilFunc&#40;GL_ALWAYS, 0, 0&#41;;
  glStencilOp&#40;GL_KEEP, GL_KEEP, GL_INCR&#41;;
  glCullFace&#40;GL_BACK&#41;;
  RenderCutter&#40;&#41;;                  /* increment the stencil where the front face of b is 
                           drawn */
  glStencilOp&#40;GL_KEEP, GL_KEEP, GL_DECR&#41;;
  glCullFace&#40;GL_FRONT&#41;;
  RenderCutter&#40;&#41;;                  /* decrement the stencil buffer where the back face
                           of b is drawn */
  glDepthMask&#40;GL_TRUE&#41;;
  glColorMask&#40;GL_TRUE, GL_TRUE, GL_TRUE, GL_TRUE&#41;;

  glStencilFunc&#40;GL_EQUAL, 0, 1&#41;;
  glDisable&#40;GL_DEPTH_TEST&#41;;

  glCullFace&#40;GL_BACK&#41;;
 RenderObject&#40;&#41;;

  glDisable&#40;GL_STENCIL_TEST&#41;;
}</pre>
		</div>
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101842</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/16903.hva#101842</link>
				<pubDate><![CDATA[Tue, 4 Dec 2007 01:54:26]]> GMT</pubDate>
				<author><![CDATA[ havythoai]]></author>
			</item>
	</channel>
</rss>
