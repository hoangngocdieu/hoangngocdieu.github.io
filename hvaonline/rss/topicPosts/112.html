<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Ký sự các vụ DDoS đến HVA - Phần 1"]]></title>
		<link>/hvaonline/posts/list/8.html</link>
		<description><![CDATA[Latest messages posted in the topic "Ký sự các vụ DDoS đến HVA - Phần 1"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Ký sự các vụ DDoS đến HVA - Phần 1</title>
				<description><![CDATA[ <b>Dấu hiệu</b>
Mấy tuần lễ gần đây, đột nhiên lượng tải trên máy chủ HVA tăng vọt trong khi số lượng thành viên chính thức truy nhập diễn đàn vẫn ở mức bình thường. DoS? hay DDoS? Lượng tải này tăng vọt khá đều đặn vài giờ trong mỗi ngày. Lượng thành viên gia tăng nên có quá nhiều người cùng truy cập? không phải. HVA đang có đề tài gì hấp dẫn nên thiên hạ ùn ùn kéo vào? cũng không phải.

<b>Dấu vết</b>
Tôi nhận công tác điều tra và xử lý tình trạng bất bình thường này, trong đầu đã phần nào đoán sự thể do DoS. Khuya ngày 10 tháng 10, tôi log vào server của HVA và tạo ra vài console, mở ra vài cái đuôi <font color='orange'>-1-</font>, làm một ấm trà và ngồi đó nhâm nhi... một mình. Không cần phải đợi lâu, hàng loạt thông tin từ log của web server hiện lên màn hình với một số chi tiết rất lý thú:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
211.199.192.157 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; iebar&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; FunWebProducts&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; FunWebProducts&#41;"
80.170.198.46 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1617 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 1.0.3705&#41;"
81.66.147.0 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1615 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322&#41;"
211.199.192.157 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; iebar&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1614 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows 98&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
24.17.150.114 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1504 "-" "Mozilla/5.0 &#40;Windows; U; Windows NT 5.1; en-US; rv:1.7&#41; Gecko/20040803 Firefox/0.9.3"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1614 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows 98&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; FunWebProducts&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; FunWebProducts&#41;"
81.66.147.0 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1615 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
80.170.198.46 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1617 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 1.0.3705&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1614 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows 98&#41;"
211.199.192.157 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; iebar&#41;"
211.199.192.157 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; iebar&#41;"
24.17.150.114 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1504 "-" "Mozilla/5.0 &#40;Windows; U; Windows NT 5.1; en-US; rv:1.7&#41; Gecko/20040803 Firefox/0.9.3"
81.66.147.0 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1615 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1614 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows 98&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
80.170.198.46 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1617 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 1.0.3705&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; FunWebProducts&#41;"
211.199.192.157 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; iebar&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
211.199.192.157 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; iebar&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1619 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; FunWebProducts&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
203.162.3.148 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1614 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows 98&#41;"
81.66.147.0 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.1" 200 1615 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322&#41;"
210.245.31.246 - - &#91;10/Oct/2004:06:57:19 -0400&#93; "POST /forum/ HTTP/1.0" 200 1618 "-" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.0&#41;"
24.17.150.114 - - &#91;10/Oct/2004:06:57:20 -0400&#93; "POST /forum/ HTTP/1.1" 200 1504 "-" "Mozilla/5.0 &#40;Windows; U; Windows NT 5.1; en-US; rv:1.7&#41; Gecko/20040803 Firefox/0.9.3"</pre>
		</div>
Chà, chẳng lẽ thành viên "hối hả" kéo vào diễn đàn và "POST" bài nhiều đến vậy sao? hai mươi lăm cái "POST" trong một giây từ một vài IP? Cứ cho là hợp lệ vì thành viên ở VN đi ra Internet, qua cùng một cửa ngõ <font color='orange'>-2-</font> là chuyện bình thường. Nhưng, hẵng đã, vừa rồi lại có một chùm đến hơn năm mươi cái "POST" đi đến trong một giây, cũng từ các IP như trên. Bất thường hay bất tường?

Tôi để yên mấy "cái đuôi" chạy trên mấy console và mở trình duyệt của mình lên, thử log vào HVA bằng nickname và password của tôi để xem thử "thái độ" POST từ máy của tôi có tương tự như những cái POST tôi nhận được vài chục giây trước đây (xác thực là bạn của nghề phân tích). Cha chả, cái POST của tôi nhìn hợp lệ hơn nhiều:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>xxx.xx.xxx.98 - - &#91;10/Oct/2004:07:11:25 +0900&#93; "POST /forum/act_Login_CODE_01.html HTTP/1.0" 200 7405 "/forum/act_Login_CODE_00.html" "Mozilla/5.0 &#40;X11; U; Linux i686; en-US; rv:1.6&#41; Gecko/20040510"</pre>
		</div>
Tôi thử mở "cái đuôi" của firewall log trên server xem có gì hấp dẫn không. Chà, log của web server vẫn "POST" vào ầm ầm nhưng firewall log thì vẫn im ắng như đỉnh Himalaya. Thôi rồi, chắc đây là một "kiểu chơi" rất hợp lệ nên firewall cho phép chúng vào thả cửa. Tôi gởi nhanh một PM đến JAL, nhờ lão phóng cái sniffer lên để "hít" <font color='orange'>-3-</font> một ít gói tin và lưu lại một nơi thích hợp dùm tôi. Đêm đã khuya, tôi phải đi ngủ để mai còn đi làm. Sáng mai sẽ copy mớ gói tin đã được lưu và sẽ phân tích xem sự thể ra sao.

<b>Phân tích</b>

<b>Ngày 11/10</b>
Trên tàu lửa đến sở làm, tôi hăm hở mở laptop ra và bắt tay vào xem xét thông tin "bắt" được tối hôm qua. Chuyện đầu tiên đập vào mắt tôi là kích thước hồ sơ đã sniff, chà, sao nó bé tí tẹo vậy nhỉ? Sáng nay lúc tôi log vào HVA server để copy hồ sơ này, tôi đã không để ý đến kích thước (vì cứ nghĩ nó phải ít nhất là vài megabytes), tôi chỉ chạy lệnh scp và bỏ đó rồi đi thay đồ đi làm. Lúc này mới nhận ra là nó bé tí tẹo, không biết có gì trong này.

Tôi dùng Ethereal mở hồ sơ này ra, và.... đúng như dự phỏng, Ethereal phàn nàn "stream not completed". Tôi bật cười và tự nhủ: "chà, chắc lão JAL sợ nó sniff lâu quá thành một hồ sơ khổng tượng nên chỉ sniff một, hai giây rồi tắt liền". Thông tin "bắt" được từ sniffer quá ít, chỉ vỏn vẹn hơn mười dòng, trong đó có được một cái SYN <font color='orange'>-4-</font>, một cái ACK,PSH từ một segment khác, một cái HTTP (POST) cộng thêm vài cái "continuation" từ các segment trước và sau cái SYN ở trên không thấy gì đi theo.

Xếp laptop lại, tôi trầm ngâm vài phút, có vài chi tiết cần xem lại trong mớ packets ngắn ngủi mà lão JAL đã cung cấp. Tôi lại mở laptop ra và đi xuyên qua mười mấy mảnh packets rời rạc. Không thể "gom" các packets này thành một stream hoàn chỉnh, tôi đành xem xét từng mảnh một lần nữa. Điểm lý thú đập ngay vào mắt tôi khi dò đến http packet chứa mảng đầu của phần "POST". Cha chả, POST cái gì mà lắm thế? 
- payload <font color='orange'>-5-</font> của "POST" có đến 2205 bytes?
- đoạn đầu của mảnh "POST" này có thông tin:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>hotlinks=Offical%2Ecom&comdoss=attack&port=80&url1=http%3A%2F%2Fhvaonline%2Enet%3A80&url2=http%3A%2F%2Fhvaonline%2Enet%3A80%2Fforum%2F&http%3A%2F%2Fwww%2Exxx%2Ecom%2FForum%2Findex%2Ephp=&act=Reg&CODE=02&coppa%5Fuser=0&PassWo</pre>
		</div>
Lý thú nhỉ, lý thú nhưng cũng chưa có gì rõ ràng cho lắm. Tôi hơi ngạc nhiên là tại sao mấy lão trên HVA lại để yên những http header và payload có dính ngổn ngang các "chú" ampersand -6-. Có lẽ mấy lão cho phép vì đây là phần cần thiết cho forum? Tôi chưa nắm được bao nhiêu các phần tố ngổn ngang giữa "Invision Board" và web server đứng trước, cái này phải điều tra kỹ mới được. 

Thiếu các mảnh tiếp theo của đoạn POST trên, tôi đành thở dài và dừng lại vì chẳng đi tới đâu. Thôi vậy, đành phải sniff lại vì mớ thông tin này chẳng giúp được bao nhiêu. 

<b>Chú thích:</b>
<font color='orange'>-1-</font> "tail", một lệnh dùng để liên tục chuyển thông tin của log lên console để theo dõi.
<font color='orange'>-2-</font> "gateway", cửa ngõ đi ra / đi vào giữa 2 network.
<font color='orange'>-3-</font> "sniff", động tác hít nói theo tính sinh hoá, động tác "bắt lấy" các gói tin đi xuyên qua đường dẫn nói theo tinh thần điện toán.
<font color='orange'>-4-</font> "SYN, ACK, PSH...." là các tcp flags được dùng trong giao thức TCP.
<font color='orange'>-5-</font> payload là dữ liệu trong gói tin (nói trên bình diện "mạng").
<font color='orange'>-6-</font> ampersand (&) là dấu "và" trên keyboard. 
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/112.html#429</guid>
				<link>/hvaonline/posts/list/112.html#429</link>
				<pubDate><![CDATA[Sat, 17 Jun 2006 06:12:53]]> GMT</pubDate>
				<author><![CDATA[ prof]]></author>
			</item>
			<item>
				<title>Ký sự các vụ DDoS đến HVA - Phần 1</title>
				<description><![CDATA[ Các bài viết tiếp theo:

<span class="link"> /hvaonline/posts/list/176.html</span>
<span class="link"> /hvaonline/posts/list/177.html</span>
<span class="link"> /hvaonline/posts/list/178.html</span>
<span class="link"> /hvaonline/posts/list/179.html</span>
<span class="link"> /hvaonline/posts/list/180.html</span>
<span class="link"> /hvaonline/posts/list/181.html</span>
<span class="link"> /hvaonline/posts/list/182.html</span>
<span class="link"> /hvaonline/posts/list/209.html</span>
<span class="link"> /hvaonline/posts/list/211.html</span>
<span class="link"> /hvaonline/posts/list/212.html</span>
<span class="link"> /hvaonline/posts/list/213.html</span>
<span class="link"> /hvaonline/posts/list/280.html</span>
<span class="link"> /hvaonline/posts/list/286.html</span>
<span class="link"> /hvaonline/posts/list/294.html</span>
<span class="link"> /hvaonline/posts/list/320.html</span>
<span class="link"> /hvaonline/posts/list/506.html</span>
<span class="link"> /hvaonline/posts/list/508.html</span>
<span class="link"> /hvaonline/posts/list/510.html</span>
<span class="link"> /hvaonline/posts/list/511.html</span>
<span class="link"> /hvaonline/posts/list/512.html</span>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/112.html#9342</guid>
				<link>/hvaonline/posts/list/112.html#9342</link>
				<pubDate><![CDATA[Sun, 23 Jul 2006 14:11:21]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
	</channel>
</rss>
