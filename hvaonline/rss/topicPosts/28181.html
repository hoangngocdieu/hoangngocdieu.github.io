<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Hỏi về câu lệnh CHARINDEX với unicode trong SQL Server 2005"]]></title>
		<link>/hvaonline/posts/list/23.html</link>
		<description><![CDATA[Latest messages posted in the topic "Hỏi về câu lệnh CHARINDEX với unicode trong SQL Server 2005"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Hỏi về câu lệnh CHARINDEX với unicode trong SQL Server 2005</title>
				<description><![CDATA[ Chào các anh! 

Em đang học lập trình cho SQL Server 2005

Khi em gõ đoạn code sau đây, thì kết quả không đúng như mong đợi, em đã thử nhiều cách để khác phục nhưng không sao gỡ được. Mong các anh chỉ giúp!

<font size='+1'><b>declare @bien nvarchar(30)
set @bien = 'Nguyễn'
SELECT CHARINDEX  (@bien,Name)
FROM Patients</b></font>

Bảng Patients của em như sau:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>PID         Name           Tel            .......
                  1     Hoàng Văn Bình     0001
                  2     Lê Văn Minh       0002
                  3     Nguyễn Thị Hoa       .
                  4     Trần Lê Vũ           .
                  5     Bùi Văn Tình         .
                  6     Ngô Lê Trà
                  7     Dương Thị Thanh
                  8     Lưu Minh Sơn
                  9     Nguyễn Vinh Khánh
                 10     Phan Nam Văn
                  .     Ngô Tuyết Hương
                  .     Bùi Trần Thu Thảo
                  .     Lê Vũ Thiên Nam
                        Nguyễn Thị Bé
                        Trần Linh Lê
                        Hoàng Thị Thùy
                        Trần Minh Bính
                        Nguyễn Bình A
                        Hà Ngô Ái
                        Tăng Thu Thắm
                        Nguyễn Bình Minh
                        Phan Vi Na
                 23     Vu Viet Lam</pre>
		</div>

Trường Name của em có kiểu là nvarchar(120)

Sau khi thực hiện thì kết quả nhận được là 23 dòng toàn số 0 ! (Điều này rõ ràng không đúng ví dụ với dòng thứ 3 Nguyễn Thị Hoa)

Vậy em mong các anh chỉ giúp để làm sao thu được kết quả đúng! (chú ý là em muốn từ "Nguyễn" phải được đặt trong biến @bien)
Em xin cảm ơn!
<ul><li></li></ul>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/28181.html#173225</guid>
				<link>/hvaonline/posts/list/28181.html#173225</link>
				<pubDate><![CDATA[Sat, 14 Mar 2009 17:08:05]]> GMT</pubDate>
				<author><![CDATA[ anoperson]]></author>
			</item>
			<item>
				<title>Re: Hỏi về câu lệnh CHARINDEX với unicode trong SQL Server 2005</title>
				<description><![CDATA[ Thử dùng PATINDEX xem sao?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/28181.html#174502</guid>
				<link>/hvaonline/posts/list/28181.html#174502</link>
				<pubDate><![CDATA[Tue, 24 Mar 2009 11:24:39]]> GMT</pubDate>
				<author><![CDATA[ qtra004]]></author>
			</item>
			<item>
				<title>Re: Hỏi về câu lệnh CHARINDEX với unicode trong SQL Server 2005</title>
				<description><![CDATA[ @anoperson: Mình thử đoạn code của bạn không có gì sai cả ( mình update lên sql server 2005 sp3 rồi) nếu bạn chưa update lên thì thêm chữ N phía trước 'Nguyễn', như thế này nè set @bien = N'Nguyễn'. Cái này mình đã test thử với 1 pc khác cài sql server 2005 sp1.
Máy mình thì 2 câu lệnh này:
select * from NhanVien
where TenNV like '%ương%'

select * from NhanVien
where TenNV like N'%ương%'

đều cho kết quả giống nhau, còn pc kia thì chỉ có câu lệnh dưới là ra kết quả câu lệnh trên không ra. Cái này cũng là do mình suy đoán thôi vì mình cũng đang học sql server. Nếu ai chuyên về cái này thì xem lai hộ xem có đúng như vậy không :D. Cám ơn nhiều.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/28181.html#174552</guid>
				<link>/hvaonline/posts/list/28181.html#174552</link>
				<pubDate><![CDATA[Tue, 24 Mar 2009 16:57:14]]> GMT</pubDate>
				<author><![CDATA[ Destiny3986]]></author>
			</item>
	</channel>
</rss>
