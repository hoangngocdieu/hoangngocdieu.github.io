<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Giải quyết cái crackme này sau nhỉ"]]></title>
		<link>/hvaonline/posts/list/36.html</link>
		<description><![CDATA[Latest messages posted in the topic "Giải quyết cái crackme này sau nhỉ"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Giải quyết cái crackme này sau nhỉ</title>
				<description><![CDATA[ Em có lấy dc cái crackme này nhưng em không thể giải quyết nó mấy anh em giải quyết và chỉ dẫn cụ thể dùm em nha

Link đây nè anh em ơi: http://www.mediafire.com/download.php?oddjntv0zz3]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/31117.html#191917</guid>
				<link>/hvaonline/posts/list/31117.html#191917</link>
				<pubDate><![CDATA[Thu, 3 Sep 2009 21:50:49]]> GMT</pubDate>
				<author><![CDATA[ langtustyle]]></author>
			</item>
			<item>
				<title>Thêm một cái nữa nè</title>
				<description><![CDATA[ http://www.mediafire.com/download.php?admn24wwczx]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/31117.html#191928</guid>
				<link>/hvaonline/posts/list/31117.html#191928</link>
				<pubDate><![CDATA[Thu, 3 Sep 2009 23:23:47]]> GMT</pubDate>
				<author><![CDATA[ langtustyle]]></author>
			</item>
			<item>
				<title>Giải quyết cái crackme này sau nhỉ</title>
				<description><![CDATA[ Tui đã giai quyết xong cái tut một cho bạn rui nè.Tui cũng vừa mới nghiên crack như bạn vì có học asm loại căn bản thui nên cũng hiểu được sơ sơ.

đầu tiên bạn nhập vào một vài kí tự sau đó ok thử thì nó báo dòng badboy tức là bạn đã nhập sai serial rùi .Bạn ghi lại dòng này rùi nhấp phải của sổ CPU&gt;search for&gt;All referenced text string&gt;rùi tìm dòng tẽt hiện ra khi bạn nhập sai và double click vào nó sẽ nhảy đến hàm API mesagebox báo nhập saỉeial ở trên:

/*4011DB*/ PUSH 10
/*4011DD*/ PUSH hackereh.00403068
/*4011E2*/ PUSH hackereh.00403045
/*4011E7*/ PUSH DWORD PTR SS:[EBP+8]
/*4011EA*/ CALL &lt;JMP.&user32.MessageBoxA&gt;

để ý 2 hàm mesagebox phía dưới đọc nội dung ta thấy nó se báo :
nhập serial thành công

/*4011F1*/ PUSH 40
/*4011F3*/ PUSH hackereh.00403068
/*4011F8*/ PUSH hackereh.0040301E
/*4011FD*/ PUSH DWORD PTR SS:[EBP+8]
/*401200*/ CALL &lt;JMP.&user32.MessageBoxA&gt;

và báo bạn nhập không đủ char

/*401207*/ PUSH 30
/*401209*/ PUSH hackereh.00403068
/*40120E*/ PUSH hackereh.00403000
/*401213*/ PUSH DWORD PTR SS:[EBP+8]

Tiếp theo ta sẽ làm gì? Ta sẽ tìm đến lệnh nhảy gọi hàm này.nhấp vào dòng đầu của hàm messagebox báo sai serial sau đó bấm CTR+R chọn dòng dia chì dầu ta sẽ đến

/*40118F*/ MOV EDI,hackereh.00403138//địa chỉ chuỗi kí tự ta nhập vào
/*401194*/ MOVSX EAX,BYTE PTR DS:[EDI]//lấy kí tự đầu tiên của chuỗi
/*401197*/ AND AL,0AD//thực hiện phép logic and với 0AD
/*401199*/ JNZ SHORT hackereh.004011DB//nhảy nếu khác 0(co zero=0)

Từ đây ta suy luận được để không nhảy đến msg sai sẻial thì AND AL,0AD =0.
có nghĩa là AL phải là not 0AD(dùng máy tính để bấm) sau đó ra được mã ASCII của kí tự 52 tức là chữ R. làm tương tự cho các dòng sau

/*40119B*/ MOVSX EAX,BYTE PTR DS:[EDI+1]
/*40119F*/ AND AL,9A
/*4011A1*/ JNZ SHORT hackereh.004011DB
/*4011A3*/ MOVSX EAX,BYTE PTR DS:[EDI+2]
/*4011A7*/ AND AL,97
/*4011A9*/ JNZ SHORT hackereh.004011DB
/*4011AB*/ MOVSX EAX,BYTE PTR DS:[EDI+3]
/*4011AF*/ AND AL,0BF
/*4011B1*/ JNZ SHORT hackereh.004011DB
/*4011B3*/ MOVSX EAX,BYTE PTR DS:[EDI+4]
/*4011B7*/ AND EAX,5FC5
/*4011BC*/ JNZ SHORT hackereh.004011DB
/*4011BE*/ MOVSX EAX,BYTE PTR DS:[EDI+5]
/*4011C2*/ AND EAX,0D6
/*4011C7*/ JNZ SHORT hackereh.004011DB

Lưu ý AND EAX,5FC5.Phía trên là MOVSX EAX,BYTE PTR DS:[EDI+4] lấy một kí tự đưa vào AL của EAX,các byte còn lại của EAX=0.nên lênh AND EAX,5FC5 ta chỉ quan tâm byte thấp C5 thui (nó dùng code này để lừa chúng ta) các byte còn lại không quan tâm vì 1hay0 and với 0 cũng bằng 0.

làm tương tự với các dòng tiếp theo đến đoạn so sánh nhảy đến msg báo sr sai cuối thì thấy nó chỉ so sánh với thanh ghi ecx

/*4011C9*/  CMP ECX,6
/*4011CC*/  JNZ SHORT hackereh.004011DB

nhiệm vụ của nó là gi ?
kéo lên phía trên xem lệnh mov vào ecx ta thấy MOV ECX,EAX
phía trên nữa là hàm GetDlgItemText có thể dò trong msdn hàm này.Ta thấy hàm này có giá trị trả về UINT(4byte) thường nó sẽ lưu trong EAX hay AL
/*401171*/  PUSH 1E
/*401173*/  PUSH hackereh.00403138
/*401178*/  PUSH 3E9
/*40117D*/  PUSH DWORD PTR SS:[EBP+8]
/*401180*/  CALL &lt;JMP.&user32.GetDlgItemTextA&gt;

/*401185*/  TEST AL,AL
/*401187*/  JE SHORT hackereh.00401207
/*401189*/  MOV ECX,EAX

giờ ta đã hiểu 
/*4011C9*/  CMP ECX,6
/*4011CC*/  JNZ SHORT hackereh.004011DB
kiểm tra kí tự nhập vào có đủ 6 ko.

Kết quả sẻial cuối cùng tìm được là: 
Reh@:)


]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/31117.html#194552</guid>
				<link>/hvaonline/posts/list/31117.html#194552</link>
				<pubDate><![CDATA[Thu, 1 Oct 2009 05:16:46]]> GMT</pubDate>
				<author><![CDATA[ quangthiennguyen]]></author>
			</item>
			<item>
				<title>Giải quyết cái crackme này sau nhỉ</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quangthiennguyen wrote:</cite><br>
		<blockquote>
....
&nbsp;
		</blockquote>
 B-)
Trời ơi, nhìn vào muốn loạn thị với đống code asm đó luôn.  :-)]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/31117.html#194941</guid>
				<link>/hvaonline/posts/list/31117.html#194941</link>
				<pubDate><![CDATA[Tue, 6 Oct 2009 21:45:42]]> GMT</pubDate>
				<author><![CDATA[ spin]]></author>
			</item>
	</channel>
</rss>
