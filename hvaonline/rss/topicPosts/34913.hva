<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "CentOS 5.3: kernel: Xploit 21956: segfault at"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/24.hva</link>
		<description><![CDATA[Latest messages posted in the topic "CentOS 5.3: kernel: Xploit 21956: segfault at"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ Chào các bạn,

Sáng nay OSSEC báo về trong /var/log/messages xuất hiện hàng loạt thông tin:

<blockquote>Jul  1 10:51:09 xx kernel: Xploit[21956]: segfault at 0000000000000000 rip 00000000080a7f53 rsp 00000000ffef5a8c error 4&nbsp;
		</blockquote>
Tần suất xuất hiện là 1 phút khoảng trên dưới 10 lần.

Vấn đề là mình không biết Xploit là thằng nào. Các bạn có gợi ý nào thì giúp mình với.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214379</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214379</link>
				<pubDate><![CDATA[Wed, 30 Jun 2010 23:10:54]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Chào các bạn,

Sáng nay OSSEC báo về trong /var/log/messages xuất hiện hàng loạt thông tin:

<blockquote>Jul  1 10:51:09 xx kernel: Xploit[21956]: segfault at 0000000000000000 rip 00000000080a7f53 rsp 00000000ffef5a8c error 4&nbsp;
		</blockquote>
Tần suất xuất hiện là 1 phút khoảng trên dưới 10 lần.

Vấn đề là mình không biết Xploit là thằng nào. Các bạn có gợi ý nào thì giúp mình với.&nbsp;
		</blockquote>

Kernel trên hệ thống này có phiên bản mấy em?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214384</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214384</link>
				<pubDate><![CDATA[Wed, 30 Jun 2010 23:34:56]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ 2.6.18-128 anh ạ.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214385</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214385</link>
				<pubDate><![CDATA[Wed, 30 Jun 2010 23:37:16]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>2.6.18-128 anh ạ.&nbsp;
		</blockquote>

Em thử:
<b>echo 0 &gt; /proc/sys/kernel/randomize_va_space</b>

và theo dõi xem hiện tượng trên còn xảy ra không?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214387</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214387</link>
				<pubDate><![CDATA[Wed, 30 Jun 2010 23:39:37]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>

Em thử:
<b>echo 0 &gt; /proc/sys/kernel/randomize_va_space</b>

và theo dõi xem hiện tượng trên còn xảy ra không?&nbsp;
		</blockquote>
Turn off randomization in memory allocator theo anh gợi ý nhưng tình hình không thuyên giảm anh à:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># cat /proc/sys/kernel/randomize_va_space 
0

# grep "Jul  1 11:5&#91;1-5&#93;:.. xx kernel: Xploit" /var/log/messages | wc -l
36</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214389</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214389</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 00:02:23]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>

Em thử:
<b>echo 0 &gt; /proc/sys/kernel/randomize_va_space</b>

và theo dõi xem hiện tượng trên còn xảy ra không?&nbsp;
		</blockquote>
Turn off randomization in memory allocator theo anh gợi ý nhưng tình hình không thuyên giảm anh à:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># cat /proc/sys/kernel/randomize_va_space 
0

# grep "Jul  1 11:5&#91;1-5&#93;:.. xx kernel: Xploit" /var/log/messages | wc -l
36</pre>
		</div>&nbsp;
		</blockquote>

Em có thể tạm thời offline máy đó khỏi network được không? Nếu được, thử rút network cable ra và xem thử tình trạng trên còn xảy ra không?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214391</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214391</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 00:05:52]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>
Em có thể tạm thời offline máy đó khỏi network được không? Nếu được, thử rút network cable ra và xem thử tình trạng trên còn xảy ra không?&nbsp;
		</blockquote>
Việc này tạm thời em chưa thực hiện ngay được, anh còn gợi ý nào khác không ạ?
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214392</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214392</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 00:18:37]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>
Em có thể tạm thời offline máy đó khỏi network được không? Nếu được, thử rút network cable ra và xem thử tình trạng trên còn xảy ra không?&nbsp;
		</blockquote>
Việc này tạm thời em chưa thực hiện ngay được, anh còn gợi ý nào khác không ạ?
&nbsp;
		</blockquote>

Thông tin em cho quá ít nên khó xác định được nguồn gốc từ đâu. Anh nghĩ nó đụng tới memory nhưng để giúp thu hẹp biên độ, anh đề nghị ngắt server ấy khỏi mạng xem thử nó còn bị hay không. Nếu nó hết bị, chắc chắn một daemon nào đó liên quan đến mạng có lỗi. Nếu nó còn bị, chắn chắn nguồn gốc của segfault này không liên quan đến mạng. 

Một cách detect khác là set ulimit -c để cho phép tạo core dump rồi analyse core dump thì mới biết chính xác nguồn cơn. Segfault đột nhiên xảy ra thường do hệ thống vừa cập nhật cái gì đó (thư viện, binaries...) và cập nhật này tạo lỗi và cách chính xác nhất là cho phép kernel tạo core dump để phân tích thôi em (vì khó biết được daemon nào gây sự cố).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214398</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214398</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 00:54:07]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ Tạm thời em đã xác định được do thằng nagios plugin gây ra:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># ps -u nagios
  PID TTY          TIME CMD
  18176 ?        00:00:01 Xploit</pre>
		</div>
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214415</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214415</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 06:00:36]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Tạm thời em đã xác định được do thằng nagios plugin gây ra:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># ps -u nagios
  PID TTY          TIME CMD
  18176 ?        00:00:01 Xploit</pre>
		</div>
&nbsp;
		</blockquote>

Hè hè... coi thử nagios chạy phiên bản nào, có thể bị lỗi gì. Anh không hiểu sao lúc chiều em nói không hề thấy có process nào có "Xploit" hết.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214416</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214416</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 06:33:42]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Anh không hiểu sao lúc chiều em nói không hề thấy có process nào có "Xploit" hết.&nbsp;
		</blockquote>
Em có nói dối anh đâu:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># ps -ef | grep Xploit
root      1371  1292  0 08:40 pts/0    00:00:00 grep Xploit

# ps -ef | grep nagios
nagios     635 15071  0 08:11 ?        00:00:00 /bin/bash ./a xx.xx
nagios     680   635  0 08:16 ?        00:00:00 /usr/sbin/sshd
nagios     684   680  0 08:16 ?        00:00:00 /usr/sbin/sshd
nagios     689   680  0 08:16 ?        00:00:03 /usr/sbin/sshd
nagios     692   680  0 08:16 ?        00:00:03 /usr/sbin/sshd
nagios     693   680  0 08:16 ?        00:00:03 /usr/sbin/sshd
...
nagios   10713     1  0 Jul01 ?        00:00:00 nrpe -c /usr/local/nagios/etc/nrpe.cfg -d
nagios   15071     1  0 00:13 ?        00:00:00 /bin/sh ./mass 220

# ps -u nagios
  PID TTY          TIME CMD
  635 ?        00:00:00 a
  680 ?        00:00:00 Xploit
  684 ?        00:00:01 Xploit
  689 ?        00:00:03 Xploit
  692 ?        00:00:04 Xploit
  693 ?        00:00:03 Xploit
...
10713 ?        00:00:00 nrpe
15071 ?        00:00:00 sh

# ps -u nagios | wc -l
236</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214454</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214454</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 20:46:41]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Anh không hiểu sao lúc chiều em nói không hề thấy có process nào có "Xploit" hết.&nbsp;
		</blockquote>
Em có nói dối anh đâu:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># ps -ef | grep Xploit
root      1371  1292  0 08:40 pts/0    00:00:00 grep Xploit

# ps -ef | grep nagios
nagios     635 15071  0 08:11 ?        00:00:00 /bin/bash ./a xx.xx
nagios     680   635  0 08:16 ?        00:00:00 /usr/sbin/sshd
nagios     684   680  0 08:16 ?        00:00:00 /usr/sbin/sshd
nagios     689   680  0 08:16 ?        00:00:03 /usr/sbin/sshd
nagios     692   680  0 08:16 ?        00:00:03 /usr/sbin/sshd
nagios     693   680  0 08:16 ?        00:00:03 /usr/sbin/sshd
...
nagios   10713     1  0 Jul01 ?        00:00:00 nrpe -c /usr/local/nagios/etc/nrpe.cfg -d
nagios   15071     1  0 00:13 ?        00:00:00 /bin/sh ./mass 220

# ps -u nagios
  PID TTY          TIME CMD
  635 ?        00:00:00 a
  680 ?        00:00:00 Xploit
  684 ?        00:00:01 Xploit
  689 ?        00:00:03 Xploit
  692 ?        00:00:04 Xploit
  693 ?        00:00:03 Xploit
...
10713 ?        00:00:00 nrpe
15071 ?        00:00:00 sh

# ps -u nagios | wc -l
236</pre>
		</div>&nbsp;
		</blockquote>

Hì hì, anh đâu có bảo em "nói dối" đâu  :P . Ý anh là phương pháp test ps để tìm process "Xploit" của mình (em và anh) chưa được thấu đáo. Chính anh cũng không nghĩ đến option <b>ps -u</b> mặc dù cả hai anh em mình đều biết chắc rằng process ấy không spawn được và bị segfault. ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214478</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214478</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 22:15:38]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ Em vẫn chưa biết tại sao lại có nhiều processes sshd owned bởi nagios kết nối đi lung tung đến thế:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># netstat -natp | grep sshd | awk '{print $5}' | sort | uniq -c | sort -rn
      1 220.231.4.177:22
      1 220.229.32.38:22
      1 220.228.163.199:22
      1 220.228.160.232:22
      1 220.227.99.217:22
      1 220.227.99.195:22
      1 220.227.95.69:22
      1 220.227.95.125:22
      1 220.227.90.238:22
      1 220.227.89.225:22
      1 220.227.75.221:22
      1 220.227.75.125:22
      1 220.227.72.234:22
      1 220.227.67.237:22
      1 220.227.62.250:22
      1 220.227.62.230:22
      1 220.227.61.77:22
      1 220.227.56.66:22
      1 220.227.56.179:22
      1 220.227.55.17:22
      1 220.227.53.61:22
      1 220.227.43.157:22
      1 220.227.41.228:22
      1 220.227.40.18:22
      1 220.227.37.187:22
      1 220.227.35.142:22
      1 220.227.31.105:22
      1 220.227.255.1:22
      1 220.227.254.74:22
      1 220.227.254.58:22
      1 220.227.254.134:22
      1 220.227.253.93:22
      1 220.227.253.169:22
      1 220.227.253.109:22
      1 220.227.252.250:22
      1 220.227.252.110:22
      1 220.227.25.162:22
      1 220.227.251.116:22
      1 220.227.251.101:22
      1 220.227.250.254:22
      1 220.227.250.114:22
      1 220.227.249.1:22
      1 220.227.247.225:22
      1 220.227.245.201:22
      1 220.227.242.42:22
      1 220.227.242.218:22
      1 220.227.242.158:22
      1 220.227.242.146:22
      1 220.227.241.21:22
      1 220.227.240.92:22
      1 220.227.240.91:22
      1 220.227.240.84:22
      1 220.227.240.72:22
      1 220.227.240.174:22
      1 220.227.240.162:22
      1 220.227.238.54:22
      1 220.227.238.27:22
      1 220.227.238.26:22
      1 220.227.237.241:22
      1 220.227.237.213:22
      1 220.227.237.133:22
      1 220.227.236.164:22
      1 220.227.235.163:22
      1 220.227.235.149:22
      1 220.227.235.145:22
      1 220.227.235.129:22
      1 220.227.219.78:22
      1 220.227.219.4:22
      1 220.227.219.110:22
      1 220.227.218.8:22
      1 220.227.218.3:22
      1 220.227.213.98:22
      1 220.227.213.50:22
      1 220.227.213.163:22
      1 220.227.213.145:22
      1 220.227.211.109:22
      1 220.227.207.44:22
      1 220.227.207.2:22
      1 220.227.207.219:22
      1 220.227.198.230:22
      1 220.227.198.1:22
      1 220.227.190.196:22
      1 220.227.190.178:22
      1 220.227.190.10:22
      1 220.227.178.20:22
      1 220.227.176.214:22
      1 220.227.170.26:22
      1 220.227.169.169:22
      1 220.227.168.14:22
      1 220.227.168.110:22
      1 220.227.165.120:22
      1 220.227.164.242:22
      1 220.227.164.148:22
      1 220.227.161.85:22
      1 220.227.161.225:22
      1 220.227.158.77:22
      1 220.227.158.210:22
      1 220.227.158.178:22
      1 220.227.158.108:22
      1 220.227.157.69:22
      1 220.227.157.37:22
      1 220.227.157.169:22
      1 220.227.156.1:22
      1 220.227.155.49:22
      1 220.227.154.51:22
      1 220.227.15.146:22
      1 220.227.15.145:22
      1 220.227.15.139:22
      1 220.227.147.83:22
      1 220.227.147.143:22
      1 220.227.141.213:22
      1 220.227.13.87:22
      1 220.227.137.30:22
      1 220.227.13.65:22
      1 220.227.134.52:22
      1 220.227.13.249:22
      1 220.227.131.121:22
      1 220.227.130.12:22
      1 220.227.129.89:22
      1 220.227.128.98:22
      1 220.227.124.16:22
      1 220.227.123.81:22
      1 220.227.12.218:22
      1 220.227.121.203:22
      1 220.227.121.200:22
      1 220.227.118.190:22
      1 220.227.114.171:22
      1 220.227.113.21:22
      1 220.227.113.209:22
      1 220.227.113.13:22
      1 220.227.11.1:22
      1 220.227.106.114:22
      1 220.227.105.202:22
      1 220.227.100.50:22
      1 220.227.100.122:22
      1 220.227.100.12:22</pre>
		</div>

Tạm thời em đã kill hết các processes này, stop luôn nrpe, add thêm một rule cản packets đi ra đến port 22 trong iptables. Anh có gợi ý nào không ạ?

PS: Em đang dùng nagios-plugins 1.4.14 và nrpe 2.12.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214485</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214485</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 22:30:46]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>CentOS 5.3: kernel: Xploit 21956: segfault at</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Em vẫn chưa biết tại sao lại có nhiều processes sshd owned bởi nagios kết nối đi lung tung đến thế:

Tạm thời em đã kill hết các processes này, stop luôn nrpe, add thêm một rule cản packets đi ra đến port 22 trong iptables. Anh có gợi ý nào không ạ?

PS: Em đang dùng nagios-plugins 1.4.14 và nrpe 2.12.&nbsp;
		</blockquote>

Anh đề nghị em lưu lại các hồ sơ cấu hình và uninstall rồi install lại nagios + nrpe hoàn toàn. Xem kỹ lại trên hệ thống coi thử có dấu vết bị xâm nhập hay không. Xem kỹ lại cấu hình của nagios có bị thay đổi gì không.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214495</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/34913.hva#214495</link>
				<pubDate><![CDATA[Thu, 1 Jul 2010 23:13:43]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
	</channel>
</rss>
