<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Hiện tượng này có phải DDOS?"]]></title>
		<link>/hvaonline/posts/list/24.html</link>
		<description><![CDATA[Latest messages posted in the topic "Hiện tượng này có phải DDOS?"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Hiện tượng này có phải DDOS?</title>
				<description><![CDATA[ Chào mọi người,

Hiện mình đang quản lý một forum VBB, gần đây site mình có hiện tượng có quá nhiều bot truy cập gây nên việc tắc nghẽn hệ thống làm VPS bị sập.

Mình xin trích một đoạn log lên đây để mọi người xem và đánh giá giúp mình và cho mình xin giải pháp khắc phục (log này mình lấy sau khi đã restart lại VPS và deny các IP gửi quá nhiều request)

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "o91492kd0k8.net" "Mozilla/5.0 &#40;Macintosh; U; PPC Mac OS X; en-us&#41; AppleWebKit/xxx.x &#40;KHTML like Gecko&#41; Safari/12x.x"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "41kwb84l9.biz" "Mozilla/4.0 &#40;compatible; grub-client-0.3.x; Crawl your own stuff with<span class="link"> http://grub.org&#41;</span>"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "72i6c2t79p.com" "Mozilla/5.0 &#40;compatible; XTbot/1.0v; +http://www.0aoo9qs.com&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "r9qx0fdn01.com" "Mozilla/5.0 &#40;compatible; PagestackerBot;<span class="link"> http://www.i164prob47w30.com&#41;</span>"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "04mf5v164170cp.com" "Mozilla/4.0 &#40;compatible; MSIE 6.0; MSIE 5.5; Windows NT 5.1&#41; Skampy/0.9.x &#91;en&#93;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "z205qavo5150r.com" "Mozilla/4.75C-ja &#91;ja&#93; &#40;X11; U; OSF1 V5.1 alpha&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "q462qdy21.ru" "Mozilla/3.0 &#40;Vagabondo/2.0 MT; webcrawler@rd9a79l85.nl;<span class="link"> http://1pd5t3di1a.nl/&#41;</span>"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "kh00q54.ru" "Mozilla/5.0 &#40;Macintosh; U; PPC Mac OS X Mach-O; en-US; rv:1.0.1&#41; Gecko/20030306 Camino/0.7"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "473gow2lq2hf7.biz" "Mozilla/3.0 &#40;compatible; Fluffy the spider;<span class="link"> http://www.searchhippo.com/;</span> info@searchhippo.com&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "ne9272kl6996.com" "Mozilla/5.0 &#40;compatible; Webduniabot/1.0; +http://search.ryo8pl643yc.com/bot.aspx&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "0171r1s44.biz" "Mozilla/5.0 &#40;compatible; heritrix/1.5.0-200506231921<span class="link"> http://145l0knq.nla.gov.au/crawl.html&#41;</span>"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "2223xu74new6v9.biz" "Mozilla/3.01 &#40;compatible; AmigaVoyager/2.95; AmigaOS/MC680x0&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "uo347w9pr47z.ru" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; iRider 2.21.1108; FDM&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "67hlj10691.net" "Mozilla/4.5 &#91;en&#93;C-CCK-MCD {RuralNet} &#40;Win98; I&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "qljcd83.ru" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; SV1; IBP; .NET CLR 1.1.4322&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "0155nb713v9td.info" "Mozilla/5.0 &#40;Version: xxxx Type:xx&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "k82t9u77a.info" "Mozilla/4.0 &#40;compatible; MSIE 4.01; Vonna.com b o t&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "g5tq514n0.net" "Mozilla/5.0 &#40;compatible; Ask Jeeves/Teoma;<span class="link"> http://34258510yn.05676p1g0izd8.com/en/docs/about/webmasters.shtml&#41;</span>"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "vklv65j257643.ru" "Mozilla/5.0 &#40;compatible; Konqueror/2.0.1; X11&#41;; Supports MD5-Digest; Supports gzip encoding"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "b4o5vvw8l6.net" "Mozilla/2.0"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "6v436o5.biz" "Mozilla/4.0 &#40;compatible; MSIE 5.5; Windows 98; SAFEXPLORER TL&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "7p6qvs08s8yr.info" "Mozilla/5.0 &#40;compatible; SnapPreviewBot; en-US; rv:1.8.0.9&#41; Gecko/20061206 Firefox/1.5.0.9"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "8z9m042.ru" "Mozilla/5.0 &#40;compatible; egothor/8.0g; +http://ego.ms.22v97sg.cuni.cz/&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "7jk6tdev.info" "Mozilla/5.0 &#40;compatible; Pogodak.hr/3.1&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "xvu7smg.ru" "Mozilla/4.6 &#91;en&#93; &#40;http://www.cnet.com/&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "q7xdb6gg.net" "Mozilla/5.0 &#40;compatible; Synoobot/0.9;<span class="link"> http://www.01bc75buxxhz.com/82ppi9pi/bot.html&#41;</span>"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "npjvst4z6.com" "Mozilla/5.0 &#40;compatible; SnapPreviewBot; en-US; rv:1.8.0.9&#41; Gecko/20061206 Firefox/1.5.0.9"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "46s7bw7.biz" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; SV1;<span class="link"> http://www.changedetection.com/bot.html</span> &#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "b9xx2b91.net" "Mozilla/2.0 &#40;compatible; T-H-U-N-D-E-R-S-T-O-N-E&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "yntqf9.ru" "Mozilla/2.01 &#40;Win16; I&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "b7q8494.info" "Mozilla/5.0 &#40;compatible; PWeBot/3.1;<span class="link"> http://www.6olw3iad17u6.net/robot.php&#41;</span>"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "6nb4j770.com" "Mozilla/4.0 &#40;compatible; MSIE 4.01; Windows CE; PPS; 240x320&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "7e54e1g396.net" "Mozilla/5.0 &#40;compatible; InterseekWeb/3.x&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "4799l8p.info" "Mozilla/5.0 &#40;Macintosh; U; Intel Mac OS X 10.4; en-US; rv:1.9b5&#41; Gecko/2008032619 Firefox/3.0b5"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "j8gkd645189.biz" "Mozilla/5.0 &#40;compatible; Charlotte/1.0b; 5i62u96si5g6@t0vh9.com&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "f6vvq3.biz" "Mozilla/4.0 &#40;compatible; MSIE 5.01; Windows NT 5.0&#41; &#40;samualt9@bigfoot.com&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "us493.ru" "Mozilla/4.72 &#91;en&#93; &#40;BACS<span class="link"> http://www.ba.be&#41;</span>"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "o993m48c.com" "Mozilla/5.0 &#40;+http://www.e7maowgb781j8.com/mammoth&#41; Mammoth/0.1"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "9u1wb80au0o.info" "Mozilla/5.0 &#40;compatible; MSIE 6.0; Podtech Network; crawler_admin@n0ydj8.net&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "ezrytw.ru" "Mozilla/5.0 &#40;compatible; heritrix/1.10.2 +http://i.v92p3dn1x22.edu/&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "4gu2sw.info" "Mozilla/4.0 &#40;compatible; ibisBrowser&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "1r1338nvb9mzw.net" "Mozilla/4.0 &#40;compatible; Advanced Email Extractor v2.xx&#41;"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "d9wg8d207nh4.ru" "Mozilla/4.0 &#40;compatible; MSIE 6.0; Windows NT 5.1; SV1; IBP; .NET CLR 1.1.4322&#41;"
222.254.73.21 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "i55q7.net" "Mozilla/5.0 &#40;compatible; PWeBot/3.1;<span class="link"> http://www.7b09on.net/robot.php&#41;</span>"
123.18.210.206 - - &#91;25/Jul/2012:20:35:16 +0700&#93; "GET / HTTP/1.0" 403 591 "6cjj28gnd.ru" "Mozilla/2.0"</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43012.html#267481</guid>
				<link>/hvaonline/posts/list/43012.html#267481</link>
				<pubDate><![CDATA[Wed, 25 Jul 2012 08:49:50]]> GMT</pubDate>
				<author><![CDATA[ tnt.ad]]></author>
			</item>
			<item>
				<title>Hiện tượng này có phải DDOS?</title>
				<description><![CDATA[ Cái này không phải là ddos, cái này là thành quả của CNTT nước nhà ;).

Nói đùa chơi chớ HVA cũng đã từng bị y hệt ông nội này gần đây.

Có 3 cách khắc phục:

1. Dùng mod_security để "đếm" số lần requests đến "/" (hoặc bất cứ một URI nào khác). Nếu quá số lần ấy thì DROP và thậm chí buộc mod_security thực thi một cái script để iptables block hẳn IP đó nếu nó "điên cuồng đánh phá" quá nhiều.

2. Thu thập hết các "User-Agent" quái dị kia và cho vào một file rồi dùng mod_security để dựa vào file đó mà block hết những requests có "User-Agent" quái dị.

3. Cũng dùng mod_security là lọc những request có Referer bất hợp lệ như vậy. Bất hợp lệ như thế nào thì ngâm cứu lại RFC liên quan tới HTTP ở phần Referer.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43012.html#267484</guid>
				<link>/hvaonline/posts/list/43012.html#267484</link>
				<pubDate><![CDATA[Wed, 25 Jul 2012 16:09:27]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
	</channel>
</rss>
