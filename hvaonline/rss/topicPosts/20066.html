<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Sơ lược về crontab"]]></title>
		<link>/hvaonline/posts/list/24.html</link>
		<description><![CDATA[Latest messages posted in the topic "Sơ lược về crontab"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <font color='orange'>1. Cron là gì?</font>
<b>Cron</b> là một tiện ích cho phép thực hiện các tác vụ một cách tự động theo định kỳ, ở chế độ nền của hệ thống. <b>Crontab</b> (CRON TABle) là một file chứa đựng bảng biểu (schedule) của các entries được chạy.

<font color='orange'>2. Cron làm việc thế nào?</font>
Một cron schedule đơn giản là một text file. Mỗi người dùng có một cron schedule riêng, file này thường nằm ở <i>/var/spool/cron</i>. Crontab files không cho phép bạn tạo hoặc chỉnh sửa trực tiếp với bất kỳ trình text editor nào, trừ phi bạn dùng lệnh <font color='#6699CC'>crontab</font>. Một số lệnh thường dùng:
<blockquote>
crontab -e: tạo hoặc chỉnh sửa file crontab
crontab -l: hiển thị file crontab
crontab -r: xóa file crontab
&nbsp;
		</blockquote>
<font color='orange'>3. Cấu trúc của crontab</font>
Một crontab file có 5 trường xác định thời gian, cuối cùng là lệnh sẽ được chạy định kỳ, cấu trúc như sau:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>*     *     *     *     *     command to be executed
-     -     -     -     -
|     |     |     |     |
|     |     |     |     +----- day of week &#40;0 - 6&#41; &#40;Sunday=0&#41;
|     |     |     +------- month &#40;1 - 12&#41;
|     |     +--------- day of month &#40;1 - 31&#41;
|     +----------- hour &#40;0 - 23&#41;
+------------- min &#40;0 - 59&#41;</pre>
		</div>
Nếu một cột được gán ký tự *, nó có nghĩa là tác vụ sau đó sẽ được chạy ở mọi giá trị cho cột đó. 

<font color='orange'>4. Ví dụ</font>
Giả sử tôi viết một đoạn script backup bookmarks trong Firefox như sau:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/bin/bash
date=`date +%F`

cp ~/.mozilla/firefox/13kee53o.default/bookmarks.html /mnt/data/BACKUP/bookmarks-$date.html</pre>
		</div>

sau đó tôi cho script này chạy định kỳ vào 15h thứ Hai và thứ Năm hàng tuần bằng cách tạo một file crontab như sau:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$ crontab -e
0 15 * * 1,4 sh /mnt/data/linux/code/backupbookmarks.sh</pre>
		</div>
Cuối cùng, nhớ khởi động lại cron daemon:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>/etc/init.d/crond restart</pre>
		</div>

ps: Để muốn "test" ngay xem crontab nó có hoạt động không, bạn có thể sửa lại đoạn script trên một chút:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/bin/bash
date=`date +%F-%H-%M-%S`

cp ~/.mozilla/firefox/13kee53o.default/bookmarks.html /mnt/data/BACKUP/bookmarks-$date.html</pre>
		</div>
và file crontab bạn sẽ cho backup liên tục theo từng phút như sau:
<blockquote>0-59 * * * * sh /mnt/data/linux/code/backupbookmarks.sh&nbsp;
		</blockquote>

]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#119373</guid>
				<link>/hvaonline/posts/list/20066.html#119373</link>
				<pubDate><![CDATA[Fri, 14 Mar 2008 18:13:42]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <blockquote>
<font color='orange'>2. Cron làm việc thế nào?</font>
Một cron schedule đơn giản là một text file. Mỗi người dùng có một cron schedule riêng, file này thường nằm ở <i>/var/spool/cron</i>. Crontab files không cho phép bạn tạo hoặc chỉnh sửa trực tiếp với bất kỳ trình text editor nào, trừ phi bạn dùng lệnh <font color='#6699CC'>crontab</font>. Một số lệnh thường dùng:
<blockquote>
crontab -e: tạo hoặc chỉnh sửa file crontab
crontab -l: hiển thị file crontab
crontab -r: xóa file crontab
&nbsp;
		</blockquote>
<font color='orange'>3. Cấu trúc của crontab</font>
Một crontab file có 5 trường xác định thời gian, cuối cùng là lệnh sẽ được chạy định kỳ, cấu trúc như sau:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>*     *     *     *     *     command to be executed
-     -     -     -     -
|     |     |     |     |
|     |     |     |     +----- day of week &#40;0 - 6&#41; &#40;Sunday=0&#41;
|     |     |     +------- month &#40;1 - 12&#41;
|     |     +--------- day of month &#40;1 - 31&#41;
|     +----------- hour &#40;0 - 23&#41;
+------------- min &#40;0 - 59&#41;</pre>
		</div>
Nếu một cột được gán ký tự *, nó có nghĩa là tác vụ sau đó sẽ được chạy ở mọi giá trị cho cột đó. 
&nbsp;
		</blockquote>

Sorry ngắt lời bạn tí xíu. Bạn có thể chỉnh sửa file crontab trong Linux luôn bằng cách xài Software GNU Midnight Commander. 
Ngoài ra bạn cũng có thể tạo File crontab (không có đuôi) trên máy Windows (cách này thường dùng trong trường hợp máy chủ là Linux máy con là Windows) bằng chương trình NOTEPAD rồi dùng Software WinSCP chuyển qua máy Linux.
Lưu ý sau khi chuyển qua máy Linux phải chạy lênh "dos2unix 'pathfile'" để chuyển sang loại file Linux đọc được.

Thân!
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#119394</guid>
				<link>/hvaonline/posts/list/20066.html#119394</link>
				<pubDate><![CDATA[Fri, 14 Mar 2008 20:28:12]]> GMT</pubDate>
				<author><![CDATA[ SemiNoob]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ thank... :) ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#189302</guid>
				<link>/hvaonline/posts/list/20066.html#189302</link>
				<pubDate><![CDATA[Sun, 9 Aug 2009 11:40:04]]> GMT</pubDate>
				<author><![CDATA[ taivn07]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ Trong ubuntu em làm theo hướng dẫn của pác

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>ubuntu@ubuntu-laptop:~$ su
Password: 
root@ubuntu-laptop:/home/ubuntu# crontab -e</pre>
		</div>

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># m h  dom mon dow   command
1 * * * *       sh /home/ubuntu/shell.sh</pre>
		</div>

[Ctrl + o] --&gt; lưu lại

Khởi động lại cron
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>root@ubuntu-laptop:/home/ubuntu# /etc/init.d/cron restart
Rather than invoking init scripts through /etc/init.d, use the service&#40;8&#41;
utility, e.g. service cron restart

Since the script you are attempting to invoke has been converted to an
Upstart job, you may also use the restart&#40;8&#41; utility, e.g. restart cron
cron start/running, process 2269</pre>
		</div>

tiếp

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>root@ubuntu-laptop:/home/ubuntu# crontab -l
no crontab for root
root@ubuntu-laptop:/home/ubuntu#</pre>
		</div>


sao không có gì hết vậy ??? ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#206700</guid>
				<link>/hvaonline/posts/list/20066.html#206700</link>
				<pubDate><![CDATA[Fri, 12 Mar 2010 00:32:35]]> GMT</pubDate>
				<author><![CDATA[ M@z]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">M@z wrote:</cite><br>
		<blockquote>Trong ubuntu em làm theo hướng dẫn của pác
..................

sao không có gì hết vậy ??? &nbsp;
		</blockquote>

Có lẽ chưa save properly

remove .selected_editor
chọn nano
ctrl+x sau khi edit
save file

nên tạo log cho cron 

ví dụ:

~# touch /var/log/mycron.log

~#crontab -e

tạo 1 file để cron /root/file/cron.sh
dán cái này vô

*/1 * * * * sh /root/file/cron.sh &gt;&gt; /var/log/mycron.log 2&gt;&1

save lại, file trên chạy 1 phút 1 lần


theo dõi xem cron có hoạt động ko, hay eror gì

~# tail -f /var/log/mycron.log

ngồi chờ 1 phút coi.

Không cần phải khởi động lại cron mỗi lần add crontab 
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#206759</guid>
				<link>/hvaonline/posts/list/20066.html#206759</link>
				<pubDate><![CDATA[Fri, 12 Mar 2010 11:15:05]]> GMT</pubDate>
				<author><![CDATA[ nora]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ hay quá, topic đây rồi. Bạn cho mình hỏi cái là mỗi lần crontab -e có thể tạo nhiều lịch ko? vd như mình tạo lịch cho nó chạy 2 script và 2 thời điểm khác nhau ý :D cảm ơn nhiều nhiều nhé]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#209463</guid>
				<link>/hvaonline/posts/list/20066.html#209463</link>
				<pubDate><![CDATA[Tue, 20 Apr 2010 22:32:43]]> GMT</pubDate>
				<author><![CDATA[ thirellouma]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">thirellouma wrote:</cite><br>
		<blockquote>hay quá, topic đây rồi. Bạn cho mình hỏi cái là mỗi lần crontab -e có thể tạo nhiều lịch ko? vd như mình tạo lịch cho nó chạy 2 script và 2 thời điểm khác nhau ý :D cảm ơn nhiều nhiều nhé&nbsp;
		</blockquote>
Được, mỗi cái bạn viết trên một dòng.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#209465</guid>
				<link>/hvaonline/posts/list/20066.html#209465</link>
				<pubDate><![CDATA[Tue, 20 Apr 2010 22:38:16]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ crontab có thể chạy file tạo ra rule cho iptables không vậy anh?em có file test.sh có nội dung sau:
<blockquote>iptables -A INPUT -j QUEUE&nbsp;
		</blockquote>

khi em dùng lệnh sh test.sh thì chạy bình thường. Nhưng dùng crontab thì theo cách của anh nora báo là <b>test.sh: line2 iptables: command not found</b>
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#210534</guid>
				<link>/hvaonline/posts/list/20066.html#210534</link>
				<pubDate><![CDATA[Sat, 8 May 2010 10:28:22]]> GMT</pubDate>
				<author><![CDATA[ actuladn]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">actuladn wrote:</cite><br>
		<blockquote>crontab có thể chạy file tạo ra rule cho iptables không vậy anh?em có file test.sh có nội dung sau:
<blockquote>iptables -A INPUT -j QUEUE&nbsp;
		</blockquote>

khi em dùng lệnh sh test.sh thì chạy bình thường. Nhưng dùng crontab thì theo cách của anh nora báo là <b>test.sh: line2 iptables: command not found</b>
&nbsp;
		</blockquote>

Viết trực tiếp lệnh trên vào trong cron table hoặc nếu để trong 1 file script thì thêm #!/bin/bash vào đầu file.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#210545</guid>
				<link>/hvaonline/posts/list/20066.html#210545</link>
				<pubDate><![CDATA[Sat, 8 May 2010 13:45:39]]> GMT</pubDate>
				<author><![CDATA[ Crunch]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Crunch wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">actuladn wrote:</cite><br>
		<blockquote>crontab có thể chạy file tạo ra rule cho iptables không vậy anh?em có file test.sh có nội dung sau:
<blockquote>iptables -A INPUT -j QUEUE&nbsp;
		</blockquote>

khi em dùng lệnh sh test.sh thì chạy bình thường. Nhưng dùng crontab thì theo cách của anh nora báo là <b>test.sh: <font color='red'>line2</font> iptables: command not found</b>
&nbsp;
		</blockquote>

Viết trực tiếp lệnh trên vào trong cron table hoặc nếu để trong 1 file script thì thêm #!/bin/bash vào đầu file.&nbsp;
		</blockquote>

bỏ dòng trắng (Blank line) edit bằng nano
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#210546</guid>
				<link>/hvaonline/posts/list/20066.html#210546</link>
				<pubDate><![CDATA[Sat, 8 May 2010 17:14:36]]> GMT</pubDate>
				<author><![CDATA[ nora]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">nora wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">Crunch wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">actuladn wrote:</cite><br>
		<blockquote>crontab có thể chạy file tạo ra rule cho iptables không vậy anh?em có file test.sh có nội dung sau:
<blockquote>iptables -A INPUT -j QUEUE&nbsp;
		</blockquote>

khi em dùng lệnh sh test.sh thì chạy bình thường. Nhưng dùng crontab thì theo cách của anh nora báo là <b>test.sh: <font color='red'>line2</font> iptables: command not found</b>
&nbsp;
		</blockquote>

Viết trực tiếp lệnh trên vào trong cron table hoặc nếu để trong 1 file script thì thêm #!/bin/bash vào đầu file.&nbsp;
		</blockquote>

bỏ dòng trắng (Blank line) edit bằng nano
&nbsp;
		</blockquote>
Báo vậy do bác ấy để trống line 1, viết câu lệnh ở line 2. Xoá đi thì nó lại báo lỗi ở line 1.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#210561</guid>
				<link>/hvaonline/posts/list/20066.html#210561</link>
				<pubDate><![CDATA[Sun, 9 May 2010 01:22:39]]> GMT</pubDate>
				<author><![CDATA[ Crunch]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ hihi!!! file em có 1 dòng ah, em dùng vi để delete khoảng trắng luôn. mỗi lần em post lên hỏi thì lại làm được. Nhưng em không hiểu tại sao với 1 dòng như trên khi thực hiện bằng lệnh thì chạy bình thường. Nhưng khi chạy crontab thì nó báo là không tìm thấy iptables. Và cần phải định nghĩa iptables cho nó
Dù sao cũng cám ơn mọi người nhiều]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#210563</guid>
				<link>/hvaonline/posts/list/20066.html#210563</link>
				<pubDate><![CDATA[Sun, 9 May 2010 01:39:15]]> GMT</pubDate>
				<author><![CDATA[ actuladn]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">actuladn wrote:</cite><br>
		<blockquote>hihi!!! file em có 1 dòng ah, em dùng vi để delete khoảng trắng luôn. mỗi lần em post lên hỏi thì lại làm được. Nhưng em không hiểu tại sao với 1 dòng như trên khi thực hiện bằng lệnh thì chạy bình thường. Nhưng khi chạy crontab thì nó báo là không tìm thấy iptables. Và cần phải định nghĩa iptables cho nó
Dù sao cũng cám ơn mọi người nhiều&nbsp;
		</blockquote>

cron ko chạy các lệnh từ shell mà phải từ path/to/command í dụ /usr/bin/* 
<b>
trong cron em có thể tìm iptables command bằng cách</b>

user@host~#which iptables

out put tương tự

<b>/sbin/iptables</b>

thay cái path này vào trong cron tab. thay vì chỉ <b>iptables</b>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#210574</guid>
				<link>/hvaonline/posts/list/20066.html#210574</link>
				<pubDate><![CDATA[Sun, 9 May 2010 06:59:47]]> GMT</pubDate>
				<author><![CDATA[ nora]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ ah được rồi, cám ơn anh nhiều]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#210798</guid>
				<link>/hvaonline/posts/list/20066.html#210798</link>
				<pubDate><![CDATA[Thu, 13 May 2010 01:43:30]]> GMT</pubDate>
				<author><![CDATA[ actuladn]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">nora wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">M@z wrote:</cite><br>
		<blockquote>Trong ubuntu em làm theo hướng dẫn của pác
..................

sao không có gì hết vậy ??? &nbsp;
		</blockquote>

Có lẽ chưa save properly

remove .selected_editor
chọn nano
ctrl+x sau khi edit
save file

nên tạo log cho cron 

ví dụ:

~# touch /var/log/mycron.log

~#crontab -e

tạo 1 file để cron /root/file/cron.sh
dán cái này vô

*/1 * * * * sh /root/file/cron.sh &gt;&gt; /var/log/mycron.log 2&gt;&1

save lại, file trên chạy 1 phút 1 lần


theo dõi xem cron có hoạt động ko, hay eror gì

~# tail -f /var/log/mycron.log

ngồi chờ 1 phút coi.

Không cần phải khởi động lại cron mỗi lần add crontab 
&nbsp;
		</blockquote>

mình có file shell backup: ftpbackup.sh
nội dung:
<font color='green'>#!/bin/bash
USER='user'
PASS='123456'
SERVER='192.168.1.4'

SOURCE='/duongdan/folderbackup'

lftp - u $USER,$PASS $SERVER &lt;&lt;EOF
mirror -R $SOURCE
EOF</font>

nội dung crontab -e
*/1 * * * * /bin/bash /duongdan/runcron/ftpbackup.sh &gt;&gt; /duongdan/runcronlog/filecron.log 2&gt;&1

thì xem file log báo lỗi 
line 8 lftp: command not found

kiểm tra lftp:
whereis lftp
trả về 
/usr/local/bin/lftp /usr/local/etc/lftp.conf /usr/local/lib/lftp

ftpserver máy 192.168.1.4 chạy tốt

đang bó tay với lỗi này
rất mong các huynh cứu giúp.
cảm ơn nhiều]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#232427</guid>
				<link>/hvaonline/posts/list/20066.html#232427</link>
				<pubDate><![CDATA[Fri, 4 Mar 2011 18:14:59]]> GMT</pubDate>
				<author><![CDATA[ netviet]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ Sửa thành đường dẫn đầy đủ là OK thôi. Tốt nhất là luôn luôn dùng đường dẫn đầy đủ khi viết script để chạy cron job.
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#232429</guid>
				<link>/hvaonline/posts/list/20066.html#232429</link>
				<pubDate><![CDATA[Fri, 4 Mar 2011 20:11:56]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ Cho em hỏi một chút ạ, liệu khi mình dùng crontab -e, mình có dược phép bỏ nhiều lệnh vào trong này không ạ? Ví dụ như sau:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>0 15 * * 1,4 sh /mnt/data/linux/code/backupbookmarks.sh
0 15 * * 1,4 sh /usr/bin/test.sh</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#256769</guid>
				<link>/hvaonline/posts/list/20066.html#256769</link>
				<pubDate><![CDATA[Sat, 3 Mar 2012 08:20:21]]> GMT</pubDate>
				<author><![CDATA[ xtdv]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ <br>
			<div align="center" class="limitview"><img src='http://img214.imageshack.us/img214/5547/calendarhva.jpg' border="0" onload="maxImg(this, 500px);" /></div>

Cái posting time của HVA có vẻ như bị trục trặc??
]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#256865</guid>
				<link>/hvaonline/posts/list/20066.html#256865</link>
				<pubDate><![CDATA[Sun, 4 Mar 2012 09:51:58]]> GMT</pubDate>
				<author><![CDATA[ dancerhp]]></author>
			</item>
			<item>
				<title>Sơ lược về crontab</title>
				<description><![CDATA[ Tớ chẳng thấy lỗi ở đâu.
Một bài năm 2011, một bài 2012 mà :|]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/20066.html#256915</guid>
				<link>/hvaonline/posts/list/20066.html#256915</link>
				<pubDate><![CDATA[Sun, 4 Mar 2012 23:04:00]]> GMT</pubDate>
				<author><![CDATA[ scout]]></author>
			</item>
	</channel>
</rss>
