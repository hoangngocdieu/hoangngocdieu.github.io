<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Xin giúp đỡ lỗi missing -l parameters trong Nagios3"]]></title>
		<link>/hvaonline/posts/list/24.html</link>
		<description><![CDATA[Latest messages posted in the topic "Xin giúp đỡ lỗi missing -l parameters trong Nagios3"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Mình cài đặt Nsclient++, listen port là 12489.
Bên Nagios server mình định nghĩa host và các service trong file windows.cfg như sau

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define host{
        use             windows-host   
        host_name       winserver     
        alias           My Windows Server      
        address         192.168.1.20   
        }
define service{
        use                     generic-service
        host_name               winserver
        service_description     Uptime
        check_command           check_nt!UPTIME
        }
define service{
        use                     generic-service
        host_name               winserver
        service_description     C:\ Drive Space
        check_command           check_nt!USEDDISKSPACE!-l c -w 80 -c 90
        }</pre>
		</div>

Và định nghĩa command check_nt trong file nt.cfg như sau

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define command {
        command_name    check_nt
        command_line    /usr/lib/nagios/plugins/check_nt -H '$HOSTADDRESS$' -p 12489 -v '$ARG1$'
}</pre>
		</div>

Kết quả sau khi restart nagios thì chỉ có Uptime là OK, check space ko được, với status là UNKNOWN và Status information là missing -l parameters.

Nhưng mình thử chạy đờ réc : 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>/usr/lib/nagios/plugins/check_nt -H 192.168.1.20 -p 12489 -v 'USEDDISKSPACE' -l c -w 80 -c 90</pre>
		</div>
thì lại có kết quả : <font color='orange'>c:\ - total: 75.13 Gb - used: 17.66 Gb (24%) - free 57.47 Gb (76%) | 'c:\ Used Space'=17.66Gb;60.11;67.62;0.00;75.13</font>

Mong mọi người xem giúp đỡ mình trường hợp này với.Thanks!!!]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271429</guid>
				<link>/hvaonline/posts/list/43881.html#271429</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 02:07:40]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Đoạn `-l c -w 80 -c 90` sẽ ứng với $ARG mấy?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271430</guid>
				<link>/hvaonline/posts/list/43881.html#271430</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 02:24:08]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Đoạn `-l c -w 80 -c 90` sẽ ứng với $ARG mấy?&nbsp;
		</blockquote>

Không ứng với ARG nào cả anh quanta, vì trong define command e chỉ khai báo có 1 ARG mà anh.

Ý anh sao e ko hiểu lắm?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271432</guid>
				<link>/hvaonline/posts/list/43881.html#271432</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 02:38:51]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">tuanksor wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Đoạn `-l c -w 80 -c 90` sẽ ứng với $ARG mấy?&nbsp;
		</blockquote>

Không ứng với ARG nào cả anh quanta, vì trong define command e chỉ khai báo có 1 ARG mà anh.
&nbsp;
		</blockquote>
Vậy bạn định nghĩa thêm 1 ARG nữa đi:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define command {
        command_name    check_nt
        command_line    /usr/lib/nagios/plugins/check_nt -H '$HOSTADDRESS$' -p 12489 -v '$ARG1$' '$ARG2$'
}</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271434</guid>
				<link>/hvaonline/posts/list/43881.html#271434</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 02:45:00]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Sau khi em thêm $ARG2$ vào,
thì kết quả đã khác : Status là CRITICAL và Status information là null  :-( 
(Em không sửa lại define service mà giữ nguyên như cũ)

A giúp e chỗ này với. 

]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271435</guid>
				<link>/hvaonline/posts/list/43881.html#271435</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 03:00:44]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">tuanksor wrote:</cite><br>
		<blockquote>
Nhưng mình thử chạy đờ réc : 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>/usr/lib/nagios/plugins/check_nt -H 192.168.1.20 -p 12489 -v 'USEDDISKSPACE' -l c -w 80 -c 90</pre>
		</div>
thì lại có kết quả : <font color='orange'>c:\ - total: 75.13 Gb - used: 17.66 Gb (24%) - free 57.47 Gb (76%) | 'c:\ Used Space'=17.66Gb;60.11;67.62;0.00;75.13</font>
&nbsp;
		</blockquote>
Nếu bạn chạy lệnh trên với `root` thì thử lại với `nagios` user xem kết quả là gì:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>su - nagios -s /bin/bash -c "/usr/lib/nagios/plugins/check_nt ..."</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271437</guid>
				<link>/hvaonline/posts/list/43881.html#271437</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 03:24:04]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Đây là kết quả của em nó:

<font color='orange'>root@ubuntu:~# su - nagios -s /bin/bash -c "/usr/lib/nagios/plugins/check_nt -H 192.168.1.20 -p 12489 -v 'USEDDISKSPACE' -l c -w 80 -
c 90"
c:\ - total: 75.13 Gb - used: 17.66 Gb (24%) - free 57.47 Gb (76%) | 'c:\ Used Space'=17.66Gb;60.11;67.62;0.00;75.13</font>

Có kết quả hẳn hoi.

Sau khi thêm ARG2, nó còn kéo theo mấy cái khác sử dụng check_nt die luôn, ko check được nữa  :-(  ]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271438</guid>
				<link>/hvaonline/posts/list/43881.html#271438</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 03:29:03]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Stop NSClient++:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>C:\Program Files\NSClient++&gt;nscp.exe service --stop --name nscp</pre>
		</div>
rồi start lại ở &quot;debug&quot; mode:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>C:\Program Files\NSClient++&gt;nscp.exe test</pre>
		</div>
sau đó, Re-schedule check từ Nagios web UI xem log báo những gì.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271445</guid>
				<link>/hvaonline/posts/list/43881.html#271445</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 08:35:32]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Sau khi chạy nscp test, restart nagios thì log của nagios ntn

<font color='orange'>SERVICE ALERT: tuanksor;C:\ Drive Space;UNKNOWN;HARD;4;wrong -l argument</font>

Lần này nó báo wrong arg

và đoạn cuối của log nscp

<font color='orange'>d de\socket/server.hpp:114  Attempting to bind to: :12489
d de\socket/server.hpp:127  Bound to: :12489
d rvice\NSClient++.cpp:612  NSClient++ - 0,4,1,66 2012-11-18 Started!
l ce\simple_client.hpp:32   Enter command to inject or exit to terminate...
d /server/protocol.hpp:59   Accepting connection from: ::ffff:192.168.1.105
d r\NSClientServer.cpp:240  Data: None&7
d r\NSClientServer.cpp:265  Data:
d rvice\NSClient++.cpp:933  Injecting: checkmem...
d rvice\NSClient++.cpp:958  Result checkmem: OK
d /server/protocol.hpp:59   Accepting connection from: ::ffff:192.168.1.105
d r\NSClientServer.cpp:240  Data: None&7
d r\NSClientServer.cpp:265  Data:
d rvice\NSClient++.cpp:933  Injecting: checkmem...
d rvice\NSClient++.cpp:958  Result checkmem: OK</font>

Hiện tại e đang làm máy ở nhà, chỉ khác ở mỗi tên service, hostname, còn các define thì như nhau
(không biết có khác gì nữa không mà bây h nó ra lỗi khác  :D )]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271447</guid>
				<link>/hvaonline/posts/list/43881.html#271447</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 09:06:27]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">tuanksor wrote:</cite><br>
		<blockquote>Sau khi chạy nscp test, restart nagios thì log của nagios ntn

<font color='orange'>SERVICE ALERT: tuanksor;C:\ Drive Space;UNKNOWN;HARD;4;wrong -l argument</font>
&nbsp;
		</blockquote>
Nếu bạn để như này:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define service{
        use                     generic-service
        host_name               winserver
        service_description     C:\ Drive Space
        check_command           check_nt!USEDDISKSPACE!-l c -w 80 -c 90
        }</pre>
		</div>
thì tháo 2 dấu nháy đơn bao quanh $ARGx$ ra:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define command {
        command_name    check_nt
        command_line    /usr/lib/nagios/plugins/check_nt -H '$HOSTADDRESS$' -p 12489 -v $ARG1$ $ARG2$
}</pre>
		</div>

Hoặc không thì sửa lại như này:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define command {
        command_name    check_nt
        command_line    /usr/lib/nagios/plugins/check_nt -H '$HOSTADDRESS$' -p 12489 -v $ARG1$ -l $ARG2$ -w $ARG3$ -C $ARG4$
}</pre>
		</div>
rồi gọi như sau cho chắc cú:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define service{
        use                     generic-service
        host_name               winserver
        service_description     C:\ Drive Space
        check_command           check_nt!USEDDISKSPACE!c!80!90
        }</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271448</guid>
				<link>/hvaonline/posts/list/43881.html#271448</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 09:27:48]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Hoặc không thì sửa lại như này:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define command {
        command_name    check_nt
        command_line    /usr/lib/nagios/plugins/check_nt -H '$HOSTADDRESS$' -p 12489 -v $ARG1$ -l $ARG2$ -w $ARG3$ -C $ARG4$
}</pre>
		</div>
rồi gọi như sau cho chắc cú:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define service{
        use                     generic-service
        host_name               winserver
        service_description     C:\ Drive Space
        check_command           check_nt!USEDDISKSPACE!c!80!90
        }</pre>
		</div>&nbsp;
		</blockquote>

Cách này e đã thử lúc chiều nhưng cũng thế, ko khả quan.

Còn cách tháo 2 dấu nháy đơn ra e mới thử xong,

Log nó đây

<font color='orange'>[2012-11-19 00:45:06] SERVICE NOTIFICATION: root;tuanksor;C:\ Drive Space;CRITICAL;notify-service-by-call;(null)
[2012-11-19 00:45:01] SERVICE NOTIFICATION: root;tuanksor;C:\ Drive Space;CRITICAL;notify-service-by-email;(null)
[2012-11-19 00:45:01] SERVICE ALERT: tuanksor;C:\ Drive Space;CRITICAL;HARD;4;(null)
[2012-11-19 00:40:39] SERVICE NOTIFICATION: root;tuanksor;Memory Usage;CRITICAL;notify-service-by-call;(null)
[2012-11-19 00:40:31] SERVICE NOTIFICATION: root;tuanksor;Memory Usage;CRITICAL;notify-service-by-email;(null)
[2012-11-19 00:40:31] SERVICE ALERT: tuanksor;Memory Usage;CRITICAL;HARD;4;(null)</font>

Lần này nó kéo thêm cái mem check đỏ loé luôn, hic

log nscp mới phát sinh thêm:

<font color='orange'>d de\socket/server.hpp:114  Attempting to bind to: :12489
d de\socket/server.hpp:127  Bound to: :12489
d rvice\NSClient++.cpp:612  NSClient++ - 0,4,1,66 2012-11-18 Started!
l ce\simple_client.hpp:32   Enter command to inject or exit to terminate...
d /server/protocol.hpp:59   Accepting connection from: ::ffff:192.168.1.105
d r\NSClientServer.cpp:240  Data: None&4&c
d r\NSClientServer.cpp:265  Data: c
d rvice\NSClient++.cpp:933  Injecting: checkdrivesize...
d rvice\NSClient++.cpp:958  Result checkdrivesize: OK
d /server/protocol.hpp:59   Accepting connection from: ::ffff:192.168.1.105
d r\NSClientServer.cpp:240  Data: None&7
d r\NSClientServer.cpp:265  Data:
d rvice\NSClient++.cpp:933  Injecting: checkmem...
d rvice\NSClient++.cpp:958  Result checkmem: OK</font>

Em thấy cái dòng 
<font color='orange'>d rvice\NSClient++.cpp:933  Injecting: checkdrivesize...
d rvice\NSClient++.cpp:958  Result checkdrivesize: OK</font>
Nó result ok mà sao ko có động tĩnh gì cả.]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271449</guid>
				<link>/hvaonline/posts/list/43881.html#271449</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 09:37:12]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Em xin thông báo lại, có kq rồi anh ạ, màu xanh đã về  :D .
Vậy ra lỗi nằm ở 2 cái dấu nháy đơn kia.

Mà cho e hỏi thêm là : Máy e có mem 4G, nhưng nagios nó báo ntn :
<font color='orange'>Status Information:	Memory usage: total:6517.30 Mb - used: 2012.52 Mb (31%) - free: 4504.78 Mb (69%)</font>

Tức là máy e có mem 6,5G. Không biết ở đâu mà nó thêm vô vậy anh?]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271450</guid>
				<link>/hvaonline/posts/list/43881.html#271450</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 09:46:16]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">tuanksor wrote:</cite><br>
		<blockquote>
Mà cho e hỏi thêm là : Máy e có mem 4G, nhưng nagios nó báo ntn :
<font color='orange'>Status Information:	Memory usage: total:6517.30 Mb - used: 2012.52 Mb (31%) - free: 4504.78 Mb (69%)</font>

Tức là máy e có mem 6,5G. Không biết ở đâu mà nó thêm vô vậy anh?&nbsp;
		</blockquote>
Chắc nó tính cả virtual memory (pagefile) rồi. Bạn chuyển sang dùng `check_nrpe` với `type=physical` thử xem:<span class="link"> http://www.nsclient.org/nscp/wiki/CheckSystem/checkMem</span>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271462</guid>
				<link>/hvaonline/posts/list/43881.html#271462</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 21:28:07]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Tình hình là ntn anh ạ :

Em chạy <font color='orange'>/usr/lib/nagios/plugins/check_nrpe -H 192.168.1.20 -p 5666 -c CheckMEM -a MaxWarn=80% MaxCrit=
90% ShowAll type=physical</font>

Thì kq là <font color='orange'>Exception processing request: Request contained arguments (not currently allowed, check the allow arguments option).</font>

Nếu e bỏ cái option<font color='orange'> -c CheckMEM </font>thì nó ra kq ntn :
<font color='orange'>I (0,4,1,66 2012-11-18) seem to be doing fine...</font>

Nên e không biết được mem của máy cần check.

A giúp em chỗ này luôn a nhé!!]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271467</guid>
				<link>/hvaonline/posts/list/43881.html#271467</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 22:52:08]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">tuanksor wrote:</cite><br>
		<blockquote>Tình hình là ntn anh ạ :

Em chạy <font color='orange'>/usr/lib/nagios/plugins/check_nrpe -H 192.168.1.20 -p 5666 -c CheckMEM -a MaxWarn=80% MaxCrit=90% ShowAll type=physical</font>

Thì kq là <font color='orange'>Exception processing request: Request contained arguments (not currently allowed, check the allow arguments option).</font>
&nbsp;
		</blockquote>
Bởi vì trong `nsclient.ini` không có command nào là `CheckMEM` cả. Sửa thành:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>check_nrpe -H 192.168.1.20 -p 5666 -c alias_mem type=physical</pre>
		</div>]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271468</guid>
				<link>/hvaonline/posts/list/43881.html#271468</link>
				<pubDate><![CDATA[Thu, 29 Nov 2012 23:19:06]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Xin giúp đỡ lỗi missing -l parameters trong Nagios3</title>
				<description><![CDATA[ Em đã sữa lại <font color='orange'>/usr/lib/nagios/plugins/check_nrpe -H 192.168.1.20 -p 5666 -c alias_mem -a MaxWarn=80% MaxCrit=90% ShowAll type=physical</font>

Nhưng kq như vầy :<font color='orange'>Exception processing request: Request contained arguments (not currently allowed, check the allow arguments option)</font>

Trong nsclient.ini có đoạn : 
<font color='orange'>alias_mem = checkMem MaxWarn=80% MaxCrit=90% ShowAll=long type=physical type=virtual type=paged type=page</font>

Em chạy <font color='orange'>/usr/lib/nagios/plugins/check_nrpe -H 192.168.1.20 -p 5666 -c alias_mem</font>

Thì kết quả đã OK.
<font color='orange'> OK: physical memory: Total: 1.9G - Used: 1.33G (70%) - Free: 583M (30%), virtual memory: Total: 2G - Used: 345M (16%) - Free: 1.66G (
84%), paged bytes: Total: 3.79G - Used: 2.63G (69%) - Free: 1.17G (31%), page file: Total: 3.79G - Used: 2.63G (69%) - Free: 1.17G (3
1%)|'physical memory %'=70%;80;90 'physical memory'=1.32G;1.51;1.7;0;1.88999 'virtual memory %'=16%;80;90 'virtual memory'=344.81M;16
38;1843.08;0;2047.87 'paged bytes %'=69%;80;90 'paged bytes'=2.62G;3.02999;3.41;0;3.79 'page file %'=69%;80;90 'page file'=2.62G;3.02
999;3.41;0;3.79</font>

Thanks Anh! H chỉ có chỉnh lại <font color='orange'>MaxWarn=$ARG1$ MaxCrit=$ARG2$ ShowAll=long type=$ARG3$ </font> trong file nsclient.ini (Nhưng ko biết như vậy có đc ko  :D ). H e mới thử]]></description>
				<guid isPermaLink="true">/hvaonline/posts/list/43881.html#271472</guid>
				<link>/hvaonline/posts/list/43881.html#271472</link>
				<pubDate><![CDATA[Fri, 30 Nov 2012 01:04:28]]> GMT</pubDate>
				<author><![CDATA[ tuanksor]]></author>
			</item>
	</channel>
</rss>
