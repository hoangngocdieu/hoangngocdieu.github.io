<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Case Study: phân tích hiện trường sau khi bị thâm nhập."]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/51.hva</link>
		<description><![CDATA[Latest messages posted in the topic "Case Study: phân tích hiện trường sau khi bị thâm nhập."]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Nhân tiện trang diễn đàn BKAV vừa bị tấn công (defaced và mất DB), tôi xin đưa ra một "case study" thực tế như sau:

Một trang web của công ty vừa bị thâm nhập. <b><font color='red'>Để bảo đảm bảo mật và uy tín của công ty, theo bạn, công ty ấy cần khai triển những gì và lý do tại sao?</font></b>

Cho rằng (các phiên bản đưa ra ở đây hoàn toàn là ngẫu nhiên): trang web ấy chạy trên hệ điều hành Windows 2003, sử dụng IIS làm reverse proxy, Apache phiên bản 2.2.15, PHP phiên bản 5.3, sử dụng software thương mại là vBulletin có phiên bản 4.1.5 và cơ sở dữ liệu là mysql phiên bản 5.1. Tất cả các dịch vụ đều chạy trên cùng một máy chủ (dedicated server) và được firewall của ISP bảo vệ.

<b>Vui lòng khai triển ở góc độ "forensics" để từ đó mới có thể đưa đến biện pháp.</b>

Mời các bạn tham gia.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253862</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253862</link>
				<pubDate><![CDATA[Tue, 14 Feb 2012 23:11:40]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Em xin mở hàng,
Có gì sai sót mong anh Conmale và các bạn chỉ bảo thêm.
Trong trường hợp này ,theo em ,công ty này cần phải triển khai 1 số điều :

<font color='red'>1.</font> Công ty này nên thiết lập ngay một web server khác và 1 trang "In Maintenance" và ngắt ngay server bị tấn công khỏi network ,hay nói cách khác ,cách ly server đó.

<font color='green'>Mục đích:</font> Để bảo vệ uy tín cho công ty ,và để cho kẻ tấn công không phán đoán được hành động của nạn nhân ,1 trang "In Maintenance Mode" cũng không làm cho khách hàng lo lắng vì maintenance cũng là chuyện bình thường đối với mọi trang web.

Cách ly server đó ra khỏi network để tránh tình trạng bị alter data ,log ,hay configuration trên server ,nhằm phục vụ cho mục đích forensic.

<font color='red'>2.</font> Lập tức thông báo cho nhóm điều hành forum thay đổi ngay password cho tài khoản email, tài khoản ftp,remote admin (nếu service tương ứng được cài đặt trên máy họ) đồng thời đưa ra hướng dẫn tạo mật khẩu an toàn. Yêu cầu các thành viên trong nhóm điều hành tiến hành quét virus ,rootkit ,trojan trên máy của họ. Nếu phát hiện điều gì bất thường ,phải báo cáo lại cho bộ phận IT chịu trách nhiệm khắc phục sự cố.

<font color='green'>Mục đích:</font> Việc này đảm bảo rằng kẻ tấn công không còn giữ quyền kiểm soát email ,account ftp,remote admin (nếu có) của các thành viên trong nhóm điều hành forum. Ngoài ra ,bước này cho phép ta xác định nguồn của cuộc tấn công có bắt đầu từ việc mất pasword ,dính rootkit hay keylogger của các thành viên trong nhóm điều hành hay không. Nếu có thì sẽ xác định được quá trình họ bị mất password (password không tuân theo hướng dẫn tạo password an toàn) ,hay thông qua việc download các software trên chính forum hay từ nguồn khác. Điều này sẽ giúp xây dựng chính sách bảo mật hợp lý sau khi đã khắc phục được sự cố.

<font color='red'>3.</font> Mời ngay 1 công ty hay các chuyên gia có kinh nghiệm ứng cứu sự cố và forensic  :^) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253873</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253873</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 00:03:48]]> GMT</pubDate>
				<author><![CDATA[ baothu]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <blockquote>Để bảo đảm bảo mật và uy tín của công ty, theo bạn, công ty ấy cần khai triển những gì và lý do tại sao? &nbsp;
		</blockquote>

1. Để đảm bảo bảo mật 

- Thực hiện việc phân tách hệ thống, nhằm đóng băng hệ thống cũ và xây dựng hệ thống mới. Tránh tình trạng downtime quá lâu 

- Xây dựng 1 đội nghiên cứu hoặc thuê bên thứ 3 chịu trách nhiệm truy dấu vết của attacker để lại trên máy chủ cũ. 

- Liên hệ với các cơ quan chức năng có thẩm quyền để "rộng" đường trong việc điều tra

- Xây dựng các giải pháp phòng tránh tạm thời để tránh tình trạng hệ thống bị thâm nhập 1 lần nữa

- Rà soát các dịch vụ, lỗ hổng -phần mềm máy chủ đang chạy. Kiểm tra các user / pc nhân viên có thẩm quyền liên quan đến hệ thống

2. Để đảm bảo uy tín công ty 
 
- Trỏ domain hiện tại sang một trang thông cáo, nhằm truyền tải nội dung giữa Cty và khách truy cập. Tránh tình trạng các thông tin từ các phía truyền thông tuyên truyền sai lệch

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253913</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253913</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 04:05:00]]> GMT</pubDate>
				<author><![CDATA[ Ikut3]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Mình xin phân tích và trình bày quan điểm như sau: 
<font color='red'>1. web của công ty vừa bị thâm nhập. 
2. Để bảo đảm bảo mật và uy tín của công ty theo bạn, công ty ấy cần khai triển những gì và lý do tại sao?</font>

1. web của công ty vừa bị thâm nhập là hệ quả của một số nguyên nhân tồn tại trước đó khách quan hoặc chủ quan. (VD: cá nhân nghịch phá , đối thủ cạnh tranh không lành mạnh, quan hệ khách hàng hoặc cộng đồng không tốt, nhân viên kỹ thuật trong công ty nghỉ việc, quản trị hệ thống thiếu quan tâm đến các dịch vụ trên máy chủ web,cập nhập,fix bugs ...vv.)

2. Bảo đảm bảo mật và uy tín của công ty là quá trình xây dựng lâu dài, từ lúc thành lập công ty và tiếp diễn. Bất kỳ công ty nào làm khi làm kinh doanh đều phải xây dựng cho mình kế hoạch phục hồi sau thảm họa (Disaster Recovery). Kế họach khôi phục sau thảm họa là quá trình chuẩn bị, là phản ứng từ trên xuống dưới, tất cả cá nhân liên quan. Việc chuẩn bị tốt chu đáo kế hoạch phản ứng với các danh sách thảm họa đã được phân loại sẽ giúp công ty giảm thiểu thiệt hại về vật chất lẫn uy tín của mình. 

- Tùy theo quy mô lớn nhỏ của công ty cũng như dịch vụ mà mình cung cấp( VD: Website availability 24/7 ) mà xây dựng kế hoạch Disaster Recovery cho phù hợp. Như vậy, việc xây dựng kế hoạch khắc phục sau thảm họa là việc cần triển khai trước tiên song song với sự phát triển của công ty. Còn tình huống web bị thâm nhập là xãy ra sau, và cần chấp nhập sự thật khi public web ra internet bị tấn công là vấn đề không tránh khỏi. Ghi nhận trường hợp của bkav và các thông tin từ các tờ báo online được xem là có uy tín ở việt nam phản ảnh: Cho  thấy sự thiếu chuẩn bị và cách đánh giá vấn đề dẫn đến các hành động, phản ứng của cá nhân đại diện bkav được cộng đồng mạng đánh giá là bất lợi cho doanh nghiệp khi kinh doanh sản phẩm và dịch vụ của mình sau này. 

- Việc đánh giá mực độ hậu quả một cách nghiêm túc,cũng như công việc thu thập thông tin để tìm ra nguyên nhân cốt lõi của vấn đề là việc cần thiết nên làm. Có thể thấy vấn đề nghiêm trọng trong trường hợp của bkav xuất phát từ cách hành xử, phản ứng đã tồn tại từ rất lâu, chứ không phải vấn đề bị tấn công (defaced và mất DB) và bị cài file "hacked.html" trên máy chủ. bkav bị tấn công(defaced và mất DB) là hậu quả tất yếu
xuất phát từ nguyên nhân là cách hành xử, phản ứng từ vụ bị tấn công trước đó. 

- Như đã đề cập ở trên, Bảo đảm bảo mật là quá trình làm việc lâu dài song song với sự phát triển của công nghệ, là sự hợp tác từ cá nhân liên quan từ cấp Lãnh đạo tới nhân viên. Ghi nhận ý kiến của anh Conmale về kiện toàn bảo mật "Bảo mật ở các tầng, các lớp không đơn thuần chỉ cấu hình ứng dụng trên máy chủ web.  
  
Thanks for viewing
      
 ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253916</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253916</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 04:18:58]]> GMT</pubDate>
				<author><![CDATA[ jerrykun]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Chưa thấy bạn nào đề cập đến việc "làm việc các đơn vị chức năng có liên quan" như "Trung tâm an ninh mạng", "Lực lượng cảnh sát phòng chống tội pham công nghệ cao" nhỉ :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253925</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253925</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 06:36:47]]> GMT</pubDate>
				<author><![CDATA[ K4i]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">comale wrote:</cite><br>
		<blockquote>
Cho rằng (các phiên bản đưa ra ở đây hoàn toàn là ngẫu nhiên): trang web ấy chạy trên hệ điều hành Windows 2003, sử dụng IIS làm reverse proxy, Apache phiên bản 2.2.15, PHP phiên bản 5.3, sử dụng software thương mại là vBulletin có phiên bản 4.1.5 và cơ sở dữ liệu là mysql phiên bản 5.1. Tất cả các dịch vụ đều chạy trên cùng một máy chủ (dedicated server) và được firewall của ISP bảo vệ.
Vui lòng khai triển ở góc độ "forensics" để từ đó mới có thể đưa đến biện pháp.
&nbsp;
		</blockquote>

Theo em thấy thì website đã bị hack thì uy tín đã sứt mẻ rồi, việc còn lại là làm sao để không sứt mẻ thêm và phục hồi nó.

Dưới "góc độ forensic" thì việc tối quan trọng là tìm ra lỗ hổng và vá lỗi kịp thời. Nhưng cái khó ở đây là vừa tìm được lỗ hổng vừa phải đảm bảo việc làm ăn vẫn thuận lợi, đối với 1 công ty lớn chỉ cần đặt server offline 1p có thể thiệt hại nhiều tỉ đồng. Do đó cái một chiến lược tốt sẽ là một chiến lược "nhanh" mà vẫn "chắc". Ngoài những thứ các bạn khác đã nói ở trên thì mình xin bổ xung theo quan điểm của mình:

1) Luôn có 1 máy chủ dự phòng và thiết lập ở chế độ DEBUG mode và SAFE mode (disable các tính năng không cần thiết). Khi bị hack lập tức switch qua máy chủ này và lưu lại toàn bộ traffic vào ra để điều tra nếu hacker có ý quay lại.

2) Trong lúc đó khoanh vùng các application có khả năng bị lỗi cao. Cái này tùy thuộc nhiều vào dấu hiệu bị hack mà attacker để lại. (qua access log, event log của window, thời gian loggin, ip loggin). Ví dụ:
Nếu bị hack vào database thì khả năng cao là :
- sql injection trong vbulletin forums, các pluggin, app v.v..
- lỗi 0-day mysql server
Nếu bị deface / upload file lạ trên hệ thống:
- xem khả năng bị chiếm quyền root của server vì các ứng dụng webserver, php có lỗi 0-day
- khả năng admin bị cài virus và mất mật khẩu
- khả năng webserver bị lỗi cho upload file hay thay đổi file

3) Cùng lúc chạy các ứng dụng tìm rootkit kết hợp audit manually các file bị thay đổi trong hệ thống trong khoảng thời gian bị tấn công.

4) Sửa lỗi và thông báo cho các cơ quan chức năng, đặc biệt quan trọng theo mình là phải luôn trung thực, cầu tiến và bình tĩnh trong phát ngôn với các tổ chức bên ngoài.
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253926</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253926</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 06:51:35]]> GMT</pubDate>
				<author><![CDATA[ WinDak]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Ikut3 wrote:</cite><br>
		<blockquote>- Liên hệ với các cơ quan chức năng có thẩm quyền để "rộng" đường trong việc điều tra &nbsp;
		</blockquote>

<p></p>
		<cite class="blockquote">KAi wrote:</cite><br>
		<blockquote>
Chưa thấy bạn nào đề cập đến việc "làm việc các đơn vị chức năng có liên quan" như "Trung tâm an ninh mạng", "Lực lượng cảnh sát phòng chống tội pham công nghệ cao" nhỉ smilie
&nbsp;
		</blockquote>
hứ hứ :P]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253928</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253928</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 06:58:33]]> GMT</pubDate>
				<author><![CDATA[ Ikut3]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Theo em, khi mà website đã bị deface như trường hợp BKAV vừa rồi thì công ty đó cần nhanh chóng ngắt cái server đó ra, thay bằng cái server khác như WinDak đề nghị, đấy là cách rất hay, vì các hacker có khả năng sẽ thử thâm nhập trở lại lần nữa nếu hắn thấy website đã bị hack nhưng đột ngột hoạt động trở lại.

Hơi ngoài lề một tí nhưng em thấy cần nói thêm:

Sau đó công ty nên soạn sẵn Thông cáo báo chí ( Media Release ), cung cấp đủ các thông tin, giải thích tình hình theo hướng có lợi cho công ty, rồi chủ động gửi cho các cơ quan báo chí, media, việc này sẽ giúp công ty nắm thế chủ động trong vấn đề kiểm soát thông tin. Nếu chậm chân, để các tờ báo, media phải tự mình tìm hiểu thông tin, xui xẻo họ hỏi đúng chỗ người ta không ưa mình thì nhiều khả năng các nhà báo, media sẽ được cung cấp các thông tin bất lợi cho công ty. ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253952</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253952</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 10:15:35]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">WinDak wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">comale wrote:</cite><br>
		<blockquote>
Cho rằng (các phiên bản đưa ra ở đây hoàn toàn là ngẫu nhiên): trang web ấy chạy trên hệ điều hành Windows 2003, sử dụng IIS làm reverse proxy, Apache phiên bản 2.2.15, PHP phiên bản 5.3, sử dụng software thương mại là vBulletin có phiên bản 4.1.5 và cơ sở dữ liệu là mysql phiên bản 5.1. Tất cả các dịch vụ đều chạy trên cùng một máy chủ (dedicated server) và được firewall của ISP bảo vệ.
Vui lòng khai triển ở góc độ "forensics" để từ đó mới có thể đưa đến biện pháp.
&nbsp;
		</blockquote>

Theo em thấy thì website đã bị hack thì uy tín đã sứt mẻ rồi, việc còn lại là làm sao để không sứt mẻ thêm và phục hồi nó.

Dưới "góc độ forensic" thì việc tối quan trọng là tìm ra lỗ hổng và vá lỗi kịp thời. Nhưng cái khó ở đây là vừa tìm được lỗ hổng vừa phải đảm bảo việc làm ăn vẫn thuận lợi, đối với 1 công ty lớn chỉ cần đặt server offline 1p có thể thiệt hại nhiều tỉ đồng. Do đó cái một chiến lược tốt sẽ là một chiến lược "nhanh" mà vẫn "chắc". Ngoài những thứ các bạn khác đã nói ở trên thì mình xin bổ xung theo quan điểm của mình:

1) Luôn có 1 máy chủ dự phòng và thiết lập ở chế độ DEBUG mode và SAFE mode (disable các tính năng không cần thiết). Khi bị hack lập tức switch qua máy chủ này và lưu lại toàn bộ traffic vào ra để điều tra nếu hacker có ý quay lại.

2) Trong lúc đó khoanh vùng các application có khả năng bị lỗi cao. Cái này tùy thuộc nhiều vào dấu hiệu bị hack mà attacker để lại. (qua access log, event log của window, thời gian loggin, ip loggin). Ví dụ:
Nếu bị hack vào database thì khả năng cao là :
- sql injection trong vbulletin forums, các pluggin, app v.v..
- lỗi 0-day mysql server
Nếu bị deface / upload file lạ trên hệ thống:
- xem khả năng bị chiếm quyền root của server vì các ứng dụng webserver, php có lỗi 0-day
- khả năng admin bị cài virus và mất mật khẩu
- khả năng webserver bị lỗi cho upload file hay thay đổi file

3) Cùng lúc chạy các ứng dụng tìm rootkit kết hợp audit manually các file bị thay đổi trong hệ thống trong khoảng thời gian bị tấn công.

4) Sửa lỗi và thông báo cho các cơ quan chức năng, đặc biệt quan trọng theo mình là phải luôn trung thực, cầu tiến và bình tĩnh trong phát ngôn với các tổ chức bên ngoài.
&nbsp;
		</blockquote>

Mình thấy phần chạy ứng dụng tìm rootkit trong điểm thứ 3 của Windak nêu ra không cần thiết lắm, vì theo mình thì 1 khi hệ thống đã bị owned thì không thể tin tưởng để tiếp tục sử dụng tiếp mà phải chuyển sang 1 máy chủ fresh khác (còn máy owned thì offline để forensic). Thay vì đó, ta nên tập trung time cho forensic thì tốt hơn  ;) 

-rickb]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253954</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253954</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 10:38:43]]> GMT</pubDate>
				<author><![CDATA[ rickb]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Do hạn chế về trình độ, nên nếu là mình thì mình sẽ rút điện Server và gọi cho C50 nhờ vả]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253957</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253957</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 10:51:26]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Có điểm này mình chưa thấy có bạn nào trình bày đó là việc xác thực log trước khi tiến hành mang nó đi phân tích. Đây có lẽ là một bước bình thường với những bạn quen việc phân tích log nhưng cũng có rất nhiều bạn quên làm bước này. Thực ra theo mình đây là một bước rất quan trọng, vì thường thì nếu attacker đã owned system thì sẽ xáo trộn log để xoá dấu vết hoặc là đánh lạc hướng điều tra, gây rắc và khó khăn trong việc điều tra. Kinh nghiệm bản thân là nếu xác định hoặc có dấu hiệu system bị owned thì không nên tin 100% vào log.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253959</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253959</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 10:54:25]]> GMT</pubDate>
				<author><![CDATA[ vulehcm]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">vulehcm wrote:</cite><br>
		<blockquote>Có điểm này mình chưa thấy có bạn nào trình bày đó là việc xác thực log trước khi tiến hành mang nó đi phân tích. Đây có lẽ là một bước bình thường với những bạn quen việc phân tích log nhưng cũng có rất nhiều bạn quên làm bước này. Thực ra theo mình đây là một bước rất quan trọng, vì thường thì nếu attacker đã owned system thì sẽ xáo trộn log để xoá dấu vết hoặc là đánh lạc hướng điều tra, gây rắc và khó khăn trong việc điều tra. Kinh nghiệm bản thân là nếu xác định hoặc có dấu hiệu system bị owned thì không nên tin 100% vào log.&nbsp;
		</blockquote>
Đúng rồi, có khi nó còn dùng log để gắp lửa bỏ tay người  :| ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253960</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253960</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 10:59:52]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Sau khi đã tham khảo những giải pháp thiết thực và hữu ích từ những bài viết trên, em xin điểm thêm một vài chi tiết nhỏ để chúng ta có thể đưa đến 1 giải pháp tốt nhất cho case study này :
 Về đối ngoại :

- Điểm đầu tiên, đã là một công ty tức phải có nhiều nhân sự và nhiều bộ phận, thiết nghĩ họ nên có chính sách rõ ràng cho từng bộ phận với nhiệm vụ và mục đích khác nhau khi đối phó với sự cố này. Ở đây ta thấy trang web là bộ mặt của một công ty - nơi khách hàng thường xuyên vào để cập nhật thông tin và tìm hiểu về sản phẩm - , nhất là với 1 công ty chuyên về bảo mật thì uy tín là rất quan trọng vì độ bảo mật luôn tỉ lệ thuận cũng sự uy tín.

 + Vậy giải pháp cần triển khai đầu tiên để đảm bảo uy tín trước tiên là ... tăng cường lại độ bảo mật. How ? Người làm bảo mật thì luôn đi kèm trách nhiệm cao, vì vậy ta cần thẳng thắn thông báo ,giải thích một cách chính xác và rõ ràng về sự 'bất thường' trên bằng cách tạo 1 trang thông báo về sự cố vừa qua - đối với home page - hoặc 1 thread - đối với forum - , dĩ nhiên là sau khi liên hệ bộ phận R&D để remove trang defaced, ta thấy có 2 điểm mang lại dấu hiệu tích cực

      .1 là các phóng viên của các trang báo mạng vừa có thể cập nhật nguồn tin cho báo mình, vừa lọc được những đối tựơng khi họ liên hệ với ta để cập nhật thêm nguồn tin khác.
      .2 là làm diệu dư luận với nội dung cô đọng, không quá che giấu sai lầm. 

- Điểm thứ hai, Forum là 1 diễn đàn được công ty đầu tư để trở thành 1 nơi giao lưu giữa người sử dụng, khách hàng ...vv với đại diện của công ty, vì vậy chí ít ban quản trị diễn đàn cũng là 1 phần thể hiện cho bộ mặt, thái độ cũng như lời nói của công ty

+ Vậy giải pháp cần triển khai kế tiếp chỉ là chọn lựa những thành viên có kĩ năng mềm tốt - vì em không lầm thì ngành nào chúng ta cũng được đào tạo kĩ năng mềm dù ít hay nhiều - nhằm xoa diệu dư luận, giải thích bằng sự tỉnh táo, tránh áp dụng các hình thức dễ gây tiêu cực cho thành viên tham gia thảo luận như banned - trừ khi họ vi phạm nghiêm trọng luật đề ra - .

Về đối nội :
- Điểm thứ ba , rõ ràng ta cần phải xem xét hiện trừơng, ở đây em cũng có vài thắc mắc, BKAV cũng từng có vài bài post về hệ thống HoneyPot của họ, vậy với dấu hiệu cho thấy sự hiện diện của DDOS trên forum của họ thì HoneyPot lúc này đang đóng vai trò gì ?

 + Vậy giải pháp lúc này là : Liên hệ với bộ phận R&D hay technican để thực hiện truy cứu nguyên nhân, yêu cầu họ làm 1 bản report mô tả đầy đủ sự kiện với các tư liệu cụ thể vì đây là các bằng chứng quan trọng, mặt khác ta làm 1 công văn liên hệ với các cơ quan có thẩm quyền để cung cấp sự kiện, vật chứng, đẩy mạnh điều tra vì họ là những người có nghiệp vụ. Quan sát nội dung attacker để lại, ta có thể đặt giả thiết gì về mối quan hệ của những attacker này với đồng phạm bị bắt ? Cân nhắc kĩ trước khi quyết định vì thoả thuận không đạt có thể dẫn đến nhiều điều rắc rối khác - Rõ ràng attacker đã có DB nên xét cho cùng họ đang có lợi thế - .

-Cuối cùng, ta cần xem lại chuỗi mắc xích từ các tầng ứng dụng web, do mỗi đối tựơng có những phiên bản khác nhau nên :

 + Cần kết hợp các thông tin bảo mật về các lỗi 0 day nhằm thực hiện cập nhật các bản vá
 + Đưa ra các chính sách an toàn cho người dùng vì DB đã bị tiết lộ
 + Thực hiện các biện pháp kĩ thuật dựa trên kết cấu hạ tầng mà họ là người nắm rõ nhất.
 + Liên tục tham khảo các bài viết mang tính thiết thực ở các diễn đàn uy tín (như HVA chẳng hạn ;) ) !
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253964</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253964</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 11:34:17]]> GMT</pubDate>
				<author><![CDATA[ chube]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ 1. Đưa hệ thống phòng hờ vào vận hành, hệ thống này lưu trử trạng thái của lần hoạt động ổn định gần nhất từ hệ thống chính.
- Lí do : Việc ngưng cung cấp dịch vụ vào lúc này càng làm suy giảm uy tín, nhưng bên cạnh đó cần khuyến cáo cho người dùng về những khả năng có thể xãy ra. Và mức độ nghiêm trọng của sự việc.

2. Tìm kiếm giải pháp tình thế khả thi, áp dụng lên hệ thống phòng hờ, theo dỏi hệ thống phòng hờ và khả năng hệ thống phòng hờ bị tấn công.
- Lý do : Trong lúc chúng ta mãi mê với việc tìm ai là thủ phạm thì hệ thống phòng hờ lại bị tấn công một lần nữa đó có lẽ là việc làm chẳng khôn ngoan cho lắm.

3. Cách ly hệ thống gây lỗi và có khả năng gây lổi để tìm hiểu nguyên nhân. Tìm hiểu mức độ thiệt hại sau khi bị tấn công, các phương thức tấn công...cập nhật các bản patch gần nhất, tìm cái giải pháp tình thế.
- Lý do : Cần phải tìm nguyên nhân gây lỗi, ứng dụng, services gây lỗi, phương thức người khác dùng để thâm nhập....

4. Đưa những thông tin sai lệch về tình hình lỗi, và nguyên nhân gây lỗi cho báo chí.
- Lý do : báo chí chẳng quan tâm tới kỹ thật, và cũng không nhất thiết phải khai nhà tôi có gì, những thông tin sai lệch thế này sẽ làm giảm khả năng bị tấn công.

5. Xem xét lại tổng thể vụ việc, đánh giá về khả năng khắc phục, mức độ của sự việc.
  + Hệ thống không bị hư hại nghiêm trọng -&gt; đưa ra các biện pháp khắc phục. 
  + Hệ thống bị hư hại hư hại ít -&gt; Tìm hiểu các bện pháp kỹ thuật thay thế, và tìm kiếm sự tư vấn từ các nhà bảo mật.
  + Hệ thống bị hư hại nghiêm trọng -&gt; Tìm kiếm sự giúp đở từ các cơ quan điều tra, và các tổ chức có uy tín.
- Lý do : Tuỳ theo mức độ của sự việc mà xem xét về nhân lực và vật lực có đủ để tiến hành khắc phục sự cố hay không.

6. Làm sạch hệ thống chính, sửa chửa và đưa vào vận hành.
- Lý do : Hệ thống chính có thể đã bị nhiễm backdood, 

7. Đưa hệ thống chính vào vận hành và kiểm tra hệ thống phòng hờ.
- Lý do : Trong quá trình duy trì dịch vụ trên hệ thống phong hờ, có thể một số biện pháp tấn công khác đã được triển khai.

8. Công bố thông tin về sự cố (1 phần của sự thật là đủ) và hổ trợ người dùng bảo vệ an toàn thông tin.
- Lý do : Không nên cho những người không nên biết, biết quá nhu cầu biết của họ.

9. Đặt các giả thiết về khả năng bị tấn công, rà soát và loại bỏ.
- Lý do : Khả năng bị tấn công do chính người trong công ty, người tấn công tiếp xúc vật lý với hệ thống....


<font color='black'>10. Sống cho đàng hoàng đừng để thiên hạ ghét.
- Lý do : Để những lần bị hack sau không tới sớm hơn.</font>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253975</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253975</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 18:45:33]]> GMT</pubDate>
				<author><![CDATA[ chiro8x]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">WinDak wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">comale wrote:</cite><br>
		<blockquote>
Cho rằng (các phiên bản đưa ra ở đây hoàn toàn là ngẫu nhiên): trang web ấy chạy trên hệ điều hành Windows 2003, sử dụng IIS làm reverse proxy, Apache phiên bản 2.2.15, PHP phiên bản 5.3, sử dụng software thương mại là vBulletin có phiên bản 4.1.5 và cơ sở dữ liệu là mysql phiên bản 5.1. Tất cả các dịch vụ đều chạy trên cùng một máy chủ (dedicated server) và được firewall của ISP bảo vệ.
Vui lòng khai triển ở góc độ "forensics" để từ đó mới có thể đưa đến biện pháp.
&nbsp;
		</blockquote>

Theo em thấy thì website đã bị hack thì uy tín đã sứt mẻ rồi, việc còn lại là làm sao để không sứt mẻ thêm và phục hồi nó.

Dưới "góc độ forensic" thì việc tối quan trọng là tìm ra lỗ hổng và vá lỗi kịp thời. Nhưng cái khó ở đây là vừa tìm được lỗ hổng vừa phải đảm bảo việc làm ăn vẫn thuận lợi, đối với 1 công ty lớn chỉ cần đặt server offline 1p có thể thiệt hại nhiều tỉ đồng. Do đó cái một chiến lược tốt sẽ là một chiến lược "nhanh" mà vẫn "chắc". Ngoài những thứ các bạn khác đã nói ở trên thì mình xin bổ xung theo quan điểm của mình:

1) Luôn có 1 máy chủ dự phòng và thiết lập ở chế độ DEBUG mode và SAFE mode (disable các tính năng không cần thiết). Khi bị hack lập tức switch qua máy chủ này và lưu lại toàn bộ traffic vào ra để điều tra nếu hacker có ý quay lại.

2) Trong lúc đó khoanh vùng các application có khả năng bị lỗi cao. Cái này tùy thuộc nhiều vào dấu hiệu bị hack mà attacker để lại. (qua access log, event log của window, thời gian loggin, ip loggin). Ví dụ:
Nếu bị hack vào database thì khả năng cao là :
- sql injection trong vbulletin forums, các pluggin, app v.v..
- lỗi 0-day mysql server
Nếu bị deface / upload file lạ trên hệ thống:
- xem khả năng bị chiếm quyền root của server vì các ứng dụng webserver, php có lỗi 0-day
- khả năng admin bị cài virus và mất mật khẩu
- khả năng webserver bị lỗi cho upload file hay thay đổi file

3) Cùng lúc chạy các ứng dụng tìm rootkit kết hợp audit manually các file bị thay đổi trong hệ thống trong khoảng thời gian bị tấn công.

4) Sửa lỗi và thông báo cho các cơ quan chức năng, đặc biệt quan trọng theo mình là phải luôn trung thực, cầu tiến và bình tĩnh trong phát ngôn với các tổ chức bên ngoài.
&nbsp;
		</blockquote>

Mình xin bổ sung thêm 1 ý kiến, sau bước 1 của WinDak mình sẽ nhanh chóng xác định chính xác với biên độ khoảng 5-10 phút thời điểm trước,diễn ra và sau khi hệ thống bị xâm nhập. Sau đó tới bước 2 WinDak đề cập mình sẽ kết hợp với phần thông tin trên Firewall cùa ISP thực hiện forensic.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253979</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253979</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 19:13:31]]> GMT</pubDate>
				<author><![CDATA[ vikjava]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Đối với một doanh nghiệp kinh doanh thì mình nghĩ nên có thêm 2 phần quan trọng sau:

1. Các bộ phận liên quan ví dụ support, call center, marketing, ... lập một report về các quan hệ khách hàng trong thời gian gần nhất, tìm hiểu và xác định rõ ràng lý do bị tấn công từ đó khoanh vùng các mục tiêu để dễ dàng làm việc. Các bộ phận như nhân sự, quản lý, ... cũng làm việc tương tự nhưng lại tìm hiểu và xác định lý do bị tấn công trên góc nhìn người trong doanh nghiệp.

2. Làm một bản report tương tự nhưng đối tượng nghiên cứu lại là các khách hàng lớn, các doanh nghiệp liên kết hoặc là với các quan hệ doanh nghiệp phức tạp nhằm tìm hiểu lý do. Có rất nhiều cuộc tấn công xuất phát từ lý do kinh doanh.

Ngoài ra, nếu ngay từ đầu có kế hoạch quản lý rủi ro (risk management plan) nào đó thì nên áp dụng ngay bây giờ.

P/s: những lúc thế này mới thấy việc ngay từ đầu tổ chức, xây dựng chặc chẽ là rất quan trọng và hữu ích.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253980</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253980</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 19:39:46]]> GMT</pubDate>
				<author><![CDATA[ vulehcm]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Với mình thì trước khi làm 1 cái gì đó cũng phải có <font color='red'>1 plan</font>.

Plan và các quá trình của mình sẽ như sau:

<font color='cyan'>TRƯỚC KHI TRIỂN KHAI DỊCH VỤ</font>

1) Thu thập thông tin
- Công đoạn này là xem xét kĩ yêu cầu của công việc và dịch vụ.
=&gt; Tránh thiếu sót hay thừa thãi về sau.
2) Chuẩn bị
- Liệt kê ra 1 danh sách những gì ta cần để thực hiện như là: nguyên liệu (máy chủ, phần mềm, ...)
- Ở bước này kèm theo luôn cả tìm hiểu thông tin về những nguyên liệu đó - như là cấu hình phần cứng liệu có đủ, phần mềm version nào ổn định, tìm hiểu thêm xem có bug mới nào của nó đã được report .... và cuối cùng là theo cảm tính đánh giá về hãng cung cấp để lựa chọn sản phẩm.
- Với yêu cầu đề ra ở đây là &quot;Đảm báo tính bảo mật và uy tín&quot;, ta cần dự phòng và tính trước những sự cố -&gt; Chuẩn bị <font color='red'>server dự phòng</font>.
- Chuẩn bị nhân lực, <font color='red'>phân chia công việc rõ ràng</font>.

<font color='cyan'>TRIỂN KHAI DỊCH VỤ</font>
1) Xây dựng
- Cài đặt và cấu hình server cẩn thận, phân quyền rõ ràng &lt;&gt; Phần lớn các công ty hiện nay mình thấy họ <font color='red'>sử dụng tài khoản root</font> để chạy chung các dịch vụ/ tác vụ trên server.
2) Thử nghiệm và theo dõi trước khi đưa vào sử dụng
- Tiến hành chạy thử và theo dõi kiểm tra xem có phát sinh lỗi gì hay không, ...

<font color='cyan'>SAU KHI TRIỂN KHAI DỊCH VỤ</font>
1) Theo dõi
- Kiểm tra log liên tục.
- Theo dõi và ghi nhận những điểm &quot;không ổn&quot; và đưa ra phương án để &quot;giải quyết&quot;.
- Luôn luôn cập nhật thông tin về các bug,exploit và update hệ thống.
2) Thu thập ý kiến đóng góp người dùng ...

<font color='cyan'>SỰ CỐ SAU KHI TRIỂN KHAI DỊCH VỤ</font>
* Bước này sẽ được giải quyết đơn giản hơn nếu mà ta từ những bước trước chuẩn bị sẵn.
1) Ngắt hoàn toàn các hoạt động của máy chủ chính và những hoạt động liên quan của nó và đưa máy chủ dự phòng vào hoạt động.
2) Đưa ngay thông báo/ cảnh báo đến người dùng.
3) Tiến hành phân tích và điều tra phát hiện lỗi:
- Nếu chúng ta thường xuyên theo dõi log và cập nhật thông tin mới, ta sẽ thu thập được từ đó những thông tin hữu ích.
- Nếu quyền hạn được phân chia rõ ràng, cũng góp phần giúp ta nhanh chóng khoanh vùng đối tượng.
4) Còn tuỳ vào tính chất sự việc mà liên hệ với bên thứ 3 để "cùng giải quyết".
-------------------------------------------

Ở đây theo ý kiến cá nhân của riêng mình, thì trước khi làm 1 cái gì đó cũng nên liệu trước các vấn đề có thể sảy ra và chuẩn bị sẵn từ trước.
Như tình huống của anh conmale đưa ra, nếu ta ngay từ đầu đã đề phòng và chuẩn bị trước thì đã không đến nỗi tệ hại lắm ;)
Còn về uy tín của công ty, không có gì là hoàn hảo cả. Cái &quot;uy tín&quot; này còn phải dựa vào cách ứng xử của công ty đó trong trường hợp này thế nào, có khiến người dùng mất cảm tình hay không mà thôi :))]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253981</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253981</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 19:58:40]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ 1. Cách ly server và đưa vào môi trường riêng để forensic
2. Dựng maintenance server (@baothu)
3. Trong khi chưa tìm ra why, when, how thì nên rebuild server từ đầu, không restored từ backup
4. Press release: sorry khách hàng, tự nhận lỗi, thông báo tình trạng đang điều tra, điếu đóm báo chí (ở VN phải vậy) PR của Cty hơi bị mệt a
5. Bây giờ đến bước forensic:
5.1 đọc log. Hệ thống có central log server + lưu hash integrity thường xuyên + backup log thường xuyên =&gt; chúc mừng, nếu để log trên chính server đó thì chia buồn
5.2 đọc log firewall, ids&ips và packet dump server để xem traffic vào ra server như thế nào
5.3 live memory dump qua 1 máy khác và dùng tool để xem các process nào đang chạy, các file handle nào đang open và các network connection như thế nào
5.4 tắt server, gỡ disk và scan toàn bộ disk kiếm coi có gì nữa không
6. Trả lời được when =&gt; restore từ backup trước đó
    Trả lời được how =&gt; patch, fix và update system & network
    Trả lời được why =&gt; sửa policy, process, company image
    Trả lời được who =&gt; call 113
7. Xong hết nên có press release
8. Share kinh nghiêm trên HVA ;) hoặc cộng đồng chuyên gia để mọi người cùng học hỏi (như apache đã từng làm).

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253982</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253982</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 20:05:53]]> GMT</pubDate>
				<author><![CDATA[ vd_]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ To chiro8x:
- Cung cấp thông tin sai lệch cho báo chí sẽ làm ảnh hưởng rất nhiều đên danh dự và uy tín của công ty đó bạn ;) Trong trường hợp này, người ta thường không cung cấp bất cứ thông tin gì và chờ đến lúc điều tra rõ ràng.

To vd_:
- Rebuild lại server sẽ mất thời gian -&gt; tăng thời gian downtime của hệ thống. Vì vậy ngay từ đầu nếu ta chuẩn bị sẵn server dự phòng thì sẽ khác.

Nếu có thể thì mình thiết lập 2 hệ thống khác nhau (cấu hình, phần mềm, ... ?), hệ thống chính nếu bị tấn công thì đưa hệ thống thứ 2 vào.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253984</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253984</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 20:17:33]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Trong đề trên chỉ có một máy chủ thôi các bạn à. Các bạn cứ đưa ra hệ thống này hệ thóng nọ theo ý của các bạn rồi trả lời trên hệ thống của các bạn thì không thiết thực lắm. Nếu trả lời theo kiểu đó tớ cũng có thể nói "Ngay từ đầu nên đầu tư khoảng 30 server, đường truyền 5GB/s và thuê 40 chuyên gia và 10 anh C50 liên tục canh ngày này qua ngày khác, có chuyện gì cứ tấp cho C50".

Nhắc lại đề của anh conmale cho các bạn Linux admin:
<blockquote>Cho rằng (các phiên bản đưa ra ở đây hoàn toàn là ngẫu nhiên): trang web ấy chạy trên hệ điều hành Windows 2003, sử dụng IIS làm reverse proxy, Apache phiên bản 2.2.15, PHP phiên bản 5.3, sử dụng software thương mại là vBulletin có phiên bản 4.1.5 và cơ sở dữ liệu là mysql phiên bản 5.1. Tất cả các dịch vụ đều chạy trên cùng một máy chủ (dedicated server) và được firewall của ISP bảo vệ. &nbsp;
		</blockquote>
Có bạn nào nghĩ đến chuyện ngay từ đầu chúng ta sẽ triển khai 2 VPS trên dedicated server này không (anh conmale không nói rõ điểm này) ? Lúc đó thì forensics thế nào nhỉ?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253988</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253988</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 20:38:57]]> GMT</pubDate>
				<author><![CDATA[ vulehcm]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Mình xin góp chút ý kiến, có vẻ mang tính lý thuyết nhưng mình nghĩ là cần thiết.
Chuẩn bị: 
- Có kế hoạch dự phòng thảm họa - càng chi tiết càng tốt, chỉ rõ vai trò, chức năng các bộ phận, cách thức phản ứng với một số trường hợp cụ thể như DDoS, mất quyền, lỗi liên quan đến DNS v.v...
- Định kỳ diễn tập như diễn tập quân sự để tăng cường khả năng phối hợp
Trong quá trình vận hành:
- Định kỳ xem qua log, đặc biệt các log liên quan đến quản trị, có thể dung tool để filter - mình nghĩ cái này rất quan trọng, trong diễn đàn cũng nhiều chủ đề về cái này. giám sát log mới có khả năng phát hiện sớm những nguy cơ, rủi ro tấn công cũng như các lỗi khác của hệ thống - Nếu có thể, đẩy log ra 1 hệ thông ngoài để lưu trữ, phân tích định kỳ (Spunk chẳng hạn)
- Thường xuyên theo dõi, cập nhật các bản vá liên quan, signature của FW, IPS
Phản ứng khi bị tấn công:
- Nếu đã có kịch bản sẽ chủ động hơn trong việc phòng chống
- các biện pháp thì các bác phía trên đã bàn nhiều rồi :D
Sau khi bị tấn công:
- Rà soát xem có rút được bài học kinh nghiệm gì không, cố gắng học từ sai lầm của người khác chứ đừng để mình mắc lỗi rồi mà vẫn không học được gì :P]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253993</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#253993</link>
				<pubDate><![CDATA[Wed, 15 Feb 2012 21:21:24]]> GMT</pubDate>
				<author><![CDATA[ leaves]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>

<b>Vui lòng khai triển ở góc độ "forensics" để từ đó mới có thể đưa đến biện pháp.</b>

Mời các bạn tham gia.&nbsp;
		</blockquote>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254010</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254010</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 00:53:52]]> GMT</pubDate>
				<author><![CDATA[ vikjava]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Em nghĩ như sau :D

1. Triển khai một server backup phòng cho việc bị tấn công thế này, 2 server luôn đồng bộ với nhau và luôn dưới dạng passive và active, khi nào bị tấn công 1 server thì lập tức ngắt server để xử lí. Tất nhiên là khi ngắt server chính thì server phụ vẫn chứa lỗi tiềm tàng của server chính. Nhưng mình sẽ tạm thời thay đổi password của admin để phòng việc bị lộ pass. Việc đổi pass có thể mã hoá md5 2 lần để tránh việc attacker brute-force thành công

2. Triển khai IDS/IPS bằng snort để lưu lại log rồi từ đó phân tích file log để phát hiện truy cập. Triển khai firewall để đưa ra các chính sách bảo mật

3.  Luôn luôn update các bản vá mới nhất cho windows cũng như IIS, Apache, tham gia nhiều trang UG hoặc các trang công bố các exploit của server, vbb để fix lỗi ngăn ngừa

4. Kiểm tra kĩ các permission của các user

5. định kì backup server 1 tuần 1 lần để tránh tổn thất khi bị tấn công, quét shell liên tục phòng tránh server bị up shell

6. Nhiều kiddiescript có thể vọc vạch nên cấu hình host cẩn thận, không cho up shell, không cho attacker có thể bypass (tất nhiên với những người nhiều kinh nghiệm thì vẫn có thể)

7.Khi bị tấn công thì phải thừa nhận và công bố trên báo chí, không quăng boom và nguỵ biện như bkav =)) Việc này đảm bảo được uy tín bởi vì tâm lí người dùng không muốn bị lừa đảo tránh để báo chí viết lung tung gây ảnh hưởng

8. Hợp tác với các cơ quan như C50, ISP để điều tra

9. Mời các hacker tấn công để kiểm tra hệ thống, trao thưởng cho hacker mũ trắng phát hiện lỗi v nhằm tăng uy tín và fix được lỗi hệ thống :D


Mong được các anh chỉ giáo thêm :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254011</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254011</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 01:06:55]]> GMT</pubDate>
				<author><![CDATA[ sieunhan93]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Bà con tham gia rất nhiệt tình. Mới có 1 ngày mà có đến 22 thảo luận và gần 900 views  :P . Chứng tỏ "case study" có sự lôi cuốn vì tính thực tế của nó.

Xuyên suốt các thảo luận cho đến nay, hầu hết mọi khía cạnh đều được đề cập đến nhưng tiêu điểm vẫn chưa được khai thác đúng mức mà có chiều hướng nghiêng hẳn về phía "phòng chống" (mặc dù có vài bạn nhắc nhỏ ;) ). Thật ra, khai triển nặng ở góc độ forensics không đơn giản, nhất là chúng ta không có gì để mà... điều tra cụ thể nhưng forensics vẫn có thể được khai triển ở cấp độ khái niệm.

Trước tiên, chúng ta nên xét thật kỹ "đề bài" bởi vì nó gói ghém những chi tiết quan trọng để dựa vào đó mà phân loại và xoáy sâu vào từng phần. Cái này cũng giống như một đề toán hoặc một chỉ thị (cấp trên) đưa xuống để đám kỹ thuật khai triển vậy. Chủ đề cung cấp những thông tin sau:

<i>"Cho rằng (các phiên bản đưa ra ở đây hoàn toàn là ngẫu nhiên): trang web ấy chạy trên hệ điều hành Windows 2003, sử dụng IIS làm reverse proxy, Apache phiên bản 2.2.15, PHP phiên bản 5.3, sử dụng software thương mại là vBulletin có phiên bản 4.1.5 và cơ sở dữ liệu là mysql phiên bản 5.1. Tất cả các dịch vụ đều chạy trên cùng một máy chủ (dedicated server) và được firewall của ISP bảo vệ. "</i>.

Chúng ta có gì?

a. Một máy chủ có nhiều dịch vụ.
b. Máy chủ ấy được ISP bảo vệ.
c. Phiên bản của của hệ điều hành và các dịch vụ.

Khi nói đến điểm a và nói đến forensics, chúng ta nghĩ ngay đến khả năng bị thâm nhập ngay trên 1 máy chủ bởi vì giới hạn được đưa ra chỉ gói ghém trên 1 máy. Khi nói đến 1 dedicated server, ta dễ hình dung đến khả năng penetrate đến chính máy chủ ấy thay vì nhảy từ một máy chủ láng giềng nào khác. Điều này có thể (hoặc có thể không) giới hạn biên độ điều tra bởi vì nếu chưa xét rõ xem ngoài dedicated server ấy, nạn nhân có sở hữu máy chủ nào gần đó và mở toang cửa để thâm nhập và dùng nó làm bàn đạp để xâm nhập mục tiêu? 

Tôi đã từng va phải trường hợp (khi audit một số hệ thống) là bên cạnh máy chủ được sử dụng chính thức (máy A) còn có một máy khác dùng để thử nghiệm (máy B). Khốn khổ là từ máy B có thể rsh hoặc rlogin thẳng vô máy A mà không cần xác thực gì hết. Bởi vậy, bỏ rơi khả năng "máy chủ láng giềng" có thể là bỏ hẳn một mảng rất lới giúp mang lại kết quả cho việc điều tra.

Khi nói đến điểm b, chúng ta nói đến khả năng máy chủ kia hoàn toàn không có cơ chế bảo vệ mà chỉ phụ thuộc vào "dịch vụ bảo vệ" mà ISP cung cấp. Đây có thể là sự trông cậy chết người mà chủ nhân của máy chủ ấy vướng phải. Chẳng có gì bảo đảm rằng hệ thống bảo vệ của ISP chặt chẽ và đúng với nhu cầu và cấu hình thực tế trên cái dedicated server này. Firewall, IPS, IDS..v...v... không thể hoàn toàn lấp được những lỗi và những tắc trách trong cấu hình. Đó là chưa kể khi đụng tình huống, liệu ISP có lưu giữ những thông tin cần thiết cho mục đích forensics hay không?

Điểm c giúp ta xác định các vectors có thể (Windows 2003, Apache, IIS, PHP, vBB, Mysql). Đây có lẽ là những mảnh thông tin rõ ràng nhất và dễ dàng nhất (bug-track everyone? ;) ) nhưng cũng là mảnh cần nhiều thời gian để phân tích logs, điều tra các lỗ hổng ..v..v....

Hãy thử nhìn sự việc ở góc độ một chuyên viên bảo mật và điều tra thay vì ở góc độ một "lính" được sai để... đánh ;). Hãy nhìn bức tranh tổng thể và hình thành cụ thể "kế hoạch tác chiến" từng mảnh một từ những điểm a, b và c. Khoan hãy nhảy thẳng vào góc độ "phòng chống" bởi vì chưa có gì rõ ràng hết.

Mời bà con tiếp tục.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254019</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254019</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 02:40:07]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Do khai triển ở góc độ &quot;forensics&quot; nên em sẽ giả sử như 1 vụ tai nạn giao thông để dễ điều tra theo, như công an hay làm.

Tai nạn giao thông thì đầu tiên là phải: 

- Giữ nguyên hiện trường = Giữ nguyên hiện trạng của máy chủ, tách máy chủ này ra khỏi mạng network, không thay đổi gì cả để tiện điều tra. (Chứ giờ thằng này đang sang đường sai lè, người nhà nó chạy ra đá hộ vào cái công tắc "xi nhan" thì công việc điều tra hỏng hết)

- Giúp việc đi lại được tiến hành bình thường:
+ đối với ô tô to (Không có 1 server để chạy dự phòng ) -&gt; căng dây báo hiệu cho các xe không đi vào = cho đăng 1 thông báo website đang bảo trì hệ thống.
+ đối với xe cơ giới loại nhỏ, xe máy, xe đạp (có 1 server để chạy dự phòng khi gặp sự cố ) = tiếp tục cho website chạy bình thường. máy chủ này bật chế độ monitor lại, để monitor lại toàn bộ mọi thứ tác động đến máy chủ.

- Thông báo với gia đình nạn nhân = thông báo các thông tin cần thiết cho khách hàng, để tránh tình trạng 1 số báo lá cãi đưa tin bậy. (việc này là để đảm bảo <font color='red'>uy tín của công ty</font>, tránh tình trạng như BKAV )

- Điều tra xem lái xe có uống rượu bia, và gia đình có tiểu sử về bệnh thần kinh hay không = kiểm tra xem các ứng dụng được cài đặt trên server có lỗi gì không?

- Xem các yếu tố tác động trực tiếp và gián tiếp đến vụ tai nạn = Yêu cầu ISP cung cấp thêm các thông tin để tiện điều tra.

- Truy tìm thằng gây tai nạn xong bỏ chạy = bắt thằng hack  :D 

<p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>Do hạn chế về trình độ, nên nếu là mình thì mình sẽ rút điện Server và gọi cho C50 nhờ vả&nbsp;
		</blockquote>

Đọc bài của bác gà mở mà em rối tung đầu, chả biết thảo luận cái gì nữa]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254020</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254020</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 02:58:51]]> GMT</pubDate>
				<author><![CDATA[ phanledaivuong]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Hì,

Có lẽ tại quá chú ý vào "Để <font color='red'>bảo đảm bảo mật và uy tín</font> của công ty, theo bạn, công ty ấy cần khai triển những gì và lý do tại sao?" nên em đi sang chiều hướng phòng chống.

Do bản thân em cũng chưa được trải nghiệm thực tế hay được chỉ dẫn qua nên có thế cái góc nhìn của em vẫn chưa được rõ ràng, các ý kiến nêu ra cũng chỉ là ý kiến cá nhân. Nhưng không sao :) tiếp tục lấy sự "hóng hớt" và "bồi dưỡng" thêm kiến thức và tiếp tục thảo luận là tiêu chỉ  -:-)

Ở đây chúng ta nắm được các thông tin sau:
<blockquote>
a. Một máy chủ có nhiều dịch vụ.
b. Máy chủ ấy được ISP bảo vệ.
c. Phiên bản của của hệ điều hành và các dịch vụ. 
&nbsp;
		</blockquote> 

Điều cần làm trước hết khi sảy ra sự cố:
1) Dữ nguyên hiện trạng và cách ly máy chủ này.
2) Thông báo/ Cảnh báo đến người sử dụng. (Điều này nên thực hiện sớm nhất có thể, nó sẽ ảnh hưởng đến cách đánh giá từ phía người sử dụng)
3) Sử dụng máy chủ dự phòng để đưa dịch vụ hoạt động trở lại - song song đó tiến hành <font color='red'>theo dõi kĩ lưỡng</font> các truy cập (Nếu ta đứng ở phía attacker, với cái tâm lý "hả hê" thì cứ vài phút lại F5 trở lại coi thành quả của mình chẳng hạn =)) hoặc attacker vô tình để lộ thông tin.)

Tiến hành phân tích máy chủ bị thâm nhập
1) Nhìn ngay vào cái đồng hồ, khoanh vùng thời gian sảy ra sự cố.
2) Khoanh vùng đối tượng.
- Trước khi đi sâu vào kĩ thuật, xem xét khả năng nhân viên để lộ mật khẩu.
- Kiểm tra các kết nối "đặc quyền" được cho phép từ bên ngoài.
- Cuối cùng mới đi vào kĩ thuật.
3) Khi đi vào kĩ thuật, đầu tiên ta sẽ chú ý đến "hệ thống phòng thủ" vốn có
- Lúc này xem xét lại khả năng phát hiện và ngăn chặn của hệ thống, ghi nhận những điểm yếu kém của nó - Góp phần giúp ta suy đoán ra phuơng thức attacker sử dụng.
4) Thu thập thông tin từ logs và tìm hiểu về lỗ hổng của phần mềm
- Dựa vào những dấu hiệu mà ta suy đoán.

Điều tra attacker (Còn tuỳ trường hợp và tình huống)
1) Dựa vào các thông tin thu thập được từ bước phân tích, ta đặt mình vào phía attacker.
2) Suy đoán những hướng đi và phuơng thức rồi tiến hành "đặt bẫy" - khả năng attacker trở lại cao.
3) Tìm hiểu thêm thông tin từ bên ngoài ...]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254035</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254035</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 04:28:20]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <i><b>a. Một máy chủ có nhiều dịch vụ. 
b. Máy chủ ấy được ISP bảo vệ. 
c. Phiên bản của của hệ điều hành và các dịch vụ. </b></i>

Một máy chủ duy nhất, thông thường một vài đơn vị nhiều chí phí không thích sài dịch vụ shared hay dịch vụ server nằm trong 1 cụm server. Chuyện Server này như chuyện vác 1 cái server tới ISP, thuê chổ đặt, thê IP, thuê firewall(email,web,...), proxy server, thuê hoặc không thuê quản trị ở ISP. Và gần như là phó mặt luôn cho quản trị của ISP. 

Chuyện trên dẫn tiếp chuyện , HDH và tùm lum dịch vụ ở trên cái server đó có được update hay không, phải xem người đi gửi server có kí hợp đồng với ISP về công việc này không. Có yêu cầu thông báo tình trạng log gửi qua mail cho người gửi server hay không. Chuyện này lại càng phụ thuộc vào người gửi.

Hai chuyện trên dẫn tiếp chuyện, người gửi server(khách hàng) có quan tâm tới LOG hoạt động của các dịch vụ, thường xuyên theo dõi bug có thể gây ra vấn đề dịch vụ gặp lỗi ngẫu nhiên, lỗi mất quyền truy cập dịch vụ vào tay kẻ xấu khai thác lỗi,.... <i><b>bug-track </b></i>

Những chuyện trên sẽ là cơ sở để xem xét hiện trạng của server và các dịch vụ. Tình trạng nguyên thuỷ của các dịch vụ, HDH hay gọi là nguyên trạng có những gì. Sau đó , quản trị ở ISP đã thêm những configuration trực tiếp gì lên server, có ghi lại cấu hình sau đó không. Có cấu hình log liết gì không ? Có PLAN backup và có PLAN theo dõi LOG và thông báo sự cố không ?

Lại tiếp tục tính tiếp việc theo dõi hiện trạng , sau khi có sự cố. Ghi nhận lại thời điểm mà sự cố xảy ra để làm một cái mốc thời gian, tuy có thể nó không thực sự đúng với thời điểm mà kẻ xấu đã khai thác 1 lỗi. Từ đó kiểm tra ngược lại, dịch vụ nào có lỗi gì được khai thác, thời điểm dịch vụ được thêm cấu hình, dịch vụ tạo được thêm, thay đổi, chèn 1 data,configuration vào để phục vụ cho việc khai thác lỗi. 

Đứng lại suy nghĩ tại sao để phán đoán tình hình, khách hàng thuê FIrewall tập trung của ISP nên không hề suy xét tới thiết lập các biện pháp hỗ trợ phán đoán sự cố ngay trên server, cập nhật server. Việc này khẳng định nghi ngờ chính các dịch vụ trên server bị thao túng. Và một vấn đề khác cũng phải xem lại, firewall của ISP là loại phục vụ cho vô vàn dịch vụ dùng chung. Có thể nó cũng đã cho qua một số truy vấn server, được phép và hợp lệ, tất nhiên là đối với nó. 

Công tác cụ thể tiếp theo là moi móc các dịch vụ và HDH. Chuyện này như chị gamma95 đề xuất, gọi C50 là một cách. 
Biện pháp cụ thể ra sao, mời các bác chuyên kiêm tra ra tay. 

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254036</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254036</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 04:29:33]]> GMT</pubDate>
				<author><![CDATA[ tmd]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Trên phương diện của 1 forensic tôi có 1 vài nhân định:
- Không nên chủ quan mình là "chuyên gia bảo mật hàng đầu " mà chủ quan, rà soát lại tất cả hệ thống , tốt hơn là nên có sự tham gia của các chuyên gia bên ngoài công ty (C50...)
- Cách li sever bị hack đề phòng hacker vẫn có thể cài mã độc nhăm lấy thông tin của nhưng người tò mò truy cập vào, mặt khác , tránh lây lan ...
- Theo nhân định của Conmale hay đúng hơn là "suy đoán" dựa trên nhưng gì Conmale thấy thì Sever của BKAV dngf IIS vì vậy phải path các lỗ hổng... (Các hacker có thể sử dụng những lỗi bảo mật rất bình thường dó ý thức chủ quan của người quản trị về những lỗi bình thường đó).
- Tổ chức cuộc họp kín trong BQT nói riêng cũng như lãnh đạo công ty nói chung để rút kinh nghiệm, đòng thời đưa ra phuơng an trấn an dư luận, vì đây là cách chuyên nghiệp nên làm của 1 công ty "uy tín" như BKAV.
- Cuối cùng cũng không kém phần quan trọng, là điều tra chính các thành viên trong nội bộ BKAV.
Thân..]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254048</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254048</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 06:44:03]]> GMT</pubDate>
				<author><![CDATA[ __mask]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Nếu em là chuyên viên nhận trách nhiệm khắc phục server sau khi bị thâm nhập. Em nghĩ em sẽ làm như thế này:

Xác định các đối tượng liên quan:
Ai liên quan đến sự cố thâm nhập ?
- Khách hàng
- Công ty
- ISP
- Xã hội

Công ty cần làm gì với các bên ?
- Với khách hàng: 
+ Trong thời gian đầu nên chỉ thông báo với khách hàng server đang bảo trì
+ Đồng thời chuẩn bị sẵn sàng trường hợp sự cố dai dẳng, không thể chốc lát mà giải quyết được 
    -&gt; Cần phải nói rõ với khách hàng về mức độ thiệt hại
    -&gt; Chuẩn bị các phương án đền bù nếu mức độ thiệt hại ảnh hưởng đến khách hàng

- Với ISP:
+ Contact trực tiếp với bên ISP 
 -&gt; Yêu cầu họ cô lập server
 -&gt; Yêu cầu họ giữ nguyên hiện trạng
 -&gt; Tiếp tục yêu cầu họ báo cáo tình hình server, mức độ thiệt hại, ảnh hưởng

Những báo cáo đó có thể được chính nhân viên của công ty đó phân tích (nếu họ có thể) hoặc chuyển giao cho bên thứ ba như C50 hoặc tiến hành trong sự hợp tác cả ba bên: nhân viên kỹ thuật của công ty, ISP và C50

+ Xem xét các điều khoản với ISP. Trách nhiệm của ISP trong trường hợp này là gì ?

- Với xã hội:
  -&gt; Cần một phát ngôn viên chính thức để thông cáo tình hình với báo chí. Luôn luôn đảm bảo giữ một kênh thông tin liên lạc thường xuyên và chính thức với cánh báo giới.

- Hiện trạng là gì ?
+ Dịch vụ nào không hoạt động
+ Những bất thường xảy ra đã ghi nhận được

- Xác nhận thời điểm tấn công gần đúng qua file log
(*) Riêng chuyện file log có thể bị làm giả, mất tính toàn vẹn thì em cũng chưa biết sẽ xử lý thế nào ?

- Loại hình mà attacker đã sử dụng để thâm nhập server
+ Kết hợp hai yếu tố trên cộng với xem xét lại cấu hình hệ thống tìm ra cách mà attacker đã dùng để thâm nhập
+ Tại đây, nhân viên phân tích cũng sẽ lưu tâm đến các yếu tố liên quan: Liệu xung quanh thời điểm bị tấn công, dedicated server có liên hệ với server nào khác, có được sửa đổi cấu hình gì không. 

- Thử nghiệm
+ Thử dựng lại tình huống tương tự với các điều kiện tương tự để xác nhận các phỏng đoán về cách thâm nhập

- Xác định nguyên nhân
+ Biết được cách thâm nhập thì sẽ tìm ra lỗ hổng của hệ thống

- Khắc phục
+ Tìm cách bít lỗ hổng này

- Tính đến các giải pháp lâu dài:
Lỗ hổng đã được vá. Công ty cần xem xét xây dựng bổ sung quy chế bảo mật và điều khoản chặt chẽ minh bạch với ISP

- Mở rộng điều tra:
Tìm xem nguồn gốc tấn công đến từ đâu ?
...
Đến đây thì em mù mờ. Em không có những kỹ năng chuyên sâu của lãnh vực bảo mật và forensics nên không thể đi sâu hơn nhưng với đề bài này thì em nghĩ tiêu điểm của case study không nhằm hướng tới các chi tiết kỹ thuật phức tạp, nặng tính chuyên môn  :) 


]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254070</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254070</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 11:06:01]]> GMT</pubDate>
				<author><![CDATA[ TheEyes]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <blockquote>- Xác nhận thời điểm tấn công gần đúng qua file log
smilie Riêng chuyện file log có thể bị làm giả, mất tính toàn vẹn thì em cũng chưa biết sẽ xử lý thế nào ? 
&nbsp;
		</blockquote>
- Quản lí log tập trung, log dữ liệu không trực tiếp lưu trên máy chạy dịch vụ đó mà mỗi record trong quá trình ghi nhân sẽ được đẩy qua Log Centralize. 

- Tuy nhiên nếu Attacker hoàn toàn có thể làm sai log (đầu độc, gây nhiễu, v.v...) trước khi quá trình đẩy log từ máy chủ dịch vụ đến máy chủ lưu trữ log. Đối với vấn đề này, thì mình vẫn chưa có giải pháp nào, mời mọi người cho ý kiến
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254106</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254106</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 22:11:51]]> GMT</pubDate>
				<author><![CDATA[ Ikut3]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Ikut3 wrote:</cite><br>
		<blockquote><blockquote>- Xác nhận thời điểm tấn công gần đúng qua file log
smilie Riêng chuyện file log có thể bị làm giả, mất tính toàn vẹn thì em cũng chưa biết sẽ xử lý thế nào ? 
&nbsp;
		</blockquote>
- Quản lí log tập trung, log dữ liệu không trực tiếp lưu trên máy chạy dịch vụ đó mà mỗi record trong quá trình ghi nhân sẽ được đẩy qua Log Centralize. 

- Tuy nhiên nếu Attacker hoàn toàn có thể làm sai log (đầu độc, gây nhiễu, v.v...) trước khi quá trình đẩy log từ máy chủ dịch vụ đến máy chủ lưu trữ log. Đối với vấn đề này, thì mình vẫn chưa có giải pháp nào, mời mọi người cho ý kiến
&nbsp;
		</blockquote>

Mánh này sẽ bị phát hiện nếu người quản trị chơi trò "nhét que tăm khe cửa". ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254110</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254110</link>
				<pubDate><![CDATA[Thu, 16 Feb 2012 22:17:56]]> GMT</pubDate>
				<author><![CDATA[ tmd]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Ikut3 wrote:</cite><br>
		<blockquote><blockquote>- Xác nhận thời điểm tấn công gần đúng qua file log
smilie Riêng chuyện file log có thể bị làm giả, mất tính toàn vẹn thì em cũng chưa biết sẽ xử lý thế nào ? 
&nbsp;
		</blockquote>
- Quản lí log tập trung, log dữ liệu không trực tiếp lưu trên máy chạy dịch vụ đó mà mỗi record trong quá trình ghi nhân sẽ được đẩy qua Log Centralize. 

- Tuy nhiên nếu Attacker hoàn toàn có thể làm sai log (đầu độc, gây nhiễu, v.v...) trước khi quá trình đẩy log từ máy chủ dịch vụ đến máy chủ lưu trữ log. Đối với vấn đề này, thì mình vẫn chưa có giải pháp nào, mời mọi người cho ý kiến
&nbsp;
		</blockquote>

- Quá trình đẩy log từ máy chủ dịch vu đến máy chủ lưu trữ log thông thường đòi hỏi Real Time. Vì khi triển khai giải pháp log tập trung thì máy chủ này không chỉ có nhiệm vụ lưu trữ log, nó có thể thực hiện chức năng tương tự như 1 IDS. Thời gian phản ứng với sự cố càng sớm càng tốt ....

- Case study này có lẽ không liên quan đến giải pháp log tập trung hay làm cách nào để đối phó với tình trạng làm nhiễu log, xoá log. Hành động làm nhiễu log, xoá log thông thường đi sau hành động tấn công, server bị nhân nhượng vì thế có lẽ nên tập trung vào giải pháp ở các tầng, các lớp bằng việc monitor, detect, alert đối với những event thuộc dấu hiệu hack ....

Tập trung vào 3 đối tượng anh conmale đề cập cũng đã có nhiều thứ để bàn rồi, mở rộng ra sẽ loãng  :) 

<b>a. Một máy chủ có nhiều dịch vụ.
b. Máy chủ ấy được ISP bảo vệ.
c. Phiên bản của của hệ điều hành và các dịch vụ.</b>

@tmd: không hiểu bác nói gì cả #:S 
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254217</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254217</link>
				<pubDate><![CDATA[Fri, 17 Feb 2012 04:14:47]]> GMT</pubDate>
				<author><![CDATA[ vikjava]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">vikjava wrote:</cite><br>
		<blockquote>

<b>a. Một máy chủ có nhiều dịch vụ.
b. Máy chủ ấy được ISP bảo vệ.
c. Phiên bản của của hệ điều hành và các dịch vụ.</b>
&nbsp;
		</blockquote>

Ở góc độ forensics, 3 điểm trên chính là biên độ điều tra (ngôn ngữ chuyên ngành còn gọi là perimeters). 

Biên độ "được ISP bảo vệ" có thể rất mơ hồ bởi vì phần lớn các ISP chỉ áp dụng một hệ thống chung nhằm cản lọc những "known vulnerabilities". Hầu hết, những attack vectors mới hoặc chưa report đều qua mặt những hệ thống cản lọc chung chung của ISP. Tệ hại nhất là thông tin để điều tra hầu như không có mấy vì chẳng có ISP nào chịu logs những hoạt động ra vào (cũng dễ hiểu vì chẳng có hệ thống lưu trữ nào đủ lớn để lưu những thông tin hoạt động ra vào). Trường hợp dedicated server bị tấn công là "fully managed" và có hệ thống bảo vệ + theo dõi riêng thì không kể nhưng dạng này thuộc dạng quý hiếm và dường như ở VN không có.

Nói chung, nếu dựa vào ISP để thu thập thông tin cho mục đích forensics và những hoạt động ấy đang xảy ra thì khả thi nhưng nếu đã xảy ra trước đây thì khá vô vọng.


Biên độ "một máy chủ có nhiều dịch vụ" có thể có những điểm quan trọng để điều tra, ví dụ: system logs, IDS logs, application logs... Tuy nhiên, nếu system và applications chỉ log lại những thông tin "bất thường" và hoàn toàn không logs những thông tin "không bất thường" thì rất kẹt. Hầu hết những tấn công ở "web" vectors khó có thể xác định tính "bất thường" ngoại trừ trường hợp IDS và applications có những quy chế logs chặc chẽ. Trong trường hợp kẻ tấn công là kẻ có kinh nghiệm, ngoài khả năng xoá trọn bộ logs (theo kiểu cover-tracks cổ điển mà mấy cuốn sách "dạy hack" thường đề cập  :P  ), kẻ tấn công có thể "gây nhiễu" trong logs hoặc chỉ xoá những thông tin cần được xoá trong logs. Cách thứ nhì là cách sẽ gây khó khăn bởi vì mọi chuyện có vẻ như bình thường nhưng quả thật hệ thống đã bị thâm nhập nhưng không biết bị thâm nhập ở vector nào. Cách này chứng tỏ hacker ấy là một kẻ dày dạn, có thừa thời gian và thừa điềm tĩnh để "gây nhiễu" trên chính hệ thống mình thâm nhập. Trong trường hợp này, nếu forensics không khéo sẽ bị lạc hướng (thay vì bế tắc như trường hợp logs bị xoá hoàn toàn). Xét ở góc độ phòng chống, nếu không thu thập được thông tin cho forensics mà vẫn tiếp tục sử dụng hệ thống ấy như cũ thì đó là quyết định dại dột.


Forensics chỉ có thể mang lại kết quả nếu như hệ thống đã được sắp xếp và ấn định sẵn. Nếu chỉ dựa vào cơ chế "logging" tiêu chuẩn của hệ điều hành và của từng application thì xem như là thất bại (ngoài trừ trường hợp hacker quá thiếu kinh nghiệm nên không thực hiện "cover-track" đúng bài bản).

Nếu hệ thống được áp dụng passive monitoring (như snort theo dõi ở dạng stealth) và có remote loggings + kernel level keylogging và những thứ này không bị hackers phát hiện thì chắc chắn sẽ thu thập được nhiều thông tin quý giá. Nếu gặp phải hacker dày dạn (như cỡ cố tình làm nhiễu logs) thì những cơ chế ấy có thể bị ép cho ngưng hoạt động hoặc thậm chí cố gây nhiễu thì cũng sẽ tạo muôn vàn khó khăn cho forensics.
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254576</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254576</link>
				<pubDate><![CDATA[Sun, 19 Feb 2012 19:16:01]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <blockquote>Forensics chỉ có thể mang lại kết quả nếu như hệ thống đã được sắp xếp và ấn định sẵn. Nếu chỉ dựa vào cơ chế &quot;logging&quot; tiêu chuẩn của hệ điều hành và của từng application thì xem như là thất bại (ngoài trừ trường hợp hacker quá thiếu kinh nghiệm nên không thực hiện &quot;cover-track&quot; đúng bài bản). &nbsp;
		</blockquote>

Vậy ở đây, forensics mang lại nhiều kết quả khi mà hệ thống được sắp xếp từ trước (có thể là nhiều nếu &quot;hacker không chuyên&quot; và ít hoặc khó khăn nếu &quot;hacker cao thủ&quot; ).
Nếu những hệ thống khi mà trước đó không được chuẩn bị từ trước (rất nhiều ở VN lẫn trên thế giới) khi bị tấn công phải chăng là &quot;khó khăn để tìm ra cho đến mức độ vô vọng&quot; ?

Ở trên, mọi người &quot;phụ thuộc&quot; vào logs để suy đoán diễn biến và hiện trạng là nhiều. Theo như em thấy thì song song nó, hằng ngày ta cũng nên theo dõi những cập nhật và phát hiện lỗi mới. Nó sẽ giúp cho quá trình forensics nhanh phát hiện ra vấn đề hơn (với nhiều trường hợp - cụ thể là những công bố lỗi bảo mật mới nhất của phiên bản dịch vụ).

=&gt; Biên độ &quot;Phiên bản của của hệ điều hành và các dịch vụ&quot; sẽ có ích hơn nhiều.

Về mặt tâm lý quản trị viên, như 1 bạn Sứ giả thiện chí của BKAV có nickname Longdo đã từng viết:
<blockquote>
Với một website đang beta như webscan, người ta chủ yếu theo dõi các chỉ số truy cập, seo, phản hồi người dùng...chứ không phải lúc nào cũng lùng sục lên code đâu bạn ạ. 
&nbsp;
		</blockquote>

Từ đây ta nhận thấy 1 điều rằng, đôi khi những cái &quot;current&quot; logs thường có &quot;khoảng thời gian không được động đến cho đến khi 1 sự việc nào đó sảy ra&quot; và cần phải kiểm tra.
Với 1 hệ thống lớn, nhiều người truy cập. Chắc hản sẽ có ấn định xoá logs trong 1 khoảng thời gian (có thể là sau vài tuần cho đến vài tháng) để tránh tình trạng hệ thống có nhiều &quot;rác&quot; ngốn hết tài nguyên.

Với 1 attacker khôn ngoan và có tính kiên nhẫn, với mục tiêu của anh ta. Trong trường hợp anh ta tấn công hệ thống thành công và cài đặt thành công backdoor nhưng &quot;dìm ỉm&quot; chuyện đó (không như anh bạn hacker kia để 1 file html to đùng ngay sau khi xâm nhập thành công). Và vài tháng sau anh ta trở lại để thực hiện hành vi phá hoại của mình thì như vậy những cái logs lưu giữ thông tin quạn trọng nhất để có thể hình dung ra quá trình bị thâm nhập lại không còn nữa ...

=&gt; Thường xuyên theo dõi tình trạng hệ thống và kiểm tra logs định kì + đầy đủ cũng rất quan trọng.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254581</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254581</link>
				<pubDate><![CDATA[Sun, 19 Feb 2012 20:41:59]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">vikjava wrote:</cite><br>
		<blockquote>

<b>a. Một máy chủ có nhiều dịch vụ.
b. Máy chủ ấy được ISP bảo vệ.
c. Phiên bản của của hệ điều hành và các dịch vụ.</b>
&nbsp;
		</blockquote>

Ở góc độ forensics, 3 điểm trên chính là biên độ điều tra (ngôn ngữ chuyên ngành còn gọi là perimeters). 
.... 
&nbsp;
		</blockquote>

Nếu bài này là đáp án thì ở case study này thì tất cả đều trượt à anh  :( ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254631</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254631</link>
				<pubDate><![CDATA[Mon, 20 Feb 2012 00:50:11]]> GMT</pubDate>
				<author><![CDATA[ phanledaivuong]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">phanledaivuong wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">vikjava wrote:</cite><br>
		<blockquote>

<b>a. Một máy chủ có nhiều dịch vụ.
b. Máy chủ ấy được ISP bảo vệ.
c. Phiên bản của của hệ điều hành và các dịch vụ.</b>
&nbsp;
		</blockquote>

Ở góc độ forensics, 3 điểm trên chính là biên độ điều tra (ngôn ngữ chuyên ngành còn gọi là perimeters). 
.... 
&nbsp;
		</blockquote>

Nếu bài này là đáp án thì ở case study này thì tất cả đều trượt à anh  :( &nbsp;
		</blockquote>

Hầu như là trượt ;). Nếu anh chấm cho nghiêm khắc thì điểm cao nhất là 40/100 ;).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254637</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254637</link>
				<pubDate><![CDATA[Mon, 20 Feb 2012 01:42:44]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>

Với 1 attacker khôn ngoan và có tính kiên nhẫn, với mục tiêu của anh ta. Trong trường hợp anh ta tấn công hệ thống thành công và cài đặt thành công backdoor nhưng &quot;dìm ỉm&quot; chuyện đó (không như anh bạn hacker kia để 1 file html to đùng ngay sau khi xâm nhập thành công). Và vài tháng sau anh ta trở lại để thực hiện hành vi phá hoại của mình thì như vậy những cái logs lưu giữ thông tin quạn trọng nhất để có thể hình dung ra quá trình bị thâm nhập lại không còn nữa ...

.&nbsp;
		</blockquote>

@.lht.: theo bác khi mò vào được hệ thống rồi, cài "backdoor" rùi. và im ỉm chờ hết một tháng ( ví dụ ) cho hệ thống nó tự huỷ cái bộ logs hôm mò mẫm vào đi. .. cho an toàn rồi hãy BACK quay trở lại qua đường backdoor à bác? thế khi bác quay lại qua đường backdoor đó. hệ thống có làm ra tí lóc ( logs ) cóc nào kô bác ??? để em còn chờ...:D, vì em chỉ biết cách cổ điển là cover -tracks thôi bác. ( nói thẳng là chỉ biết và cố xoá trọn bộ logs ) xin các bác các anh cho ý kiến ạ . 

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254683</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254683</link>
				<pubDate><![CDATA[Mon, 20 Feb 2012 10:18:34]]> GMT</pubDate>
				<author><![CDATA[ Nowhereman]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Ở trên mình có nói mà :D Những thông tin quan trọng nhất để phát hiện lỗ hổng lúc này có thể đã bị &quot;tự huỷ&quot; nên nếu khi &quot;back&quot; thì mình qua đường backdoor. 

Mục tiêu của người quản trị là tìm ra &quot;lỗ hổng chính&quot; để fix, còn attacker lại cao tay hơn &quot;chờ&quot; 1 thời gian &quot;quay lại với con đường khác đã mở ra từ trước&quot; chứ không theo con đường cũ. Sự việc này sẽ khiến 1 người quản trị &quot;không thường xuyên theo dõi (lười)&quot; khó tìm ra được vấn đề.

<blockquote>=&gt; Thường xuyên theo dõi tình trạng hệ thống và kiểm tra logs định kì + đầy đủ cũng rất quan trọng. &nbsp;
		</blockquote> 

:D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254695</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254695</link>
				<pubDate><![CDATA[Mon, 20 Feb 2012 12:25:22]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>Ở trên mình có nói mà :D Những thông tin quan trọng nhất để phát hiện lỗ hổng lúc này có thể đã bị &quot;tự huỷ&quot; nên nếu khi &quot;back&quot; thì mình qua đường backdoor. 

Mục tiêu của người quản trị là tìm ra &quot;lỗ hổng chính&quot; để fix, còn attacker lại cao tay hơn &quot;chờ&quot; 1 thời gian &quot;quay lại với con đường khác đã mở ra từ trước&quot; chứ không theo con đường cũ. Sự việc này sẽ khiến 1 người quản trị &quot;không thường xuyên theo dõi (lười)&quot; khó tìm ra được vấn đề.
&nbsp;
		</blockquote>

Đây là 1 case study khá hay để thâm nhập xoá vết hơn là điều tra :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254850</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254850</link>
				<pubDate><![CDATA[Wed, 22 Feb 2012 00:20:37]]> GMT</pubDate>
				<author><![CDATA[ phanledaivuong]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Nhân tiện trang diễn đàn BKAV vừa bị tấn công (defaced và mất DB), tôi xin đưa ra một "case study" thực tế như sau:

Một trang web của công ty vừa bị thâm nhập. <b><font color='red'>Để bảo đảm bảo mật và uy tín của công ty, theo bạn, công ty ấy cần khai triển những gì và lý do tại sao?</font></b>

Cho rằng (các phiên bản đưa ra ở đây hoàn toàn là ngẫu nhiên): trang web ấy chạy trên hệ điều hành Windows 2003, sử dụng IIS làm reverse proxy, Apache phiên bản 2.2.15, PHP phiên bản 5.3, sử dụng software thương mại là vBulletin có phiên bản 4.1.5 và cơ sở dữ liệu là mysql phiên bản 5.1. Tất cả các dịch vụ đều chạy trên cùng một máy chủ (dedicated server) và được firewall của ISP bảo vệ.

<b>Vui lòng khai triển ở góc độ "forensics" để từ đó mới có thể đưa đến biện pháp.</b>

Mời các bạn tham gia.&nbsp;
		</blockquote>

Hì hì, bác conmale đưa ra các phiên bản của HĐH và applications của một hệ thống một cách ngẫu nhiên mà dường như thấy "sát sàn sạt", nó đang gần giống như một hệ thống nào đó mới bị defaced và bị tấn công DDoS (hay chỉ là DoS thôi) và "sập tiệm".

<i>Win 2K3 thì như đúng rồi, IIS hay nginx làm reverse proxy nhỉ, chắc là IIS?, PHP 5.3.x -có nên thêm con số x nào đấy vào cho thật cụ thể không? , Apache (Win32) thì có lẽ là 2.2.17 cho nó mới hơn, dù thế hiện cũng đã cũ. Thế hệ thống có cài ActivePerl không nhỉ? Các thứ khác thì xin OK!</i>

Hì hì! chỉ giỡn đôi chút để làm các bạn vui thêm sau khi căng thẳng suy nghĩ về câu hỏi của anh conmale mà thôi!
----------------------
Nay xin quay về câu hỏi của anh conmale.

Trên đây có nhiều bạn đã trả lời với nhiều ý kiến. Có những ý kiến khá hay, đáng học hỏi. Nhưng có vẻ có những ý kiến hơi khái quát, hơi bao quát quá. Các giải pháp đưa ra có thể hay chỉ áp dụng như một nguyên tắc, nguyên lý, qui định chung về bảo mật hay khắc phục sự cố mà thôi.

Tôi xin bổ sung thêm một vài ý kiến nhỏ.

Ta giả dụ hệ thống bị defaced theo cách mà trang web webscan.bkav.com.vn bị defaced, nghĩa là hacker đặt đươc một file "hacked.html" vào thư mục gốc hay Documentroot của Apache, tức là của webserver và sau đó một vài ngày nó bị tấn công từ chôi dịch vụ và bị ngưng trệ trong nhiều ngay, dù có vẻ không có sự tham gia của một hệ thống botnet (DDoS zombies) trên mạng.

Điều quan trọng đâu tiên chúng ta phải xác định rõ cấu hình cụ thể của webserver vừa bị hack. 
Trước tiên, <font color='orange'><b>loại  HĐH</b></font> mà webserver cài đặt là một yếu tố rất quan trọng cần phải xem xét. Win2k3 hay Windows OS nói chung có những điểm yếu rất khó khắc phục, tạo cơ hôi cho hacker thâm nhập. Vấn đề phải tìm xem hành đông hay hiện tượng thâm nhập vừa qua có liên quan đến điểm yếu nào của Win2K3 hay không?
 Chú ý là việc update tự động các lỗ hổng bảo mật cho Windows thì MS làm khá tốt và dễ dàng. Vì vậy chỉ nên tập trung vào các lỗi mà admin của hệ thống bị hack chưa kip update, vì một lý do nào đó, hay lỗi mà MS chưa kịp ban hành bản vá lỗi trên mạng. Có rất ít hacker tim ra lỗi 0-day để hack.

 Điểm thứ hai chúng ta phải xem xét đến phiên bản <font color='orange'><b>web server </b></font>(trình quản lý web) được cài trong hệ thống. Ở đây là Apache(Win32)2.2.15. Apache không ban hành các bản vá lỗi tự động như MS cho Windows. Họ chỉ ban hành các phiên bản mới thay cho các phiên bản cũ có lỗi, có khả năng bị hack. Hiện nay đã là Apache 2.2.22 (released 2012-01-31). Chỉ cần tham khảo tài liệu của Apache là biết các lỗi của phiên bản cũ. Vấn đề chỉ còn là phải xác định hiện tượng và hành đông xâm nhập cụ thể của hacker vừa qua có liên quan đến các lỗi này không và đó là lỗi nào? (Tuy nhiên xác định được điều này không hề dễ dàng tí nào).

 Điểm thứ 3, nhưng có khi lại là quan trọng nhất là các <font color='orange'><b>application</b></font> được cài đặt trong hệ thống. Các application ở đây là PHP 5.3, MySQL 5.1, vBulletin 4.1.5.... Chú ý là các application mới là các nguyên nhân tạo ra nhiều lỗ hổng để cho hacker đột nhập hay defaced hệ thống. Một Application đươc cải tiến để tiện dụng hơn, có nhiều tính năng hơn thì lai càng có nhiều lỗ hổng hơn, đó là hậu quả, là "side effect", điển hình là PHP chẳng hạn.

 Vì vậy nếu hiện tượng haker defaced website và để lai một file "hacked.html" ở root thì điều trước tiên ta phải nghĩ đến lỗi RFI (không phải "Đài phát thanh Pháp quốc" đâu nhé! Hì hì- mà là Remote file Inclusion vulnerability) hay LFI (Local File Inclusion). Lỗi này cho phép hacker đưa (upload) một file bẩn vào hệ thống từ xa và đặt nó ở directory hacker mong muốn. Vấn đề là admin của hệ thống đã không config. PHP (cụ thể là file php.ini) kỹ càng....<font color='orange'>(Các bạn ở BKAV cũng nên kiểm tra lai điều này).</font> Chú ý là chỉ PHP đời mới sau này, như PHP 5.3.x, mới có lỗi này. Hì hì.

Tất nhiên một hệ thống Windows cài DotNet (.Net framework ) như hệ thống mà anh conmale đưa, cũng có lỗi RFI, nhưng khả năng hacker tận dụng lỗi này có vẻ ít hơn.
 Chúng ta nhớ lai, trong đợt các hacker TQ defaced hàng loạt website của VN vừa qua, chúng cũng tận dụng lỗi nói trên (RFI). Ngược lai các hacker trẻ VN cũng làm giống như thế.

 Cũng cần xác định rằng việc hacker defaced website như trường hợp webscan.bkav.com.vn <font color='yellow'>thì không  có nghĩa là hacker đã chiếm được quyền admin (lấy được password)</font> của hệ thống đâu nhé. Khoảng cách đến đó nhiều trường hơp khá xa đấy.

 Còn việc hệ thống bị tấn công từ chối dịch vụ và bị ngưng trệ trong thời gian dài mà  không có sự tham gia cuả một hệ thống botnet trên mạng, thì thực tế có thể có đấy. Vấn đề là phải có hai yếu tố:
- Hacker phải dùng một <font color='yellow'>DoS tool loại nào</font>?
- Hệ thống phải <font color='yellow'>cài các application nào </font>để DoS tool này mới có thể phát huy tác dung? (<i>Chỉ cần một hay hai hacker DoS trong một vài phút là hệ thống có thể ngưng trê nhiều giờ</i>).Hệ thống mà anh conmale nói có cài các application ấy đấy.  Tuy nhiên vấn đề này tôi xin nói sau, vì bài viết đã dài.

Chỉ khi xác định đươc cách thức tấn công cụ thể của hacker thì ta mới chặn được nó và có biện pháp hữu hiệu để phòng thủ.
<font color='yellow'>
"The Only Way To Stop A Hacker Is To Think Like One"</font>




]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254947</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254947</link>
				<pubDate><![CDATA[Thu, 23 Feb 2012 02:30:43]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Anh nói vậy mới làm em chợt nhận ra cái điểm quan trọng đó mà không nhớ đến từ đầu :(

<blockquote>"The Only Way To Stop A Hacker Is To Think Like One"&nbsp;
		</blockquote>

Ở các ý kiến trước của <font color='orange'>mọi người đều chỉ nói đến khía cạnh của 1 quản trị</font> chứ <font color='orange'>chưa đặt mình vào vị trí và suy nghĩ như attacker</font> ...

Nếu đặt mình vào vị trí của attacker, có lẽ mọi chuyện trở lên dễ dàng hơn nhiều.

"Apache thì có sóng gió <font color='red'>slowloris</font>"
"PHP 5.3.<font color='red'>9</font> thì dính RCE (remote code execution) và các phiên bản cũ hơn 5.3.9 thì DoS exploit."
"vBB 4.x.x thì có lỗi ở phần Search (SQL injection) - nếu dùng tài khoản root cho database thì khá nguy hiểm ... (rất hay gặp ở nhiều site lớn dùng server riêng)"
....

Trời ơi  :|  quá chú ý vào "phòng tránh" nên không nghĩ đến khía cạnh này ...
 #:S ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254972</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254972</link>
				<pubDate><![CDATA[Thu, 23 Feb 2012 10:23:19]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Ngày xưa, khi HVA từng bị DDoS triền miên bất tận, có lúc bị hết luôn disk space. log daemon và apache chẳng còn chỗ để ghi logs. Những lúc ấy thật nguy hiểm. Nguy hiểm không những ở khía cạnh không còn lưu được logs cho công tác forensics mà còn nguy ở chỗ bị phân tán trong việc theo dõi và phòng bị bảo mật cho máy chủ. Mọi tài nguyên, thời gian và tâm lực chỉ đổ dồn vô chuyện chống đỡ ddos nên xao nhãng chuyện cập nhật bản vá, backup, kiện toàn bảo mật...v...v... Đó là bài học lớn xảy ra vào năm 2006 cho HVA.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254989</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#254989</link>
				<pubDate><![CDATA[Thu, 23 Feb 2012 21:46:41]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Anh conmale, đồng chí weareanon đã cung cấp file thông tin về máy chủ của BKAV, theo em thì mình dùng nó bổ sung vô cái case study luôn đi, em đọc thấy trong đó có nhiều file đồng chí weareanon chưa hề phân tích ví dụ như cái file apache config đọc cũng khá lý thú, có bồ bên topic về vụ hack BKAV bên kia đã tìm ra là BKAV không hề dùng mod security chẳng hạn.

À mà như bác Mai đã nhận ra, khi đọc mấy cái file do bồ weareanon cung cấp, em thấy mấy cái giả định của anh trúng tới 95%  B-) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255090</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255090</link>
				<pubDate><![CDATA[Fri, 24 Feb 2012 04:28:26]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">xnohat wrote:</cite><br>
		<blockquote>Anh conmale, đồng chí weareanon đã cung cấp file thông tin về máy chủ của BKAV, theo em thì mình dùng nó bổ sung vô cái case study luôn đi, em đọc thấy trong đó có nhiều file đồng chí weareanon chưa hề phân tích ví dụ như cái file apache config đọc cũng khá lý thú, có bồ bên topic về vụ hack BKAV bên kia đã tìm ra là BKAV không hề dùng mod security chẳng hạn.

À mà như bác Mai đã nhận ra, khi đọc mấy cái file do bồ weareanon cung cấp, em thấy mấy cái giả định của anh trúng tới 95%  B-) &nbsp;
		</blockquote>

Hello em, anh thấy weareanon "mượn" nhà của HVA để post thông tin mà mình lại trưng thông tin của weareanon thì coi không được. Cho nên anh đã gởi PM cho bạn ấy để xin phép. Nếu weareanon đồng ý thì anh sẽ xúc tiến.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255094</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255094</link>
				<pubDate><![CDATA[Fri, 24 Feb 2012 04:33:49]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ mình có trưng dữ liệu cá nhân gì của weareanon lên đâu anh, ý em là mình dùng cái này nè anh 

http://www.mediafire.com/?h84wmv6zq7oh7ly]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255100</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255100</link>
				<pubDate><![CDATA[Fri, 24 Feb 2012 05:09:54]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">xnohat wrote:</cite><br>
		<blockquote>Anh conmale, đồng chí weareanon đã cung cấp file thông tin về máy chủ của BKAV, theo em thì mình dùng nó bổ sung vô cái case study luôn đi, em đọc thấy trong đó có nhiều file đồng chí weareanon chưa hề phân tích ví dụ như cái file apache config đọc cũng khá lý thú, có bồ bên topic về vụ hack BKAV bên kia đã tìm ra là BKAV không hề dùng mod security chẳng hạn.

<font color='yellow'><b>À mà như bác Mai đã nhận ra, khi đọc mấy cái file do bồ weareanon cung cấp, em thấy mấy cái giả định của anh trúng tới 95%</b></font>  B-) &nbsp;
		</blockquote>

Chào xnohat

 Mình không quen biết bạn <b>weareanon</b> và cho đến nay cũng chưa trao đổi với bạn ấy lần nào qua email, chat.... Tôi cho rằng bạn weareanon là một bạn có trình độ IT rất khá và trên mạng có cách trao đổi đúng mực, vừa phải, khôn khéo. Tuy nhiên tôi không có bình luận gì về mục đích hack vào BKAV forum của bạn ấy, hay bạn ấy có thưc sự là một thành viên của Anonymous và LulzSec Vietnam hay không? Cũng như thực sự đang  có một tổ chức như vậy ở VN hay không.

 Bài viết của tôi (<i>phía trên, trong topic này</i>) viết trước bài viết "<font color='orange'>Thông báo số 2</font>" (<i>gọi thế cho tiện</i>) của bạn weareanon. Bài viết của tôi ngày <font color='yellow'>23/02/2012 </font>15:30:43 (+0700) | #40 | 254947, còn bài "Thông báo số 2" của weareanon đăng trên HVA forum ngày <font color='yellow'>24/02/2012 </font>12:03:15 (+0700) | #469 | 255001 (<i>dường như weareanon cũng đăng tải nôi dung "Thông báo số 2" trên mạng vào cùng thời gian này</i>)

 Khi website webscan.bkav.com.vn bị defaced, tôi có trao đổi với <font color='violet'><b>gamma95</b></font>, người tôi cho là rất thông minh, hiểu biết trong việc phân tích những sự kiện như thế này. Tôi ghi nhận, nhưng không hoàn toàn đồng ý với ý kiến của bạn ấy. Ý kiến riêng của tôi, thì đã trình bầy một phần ở post trên.

 Dù khá bận công việc (<i>liên quan đến việc nhân GT Nhà nước về KH&CN 2010</i>), tôi vẫn bỏ một phần thời gian "nghiên cứu-tìm hiểu" về các website-hệ thống của BKAV vừa bị hack. Dĩ nhiên là tìm hiểu theo cách của người làm bảo mật, không phải là thâm nhập-hacking vào bên trong hệ thống. Tôi cũng chỉ tìm hiểu về werbserver-hệ thống webscan.bkav.com.vn, chứ không về forum.bkav.com.vn. Tuy nhiên các hệ thống khác nhau của BKAV lai có cấu hình khá giống nhau, trên nền tảng: Win2K3-Apache(Win32)-PHP 5.3.x-MySQL... vân vân (xin không viết hết cả ra).

Từ cách deface website BKAV của hacker vào trang webscan.bkav.com.vn và chi tiết cấu hình của webserver, băng kinh nghiệm bản thân, tôi đoán cách thức cụ thể hacker deface website của BKAV cũng như cách thức hacker tấn công từ chối dịch vụ (DoS- chứ dường như không phải DDoS) rất hiệu quả vào webserver này, vài ngày sau đó.

 Về nôi dung bản "<font color='orange'>Thông báo số 2</font>" của bạn weareanon tôi còn có những thắc mắc và nghĩ ngợi. Tất nhiên BKAV không chỉ mắc những lỗi mà weareanon đã nêu, mà còn những lỗi khác, thí dụ các lỗi liên quan đến việc config. Apache trên file httpd.conf. Nhưng cũng chính nôi dung config. Apache của BKAV (mà weareanon dẫn ra) lại có những điểm lạ, ít nhất được coi là khó hiểu hay có chút mâu thuẫn. Có thời gian ta sẽ bàn thêm việc này.

Tôi muốn lưu ý về cách thức <font color='yellow'>tấn công từ chối dịch vụ</font> của các hacker vào hệ thống của BKAV vừa qua. Theo tôi đây là một cách tấn công mới, rất hiệu quả, chỉ cần rất ít người tham gia, không cần một mạng botnet to lớn, mà việc tạo lập nó vốn rất mất công và việc kiểm soát  bot net rất dễ tuột khỏi tay hacker. (<i>như trường hợp vừa qua khá nhiều mạng  botnet của STL đã bị huỷ diệt hay mất đi sự được kiểm soát, sau khi anh TQN và một số thành viên HVA khác RCE các malicious codes của botnets và các International Antivirus Co. kịp thời cập nhật chương trình diệt virus của họ).</i>


 Có thể các cuộc tấn công DoS của hacker vào BKAV forum  đã đánh đúng vào <font color='yellow'>"<b>gót chân Achilles</b>"</font> của hệ thống, gây ra bởi chính một số application cài đặt trong nó. Theo tôi, đây là vấn đề quan trọng, liên quan đến mạng truyền thông quốc gia, cộng đồng, mà HVA chúng ta cần lưu ý, có những cảnh báo, hướng dẫn giúp công đống cách thức phòng thủ hay khắc phục, trong thời gian tới




]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255200</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255200</link>
				<pubDate><![CDATA[Fri, 24 Feb 2012 20:40:45]]> GMT</pubDate>
				<author><![CDATA[ PXMMRF]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">xnohat wrote:</cite><br>
		<blockquote>mình có trưng dữ liệu cá nhân gì của weareanon lên đâu anh, ý em là mình dùng cái này nè anh 
<span class="link"> http://www.mediafire.com/?h84wmv6zq7oh7ly&nbsp;</span>
		</blockquote>

À, anh lại nghĩ là ý em khai triển theo góc độ điều tra dấu vết ở những biên độ khác. Trong trường hợp này, dấu vết weareanon có thể tiết lộ là dấu vết anh ta đã post bài trên diễn đàn HVA. Thông thường kẻ tấn công luôn luôn tìm hiểu kết quả những việc mình đã làm, thậm chí công bố việc mình đã làm vì một lý do nào đó. Anh thấy đây cũng là một góc độ khai triển, bởi vậy anh đã xin phép weareanon qua PM như sau:

<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Tôi đường đột gởi PM này để xin phép bạn sử dụng một số thông tin đăng nhập của bạn được lưu trên log của diễn đàn đó là IP address và User-Agent để làm case study cho thành viên diễn đàn. Tôi xét thấy những thông tin ấy hoàn toàn anonymous và là những thông tin khá lý thú nên mới gởi bạn đề nghị này.

Rất mong bạn xem xét và hồi âm.

Cảm ơn. &nbsp;
		</blockquote>

và weareanon đã trả lời hôm nay như sau:

<blockquote>Thưa ngài,

Đầu tiên, chúng tôi thành thực cám ơn sự giúp đỡ của ngài và các quản trị viên đối với sự vụ của chúng tôi.
Lời đề nghị của ngài, chúng tôi thấy đây là một yêu cầu xác đáng, vì chúng tôi tin tưởng ngài với sự am tường kỹ nghệ máy tính rất chuyên sâu, sẽ có thể dùng các thông tin ấy một cách hiệu quả và tránh được cho chúng tôi các sự cố đáng tiếc. Do đó chúng tôi rất hoan hỉ nếu có thể giúp ngài được chút gì đó hữu ích.

Thân chào ngài và chúc ngài nhiều sức khoẻ,
Kính thư
weareanon &nbsp;
		</blockquote>

He he, cách viết và cách trả lời của weareanon hơi lạ (gần giống như người ngoại quốc dịch tiếng ngoại quốc sang tiếng Việt ;) ) nhưng quan trọng là anh ấy đã đồng ý. Bởi thế, anh sẽ tán 1 bài khai triển theo góc độ này.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255228</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255228</link>
				<pubDate><![CDATA[Fri, 24 Feb 2012 22:20:32]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Khi nói đến điểm b, chúng ta nói đến khả năng máy chủ kia hoàn toàn không có cơ chế bảo vệ mà chỉ phụ thuộc vào "dịch vụ bảo vệ" mà ISP cung cấp. Đây có thể là sự trông cậy chết người mà chủ nhân của máy chủ ấy vướng phải. Chẳng có gì bảo đảm rằng hệ thống bảo vệ của ISP chặt chẽ và đúng với nhu cầu và cấu hình thực tế trên cái dedicated server này. Firewall, IPS, IDS..v...v... không thể hoàn toàn lấp được những lỗi và những tắc trách trong cấu hình. Đó là chưa kể khi đụng tình huống, liệu ISP có lưu giữ những thông tin cần thiết cho mục đích forensics hay không?

Điểm c giúp ta xác định các vectors có thể (Windows 2003, Apache, IIS, PHP, vBB, Mysql). Đây có lẽ là những mảnh thông tin rõ ràng nhất và dễ dàng nhất (bug-track everyone? ;) ) nhưng cũng là mảnh cần nhiều thời gian để phân tích logs, điều tra các lỗ hổng ..v..v....&nbsp;
		</blockquote>

Chào bác,

Em có một số khúc mắc nho nhỏ:

Ở điểm b của bác, xét đến việc có được ISP ra tay bảo vệ hay chưa và hoàn toàn không tin tưởng vào sự bảo vệ này thì liệu điểm này có liên quan tới chủ đề đang "study" hay không?

Ở c, nếu logs hoàn toàn bị xoá (vì chỉ nằm trên 1 server) thì có phải việc giám định bị đi vào ngõ cụt không?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255399</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255399</link>
				<pubDate><![CDATA[Sat, 25 Feb 2012 03:27:55]]> GMT</pubDate>
				<author><![CDATA[ cino]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">xnohat wrote:</cite><br>
		<blockquote>mình có trưng dữ liệu cá nhân gì của weareanon lên đâu anh, ý em là mình dùng cái này nè anh 
<span class="link"> http://www.mediafire.com/?h84wmv6zq7oh7ly&nbsp;</span>
		</blockquote>

À, anh lại nghĩ là ý em khai triển theo góc độ điều tra dấu vết ở những biên độ khác. Trong trường hợp này, dấu vết weareanon có thể tiết lộ là dấu vết anh ta đã post bài trên diễn đàn HVA. Thông thường kẻ tấn công luôn luôn tìm hiểu kết quả những việc mình đã làm, thậm chí công bố việc mình đã làm vì một lý do nào đó. Anh thấy đây cũng là một góc độ khai triển, bởi vậy anh đã xin phép weareanon qua PM như sau:

<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Tôi đường đột gởi PM này để xin phép bạn sử dụng một số thông tin đăng nhập của bạn được lưu trên log của diễn đàn đó là IP address và User-Agent để làm case study cho thành viên diễn đàn. Tôi xét thấy những thông tin ấy hoàn toàn anonymous và là những thông tin khá lý thú nên mới gởi bạn đề nghị này.

Rất mong bạn xem xét và hồi âm.

Cảm ơn. &nbsp;
		</blockquote>

và weareanon đã trả lời hôm nay như sau:

<blockquote>Thưa ngài,

Đầu tiên, chúng tôi thành thực cám ơn sự giúp đỡ của ngài và các quản trị viên đối với sự vụ của chúng tôi.
Lời đề nghị của ngài, chúng tôi thấy đây là một yêu cầu xác đáng, vì chúng tôi tin tưởng ngài với sự am tường kỹ nghệ máy tính rất chuyên sâu, sẽ có thể dùng các thông tin ấy một cách hiệu quả và tránh được cho chúng tôi các sự cố đáng tiếc. Do đó chúng tôi rất hoan hỉ nếu có thể giúp ngài được chút gì đó hữu ích.

Thân chào ngài và chúc ngài nhiều sức khoẻ,
Kính thư
weareanon &nbsp;
		</blockquote>

He he, cách viết và cách trả lời của weareanon hơi lạ (gần giống như người ngoại quốc dịch tiếng ngoại quốc sang tiếng Việt ;) ) nhưng quan trọng là anh ấy đã đồng ý. Bởi thế, anh sẽ tán 1 bài khai triển theo góc độ này.&nbsp;
		</blockquote>
Anh conmale, em nghĩ đây là sự cố tình của các bạn ấy. Trong Món quà số 2, cách hành văn không hề giống như vầy. Giả thuyết đưa ra có thể là để tránh tìm hiểu về văn phong, các bạn ấy có thể đưa qua 1 translator machine rồi chỉnh sửa lại?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255432</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255432</link>
				<pubDate><![CDATA[Sat, 25 Feb 2012 05:25:05]]> GMT</pubDate>
				<author><![CDATA[ LeVuHoang]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Em cũng đang có nhận định giống anh LeVuHoang. Nếu so sánh văn phong từ Thông báo số 1 - Thông báo số 2 - Bức thư ngày hôm nay thì dường như có việc có sử dụng machine translator trong thông báo số 2 và Bức thư gửi C50.

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255503</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255503</link>
				<pubDate><![CDATA[Sat, 25 Feb 2012 10:24:21]]> GMT</pubDate>
				<author><![CDATA[ K4i]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Hôm trước tớ có PM xin phép weareanon dùng một số thông tin có lưu trên logs của HVA để tiếp tục khai triển case study này và đã được anh ấy đồng ý. Hôm nay, tớ xin khai triển thêm một tí ở góc độ này.

Thông thường, perpetrator nếu tinh ranh và kinh nghiệm, hắn ta sẽ xoá logs, xoá hết tất cả các dấu vết thâm nhập trên mục tiêu. Tuy nhiên, đến một lúc nào đó, nếu cần công bố thông tin, hắn vẫn phải dùng một phương tiện nào đó để thực hiện ý định công bố ấy. Trong trường hợp weareanon, anh chàng đã chọn HVA làm nơi tung ra thông điệp đầu tiên và tất nhiên, trên logs của HVA sẽ ghi nhận lại một số thông tin. Ví dụ:

<b>109.163.233.201 - - [24/Feb/2012:01:56:48 -0600] "GET /hvaonline/posts/list/41282.hva HTTP/1.1" 200 13964 "http://www.hvaonline.net/hvaonline/forums/show/19.hva" "Mozilla/5.0 <font color='red'>(Windows; U; X11; Windows NT 6.1</font>; rv:5.0) Gecko/20100101 Firefox/5.0"</b>

Thoạt nhìn thì thấy không có gì lạ, nhưng nhìn kỹ thì User-Agent này là vừa Windows, lại vừa Unix. Theo specs của Mozilla thì User-Agent trên bất hợp lệ về mặt cú pháp. Không thể nào trình duyệt này vừa có signature cho OS là vừa Windows mà lại vừa Unix ;).

Tuy nhiên, điều thú vị hơn là sau hơn 10 phút, nó lại trở thành:

<b><font color='red'>109.163.233.201</font> - - [24/Feb/2012:02:10:50 -0600] "GET /hvaonline/posts/list/480/41193.hva HTTP/1.1" 200 13808 "http://www.hvaonline.net/hvaonline/forums/list.hva" "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.20) Gecko/25250202 BTRS35926 Firefox/2.0.0.20 (.NET CLR 3.5.30729)"</b>

Ở đây, User-Agent đột ngột thay đổi và User-Agent này có điểm buồn cười là trên đời này không có cái gì là "Gecko/25250202" hết.

IP 109.163.233.201 được resolved thành wau2.torservers.net và nó thuộc một Class C của mạng 109.163.233.192/28 do ZWIEBELFREUNDE quản lý. Đây là một t0r node khá phổ biến (trong hơn 2 ngàn nodes). Điều này có nghĩa mỗi ngày phải có hàng TB traffic đi xuyên qua nó.

Giả sử an ninh mạng của một quốc gia liên hệ với quản lý của mạng ZWIEBELFREUNDE và yêu cầu cung cấp thông tin truy cập của nguồn IP nguyên thuỷ đến t0r node có IP là <font color='red'>109.163.233.201</font>. Nếu mạng này có log lại đầy đủ thông tin nguồn IP nguyên thuỷ nào đó truy cập đến <font color='red'>109.163.233.201</font>  thì ngay cả việc trace và correlate access từ nguồn IP nguyên thuỷ là một việc không đơn giản tí nào. Tuy nhiên, đây là chuyện hầu như không thể vì chẳng có mạng nào có thể log tất cả mọi packets cho công tác audit, hơn nữa đây là mạng đại trà chớ chẳng phải là mạng thuộc hệ thống tài chính hay chính phủ cho nên không có policy logging như vậy. Hơn nữa, không phải vô cớ mà "ZWIEBELFREUNDE" lại có slogan là “Friends of the Onion”, nơi security, privacy và anonymity được bảo vệ. Tình hình có lẽ còn phải gay go hơn nếu perpetrator dùng một private VPS hoặc anonymous VPN nào đó trước khi access t0r network.

Để điều tra cấp độ này và để có sự hợp tác rộng rãi giữa các quốc gia và các ISP có lẽ phải cần đến criminals loại international bởi vì mỗi ngày cyber frauds có hàng ngàn cases thì làm sao có đủ ưu tiên và nhân lực để truy tìm t0r users cho mấy cái deface vớ vẩn?

Quay lại hai cái ví dụ trên (trong hàng trăm requests có cùng IP như vậy), chúng ta thấy chẳng có gì bảo đảm request của ví dụ một và ví dụ hai thuộc về một người dùng hay hai người dùng hết. Nếu có 2 hoặc 100 người dùng sử dụng t0r và được t0r network randomly gán cho cái "gateway" có cùng IP address như trên thì đúng là bó tay vì đằng sau nó có thể có hàng trăm IP khác.

Forensics ở khía cạnh này nói lên điều gì? <b>Nó nói lên rằng, đôi khi perpetrator cẩn thận việc xoá dấu vết ngay tại hiện trường nhưng lại thiếu cẩn thận hoặc chủ quan khi tung lên thông tin thì công tác xoá dấu vết kia hoá ra vô ích</b> và bởi thế, việc điều tra đôi khi trở nên hết sức đơn giản và dễ dàng (tất nhiên là HVA hoặc nơi nào đó mà perpetrator chọn để thông tin phải cung cấp cho nhóm điều tra thông tin đầu tiên, đó là thông tin về IP <font color='red'>109.163.233.201</font>).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255570</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255570</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 01:15:41]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Có 1 ý tưởng thật "ngớ ngẩn" nhưng cũng thật "thú vị" để chơi trò "may rủi" thu nhỏ phạm vi đối tượng tình nghi hoặc nếu "may" có thể tóm gọn attacker nếu attacker "không cẩn thận".

Từ cái IP và những "thông tin liên quan" mà anh conmale cung cấp, BKAV có thể "giăng 1 cái lưới" để "bắt" những "con cá ngu ngơ". 

Ở đây giả dụ ta đặt <font color='red'>tình huống là attacker vẫn tiếp tục sử dụng IP đó hoặc thậm chí attacker không sử dụng IP đó nữa nhưng vẫn dùng Tor và những nodes khác của Tor để tiếp tục truy cập và nghe ngóng ở BKAV.</font>

Nếu ta <font color='orange'>đặt mình vào vị trí attacker</font>, 1 <font color='red'>kẻ khôn ngoan sẽ chọn những node "<b>phổ biến</b>, <b>truy cập khá và nhanh</b>".</font>

Attacker: Vậy bạn có cách gì để thu hẹp phạm vi đối tượng ? ...
Me: Vâng, <font color='#6699CC'>chính sự thông minh, khôn khéo đó đôi khi sẽ hại bạn ! </font>;)

Attacker: Tại sao ?
Me: Vì bạn để lộ thông tin bạn dùng Tor =))

Attacker: Để lộ thông tin dùng Tor thì làm sao chứ ?
Me: Bạn dùng Tor và chính Tor nó hại bạn ;)

Attacker: Tor thì hại gì chứ ?
Me: Phiền bạn ghé qua đây ;)<span class="link"> https://check.torproject.org/?lang=vi</span>

Attacker: Opp ... 
Me: Vâng, <font color='red'>bản thân Tor nó có công cụ nhận dạng xem bạn có đang sử dụng Tor hay không</font>. Vậy <font color='red'>mấy bác bên BKAV cũng tạo 1 công cụ kiểm tra các IP truy cập đến đó có thuộc đám "con cháu" của Tor  không thì sẽ giới hạn được phạm vi.</font>

Attacker: Ah ừ ... biết tôi dùng Tor rồi thì làm được gì nữa ? <font color='olive'>Hàng trăm hàng ngàn người khác cũng đang sử dụng Tor và cùng thông qua 1 IP như tôi mà</font> =)) Bạn cứ đùa =))
Me: Vâng, <font color='red'>nhưng không mấy ai lại trùng hợp cùng truy cập vào những site của BKAV cả </font>:-"

Attacker: :| Cứ cho là thế đi, nhưng tìm ra được tôi "hơi bị khó đấy" !
Me: <font color='red'>Chỉ là vấn đề thời gian thôi, nếu bạn vẫn "theo đường cũ" </font>....

Attacker: Là sao :| ?
Me: Bạn nghĩ sao khi mà BKAV khi phát hiện bạn dùng Tor, họ sẽ tiến hành theo dõi bạn ?

Attacker: Theo dõi sao ?
Me: <font color='red'>Khi biết bạn dùng Tor, họ sẽ lưu lại cái IP hiện hành vào Cookie của các trang web BKAV mà bạn truy cập . Sau đó những lần truy cập sau, cái cookie đó được lôi ra so sánh và cái IP trong đó được lôi ra để so sánh với những IP tiếp theo ở những lần truy cập tiếp theo ...</font>

Attacker: ..... 
Me: Và cứ như vậy, họ tiến dần đến bạn ;) Chỉ 1 sơ hở rất nhỏ, bạn đã nằm trong lưới như 1 con cá rồi ;)

............................]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255586</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255586</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 03:41:34]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>
Attacker: Opp ... 
Me: Vâng, <font color='red'>bản thân Tor nó có công cụ nhận dạng xem bạn có đang sử dụng Tor hay không</font>. Vậy <font color='red'>mấy bác bên BKAV cũng tạo 1 công cụ kiểm tra các IP truy cập đến đó có thuộc đám "con cháu" của Tor  không thì sẽ giới hạn được phạm vi.</font>
&nbsp;
		</blockquote>
Cứ dùng firefox change user-agent và các công cụ Tor, ... để post bài lên HVA.
Dùng IE or Chrome vào BKAV.

Bạn trả lời hộ mình: <font color='red'>Tại sao vào BKAV phải dùng Tor?</font>
Chỉ có cu cậu vụ handheld.vn mới dùng account lừa đảo để post bài: Catch me if you can. Sau đó login vào acc thật để đọc bài thôi. Chứ nếu thằng gây án là mình thì luôn luôn là gây án xong rồi mất tích. Không bao giờ quay lại hiện trường, chỉ có trà đá và nghe ngóng tình hình.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255591</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255591</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 05:13:23]]> GMT</pubDate>
				<author><![CDATA[ phanledaivuong]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>Có 1 ý tưởng thật "ngớ ngẩn" nhưng cũng thật "thú vị" để chơi trò "may rủi" thu nhỏ phạm vi đối tượng tình nghi hoặc nếu "may" có thể tóm gọn attacker nếu attacker "không cẩn thận".

Từ cái IP và những "thông tin liên quan" mà anh conmale cung cấp, BKAV có thể "giăng 1 cái lưới" để "bắt" những "con cá ngu ngơ". 

Ở đây giả dụ ta đặt <font color='red'>tình huống là attacker vẫn tiếp tục sử dụng IP đó hoặc thậm chí attacker không sử dụng IP đó nữa nhưng vẫn dùng Tor và những nodes khác của Tor để tiếp tục truy cập và nghe ngóng ở BKAV.</font>

Nếu ta <font color='orange'>đặt mình vào vị trí attacker</font>, 1 <font color='red'>kẻ khôn ngoan sẽ chọn những node "<b>phổ biến</b>, <b>truy cập khá và nhanh</b>".</font>

Attacker: Vậy bạn có cách gì để thu hẹp phạm vi đối tượng ? ...
Me: Vâng, <font color='#6699CC'>chính sự thông minh, khôn khéo đó đôi khi sẽ hại bạn ! </font>;)

Attacker: Tại sao ?
Me: Vì bạn để lộ thông tin bạn dùng Tor =))

Attacker: Để lộ thông tin dùng Tor thì làm sao chứ ?
Me: Bạn dùng Tor và chính Tor nó hại bạn ;)

Attacker: Tor thì hại gì chứ ?
Me: Phiền bạn ghé qua đây ;)<span class="link"> https://check.torproject.org/?lang=vi</span>

Attacker: Opp ... 
Me: Vâng, <font color='red'>bản thân Tor nó có công cụ nhận dạng xem bạn có đang sử dụng Tor hay không</font>. Vậy <font color='red'>mấy bác bên BKAV cũng tạo 1 công cụ kiểm tra các IP truy cập đến đó có thuộc đám "con cháu" của Tor  không thì sẽ giới hạn được phạm vi.</font>

Attacker: Ah ừ ... biết tôi dùng Tor rồi thì làm được gì nữa ? <font color='olive'>Hàng trăm hàng ngàn người khác cũng đang sử dụng Tor và cùng thông qua 1 IP như tôi mà</font> =)) Bạn cứ đùa =))
Me: Vâng, <font color='red'>nhưng không mấy ai lại trùng hợp cùng truy cập vào những site của BKAV cả </font>:-"

Attacker: :| Cứ cho là thế đi, nhưng tìm ra được tôi "hơi bị khó đấy" !
Me: <font color='red'>Chỉ là vấn đề thời gian thôi, nếu bạn vẫn "theo đường cũ" </font>....

Attacker: Là sao :| ?
Me: Bạn nghĩ sao khi mà BKAV khi phát hiện bạn dùng Tor, họ sẽ tiến hành theo dõi bạn ?

Attacker: Theo dõi sao ?
Me: <font color='red'>Khi biết bạn dùng Tor, họ sẽ lưu lại cái IP hiện hành vào Cookie của các trang web BKAV mà bạn truy cập . Sau đó những lần truy cập sau, cái cookie đó được lôi ra so sánh và cái IP trong đó được lôi ra để so sánh với những IP tiếp theo ở những lần truy cập tiếp theo ...</font>

Attacker: ..... 
Me: Và cứ như vậy, họ tiến dần đến bạn ;) Chỉ 1 sơ hở rất nhỏ, bạn đã nằm trong lưới như 1 con cá rồi ;)

............................&nbsp;
		</blockquote>

Xuất sắc, ý tưởng này thực sự rất khả thi. Vì hacker có thể chỉ sử dụng tor khi tấn công, còn khi quay trở lại, hắn có thể không sử dụng tor mà là IP thật, khi đó thì cái cookie sẽ tố cáo hắn.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255610</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255610</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 07:49:12]]> GMT</pubDate>
				<author><![CDATA[ xnohat]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Bác này quên là có cái Tor Bundled :-)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255621</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255621</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 09:49:43]]> GMT</pubDate>
				<author><![CDATA[ LeVuHoang]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Thật ra đó chỉ là 1 ý tưởng đơn giản.

Để đạt kết quả tốt hơn cũng c<font color='red'>ó thể kiểm tra hoặc thu thập thêm các thông tin liên quan trên client</font> có thể rồi tiến hành sàng lọc.
Và trong quá trình nghe ngóng tình hình, tâm lý của bạn attacker sẽ có khi quay trở lại. Và <font color='red'>ai dám chắc là bạn ý sử dụng Tor mãi ?</font>

Ngoài ra, 1 kĩ thuật nâng cao hơn :

<font color='red'>Javascript có thể sử dụng để tạo <b>custom cookie</b>.</font> Thử nghĩ đơn giản thế này: Tại sao ta không lợi dụng javascript để moi móc thêm thông tin ngay trên client và gửi ngược lại lên server ? 

- Ví dụ với javascript, ta có thể lấy được thời gian hệ thống của client (từ đó biết được bạn ý đang thuộc "zone" nào)!
- Với javascript, ta có thể lấy được user-agent của trình duyệt.

Đó là còn chưa kể, <font color='red'>ngoài javascript thì còn có flash, java là những loại script chạy phía client</font> !


...

<p></p>
		<cite class="blockquote">phanledaivuong wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>
Attacker: Opp ... 
Me: Vâng, <font color='red'>bản thân Tor nó có công cụ nhận dạng xem bạn có đang sử dụng Tor hay không</font>. Vậy <font color='red'>mấy bác bên BKAV cũng tạo 1 công cụ kiểm tra các IP truy cập đến đó có thuộc đám "con cháu" của Tor  không thì sẽ giới hạn được phạm vi.</font>
&nbsp;
		</blockquote>
Cứ dùng firefox change user-agent và các công cụ Tor, ... để post bài lên HVA.
Dùng IE or Chrome vào BKAV.

Bạn trả lời hộ mình: <font color='red'>Tại sao vào BKAV phải dùng Tor?</font>
Chỉ có cu cậu vụ handheld.vn mới dùng account lừa đảo để post bài: Catch me if you can. Sau đó login vào acc thật để đọc bài thôi. Chứ nếu thằng gây án là mình thì luôn luôn là gây án xong rồi mất tích. Không bao giờ quay lại hiện trường, chỉ có trà đá và nghe ngóng tình hình.&nbsp;
		</blockquote>

Hì, bạn đọc chưa kĩ rồi ;)


<font color='#6699CC'>[Edited vì hiện giờ 1 số ý tưởng trong này không xác thực nữa vì nó liên quan đến các exploits của browser]</font>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255628</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255628</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 10:32:21]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ tor cũng ko thực sự an toàn. Nếu xét 1 vụ việc thì ko nên quên &quot;chi phí điều tra&quot; .. 

- với vụ BKAV thì phải xem bkav có chịu &quot;chi&quot; cho vụ điều tra này ko đã :). BKAV liệu có bỏ chi phí ra lục tung internet lên chăng.  VD: như kiểu: VPS&gt;&gt;VPN&gt;&gt;Tor&gt;&gt;BKAV site    :)  . Với kết nối mạng như trên !  bkav khó lòng theo đuổi vụ việc đến tận cùng :) Lí do: chi phí điều tra đem so sánh với cái lợi khi bắt dc &quot;hacker&quot; quả là khập khiễng :) ... 

- với những vụ &quot;tầm cỡ&quot;  & bên nguyên chịu &quot;chi&quot;  thì ko khó để tìm ra thủ phạm :) (phục thuộc nhiều yếu tố khác nữa)

- nếu có gì sai mong các bác cứ ném đá :) 

------------------------------------------

Nếu đứng theo góc độ bảo mật thì theo ngu í của em nên làm như sau:

1. Khi xác nhận bị Attack =&gt; cách li server :)

2. Thông báo cho toàn bộ hệ thống & những bên liên quan

3. Ước tính thiệt hại & khắc phục sự cố :

             - nêu ra những thông tin nào đã bị attacker lấy cắp (database, password, v..v.v.v.v)
             - thông báo cách khắc phục sự cố cho những bên liên quan (ở đây là member: change password .v.v.)

4. Truy tìm thủ pham: 
             - xem  phân tích tỉ mỉ log server 
             - dựa vào thông tin ghi lại trên server xác định bug mà attacker đã dùng để tấn công =&gt; xử lí bug :) 
             - xác định thông tin Attacker (IP, time of attack, user agent .v.v.vv.)
             - từ đó khoanh vùng đối tượng =&gt; đưa ra cách xử lí tốt nhất L)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255634</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255634</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 11:37:08]]> GMT</pubDate>
				<author><![CDATA[ al0nex]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>Thật ra đó chỉ là 1 ý tưởng đơn giản.

Để đạt kết quả tốt hơn cũng c<font color='red'>ó thể kiểm tra hoặc thu thập thêm các thông tin liên quan trên client</font> có thể rồi tiến hành sàng lọc.
Và trong quá trình nghe ngóng tình hình, tâm lý của bạn attacker sẽ có khi quay trở lại. Và <font color='red'>ai dám chắc là bạn ý sử dụng Tor mãi ?</font>

Ngoài ra, 1 kĩ thuật nâng cao hơn :

<font color='red'>Javascript có thể sử dụng để tạo <b>custom cookie</b>.</font> Thử nghĩ đơn giản thế này: Tại sao ta không lợi dụng javascript để moi móc thêm thông tin ngay trên client và gửi ngược lại lên server ? 

- Ví dụ với javascript, ta có thể lấy được thời gian hệ thống của client (từ đó biết được bạn ý đang thuộc "zone" nào)!
- Với javascript, ta có thể lấy được user-agent của trình duyệt.

Đó là còn chưa kể, <font color='red'>ngoài javascript thì còn có flash, java là những loại script chạy phía client</font> !


...

<p></p>
		<cite class="blockquote">phanledaivuong wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>
Attacker: Opp ... 
Me: Vâng, <font color='red'>bản thân Tor nó có công cụ nhận dạng xem bạn có đang sử dụng Tor hay không</font>. Vậy <font color='red'>mấy bác bên BKAV cũng tạo 1 công cụ kiểm tra các IP truy cập đến đó có thuộc đám "con cháu" của Tor  không thì sẽ giới hạn được phạm vi.</font>
&nbsp;
		</blockquote>
Cứ dùng firefox change user-agent và các công cụ Tor, ... để post bài lên HVA.
Dùng IE or Chrome vào BKAV.

Bạn trả lời hộ mình: <font color='red'>Tại sao vào BKAV phải dùng Tor?</font>
Chỉ có cu cậu vụ handheld.vn mới dùng account lừa đảo để post bài: Catch me if you can. Sau đó login vào acc thật để đọc bài thôi. Chứ nếu thằng gây án là mình thì luôn luôn là gây án xong rồi mất tích. Không bao giờ quay lại hiện trường, chỉ có trà đá và nghe ngóng tình hình.&nbsp;
		</blockquote>

Hì, bạn đọc chưa kĩ rồi ;)


<font color='#6699CC'>[Edited vì hiện giờ 1 số ý tưởng trong này không xác thực nữa vì nó liên quan đến các exploits của browser]</font>&nbsp;
		</blockquote>

Thật ra perpetrator đã cố tình ẩn thì những ứng dụng client-side khó phát huy được tác dụng. Cho dù có tác dụng đi chăng nữa, đây cũng là tình trạng đã xảy ra và tư duy của mình cứ tự động đi ngược lại vị trí "phòng thủ" ;). Giả sử nạn nhân bị tấn công quyết định từ rày về sau sẽ log tối đa thông tin (trên mọi tầng) để có thông tin cho forensics trong tình huống bị thâm nhập, chính nạn nhân ấy tự tạo cho mình một khó khăn mới và khó khăn này không phải nhỏ, đó là: tài nguyên (chỗ chứa, băng thông để chuyển tải dữ liệu đã log) và thời gian + nhân lực để thường xuyên theo dõi và phân tích dữ liệu thu thập được.

Nói thêm một tí về sự hạn chế của các ứng dụng "client-side" để thu thập thông tin. Ứng dụng "client-side" hoàn toàn nằm trên tầng application và chúng khó lòng thu thập được những thông tin có giá trị để sử dụng cho forensics. Giả sử perpetrator sử dụng L2IPsec VPN thì làm sao các ứng dụng client side thu thập được IP thật? Gay go hơn nữa, nếu perpetrator dùng một máy ảo (trên VMware, VirtualBox...) và dù có thu thập thông tin cỡ nào đi chăng nữa cũng chỉ toàn là thông tin thuộc máy ảo.

Theo anh thấy, social engineering trong những trường hợp này khả thi hơn là khai triển với góc độ kỹ thuật. Cá nhân anh thì anh thấy rất tởm những trò social engineering bởi vì những trò này xét cho cùng là những trò nói láo để dụ nai ;) nhưng phải nói là để điều tra thì nó là một thứ công cụ không thể xem thường. Social engineering càng dễ dàng hơn khi Internet càng ngày càng có nhiều những phương tiện giao lưu, các mạng xã hội, gởi mail ở dạng forged.... Ngay cả môt trò kích thích tò mò bằng cách tung ra một tin gì đó giât gân để thu hút sự chú ý để thu thập thông tin những trình duyệt truy cập và từ đó thu hẹp biên độ tìm kiếm (thông thường hiếm ai obsfucated "signature" của mình khi duyệt những trang tin tức phổ biến).

Nói tóm lại, chỉ có mấy ông amateur tưởng mình là đại cao thủ (sau khi dùng một mớ tool có sẵn) nhưng không nắm những khái niệm cover-track đúng mức (trong khi thâm nhập, sau khi thâm nhập và trong quá trình tung ra thông tin sau đó) thì mới bị tóm một cách dễ dàng.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255640</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255640</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 14:26:05]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Nhân mrro đề cập đến tính &quot;an toàn&quot; của t0r bên topic kia và một số anh em cũng đề cập đến mảng này, tớ thử &quot;t0r&quot; và capture một &quot;case&quot;.

Mô hình tớ thử t0r trong case này như sau:

<font color='red'>VMware Linux</font> (with t0r client) ---&gt; <font color='orange'>Mac OS host</font> --&gt; <font color='#6699CC'>Linux Firewall</font> ---&gt; <font color='violet'>Internet</font> ---&gt; <font color='yellow'>hvaonline.net</font> site.

1. Trên <font color='red'>VMware chạy Linux</font>, sau khi enable t0r client, tớ thử liệt kê netstat -nat thì thấy có kết quả sau:
<blockquote>tcp        0      0 127.0.0.1:49195             127.0.0.1:<font color='orange'>9051</font>              ESTABLISHED 
tcp        0      0 127.0.0.1:9051              127.0.0.1:49195             ESTABLISHED 
tcp        0      0 192.168.41.196:39646        <b>171.25.193.20</b>:<font color='red'>443</font>           ESTABLISHED 
tcp        0      0 192.168.41.196:40618        <b>38.229.70.53</b>:<font color='red'>443</font>            ESTABLISHED 
tcp        0      0 192.168.41.196:50637        <b>146.185.23.180</b>:<font color='red'>443</font>          ESTABLISHED &nbsp;
		</blockquote>

trong đó, 
- cổng 9051 chính là cổng &quot;Control Port&quot; của t0r trên chính VMWare Linux.
- các IP 171.25.193.20, 38.229.70.53 và 146.185.23.180 trên cổng 443 là các t0r relay servers.

Các t0r relay servers này có thể thay đổi thường xuyên.

Trên VMware Linux box này, tớ access<span class="link"> http://www.hvaonline.net</span> và capture packets xuyên qua cổng 443 bằng tcpdump. Mặc dù tớ duyệt<span class="link"> http://www.hvaonline.net</span> là qua cổng 80 bình thường nhưng vì t0r client đẩy traffic xuyên qua cổng 443 của t0r network cho nên sniff trên cổng 80 sẽ không có thông tin gì hết.

Packets được sniff trên cổng 443 ngay trên VMware Linux box như sau:
<br>
			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/posts/downloadAttach/1106.hva' border="0" onload="maxImg(this, 500px);" /></div>

Các bạn cũng thấy, IP 192.168.41.196 là private IP của chính VMware Linux box và IP <b>171.25.193.20</b> là IP của t0r relay server. Nếu client bị sniff trong trường hợp này, cùng lắm chỉ thấy được có traffic từ localhost này đi đến 1 trong vài ngàn t0r relay servers nhưng không thấy được gì khác vì payload hoàn toàn được mã hoá bằng <b>TLS 1.0</b> (ngoại trừ...):

<br>
			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/posts/downloadAttach/1109.hva' border="0" onload="maxImg(this, 500px);" /></div>


2. Trên <font color='orange'>Mac OS host</font>, nếu chạy netstat, tớ sẽ thấy các connections:
<b>tcp4       0      0  172.17.1.205.52763     146.185.23.180.443     ESTABLISHED
tcp4       0      0  172.17.1.205.52676     38.229.70.53.443       ESTABLISHED
tcp4       0      0  172.17.1.205.52674     171.25.193.20.443      ESTABLISHED</b>

cái này là do <font color='red'>VMware chạy Linux</font> sử dụng NAT (cho network) trên VMware và trên <font color='orange'>Mac OS host</font>, nó làm việc như chính nó đang connect đến các t0r relay servers.

Thử sniff trên <font color='orange'>Mac OS host</font>, tớ thấy:
<br>
			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/posts/downloadAttach/1107.hva' border="0" onload="maxImg(this, 500px);" /></div>

trong đó,

- 172.17.1.205 chính là private IP của máy <font color='orange'>Mac OS host</font>
- 171.25.193.20 cũng chính là IP của một trong nhiều ngàn t0r relay IP.

Cũng như trên VMware, traffic này hoàn toàn được encrypted (<b>TLS 1.0</b>). 


3. Trên <font color='#6699CC'>Linux Firewall</font> cũng tương tự như trên.

4. Trên <font color='yellow'>hvaonline.net</font> site, tcpdump cụ thể cho thấy:

<br>
			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/posts/downloadAttach/1108.hva' border="0" onload="maxImg(this, 500px);" /></div>

- 89.45.202.93 lại là một t0r relay server khác hoặc một t0r node ở dạng &quot;exit relay&quot;.
- 74.63.219.12 chính là IP của HVA.

Từ t0r relay node này, traffic đi vào HVA hoàn toàn không encrypted (như hình minh hoạ).

Hai điểm lý thú ở đây:

a. Từ client (trên <font color='red'>VMware Linux</font>) đến đích (<font color='yellow'>hvaonline.net</font>) mình không biết traffic đi xuyên qua bao nhiêu t0r nodes và xuyên qua những nodes nào. Khi đến đích, một IP hoàn toàn khác (89.45.202.93) với IP được kết nối vào t0r relay network (171.25.193.20) được dùng để truy cập HVA. Nếu điều tra ngược lại, không cách gì dựa vào 89.45.202.93 để trace ngược lại điểm xuất phát (171.25.193.20) bởi vì làm sao trace được khi t0r pass through những t0r nodes dynamically? Đó là chưa kể, từ client (trên <font color='red'>VMware Linux</font>), t0r relay servers có thể thay đổi thường xuyên và mỗi lần thay đổi như vậy, requests lại đi xuyên các t0r nodes khác nhau trước khi đến đích là HVA.

b. Tất cả các encryption channels trên đường đi (trong giới hạn mình có thể capture) đều là TLS 1.0. Có lẽ đây là lý do mrro cảnh báo (BEAST, anyone? ;) ).
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255651</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255651</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 19:12:40]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Em xin bổ sung một chút về một số điểm. 
- Đối với các công ty tổ chức thì thường có những quy trình ứng phó với các sự cố, dĩ nhiên Nếu một công ty cỡ nhỏ hoặc quản trị viên quá kém cỏi hay lười nhác thì sẽ không có quy trình. Tuy nhiên sơ đẳng cũng biết nên ứng phó như thế nào (Do không có quy trình chi tiết nên sẽ bối rối và có thể phạm sai lầm). 
- Một vài bước trong quá trình forensic 

<b>Một vài giả định: </b>

- Điều tra viên có đầy đủ tool hỗ trợ việc forensic (công cụ phục hồi dữ liệu, các phần mềm phân tích log ….)
- Các thông tin hacker lấy được lần lượt được hacker công bố (tương tự như trường hợp của BKAV)
- Các bên liên quan phối hợp hỗ trợ thông tin cho quá trình forensic. 

<font size='+2'><font color='orange'><b>I. PHỤC HỒI HỆ THỐNG VÀ ĐÁNH GIÁ THIỆT HẠI</b></font></font>

<font size='+1'><b><font color='green'>Về mặt kỹ thuật:</font></b> </font>
<ul><li>Đưa server dự phòng vào hoạt động, đồng thời triển khai Firewall và IDS để giám sát tránh tình trạng Hacker quay lại tiếp tục phá hoại. 
Cách ly Server bị tấn công đợi cơ quan điều tra vào cuộc. 
Đánh giá thiệt hại chung để đưa ra các thông tin bảo vệ khách hàng</li></ul>
<font size='+1'><b><font color='green'>Về mặt PR:</font></b> </font>
<ul><li>Soạn một thông cáo báo chí chính thức, nhằm kiểm soát thông tin tránh các thông tin ngoài luồng gây ảnh hưởng đến uy tín của công ty. 
Cáo lỗi với khách hàng và cung cấp các thông tin hướng dẫn bảo vệ quyền lợi của khách hàng. 
Phối hợp với cơ quan điều tra để công bố các thông tin gây nhiễu (nếu cần thiết) phục vụ quá trình điều tra. </li></ul>
<font size='+2'><font color='orange'><b>II. TÌM HIỂU CÁCH THỨC HACKER XÂM NHẬP</b></font></font>

Do “hacker trẻ tuổi và tài năng” đã đưa ra các phân tích và nhận định quá đầy đủ, sâu sắc và chuẩn xác nên các thành viên khác không thể phân tích và nhận định được gì hơn :D 
<p></p>
		<cite class="blockquote">Hacker trẻ tuổi và tài năng wrote:</cite><br>
		<blockquote>
Trên đây có nhiều bạn đã trả lời với nhiều ý kiến. Có những ý kiến khá hay, đáng học hỏi. Nhưng có vẻ có những ý kiến hơi khái quát, hơi bao quát quá. Các giải pháp đưa ra có thể hay chỉ áp dụng như một nguyên tắc, nguyên lý, qui định chung về bảo mật hay khắc phục sự cố mà thôi.

Tôi xin bổ sung thêm một vài ý kiến nhỏ.

Ta giả dụ hệ thống bị defaced theo cách mà trang web webscan.bkav.com.vn bị defaced, nghĩa là hacker đặt đươc một file &quot;hacked.html&quot; vào thư mục gốc hay Documentroot của Apache, tức là của webserver và sau đó một vài ngày nó bị tấn công từ chôi dịch vụ và bị ngưng trệ trong nhiều ngay, dù có vẻ không có sự tham gia của một hệ thống botnet (DDoS zombies) trên mạng.

Điều quan trọng đâu tiên chúng ta phải xác định rõ cấu hình cụ thể của webserver vừa bị hack. 
Trước tiên, <font color='orange'><b>loại  HĐH</b></font> mà webserver cài đặt là một yếu tố rất quan trọng cần phải xem xét. Win2k3 hay Windows OS nói chung có những điểm yếu rất khó khắc phục, tạo cơ hôi cho hacker thâm nhập. Vấn đề phải tìm xem hành đông hay hiện tượng thâm nhập vừa qua có liên quan đến điểm yếu nào của Win2K3 hay không?
 Chú ý là việc update tự động các lỗ hổng bảo mật cho Windows thì MS làm khá tốt và dễ dàng. Vì vậy chỉ nên tập trung vào các lỗi mà admin của hệ thống bị hack chưa kip update, vì một lý do nào đó, hay lỗi mà MS chưa kịp ban hành bản vá lỗi trên mạng. Có rất ít hacker tim ra lỗi 0-day để hack.

 Điểm thứ hai chúng ta phải xem xét đến phiên bản <font color='orange'><b>web server </b></font>(trình quản lý web) được cài trong hệ thống. Ở đây là Apache(Win32)2.2.15. Apache không ban hành các bản vá lỗi tự động như MS cho Windows. Họ chỉ ban hành các phiên bản mới thay cho các phiên bản cũ có lỗi, có khả năng bị hack. Hiện nay đã là Apache 2.2.22 (released 2012-01-31). Chỉ cần tham khảo tài liệu của Apache là biết các lỗi của phiên bản cũ. Vấn đề chỉ còn là phải xác định hiện tượng và hành đông xâm nhập cụ thể của hacker vừa qua có liên quan đến các lỗi này không và đó là lỗi nào? (Tuy nhiên xác định được điều này không hề dễ dàng tí nào).

 Điểm thứ 3, nhưng có khi lại là quan trọng nhất là các <font color='orange'><b>application</b></font> được cài đặt trong hệ thống. Các application ở đây là PHP 5.3, MySQL 5.1, vBulletin 4.1.5.... Chú ý là các application mới là các nguyên nhân tạo ra nhiều lỗ hổng để cho hacker đột nhập hay defaced hệ thống. Một Application đươc cải tiến để tiện dụng hơn, có nhiều tính năng hơn thì lai càng có nhiều lỗ hổng hơn, đó là hậu quả, là &quot;side effect&quot;, điển hình là PHP chẳng hạn.

 Vì vậy nếu hiện tượng haker defaced website và để lai một file &quot;hacked.html&quot; ở root thì điều trước tiên ta phải nghĩ đến lỗi RFI (không phải &quot;Đài phát thanh Pháp quốc&quot; đâu nhé! Hì hì- mà là Remote file Inclusion vulnerability) hay LFI (Local File Inclusion). Lỗi này cho phép hacker đưa (upload) một file bẩn vào hệ thống từ xa và đặt nó ở directory hacker mong muốn. Vấn đề là admin của hệ thống đã không config. PHP (cụ thể là file php.ini) kỹ càng....<font color='orange'>(Các bạn ở BKAV cũng nên kiểm tra lai điều này).</font> Chú ý là chỉ PHP đời mới sau này, như PHP 5.3.x, mới có lỗi này. Hì hì.

Tất nhiên một hệ thống Windows cài DotNet (.Net framework ) như hệ thống mà anh conmale đưa, cũng có lỗi RFI, nhưng khả năng hacker tận dụng lỗi này có vẻ ít hơn.
 Chúng ta nhớ lai, trong đợt các hacker TQ defaced hàng loạt website của VN vừa qua, chúng cũng tận dụng lỗi nói trên (RFI). Ngược lai các hacker trẻ VN cũng làm giống như thế.

 Cũng cần xác định rằng việc hacker defaced website như trường hợp webscan.bkav.com.vn <font color='yellow'>thì không  có nghĩa là hacker đã chiếm được quyền admin (lấy được password)</font> của hệ thống đâu nhé. Khoảng cách đến đó nhiều trường hơp khá xa đấy.

 Còn việc hệ thống bị tấn công từ chối dịch vụ và bị ngưng trệ trong thời gian dài mà  không có sự tham gia cuả một hệ thống botnet trên mạng, thì thực tế có thể có đấy. Vấn đề là phải có hai yếu tố:
- Hacker phải dùng một <font color='yellow'>DoS tool loại nào</font>?
- Hệ thống phải <font color='yellow'>cài các application nào </font>để DoS tool này mới có thể phát huy tác dung? (<i>Chỉ cần một hay hai hacker DoS trong một vài phút là hệ thống có thể ngưng trê nhiều giờ</i>).Hệ thống mà anh conmale nói có cài các application ấy đấy.  Tuy nhiên vấn đề này tôi xin nói sau, vì bài viết đã dài.

Chỉ khi xác định đươc cách thức tấn công cụ thể của hacker thì ta mới chặn được nó và có biện pháp hữu hiệu để phòng thủ.
<font color='yellow'>
&quot;The Only Way To Stop A Hacker Is To Think Like One&quot;</font>
&nbsp;
		</blockquote>
Dựa trên các thông tin hacker công bố trên<span class="link"> http://bkavop.blogspot.com/2012/02/mon-qua-so-2-man-tau-hai-ve-bao-mat-cua.html</span> thì có thêm những lưu ý sau: 
- <b>Nguy cơ Server bị cài cắm Trojan</b>
<p></p>
		<cite class="blockquote">TQN wrote:</cite><br>
		<blockquote>
Trong file tasklist.txt, có vài điểm mà em nghi ngờ cái server này đã nhiểm virus của stl. Uổng thiệt, nếu cậu hacker này mà tasklist thêm thông số thì em khoẻ biết mấy: 
<blockquote>jusched.exe 1628 Console 0 6,136 K 
jusched.exe 2948 1 6,192 K 
wuauclt.exe 3652 Console 0 3,896 K 
jucheck.exe 3392 Console 0 8,588 K 
jucheck.exe 4136 1 7,344 K &nbsp;
		</blockquote>
jucheck # jusched nhé các bạn. Khả năng jucheck.exe là virus cao hơn jusched.exe của Java Update. 
Nếu đã tắt Windows Update thì wuauclt.exe sẽ không run, các bạn còn nhớ wuauclt.exe trong &quot;đống&quot; mèo què của stl chứ. 
Nếu em đoán đúng thì hết nói về cái BKAV phờ rồ. Nhưng nói vậy thôi chứ làm sao em có 3 mẫu này được ? 
&nbsp;
		</blockquote>
Nguy cơ Server bị nhiễm mã độc khi duyệt web trên chính server bằng chrome
<p></p>
		<cite class="blockquote">Anonymous wrote:</cite><br>
		<blockquote>
<font size='+1'><b>Cái ngu số 04</b></font>

Administrator lướt web ngay trên server và trong giờ làm việc

Bạn vui lòng tham khảo tệp tin &quot;tasklist.txt&quot; , bạn sẽ thấy các dòng sau:

<blockquote>chrome.exe                    4520 Console                    0     42,804 K
chrome.exe                    4588 Console                    0     32,088 K
&nbsp;
		</blockquote>
Sau khi thấy có quá nhiều process của trình duyệt Chrome đang vận hành trên server chúng tôi nghi ngờ là quản trị viên server đang lướt web ngay trên server nên thực hiện việc sniff gói tin trên server, kết quả khá thú vị khi thấy quản trị server đúng là đang lướt web đọc báo, thậm chí vô Facebook bằng Server của BKAV. Chúng tôi rất tiếc không thể cung cấp gói sniff đó lên đây do nó chứa nhiều thông tin có thể làm hại người vô tội.
&nbsp;
		</blockquote>

<font color='green'><b><font size='+1'>Đánh giá</font></b></font> 
Do hacker ra tay rất chuyên nghiệp và có sự chuẩn bị kỹ nên có thể hacker đã thăm dò rất kỹ và rất có thể đã xâm nhập vào trước đó. Nên cần kiểm tra lại log trên server và ISP trong vòng 1 tháng gần nhất đến thời điểm hiện tại. (Vì sao log quan trọng trong quá trình forensic sẽ giải thích ở phần sau).

<font size='+1'><font color='green'><b>1. Log trên Server</b></font></font>

Khi bị tấn công xâm nhập thì log trên server không còn đáng tin cậy, tuy nhiên bằng các phương pháp kỹ thuật ta cũng có thể có được các thông tin hữu ích cho quá trình forensic. 

<font color='red'><b>Trường Hợp 1: Log bị xóa</b></font> (do hệ thống tự động xóa hoặc quản trị viên vô tình xóa). 
Trường hợp này dễ dàng dùng các công cụ phục hồi dữ liệu chuyên nghiệp để lấy lại log nguyên bản. 

<font color='red'><b>Trường Hợp 2: Log bị xóa</b></font> (do hacker chủ động xóa). 
<ul><li>Trường hợp hacker xóa log bằng các câu lệnh xóa thông thường =&gt; Dễ dàng khôi phục lại log gốc bằng các công cụ chuyên dụng.
Trường hợp hacker xóa log bằng các công cụ xóa an toàn (xóa và ghi đè 30 lần chẳng hạn) =&gt; Không thể phục hồi log để phục vụ quá trình forensic. =&gt; Việc truy tìm và buộc tội hacker là điều cực kỳ khó khăn. Tuy nhiên cũng có thể còn chút dấu vết nào đó nhận dạng hacker (chương trình xóa an toàn hacker sử dung, thói quen xóa dấu vết khi xâm nhập ....)</li></ul>
<font color='red'><b>Trường Hợp 3: Log bị sửa</b></font>
Dùng các công cụ phục hồi dữ liệu chuyên dụng lấy lại log trước đó. So sánh sự khác nhau giữa log lưu trước đó và hiện tại (đơn giản với lệnh diff trên linux thì dễ dàng có được các đoạn log cần thiết).

<font color='red'><b>Trường Hợp 4: Log bị làm nhiễu</b></font>
Dùng các công cụ phân tích log và thống kê (splunk). Thông qua quá trình sàng lọc cũng sẽ được các thông tin cần thiết. 

<font color='red'><b>Trường Hợp 5: Kết hợp nhiều phương pháp</b></font>
Trường hợp này sẽ mất nhiều thời gian và có thể sẽ bị phát hiện trong lúc xóa dấu vết. =&gt; Trường hợp này hiếm xảy ra, nếu rơi vào tình trạng này thì việc điều tra cực kỳ khó khăn (có thể khiến quá trình forensic đi vào ngõ cụt). 

<font size='+1'><font color='green'><b>2. Log của ISP</b></font></font>

Đây là các thông tin có thể tin cậy. Kết hợp với phân tích log trên Server ta có thể biết được cách thức hacker xâm nhập, thời gian xâm nhập, IP .... Đồng thời kết hợp với log trên server thì ta có thể hình dung được các hành động của hacker trên hệ thống, đồng thời tìm các điểm yếu của hệ thống. 

<font size='+1'><font color='green'><b>3. Thu thập thông tin từ các bên liên quan và các nguồn khác</b></font></font>
<ul><li>Thu thập thông tin từ Blog: IP truy cập vào<span class="link"> http://bkavop.blogspot.com/</span> post bài, email đăng ký blogspot.
Thu thập thông tin từ nhà cung cấp email: IP và log quá trình đăng nhập và sử dụng tài khoản email. 
Thu thập thông tin từ các các nguồn khác: HVA, bkav, vozforum … =&gt; tìm các sai sót và cung cấp dữ liệu hình thành &quot;chân dung&quot; hacker</li></ul>

<font size='+2'><font color='orange'><b>III. Nghiệp vụ trong Forensic</b></font></font>

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>cách đây vài năm tôi có viết một bài nhắc đến Tor như là một công cụ tốt để trở nên ẩn danh trên Internet. bây giờ đọc lại thì tôi mới thấy, nói như cách g4mm4 hay nói, hạn chế của tôi hồi đó. bạn nào nghĩ rằng sử dụng Tor là an toàn thì bây giờ bắt đầu lo lắng là vừa. đối với một hệ thống có sự chuẩn bị tốt thì phải rất cao tay mới mong lai vô ảnh, khứ vô hình khi xâm nhập vào hệ thống đó. địa chỉ IP, thứ mà Tor có thể giúp che dấu một phần, chỉ là một trong số rất rất nhiều &quot;dấu vân tay&quot; mà chúng ta để lại khi duyệt web.&nbsp;
		</blockquote>
Như anh mrro đã đề cập địa IP chỉ là một mảnh nhỏ (tựa như dấu vân tay) trong quá trình forensic. Để hiểu hơn thì chúng ta tìm hiểu một chút về quy trình forensic.
 
<font size='+1'><font color='green'><b>Bước 1: Phân tích hiện trường và thu thập thông tin =&gt; phác họa chân dung thủ phạm</b></font></font>

Các thông tin cần thiết cho quá trình forensic: 
<ul><li>Dấu vân tay (Địa chỉ IP)
Dấu vết (hành vi của thủ phạm) và chứng cứ (log) tại hiện trường
Phân tích tính cách khả năng, hành vi của tội phạm (Thu thập thông tin từ các nguồn + Các biện pháp thăm dò tâm lý) =&gt; Phác họa chân dung cơ bản của tội phạm.</li></ul>
Các thông tin trên càng đầy đủ và chính xác thì quá trình xác định nghi can và tìm ra  thủ phạm càng nhanh chóng.

<b><font color='green'>Ví dụ:</font></b> Trường hợp của BKAV
<ul><li>Dựa trên các thông tin log ISP, và thông tin được cung cấp từ các công ty, tổ chức … Ta có thể xác định được là hacker sử dụng Tor nên việc tìm ra địa chỉ IP thực của hacker gần như là không thể (tạm thời thiếu mất một yếu tố). 
Dấu vết (hành vi của thủ phạm) và chứng cứ (log) tại hiện trường của BKAV chưa xác định được trạng thái. Nhưng dù chứng cứ (log) tại hiện trường có bị xóa sạch hay tạo hiện trường giả (sửa log, làm nhiễu log) thì vẫn còn các dấu vết (Các bước hành động tổng quát của hacker). 
Thêm các thông tin từ<span class="link"> http://bkavop.blogspot.com/,</span><span class="link"> https://www.facebook.com/pages/BKAV-Op/197446347029547?sk=wall,</span> các forum … Thì ta có thể hình thành bảng đánh giá phác họa chân dung Hacker.</li></ul>
<font color='red'><b>Chú thích:</b></font> Trong ngành phân tích tâm lý tội phạm, các nhà khoa học đã hình thành một bảng trắc nghiệm, đánh giá hành vi, tâm lý của tội phạm từ đó phác thảo tương đối chính xác (&gt;60%) “chân dung” tội phạm (kết hợp giữa khoa học phân tích tâm lý và suy luận khoa học xã hội). Bạn nào hay theo dõi phim điều tra phá án của của Anh, Pháp, Mỹ, Hồng Kông và các phim về CSI thì chắc biết phương pháp này :P (Phương pháp này giống phương pháp suy luận của Sherlock Holmes). Lúc đầu chỉ là bảng trắc nghiệm thống kê nhưng giờ một số nơi đã viết thành một phần mềm chuyên dụng nên hỗ trợ rất nhiều cho công tác điều tra  :*- 

<font color='green'><b><font size='+1'>Bước 2: Tạo danh sách Nghi Phạm và khoanh vùng các nghi can</b></font></font>

<b>Lên danh sách các nghi phạm (rất dài), dựa trên các kết quả phân tích khoa học và suy luận để thu hẹp danh sách nghi phạm (còn lại khoảng khoảng 1/4 đến 1/2 danh sách).</b> =&gt; Bước này thường dựa vào động cơ gây án để thu hẹp. 

<font color='green'><b>Ví dụ:</b></font>Trường hợp của BKAV 
Các nhóm đối tượng tình nghi:
Đối thủ cạnh tranh không lành mạnh
AntiFan 
Hacker muốn chứng tỏ tài năng (Nếu các thông tin tại<span class="link"> http://bkavop.blogspot.com/</span> chính xác thì các script kiddy cũng có thể thực hiện :D)
Hacker liên quan đến người bị bắt trước đó (02/02/2012)
Hacker bất bình với hành xử của BKAV =&gt; Trường hợp của BKAV có quá nhiều nghi phạm nên rất khó khăn trong quá trình forensic  =))
Còn có nhóm đối tượng nằm trong nhiều nhóm trên nữa. Đối với BKAV danh sách nghi phạm sẽ rất nhiều  :D 
<b>Tiến hành giám sát các nghi phạm, thu thập thông tin hình thành bảng đánh giá nghi phạm. </b>
=&gt; Đây là bước cực kỳ khó khăn, đòi hỏi nhân lực và thời gian theo dõi dài, nếu nghi phạm không có dấu hiệu bất thường (do xong việc) thì việc hình thành danh sách nghi can là cực kỳ khó. Chính vì vậy thường các điều tra viên thường tung tin sai lệch để thủ phạm lộ sơ hở =&gt; từ đó khoanh vùng nghi can.

<b><font color='green'>Ví dụ:</font></b> Trường hợp của BKAV
<p></p>
		<cite class="blockquote">vnexpress wrote:</cite><br>
		<blockquote>
Đại tá Trần Văn Hòa, Cục phó Cục Cảnh sát phòng chống tội phạm công nghệ cao (C50 - Bộ Công an), khẳng định với VnExpress.net rằng đã xác định được hacker - tác giả của những thông tin về các lỗi bảo mật của Bkav đang gây xôn xao trên mạng, đồng thời cho biết những gì hacker đưa lên có một số điều không chính xác.
&nbsp;
		</blockquote><span class="link"> http://vnexpress.net/gl/vi-tinh/hacker-virus/2012/02/bkav-len-tieng-ve-vu-phat-tan-8-sai-lam-bao-mat/</span> 
Thì nhanh chóng hacker có thông tin phản hồi: <span class="link"> http://bkavop.blogspot.com/2012/02/thu-gui-ngai-quan-chuc-chinh-phu-chuyen.html</span> 
Và: <span class="link"> https://www.facebook.com/pages/BKAV-Op/197446347029547?sk=wall</span> 

<font color='green'><font size='+1'><b>Đánh giá</b></font></font>
<ul><li>Đây là hành động nhóm hacker lo sợ sẽ “ảnh hưởng đến người vô tội” hoặc BKAV & C50 thí con tốt để trấn an dư luận. Lúc này mục tiêu ban đầu của hacker( đòi lại công bằng cho hacker bị bắt và hạ uy tín của BKAV) không đạt được. 
Hacker đã thăm dò và lên kế hoạch tỉ mỉ cho việc tấn công BKAV (deface, drop database, dump database, thông tin cấu hình các thành phần, …) đồng thời lộ trình đưa lần lượt các thông tin lên mạng. Nhưng vẫn chưa dự trù đối phó hết các chiêu tâm lý của BKAV & C50. Chính vì thế “thư gửi điều tra viên” kia có chút lúng túng nhưng lại được viết theo phong cách hành văn khác (giống cách hành văn phản hồi cho anh conmale). <b><font color='red'>-a-</font></b>
Hacker đã xác định tấn công BKAV thì C50 sẽ vào cuộc=&gt;  một mình Hacker đấu trí với một đội ngũ chuyên nghiệp là việc làm dại dột<font color='red'><b> -b-</b></font></li></ul>
=&gt;  Từ <font color='red'><b>-a-</b></font> và <font color='red'><b>-b-</b></font> ta có thể thấy rằng hacker tấn công BKAV có ít nhất 2 người và được phân công công việc một cách rõ ràng. 

<font size='+1'><font color='violet'><b>Dự đoán</b></font></font> 
<ul><li>BKAV vẫn tiếp tục im lặng nếu tìm được nghi phạm sẽ quăng bom, nếu không tìm ra thì im lặng và dùng các biện pháp bưng bít thông tin nhằm cho vụ việc rơi vào quên lãng. 
Hacker vẫn lần lượt tung các thông tin có được trong đợt xâm nhập BKAV
Màn đấu trí giữa C50 và hacker
Màn đấu khẩu giữa sgtc BKAV và cộng đồng IT </li></ul>
<b>Sau khi dùng các đòn tâm lý thì sẽ có một số nghi phạm có dấu hiệu bất thường</b>(Có tật thì giật mình  :P ) =&gt; Sàng lọc được một số đối tượng hình thành danh sách nghi can (còn khoảng chục người). 
<b>Tiếp tục giám sát nhằm thu hẹp các các nghi can</b> (để xin lệnh khám xét hoặc tạm giam để thẩm vấn cho dễ  -:-) ). 

<font size='+1'><font color='green'><b>Bước 3: Tiến hành thẩm vấn các nghi can và thu thập chứng cớ</b></font></font>

Lúc này các nghi can còn lại tương đối ít nên việc xin lệnh khám xét tương đối dễ.

<b><font color='red'>Trường Hợp 1:</font></b> Thu thập được các bằng chứng cần thiết =&gt; R.I.P
 Lúc này thẩm vấn rất đơn giản, hacker chỉ còn cách cúi đầu nhận tội. 

<b><font color='red'>Trường Hợp 2:</font></b> Không thu thập được bất cứ bằng chứng nào
<ul><li>Nghi can sẽ được hai nhân viên thẩm vấn (Có thể có một vài người giám sát để phát hiện nghi can có nói dối hay không). Bằng các biện pháp tâm lý từ đe dọa đến mềm mỏng để khai thác thông tin và khiến nghi phạm mất bình tĩnh mà để lộ sơ hở. =&gt; Nếu nghi can phạm tội thực sự sẽ để lộ sơ hở và bị người thẩm vấn hỏi vặn lại =&gt; Thành khẩn khai báo. 
Các nghi can có mối liên hệ với nhau thì tung hỏa mù dạng: “Thằng xxx và thằng yyy đã thành khẩn khai nhận, và nó nói chủ mưu chính là anh/chị” =&gt; Lần lượt từng người khai báo với suy nghĩ: “Nếu thằng xxx hay thằng yyy có khai báo thật và đổ tội hết lên đâu mình thì toi”
Nghi can khai báo lung tung hoặc không có gì để khai báo =&gt; Tiến hành thẩm vấn các nghi can khác. Nếu không thu được gì thì tiếp tùng sàng lọc lại các đối tượng. =&gt; Mất thời gian và có thể không tìm ra được thủ phạm. </li></ul>
<font size='+1'><font color='green'><b>Đánh giá:</b></font> </font>
<ul><li>Một đấu trí với hai thì không thể dành chiến thắng được  ;). Thực tế chứng minh dù tội phạm có tinh ranh và ngoan cố đến đâu đi chăng nữa, thì sau một thời gian thẩm vấn sẽ ngoan ngoãn nhận tội =&gt; Chính vì thế trong phim nghi can thường không nói gì khi không có luật sư bên cạnh. Ở Việt Nam thì tùy từng hoàn cảnh  =(( . 
Đôi khi nghi can tâm lý không vững nên sau khi bị đe dọa, bị mớm cung vẫn có thể nhận tội bừa =&gt; Đối với tội phạm kinh tế hay tội phạm công nghệ cao thì rất hiếm có trường hợp này. 
Nếu nghi can hoàn toàn không phạm tội thì sẽ chả có gì để khai :D =&gt; Đôi khi nghi can phạm tội nhưng khả năng ứng phó và đối đáp quá tài tình thì các điều tra viên cũng không thu được kết quả gì (Trường hợp này chỉ có những chuyên gia tình báo, nhân viên an ninh nằm vùng được đào tạo bài bản mới vượt qua được, trừ trường hợp mấy thằng bị mất trí nhớ =)) )</li></ul>

- Ky0 -

PS:
- Mới coi xong bộ Forensic Hero III, đang theo dõi bộ Sherlock Holmes 2011 nên bị nhiễm hơi nhiều :D
- Có lẽ nên dành một topic thảo luận về Tor thì hay nhất
- Năm nay sẽ là năm cao số khi Tor được mọi người sử dụng để tấn công các website  #:S ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255696</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255696</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 22:26:40]]> GMT</pubDate>
				<author><![CDATA[ Ky0]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Ky0 wrote:</cite><br>
		<blockquote>2. Log của ISP

Đây là các thông tin có thể tin cậy. Kết hợp với phân tích log trên Server ta có thể biết được cách thức hacker xâm nhập, thời gian xâm nhập, IP .... Đồng thời kết hợp với log trên server thì ta có thể hình dung được các hành động của hacker trên hệ thống, đồng thời tìm các điểm yếu của hệ thống.
&nbsp;
		</blockquote>


Điểm này e là rất khó Ky0.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255706</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255706</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 23:02:20]]> GMT</pubDate>
				<author><![CDATA[ Phó Hồng Tuyết]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Phó Hồng Tuyết wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">Ky0 wrote:</cite><br>
		<blockquote>2. Log của ISP

Đây là các thông tin có thể tin cậy. Kết hợp với phân tích log trên Server ta có thể biết được cách thức hacker xâm nhập, thời gian xâm nhập, IP .... Đồng thời kết hợp với log trên server thì ta có thể hình dung được các hành động của hacker trên hệ thống, đồng thời tìm các điểm yếu của hệ thống.
&nbsp;
		</blockquote>


Điểm này e là rất khó Ky0.&nbsp;
		</blockquote>
Trong quá trình forensic mỗi công đoạn có cái khó riêng nhất là việc thiếu hụt thông tin :P. 
Điểm mà Phó Hồng Tuyết đề cập sẽ vô cũng khó khăn nếu log trên server bị xóa hoàn toàn. Chưa hết việc thu thập log trong vòng 1 tháng vào server là việc khá khó khăn nếu ISP chỉ lưu trữ log trong vòng một tuần chẳng hạn. 
Việc phác họa về hacker dựa trên các thông tin và dấu vết có chính xác và chi tiết hay không phụ thuộc rất nhiều vào năng lực của điều tra viên. 

Mình chỉ đưa ra các bước tổng quát trong quá trình forensic và có lấy ví dụ với thông tin ít ỏi mình có được. Nếu ISP và BKAV cung cấp cho mình thêm thông tin và log thì mình sẽ có ví dụ để phân tích cụ thể hơn  ;)   

- Ky0 -]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255730</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255730</link>
				<pubDate><![CDATA[Sun, 26 Feb 2012 23:38:36]]> GMT</pubDate>
				<author><![CDATA[ Ky0]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ He he, chiều nay trong lúc họp, ngồi trace thử cái t0r client / server thì thấy rằng có hai phân đoạn rạch ròi:

1. handshaking giữa t0r client và t0r relay server(s).

2. traffic từ trình duyệt đi xuyên qua t0r tunnel (đã được thiết lập ở trên).

tcpdump và gdb xuyên qua quá trình "Hello" giữa t0r client và t0r relay server(s) và quá trình push giữa hai đầu cho thấy trước khi mỗi payload được gởi đi, một record rỗng được chèn vô. Đây chính là tính năng của openSSL từ phiên bản 0.9.6d trở đi. Bởi vậy, BEAST không thể nào exploit được. Đây là biểu hiện y hệt như TLS 1.1 mà t0r clients và t0r servers sử dụng. Sở dĩ nó không bị "broken" bởi vì các t0r clients và t0r servers handshake trực tiếp không qua trình duyệt nào hết (không bị tình trạng broken negotiation như đã và đang xảy ra giữa trình duyệt thông thương và các web sites thông thường). Cả t0r clients và t0r relay servers đều đồng ý với dạng TLS rỗng được chèn cho nên chúng vẫn hoạt động bình thường. Chính vì vậy, việc "tóm" được một mảnh user secret (cookie chẳng hạn) từ một vị trí có thể đoán được như trong BEAST case là không thể xảy ra giữa t0r clients và t0r relay servers.

Sau khi tunnel (giữa t0r clients và t0r relay servers) được hình thành, trọn bộ thông tin đi từ trình duyệt (hoặc chat cient hoặc bất cứ cái gì có thể đi xuyên qua) hoàn toàn nằm ở dạng encrypted payload. Trình duyệt gởi và nhận thông tin với end-points (web site đích) không hề bị lộ ra ngoài để có thể thi triển BEAST.

Tóm lại, trình duyệt đi xuyên qua t0r tunnels là safe. Cùng lắm ISP chỉ có thể capture một IP của ADSL hoặc cable hoặc cái gì đó connect đến một t0r relay server (trong hàng ngàn cái) nhưng không thể capture được cái gì trong payload hết.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255775</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255775</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 01:35:17]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Em đoán ý của mrro là IP chỉ là 1 mảnh của forensic, nhiều thứ  còn có thể dựa vào behaviour.
Ví dụ như trong trường hợp BKAV sẽ là:
1. Khoanh vùng đối tượng, chắc chắn hay ít nhất sẽ có mối quan hệ giữa anh chàng bị bắt và BKAVOp.
2. Ngày trước mấy con bot của STL viết bằng VC++, nếu không may viết bằng Delphi chắc em cũng có trong danh sách bị tình nghi =]]
Nói chung, các biện pháp kỹ thuật là 1 phần trong cuộc điều tra, để xem vài ngày nữa có tình tiết nào mới không.
Ngoài ra, theo ý riêng của em, vì BKAV không lường trước được sự việc là sẽ bị hack nên có thể đã bị cài backdoor từ lâu rồi mà không để ý --&gt; các log quan trọng không giữ được hay khó để lần ra lại từ đầu mà ngay cả hiện nay không biết nội bộ BKAV đã biết được hổng chỗ nào chưa để fix.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255918</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255918</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 10:17:56]]> GMT</pubDate>
				<author><![CDATA[ LeVuHoang]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">LeVuHoang wrote:</cite><br>
		<blockquote>Em đoán ý của mrro là IP chỉ là 1 mảnh của forensic, nhiều thứ  còn có thể dựa vào behaviour.
Ví dụ như trong trường hợp BKAV sẽ là:
1. Khoanh vùng đối tượng, chắc chắn hay ít nhất sẽ có mối quan hệ giữa anh chàng bị bắt và BKAVOp.
2. Ngày trước mấy con bot của STL viết bằng VC++, nếu không may viết bằng Delphi chắc em cũng có trong danh sách bị tình nghi =]]
Nói chung, các biện pháp kỹ thuật là 1 phần trong cuộc điều tra, để xem vài ngày nữa có tình tiết nào mới không.
Ngoài ra, theo ý riêng của em, vì BKAV không lường trước được sự việc là sẽ bị hack nên có thể đã bị cài backdoor từ lâu rồi mà không để ý --&gt; các log quan trọng không giữ được hay khó để lần ra lại từ đầu mà ngay cả hiện nay không biết nội bộ BKAV đã biết được hổng chỗ nào chưa để fix.&nbsp;
		</blockquote>

Anh nghĩ nghiệp vụ thu hẹp biên độ thì make sense nhưng chỉ dựa vào IP của t0r mà điều tra thì vô khả thi. 

Anh thử analyse những packets đi xuyên qua t0r tunnel đến HVA thì thấy chúng hoàn toàn bình thường và hợp lệ. Không có bất cứ một signature nào đặc biệt để có thể tách rời nó ra mà điều tra. Điểm vô vọng nhất là xác định bao nhiêu t0r "exit nodes" mà packets đi xuyên qua để trace ngược lại IP nguyên thuỷ của người dùng. Nhìn cái hình này thì đúng là bó chiếu:

<br>
			<div align="center" class="limitview"><img src='https://www.torproject.org/images/htw3.png' border="0" onload="maxImg(this, 500px);" /></div>

Giả sử những cái X màu xanh ở trên là những IP random của người dùng t0r khắp nơi trên thế giới mà họ đã set trong t0r client:

<br>
			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/posts/downloadAttach/1110.hva' border="0" onload="maxImg(this, 500px);" /></div>

thì làm sao mà trace?

Những IP của người dùng chẳng những là những dynamic IP (thay đổi thường xuyên) mà chính t0r path cũng thay đổi liên tục thì quả là bó tay.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255943</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255943</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 17:09:47]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ giờ mới có thời gian xem chủ đề này một cách rốt ráo.

<b>@conmale</b>: bọn em có làm việc với nhóm Tor khi công bố BEAST và kết luận, đúng như anh nhận xét, Tor không bị ảnh hưởng bởi BEAST vì họ sử dụng miếng vá của OpenSSL từ đầu [1]. dẫu vậy thì ý của em không phải là nói đến độ an toàn của Tor. mời anh xem tiếp để rõ ý em.

<b>@al0nex</b>: cảm ơn vì bạn đã đưa ra một nhận xét rất thú vị: BKIS sẽ bỏ ra bao nhiêu tiền để truy lùng thủ phạm (và rốt cuộc sẽ thu lại được gì)?

<b>@.lht.</b>: phác thảo về cách phát hiện thủ phạm của bạn dùng Javascript cookie chính là điều mà mình muốn nói đến.

thực tế thì ngoài địa chỉ IP, sử dụng Tor hay không sử dụng Tor và Javascript cookie ra, còn có rất nhiều cách khác để một website có thể theo dõi được chúng ta. những kết quả nghiên cứu gần đây cho thấy rất khó để có thể trở nên ẩn danh hoàn toàn khi duyệt web [2] [3] [4].

điểm yếu cốt lõi, mà mình đã có lần đề cập, là attacker thường không có ý định xâm nhập trong những lần đầu tiên viếng thăm nạn nhân. dựa quan sát này và các kết quả nghiên cứu ở trên, người ta hoàn toàn có thể "đánh dấu" trình duyệt của attacker, để rồi khi attacker thực hiện tấn công, hoặc quay lại hiện trường để dò la tin tức, người ta có thể nhanh chóng nhận ra anh attacker này là ai trong quá khứ, mặc dù anh ấy đã cố tính đi xuyên qua Tor. nói nôm na là mặc dù đã che đi khuôn mặt, nhưng hình xăm trên tay hoặc giọng nói hoặc cử chỉ vẫn có thể tố cáo thủ phạm.

để triển khai được một hệ thống theo dõi như thế này cũng không quá khó. dẫu vậy ở nhiều quốc gia, theo dõi người dùng như thế là một hành động không được hoan nghênh và có khi là phạm luật. mình nghĩ đối với một công ty như BKIS thì họ hoàn toàn có thể triển khai một hệ thống như thế, nhưng mình không tin là họ đã, đang hoặc sẽ làm. đơn giản vì có những việc đơn giản hơn nhiều và có hiệu quả tức thì như kiện toàn hệ thống mà họ còn không làm, thì khó mà hình dung họ sẽ đầu tư cho những biện pháp có tính phòng xa như thế này. 

ở góc nhìn ngược lại, attacker muốn không bị theo dõi thì phải cập nhật và hiểu rõ những nghiên cứu mới nhất về web security & privacy mà mình đề cập ở trên, rồi tìm cách tự bảo vệ bản thân, một việc mà mình cho là khó hơn rất nhiều so với tấn công BKIS.

nhân tiện mình cũng muốn nói đây là một chủ đề mà mình đã dự tính trình bày ở TetCon 2012, nhưng do không tìm được người làm cùng nên đành phải gác lại. nếu bạn <b>.lht.</b> hoặc ai đó có hứng thú thì mình sẽ rất sẵn sàng hỗ trợ bạn nghiên cứu về vấn đề này, như là một đề tài của TetCon 2013. chúng ta có thể triển khai đề tài này theo hai góc nhìn: góc nhìn của người dùng cuối muốn bảo vệ riêng tư khi duyệt web và góc nhìn của những attacker muốn ẩn danh khi hành sự. mình nghĩ đây là một đề tài rất thú vị, có khả năng tìm ra những kỹ thuật mới chưa được công bố.

-m

[1]<span class="link"> https://blog.torproject.org/blog/tor-and-beast-ssl-attack</span>

[2]<span class="link"> http://samy.pl/evercookie/</span>

[3]<span class="link"> https://grepular.com/Abusing_HTTP_Status_Codes_to_Expose_Private_Information</span>

[4]<span class="link"> https://panopticlick.eff.org/</span>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255945</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255945</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 17:33:32]]> GMT</pubDate>
				<author><![CDATA[ mrro]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>giờ mới có thời gian xem chủ đề này một cách rốt ráo.

<b>@conmale</b>: bọn em có làm việc với nhóm Tor khi công bố BEAST và kết luận, đúng như anh nhận xét, Tor không bị ảnh hưởng bởi BEAST vì họ sử dụng miếng vá của OpenSSL từ đầu [1]. dẫu vậy thì ý của em không phải là nói đến độ an toàn của Tor. mời anh xem tiếp để rõ ý em.
&nbsp;
		</blockquote>
Thanks em. Đọc phản hồi cụ thể của em, anh mới hiểu rõ ý em. Trong chủ đề ở mục "Các thảo luận khác", em có cảnh báo là t0r có thể không an toàn cho nên anh cứ nghĩ là bản thân t0r không an toàn cho nên mới lò dò tìm hiểu. Vậy cũng tốt vì ít ra mình xác nhận được là t0r (client và server) an toàn nếu như user không dùng thêm những thứ linh tinh như flash, java applets...v..v...

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
<b>@al0nex</b>: cảm ơn vì bạn đã đưa ra một nhận xét rất thú vị: BKIS sẽ bỏ ra bao nhiêu tiền để truy lùng thủ phạm (và rốt cuộc sẽ thu lại được gì)?

<b>@.lht.</b>: phác thảo về cách phát hiện thủ phạm của bạn dùng Javascript cookie chính là điều mà mình muốn nói đến.

thực tế thì ngoài địa chỉ IP, sử dụng Tor hay không sử dụng Tor và Javascript cookie ra, còn có rất nhiều cách khác để một website có thể theo dõi được chúng ta. những kết quả nghiên cứu gần đây cho thấy rất khó để có thể trở nên ẩn danh hoàn toàn khi duyệt web [2] [3] [4].

điểm yếu cốt lõi, mà mình đã có lần đề cập, là attacker thường không có ý định xâm nhập trong những lần đầu tiên viếng thăm nạn nhân. dựa quan sát này và các kết quả nghiên cứu ở trên, người ta hoàn toàn có thể "đánh dấu" trình duyệt của attacker, để rồi khi attacker thực hiện tấn công, hoặc quay lại hiện trường để dò la tin tức, người ta có thể nhanh chóng nhận ra anh attacker này là ai trong quá khứ, mặc dù anh ấy đã cố tính đi xuyên qua Tor. nói nôm na là mặc dù đã che đi khuôn mặt, nhưng hình xăm trên tay hoặc giọng nói hoặc cử chỉ vẫn có thể tố cáo thủ phạm.

để triển khai được một hệ thống theo dõi như thế này cũng không quá khó. dẫu vậy ở nhiều quốc gia, theo dõi người dùng như thế là một hành động không được hoan nghênh và có khi là phạm luật. mình nghĩ đối với một công ty như BKIS thì họ hoàn toàn có thể triển khai một hệ thống như thế, nhưng mình không tin là họ đã, đang hoặc sẽ làm. đơn giản vì có những việc đơn giản hơn nhiều và có hiệu quả tức thì như kiện toàn hệ thống mà họ còn không làm, thì khó mà hình dung họ sẽ đầu tư cho những biện pháp có tính phòng xa như thế này. 

ở góc nhìn ngược lại, attacker muốn không bị theo dõi thì phải cập nhật và hiểu rõ những nghiên cứu mới nhất về web security & privacy mà mình đề cập ở trên, rồi tìm cách tự bảo vệ bản thân, một việc mà mình cho là khó hơn rất nhiều so với tấn công BKIS.
&nbsp;
		</blockquote>
Trước kia anh đã từng dính vô vài projects thiết kế IDS và data mining cho nó. Thiết lập thì không khó nhưng khó ở chỗ có nhân lực và tài nguyên để duy trì và thường xuyên theo dõi hay không thôi  :P . Trong trường hợp BKAV hoặc những ứng dụng trên tầng web thì có lẽ Splunk là best candidate cho công tác theo dõi.

Xét ở góc độ chuyên nghiệp của kẻ tấn công theo anh thấy quả là không hẳn nằm ở attack vectors mà nằm ở chỗ "cover tracks". Covering tracks không những nằm ở biên độ và hiện trường nơi tấn công mà còn trải dài nhiều khu vực khác. Đối với "dấu vết" anh có thể thu thập được từ wearmon vì anh chàng đã đăng nhập HVA nhiều lần, sau khi phân tích, anh thấy bế tắc vì nó muôn trùng. Tuy vậy, đôi khi chính những thông tin mà "anonymous VN" gì đó tung ra lại hàm chứa những "dấu vết" nào đó  :P . Cái này thì phải cần đến nghiệp vụ phân tích ở mảng khác chớ không trực tiếp là computer forensics.

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
nhân tiện mình cũng muốn nói đây là một chủ đề mà mình đã dự tính trình bày ở TetCon 2012, nhưng do không tìm được người làm cùng nên đành phải gác lại. nếu bạn <b>.lht.</b> hoặc ai đó có hứng thú thì mình sẽ rất sẵn sàng hỗ trợ bạn nghiên cứu về vấn đề này, như là một đề tài của TetCon 2013. chúng ta có thể triển khai đề tài này theo hai góc nhìn: góc nhìn của người dùng cuối muốn bảo vệ riêng tư khi duyệt web và góc nhìn của những attacker muốn ẩn danh khi hành sự. mình nghĩ đây là một đề tài rất thú vị, có khả năng tìm ra những kỹ thuật mới chưa được công bố.

-m

[1]<span class="link"> https://blog.torproject.org/blog/tor-and-beast-ssl-attack</span>

[2]<span class="link"> http://samy.pl/evercookie/</span>

[3]<span class="link"> https://grepular.com/Abusing_HTTP_Status_Codes_to_Expose_Private_Information</span>

[4]<span class="link"> https://panopticlick.eff.org/&nbsp;</span>
		</blockquote>
Đề tài này rất lý thú. Nó đòi hỏi kiến thức rất sâu và rất rộng cộng thêm khả năng forensics nữa. Nếu khai triển thì hay lắm em.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255950</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255950</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 19:02:24]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Cảm ơn anh mrro, 
Thật sự với điều kiện chưa cho phép và trình độ có hạn nên em chỉ dám xin anh đống tài liệu để tham khảo và tham gia tích cực các hoạt động dạng như case study này để nâng cao kiến thức thôi :D
Về cái hội thảo TetCon thật sự em cũng rất thích được "hóng" nhưng vì em ở nước ngoài nên không đi "hóng" được :)

Mà từ mấy bài phân tích về Tor và coi qua cái Tor Bundle,  chắc em chuyển qua tìm hiểu về phương pháp phát hiện proxy và cấm tiệt không cho truy cập nếu phát hiện dùng tor quá =)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255959</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255959</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 21:00:13]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Lúc đầu bạn .lht. có đề cập đến việc chôm cookie dựa trên lỗi trình duyệt và ứng dụng web, sau đó bạn đã xóa 
 đi rồi, mình hoàn toàn đồng ý việc có thể xảy ra tình huống này. Bkav hay victim có thế lực hoàn toàn có thể bắt tay với những diễn đàn hay website thông dụng nào để chôm cookie người dùng trong giai đoạn điều tra tội phạm, tuy nhiên mình cho rằng việc làm này khá bẩn và vi phạm quyền riêng tư con người trầm trọng.

Gửi anh mrro:
<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>giờ mới có thời gian xem chủ đề này một cách rốt ráo.

<b>@conmale</b>: bọn em có làm việc với nhóm Tor khi công bố BEAST và kết luận, đúng như anh nhận xét, Tor không bị ảnh hưởng bởi BEAST vì họ sử dụng miếng vá của OpenSSL từ đầu [1]. dẫu vậy thì ý của em không phải là nói đến độ an toàn của Tor. mời anh xem tiếp để rõ ý em.

<b>@al0nex</b>: cảm ơn vì bạn đã đưa ra một nhận xét rất thú vị: BKIS sẽ bỏ ra bao nhiêu tiền để truy lùng thủ phạm (và rốt cuộc sẽ thu lại được gì)?

<b>@.lht.</b>: phác thảo về cách phát hiện thủ phạm của bạn dùng Javascript cookie chính là điều mà mình muốn nói đến.

thực tế thì ngoài địa chỉ IP, sử dụng Tor hay không sử dụng Tor và Javascript cookie ra, còn có rất nhiều cách khác để một website có thể theo dõi được chúng ta. những kết quả nghiên cứu gần đây cho thấy rất khó để có thể trở nên ẩn danh hoàn toàn khi duyệt web [2] [3] [4].

điểm yếu cốt lõi, mà mình đã có lần đề cập, là attacker thường không có ý định xâm nhập trong những lần đầu tiên viếng thăm nạn nhân. dựa quan sát này và các kết quả nghiên cứu ở trên, người ta hoàn toàn có thể "đánh dấu" trình duyệt của attacker, để rồi khi attacker thực hiện tấn công, hoặc quay lại hiện trường để dò la tin tức, người ta có thể nhanh chóng nhận ra anh attacker này là ai trong quá khứ, mặc dù anh ấy đã cố tính đi xuyên qua Tor. nói nôm na là mặc dù đã che đi khuôn mặt, nhưng hình xăm trên tay hoặc giọng nói hoặc cử chỉ vẫn có thể tố cáo thủ phạm.
&nbsp;
		</blockquote>

Nếu ngay từ khi bắt đầu dò thông tin về victim đến lúc quay lại hiện trường để dò la tin tức, mọi thông tin về trình duyệt đều được ngẫu nhiên hóa (randomize) thì làm sao tạo được <b><font color='yellow'>mối liên hệ</font></b> giữa những lần đầu tiên viếng thăm nạn nhân và lúc bắt đầu thăm dò nạn nhân cho đến các hoạt động về sau?
Nếu như attacker ngay từ đầu đã xác định mọi hành động đơn giản nhất từ việc thu thập thông tin liên quan đến bảo mật của victim đến các hành động về sau đều cần phải được thực hiện trong một máy ảo riêng với một trình duyệt riêng (ví dụ: Tor Browser Bundle) ở tiệm Cafe Internet/nơi có Public WiFi hoặc xuyên qua Tor network và không để lại một message nào ở website của victim thì ngoài thông tin về trình duyệt, còn có thể dựa vào thông tin nào khác để theo dõi người truy cập như mrro đề cập nữa không?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255981</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#255981</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 21:53:29]]> GMT</pubDate>
				<author><![CDATA[ bolzano_1989]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Mình chỉ end-user sử dụng Tor, theo như kiến thức của mình biết thì Tor trên máy của mình sẽ chọn bất kỳ node nào để truyền dữ liệu đến đích và đường đi này chỉ xác định trong khoãng thời gian nào đó chứ không phải thời gian hoàn toàn vĩnh viễn , kết thúc thời gian này xong thì nó lại xác định 1 đường đi kế tiếp, như vậy nó sẽ thay đổi liên tục và việc truy tìm thủ phạm rất gian nan, vất vã. 

<br>
			<div align="center" class="limitview"><img src='https://www.torproject.org/images/htw3.png' border="0" onload="maxImg(this, 500px);" /></div>

Bây giờ mình giả sử C50 muốn điều tra người tấn công vào BKAV Forum (mình sẽ bỏ qua vụ phân tích log trước mà tập trung vào việc hacker đó sử dụng Tor để tấn công vào BKAV Forum)

Câu hỏi đặt ra, nếu thói quen của "đối tượng" tấn công thành công vào BKAV Forum sau đó im hơi lặng tiếng,đánh bài chuồn...chẳng tiếp xúc với internet thì làm sao mà C50, ISP VN, doanh nghiệp bị hại bắt được hacker này. Trong khi đó khi người lập ra dịch vụ, cũng như người sử dụng tor đâu ai biết ai là ai !! Như <b>mrro</b> có đề cập đến vấn đề "cách phát hiện thủ phạm của bạn dùng Javascript cookie" giả sử như lúc này thu thập cookie của "nghi phạm" tình nghi trong khi đó nghi phạm chỉ 1 lần duy nhất thăm cái wesite này và hàng ngày có hàng chục ngàn lượt truy cập thì có khác nào mò kim xuống đáy biển.  :) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256000</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256000</link>
				<pubDate><![CDATA[Mon, 27 Feb 2012 22:28:36]]> GMT</pubDate>
				<author><![CDATA[ tranhuuphuoc]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ @bolzano_1989

mrro có nói đến evercookie =&gt; browser của attacker sẽ bị mark bằng 1 cookie đặc biệt, nên nếu attacker ghé thăm các domain mà cxx control thì cxx có thể rút ra một số lượng thông tin kha khá.

Anh conmale cũng có nói đến social engineering, tui nghĩ trong trường hợp này social engineering sẽ hữu hiệu hơn là technical solution. Bởi vậy các bạn chém gió nên chém vừa vừa thôi :D ( xem phim Mỹ mấy ông cớm hay chơi chiêu hù mấy em giang hồ vặt rồi lượm lặt vòng vo sẽ đến trùm )]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256033</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256033</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 00:49:21]]> GMT</pubDate>
				<author><![CDATA[ vd_]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">vd_ wrote:</cite><br>
		<blockquote>@bolzano_1989

mrro có nói đến evercookie =&gt; browser của attacker sẽ bị mark bằng 1 cookie đặc biệt, nên nếu attacker ghé thăm các domain mà cxx control thì cxx có thể rút ra một số lượng thông tin kha khá.

Anh conmale cũng có nói đến social engineering, tui nghĩ trong trường hợp này social engineering sẽ hữu hiệu hơn là technical solution. Bởi vậy các bạn chém gió nên chém vừa vừa thôi :D ( xem phim Mỹ mấy ông cớm hay chơi chiêu hù mấy em giang hồ vặt rồi lượm lặt vòng vo sẽ đến trùm )&nbsp;
		</blockquote>

Bạn để ý mình nêu ở trên là chỉ dùng 1 bản Tor Browser Bundle để duyệt website victim (không dùng bất cứ trình duyệt nào khác để vào website victim), dùng xong thì xóa luôn :) . Chú ý là nên kết hợp thêm extension NoScript khi duyệt website thông thường (đặc biệt là các website và diễn đàn Việt Nam hay quốc gia mà attacker đang sinh sống thì không bao giờ allow JavaScript  -:-) ).

Khi đã có ý định thăm dò bảo mật thì attacker có thể chạy Tor Browser Bundle trong máy ảo được setup riêng hoặc trong môi trường sandbox, dùng xong thì dọn dẹp sandbox luôn.
=&gt; Đảm bảo website victim không lưu lại vết nào trong máy tính của attacker.
=&gt; Khi truy cập các website khác bằng máy thật, không có vết nào để thu thập từ evercookie cả.

Giả sử C50 có kiểm soát được các forum hay website thông dụng để tạo và lấy được evercookie thì liệu họ có cơ sở nào để tạo được <font color='yellow'><b>mối liên hệ</b></font> giữa việc truy cập website khác (bằng trình duyệt thật thường dùng) với việc truy cập website victim như trên?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256044</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256044</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 01:34:32]]> GMT</pubDate>
				<author><![CDATA[ bolzano_1989]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Nếu kịch bản là:

- Hacker login vào một free VPS, online bằng TOR
- Cài máy ảo (VM)
- Cài 1 hệ điều hành Linux fresh vào VM
- Tấn công BKAV qua trình duyệt và application của VM
- Xóa harddisk của VM
- Ngắt kết nối với VPS
- Không bao giờ sử dụng VPS đó nữa (disable service hoặc terminate plan)

Rõ ràng cho dù có evercookie thì nó cũng chỉ save browser của máy ảo
Như vậy liệu có cách nào phát hiện được không ? Mọi người cho ý kiến ?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256091</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256091</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 06:38:46]]> GMT</pubDate>
				<author><![CDATA[ WinDak]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ Về mảng social engineering thật sự em thấy hay và không "tởm" như anh conmale nghĩ :D

Ở VN thường thấy nhất ở trường học, người ta chỉ "chú trọng" vào kiến thức mà "không quan tâm" đến khả năng giao tiếp của học sinh ...
Trong lĩnh vực security cũng vậy anh ạ, ngoài kĩ thuật tốt thì social engineering thật sự là 1 mảng rất hay đáng để nghiên cứu và thảo luận :D

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256125</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256125</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 08:49:20]]> GMT</pubDate>
				<author><![CDATA[ .lht.]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">WinDak wrote:</cite><br>
		<blockquote>Nếu kịch bản là:

- Hacker login vào một free VPS, online bằng TOR
- Cài máy ảo (VM)
- Cài 1 hệ điều hành Linux fresh vào VM
- Tấn công BKAV qua trình duyệt và application của VM
- Xóa harddisk của VM
- Ngắt kết nối với VPS
- Không bao giờ sử dụng VPS đó nữa (disable service hoặc terminate plan)

Rõ ràng cho dù có evercookie thì nó cũng chỉ save browser của máy ảo
Như vậy liệu có cách nào phát hiện được không ? Mọi người cho ý kiến ?&nbsp;
		</blockquote>

MAC là dấu chân asin trong trường hợp bạn nêu ở trên.

nếu VPS Free thì yêu cầu là bạn phải đăng ký dịch vụ (dính MAC - thậm chí là IP thật), thông tin sẽ được lưu lại nơi bạn đăng ký Free VPS.

Nếu VPS do bạn của bạn share thì mức độ nguy hiểm cao hơn.

--- 
trở lại vấn đề :

VPS thì tất nhiên nó có ip tĩnh. khi có ip này sẽ truy ra được nhà cung cấp dịch vụ nào.

Yêu cầu xin log của người mua VPS đó hoặc log đăng ký VPS.

Khi có được log này thì sẽ có khả năng có được IP thật và MAC

* nếu dùng FAKE IP : thì khó xác định.
* IP Thật + MAC : :|





]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256148</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256148</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 10:39:41]]> GMT</pubDate>
				<author><![CDATA[ Phó Hồng Tuyết]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">Phó Hồng Tuyết wrote:</cite><br>
		<blockquote>
MAC là dấu chân asin trong trường hợp bạn nêu ở trên.

nếu VPS Free thì yêu cầu là bạn phải đăng ký dịch vụ (dính MAC - thậm chí là IP thật), thông tin sẽ được lưu lại nơi bạn đăng ký Free VPS.

Nếu VPS do bạn của bạn share thì mức độ nguy hiểm cao hơn.

--- 
trở lại vấn đề :

VPS thì tất nhiên nó có ip tĩnh. khi có ip này sẽ truy ra được nhà cung cấp dịch vụ nào.

Yêu cầu xin log của người mua VPS đó hoặc log đăng ký VPS.

Khi có được log này thì sẽ có khả năng có được IP thật và MAC

* nếu dùng FAKE IP : thì khó xác định.
* IP Thật + MAC : :|

&nbsp;
		</blockquote>

Bạn có đọc kỹ tôi viết không vậy ? Tôi có nói rõ là sử dụng TOR, vậy thì trace về VPS như thế nào ? Chưa kể những dịch vụ như Amazon EC2 còn cho phép tạo và xóa VPS trong tài khoản cá nhân 1 cách tùy ý, và cũng không thấy có điểm nào đòi bạn phải đăng ký MAC address cả

Mời bạn trình bày tiếp.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256166</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256166</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 13:49:05]]> GMT</pubDate>
				<author><![CDATA[ WinDak]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>
Attacker: Tor thì hại gì chứ ?
Me: Phiền bạn ghé qua đây ;)<span class="link"> https://check.torproject.org/?lang=vi</span>
Me: Vâng, <font color='red'>bản thân Tor nó có công cụ nhận dạng xem bạn có đang sử dụng Tor hay không</font>. Vậy <font color='red'>mấy bác bên BKAV cũng tạo 1 công cụ kiểm tra các IP truy cập đến đó có thuộc đám &quot;con cháu&quot; của Tor  không thì sẽ giới hạn được phạm vi.</font>
Me: Vâng, <font color='red'>nhưng không mấy ai lại trùng hợp cùng truy cập vào những site của BKAV cả </font>:-&quot;
Me: Bạn nghĩ sao khi mà BKAV khi phát hiện bạn dùng Tor, họ sẽ tiến hành theo dõi bạn ?
Me: <font color='red'>Khi biết bạn dùng Tor, họ sẽ lưu lại cái IP hiện hành vào Cookie của các trang web BKAV mà bạn truy cập . Sau đó những lần truy cập sau, cái cookie đó được lôi ra so sánh và cái IP trong đó được lôi ra để so sánh với những IP tiếp theo ở những lần truy cập tiếp theo ...</font>
&nbsp;
		</blockquote>
<p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>
Để đạt kết quả tốt hơn cũng <font color='red'>có thể kiểm tra hoặc thu thập thêm các thông tin liên quan trên client</font> có thể rồi tiến hành sàng lọc.
Và trong quá trình nghe ngóng tình hình, tâm lý của bạn attacker sẽ có khi quay trở lại. Và <font color='red'>ai dám chắc là bạn ý sử dụng Tor mãi ?</font>
<font color='red'>Javascript có thể sử dụng để tạo <b>custom cookie</b>.</font> Thử nghĩ đơn giản thế này: Tại sao ta không lợi dụng javascript để moi móc thêm thông tin ngay trên client và gửi ngược lại lên server ? 
- Ví dụ với javascript, ta có thể lấy được thời gian hệ thống của client (từ đó biết được bạn ý đang thuộc &quot;zone&quot; nào)!
- Với javascript, ta có thể lấy được user-agent của trình duyệt.
Đó là còn chưa kể, <font color='red'>ngoài javascript thì còn có flash, java là những loại script chạy phía client</font> !
&nbsp;
		</blockquote>

<p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>
người ta hoàn toàn có thể &quot;đánh dấu&quot; trình duyệt của attacker, để rồi khi attacker thực hiện tấn công, hoặc quay lại hiện trường để dò la tin tức, người ta có thể nhanh chóng nhận ra anh attacker này là ai trong quá khứ, mặc dù anh ấy đã cố tính đi xuyên qua Tor. nói nôm na là mặc dù đã che đi khuôn mặt, nhưng hình xăm trên tay hoặc giọng nói hoặc cử chỉ vẫn có thể tố cáo thủ phạm.
&nbsp;
		</blockquote>

Hehe, tôi có tìm hiểu và sử dụng Tor từ lâu và nhưng tôi chưa bao giờ tìm hiểu Tor an toàn tới mức nào. Thật ra bây giờ tôi nhìn vào thứ này mà chú conmale đưa ra thì tôi mới bắt đầu cảm thấy &quot;hãi&quot; vì độ cover track của Tor là quá kinh khủng
<p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>
<b>109.163.233.201 - - [24/Feb/2012:01:56:48 -0600] &quot;GET /hvaonline/posts/list/41282.hva HTTP/1.1&quot; 200 13964 &quot;http://www.hvaonline.net/hvaonline/forums/show/19.hva&quot; &quot;Mozilla/5.0 <font color='red'>(Windows; U; X11; Windows NT 6.1</font>; rv:5.0) Gecko/20100101 Firefox/5.0&quot;</b>

<b><font color='red'>109.163.233.201</font> - - [24/Feb/2012:02:10:50 -0600] &quot;GET /hvaonline/posts/list/480/41193.hva HTTP/1.1&quot; 200 13808 &quot;http://www.hvaonline.net/hvaonline/forums/list.hva&quot; &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.20) Gecko/25250202 BTRS35926 Firefox/2.0.0.20 (.NET CLR 3.5.30729)&quot;</b>
&nbsp;
		</blockquote>

Ở bài viết sau đây, tôi xin mạn phép giới thiệu về khả năng cover-backtrack của Tor <font color='red'>tại client</font>,vì tôi thấy có <b>.lht.</b> và <b>mrro</b> không tin lắm về sự cẩn thận của tor, và phần này cũng khá thú vị ^_^.
Như mọi người đã biết, Tor-client chỉ đơn thuần là một client proxy làm nhiệm vụ kết nối tới Tor-server, nếu bạn nào lên trang download của tor mà down tor về thôi, bật lên thì chắc chắn là vẫn không truy cập được bằng proxy. Vì lý do là cần phải có một công cụ định hướng traffic (hoặc setup tay) từ browser =&gt; tor-client. Trong gói cài đặt thì Tor có một công cụ như thế gọi là Tor-button. Và extension này cực kỳ lợi hại, mời mọi người xem qua về document:<span class="link"> https://www.torproject.org/torbutton/torbutton-options.html.en.</span> Theo như tài liệu thì tôi thấy Tor-button chỉ ra các &quot;vết&quot; có thể để lại và đã vá như sau.
1. Disable các plugin khác như Flash, Java, QuickTime, SilverLight, .....
2. Làm nhiễu các đoạn javascript/CSS ẩn với nhiệm vụ reload liên tục, để khi user exit-Tor thì sẽ reveal IP của user ^_^, ngoài ra cũng có CSS popup nữa
3. Hook và mask các Date-object tại client-side, chú ý là timezone tại client side và nó có thể get bằng lệnh đại loại như sau:<span class="link"> http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_gettimezoneoffset</span>
4. Window dimension. Cái này là độ to khi bạn dùng trình duyệt, nếu mà luôn luôn mở dạng full-screen thì khi bị lấy thông tin, ví dụ như tôi dùng màn hình 1024x768, lúc điều tra ra 3 nghi can, 2 nghi can dùng màn hình rộng, có mỗi tôi là 1024x768 thì tôi sẽ bị tình nghi nhiều hơn ^_^. Ở đây Tor-button chuyển toàn bộ dimension về dạng bội số của 50px
5. Block Tor/Non-Tor access vào internet từ những url có dạng<span class="link"> file://</span>
6. Cấm truy cập history
7. Disable DOM Storage
8. Cookie: Store Non-Tor cookies in a protected jar =&gt; Non-Tor cookie sẽ được bảo vệ và che giấu
9. Spoof US English Browser. Bạn nào dùng Firefox-Vi thì sau khi activated Tor-button, bạn sẽ trở thành Firefox-En :D
10. Chỉnh sửa User-agent. Ở đây tor-button có nói rằng tất cả tor-user sẽ có một uniform, và đó là: Mozilla/5.0 (Windows NT 6.1; rv:5.0) Gecko/20100101 Firefox/5.0
11. Và một số chuyện rắc rối khác xảy ra từ extension khác, hay là lúc crash firefox,.......

Tôi thử bật tor-button và đi vào youtube, thì tôi thấy rằng:
<span class="link"> https://lh3.googleusercontent.com/-AEVLtW84_zE/T01GrEedRaI/AAAAAAAABOo/tFAPL2yPnGQ/s1280/noyoutube.png</span>
<br>
			<div align="center" class="limitview"><img src='https://lh3.googleusercontent.com/-AEVLtW84_zE/T01GrEedRaI/AAAAAAAABOo/tFAPL2yPnGQ/s640/noyoutube.png' border="0" onload="maxImg(this, 500px);" /></div>
không thể load được youtube :D vì flash đã bị disable

Như vậy là ít nhất là Flash đã bị vô hiệu hóa, các evercookie khác như Java, HTML5, .... thì tôi không rành lắm nên không thử được.

Bây giờ tôi thử get Time, window dimension và user-agent. Hình sau cho thấy time và các giá trị về dimension cũng đã bị mask
<br>
			<div align="center" class="limitview"><img src='https://lh6.googleusercontent.com/-qVBBlyNJEmY/T01GpwCpWlI/AAAAAAAABOo/C9wwAcuvE38/s640/torbutton.png' border="0" onload="maxImg(this, 500px);" /></div>

Ngoài ra có một điểm khá thú vị về User-Agent mà tôi vừa tranh cãi là thế này. Liệu Tor-client có giúp chúng ta chỉnh sửa user-agent hay không hay chỉ có Tor-button mới làm việc đó, hay là Tor exit-node quyết định đến User-Agent ? Thì tôi kiểm định bằng cách bật Tor-client, nhưng không dùng tor-button mà tự tay setup proxy thì tôi bị lộ user-agent, mặc dù có thể thấy là IP của tôi không phải là IP VN nữa
<span class="link"> https://lh4.googleusercontent.com/-cofv0fUv3rk/T01GqZ0xbNI/AAAAAAAABOo/I-MHNVjAmuM/s1280/nontorbutton.png</span><br>
			<div align="center" class="limitview"><img src='https://lh4.googleusercontent.com/-cofv0fUv3rk/T01GqZ0xbNI/AAAAAAAABOo/I-MHNVjAmuM/s640/nontorbutton.png' border="0" onload="maxImg(this, 500px);" /></div>

Còn đây là sau khi bật Tor-button
<span class="link"> https://lh6.googleusercontent.com/-qVBBlyNJEmY/T01GpwCpWlI/AAAAAAAABOo/C9wwAcuvE38/s1280/torbutton.png</span>
<br>
			<div align="center" class="limitview"><img src='https://lh6.googleusercontent.com/-qVBBlyNJEmY/T01GpwCpWlI/AAAAAAAABOo/C9wwAcuvE38/s640/torbutton.png' border="0" onload="maxImg(this, 500px);" /></div>

<span class="link"> https://lh5.googleusercontent.com/-r8e9rA1b1io/T01Gsd3ikWI/AAAAAAAABOo/Hs7W7YVB8Sg/s1024/ubuntu.png</span><br>
			<div align="center" class="limitview"><img src='https://lh5.googleusercontent.com/-r8e9rA1b1io/T01Gsd3ikWI/AAAAAAAABOo/Hs7W7YVB8Sg/s640/ubuntu.png' border="0" onload="maxImg(this, 500px);" /></div>

Và như vậy đúng như trong document đã ghi: &quot;User agent masking is done with the idea of making <b><font color='red'>all Tor users appear uniform</font></b>&quot; - điều này làm giảm đi sự bất thường khi bạn dùng một distro độc của linux chẳng hạn, sẽ khó mà dò ra bạn là ai một khi bạn đã khoác chiếc áo Tor.

Như vậy có thể thấy rằng khá nhiều fingerprint mà chúng ta thường hay không để ý thì Tor-button/Tor-browser đã bít khá nhiều. Tôi không chắc là có còn lỗ hổng nào nữa không, <font color='red'>nhưng nếu dùng các side-attack như evercookie, cookie, history, file-url-access, timezone như bạn .lht. đã nêu thì chúng ta có thể hoàn toàn yên tâm là tor đã handle hết vụ này</font> ^_^.

Tôi có thấy là weareanon có user-agent ban đầu hơi giống với user-agent uniform của tor-users, chỉ khác ở chỗ bị bôi đỏ (&quot;Mozilla/5.0 <b><font color='red'> (Windows; U; X11;</font></b> Windows NT 6.1; rv:5.0) Gecko/20100101 Firefox/5.0&quot; , nên weareanon có khả năng cao là đang dùng tor-browser rồi.

Ngoài ra nếu cài thử Tor-browser thì sẽ thấy Tor-browser sẽ bonus thêm cho ta những gì ?
a. Tor-browser có cài Tor-button
b. Noscript :D nhưng tôi ko biết nó để làm gì nên bạn nào rành về nó thì phân tích giùm tôi.
c. HTTPS everywhere.
d. Mỗi khi tắt Tor-browser, toàn bộ dữ liệu sẽ bị xóa sạch.
e. Tôi vào tab plugin (thường thì thấy plugin-flash nằm ở đấy) và phát hiện ra là nó trống trơn :D =&gt; hoàn toàn không phải lo ngại gì về super-cookie.


Sẵn bàn về weareanon, sáng hôm qua tôi có nghĩ đến một hướng khác để tìm ra weareanon. Tôi nghĩ là để download tor thì tôi chỉ việc vào google, gõ "tor", enter, vào trang torpoject.com và download tor. Vậy ở đây điểm yếu của weareanon là xác xuất mà weareanon connect đến torproject.org mà không có sự bảo vệ là rất cao, mà chưa kể là trong vòng mấy tháng qua theo tôi là hầu như ít có ai quan tâm tới tor cho lắm nên việc khoanh vùng dựa vào đây thì sẽ rất dễ. Nhưng tôi nghĩ là xác xuất mà ISP VN ghi hết cái mớ log đó là rất thấp vì không có log nào chứa nổi, chưa kể 50/50 là weareanon không phải đang ở VN vì thông tin về họ rất là mập mờ. Không biết mọi người nghĩ sao về nhận định này ?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256170</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256170</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 15:46:11]]> GMT</pubDate>
				<author><![CDATA[ kinggreedy1991]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">.lht. wrote:</cite><br>
		<blockquote>Về mảng social engineering thật sự em thấy hay và không "tởm" như anh conmale nghĩ :D

Ở VN thường thấy nhất ở trường học, người ta chỉ "chú trọng" vào kiến thức mà "không quan tâm" đến <font color='red'>khả năng giao tiếp</font> của học sinh ...
Trong lĩnh vực security cũng vậy anh ạ, ngoài kĩ thuật tốt thì social engineering thật sự là 1 mảng rất hay đáng để nghiên cứu và thảo luận :D

&nbsp;
		</blockquote>

He he, em gom chung "social engineering" với mọi dạng "khả năng giao tiếp" rồi. Khả năng giao tiếp trên căn bản trung thực và trong sáng (A) hoàn toàn khác khả năng giao tiếp trên căn bản thủ đoạn, mưu mẹo và thậm chí lừa lọc (B).

Social engineering <b>nhằm khai thác thông tin</b> ít khi nào dừng lại ở A mà hầu như cần phải khai thác tối đa ở B. Tởm là tởm ở chỗ đó.

Đối với anh, khoảng A là cần thiết và rất nên phát huy nhưng B thì không nên. Xã hội nay càng lúc càng nhiều lừa lọc, ranh mãnh và giả tạo rồi. Xây dựng thêm cái B chỉ thêm hại.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256171</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256171</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 15:48:49]]> GMT</pubDate>
				<author><![CDATA[ conmale]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <b>@WinDak, bolzano_1989</b>: trong một thế giới lý tưởng thì kẻ tấn công sẽ trở nên hoàn hảo và không phạm phải bất kỳ sai lầm nào như hai bạn mô tả. dẫu vậy có hai điểm mà các bạn cần lưu ý.

thứ nhất, các kịch bản mà các bạn đưa ra đều dựa trên giả thuyết là kẻ tấn công đã biết lỗi của BKIS từ trước. câu hỏi là làm thế nào mà kẻ tấn công tìm được lỗ hổng này? và trong quá trình tìm kiếm, thử nghiệm lỗ hổng đó, bạn có chắc chắn rằng kẻ tấn công sẽ thực hiện tất cả những gì mà bạn đưa ra trong kịch bản hay không? 

mình có nói ở trên, điểm khác biệt mấu chốt là tâm lý của kẻ tấn công. trong giai đoạn tìm kiếm, thử nghiệm lỗ hổng, rất có thể kẻ tấn công vẫn chưa có một ý định gì cụ thể (chẳng hạn như dùng lỗ hổng để deface BKIS). vì lẽ đó, rất có thể kẻ tấn công sẽ không quá cẩn thận và chính sự không cẩn trọng này sẽ tố cáo kẻ tấn công khi anh ta thực hiện tấn công, mặc dù lúc này anh ấy đã rất cẩn thận. cá nhân mình từng thấy ít nhất 2-3 trường hợp như thế này trong thực tế rồi.

thứ hai, chúng ta đang giả định: kẻ tấn công biết và hiểu rõ các kỹ thuật theo dõi trên web. chính sự hiểu biết này giúp cho kẻ tấn công xây dựng được một kịch bản như hai bạn đưa ra. câu hỏi là chuyện gì sẽ xảy ra nếu kẻ tấn công không biết đến các kỹ thuật này? thực tế là không riêng gì kẻ tấn công mà <font color='yellow'>tất cả chúng ta đều không (thể) sợ và không (thể) phòng ngừa những nguy cơ mà chúng ta không biết</font>.

<b>@kinggreedy1991</b>: bạn nên tìm hiểu thật kỹ về các kỹ thuật theo dấu trên web dựa theo các tài liệu mà mình liệt kê ở trên, rồi từ đó hẵng hãy tìm hiểu tiếp xem Tor-browser với Tor-button có thật sự giúp bạn tránh bị theo dõi hay không. đây là một thử nghiệm thú vị, nên làm và sau khi làm xong nên gửi lên HVA để bàn thảo.

mình thấy bạn chưa hiểu bản chất của các kỹ thuật theo dõi, mà chỉ thực hiện vài bài kiểm tra qua loa rồi kết luận là chỉ cần sử dụng Tor-browser với Tor-button là an toàn. <font color='yellow'>ảo tưởng về khả năng của công cụ là tiếc nuối lớn nhất của các cầu thủ Juventus ;-)</font>.

-m
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256174</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256174</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 17:20:23]]> GMT</pubDate>
				<author><![CDATA[ mrro]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ @bolzano_1989

Tui đang nghĩ đến hướng indirect tiếp cận đến attacker. Ví dụ attacker nếu đủ khả năng thì sẽ xoá dấu vết bằng cách xoá máy ảo, trình duyệt v.v... Nhưng ở đây chúng ta chú ý là attacker còn thường xuyên vào các diễn đàn bàn về sự việc này để công bố và nghe ngóng, như vậy không lẽ mỗi lần post bài ở hva hay blogspot thì attacker (hoặc bạn của attacker) phải lặp lại hoàn toàn chu kỳ cài vm - tor - xoá vm v.v... Chưa kể theo thời gian thì sự chủ quan của con người sẽ tăng và sẽ dễ bị mắc sai lầm (to err is human) -&gt; chỉ cần đủ kiên nhẫn, đủ thời gian góp nhặt thông tin thông qua việc đánh dấu các phát biểu liên quan đến sự việc thỉ cũng có thể thu thập khá khá thông tin. Và như vậy, chỉ cần tóm bạn của bạn của bạn của .... thì với social engineering + &quot;physical&quot; engineering (xem phim Mẽo, quánh 1 trận thì cái gì cũng khai  :D ) =&gt; có thể tiếp cận được.

Vì vậy, cảnh báo của conmale hay mrro không bao giờ thừa.



]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256192</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256192</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 20:04:58]]> GMT</pubDate>
				<author><![CDATA[ vd_]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote> <font color='yellow'>tất cả chúng ta đều không (thể) sợ và không (thể) phòng ngừa những nguy cơ mà chúng ta không biết</font>.
&nbsp;
		</blockquote>
Câu này đã nghe mrro nhắc đến rất nhiều lần trước đây mà hình như không thấy ai nhớ đến :D ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256206</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256206</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 21:52:26]]> GMT</pubDate>
				<author><![CDATA[ neoad]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">vd_ wrote:</cite><br>
		<blockquote>@bolzano_1989

Tui đang nghĩ đến hướng indirect tiếp cận đến attacker. Ví dụ attacker nếu đủ khả năng thì sẽ xoá dấu vết bằng cách xoá máy ảo, trình duyệt v.v... Nhưng ở đây chúng ta chú ý là attacker còn thường xuyên vào các diễn đàn bàn về sự việc này để công bố và nghe ngóng, như vậy không lẽ mỗi lần post bài ở hva hay blogspot thì attacker (hoặc bạn của attacker) phải lặp lại hoàn toàn chu kỳ cài vm - tor - xoá vm v.v...
&nbsp;
		</blockquote>

Theo mình thì một khi đã có ý định ra vào các diễn đàn nghe ngóng tình hình thì tuyệt đối không dùng máy tính ở nhà, cơ quan, hay bạn bè, người thân để nghe ngóng. Ngoài ra thì máy ảo VMware cho phép restore lại trạng thái có thể tin tưởng được rất nhanh và tiện lợi, mình thấy cũng chẳng mất công mấy. Quan trọng là attacker cần mã hóa file ảnh của máy ảo để công tác forensics khi tịch thu máy tính của attacker nếu có không cho được kết quả nào, khi nào cần dùng thì giải mã ra dùng lại. Chú ý là sau khi dùng xong thì phải xóa (secure delete) luôn file ảnh đĩa mà máy ảo đang dùng hiện hành để không còn chứng cứ trong máy attacker nữa, dữ liệu nếu có được lưu lại cũng phải được mã hóa nốt (trong một ổ đĩa ảo chẳng hạn).

Để thuận tiện hơn thì về sau (sau khi đã thâm nhập và thu thập dữ liệu thành công) và để tránh những nguy cơ mà mình không biết, cứ dùng một live cd chuyên dùng cho Penetration Testing (Pen-Test) như BackTrack, v.v. để duyệt web nghe ngóng diễn đàn, dữ liệu cần lưu thì cứ phải được mã hóa và lưu trong một ổ đĩa ảo.
Ngoài ra attacker cần tránh truy cập website, diễn đàn + có hành động gì liên quan đến victim vào lúc đêm hôm khuya vắng ít người dùng máy tính truy cập mạng.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256207</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256207</link>
				<pubDate><![CDATA[Tue, 28 Feb 2012 21:57:37]]> GMT</pubDate>
				<author><![CDATA[ bolzano_1989]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>

<font color='yellow'>ảo tưởng về khả năng của công cụ là tiếc nuối lớn nhất của các cầu thủ Juventus ;-)</font>.

-m
&nbsp;
		</blockquote>

Thật sự đọc bài này của anh em không thể nhịn được cười  =)).
Cứ thấy admin <font color='red'>mrro</font> ít nói chuyện trên hva thì tưởng anh cứng nhắc lắm. Ai dè các câu nói cũng rất thâm thuý và hài hước.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256218</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256218</link>
				<pubDate><![CDATA[Wed, 29 Feb 2012 00:35:43]]> GMT</pubDate>
				<author><![CDATA[ phanledaivuong]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <font color='red'>To Err Is Human</font>
- Con người khi hành động hầu như đều có mục đích nào đó, tội phạm cũng vậy, trong quá trình thực hiện hành vi phạm tội của mình... tội phạm sẽ để lại dấu vết đồng thời, cũng tìm cách xoá dấu vết.
- Việc xoá dấu vết cũng đồng nghĩa với việc &quot;để lại các dấu vết khác&quot;.

Tất cả những tình huống, khả năng mà chúng ta đưa ra ở trên đều chỉ là giả định, mà điều tra (tiếp cận theo forensic) thì lại phải căn cứ vào &quot;kết quả thực tế&quot;.

Do đó, theo mình..... cứ giả định rồi theo cái giả định đó thì không bao giờ có hồi kết.

Đối với 1 vụ việc hay một vụ án gì đi nữa, vấn đề khó nhất chỉ là:
- Tầm quan trọng của vụ việc?
- Số lượng người huy động để tham gia ?
- Chi phí tổng thể là bao nhiêu?

Đó là những lý do phải cân nhắc :) NÊN | KHÔNG

Trở lại tình huống của BKAV chẳng hạn.
- Đi theo hướng khai thác mối quan hệ giữa &quot;Hec cơ&quot; bị bắt với &quot;hec cơ&quot; hay &quot;nhóm hec cơ&quot; khác là một lợi thế?

Cụ thể như sau:

- Thông tin về hec cơ bị bắt
+ Số điện thoại <font color='red'>liên lạc, tin nhắn</font>
+ Thông tin về <font color='red'>email/pass</font> | Thông tin <font color='red'>account trên các diễn đàn</font>
+ Thông tin lưu ở máy tính (cái này thì <font color='red'>50/50</font>)
===&gt; Lọc ra các thông tin <font color='yellow'>(1)</font>

- Tác động tâm lý (hỏi, ghi lời khai,....)
+ Thời gian, Mục đích, quá trình thực hiện hành vi? v.v
+ Xác định sự phù hợp giữa thông tin ở <font color='yellow'>1</font> và <font color='yellow'>lời khai</font>
===&gt; Đưa ra các hướng để tác động tâm lý


]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256393</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#256393</link>
				<pubDate><![CDATA[Wed, 29 Feb 2012 22:13:09]]> GMT</pubDate>
				<author><![CDATA[ trantuan_bkhcm]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">mrro wrote:</cite><br>
		<blockquote>để triển khai được một hệ thống theo dõi như thế này cũng không quá khó. dẫu vậy ở nhiều quốc gia, theo dõi người dùng như thế là một hành động không được hoan nghênh và có khi là phạm luật. mình nghĩ đối với một công ty như BKIS thì họ hoàn toàn có thể triển khai một hệ thống như thế, nhưng mình không tin là họ đã, đang hoặc sẽ làm. đơn giản vì có những việc đơn giản hơn nhiều và có hiệu quả tức thì như kiện toàn hệ thống mà họ còn không làm, thì khó mà hình dung họ sẽ đầu tư cho những biện pháp có tính phòng xa như thế này. &nbsp;
		</blockquote>
Cái này quả là vấn đề thú vị mà em đang nghĩ đến. Mấy cái Log cũng khá nguy hiểm đến nỗi công ty em chặn cả Google Analytics :&quot;&gt;. Còn làm 1 cái tương tự thì ...
Nhưng mà em nghĩ nếu như sử dụng các công cụ như ẩn danh của chrome, thì có vẻ cũng rất hay đấy. Tuy nhiên đến mức độ disable cả Script, flash, java và Cookies thì cũng dễ gây nghi ngờ.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#257125</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#257125</link>
				<pubDate><![CDATA[Wed, 7 Mar 2012 07:57:45]]> GMT</pubDate>
				<author><![CDATA[ afterlastangel]]></author>
			</item>
			<item>
				<title>Case Study: phân tích hiện trường sau khi bị thâm nhập.</title>
				<description><![CDATA[ &lt;Lạc đề lan man&gt;
Nếu người thâm nhập chỉ cần không là người Việt Nam, ở Việt Nam như từ đầu đã nói thì em nghĩ không đến mức phải quá cẩn trọng trong mọi hành động nước bước.
Đơn giản nếu đã biết được tao là ai thì cũng không thể làm gì được tao nếu tao chẳng có liên hệ gì khi còn ở VN cả. Và cái danh sách blacklist của VN cũng dài lắm rồi nên mấy tên cỏn con này chắc cũng chẳng được để ý lắm.
=&gt; em đoán nhiều khả năng người này đang ở Việt Nam
&lt;/Lạc đề lan man&gt;

Quay lại vấn đề phân tích log khi truy cập. Mọi người chắc chỉ để ý đến Access Log không phân tích đến các log của Web Analytics. Để ẩn danh rắt kỹ thì chắc phải chuẩn bị kế hoạch và chắc chắn cũng cần audit trước khi tấn công vì con người mà...

Nhưng ví dụ nếu truy cập bằng Tor lúc đầu thì đã để lại 1 lỗ hổng rất lớn rồi. Vì các chữ kí lạ lẫm rất dễ bị phát hiện. (Không flash, không script, độ phân giải màn hình). 

Việc lục log của ISP là có khả năng xảy ra. Vì nghe đồn thì ISP ở VN cũng bị bắt buộc ghi log lại. Có người nói rằng an toàn khi xài Tor. Nhưng thử hỏi kỹ lại ở VN có bao nhiêu người dùng các port khác để truy cập vào 1 server mà không dùng port 80. ISP có thể lọc ra tất cả các kết nối đáng nghi ngại (nếu như đã có policy từ trước) như dùng VPN và xác định user đó đang dùng Tor. Theo em nghĩ đến lúc này có thể khoanh vùng lại còn chừng vài chục ngàn người. Sau đó so sánh các kết quả này với thời gian BKAV bị tấn công (nếu phát hiện được).
Anonymous có thể cầm cái mặt nạ để đi cướp an toàn nhưng chính cái mặt nạ ấy nên có thể người ấy đã là mục tiêu bị theo dõi từ lâu. (Ví dụ như 1 vụ án đối tượng sử dụng súng thì công việc của công an cũng rất dễ dàng để sàn lọc được đối tượng).]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41207.hva#257127</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41207.hva#257127</link>
				<pubDate><![CDATA[Wed, 7 Mar 2012 08:28:01]]> GMT</pubDate>
				<author><![CDATA[ afterlastangel]]></author>
			</item>
	</channel>
</rss>
