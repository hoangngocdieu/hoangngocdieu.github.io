<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Tính tổng dung lượng các file được tiến trình mở ra ? "]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/24.html</link>
		<description><![CDATA[Latest messages posted in the topic "Tính tổng dung lượng các file được tiến trình mở ra ? "]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Tính tổng dung lượng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ Hi mọi người,

Mình có một lệnh như sau : 
lsof -c httpd 

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>COMMAND   PID   USER   FD   TYPE             DEVICE      SIZE      NODE NAME
httpd    7617 nobody  644w   REG               0,53         0  10949472 /usr/local/apache/domlogs/test.xx
httpd    7617 nobody  645w   REG               0,53         0  10950052 /usr/local/apache/domlogs/test.xxx
httpd    7617 nobody  646w   REG               0,53         0  10949870 /usr/local/apache/domlogs/qbraxxx
httpd    7617 nobody  647w   REG               0,53         0  10949185 /usr/local/apache/domlogs/qbrandxxxxxx

...</pre>
		</div>

Bây giờ mình muốn tính tổng ở cột size thì làm thế nào nhỉ. Mong mọi người giúp đỡ
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259489</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259489</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 04:57:03]]> GMT</pubDate>
				<author><![CDATA[ pmquang]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ Bạn tìm cuốn sed & awk của O'Reilly mà đọc:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk '{ size += $7 } END { print size }'</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259508</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259508</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 08:26:39]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Bạn tìm cuốn sed & awk của O'Reilly mà đọc:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk '{ size += $7 } END { print size }'</pre>
		</div>&nbsp;
		</blockquote>

Cái trên thì mình cũng biết quanta oi. Nhưng nó hoàn toàn sai rồi.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259528</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259528</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 10:23:40]]> GMT</pubDate>
				<author><![CDATA[ pmquang]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">pmquang wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Bạn tìm cuốn sed & awk của O'Reilly mà đọc:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk '{ size += $7 } END { print size }'</pre>
		</div>&nbsp;
		</blockquote>

Cái trên thì mình cũng biết quanta oi. Nhưng nó hoàn toàn sai rồi.&nbsp;
		</blockquote>
Sai ở chỗ nào vậy bạn?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259529</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259529</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 10:27:39]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">pmquang wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>Bạn tìm cuốn sed & awk của O'Reilly mà đọc:

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk '{ size += $7 } END { print size }'</pre>
		</div>&nbsp;
		</blockquote>

Cái trên thì mình cũng biết quanta oi. Nhưng nó hoàn toàn sai rồi.&nbsp;
		</blockquote>
Sai ở chỗ nào vậy bạn?&nbsp;
		</blockquote>

À mình xin lỗi vì không đưa rõ cái output ra, cụ thể trong cái lệnh trên còn có những dòng như sau: 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>httpd    3640   root  mem    REG                9,1             29000181 /lib/libz.so.1.2.3 &#40;path dev=0,25&#41;
httpd    3640   root  mem    REG                9,1              4366361 &#40;deleted&#41; /lib/libcrypto.so.0.9.8e &#40;stat: No such file or directory&#41;
httpd    3640   root  mem    REG                9,1             29000105 &#40;deleted&#41; /lib/libssl.so.0.9.8e &#40;stat: No such file or directory&#41;
httpd    3640   root  mem    REG                9,1             11512775 /usr/local/apache/modules/mod_bwlimited.so &#40;path dev=0,25&#41;
httpd    3640   root  mem    REG                9,1             11512774 /usr/local/apache/modules/mod_auth_passthrough.so &#40;path dev=0,25&#41;
httpd    3640   root  mem    REG                9,1              4366365 &#40;deleted&#41; /lib/ld-2.5.so &#40;stat: No such file or directory&#41;</pre>
		</div>
như cái này thì $7 ở đây là NODE chứ không phải là size và cũng có thể có nhiều dòng không hợp chuẩn như thế nữa chẳng hạn như lâu lâu nó có thêm cái này 
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>httpd   28322 nobody 1038u  IPv4         3917352894                  TCP xx.xxxxx.vn:http-&gt;baiduspider-180-76-5-97.crawl.xxxx.com:15792 &#40;ESTABLISHED&#41;
httpd   28322 nobody 1039u  IPv4         3917353012                  TCP xx.xxxxx.vn:http-&gt;110.172.xxx.xxx:59698 &#40;ESTABLISHED&#41;</pre>
		</div>
quanta xem thử nhé.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259532</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259532</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 10:47:31]]> GMT</pubDate>
				<author><![CDATA[ pmquang]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ À, OK, đã có cách:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk 'NF &gt;= 9 { size += $7 } END { print size }'</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259535</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259535</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 11:29:37]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>À, OK, đã có cách:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk 'NF &gt;= 9 { size += $7 } END { print size }'</pre>
		</div>&nbsp;
		</blockquote>
NF ở đây là number field nên nó phải bằng 9 mới đúng chứ nhỉ. Mặc dù không phải tổng quát lắm nhưng lệnh trên cũng khá hữu ích với mình.

Ps: công nhận quanta siêu command linux thật ^^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259537</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259537</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 11:53:57]]> GMT</pubDate>
				<author><![CDATA[ pmquang]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>À, OK, đã có cách:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk 'NF &gt;= 9 { size += $7 } END { print size }'</pre>
		</div>&nbsp;
		</blockquote>
NF ở đây là number field nên nó phải bằng 9 mới đúng chứ nhỉ. Mặc dù không phải tổng quát lắm nhưng lệnh trên cũng khá hữu ích với mình.
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>httpd    3633 nobody  cwd    DIR               0,25      4096    3647702 /
httpd    3633 nobody  rtd    DIR               0,25      4096    3647702 /</pre>
		</div>

Ps: công nhận quanta siêu command linux thật ^^]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259538</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259538</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 11:53:59]]> GMT</pubDate>
				<author><![CDATA[ pmquang]]></author>
			</item>
			<item>
				<title>Tính tổng các file được tiến trình mở ra ? </title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">pmquang wrote:</cite><br>
		<blockquote><p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>À, OK, đã có cách:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk 'NF &gt;= 9 { size += $7 } END { print size }'</pre>
		</div>&nbsp;
		</blockquote>
NF ở đây là number field nên nó phải bằng 9 mới đúng chứ nhỉ. 
&nbsp;
		</blockquote>
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk 'NF &gt;= 10 { print $0 }'
httpd   17244 apache    4u  sock     0,5           4637231 can't identify protocol
httpd   17245 apache    4u  sock     0,5           4637231 can't identify protocol
httpd   17349 apache    4u  sock     0,5           4637231 can't identify protocol
httpd   17350 apache    4u  sock     0,5           4637231 can't identify protocol
httpd   17351 apache    4u  sock     0,5           4637231 can't identify protocol
httpd   17393 apache    4u  sock     0,5           4637231 can't identify protocol
httpd   17394 apache    4u  sock     0,5           4637231 can't identify protocol
httpd   18760   root    4u  sock     0,5           4637231 can't identify protocol</pre>
		</div>

Ồ, như vậy là lệnh trên vẫn chưa đúng. Hy vọng là cái này đã chặn được hết các trường hợp:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># lsof -s -c httpd | awk '$8 ~ &quot;&#91;0-9&#93;+&quot; { size += $7 } END { print size }'</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/41684.html#259539</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/41684.html#259539</link>
				<pubDate><![CDATA[Wed, 21 Mar 2012 12:00:06]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
	</channel>
</rss>
