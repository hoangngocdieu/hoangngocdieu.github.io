<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "load average cao nhưng cpu thấp"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/24.html</link>
		<description><![CDATA[Latest messages posted in the topic "load average cao nhưng cpu thấp"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ Xin chào anh chị !

Hiện tại mình có 1 server chạy website có load average lên rất cao khiến việc truy cập vào trang web rất  khó khăn và cả khi truy cập ssh hay truy cập từ console cũng rất chậm chạp,tuy nhiên cpu lại load thấp,mong mọi người xem giúp thử server đang bị vấn để gì vậy?

Đây là kết quả lệnh top khi server load cao,lúc này ssh vào rất khó khăn

<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>top - 14:55:57 up  5:24,  2 users,  load average: 168.09, 112.59, 53.37
Tasks: 400 total,   1 running, 399 sleeping,   0 stopped,   0 zombie
Cpu&#40;s&#41;:  3.4%us,  5.6%sy,  0.0%ni, 32.8%id, 58.1%wa,  0.0%hi,  0.1%si,  0.0%st
Mem:   4017820k total,  3986360k used,    31460k free,     1100k buffers
Swap:  8193140k total,  5034288k used,  3158852k free,    24236k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                                                           
15423 daemon    16   0  239m  59m 4952 S  1.3  1.5   0:03.57 httpd                                                                                                                             
15506 daemon    16   0  238m  58m 4968 S  1.7  1.5   0:03.43 httpd                                                                                                                             
15612 daemon    16   0  237m  57m 4952 S  2.0  1.5   0:01.89 httpd                                                                                                                             
15535 daemon    16   0  231m  53m 4536 S  0.0  1.4   0:01.72 httpd                                                                                                                             
15488 daemon    16   0  237m  52m 4808 S  2.7  1.3   0:01.71 httpd                                                                                                                             
15617 daemon    17   0  229m  51m 4544 S  1.3  1.3   0:06.64 httpd                                                                                                                             
15467 daemon    15   0  229m  51m 4508 S  0.0  1.3   0:05.40 httpd                                                                                                                             
15468 daemon    16   0  236m  46m 4512 S  0.0  1.2   0:02.82 httpd                                                                                                                             
15447 daemon    16   0  235m  45m 4496 D  0.0  1.2   0:02.35 httpd                                                                                                                             
15474 daemon    16   0  222m  43m 4084 D  3.3  1.1   0:02.34 httpd                                                                                                                             
15586 daemon    16   0  219m  41m 4548 S 13.9  1.1   0:03.00 httpd                                                                                                                             
15071 daemon    16   0  231m  39m 4984 D  0.0  1.0   0:07.92 httpd                                                                                                                             
 4235 mysql     15   0 1520m  38m 2812 S  1.3  1.0   2:12.51 mysqld                                                                                                                            
15452 daemon    15   0  214m  36m 4548 S  0.0  0.9   0:03.82 httpd                                                                                                                             
15589 daemon    15   0  214m  36m 4040 S  0.0  0.9   0:00.96 httpd                                                                                                                             
15513 daemon    15   0  214m  36m 4056 S  0.0  0.9   0:01.58 httpd                                                                                                                             
15519 daemon    15   0  214m  36m 4032 S  0.0  0.9   0:01.40 httpd                                                                                                                             
15518 daemon    15   0  214m  36m 4032 S  0.0  0.9   0:01.32 httpd                                                                                                                             
15530 daemon    15   0  214m  36m 4032 S  0.0  0.9   0:01.61 httpd                                                                                                                             
15515 daemon    15   0  214m  36m 4552 S  0.0  0.9   0:02.81 httpd                                                                                                                             
15536 daemon    15   0  214m  36m 4044 S  0.0  0.9   0:00.85 httpd                                                                                                                             
15573 daemon    15   0  211m  34m 4548 S  0.0  0.9   0:03.01 httpd                                                                                                                             
15470 daemon    15   0  211m  34m 4452 S  0.0  0.9   0:02.53 httpd                                                                                                                             
15598 daemon    16   0  211m  33m 4508 D  0.0  0.9   0:02.21 httpd                                                                                                                             
15596 daemon    16   0  211m  33m 4044 D  0.0  0.9   0:01.11 httpd                                                                                                                             
15465 daemon    16   0  219m  33m 3944 D  0.0  0.8   0:01.71 httpd                                                                                                                             
14626 daemon    17   0  216m  32m 4928 D  0.0  0.8   0:46.50 httpd                                                                                                                             
15627 daemon    15   0  210m  32m 3756 S  0.0  0.8   0:01.30 httpd                                                                                                                             
15574 daemon    15   0  210m  32m 3748 S  0.0  0.8   0:01.06 httpd                                                                                                                             
 2801 root      14 -10 38944  32m 1740 S  0.0  0.8   0:00.01 iscsiuio                                                                                                                          
15460 daemon    16   0  214m  31m 4040 D  0.0  0.8   0:01.61 httpd                                                                                                                             
15399 daemon    16   0  214m  31m 4076 D  0.0  0.8   0:02.55 httpd</pre>
		</div>

Rất mong sự giúp đỡ của mọi người, chân thành cảm ơn 



]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276770</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276770</link>
				<pubDate><![CDATA[Fri, 21 Jun 2013 03:31:15]]> GMT</pubDate>
				<author><![CDATA[ p.n.t]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ Nguyên nhân theo tớ thấy có thể có quá nhiều tiến trình apache -&gt; cậu xem logs coi phải bị DDOS hay không
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276782</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276782</link>
				<pubDate><![CDATA[Fri, 21 Jun 2013 22:07:07]]> GMT</pubDate>
				<author><![CDATA[ xwm]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ Theo mình có 3 yếu tố chính ảnh hưởng đến load average đó là: 
- CPU
- Disk I/O
- Network I/O

Ở đây bạn thấy CPU thấp --&gt; kiểm tra 2 yếu tố còn lại là Disk I/O và Network I/O. Từ đó sẽ tìm ra nguyên nhân chính xác là do đâu. 
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276784</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276784</link>
				<pubDate><![CDATA[Fri, 21 Jun 2013 22:37:27]]> GMT</pubDate>
				<author><![CDATA[ KhanhLN]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">xwm wrote:</cite><br>
		<blockquote>Nguyên nhân theo tớ thấy có thể có quá nhiều tiến trình apache -&gt; cậu xem logs coi phải bị DDOS hay không
&nbsp;
		</blockquote>

Cảm ơn cậu đã trả lời tuy nhiên sau khi kiểm tra thì việc bị ddos bị loại trừ

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276793</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276793</link>
				<pubDate><![CDATA[Sat, 22 Jun 2013 03:10:14]]> GMT</pubDate>
				<author><![CDATA[ p.n.t]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">KhanhLN wrote:</cite><br>
		<blockquote>Theo mình có 3 yếu tố chính ảnh hưởng đến load average đó là: 
- CPU
- Disk I/O
- Network I/O

Ở đây bạn thấy CPU thấp --&gt; kiểm tra 2 yếu tố còn lại là Disk I/O và Network I/O. Từ đó sẽ tìm ra nguyên nhân chính xác là do đâu. 
&nbsp;
		</blockquote>

Cảm ơn bạn đã trả lời, theo như trong output của lệnh top mình post lên thì thấy wait I/O cao (51%) và process apache chiếm Ram rất nhiều , vậy có thể tuning gì trong trường hợp này  để giải quyết tình trạng wait I/O cao(server mình đang dùng Raid 5 với 3 ổ SAS)???,còn Ram thì có lẽ phải upgrade thêm

Tks]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276794</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276794</link>
				<pubDate><![CDATA[Sat, 22 Jun 2013 03:17:26]]> GMT</pubDate>
				<author><![CDATA[ p.n.t]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ swap đang chạy tới 5GB kìa bạn, kiểu này đường nào ko treo server. Upgrade thêm Ram đi nha bạn. Check lại code php và compile lại apache và php với cấu hình thích hợp nhất xem sao nhé.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276802</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276802</link>
				<pubDate><![CDATA[Sat, 22 Jun 2013 10:22:43]]> GMT</pubDate>
				<author><![CDATA[ consoko]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ @p.n.t: bạn để ý cột STATE (S) xem có gì lạ không ;)?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276817</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276817</link>
				<pubDate><![CDATA[Sun, 23 Jun 2013 11:44:01]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>@p.n.t: bạn để ý cột STATE (S) xem có gì lạ không ;)?&nbsp;
		</blockquote>

Em thấy ở cột S có rất nhiều process httpd bị D state, chắc có lẻ đây là nguyên nhân chính dẫn đến Load Average tăng cao, anh quanta có thể đưa ra hướng xử lý tình trạng này giúp em được ko ạ?Cảm ơn anh trước]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276859</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276859</link>
				<pubDate><![CDATA[Mon, 24 Jun 2013 08:00:54]]> GMT</pubDate>
				<author><![CDATA[ p.n.t]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ D state là đang xài đĩa (IO), còn S state là sleep. R state là đang chạy (xài CPU).
Các tiến trình apache vừa xài đĩa nhiều (có mấy cái lận), mà lại thiếu RAM phải xài swap tới 5GB =&gt; IO wait cao (IO wait được tính vào load). =&gt; chậm lắm.
Cần nâng cấp RAM lên gấp đôi hoặc 3 số lượng hiện có (4GB -&gt; 12GB).
Hoặc là giảm số lượng max apache process xuống (có khả năng thiếu RAM do cái này).
Để ý thấy mỗi apache httpd chiếm khoảng 1% RAM, nghĩa là máy nên có 80-90 process = 90% RAM. Giảm số process xuống còn 90 thôi. người ta bị từ chối truy cập còn hơn là server đơ ra.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276866</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276866</link>
				<pubDate><![CDATA[Mon, 24 Jun 2013 11:44:17]]> GMT</pubDate>
				<author><![CDATA[ myquartz]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">myquartz wrote:</cite><br>
		<blockquote>D state là đang xài đĩa (IO), còn S state là sleep. R state là đang chạy (xài CPU).
Các tiến trình apache vừa xài đĩa nhiều (có mấy cái lận), mà lại thiếu RAM phải xài swap tới 5GB =&gt; IO wait cao (IO wait được tính vào load). =&gt; chậm lắm.
Cần nâng cấp RAM lên gấp đôi hoặc 3 số lượng hiện có (4GB -&gt; 12GB).
Hoặc là giảm số lượng max apache process xuống (có khả năng thiếu RAM do cái này).
Để ý thấy mỗi apache httpd chiếm khoảng 1% RAM, nghĩa là máy nên có 80-90 process = 90% RAM. Giảm số process xuống còn 90 thôi. người ta bị từ chối truy cập còn hơn là server đơ ra.&nbsp;
		</blockquote>

Thank myquartz nha, mình cũng đã upgrade Ram lên 16GB rồi và đang theo dõi xem sao]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276915</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276915</link>
				<pubDate><![CDATA[Tue, 25 Jun 2013 21:21:30]]> GMT</pubDate>
				<author><![CDATA[ p.n.t]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ @p.n.t: bạn enable SysRq lên rồi chạy `echo w &gt; /proc/sysrq-trigger` và mở kernel log ra xem mấy processes bị D state kia đang treo ở đâu.

Cho mình xem luôn:
- /proc/[pid]/wchan
- /proc/[pid]/status (chạy xong, đợi vài giây rồi chạy lại và gửi kết quả cả 2 lần lên)
- /proc/[pid]/io, /proc/[pid]/stack, /proc/[pid/syscall (nếu kernel đủ mới)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276916</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276916</link>
				<pubDate><![CDATA[Tue, 25 Jun 2013 21:37:39]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">quanta wrote:</cite><br>
		<blockquote>@p.n.t: bạn enable SysRq lên rồi chạy `echo w &gt; /proc/sysrq-trigger` và mở kernel log ra xem mấy processes bị D state kia đang treo ở đâu.

Cho mình xem luôn:
- /proc/[pid]/wchan
- /proc/[pid]/status (chạy xong, đợi vài giây rồi chạy lại và gửi kết quả cả 2 lần lên)
- /proc/[pid]/io, /proc/[pid]/stack, /proc/[pid/syscall (nếu kernel đủ mới)&nbsp;
		</blockquote>

Cảm ơn anh đã trả lời , hiện tại sau khi upgrade thêm Ram và số lượng truy cập chưa nhiều nên chưa có process D state , khi nào server xuất hiện tình trạng đó em sẽ gửi ouput lên cho anh xem giúp.Tks

]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#276917</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#276917</link>
				<pubDate><![CDATA[Tue, 25 Jun 2013 22:16:00]]> GMT</pubDate>
				<author><![CDATA[ p.n.t]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ Sẵn mấy anh cho em hỏi thêm thông tin lệnh Top được ko ạ, em ko hiểu mấy chỗ này có nghĩa gì:

PR
NI
VIRT
RES
SHR
TIME+

Cám ơn anh chị giúp đỡ.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#277041</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#277041</link>
				<pubDate><![CDATA[Mon, 1 Jul 2013 05:30:50]]> GMT</pubDate>
				<author><![CDATA[ everytest]]></author>
			</item>
			<item>
				<title>load average cao nhưng cpu thấp</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">everytest wrote:</cite><br>
		<blockquote>Sẵn mấy anh cho em hỏi thêm thông tin lệnh Top được ko ạ, em ko hiểu mấy chỗ này có nghĩa gì:

PR
NI
VIRT
RES
SHR
TIME+
&nbsp;
		</blockquote>
Đây là những từ viết tắt, ví dụ: PR là Priority, NI là Nice, ... Bạn gõ `man top` rồi `/` để search nhé, trong đó cũng giải thích ý nghĩa luôn.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/44875.html#277082</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/44875.html#277082</link>
				<pubDate><![CDATA[Tue, 2 Jul 2013 04:25:49]]> GMT</pubDate>
				<author><![CDATA[ quanta]]></author>
			</item>
	</channel>
</rss>
