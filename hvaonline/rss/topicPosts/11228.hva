<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/23.hva</link>
		<description><![CDATA[Latest messages posted in the topic "Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!</title>
				<description><![CDATA[ em đang cần code dùng để tạo folder và copy file bất kỳ vào nơi em để web của em bằng ASP 3.0

<b>VD: em đang để toàn bộ web của em ở ổ D: chẳng hạn,cả CSDL cũng ở đó luôn ~&gt; em muốn tạo 1 trang ASP có chắc năng tạo thêm folder trong ổ D: này.Sau khi tạo được folder rồi thì em muốn copy 1 flie bất kỳ từ ổ C: chẳng hạn vào folder vừa tạo ra đó.</b> :-o) 

~&gt; mong các bác giúp dùm ạ!

<b>Tiện thể các bác có thể hướng dẫn em tạo 1 trang ASP3.0 để up nhiều file cùng 1 lúc nhé, và những file đó có thể đến từ nhiều nguồn khác nhau nhưng khi up xong thì nó đều nằm chung trong 1 thư mục do mình chỉ định.</b>

Em cảm ơn trước!
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11228.hva#64607</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11228.hva#64607</link>
				<pubDate><![CDATA[Thu, 14 Jun 2007 09:47:40]]> GMT</pubDate>
				<author><![CDATA[ gulic]]></author>
			</item>
			<item>
				<title>Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!</title>
				<description><![CDATA[ sao k0 có ai giúp em hết vậy? Các bác ơi chỉ giùm với]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11228.hva#65807</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11228.hva#65807</link>
				<pubDate><![CDATA[Wed, 20 Jun 2007 00:17:12]]> GMT</pubDate>
				<author><![CDATA[ gulic]]></author>
			</item>
			<item>
				<title>Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">gulic wrote:</cite><br>
		<blockquote>sao k0 có ai giúp em hết vậy? Các bác ơi chỉ giùm với&nbsp;
		</blockquote>

Bạn hãy nghiên cứu phần FileSystemObject  trong ASP nhé, nó có thể xoá, di chuyển, tạo mới file và folder trên server.
bạn có thể tham khảo tại địa chỉ trên<span class="link"> http://www.w3schools.com/asp/asp_ref_filesystem.asp</span>

Chúc bạn sớm thành công]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11228.hva#65816</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11228.hva#65816</link>
				<pubDate><![CDATA[Wed, 20 Jun 2007 02:57:33]]> GMT</pubDate>
				<author><![CDATA[ soccon]]></author>
			</item>
			<item>
				<title>Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!</title>
				<description><![CDATA[ thank bác nhé!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11228.hva#65934</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11228.hva#65934</link>
				<pubDate><![CDATA[Wed, 20 Jun 2007 18:33:18]]> GMT</pubDate>
				<author><![CDATA[ gulic]]></author>
			</item>
			<item>
				<title>Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!</title>
				<description><![CDATA[ Còn đây là đoạn code xử lý việc upload file, bạn thử nghiên cứu xem nhé!
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;%
Dim tBytes
Dim binData
Dim Dict
Dim fileName
Dim fso
Dim fsoFile
Dim binaryFileContent
Dim i
tBytes = Request.TotalBytes
binData = Request.BinaryRead&#40;tBytes&#41;
Set Dict = BuildUploadRequest&#40;binData&#41;
fileName = Dict.Item&#40;"fName"&#41;.Item&#40;"FileName"&#41;
binaryFileContent = Dict.Item&#40;"fName"&#41;.Item&#40;"Value"&#41;
fileName = ParseFileFromPath&#40;fileName&#41;
fname=filename
fileName = Server.MapPath&#40;"/"&#41; & "\photos\" & fileName
'fileName = "C:\Article\" & fileName

'==constructing the filepath of the root on server 
Set fso = Server.CreateObject&#40;"Scripting.FileSystemObject"&#41;
Set fsoFile = fso.CreateTextFile&#40;fileName, True&#41;
For i = 1 To LenB&#40;binaryFileContent&#41;
	fsoFile.Write Chr&#40;AscB&#40;MidB&#40;binaryFileContent, i, 1&#41;&#41;&#41;
Next 
fsoFile.Close
Set fso = Nothing

'-------------------------------------------------------------------
Function getString&#40;StringBin&#41;
	getString =""
	For intCount = 1 To LenB&#40;StringBin&#41;
		getString = getString & chr&#40;AscB&#40;MidB&#40;StringBin,intCount,1&#41;&#41;&#41; 
	Next
End Function

'-------------------------------------------------------------------
Function getByteString&#40;StringStr&#41;
	For i = 1 To Len&#40;StringStr&#41;
		char = Mid&#40;StringStr, i, 1&#41;
		getByteString = getByteString & chrB&#40;AscB&#40;char&#41;&#41;
	Next
End Function

'-------------------------------------------------------------------
Function BuildUploadRequest&#40;RequestBin&#41;
	Dim scrDict
	Set scrDict = Server.CreateObject&#40;"Scripting.Dictionary"&#41;
	PosBeg = 1
	PosEnd = InstrB&#40;PosBeg,RequestBin,getByteString&#40;chr&#40;13&#41;&#41;&#41;
	boundary = MidB&#40;RequestBin,PosBeg,PosEnd-PosBeg&#41;
	boundaryPos = InstrB&#40;1,RequestBin,boundary&#41;
	Do until &#40;boundaryPos=InstrB&#40;RequestBin,boundary & getByteString&#40;"--"&#41;&#41;&#41;
		Dim UploadControl
		Set UploadControl = CreateObject&#40;"Scripting.Dictionary"&#41;
		Pos = InstrB&#40;BoundaryPos,RequestBin, getByteString&#40;"Content-Disposition"&#41;&#41;
		Pos = InstrB&#40;Pos,RequestBin,getByteString&#40;"name="&#41;&#41;
		PosBeg = Pos+6
		PosEnd = InstrB&#40;PosBeg,RequestBin,getByteString&#40;chr&#40;34&#41;&#41;&#41;
		Name = getString&#40;MidB&#40;RequestBin,PosBeg,PosEnd-PosBeg&#41;&#41;
		PosFile=InstrB&#40;BoundaryPos,RequestBin,getByteString&#40;"filename="&#41;&#41;
		PosBound = InstrB&#40;PosEnd,RequestBin,boundary&#41;
		If PosFile&lt;&gt;0 AND &#40;PosFile&lt;PosBound&#41; Then
			PosBeg = PosFile + 10
			PosEnd = InstrB&#40;PosBeg,RequestBin,getByteString&#40;chr&#40;34&#41;&#41;&#41;
			FileName = getString&#40;MidB&#40;RequestBin,PosBeg,PosEnd-PosBeg&#41;&#41;
			UploadControl.Add "FileName", FileName
			Pos = InstrB&#40;PosEnd,RequestBin,getByteString&#40;"Content-Type:"&#41;&#41;
			PosBeg = Pos+14
			PosEnd = InstrB&#40;PosBeg,RequestBin,getByteString&#40;chr&#40;13&#41;&#41;&#41;
			ContentType = getString&#40;MidB&#40;RequestBin,PosBeg,PosEnd-PosBeg&#41;&#41;
			UploadControl.Add "ContentType",ContentType
			PosBeg = PosEnd+4
			PosEnd = InstrB&#40;PosBeg,RequestBin,boundary&#41;-2
			Value = MidB&#40;RequestBin,PosBeg,PosEnd-PosBeg&#41;
		Else
			Pos = InstrB&#40;Pos,RequestBin,getByteString&#40;chr&#40;13&#41;&#41;&#41;
			PosBeg = Pos+4
			PosEnd = InstrB&#40;PosBeg,RequestBin,boundary&#41;-2
			Value = getString&#40;MidB&#40;RequestBin,PosBeg,PosEnd-PosBeg&#41;&#41;
		End If
		UploadControl.Add "Value" , Value
		scrDict.Add Name, UploadControl
	BoundaryPos=InstrB&#40;BoundaryPos+LenB&#40;boundary&#41;,RequestBin,boundary&#41;
	Loop
	
	Set BuildUploadRequest = scrDict
	Set scrDict = Nothing
End Function

'-------------------------------------------------------------------
Function ParseFileFromPath&#40;iStr&#41;
	Dim tPos
	tPos = InStrRev&#40;iStr, "\"&#41;
	If tPos = 0 Or IsNull&#40;tPos&#41; Then
		ParseFileFromPath = iStr
		Exit Function
	End If
	ParseFileFromPath = Right&#40;iStr, Len&#40;iStr&#41; - tPos&#41;
End Function

%&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;title&gt;Upload Picture&lt;/title&gt;
&lt;STYLE type="text/css"&gt; 
&lt;!--
.link1 {text-decoration: none;}
A:hover {color : Red;}
BODY {font-family:Arial; font-size:10pt;}
TABLE {font-family:Arial; font-size:10pt;}
 --&gt;
&lt;/STYLE&gt;
&lt;/HEAD&gt;

&lt;BODY&gt;
&lt;br&gt;&lt;br&gt;&lt;center&gt;
&lt;b&gt;&lt;a href="../photos/&lt;%=fname%&gt;"&gt;
&lt;%=fname%&gt;&lt;/a&gt;&lt;/b&gt; 
has been uploaded successfully...&lt;br&gt;&lt;br&gt;
Thank you for using our service.
&lt;/center&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11228.hva#66555</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11228.hva#66555</link>
				<pubDate><![CDATA[Sat, 23 Jun 2007 19:00:02]]> GMT</pubDate>
				<author><![CDATA[ theson267]]></author>
			</item>
			<item>
				<title>Làm ơn giúp em cách tạo folder + uploadfile bằng ASP 3.0!</title>
				<description><![CDATA[ cảm ơn bạn đã giúp!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/11228.hva#67025</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/11228.hva#67025</link>
				<pubDate><![CDATA[Mon, 25 Jun 2007 22:44:48]]> GMT</pubDate>
				<author><![CDATA[ gulic]]></author>
			</item>
	</channel>
</rss>
