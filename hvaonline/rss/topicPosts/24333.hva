<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title><![CDATA[Latest posts for the topic "05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )"]]></title>
		<link>http://www.hvaonline.net/hvaonline/posts/list/13.hva</link>
		<description><![CDATA[Latest messages posted in the topic "05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )"]]></description>
		<generator>JForum - http://www.jforum.net</generator>
			<item>
				<title>05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ 1. Vào địa chỉ : target.com/index.php?option=com_user&view=reset&layout=confir m

2. Nhập kí tự ' vào.

3. Xong thì nhập password mới

4. Vào admin : target.com/administrator/

5. Đăng nhập với password mới đó với user là admin.



Sưu Tầm :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146941</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146941</link>
				<pubDate><![CDATA[Thu, 14 Aug 2008 19:55:44]]> GMT</pubDate>
				<author><![CDATA[ LM]]></author>
			</item>
			<item>
				<title>05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">LM wrote:</cite><br>
		<blockquote>1. Vào địa chỉ : target.com/index.php?option=com_user&view=reset&layout=confir m

2. Nhập kí tự ' vào.

3. Xong thì nhập password mới

4. Vào admin : target.com/administrator/

5. Đăng nhập với password mới đó với user là admin.



Sưu Tầm :)&nbsp;
		</blockquote>

Mèn ơi ! Mấy site chưa fix lỗi bị "hác-cơ" oanh tạc te tua !!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146947</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146947</link>
				<pubDate><![CDATA[Thu, 14 Aug 2008 20:37:02]]> GMT</pubDate>
				<author><![CDATA[ TheShinichi]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Bác LM có thể viết 1 bài phân tích được ko nhỉ? :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146952</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146952</link>
				<pubDate><![CDATA[Thu, 14 Aug 2008 21:34:04]]> GMT</pubDate>
				<author><![CDATA[ anhsuytu]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ <span class="link"> http://developer.joomla.org/security/news/241-20080801-core-password-remind-functionality.html</span>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146981</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146981</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 00:05:38]]> GMT</pubDate>
				<author><![CDATA[ AIO]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Phân tích lỗi xem tại :
http://milw0rm.com/exploits/6234]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146983</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#146983</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 00:11:32]]> GMT</pubDate>
				<author><![CDATA[ canh_nguyen]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Tại thời điểm này hình như người ta fix hết rồi . Em chỉ tìm thấy 1 ,2 trang bị mắc lỗi này thôi]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147032</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147032</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 11:21:12]]> GMT</pubDate>
				<author><![CDATA[ mr.khungxox]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Bác nào phân lại từng bước+ giải thích rõ được ko, em đọc trên milw0rm chẳng hiều gì. Thanks :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147033</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147033</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 11:34:28]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ bác gamma95 được cái thích đùa :D, hix, anh em lại có dịp "mò" nữa rùi, kiểu này có khối anh bị thương, r57 có cơ hội oanh tạc :D]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147044</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147044</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 13:02:21]]> GMT</pubDate>
				<author><![CDATA[ hoahongtim]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Bản chất của lỗi này thật ra cũng là SQL Ịnection!
<span class="link"> http://hkp.com.vn/index.php?option=com_user&view=reset&layout=confirm</span>
dòng này được tạo ra khi điền email để forgot pasword và 1 Token đã gửi về mail, form này dùng để điền Token đó!
Tuy nhiên lại phát sinh lỗi ở dòng:
 <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$db-&gt;setQuery&#40;'SELECT id FROM #__users WHERE block = 0 AND activation = '.$db-&gt;Quote&#40;$token&#41;&#41;;  &lt;</pre>
		</div>
nhiệm vụ của nó là liệt kê ra user có activation = cái token vừa nhập vào và cho phép đổi password mới. Vì vậy khi ta chèn kí tự ' vào thì lệnh nó sẽ trở thành:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>SELECT id FROM jos_users WHERE block = 0 AND activation = ''</pre>
		</div>
nó lại đi liệt kê ra các user có activation là rỗng thay vì là user có activation phù hợp và theo nguyên tắc chỉ lấy 1 kết quả, nó sẽ lấy user có id nhỏ nhất và thường thì đó là tài khoản của admin! vì vậy dẫn tới việc password của admin bị reset!
Cách khắc phục:
- Nâng cấp phiên bản Joomla! mới nhất (1.5.6 hoặc mới hơn), hoặc sửa lỗi trong file /components/com_user/models/reset.php với đoạn mã sau:

Sau global $mainframe; trên dòng 113 của file reset.php, thêm:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>if&#40;strlen&#40;$token&#41; != 32&#41; {

       {

              $this-&gt;setError&#40;JText::_&#40;'INVALID_TOKEN'&#41;&#41;;

              return false;

       }</pre>
		</div>]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147059</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147059</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 13:53:51]]> GMT</pubDate>
				<author><![CDATA[ hackerbinhphuoc]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ uhm.. :D Kiểu như SQL Injection by pass vậy ! 
fix lỗi trên, theo mình nghĩ đơn giãn... :
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$db-&gt;setQuery&#40;"SELECT id FROM #__users WHERE block = 0 AND activation =".$db-&gt;Quote&#40;$token&#41;."'"&#41;;</pre>
		</div>

là đủ rùi ! Mà nếu là sql injection thì sao ko thử : 

SELECT id FROM jos_users WHERE block = 0 AND activation = '' union select xxx from jos_uers where activation='' 

liệu có được ko nhĩ ?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147060</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147060</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 14:02:21]]> GMT</pubDate>
				<author><![CDATA[ flier_vn]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ hix tìm trên google thử mà đa số nâng cấp hết rùi còn lại bị hack hết tìm 1 site thực hành hơi khó]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147077</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147077</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 15:39:16]]> GMT</pubDate>
				<author><![CDATA[ ken_shin]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Không phòng thủ kịp nên bị đánh te tua, cũng may là có backup ở host khác....
Hình như là joomla.org cũng bị đánh...
Bản 1.5.6 vừa mới fix lỗi này xong.]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147078</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147078</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 15:48:03]]> GMT</pubDate>
				<author><![CDATA[ louisnguyen27]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">hackerbinhphuoc wrote:</cite><br>
		<blockquote><font color='yellow'>Bản chất của lỗi này thật ra cũng là SQL Ịnection!</font>
..................
- Nâng cấp phiên bản Joomla! mới nhất (1.5.6 hoặc mới hơn), hoặc sửa lỗi trong file /components/com_user/models/reset.php với đoạn mã sau:

Sau global $mainframe; trên dòng 113 của file reset.php, thêm:
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>if&#40;strlen&#40;$token&#41; != 32&#41; {

       {

              $this-&gt;setError&#40;JText::_&#40;'INVALID_TOKEN'&#41;&#41;;

              return false;

       }</pre>
		</div>&nbsp;
		</blockquote>
Bản chất là SQL injection mà dùng hàm <font color='yellow'>strlen</font> để fix là sao nhể ?  :D, nó ráng inject sao đó cho strlen($input_token)=32 thì ....  :^) ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147085</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147085</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 16:29:25]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Mình mới test, vẫn còn nhiều trang bị mà :)]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147108</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147108</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 17:58:00]]> GMT</pubDate>
				<author><![CDATA[ anhsuytu]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ Bác nào nhận xét bug này bản chất là SQL injection là hoàn toàn sai. Ngay cả exploit trên milw0rm<span class="link"> http://milw0rm.com/exploits/6234</span> , người publish khi phân tích cũng ko hiểu rõ vấn đề :D
Các bác có để ý là thằng Joomla nó fixed kiểu
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>if&#40;strlen&#40;$token&#41; != 32&#41; {
 
        
               $this-&gt;setError&#40;JText::_&#40;'INVALID_TOKEN'&#41;&#41;;
 
               return false;
 
        }</pre>
		</div>
nghĩa là nó chỉ check chiều dài thôi ko?? Nếu bị SQL injection thì nó đâu có fixed kiểu stup!d như thế  :D 
<font color='yellow'>*Update</font>: Các bác "hắc cờ" nào đi test mấy site chưa fixed sẽ thấy ko nhất thiết phải thêm nháy đơn vào mới khai thác được, mà chỉ cần input kí tự có dạng meta là được:
vídu:
<font color='yellow'>!@#$%^&*()</font> .....
Hoặc tổ hợp một chuỗi các kí tự meta một lúc.
Thế nên cái cách giải thích của thằng đã publish exploit trên milw0rm
<span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>{1} - Replace ' with empty char
{3} - If you enter ' in token field then query will be looks like : "SELECT id FROM jos_users WHERE block = 0 AND activation = '' "</pre>
		</div>
là rất mơ hồ, vì nó cũng ko hiểu vấn đề.
PS: Các bác debug biến $token bằng cách
<blockquote>if(strlen($token) != 32) {
 
        {
<font color='yellow'>echo $token;//tui thêm vào
exit(1);//tui thêm vào</font>
 
               $this-&gt;setError(JText::_('INVALID_TOKEN'));
 
               return false;
 
        }
&nbsp;
		</blockquote>
chạy vào test thử với các input là các kí tự meta, meta trộn lẫn chuỗi thường ...etc sẽ hiểu
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147121</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147121</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 19:50:52]]> GMT</pubDate>
				<author><![CDATA[ gamma95]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ hehe nhờ anh gamma95 giải thích em mới hiểu! lúc đầu khi chưa biết về cái token thì em là SQL  Injection nhưng sau xem lại thì đúng là ko phải thật!]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147125</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147125</link>
				<pubDate><![CDATA[Fri, 15 Aug 2008 20:22:13]]> GMT</pubDate>
				<author><![CDATA[ hackerbinhphuoc]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ có phải cái chỗ $token = JRequest::getVar('token', null, 'post', 'alnum'); là thay tất cả các ký tự đặc biệt bằng ký tự trắng không.
Nếu vậy thì mình kiểm tra strlen($token)==0 cũng được nhỉ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147730</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#147730</link>
				<pubDate><![CDATA[Tue, 19 Aug 2008 13:40:00]]> GMT</pubDate>
				<author><![CDATA[ mt37vn]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ hay quá, em fix ngay
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#148043</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#148043</link>
				<pubDate><![CDATA[Thu, 21 Aug 2008 12:12:36]]> GMT</pubDate>
				<author><![CDATA[ haian82]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ cái này chỉ dành cho J nào cho đăng ký mem phải không ạ? Nếu site đóng chỉ để cung cấp thông tin thì em vào nó chỉ nói

Chào mừng!
Chào mừng bạn tới khu vực người dùng trên site của chúng tôi ]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#154959</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#154959</link>
				<pubDate><![CDATA[Sun, 12 Oct 2008 04:46:49]]> GMT</pubDate>
				<author><![CDATA[ alexnguyen]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">alexnguyen wrote:</cite><br>
		<blockquote>cái này chỉ dành cho J nào cho đăng ký mem phải không ạ? Nếu site đóng chỉ để cung cấp thông tin thì em vào nó chỉ nói

Chào mừng!
Chào mừng bạn tới khu vực người dùng trên site của chúng tôi &nbsp;
		</blockquote>
Đọc kỹ các bài viết và đường dẫn ở trên. Người ta đã fixx hết rồi đừng cố gắng xâm nhập làm gì.
]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#155056</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#155056</link>
				<pubDate><![CDATA[Mon, 13 Oct 2008 10:32:21]]> GMT</pubDate>
				<author><![CDATA[ louisnguyen27]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ nhìu site vẫn bị đó chứ.
Nhưng cho em hỏi, reset pass xong rồi. Lỡ user admin của nó ko phải là admin thì sao nhỉ ?]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#168868</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#168868</link>
				<pubDate><![CDATA[Mon, 9 Feb 2009 15:11:28]]> GMT</pubDate>
				<author><![CDATA[ lequi]]></author>
			</item>
			<item>
				<title>Re: 05 Bước khai thác Joomla 1.5.x (Remote Admin Password Change )</title>
				<description><![CDATA[ <p></p>
		<cite class="blockquote">lequi wrote:</cite><br>
		<blockquote>nhìu site vẫn bị đó chứ.
Nhưng cho em hỏi, reset pass xong rồi. Lỡ user admin của nó ko phải là admin thì sao nhỉ ?&nbsp;
		</blockquote>
Thì đi tìm tên user admin là cái gì???]]></description>
				<guid isPermaLink="true">http://www.hvaonline.net/hvaonline/posts/list/24333.hva#168871</guid>
				<link>http://www.hvaonline.net/hvaonline/posts/list/24333.hva#168871</link>
				<pubDate><![CDATA[Mon, 9 Feb 2009 15:46:12]]> GMT</pubDate>
				<author><![CDATA[ louisnguyen27]]></author>
			</item>
	</channel>
</rss>
