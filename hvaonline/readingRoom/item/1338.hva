<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="http://www.hvaonline.net" title="[Logo]"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Defense::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 NetBIOS hacking và cách phòng chống - 1 <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/482.hva#1338" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: Nguyễn Xuân Việt (Phuongdong) - Translator:  - Entry Date: 10/02/2009 09:34:47" title="Author: Nguyễn Xuân Việt (Phuongdong) - Translator:  - Entry Date: 10/02/2009 09:34:47"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody"><font color='yellow'><b>Mở đầu</b></font><br/> Thấy các bạn Newbie hỏi về các lệnh net ... và về IPC$, SAM nên mình viết bài này để share một số thông tin rất cơ bản cho các bạn còn chưa rõ cách sử dụng nó<br/> <br/> NetBIOS là viết tắt của chữ Network Basic Input Output System. Đầu tiên nó được IBM và Sytek xây dựng để truy nhập vào các tài nguyên được chia sẻ trong mạng LAN ( Local Area Network ). Tài nguyên trong mạng có thể là ổ đĩa, máy in , máy scan ....<br/> <br/> Nếu bạn đã từng làm việc trong các mạng LAN và sử dụng hệ điều hành Windows ( windows9.x , me, 2000, XP .... ) thì bạn đã từng bấm đúp chuột vào biểu tượng Network Neghborhood ( hay My Network Places ) để truy nhập tới các may tính khác trong mạng =&gt; đó chính là bạn đã sử dụng một số lệnh của NetBIOS trong môi trường Winđows.<br/> <br/> Mỗi mỗi service trong máy đều làm việc trên một cổng nào đó, NetBIOS cũng được gán cho một số cổng tùy theo bạn đang sử dụng HDH nào.<br/> <br/> <blockquote> - TCP 135 RPC/DCE Endpoint mapper<br/>  - UDP 137 NetBIOS Name Service<br/>  - UDP 138 NetBIOS Datagram Service<br/>  - TCP 139 NetBIOS Sesion Service ( SMB/CIFS over NetBIOS<br/>  - TCP/UDP 445 Direct Host&nbsp;<br/> 		</blockquote><br/> ( SMB - Server Mesage Block)<br/> CIFS - Common Internet File System )<br/> <br/> Mặc định thì Windows 9.x ( 95,98,98se ), NT4 và Windows2000 sẽ lắng nghe trên cổng 139, nhưng Windows 9.x không lắng nghe trên cổng TCP/UDP 135 ( =&gt; chính vì điều này mà đợt vừa qua khi phát hiện ra lỗi RPC , Virus Blaster không gây ảnh hưởng gì cho các máy tính đang chạy Windows 9.x ) Windows 2000 và XP cũng lắng nghe trên các cổng TCP/UDP 445<br/> =&gt; Dựa vào các hiểu biết này và các lệnh của Windows ( các lệnh này thường nằm trong <font color='yellow'>C:\Windows\system32</font> - hoặc <font color='yellow'>WinNT\system32</font> ) người ta có thể truy nhập vào các máy tinh khác trong mạng<br/> <br/> <font color='yellow'><b>Tìm kiếm IP của victim</b></font><br/> <br/> <b>Nhắc lại một tý về IP: </b><br/> IP là một số xác định được gán cho mỗi máy tính trong một mạng nào đó.<br/> IP được biểu diễn là một số 32 bit, các bit đựơc chia thành 4 phần mỗi phần 8 bit ( 1 byte ). Có 3 cách để biểu diễn cho một địa chỉ IP:<br/>  - Dạng thập phân ( dạng hay dùng nhất ) Ví dụ : 130.57.30.56<br/>  - Dạng nhị phân : 10000010.00111001.00011110.00111000<br/>  - Dạng Hexadecimal 82 39 1E 38<br/> <br/> Trong mỗi địa chỉ IP bao giờ cũng có hai phần là địa chỉ mạng ( Networrk Address ) và địa chỉ máy ( Node Address ). Các máy tính trong một mạng bao giờ cũng có cùng một địa chỉ mạng<br/> ( Các bạn có thể tìm thấy bài viết chi tiết về địa chỉ IP trên HVA portal )<br/> <br/> Để biết địa chỉ IP của mình bạn có thể dùng lệnh trong windows để xem :<br/> <br/> <b>1- Nếu bạn đang dùng Windows 9,x :</b><br/> Bấm vào Start \ run sau đó đánh vào lệnh command rồi bấm OK ( Để chạy ra màn hình DOS - DOS shell )<br/> Tại dấu nhắc của lệnh DOS đánh vào lệnh <b>IPCONFIG </b>( hoặc <b>IPCONFIG / ALL</b> )<br/> Nếu bạn dùng Win98 có thể sử dụng Start \run rồi đánh vào lệnh <b>WINIPCFG </b>cũng cho kết quả tương tự<br/> <br/> <b>2- Nếu bạn dùng Win2000, XP ...</b><br/> Bấm vào Start \ run sau đó đánh vào lệnh cmd rồi bấm OK ( Để chạy ra màn hình DOS - DOS shell )<br/> Tại dấu nhắc của lệnh DOS đánh vào lệnh IPCONFIG ( hoặc IPCONFIG / ALL )<br/> Bạn chú ý nhìn dòng IP Address rồi nhìn sang bên phải thấy một số có dạng xxxx.xxxx.xxx.xxx &lt;= đó chính là địa chỉ IP của bạn khi bạn vào mạng<br/> <br/> Công việc tìm kiếm IP và xem nó có mở cổng không của victim thường mất rất nhiều thời gian - Người ta có thể dùng một số Tool để thực hiện việc tìm kiếm cho nhanh ( và đỡ tốn tiền Net ) như NetScanPro2000, hay Esential NetTools ( ET3 ), IP Tool ...<br/> (Bài hướng dẫn về cách sử dụng và nơi Download cũng có trên 4rum - Các bạn có thể vào mục đồ nghề để tìm)<br/> <br/> Nếu bạn đang sử dụng ICQ để chát với victim bạn có thể sử dụng lệnh netstat -n ( lệnh này sẽ cho ta biết các kết nối đựơc thiết lập giữa máy của ta và bên ngoài và qua các cổng nào ) để biết IP của victim.<br/> <b>Ví dụ</b>: sau khi chạy lệnh <b>netstat -n</b> ta sẽ nhận đựơc bảng sau :<br/> <br/> <blockquote>Active Connections<br/> Proto Local Address Foreign Address State<br/> TCP 192.168.0.1:3537 203.195.136.156:2869 Established<br/> .......................................................................................&nbsp;<br/> 		</blockquote><br/> <br/> Bạn chú ý nhìn ở dưới dòng chữ Foreign Address số 203.195.136.156 &lt;= Đó là địa chỉ IP của victim, còn số 2869 chính là cổng kết nối.<br/> <br/> Chữ Established =&gt; báo cho bạn biết một kết nối đã được thiết lập giữa máy tính của bạn và victim.<br/> <br/> Còn nếu bạn sử dụng MSN hay YH, nếu sử dụng lệnh netstat - n có thể bạn không nhìn thấy IP của victim mà có thể là địa chỉ của Server của MSN hay YH.<br/> <br/> Để xác định chính xác bạn có thể sử dụng Send File của YH để gửi một file tới victim. Trước khi Send File, sử dụng lệnh netstat -n để xác định các kết nối đã có. <br/> <br/> Trong khi đang Send file bạn lại sử dụng lệnh <b>netstat -n </b> sau đó tìm địa chỉ IP nào mà mới được thiết lập =&gt; đó chình là dịa chỉ IP của Victim ( vì khi Send file nó se thiết lập một kết nối trực tiếp giữa máy bạn và victim )<br/> <br/> Sau khi đã có địa chỉ IP của victim bạn sử dụng lênh <b>nbtstat -a ipAddress</b> ( lệnh này dùng để xác đinh một số thông tin trên máy victim ... )<br/> <b>Ví dụ</b> : <b>C:\&gt; nbtstat - a 203.210.136.23</b> <br/> ( &lt;= Đây là địa chỉ mô phỏng thôi đấy nhé - đừng thử greenbiggrin.gif )<br/> <br/> Bạn có thể nhận được các dòng như sau<br/> <br/> <blockquote>NetBIOS remote Machine Name Table<br/> Name Type Status<br/> may1 &lt;00&gt; Unique Registered<br/> netde&lt;00&gt; Group Registered<br/> may1 &lt;03&gt; Unique Registered<br/> may1 &lt;20&gt; Unique Registered<br/> ...............................<br/> MAC address 00-32-04-14-23-E6&nbsp;<br/> 		</blockquote><br/> <br/> <br/> Ở đây bạn chú ý đến số <b>&lt;20&gt;</b> =&gt; Nếu thấy số này có nghĩa là máy victim đã bật chế độ chia sẻ File và máy in ( File And Printer Sharing )<br/> Tiếp theo ta sử dụng lệnh <b>net view \\ipaddress</b> ( lệnh này dùng để xem máy vic tim chia sẻ những cái gì để còn .... )<br/> <br/> Ví dụ : <b>C:&gt; net view \\203.210.136.23</b><br/> Bạn có thể thấy các dòng tương tự như ở dưới đây :<br/> <br/> <blockquote>Shared resource at \\203.210.136.23<br/> Share name Type User As Comment<br/> C Disk<br/> D Disk<br/> IPC$ Disk<br/> .........................................................................<br/> The command complete succesfully&nbsp;<br/> 		</blockquote><br/> <br/> =D&gt; Đến đây bạn vào tìm file LMHost - nếu không có thì tạo ra ( Nếu bạn sử dụng window98 thì nó nằm ngay trong thư mục windows, nếu là XP thì trong thư mục <font color='yellow'>Windows\System32\Drivers \etc</font> còn Win2000 thì nằm trong <font color='yellow'>WinNT\System32\Drivers\etc</font> )<br/> <br/> <b>Lạm bàn về LMHost</b> : Ngày trước tên máy và địa chỉ IP được lưu vào trong đó - Nó được dùng để phân giải tên máy và địa chỉ IP ( Name - to - Address )<br/> <br/> File này được cập nhật và quản lý bởi SRI - NIC ( Standford Research Institute Network Information Center ), vài tuần một lần tổ chức này lại cập nhật lại nội dung File này.<br/> <br/> Ngày trước các Admin của mạng thường Download về Server của mình. Dần dần số lượng của các trang Web trên Net ngày càng nhiều =&gt; cách sử dụng này trở nên thiếu hiệu quả và mất thời gian =&gt; DNS ra đời ...<br/> ( Cũng có bài viết chi tiết về DNS trên HVA portal ).<br/> <br/> Sau đó bạn thêm vào trong File này theo cú pháp sau :<br/> <b>ipAddressvictim tênmáy #PRE</b><br/> <br/> Ví dụ ở đây tôi thêm vào dòng : <b>203.210.136.23 MAY1 #PRE</b> trong File LMHost, rồi chạy lệnh <b>nbtstat -R</b> để nạp lại table cache.<br/> <br/> Bây giờ bạn có thể tạo thêm một ổ trên máy tính của mình và kết nối tới ở hay thư mục được Share trên máy tính của victim bằng cách sử dụng lênh <b>Net use</b><br/> <br/> <b>Net use Tên_ổ_đĩa : \\ipAddressVictim\shareName</b><br/> <br/> Ví dụ : <b>Net use X: \\203.210.136.23\C</b><br/> <br/> Nếu thấy dòng lệnh<br/> <blockquote>The command was complete succesfully&nbsp;<br/> 		</blockquote><br/> <br/> <br/> Done, bấm đúp vào My Computer và xem thử xem có gì mới trong máy tính của ta không.<br/> <br/> Để tránh nhầm lẫn khi ánh xạ ổ đĩa ta có thể sử dụng ký hiệu * thay cho tên ổ đĩa:<br/> <br/> <b>net use * \\203.210.136.23\C</b><br/> <br/> Thế nhưng nhiều khi cuộc đời không đẹp như mơ vì khi thực hiện đường truyền của bạn chậm hay vì máy victim đặt pass truy nhập. ...<br/> <br/> Nếu máy victim sử dụng Windows95,98,98se hay Win me bạn có thể tạm dùng pass : PQWAK ( cái này giống như kiểu concat trên các Main đời cũ <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">)<br/> <br/> Thế thì còn máy tính dùng 2000 hay XP ... mà đặt pass và user thì làm thế nào =&gt; ta có thể xây dựng một từ điển để dò và sử dụng lệnh For của DOS để thực hiện.<br/> <br/> Ví dụ tôi sẽ tạo ra một File có tên là DoPass.txt và có định dạng sau :<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>password username<br/> password Administrator<br/> "" Administrator<br/> admin Administrator<br/> ............................................................</pre><br/> 		</div><br/> <br/> Và bấy giờ ta có thể sử dụng lệnh <b>For</b><br/> <br/> <b>C:\FOR /F "token=1,2* " %i in (DoPass.txt ) Do net use \\IpAddressvictim\ShareName</b><br/> <br/> ( cú pháp sử dụng của lệnh FOR xin các bạn xem trong help của Windows )<br/> &lt;còn tiếp&gt;<br/> <font color='yellow'><b>Tác giả: phuongdong</b></font></div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/readingRoom/item/1338.hva"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/readingRoom/item/1338.hva"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/readingRoom/item/1338.hva"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/readingRoom/item/1338.hva"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/readingRoom/item/1338.hva"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/1338.hva"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/1338.hva"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>

		<tr>
			<td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
						<div class="postbody"><b>Other posts in the same group:</b></div><br />
									<div class="gen"><b>NetBIOS hacking và cách phòng chống - 1</b></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1343.hva">NetBIOS hacking và cách phòng chống  - 2</a></div>
						</td>
					</tr>
				</table>
			</td>
		</tr>


		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/482.hva#1338" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.hva'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
