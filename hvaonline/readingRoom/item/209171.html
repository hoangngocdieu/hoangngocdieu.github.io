<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="http://www.hvaonline.net" title="[Logo]"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Windows::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Ứng dụng tự động hoá quá trình cài đặt phần mềm với các hàm API <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/34037.html#209171" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: FaL - Translator:  - Entry Date: 16/04/2010 11:08:01" title="Author: FaL - Translator:  - Entry Date: 16/04/2010 11:08:01"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody">Vừa qua FaL có viết ứng dụng nhỏ này, bài viết này không hướng dẫn cụ thể từng bước phát triển chương trình, cũng không có code toàn bộ chương trình, chỉ xin trình bày một số ý chính và thao tác cần thiết tương ứng.<br/> <br/> Trong hệ thống máy tính với nhiều máy con, việc cài đặt và update phần mềm là một công việc vất vả. Tự động hóa quá trình cài đặt phần mềm giúp quản trị viên tiết kiệm thời gian, công sức của mình.<br/> Ý tưởng của ứng dụng:<br/> <ul><li>Phần 1: Ghi lại quá trình cài đặt bộ phần mềm cần thiết trên máy mẫu.</li><li> Phần 2: Tự động cài đặt bộ phần mềm mẫu lên các máy con khác.</li></ul><br/> <br/> <b><font color='yellow'>Phần 1:</font></b><br/> Có nhiều cách để ghi lại quá trình làm việc của máy tính, trong ứng dụng này người quản trị sẽ chủ động chọn lựa những thao tác cần ghi lại. Những thao tác này trên Windows sẽ là: Nhấp chuột, chọn/bỏ chọn checkbox/radiobuton, nhập Text vào TextBox… Phần 1 của ứng dụng sẽ cho phép người quản trị gửi “thông điệp” của mình tới trình cài đặt tương ứng.<br/> Để làm được điều này, trước hết từ ứng dụng cần xác định cửa sổ của trình cài đặt. Ở đây ta có thể liệt kê tất cả các cửa sổ trên Desktop với sự trợ giúp của hàm <font color='orange'>GetDesktopWindow</font>() và <font color='orange'>GetWindow</font>():<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>hwnd = GetDesktopWindow&#40;&#41;;<br/> hwnd = GetWindow&#40;hwnd, GW_CHILD&#41;;<br/> while&#40;hwnd!=0&#41;{<br/> 	 GetWindowTextW&#40;hwnd, Title, MAX_LENGTH&#41;;<br/> 	//ở đây chứa thao tác liệt kê tương ứng của bạn<br/> 	 hwnd = GetWindow&#40;hwnd, GW_HWNDNEXT&#41;;<br/> }</pre><br/> 		</div><br/> Sau khi người quản trị lựa chọn cửa sổ của trình cài đặt, ta sẽ liệt kê tất cả control của ứng dụng để thao tác. Các control cũng sẽ là các “cửa sổ” con của trình cài đặt, một hàm recursive sẽ giúp ta thực hiện điều này:<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>void GetChildHwnd&#40;HWND hInstaller&#41;{<br/> 			 HWND hwnd = GetWindow&#40;hInstaller, GW_CHILD&#41;;<br/> 			 if&#40;hwnd == NULL&#41;return;			 <br/> 			 wchar_t WindowTitle&#91;MAX_LENGTH&#93;;<br/> 			 GetWindowTextW&#40;hwnd, WindowTitle, MAX_LENGTH&#41;;<br/> 			 //ở đây chứa thao tác liệt kê tương ứng của bạn	<br/> 			 GetChildHwnd&#40;hwnd&#41;;<br/> 			 while&#40;hwnd!=0&#41;<br/> 			 {<br/> 				 hwnd = GetWindow&#40;hwnd, GW_HWNDNEXT&#41;;			 <br/> 				 if&#40;hwnd&#41;<br/> 				 {						 <br/> 					 wchar_t wtmp&#91;256&#93;;<br/> 					 GetWindowTextW&#40;hwnd, wtmp, 255&#41;;<br/> 					 //ở đây chứa thao tác liệt kê tương ứng của bạn <br/> 				 }<br/> 				 GetChildHwnd&#40;hwnd&#41;;<br/> 			 }<br/> 			 return; <br/> 		 }</pre><br/> 		</div><br/> Sau khi xác định được các control, những thao tác tương ứng sẽ được thực hiện với các hàm API của Windows, ở đây là SendMessage() và PostMessage(). Tôi không liệt kê tất cả các thao tác có thể, mà chỉ là các thao tác thường thấy:<br/> <b>Nhấp chuột:</b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>PostMessageW&#40;hwnd, WM_LBUTTONDOWN, 0, 0&#41;;	<br/> PostMessageW&#40;hwnd, WM_LBUTTONUP, 0, 0&#41;;</pre><br/> 		</div><br/> <b>Check box:</b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>SendDlgItemMessageW&#40;GetParent&#40;hwnd&#41;, GetDlgCtrlID&#40;hwnd&#41;,BM_SETCHECK, BST_CHECKED,0&#41;;</pre><br/> 		</div><br/> <b>Uncheck box:</b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>SendDlgItemMessageW&#40;GetParent&#40;hwnd&#41;, GetDlgCtrlID&#40;hwnd&#41;, BM_SETCHECK, BST_UNCHECKED, 0&#41;;</pre><br/> 		</div><br/> <b>Check radiobutton</b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>SendMessageW&#40;hwnd, BM_CLICK, 0, 0&#41;;</pre><br/> 		</div><br/> <b>Nhập Text vào TextBox:</b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>SendMessageW&#40;hwnd, WM_SETTEXT, 10, &#40;LPARAM&#41;text&#41;;</pre><br/> 		</div><br/> Ở đây hwnd là handle của control nhận thông điệp.<br/> Quá trình thao tác này sẽ được ghi lại vào file hoặc CSDL phù hợp với bạn. Ở đây tôi sử dụng INI file vì sự tiện dụng và portale của nó. Một bộ phần mềm sẽ được ghi lại bằng 1 project file chứa thông tin chung: Số lượng phần mềm cần cài đặt, file cấu hình cài đặt của từng phần mềm,… File cấu hình cài đặt của từng phần mềm sẽ bao gồm các thao tác: Làm việc với control nào, thao tác gì, thông số phụ… Làm việc với file INI có 2 hàm cơ bản: <font color='orange'>WritePrivateProfileString</font>() và <font color='orange'>GetPrivateProfileString</font>().<br/> <b><font color='yellow'>Phần 2:</font></b><br/> Thật ra phần 2 chỉ là lặp lại quá trình ở phần 1 một cách tự động mà không cần sự tác động của quản trị viên. Ứng dụng sẽ tự động chạy các bộ cài đặt, gửi các thông điệp tương ứng đến các cửa sổ cần thiết.<br/> <br/> Ghi chú:<br/> <ul><li>Tham khảo msdn để có thông tin cụ thể hơn về các hàm sử dụng</li></ul></div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/readingRoom/item/209171.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/readingRoom/item/209171.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/readingRoom/item/209171.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/readingRoom/item/209171.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/readingRoom/item/209171.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/209171.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/209171.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>

		<tr>
			<td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
						<div class="postbody"><b>Other posts in the same group:</b></div><br />
									<div class="gen"><b>Ứng dụng tự động hoá quá trình cài đặt phần mềm với các hàm API</b></div>
						</td>
					</tr>
				</table>
			</td>
		</tr>


		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/34037.html#209171" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
