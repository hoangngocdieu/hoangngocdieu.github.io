<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="http://www.hvaonline.net" title="[Logo]"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Reverse Engineering::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 4 <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/18695.hva#111869" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: mfeng - Translator:  - Entry Date: 26/02/2009 11:33:37" title="Author: mfeng - Translator:  - Entry Date: 26/02/2009 11:33:37"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody"><font color='orange'><b>3.4. Case study 1: example1.exe</b></font><br/> <br/> Trong phần này, chúng ta sẽ thử nghiệm debug file example1.exe, chương trình có nội dung như sau:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/242fa8f6cab9caa61ce36caf506b01b0_92659.jpg' border="0"  /></div><br/> <br/> Tùy theo giá trị nhập vào, kết quả “Check key” sẽ hiện ra <font color='yellow'>“Correct” </font>hay <font color='yellow'>“Incorrect”</font>.<br/> Mục tiêu của Debug là tìm ra giá trị Key khi nhập vào tên User bất kỳ. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> <br/> <b><font color='white'>Bước 1: Khảo sát</font></b><br/> <br/> Chạy example1.exe trên máy ảo Windows Mobile, nhập vào:<br/> <b>User</b>: <font color='yellow'>mfeng-hvaonline</font><br/> <b>Key</b>: <font color='yellow'>123456789</font><br/> và tap <font color='yellow'>“Check Key”</font>, kết quả:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/03dc69b7072c5e1e7302c4fbb6a5616e_92659.jpg' border="0"  /></div><br/> <br/> <b><font color='white'>Bước 2: Dùng  IDA phân tích file example1.exe</font></b><br/> <br/> Sau khi mở file example1.exe bằng IDA, một cửa sổ hiện ra như ở hình bên dưới, hãy click OK.<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/9ec57d095d5791ca92af40ceb93e0f69_92659.jpg' border="0"  /></div><br/> <br/> Dùng tab String, tìm tới chuỗi <font color='red'>“Incorrect Key”</font>:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/a252948f834e171acee984541c8f329b_92659.jpg' border="0"  /></div><br/> <br/> Ta được:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/ea25b2e9824fddb9c2413b4890fe9791_92659.jpg' border="0"  /></div><br/> <br/> Ngược lên đoạn mã tham chiếu tới chuỗi này, ta sẽ ở đây:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/eef2dbdf6cc340a2ee6b25ddf4f2ff59_92659.jpg' border="0"  /></div><br/> <br/> và tiếp theo:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/8c2f50dde2e44979c21dff0ad7e7d077_92659.jpg' border="0"  /></div><br/> <br/> Chú ý tới đoạn code từ <font color='yellow'>0x0001183C </font>tới <font color='yellow'>0x00011848</font>, ta có thể suy ra đoạn mã kiểm tra dạng như sau:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>if &#40;sub_116F0&#40;&#41; == 0&#41;<br/> 	//Incorrect key<br/> else<br/> 	//Correct Key</pre><br/> 		</div><br/> Việc cần thiết bây giờ là đặt breakpoint tại <font color='yellow'>0x0001183C </font><img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> <br/> <b><font color='white'>Bước 3: Debug</font></b><br/> <br/> Menu <font color='yellow'>Debug -&gt; Process options</font>, đặt các thông số như sau:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/a6e922ec8f2aab17b12a5b89c3830332_92659.jpg' border="0"  /></div><br/> Sau đó click OK<br/> <br/> Đặt breakpoint tại <font color='yellow'>0x0001183C</font>:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/1ac4bf10a43a1e7046ca391a0a584712_92659.jpg' border="0"  /></div><br/> <br/> F9 để bắt đầu debug.<br/> <br/> Nhập User: <font color='yellow'>mfeng-hvaonline</font> & Key: <font color='yellow'>123456789</font>. Tap “Check Key”, IDA breaks tại vị trí sau:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/534653278c23927ed8836a94c15020d9_92659.jpg' border="0"  /></div><br/> <br/> Xem giá trị <font color='yellow'>R0 = 0x2404F954</font>, không thấy trỏ tới chuỗi ký tự đặc biệt nào. (Thực chất, R0 là con trỏ this).<br/> <br/> Xem giá trị <font color='yellow'>R1 = 0x00055EF0</font>:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/9efa30de02990baa829739581d396e72_92659.jpg' border="0"  /></div><br/> <br/> Và <font color='yellow'>R2 = 0x00055F30</font><br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/b60cccc176966a8d1df09994fdc99df4_92659.jpg' border="0"  /></div><br/> <br/> Trace vào bên trong hàm <font color='yellow'><b>sub_116F0</b></font>, đoạn code của hàm này như sau:<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/15f7c05003553187e970f44cdce55d20_92659.jpg' border="0"  /></div><br/> <br/> Tại <font color='yellow'>0x00011704</font>, hàm <font color='white'>wcslen </font>lấy độ dài chuỗi ký tự User: <font color='yellow'>mfeng-hvaonline</font>. Kết quả trả về là <font color='yellow'>R0 = 0x0000000F (15)</font>.<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/9f7fd1649770b431cd5f69de1dd0c4fd_92659.jpg' border="0"  /></div><br/> <br/> Tại <font color='yellow'>0x00011710</font>, độ dài user được so sánh với #4, nếu nhỏ hơn, <b><font color='yellow'>sub_116F0</font></b> trả về giá trị 0 tại 0x00011730.<br/> Tại <font color='yellow'>0x00011720</font>, so sánh hai chuỗi user và key, nếu giống nhau, <b><font color='yellow'>sub_116F0</font></b> trả về giá trị 1, còn lại trả về giá trị 0.<br/> Như vậy,  chỉ cần user & key giống hệt nhau, chương trình sẽ cho ra kết quả <font color='red'>“Correct”</font>.<br/> Tóm lại, đoạn debug vừa rồi cho ta thấy hoạt động của example1.exe ở cấp độ assembly, cho biết cách thức kiểm tra giữa User và Key để cho ra kết quả <font color='red'>“Correct” </font>hay <font color='red'>“Incorrect”</font>.<br/> <br/> <b><font color='orange'>3.5. Case study 2: example2.exe</font></b><br/> Trong case study này, các bạn hãy tự mình giải quyết cơ chế tìm key theo user. Khác với example1, case study này có đôi chút khó khăn hơn  <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"> <br/> <br/> <b><font color='red'>4. Kết luận</font></b><br/> Bài viết trên đã trình bày các nội dung cơ bản nhất để tiến hành reverse một chương trình trên Windows Mobile, đồng thời minh họa cách thức debug thông qua hai case study đơn giản nhất. Từ các kiến thức này, bạn đọc có thể hoàn toàn tự mình nghiên cứu reverse và phân tích các ứng dụng phức tạp hơn.<br/> <br/> <b><font color='red'>5. Greetings </font></b><br/> Greats thanks to all HVA and REA members.<br/> <br/> <font color='red'><b>6. Tài liệu tham khảo</b></font><br/> <br/> 1.	"Hacking Windows CE", Phrack Magazine, Volume 0x0b, Issue 0x3f, Phile #0x06 of 0x14<br/> 2.	http://www.ra.informatik.uni-stuttgart.de/~ghermanv/Lehre/SOC02/ARM_Presentation.pdf<br/> 3.	http://infocenter.arm.com/help/topic/com.arm.doc.qrc0001l/QRC0001_UAL.pdf<br/> ---<br/> Hết.</div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/readingRoom/item/111869.hva"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/readingRoom/item/111869.hva"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/readingRoom/item/111869.hva"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/readingRoom/item/111869.hva"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/readingRoom/item/111869.hva"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/111869.hva"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/111869.hva"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>

		<tr>
			<td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
						<div class="postbody"><b>Other posts in the same group:</b></div><br />
									<div class="gen"><a href="/hvaonline/readingRoom/item/111283.hva">Kiến thức cơ bản về Reverse Engineering trên Windows Mobile</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/111825.hva">Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 2</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/111866.hva">Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 3</a></div>
									<div class="gen"><b>Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 4</b></div>
						</td>
					</tr>
				</table>
			</td>
		</tr>


		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/18695.hva#111869" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.hva'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
