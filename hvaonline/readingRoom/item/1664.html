<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="http://www.hvaonline.net" title="[Logo]"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Others::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Lập trình an toàn với Ada - 8 <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/543.html#1664" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: NQL05 - Translator:  - Entry Date: 13/02/2009 11:07:54" title="Author: NQL05 - Translator:  - Entry Date: 13/02/2009 11:07:54"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody">Phần 2 của loạt bài tiếp cận lập trình đa luồng (multi-thread) và cái nhìn dưới con mắt Ada.<br/> <br/> <br/> <font color='orange'><font size='+1'><b>Mỗi con sông đều có nhiều luồng nước chảy</b></font></font><br/> <br/> Các ứng dụng đa luồng thống trị thế giới phần mềm. Mỗi ứng dụng tương tác, bất kể trên desktop hay server đều cần hoạt động theo nhiều luồng để cho “cục cưng” người dùng có cảm giác mọi ý muốn của hắn đều được thỏa mãn ngay tức thì và máy tính chỉ hầu hạ cho riêng hắn. Qua phần này, không những bạn sẽ được biết về luồng nói chung, mà còn được biết các luồng hoạt động như thế nào trong Ada. Ada hỗ trợ lập trình đa luồng bằng những kết cấu đặc biệt của ngôn ngữ. Nói vắn tắt, một thứ gì đó khác hẳn luồng trong Linux, Win32, Java và .NET.<br/> <br/> <font color='orange'><b>Một chút thuật ngữ</b></font><br/> Thuật ngữ, như ta vẫn thường thấy, là một mớ bòng bong. Cùng một sự vật, các hệ thống *NIX đặt tên một đàng, Microsoft đặt tên một nẻo; thuật ngữ trong tài liệu người dùng khác xa với tài liệu lập trình viên; mỗi ngôn ngữ lập trình tự đặt ra các thuật ngữ của riêng mình. Rồi dịch thuật không thống nhất cũng làm cho vấn đề rối ren thêm nữa. Trong bài này, người viết sẽ dùng khái niệm <font color='yellow'>quá trình</font> (process) để chỉ đối tượng của hệ điều hành, chứa một hay nhiều <font color='yellow'>luồng</font> (thread). Tất cả các luồng của một quá trình dùng chung một không gian địa chỉ, nhưng mỗi luồng đều có ngăn xếp (stack) của riêng mình. Ngôn ngữ Ada đặt ra thuật ngữ <font color='yellow'>tác vụ</font> (task) mà về bản chất, đó chính là luồng.<br/> <br/> <font color='orange'><b>Cơ hội?...</b></font><br/> Hãy tưởng tượng bạn dùng một chương trình e-mail client. Sau khi bạn viết xong một lá thư và ấn nút Send, chương trình phải thực hiện một hành động nào đó. Nó phải kết nối với một e-mail server nào đó rồi chuyển lá thư đi. Việc này có thể kéo dài hàng chục giây. Nếu giả thử mọi hành động đều diễn ra trong một luồng thì chương trình client của bạn trong suốt khoảng thời gian đó sẽ “treo” cứng. Điều đó chẳng thể làm cho bạn vui lòng, bạn muốn viết một lá thư khác nữa kia mà. Đa luồng sẽ giải quyết tình huống này một cách đẹp mắt. Sau khi ấn nút Send chương trình client tạo ra một luồng mới có nhiệm vụ gửi thư. Việc tạo luồng diễn ra rất nhanh, trong nháy mắt bạn có thể bắt tay vào lá thư mới. Việc phát sinh một luồng mới nào đó chạy mất hàng chục giây để gửi thư, bạn chả bận tâm.<br/> <br/> <font color='orange'><b>... Và thách đố?</b></font><br/> Khi chạy một quá trình, hệ điều hành khởi động một luồng duy nhất. Tạo thêm những luồng mới là công việc của người lập trình. Thường là bằng cách gọi một hàm nào đó có trong thư viện của ngôn ngữ và liên hệ trực tiếp với một thủ tục (routine) tương ứng nào đó của hệ điều hành. Một hàm như thế thường tiếp nhận địa chỉ của một phân trình, lấy địa chỉ ấy làm điểm xuất phát cho luồng mới.<br/> <br/> Rồi cần phải có các công cụ để điều khiển các luồng đã tạo. Các luồng cần trao đổi thông tin với nhau, ta thường phải đảm bảo rằng hai luồng không làm việc đồng thời trên một biến toàn cục, vân vân. Phục vụ cho việc đó là "kính thưa" các kiểu đối tượng nguyên sơ (primitive) như đoạn găng (critical section), khóa (lock), cờ hiệu (semaphore), mutex (13), mutant (14). Chúng ta sẽ không quan tâm tìm hiểu ý nghĩa của những từ này; điều quan trọng là để làm việc với những đối tượng này, có các thủ tục trong kernel hệ điều hành và, tương ứng với chúng, có các hàm trong các ngôn ngữ lập trình.<br/> <br/> Nếu lập trình ở mức thấp nhất, người lập trình thường gọi thẳng các thủ tục của hệ điều hành. Thí dụ để tạo luồng mới Linux có <i>pthread_create</i>, Win32 có <i>CreateThread</i>. Lập trình như thế, mã nguồn sẽ không thể chuyển đặt (portable). Khó khăn này có thể xử lý bằng một thư viện che phủ tầng thấp nhất đó, nhưng chúng ta, lập trình viên lười biếng, muốn có nhiều tiện nghi hơn. Trong Java (và do đó cả trong C#) tình thế vẫn tương tự, thư viện chuẩn cung cấp một lớp nào đó nối thẳng vào tận ruột gan của Máy Ảo (Virtual Machine) và cho phép chạy một phương thức (method) trong một luồng mới. Java còn hỗ trợ đa luồng bằng cả những kết cấu làm đồng bộ luồng.<br/> <br/> Đối tượng nguyên sơ, thủ tục kernel, thư viện hay kết cấu ngôn ngữ nói trên đều là những công cụ hỗ trợ mức thấp. Lập trình đa luồng với chúng là một công việc căng thẳng, đầy mệt mỏi và dễ gây sai sót, có thể ví như như lập trình bằng hợp ngữ vậy.<br/> <br/> <font color='orange'><b>Quên đi tất cả, đến với Ada</b></font><br/> Chính thế. Với Ada mọi chuyện đều khác. Luồng trong Ada được nhìn từ một tầm trừu tượng hóa cao hơn, chứa đựng một quan điểm toàn diện hơn nhiều. Luồng Ada, hay còn gọi là tác vụ, là một thực thể đặc biệt. Không những có thể khai báo một tác vụ đơn lẻ mà còn có thể khai báo <font color='yellow'>kiểu tác vụ</font>, một thứ khuôn mẫu để từ đó tạo ra nhiều tác vụ giống nhau. Ta hãy bắt đầu với một Hello World đa luồng.<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>with Ada.Text_IO;<br/> use Ada.Text_IO;<br/> <br/> procedure Hello_Example is<br/> <br/>    task type Hello_Task is       -- đặc tả tác vụ<br/>      -- giao diện &#40;rỗng&#41;<br/>    end Hello_Task;<br/> <br/>    task body Hello_Task is       -- thân tác vụ<br/>    begin<br/>       Put_Line&#40;"Hello from thread"&#41;;<br/>    end Hello_Task;<br/> <br/>    H1, H2, H3 : Hello_Task;      -- 3 tác vụ &#40;3 luồng&#41; giống nhau<br/>                                  -- song song với luồng chính<br/> begin    -- Tại đây, cả 4 luồng cùng khởi động<br/>    Put_Line&#40;"Hello from main thread"&#41;;<br/> end Hello_Example;</pre><br/> 		</div><br/> <br/> Đây là một chương trình đầy đủ, chạy được. Ở đầu ta xác lập một kiểu Hello_Task, thể hiện một luồng nào đó làm khuôn mẫu. Định nghĩa của kiểu này được chia thành hai phần rời hẳn nhau: <font color='yellow'>đặc tả</font> (specification) và <font color='yellow'>thân</font> (body). Đặc tả ở đây rất đơn giản, thực chất chỉ có mỗi cái tên. Thân cũng rất đơn giản, chỉ viết ra câu “Hello from thread” rồi kết thúc. Kế đó ta khai báo ba biến (H1, H2 và H3) của kiểu Hello_Task, cũng y hệt như mọi biến khác mà thôi. Câu khai báo này cho biết ta cần ba tác vụ kiểu Hello_Task và hệ thống sẽ khởi động chúng khi bắt đầu vào đến thân chương trình, tức là điểm <b>begin</b> kế đó. Khi luồng chính bắt đầu viết ra câu “Hello from main thread” thì đã có cả thảy bốn luồng cùng chạy song song. Trên màn hình sẽ hiển thị bốn dòng sau đây, theo một thứ tự ngẫu nhiên nào đó.<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>Hello from thread<br/> Hello from thread<br/> Hello from main thread<br/> Hello from thread</pre><br/> 		</div><br/> <br/> <br/> <br/> ______________________________<br/> NOTES<br/> <br/> (13)	Sinh từ <font color='yellow'>mutual exclusion</font> (loại trừ lẫn nhau).<br/> <br/> (14)	Đây là đặc sản trong thực đơn tiếng lóng của Microsoft, dùng để chỉ một dị bản của mutex cho Windows NT kernel, chứ không phải là “quái nhân đột biến gene” <img src="/hvaonline/images/smilies/6a0fe32c3736658bde52846b7df05e01.gif" border="0" alt="smilie" align="absbottom">.<br/> </div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/readingRoom/item/1664.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/readingRoom/item/1664.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/readingRoom/item/1664.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/readingRoom/item/1664.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/readingRoom/item/1664.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/1664.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/1664.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>

		<tr>
			<td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
						<div class="postbody"><b>Other posts in the same group:</b></div><br />
									<div class="gen"><a href="/hvaonline/readingRoom/item/1643.html">Lập trình an toàn với Ada - 1</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1646.html">Lập trình an toàn với Ada - 2</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1650.html">Lập trình an toàn với Ada - 3</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1653.html">Lập trình an toàn với Ada - 4</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1655.html">Lập trình an toàn với Ada - 5</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1659.html">Lập trình an toàn với Ada - 6</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1660.html">Lập trình an toàn với Ada - 7</a></div>
									<div class="gen"><b>Lập trình an toàn với Ada - 8</b></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1666.html">Lập trình an toàn với Ada - 9</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/1670.html">Lập trình an toàn với Ada - 10</a></div>
						</td>
					</tr>
				</table>
			</td>
		</tr>


		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/543.html#1664" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
