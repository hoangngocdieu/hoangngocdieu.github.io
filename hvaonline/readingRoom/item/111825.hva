<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="http://www.hvaonline.net" title="[Logo]"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Reverse Engineering::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 2 <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/18695.hva#111825" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: mfeng - Translator:  - Entry Date: 26/02/2009 11:28:29" title="Author: mfeng - Translator:  - Entry Date: 26/02/2009 11:28:29"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody"><b><font color='white'>b) Lệnh copy dữ liệu</font></b><br/> <br/> Nhóm lệnh này có chức năng đọc/ghi dữ liệu giữa bộ nhớ và thanh ghi. Có ba nhóm:<br/> <br/> -	Đọc dữ liệu từ bộ nhớ vào một thanh ghi: dữ liệu là byte, word (32bit) hay half-word (16bit)<br/> -	Đọc dữ liệu từ bộ nhớ vào nhiều thanh ghi: dữ liệu là words<br/> -	Đổi chỗ giá trị bộ nhớ - thanh ghi.<br/> <br/>  <b><i><font color='white'>*) Đọc dữ liệu từ bộ nhớ cho một thanh ghi</font></i></b><br/> <br/> 32 bits:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>LDR 	r0, &#91;r1&#93; 		; r0 := mem &#91;r1&#93;<br/> 	STR 	r0, &#91;r1&#93; 		; mem &#91;r1&#93; := r0<br/> 	LDR 	r0,&#91;r1, #4&#93; 		; r0 := mem&#91;r1+4&#93;</pre><br/> 		</div><br/> <i>Giá trị chuyển dịch (như #4 trong vd trên) tối đa là +/- 4KB</i><br/> <br/> 8 bits:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>LDRB 	r0, &#91;r1&#93; 		; r0 := mem &#91;r1&#93; &#91;7:0&#93;<br/> STRB 	r0, &#91;r1&#93; 		; mem &#91;r1&#93; &#91;7:0&#93; := r0</pre><br/> 		</div><br/> <br/> Cập nhật luôn giá trị thanh ghi địa chỉ:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>LDR r0, &#91;r1&#93;, #4 		; r0 := mem&#91;r1&#93;<br/> 				; r1 := r1 + 4</pre><br/> 		</div><br/> <br/> <b><i><font color='white'> *) Đọc dữ liệu từ bộ nhớ vào nhiều thanh ghi:</font></i></b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>LDMIA 	r1,{r0, r2, r5} 	; r0 := mem &#91;r1&#93;<br/> 				; r2 := mem &#91;r1+4&#93;<br/> 				; r5 := mem &#91;r1+8&#93;</pre><br/> 		</div><br/> Copy khối dữ liệu: trong các lệnh loại này, thanh ghi địa chỉ có thể tăng (Increase), giảm (Decrease) trước (Before) hoặc sau (After) khi dữ liệu được copy. Các lệnh này hay được dùng để quản lý stack.<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/d204ba3f9d0e4e54a6693d1187e2dfb7_92659.gif' border="0"  /></div><br/> <br/> Ví dụ: lệnh sau đây hay được dùng trong code prolog  và code epilog của các hàm:<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>STMFD   SP!, {R4-R6,LR}		; Lưu giá trị R4, R5 & LR <br/> 					; vào stack, trừ SP đi 4 x 4 = 0x10<br/> SUB     SP, SP, #0x24			; Dành 0x24 bytes cho local vars<br/> ....<br/> ADD     SP, SP, #0x24			; Phục hồi trạng thái stack<br/> LDMFD   SP!, {R4-R6,PC}		; Phục hồi thanh ghi R4, R6, trả về địa chỉ sau khi gọi BL vào thanh ghi PC &#40;R15&#41;</pre><br/> 		</div><br/> <br/> <font color='white'><b><i> *) Đổi chỗ giá trị bộ nhớ - thanh ghi.</i></b></font><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>SWP      Rd, Rm, &#91;Rn&#93;</pre><br/> 		</div><br/> Ý nghĩa của lệnh này như sau: đọc giá trị từ bộ nhớ [Rn] vào thanh ghi Rd, sau đó ghi giá trị ở thanh ghi Rm vào [Rn].<br/> <br/> <font color='white'><b>c) Tập lệnh điều khiển, rẽ nhánh</b></font><br/> <br/> Các lệnh rẽ nhánh thực hiện dựa trên trạng thái của các bit trong thanh ghi CPSR, bao gồm bit <font color='red'>N, S, C, V</font>.<br/> <br/> <i> - Rẽ nhánh vô điều kiện: </i><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>B	LABEL</pre><br/> 		</div><br/> <i> - Rẽ nhánh có điều kiện:</i><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>MOV r0, #0		; initialize counter<br/> LOOP: 	...<br/> 		ADD r0, r0, #1		; increment counter<br/> 		CMP r0, #10	 	; compare with limit<br/> 		BNE LOOP 		; repeat if not equal<br/> 		... 			; else continue</pre><br/> 		</div><br/> <font color='white'><b>Tổng kết các lệnh rẽ nhánh:</b></font><br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>Branch		Interpretation 			Normal Uses<br/> --------------------------------------------------------------<br/> B 		Unconditional 			Always take this branch<br/> BAL 		Always 				Always take this branch<br/> BEQ 		Equal 				Comparison equal or zero result<br/> BNE 		Not equal 			Comparison not equal or zero result<br/> BPL 		Plus 				Result positive or zero<br/> BMI 		Minus 				Result minus or negative<br/> BCC 		Carry clear 			Arithmetic operation did not give carry-out<br/> BLO 		Lower 				Unsigned comparison gave lower<br/> BCS 		Carry 				set Arithmetic operation gave carry-out<br/> BHS 		Higher or same 			Unsigned comparison gave higher or same<br/> BVC 		Overflow clear 			Signed integer operation ; no overflow occurred<br/> BVS 		Overflow set 			Signed integer operation ; overflow occurred<br/> BGT 		Greater than 			Signed integer comparison gave greater than<br/> BGE 		Greater or equal 		Signed integer comparison gave greater or equal<br/> BLT 		Less than 			Signed integer comparison gave less than<br/> BLE 		Less or equal 			Signed integer comparison gave less than or equal<br/> BHI 		Higher 				Unsigned comparison gave highe<br/> BLS 		Lower or same 			Unsigned comparison gave lower or same</pre><br/> 		</div><br/> <br/> <b><i><font color='white'>Chú ý:</font></i></b> các lệnh xử lý dữ liệu có thể bao gồm chức năng điều kiện:<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>CMP	r0, #5 		; if &#40;r0 != 5&#41; {<br/> ADDNE	r1, r1, r0 	; 	r1 := r1 + r0 - r2<br/> SUBNE	r1, r1, r2 	; }</pre><br/> 		</div><br/> <br/> <b><font color='white'>Mã điều kiện:</font></b><br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>Opcode	 	Mnemonic 	Interpretation 				Status flag state<br/> &#91;31:28&#93;  	extension 						for execution					 	 <br/> ----------------------------------------------------------------------------------<br/> 0000 		EQ 		Equal / equals zero 			Zset 	 <br/> 0001 		NE 		Not equal 				Zclear 	 <br/> 0010 		CS/HS 		Carry set / unsigned higher or same 	Cset 	 <br/> 0011 		CC/LO 		Carry clear / unsigned lower 		Cclear 	 <br/> 0100 		MI 		Minus / negative 			Nset 	 <br/> 0101 		Pl 		Plus / positive or zero 		Nclear 	 <br/> 0110 		VS 		Overflow				Vset 	 <br/> 0111 		VC 		No overflow 				Vclear 	 <br/> 1000 		HI 		Unsigned higher 			Cset and Zclear 	 <br/> 1001 		LS 		Unsigned lower or same 			Cclear or Zset 	 <br/> 1010 		GE 		Signed greater than or equal 		N equals V 	 <br/> 1011 		LT 		Signed less than 			N is not Equal to V 	 <br/> 1100 		GT 		Signed greater than 			Z clear and N equals V 	 <br/> 1101 		LE 		Signed less than or equal 		Z set or Nis not equal to 	 <br/> 1110 		AL 		Always 					any 	 <br/> 1111 		NV 		Never &#40;do not use!&#41; 			none</pre><br/> 		</div><br/> <br/> <b><font color='orange'>Cơ chế gọi hàm của ARM </font></b>: dùng thanh ghi <font color='yellow'>r14 (LR)</font> lưu trữ địa chỉ lệnh kế tiếp sau lệnh <font color='yellow'>BL</font> để quay trở về.<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>BL 	SUBR 		; branch to SUBR<br/> 	... 			; return to here<br/> SUBR 	... 			; subroutine entry point<br/> 	MOV pc, r14 		; return</pre><br/> 		</div><br/> <b>Gọi hàm nhiều lớp (nested subroutines)</b>: thanh ghi R14 (LR) cần được cất vào stack trước khi gọi hàm.<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>BL SUB1 			; branch to SUB1<br/> 	...<br/> SUB1 	STMDA r13!, {r0-r2, r14}	; save regs<br/> 	BL SUB2<br/> 	...<br/> 	LDMIB r13!, {r0-r2, pc}		; restore regs + return<br/> SUB2 	...<br/> 	MOV pc, r14 			; return</pre><br/> 		</div><br/> <br/> <b><i><font color='orange'>Chú ý</font></i></b>: ARM không có phép toán <font color='yellow'>NOP </font>(như x86). Để thay thế lệnh này, có thể dùng llệnh <font color='yellow'>MOV R0, R0 </font>có opcode là <font color='orange'>0000A0E1</font><br/> <br/> Đến đây, với nội dung đã trình bày, bạn đã có thể đọc hiểu mã lệnh assembly của VXL ARM. Phần tiếp theo đề cập tới các công cụ debug, disassembler và editor hỗ trợ cho reverse engineering trên Windows Mobile. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/readingRoom/item/111825.hva"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/readingRoom/item/111825.hva"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/readingRoom/item/111825.hva"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/readingRoom/item/111825.hva"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/readingRoom/item/111825.hva"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/111825.hva"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/111825.hva"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>

		<tr>
			<td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
						<div class="postbody"><b>Other posts in the same group:</b></div><br />
									<div class="gen"><a href="/hvaonline/readingRoom/item/111283.hva">Kiến thức cơ bản về Reverse Engineering trên Windows Mobile</a></div>
									<div class="gen"><b>Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 2</b></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/111866.hva">Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 3</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/111869.hva">Kiến thức cơ bản về Reverse Engineering trên Windows Mobile - 4</a></div>
						</td>
					</tr>
				</table>
			</td>
		</tr>


		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/18695.hva#111825" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.hva'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
