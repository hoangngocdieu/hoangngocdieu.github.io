<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="" title="[Logo]"><img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::*nix::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 SAMBA 3.0 THỰC HÀNH <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/2115.html#10766" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: tranvanminh - Translator:  - Entry Date: 23/02/2009 12:34:04" title="Author: tranvanminh - Translator:  - Entry Date: 23/02/2009 12:34:04"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody">Chào mừng bạn đến với ``vũ điệu Samba`` trong ``Lễ hội.. Chim cánh chụt``!<br/> Bạn có biết gần đây ``vũ điệu`` này đã có sự chuyển biến lớn hay không? Bạn đã biết, đã nghe hay đã ``vọoc`` những chức năng mới của Samba 3.0 chưa? Nếu chưa thì hãy thử nhé! Tôi sẽ cùng thử với các bạn trong bài viết này!<br/> <br/> <br/> Như các bạn đã biết, Samba đã có một vị trí nhất định, một phần không thể thiếu trong các Distribution của giới mã mở, như Red Hat Enterprise Linux（RHEL） 3.0 Fedora Core, và trong nhiều Distributio khác.<br/> <br/> Nếu bạn yêu thích *nix, bạn đã từng sử dụng Samba 2.2x thì bạn có có nghĩ đến việc nâng cấp lên phiên bản Samba 3.0 mới mẽ, với nhiều tính năng rất ``ăn tiền`` này chưa?<br/> <br/> Cho dù bạn đang quản trị một mạng lớn, hay chỉ là một Iter bình thường, hoặc thậm chí là là người mới mò mẫm, mới đặt chân vào thế giới Samba thì bạn đừng do dự, hãy thử đi rồi bạn sẽ thấy thú vị với những khám phá của mình. Bạn cũng đừng lo nếu mình đang ``sở hữu`` vốn kiến thức ``tiếng Anh.. thầy chạy`` không thể sờ mó, gậm nhấm được cái mớ chỉ toàn chữ là chữ của đám Anglo Sắc xông ``mắc toi`` kia! Bởi vì những gì bạn được đọc bên dưới được viết bằng thứ ngôn ngữ mà bất cứ người Việt (không mù chữ) nào cũng có thể đọc và có thể hiểu được! greensmile.gif<br/> <br/> Ơ kê, bắt đầu nào quý vị!<br/> <br/> <br/> 1. ``Điểm mặt`` những chức năng mới trong Samba 3.0<br/> <br/> 1.1. Internationalization<br/> <br/> 1.2. SWAT Internationalization<br/> <br/> 1.3. Unicode Support: Xử lý thông tin bằng UCS-2 (Unicode base)<br/> Windows 2000／XP／Windows Server 2003<br/> <br/> 1.4. Kết hợp với Active Directory<br/> Đuợc hỗ trợ xác thực (authentication) của Kerberos nên tương thích với Active Directory (Windows 2000 trở lên)<br/> <br/> 1.5. Mở rộng chức năng Winbind<br/> <br/> Có thệ quản lý LDAP server trên mapping tables userID + Groups<br/> <br/> 1.6. Hỗ trợ nhóm toàn cụ Arbitrarry (Arbitrary Global Group support)<br/> <br/> 1.7. Hỗ trợ tính năng Attestation database<br/> smbpasswd, và nhiều chưc năng Attestation có chất luợng bảo mật cao khác.<br/> <br/> 1.8. Mở rộng an ninh cho SMB -<br/> SMB signature; mã hóa cho security channel, và có sự phố hợp với nhiều chức năng bảo mật cao của Windows<br/> <br/> 1.9. Mở rộng, làm phong phú thêm các Command cho các tính đồ chuộng gõ bàn phím hơn là rê chuột.<br/> <br/> ===============================<br/> <br/> <b>2. Cấu hình cho Samba 3.0</b><br/> <br/> Phần này giới thiệu cơ bản cách cấu hình của Samba - nếu bạn đã từng ``làm việc`` với Samba 2.x bạn sẽ nhận ra nhiều cái ``lối cũ ta về`` á! Tuy nhiên, Samba 3.0 có rất nhiều chức năng mới, hoặc đã được nâng cấp, sửa đổi nên các bạn cũng cần lưu ý.<br/> <br/> Như đã đề cập ở phần giới thiệu, Samba 3.0 được tích hợp trong các distribution của *nix nên khi bạn cài đặt các Dis này thì mặc định các bạn đã có tùy chọn xử lý với Samba.<br/> <br/> Ngoài ra, các bạn có thể download bản Samba mới nhất ở đây:<span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://us1.samba.org/samba/</span></span></span></span></span></span></span></span></span></span></span><br/> <br/> Đây là phiên bản mới nhất (Samba 3.0.6) và được sử dụng cho bài viết này. Bạnbạn có thể tùy chọn download các gói RPM, Tar, SRPM để cài đặt. Bài này tôi dùng SRPM, và GNU Libiconv để thực hiện cài đặt.<br/> <br/> <br/> cd /usr/src/redhat/SRPMS/<br/> rpm --rebuild libiconv-1.8-1.src.rpm<br/> rpm --rebuild samba-3.0.6.src.rpm<br/> <br/> Khi thực hiện rebluild, hệ thống của bạn sẽ tiến hành biên dịch Samba - bạn phải có các packages như GCC , LDAP , Kerberos để thi hành biên dịch. Nếu thực hiện rebuild thành công, trong /usr/src/redhat/RPM/RPMS/i386 sẽ có file RPM -- &gt; Còn không nhanh chân dùng file này để mà cài với đặt! <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom"><br/> <br/> Ah há, nếu bạn nào có ``Coca Cola``, á lộn, có APT, bạn cụng có thể dùng chúng để để download và cài đặt cho nhanh nhanh hơn tí! greenbiggrin.gif<br/> <br/> <br/> apt-get update<br/> apt-get install locales<br/> apt-get install samba<br/> <br/> <br/> Nếu như 2 cách trên bạn không thể dùng đuợc, hoặc bạn muốn sử dụng bản Samba mới nhất này vì lý do gì đó thì bạn có thể complier Samba từ source. Muốn cài đặt Samba, như đã nó trên, bạn cần cài đặt GNU Libiconv. Để sử dụng Attestation Database hoặc AD Domain support thì bạn cần cài LADP và Kerberos.<br/> <br/> <br/> <b>Tiến trình cài cài đặt Samba có thể mô tả như sau:</b><br/> <br/> Nếu bạn không muốn nhận các thông báo lỗi (error message) khi cấu hình Samba thì cần chọn các Options:<br/> <br/> --with-libiconv=<br/> : GNU libiconv install dir<br/> <br/> --with-pam : Hữu hiệu hóa PAM<br/> <br/> --with-ads : Active Directory<br/> <br/> --with-ldapsam : support Attestation LDAP<br/> <br/> cd samba-3.0.6source<br/> <br/> ./configure --with-libiconv=/usr/local --with-automount --with-smbmount --with-pam --with-pam_smbpass --with-ldapsam --with-syslog --with-quotas --with-utmp --with-winbind --with-ldap --with-ads --with-smbwrapper<br/> <br/> $ make<br/> $ su<br/> # make install<br/> <br/> <br/> <br/> Unicode Support （UCS-2、UTF-8）<br/> <br/> <b>/etc/smb.conf</b><br/> <br/> <blockquote><br/> [global]<br/> unix charset = UTF-8<br/> dos charset = UTF-8<br/> display charset = UTF-8<br/> <br/> <br/> unix charset = Nhưng char chạy trên Unix filesystem<br/> <br/> dos charset =Nhưng char chạy trên Windows<br/> <br/> display charset = Những chat chạy trên SWAT<br/> <br/> <br/> Tham gia Active Directory<br/> <br/> Khi sử dụng Kerberos Attestation, Samba 3.0 có thể tham gia Active Drectory trên Windows .<br/> <br/> Thí dụ bạn có những yếu tố như sau:<br/> <br/> DCOS ： Windows Server 2000 (DC= Domain control )<br/> 　 FQDN ： thanbai.w2000ad1.minh.com<br/> Directory domain ： W2000AD1.MINH.COM<br/> 　 Samba 3.0.3 PC ： 777 (computer name )<br/> <br/> &nbsp;<br/> 		</blockquote><br/> <br/> Cách cấu hình /etc/krb5.conf<br/> <blockquote><br/> <br/> [realms]<br/> W2000AD1.MINH.COM = {　# Active domain name<br/> kdc = thanbai.w2000ad1.minh.com　# Dc host<br/> }<br/> <br/> [domain_realm]<br/> .thanbai.w2000ad1.minh.com = W2000AD1.MINH.COM<br/> <br/> thanbai.w2000ad1.minh.com = W2000AD1.MINH.COM<br/> # DNS domain name và Kerberos Realm<br/> <br/> &nbsp;<br/> 		</blockquote><br/> <br/> đồng thời trong file /etc/smb.conf bạn cấu hình như sau<br/> <blockquote><br/> [global]<br/> workgroup W2000AD1　&lt;- Net BIOS name<br/> realm = W2000AD1.MINH.COM<br/> security = ADS&nbsp;<br/> 		</blockquote><br/> <br/> Chuẩn bị xong, ta bắt đầu tham gia vô Active Directory:<br/> <br/> kinit <a href="mailto:administrator@W2000AD1.MINH.COM">administrator@W2000AD1.MINH.COM</a> &lt;--- Nhập chữ IN<br/> Password for <a href="mailto:administrator@W2000AD1.MINH.COM">administrator@W2000AD1.MINH.COM</a>: &lt;--- Nhập Password cũa Administrator<br/> <br/> <br/> Kau khi login thành công, bạn dùng cmd:<br/> <br/> net ads join<br/> <br/> Joined...<br/> <br/> cái ni chắc bạn đã thấy rồi......<br/> <br/> Support of an attestation database<br/> <br/> Tiếp theo tôi xin giới thiệu một trong các tính năng hay ho của Samba là hỗ trợ nhiều chức năng bảo mật tốt cho auth database.<br/> <br/> <br/> Default attestation modules<br/> <br/> smbpasswd : (default)<br/> tdbsam : Databse dạng TDB<br/> ldapsam : Set URL LDAP server<br/> <br/> example config<br/> <br/> [global]<br/> passdb backend = ldapsam:ldap://ldap.minh.com smbpasswd<br/> <br/> <br/> <br/> pdbedit command<br/> cmd này dùng cho ta quản lý acount như add user , modify user ,<br/> <br/> <br/> pdbedit -u 777 -v<br/> <br/> <br/> Unix username: 777<br/> NT username:<br/> Account Flags: [U ]<br/> User SID: S-1-5-21-3899892270-3850540773-3613385630-12000<br/> Primary Group SID: S-1-5-21-3899892270-3850540773-3613385630-10201<br/> Full Name:<br/> Home Directory: \777<br/> HomeDir Drive: G:<br/> Logon Script:<br/> Profile Path: \777profile<br/> Domain: SAMBA30<br/> Account desc:<br/> Workstations:<br/> .............<br/> ..............<br/> .............<br/> <br/> <br/> <br/> <br/> <b>Mỏ rộng security cho SMB</b><br/> <br/> Samba protocol đuợc mỡ rộng và có rất nhiều chức năng năng cao bảo mật cho samba.<br/> <br/> Một số tính năng mới của Samba3.0:<br/> <br/> encrypt passwords、client plaintextauth<br/> <br/> lanman auth、client lanman auth<br/> <br/> ntlm auth、client ntlmv2auth<br/> <br/> ntlmv2 auth、client ntlmv2auth<br/> <br/> server signing、client signin<br/> <br/> server schannel、client schannel<br/> <br/> disable netbios<br/> <br/> <br/> <b>Global group support in NT domain</b><br/> <br/> Trong Samba 2.2 chỉ có hỗ trợ Domain Admins và Domain Users, nhưng đối với samba3.0.x thì hoàn toàn đuợc cải thiện trong vấn đề này, samba3.0.x có thể dùng tất cả domain trong Windows<br/> <br/> Bạn có thể dùng command net groupsmap để cấu trúc global group. Khi dùng net groupsmap command cần có sự phối họp của *nix groups, bạn có thể mapping hoặc make một *nix group dành cho bên *nix<br/> <br/> <br/> Phối hợp Domain Admins và *nix omadm group<br/> <br/> <blockquote><br/> # net groupmap modify NTgroup=`Domain Admins` UNIXgroup=domadm<br/> <br/> # net groupmap add NTgroup=`Samba 1` UNIXgroup=samba1 type=d　<br/> <br/> No rid or sid specified, choosing algorithmic mapping<br/> Successully added group Samba 1 to the mapping db<br/> <br/> <br/> <b>check setting</b><br/> <br/> # net groupmap list　<br/> <br/> Domain Admins (S-1-5-21-3665834988-2389521404-3181922140-512) - &gt; domadm<br/> Domain Guests (S-1-5-21-3665834988-2389521404-3181922140-514) - &gt; -1　<br/> ...............................<br/> ..........................<br/> ...........................<br/> ......................<br/> .....................<br/> <br/> Samba 1 (S-1-5-21-2348584241-585622575-4239557047-1000) - &gt; samba1　<br/> con số là SID&nbsp;<br/> 		</blockquote><br/> <br/> ==========<br/> <br/> <b>3. Tổng kết</b><br/> <br/> Còn rất nhiều chức năng tôi không nêu trong bài viết đuợc trong khuôn khổ giới hạn của bài viết này. Hy vọng có thời gian để bổ túch thêm trong các version tíep theo của bài này ngõ hầu giúp các bạn có nguồn tài liệu bằng Việt ngữ để có thể tìm hiểu, học hỏi, nâng cao thêm kiến thức về Samba.<br/> <br/> <b>4. Các tài liệu tham khảo </b><br/> <br/> Active Directory<br/> <br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> /forum/showtopic_3...tml#entry206869</span></span></span></span></span></span></span></span></span></span></span><br/> <br/> LDAP<br/> <br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://www.gracion.com/server/whatldap.html</span></span></span></span></span></span></span></span></span></span></span><br/> <br/> SWAT<br/> <br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://www.sjoerd-visser.demon.nl/net-linux/swat.html</span></span></span></span></span></span></span></span></span></span></span><br/> <br/> Các site khác:<br/> <br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://us1.samba.org/samba/docs/</span></span></span></span></span></span></span></span></span></span></span><br/> <br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://samba.sernet.de/</span></span></span></span></span></span></span></span></span></span></span><br/> <br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://www.ifn.ing.tu-bs.de/ifn/sonst/samba-vms.html</span></span></span></span></span></span></span></span></span></span></span><br/> <br/><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"><span class="link"> http://www.osnews.com/story.php?news_id=6684</span></span></span></span></span></span></span></span></span></span></span><br/> <br/> 777-Diemxua<br/> </div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=/hvaonline/readingRoom/item/10766.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=/hvaonline/readingRoom/item/10766.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=/hvaonline/readingRoom/item/10766.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=/hvaonline/readingRoom/item/10766.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=/hvaonline/readingRoom/item/10766.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=/hvaonline/readingRoom/item/10766.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=/hvaonline/readingRoom/item/10766.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>



		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/2115.html#10766" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
