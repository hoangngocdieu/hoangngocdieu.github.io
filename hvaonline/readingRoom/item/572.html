<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="http://www.hvaonline.net" title="[Logo]"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Defense::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Snort - A Preprocessor <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/167.html#572" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: Chanhua - Translator:  - Entry Date: 30/05/2009 15:45:38" title="Author: Chanhua - Translator:  - Entry Date: 30/05/2009 15:45:38"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody"><b><font color='violet'>2.4.3 Cấu hình tiền xử lý (preprocessor)</font></b><br/> <br/> Tiền xử lý phục vụ cho nhiều mục đích. Nó “bình thường hoá” traffic cho các services, để chắc chắn rằng dữ liệu trong các packet Snort đang theo dõi sẽ có cơ hội tốt nhất để so sánh với các tín hiệu nhận dạng (signatures ) mà Snort đuợc trang bị. Chức năng khác của quá trình tiền xử lý là tự phòng thủ. Các cuộc tấn công được phát triển để lẩn tránh hoặc làm tràn ngập NIDS sensor, vì thế attacker có thể lợi dụng làm những công việc mình cần. Chức năng frag2 và stream4 tiền xử lý có chức năng chính để chống lại các phương pháp này.<br/> Và chức năng cuối cùng cũng là chức năng quan trọng nhất là làm cho Snort có thêm chút thông minh để phát hiện ra các cuộc tấn công mang phong cách không bình thuờng mà Snort không được trang bị trong rules.<br/> <br/> Mô hình các gói tin đi vào ở mode preprocessor<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455634_thumb.jpg' border="0"  /></div><br/> <br/> 2.4.3.1 FLOW<br/> <br/> Flow preprocessor có một module là flow-portscan. Flow theo dõi tất cả traffic và giữ các track kết nối giữa hệ thống và port lạ, khi có 1 flow lạ mới thông tin sẽ chuyển qua hash (làm cho các track nhỏ hơn , nhanh hơn trong tracking các địa chỉ IP và PORTS) được lưu trữ trong bảng bộ nhớ dành sẵn. Các option cho flow preprocessor<br/> <br/> Memcap<br/> <br/> Chỉ định mức tối đa cho bộ nhớ khi tracking, mặc định là 10MB, thông số này để điều khỉên bộ nhớ của Snort khi cần<br/> <br/> Rows<br/> <br/> Chỉ định số dòng trên bảng hash, mặc định là 4,099 dòng<br/> <br/> Stats_interval<br/> <br/> Có thể chuyển tình trạng của flow preprocessor qua stdout, giá trị là một số nguyên đại diện cho thời gian tính bằng giây (s) , rất hữu ích khi dùng cho mục đích test<br/> <br/> Hash<br/> Phương pháp sử dụng hash thông tin vào bảng, có thể set hash có giá trị là 1 (byte) hoặc 2 (số nguyên ) dùng hash 2 nhanh hơn<br/> <br/> Đây là cấu hình khuyên của các nhà phát triên dùng cho flow:<br/> <br/> Preprocessor flow: stats_interval 0 hash 2<br/> <br/> 2.4.3.2 frag2<br/> <br/> Khi một packet đi từ mạng này qua mạng khác, nó thường cần phân mảnh thành các packet nhỏ hơn, bởi vì mạng thứ 2 sẽ giới hạn kích thuớc của packet và tất nhiên nhỏ hơn mạng đầu tiên. Và tất cả các packet nhỏ sẽ đuợc sắp xếp lại khi đến nơi. Một trong những phương pháp của attacker là dùng các packet nhỏ để lừa firewall hoặc IDS. Ví dụ: rules của Snort đang dò tìm chuỗi /users.pwd trong các section của packet, một attacker có thể tạo ra một dãy các packet rất nhỏ chỉ chứa vài byte trong data của packet, mảnh đầu tiên có thể chứa /user , và cái packet phân mảnh thứ 2 có thể chứa s.pwd, các packet này sẽ không kích hoạt báo động bởi vì nó không giống các rules nào cả, frag2 preprocessor sẽ sắp xếp sự phân mảnh này vào chung và nó sẽ dễ dàng phát hiện sự ẩn dấu đó. Hoặc một ví dụ khác các attacker có thể đưa ra 1 dung lượng quá lớn các packet đã phân mảnh nó sẽ chiếm dung lưonng của hệ thống và làm overload có thể Snort sẽ từ chối tất cả và ảnh hưởng tới các packet không liên quan, các tools mà attacker thường dùng là Fragroute, frag2 có các options để chống lại các dạng tấn công này<br/> <br/> Timeout:<br/> <br/> Số dây trước khi tắt các sension để flush lại bộ nhớ, mặc định là 60s<br/> <br/> Memcap<br/> <br/> Số luợng bytes của memory set aside, mặc định là 4MB<br/> <br/> Detect_state_problems<br/> <br/> Bật chức năng báo động khi phát hiện điều kiện không bình thường trong các packet phân mảnh, nó nên được bật cho hầu hết các trường hợp<br/> <br/> Min_ttl<br/> <br/> Thiết lập time to live (TTL) tối thiểu đuợc chấp nhận của tiền xử lý, mặc định là 0<br/> <br/> Ttl_limit<br/> <br/> Thiết lập ttl maximum, nó không nên quá lớn ,mặc định là 5<br/> <br/> Thiết lập khuyến cáo nên dùng:<br/> <br/> Preprocessor frag2<br/> <br/> 2.4.3.3 stream4<br/> <br/> stream4 được thiết kế để bảo vệ Snort từ 1 dạng tấn công mới của attacker tới các NIDS sensor bằng cách gửi tràn ngập các packet chứa các chuỗi dữ liệu giống như trong rules để kích các báo động, cũng có khá nhiều tools dùng cho việc này nhưng Snort của có cách chống lại.<br/> <br/> stream4 có 2 nhiệm vụ chính: sateful inspection ( kiểm tra tính nguyên ven ), awareness and session reassembly ( nhận biết và sắp xếp các session )<br/> <br/> Các option của stream4<br/> <br/> Detect_scans<br/> <br/> Mặc định là tắt. nó sẽ báo động khi phát hiện các tools scan ports<br/> <br/> Detect_state_problems<br/> <br/> Mặc định tắt. sẽ báo động khi có vấn đề về tình trạng của cuộc thoại bị phát hiện<br/> <br/> Disable_evasion_alerts<br/> <br/> Cũng mặc định tắt luôn. nếu bật nó có thể phát hiện attacker đang cố gắng từ chối IDS bằng cách gởi các packet đuơc sắp xếp lộn xộn, hoặc các packet là SYN trong data<br/> <br/> Min_ttl<br/> <br/> Thiết lập thời gian sống ít nhất để chấp nhận các packet vào stream4 preprocessor<br/> <br/> Ttl_limit<br/> <br/> Giống như trong phần của frag2<br/> <br/> keepstats [machine, binary]<br/> <br/> Mặc định tắt, nếu bật nó sẽ hiển thị tình trạng các senssion đã theo dõi ở 2 chế độ machine là text file, định dạng binary và dùng tools barnyard để thống nhất<br/> <br/> Noinspect<br/> <br/> Mặc định cũng off. tắt chức năng statefull inspection của tất cả các packets<br/> Ta có thể tham khảo về các tiến trình stateful ở hình này<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455673_thumb.jpg' border="0"  /></div><br/> <br/> Timeout mặc định là 30s<br/> <br/> log_flushed_streams<br/> <br/> Nếu một packet đang bị theo dõi và là nguyên nhân gây ra báo động, ta có thể dump session này và lưu thông tin từ stream4 vào đĩa cứng<br/> <br/> Memcap<br/> <br/> Giống phần frag2<br/> <br/> Đây là câu lệnh khuyến cáo nên dùng<br/> <br/> preprocessor stream4: detect scans, disable_evasion_alerts, timeout 60, ttl_limit 10<br/> <br/> 2.4.3.4 stream4_reassemble<br/> <br/> Snort phản hồi những chuỗi kí tự nó đọc đuợc trong các gói tin đi qua nếu nó trùng với các kí tự nhận dạng trong signatures. Nếu attacker có thể phân chia các kí tự thành nhiều gói tin để tránh báo động của Snort, stream4_reassemble đóng vài trò sắp xếp lại các traffic giữa 2 hệ thống đàm thoại ( conversation ) của network, gia tăng khả năng match các signatures<br/> <br/> Các conversation network thường là các chương trình dùng bằng command line như Telnet, Ftp, Smtp có thể là các nguyên nhân nội dung của các packet lọt qua được hệ thống. Reassemble các traffic các services này là cần thiết để ngăn chặn các báo động lầm hoặc bỏ sót.<br/> Một kĩ thuật khác của attacker là nhúng các gói tin với các kí tự gây lỗi, reassemble vẫn có thể phát hiện được<br/> <br/> Các option của reassemble<br/> <br/> Clientonly<br/> <br/> Chỉ bật chức năng này trên client<br/> <br/> Serveronly<br/> <br/> Chỉ bật chức năng này trên server<br/> <br/> Both<br/> <br/> Bật trên cả server và client<br/> <br/> Noalerts<br/> <br/> Chế độ báo động vẫn hoạt động nhưng chỉ tắt chức năng reassembly<br/> <br/> Ports [list]<br/> <br/> Chỉ định những ports cụ thể để reassembly<br/> <br/> Câu lệnh khuyên dùng:<br/> <br/> Preprocessor stream4_reassemble: both<br/> <br/> <br/> 2.4.3.5 Tiền xử lý các http inspect <br/> <br/> Có nhiều cách thông tin có thể định dạng sang các http session và cũng có nhiều loại khác nhau biểu diễn các thông tin như là các http session như multimedia, .xml, .HTML, .asp, .php, .java,….và kết quả Snort phải “massage” nội dung của các HTTP conversation để định dạng lại data phục vụ cho quá trình phát hiện tốt nhất<br/> <br/> Có 2 kiểu cấu hình http_inspect là global và server. Global ảnh huởng trực tiếp tới http traffic ,cấu hình Server chứa các phần setting cho 1 máy server và các group servers như vậy, cái này rất thường dùng để cấu hình cho web server dùng apache hoặc IIS<br/> <br/> http_inspect ( global )<br/> <br/> Có 3 option trong phần này dùng để config http traffic:<br/> <br/> iis_unicode_map &lt;filename&gt; [codemap &lt;interger]<br/> <br/> Chỉ đuờng dẫn tới map file unicode.map. Nó sẽ chỉ cho bộ tiền xử lý biết làm cách nào để map các kí tự unicode sang ASCII dạng text đê match các signatures. Ta phải chỉ ra code dể map ví dụ 1252 là latin code<br/> <br/> detect_anomalous_servers<br/> <br/> Sẽ báo động khi gặp các ports lạ không tiêu chuẩn. thường không bật chế độ này<br/> <br/> proxy_alert<br/> <br/> Nếu bạn sử dụng proxy server cho các internet user, bật chức năng này để giám sát các user không dùng proxy để kết nối internet<br/> <br/> Đề nghị setting cho mode này:<br/> <br/> preprocessor http_inspect: global iis_unicode_map unicode.map 1252<br/> <br/> http_inspect_server<br/> <br/> Có thể dùng option này cho servers bất kì hoặc các servers trong môi truờng làm việc của mình. hầu hết các administrator đều dùng 1 server riêng dùng cho IIS và cái khác dùng Apache servers. Trong phần trình bày này sẽ có ví dụ cụ thể.<br/> <br/> Có 2 kiều cấu hình cho http_inspetct_server là “default” và “by IP address”, kiểu “default” chỉ cấu hình cho tất cả web traffic không liên quan gì đến IP address, còn kiểu “IP address” chỉ cấu hình cho các IP đựơc chỉ định hoặc 1 dãy các IP. Có các option là:<br/> <br/> Default hoặc &lt; IP address &gt;<br/> <br/> Như đã trình bày ở trên<br/> <br/> Profile &lt;all | apache | iis &gt;<br/> <br/> Có thể dùng apache hoặc chỉ dùng cho iis ta cũng có thể dùng all cho cả 2. Các bảng sau sẽ trình bày cụ thể của profile khi dùng từng loại <br/> <br/> Bảng setting cho profile "all"<br/> <br/> <br/> Option                                            Setting<br/> <br/> flow_depth                                300<br/> chunk_encoding                            Báo động khi các chunks lớn hơn 500,000 bytes<br/> lis_unicode_map                            Map sử dụng cho mode globle<br/> ascii                                              No<br/> non_refc_char                              On<br/> multi_slash                                  No<br/> directory                                    No<br/> apache_whitespace                  Yes<br/> double_decode                            Yes<br/> j_encode                                  Yes<br/> bare_byte                                Yes<br/> lis_unicode                                  Yes<br/> lis_backslash                                No<br/> lis_delimiter                                  Yes<br/> <br/> <br/> Bảng setting cho profile "apache"<br/> <br/> <br/> Option                                          Setting<br/> <br/> flow_depth                              300<br/> chunk_encoding                          Báo động khi các chunks lớn hơn 500,000 bytes<br/> ascii                                            No<br/> non_rfc_char                            On<br/> multi_slash                              No<br/> directory                                No<br/> apache_whitespace              Yes<br/> <br/> <br/> <br/> Bảng setting cho profile "iis"<br/> <br/> <br/> Option                                          Setting<br/> <br/> flow_depth                              300<br/> lis_unicode_map                          Map sử dụng cho mode globle<br/> ascii                                            No<br/> multi_slash                                No<br/> directory                                  No<br/> double-decode                            Yes<br/> u_encode                              Yes<br/> bare_byte                              Yes<br/> lis_unicode                                Yes<br/> lis_backslash                              No<br/> lis_delimiter                                Yes<br/> apache_whitespace                Yes<br/> <br/> utf_8                                          No<br/> non_strict                                On<br/> <br/> <br/> <br/> Đây là phần cấu hình mặc định cho http_inspect_server:<br/> <br/> Preprocessor http_inspect_server: server default profile all ports {80 8080 }<br/> <br/> Đây là phần cấu hình cho IIS server http_inspect_server :<br/> <br/> Preprocessor http_inspect_server: server 10.10.10.33 profile iis ports { 80 8080 }<br/> <br/> Còn đây là cấu hình điển hình cho Apache server:<br/> <br/> Preprocessor http_inspect_server 10.1.1.125 profile apache ports { 80 8080 }<br/> <br/> <b><font color='violet'>2.4.3.6 rpc_decode</font></b><br/> <br/> RPC’s traffic có thể phân chia ra nhiều packet và mã hoá theo nhiều kiểu khác nhau. Rpc_decode preprocessor sẽ bình thường hoá các traffic này cũng chỉ mục đích giúp nhận diện tốt hơn trong singnatures list. List của các ports mà RPC services đang chạy đuợc cung cấp trong các dòng cấu hình. Ở đây có 4 options cho rpc_decode<br/> <br/> Alert_fragments<br/> <br/> Báo động khi có fragmented RPC traffic<br/> <br/> No_alert_multiple_requests<br/> <br/> Không báo động khi nhiều hơn một RPC request đuợc chứa trong một packet.<br/> <br/> No_alert_large_fragments<br/> <br/> RPC fragments có thể lớn hơn size của các fragment hiện hành. Nếu bạn tìm lỗi xác thực, ta phải dùng chức năng này để disable<br/> <br/> No_alert_incomplete<br/> <br/> RPC messages có thể rất lớn, có khi nó lớn hơn có MTU của mạng nó đang đi qua, nó có thể gây nhiều lỗi cho các RPC network services. Có thể tắt chức năng này để phát hiện lỗi<br/> <br/> Đây là đề nghị config rpc_decode<br/> <br/> Preprocessor rpc_decode: 111 32771 1024<br/> <br/> <br/> 2.4.3.7 bo<br/> <br/> Bo- Back orifice con virust nổi tiếng của các hacker trong các năm qua, dùng để điều khiển từ xa các client bị nhiễm nó, Snort có option để ngăn chặn điều này và phát hiện khá dễ dàng chỉ bằng một dòng lệnh ngắn gọn.<br/> <br/> Preprocessor bo<br/> <br/> 2.4.3.8 telnet_decode<br/> <br/> Dùng chức năng này để bình thuờng hoá các kí tự ,chuổi không tiêu chuẩn , lạ của traffic FTP và telnet cũng đơn giản dùng 1 câu lệnh đơn giản.<br/> <br/> Preprocessor telnet_decode<br/> <br/> 2.4.3.9 flow-portscan<br/> <br/> Flow-portscan thay thế portscan2 nó nhiều chức năng hơn và mạnh hơn. Có 3 components cơ bản cho flow-portscan<br/> <br/> Scoreboards<br/> <br/> Nó phát hiện đuợc 2 loại khác nhau của host , talker và scanner. Talker là tất cả các host đang active trong mạng. còn scanner là host đang connection tới 1 port trên server ở trong mạng<br/> <br/> Uniqueness tracker<br/> <br/> Theo dõi nếu có duy nhất 1 kết nối<br/> <br/> Server statistics tracker<br/> <br/> Sử dụng để theo dõi thời gian của các service trên các server nhằm theo dõi các kết nối<br/> <br/> Để phát hiện các attacker scan port rất khó vì hacker có thể dùng nhiều cách khác nhau: <br/> Sau đây là các option ta có thể dùng để nâng cao hiệu quả của flow-portscan<br/> <br/> <br/> scoreboard-memcap-talker &lt; bytes&gt;<br/> scoreboard-rows-talker &lt; count&gt;<br/> scoreboard-rows-scanner &lt; count&gt;<br/> scoreboard-memcap-scanner &lt; bytes&gt;<br/> scanner-fixed-threshold &lt; integer&gt;<br/> scanner-sliding-threshold &lt; integer&gt;<br/> scanner-fixed-window &lt; integer&gt;<br/> scanner-sliding-window &lt; integer&gt;<br/> scanner-sliding-scale-factor &lt; float&gt;<br/> talker-fixed-threshold &lt; integer&gt;<br/> talker-sliding-threshold &lt; integer&gt;<br/> talker-fixed-window &lt; integer&gt;<br/> talker-sliding-window &lt; integer&gt;<br/> talker-sliding-scale-factor &lt; float&gt;<br/> unique-memcap &lt; bytes&gt;<br/> unique-rows &lt; integer&gt;<br/> server-memcap &lt; bytes&gt;<br/> server-rows &lt; integer&gt;<br/> server-watchnet &lt; ip list in Snort notation&gt;<br/> src-ignore-net &lt; ip list in Snort notation&gt;<br/> dst-ignore-net &lt; ip list in Snort notation&gt;<br/> tcp-penalties &lt;on|off&gt;<br/> server-learning-time &lt; seconds&gt;<br/> server-ignore-limit &lt; hit count&gt;<br/> server-scanner-limit &lt; hit count&gt;<br/> alert-mode &lt;once|all&gt;<br/> output-mode &lt;msg|pktkludge&gt;<br/> base-score &lt; integer&gt;<br/> dumpall &lt;1&gt;<br/> <br/> <br/> <br/> Đây là dòng cấu hình mẫu cho flow-portscan<br/> <br/> preprocessor flow-portscan: server-watchnet [10.10.10.0/24,10.10.20.0/24]<br/> <br/> 2.4.3.10 arpspoof<br/> <br/> Arpspoof được thiết kế cho preprocessor dể detech các hoạt động spoof arp bất hợp pháp trên local nétwork. Các hacker dùng các tools man-in-the-middle attacks như ettercap hoặc arpspoof để nghe trộm giữa các máy trong mạng nội bộ. để cấu hình administrator phải biết địa chỉ MAC của card mạng, điều này thì quá dễ dàng:<br/> <br/> Sau đây là cấu hình đề nghị:<br/> <br/> # preprocessor arpspoof<br/> <br/> # preprocessor arpspoof_detect_host: 192.168.1.1 F0:AB:GH:10:12:53<br/> <br/> <br/> <br/> 2.4.3.11 perfmonitor<br/> <br/> Một trong những khả năng rất hay của Snort là monitor tình trạng hiện tại của hể điều hành các thông số nó thể hiện nêu lên nhiều ý nghĩa mà dựa vào đó ta có thể đoán được nhiều đìều và đưa ra nhiều biện pháp điều chỉnh theo ý muốn, các thông số Snort monitor<br/> <br/> <br/> Packets received <br/> Packets dropped <br/> Percentage of packets dropped <br/> Packets Received  <br/> Kpackets per second <br/> Average bytes per packets <br/> Mbits per second (wire) <br/> Mbits per second (rebuilt) (Mbits trung bình Snort nhúng vào sau khi rebuil các packet) <br/> Mbits per second (total) <br/> Pattern-matching percent (Phần trăm dữ liệu average percent of data received that Snort processes <br/> in pattern matching) <br/> CPU usage (user time, system time, idle time) <br/> Alerts per second <br/> SYN packets per second <br/> SYN/ACK packet per second <br/> New sessions per second <br/> Deleted sessions per second <br/> Total sessions <br/> Max sessions during time interval <br/> Stream flushes per second <br/> Stream faults per second <br/> Stream timeouts <br/> Frag completes per second <br/> Frag inserts per second <br/> Frag deletes per second <br/> Frag flushes per second <br/> Frag timeouts <br/> Frag faults<br/> <br/> <br/> Khi dùng thêm từ “flow” , nó sẽ hiển thị tình trạng các traffic của protocal mà Snort dang soi, dùng “event” Snort sẽ mở chức năng reporting và hiển thị trạng thái số lượng signatures match, dùng từ “max” sẽ kích hoạt Snort hoạt động hết sức để nâng cao hiệu quả, dùng tư “pktcnt” điều chỉnh số lượng packets đang thực thi trước khi check thời gian sample mặc định set là 10,000.<br/> <br/> Ví dụ config và bật chức năng perfmonitor preprocessor:<br/> <br/> Preprocessor perfmonitor : time 30 events flow file stats.profile max console pktcnt 10000<br/> <br/> Preprocessor perfmonitor: time 30 file /var/tmp/Snortstat pktcnt 10000<br/> <br/> <b><font color='violet'>2.4.4 Cấu hình OUTPUT</font></b><br/> <br/> Snort có thể output vào các file log hoặc output ra console, nhiều administrator thích dùng các phần mềm của hãng thứ 3 (third party ) để tăng thêm chức năng giám sát của Snort, các phần mềm data database đều có thể dùng được, lưu ý trước khi cài đặt Snort muốn dùng database nào thì cần chỉ rõ khi cài đặt ví dùng dùng MySQL , khi biên dịch source thêm vào - -mysql <br/> ví dụ: ./configure  - -  mysql<br/> <br/> <br><br/> 			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136530751_thumb.jpg' border="0"  /></div><br/> <br/> 2.4.4.1 alert_syslog<br/> <br/> Output cấu hình theo kiểu<br/> <br/> Output alert_syslog : &lt;facility&gt; &lt;priority&gt;<br/> <br/> Các option sau là một trong nhưng syslog chuẩn và syslog mặc định là <br/> <br/> LOG_AUTH<br/> <br/> LOG_AUTH<br/> LOG_AUTHPRIV<br/> LOG_DAEMON<br/> LOG_LOCAL0<br/> LOG_LOCAL1<br/> LOG_LOCAL2<br/> LOG_LOCAL3<br/> LOG_LOCAL4<br/> LOG_LOCAL5<br/> LOG_LOCAL6<br/> LOG_LOCAL7<br/> LOG_USER<br/> <br/> Các option ưu tiên sau cũng là các syslog ưu tiên chuẩn, mặc định là LOG_ALERT<br/> <br/> LOG_EMERG<br/> LOG_ALERT<br/> LOG_CRIT<br/> LOG_ERR<br/> LOG_WARNING<br/> LOG_NOTICE<br/> LOG_INFO<br/> LOG_DEBUG<br/> <br/> Đây là câu cấu hình mẫu cho alert_syslog<br/> <br/> output alert_syslog: LOG_AUTH LOG_ALERT<br/> <br/> và câu lệnh này dành cho bản windows của Snort nhìn vào cũng dễ hiểu<br/> <br/> output alert_syslog: host=192.168.1.100:80 LOG_AUTH LOG_ALERT<br/> <br/> 2.4.4.2 log_tcpdump<br/> <br/> Log này sẽ định dạng sang dạng log_tcpdump, do có rất nhiều phần mềm có thể đọc được dạng log này, khi log sẽ có timestamp đính vào file name<br/> <br/> ví dụ: câu lệnh cấu hình<br/> <br/> output log_tcpdump /var/log/Snort/tcpdump.out<br/> <br/> 2.4.4.3 database<br/> <br/> Khi log vào database , một khối luơng lớn thông tin của Snort sẽ được lưu trữ như các báo động (alert) , các host liên quan, các packet gây ra báo động, và ta dễ dàng log các báo động thật sự và các báo động lỗi, sai nhanh và nhiều hơn<br/> Đôi khi log vào database cũng quá tải gây ra hiện tượng thắt cổ chai dẫn đến 1 alert chỉ có thể được log trong một thời gian. Và phương pháp cấu hình Snort làm sao hợp lý nhất là các kinh nghiệm của các admin sau này ví dụ có thể dùng tuning hoặc thresholding để tạo hiệu quả hơn.<br/> <br/> Cấu trúc của câu lệnh output ra database<br/> <br/> output database: &lt;log | alert&gt;,&lt;database type&gt;,&lt;parameter list&gt;<br/> <br/> Câu lệnh trên nhìn vào ta có thể hiểu ngay được ý nghĩa của nó, còn &lt;parameter list&gt; bao gồm các phần sau :<br/> <br/> host<br/> <br/> Địa chỉ IP của database server<br/> <br/> port <br/> Port của database đang lắng nghe<br/> <br/> dbname=&lt;database name&gt;<br/> <br/> Loại database ta đang logging<br/> <br/> user<br/> <br/> username Snort sử dụng để log trong database<br/> <br/> password<br/> <br/> Tất nhiên là có user phải có pass để vào rồi<br/> <br/> sensor_name<br/> <br/> Tên của sensor cấu hình, có thể thểm -I trong command line sử dụng IP address thay cho tên <br/> <br/> encoding<br/> <br/> Sử dụng mã hoá để log vào database, ví dụ kiểu hex,base64,ascii và khuyên dùng ascii <br/> <br/> detail<br/> <br/> Có thể chỉ định details level nào log vào database, ví dụ dùng full,fast và full được khuyên dùng nhất<br/> <br/> Với các loại database cụ thể ta phải biên dịch cho đúng khi cài đặt như đã nói phần trước<br/> <br/> CODEMySQL<br/> ./configure - -with-mysql<br/> <br/> POSTGRESQL<br/> ./configure - -with-postresql<br/> <br/> ODBC<br/> ./configure - -with-odbc<br/> <br/> MSSQL<br/> Chỉ dùng cho bản windown, dùng odbc để log vào MSMSQL server<br/> <br/> ORACLE<br/> ./configure - -with-oracle<br/> <br/> và các log khác ta sẽ coi trong phần khuyến cáo của database kèm theo<br/> <br/> 2.4.5 File Inclusion<br/> <br/> Trong file Snort.conf, câu lệnh include chỉ cho Snort đọc các file sau từ include được lưu trong filesystem của Snort sensor, giống như trong lập trình vậy<br/> <br/> ví dụ : <br/> <br/> $ include $RULE_PATH/bad-traffic.rules<br/> $ include $RULE_PATH/exploit.rules<br/> $ include $RULE_PATH/scan.rules<br/> <br/> Các rules trên ta có thể download trên internet, khi down về ta muốn phân nhóm hoặc chỉnh sửa,độ ưu tiên các rules ta có thể cấu hình trong file classification.config, file reference.config gồm các links tới web site với các thông tin cho tất cả các alerts, include nó rất hữu tích , nhanh gọn<br/> ví dụ:<br/> <br/> # include classification & priority settings<br/> <br/> include classification.config<br/> <br/> # include reference systems<br/> <br/> include reference.config<br/> <br/>  channhua - HVA</div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/readingRoom/item/572.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/readingRoom/item/572.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/readingRoom/item/572.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/readingRoom/item/572.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/readingRoom/item/572.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/572.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/572.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>

		<tr>
			<td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
						<div class="postbody"><b>Other posts in the same group:</b></div><br />
									<div class="gen"><a href="/hvaonline/readingRoom/item/569.html">Snort - Detecting Intrusions</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/570.html">Snort - A Sniffer</a></div>
									<div class="gen"><b>Snort - A Preprocessor</b></div>
						</td>
					</tr>
				</table>
			</td>
		</tr>


		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/167.html#572" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
