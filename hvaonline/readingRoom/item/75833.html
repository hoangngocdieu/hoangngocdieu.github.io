<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="" title="[Logo]"><img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::*nix::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Squid - Access Control <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/12859.html#75833" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: Vickizw - Translator:  - Entry Date: 13/02/2009 16:43:07" title="Author: Vickizw - Translator:  - Entry Date: 13/02/2009 16:43:07"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody">Do trình độ có hạn nên bài viết còn sơ sài , mong mọi người góp ý.<br/> <br/> Squid có khoảng 25 loại ACL khác nhau, một số trong chúng được sử dụng khá phổ biến.<br/> <br/> File cấu hình chính của Squid là <b>squid.conf ( /etc/squid/squid.conf )</b> , mọi thay đổi ở file này bạn <b>cần restart lại squid để có hiệu lực</b>.<br/> <br/> <b>1.Hạn chế truy cập web theo thời gian</b>:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl home_network src 192.168.1.0/24<br/> acl allow_hours time M T W H F 9:00-17:00<br/> acl RestrictedHost src 192.168.1.23<br/> <br/> http_access deny RestrictedHost<br/> http_access allow home_network allow_hours</pre><br/> 		</div><br/> <br/> Nếu bạn có các dòng trên trong file squid.conf thì các máy trong mạng nội bộ chỉ truy cập được vào mạng vào các ngày thứ 3 đến thứ 6 và trong thời gian 9h đến 17h.<br/> Trừ máy 192.168.1.23, vì bị cấm tất cả.<br/> <br/> M, T, W, H, F là viết tắt các ngày trong tuần ( chủ nhật : S, thứ bảy : A)<br/> Có thể dùng D để thay bằng các ngày trong tuần ( M - F )<br/> <br/> <b>2.Hạn chế truy cập các website được ấn định trước :</b><br/> <br/> Đầu tiên tạo 2 file ở trong thư mục /etc/squid là allowed-sites.squid và restricted-sites.squid để chứa tên các domain cho phép truy cập và cấm truy cập.<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre># File: /squid/allowed-sites.squid<br/> www.hvaonline.net<br/> fotech.org<br/> <br/> # File: /etc/squid/restricted-sites.squid<br/> www.sex.com<br/> xxx.net</pre><br/> 		</div><br/> <br/> Nếu bạn muốn trong thời gian làm việc, cấm vào một số site và cho phép vào một số site nó thì :<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl home_network src 192.168.1.0/24<br/> acl work_hours time M T W H F 9:00-17:00<br/> acl GoodSites dstdomain "/etc/squid/allowed-sites.squid"<br/> acl BadSites  dstdomain "/etc/squid/restricted-sites.squid"<br/> <br/> http_access deny BadSites<br/> http_access allow home_network work_hours GoodSites</pre><br/> 		</div><br/> <br/> Bạn có thể dùng url_regex để hạn chế vào các domain name được ấn định:<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl domainname url_regex -i ^http://www<br/> http_access deny domainname</pre><br/> 		</div><br/> <br/> <b>3.Hạn chế truy cập web theo địa chỉ ip :</b><br/> <br/> Bạn có thể tạo một access control list để hạn chế truy cập web trên một mạng nào đó.<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl home_network src 192.168.1.0/255.255.255.0<br/> http_access allow home_network<br/> <br/> acl localhost dst 127.0.0.0/8<br/> http_access allow localhost</pre><br/> 		</div><br/> <br/> <b>4.Hạn chế nội dung các file download:</b><br/> <br/> Tạo một file chứ nội dung các phần đuôi của các tập tin mà bạn muốn hạn chế là blocks.files.acl nằm trong <b>/etc/squid</b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>\.&#91;Ee&#93;&#91;Xx&#93;&#91;Ee&#93;$<br/> \.&#91;Aa&#93;&#91;Vv&#93;&#91;Ii&#93;$<br/> \.&#91;Mm&#93;&#91;Pp&#93;&#91;Gg&#93;$<br/> \.&#91;Mm&#93;&#91;Pp&#93;&#91;Ee&#93;&#91;Gg&#93;$<br/> \.&#91;Mm&#93;&#91;Pp&#93;3$</pre><br/> 		</div><br/> <br/> Thêm vào<b> squid.conf</b> dòng<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl blockfiles urlpath_regex “/etc/squid/blocks.files.acl”<br/> http_access deny blockfiles</pre><br/> 		</div><br/> <br/> <b>5.Hạn chế truy cập theo cổng :</b><br/> <br/> vd<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl httpports port 80 8000-8010 8080<br/> http_access allow httpports</pre><br/> 		</div><br/> <br/> Các bạn nên duy trì và allow một số cổng. Dưới đây là một số cổng được cho là an toàn ( mặc định tỏng file squid.conf )<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl safe_ports port 80 # http<br/> acl safe_ports port 21 # ftp<br/> acl safe_ports port 443 563 # https snews<br/> acl safe_ports port 70 # gopher<br/> acl safe_ports port 210 # wais<br/> acl safe_ports port 1025-65535 # unregistered ports<br/> acl safe_ports port 280 # http-mgmt<br/> acl safe_ports port 480 # gss-http<br/> acl safe_ports port 591 # filemaker<br/> acl safe_ports port 777 # multiling http<br/> <br/> http_access deny !safe_ports</pre><br/> 		</div><br/> <br/> <b>6.Hạn chế truy cập thep giao thức :</b> <br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl FTP proto FTP<br/> http_access deny FTP</pre><br/> 		</div><br/> <br/> <b>7.Dùng NCSA kiểm định password</b>:<br/> <br/> đầu tiên tạo một file password,vd <b>/etc/squid/squid_passwd</b><br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>touch /etc/squid/squid_passwd<br/> chmod o+r /etc/squid/squid_passwd</pre><br/> 		</div><br/> Dùng htpasswd để add user vào pass vào file squid_passwd đó<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>htpasswd /etc/squid/squid_passwd vicki<br/> New password:<br/> Re-type new password:<br/> Adding password for user vicki</pre><br/> 		</div><br/> <br/> giờ thêm vào file squid.conf<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>auth_param basic program /usr/lib/squid/ncsa_auth /etc/squid/squid_passwd<br/> acl ncsa_users proxy_auth REQUIRED<br/> http_access allow ncsa_users</pre><br/> 		</div><br/> <br/> Như vậy phải dùng user và pass được add vào file squid_passwd mới có thể truy cập vào internet được.<br/> Cũng có thể kết hợp thời gian để bắt kiểm định pass vào mốc thời gian nhất định ( tham khảo đầu bài )<br/> <br/> <br/> Nếu bạn muốn mọi deny đều có một thông báo cho người dùng biết thì :<br/> Tạo một file deny.php với nội dung tùy bạn, đặt vào /var/www chẳng hạn.<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>acl blacklist url_regex yahoo\.com vietnamnet\.vn<br/> http_access deny blacklist<br/> deny_info domain/deny.php blacklist</pre><br/> 		</div><br/> <br/> Bài viết chỉ lấy VD ở mỗi phần, bạn có thể tùy cơ ứng biến.<br/> Tham khảo thêm nội dung file <b>squid.conf</b> mặc định để hiểu thêm.<br/> <br/> <b>Vickizw</b><br/> </div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=/hvaonline/readingRoom/item/75833.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=/hvaonline/readingRoom/item/75833.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=/hvaonline/readingRoom/item/75833.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=/hvaonline/readingRoom/item/75833.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=/hvaonline/readingRoom/item/75833.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=/hvaonline/readingRoom/item/75833.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=/hvaonline/readingRoom/item/75833.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>



		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/12859.html#75833" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
