<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="description" content="HVA Reading Room">
<meta name="keywords" content=", reading room, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title> - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0" align="center">
	<tr>
        <td width="100%" align="center" valign="middle">
			<a href="http://www.hvaonline.net" title="[Logo]"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" /></a>
		</td>
	</tr>

	<tr>
		<td>
<table cellspacing="0" cellpadding="0" width="80%" align="center" border="0">

		<tr height="15">
			<th colspan="2" class="thportal" align="left"><span class="readingheader">&nbsp;.::Others::.</span></th>
		    <th class="thportal" align="center">
				<span class="readingheader">
					 Khoá và Mở máy tính của bạn bằng USB <a name="topPage" id="topPage"></a>
				</span>
			</th>
		    <th class="thportal" align="right">
				<a href="/hvaonline/posts/list/0/3102.hva#17414" target="_blank">
				<img src="/hvaonline/templates/viet/images/goright.gif" align="absbottom" border="0" alt="Go to original post" title="Go to original post"/></a> 
				<img src="/hvaonline/templates/viet/images/what.gif" align="absbottom" border="0" alt="Author: KVD - Translator:  - Entry Date: 13/02/2009 09:31:03" title="Author: KVD - Translator:  - Entry Date: 13/02/2009 09:31:03"/>
			</th>
		</tr>
</table>

<table cellspacing="0" cellpadding="5" width="80%" align="center" border="0">
		<tr>
		    <td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
							<div class="postbody"><font size='+1'>Khoá và Mở máy tính của bạn bằng USB</font><br/> <br/> Đây là đoạn mã hoàn thiện của PC Lock và hoạt động có vẻ rất tốt. Nó sẽ tự động khoá nếu bạn khởi động lại máy tính.<br/> Tập tin "lock.exe" đặt trong đĩa mềm hoặc USB nhưng tốt nhất là USB và chạy tập tin đó.<br/> <br/> Đoạn mã đầu tiên là "lock.au3"<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>#include&lt;guiconstants.au3&gt;<br/> #include&lt;file.au3&gt;<br/> #include&lt;misc.au3&gt;<br/> <br/> filedelete&#40;"C:\locksearch.exe"&#41;<br/> <br/> fileinstall&#40;"locksearch.exe","C:\locksearch.exe"&#41;<br/> <br/> FileCreateShortcut&#40;"C:\locksearch.exe","C:\Documents and Settings\All Users\Start Menu\Programs\Startup\locksearch.ink"&#41;<br/> <br/> if not ProcessExists&#40;"locksearch.exe"&#41; then run &#40;"c:\locksearch.exe"&#41;<br/>             <br/> Opt&#40;"WinTitleMatchMode", 4&#41;<br/> Opt&#40;"OnExitFunc"&#41;<br/> Opt&#40;"TrayAutoPause",0&#41;<br/> <br/> $hwnd = WinGetHandle&#40;"classname=Progman"&#41;<br/> $user32 = DllOpen&#40;"user32.dll"&#41;<br/> Global Const $lciWM_SYSCommand = 274<br/> Global Const $lciSC_MonitorPower = 61808<br/> Global Const $lciPower_Off = 2<br/> Global Const $lciPower_On = -1<br/> global  $scriptfullpath = @ScriptFullPath<br/> global  $drive = StringLeft&#40;$scriptfullpath, 2&#41; & "\"<br/> <br/> if regread&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Status"&#41; = 1 then <br/>     $scriptfullpath = regread&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Path"&#41;<br/>     global $code = regread&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Code"&#41;<br/>     $drive = StringLeft&#40;$scriptfullpath, 2&#41; & "\"<br/> Else    <br/>     global  $code = _DriveInfo&#40;$drive&#41;<br/> EndIf<br/> <br/> <br/> Regwrite&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Code","REG_SZ",$code&#41;<br/> <br/> While 1<br/>     $msg = guigetmsg&#40;&#41;<br/>     RegWrite&#40;"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System", "DisableTaskMgr", "REG_DWORD", 00000000&#41; <br/>     Regwrite&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Status","REG_DWORD",0&#41;    <br/>     Regwrite&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Path","REG_SZ",$scriptfullpath&#41;<br/>     <br/>     While FileExists&#40;$scriptfullpath&#41; <br/>       Sleep&#40;100&#41;<br/>   WEnd<br/>   <br/>     RegWrite&#40;"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System", "DisableTaskMgr", "REG_DWORD", 00000001&#41;<br/>     Regwrite&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Status","REG_DWORD",1&#41;<br/>     While not &#40; _DriveInfo&#40;$drive&#41; = $code &#41;<br/>     <br/>           While not FileExists&#40;$scriptfullpath&#41;<br/>             BlockInput&#40;1&#41;<br/>             DllCall&#40;$user32, "int", "SendMessage", "hwnd", $hwnd, "int", $lciWM_SYSCommand, "int", $lciSC_MonitorPower, "int", $lciPower_Off&#41;<br/>             Sleep&#40;50&#41;<br/>             WEnd<br/>         <br/>       WEnd<br/>       <br/>     RegWrite&#40;"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System", "DisableTaskMgr", "REG_DWORD", 00000000&#41; <br/>     Regwrite&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Status","REG_DWORD",0&#41;<br/>     DllCall&#40;$user32, "int", "SendMessage", "hwnd", $hwnd, "int", $lciWM_SYSCommand, "int", $lciSC_MonitorPower, "int", $lciPower_On&#41;<br/>     BlockInput&#40;0&#41;<br/> WEnd<br/> Exit<br/> <br/> ; --------------------begin functions------------------<br/> <br/> func lock&#40;&#41;<br/>        While not &#40; _DriveInfo&#40;$drive&#41; = $code &#41;<br/>           RegWrite&#40;"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System", "DisableTaskMgr", "REG_DWORD", 00000001&#41;<br/>           Regwrite&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Status","REG_DWORD",1&#41;<br/>           <br/>           While not FileExists&#40;$scriptfullpath&#41;<br/>             BlockInput&#40;1&#41;<br/>             DllCall&#40;$user32, "int", "SendMessage", "hwnd", $hwnd, "int", $lciWM_SYSCommand, "int", $lciSC_MonitorPower, "int", $lciPower_Off&#41;<br/>             Sleep&#40;50&#41;<br/>           WEnd<br/>       WEnd<br/>       <br/>     RegWrite&#40;"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System", "DisableTaskMgr", "REG_DWORD", 00000000&#41; <br/>     Regwrite&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Status","REG_DWORD",0&#41;<br/>     DllCall&#40;$user32, "int", "SendMessage", "hwnd", $hwnd, "int", $lciWM_SYSCommand, "int", $lciSC_MonitorPower, "int", $lciPower_On&#41;<br/>     BlockInput&#40;0&#41;<br/>        <br/>     Return<br/>    EndFunc<br/>    <br/> <br/> Func _DriveInfo&#40; $drv &#41;<br/>     $keycode = DriveGetFileSystem&#40;$drv&#41;&DriveGetLabel&#40;$drv&#41;&DriveGetSerial&#40;$drv&#41;&DriveGetType&#40;$drv&#41;&DriveSpaceTotal&#40;$drv&#41;&DriveStatus&#40;$drv&#41;<br/>     Return $keycode<br/> EndFunc<br/> <br/> Func OnAutoItExit&#40;&#41; ;;;; TO ACTUALLY EXIT, HOLD {CTRL+LEFTWIN+ALT+SPACE} WHEN YOU EXIT program from tray<br/>     RegWrite&#40;"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System", "DisableTaskMgr", "REG_DWORD", 00000001&#41;<br/>     for $var = 1 to 3000<br/>         if _ispressed&#40;11&#41; and _ispressed&#40;12&#41;and _ispressed&#40;"5B"&#41;and _ispressed&#40;20&#41; then exit            <br/>         Next<br/>     blockinput&#40;1&#41;<br/>     guicreate&#40;"Invalid",@desktopwidth,@desktopheight,0,0,$WS_popup&#41;<br/>     GUISetBkColor&#40;0x000000&#41;<br/>     guictrlcreatelabel&#40;"Invalid Exit Procedure." & @crlf & "Lock is Active.",40,40&#41;<br/>     GUICtrlSetColor&#40;-1,0xffffff&#41;<br/>     winsettrans&#40;"Invalid","",255&#41;<br/>     GUISetState&#40;&#41;<br/>         <br/>         sleep&#40;2000&#41;<br/> <br/>     <br/>     for $var = 255 to 0 step -15<br/>         winsettrans&#40;"Invalid","",$var&#41;<br/>     Next<br/>     guidelete&#40;&#41;<br/>     blockinput&#40;0&#41;<br/>     run&#40;"lock.exe"&#41;   <br/> EndFunc</pre><br/> 		</div><br/> <br/> Đây là đoạn mã của "locksearch.au3"<br/> <span class="quotetxt"><b>Code:</b></span><br/><br/> 		<div class="coded""><br/> 		<pre>#include&lt;guiconstants.au3&gt;<br/> #include&lt;file.au3&gt;<br/> if regread&#40;"HKEY_LOCAL_MACHINE\SOFTWARE\XLock","Status"&#41; = 1 and not processexists&#40;"lock.exe"&#41; then run&#40;"lock.exe"&#41;<br/>     <br/>     <br/> while 1<br/>     winclose&#40;"zzxxzxz"&#41;<br/>     $drives = DriveGetDrive &#40;"REMOVABLE"&#41;<br/>     if not @error then <br/>         if $drives&#91;0&#93; &gt; 0  then <br/>             for $var = 1 to $drives&#91;0&#93;<br/>                 if FileExists&#40;stringtrimright&#40;$drives&#91;$var&#93;,1&#41;&":\lock.exe"&#41; and ProcessExists&#40;"lock.exe"&#41;=0 then<br/>                     run&#40;stringtrimright&#40;$drives&#91;$var&#93;,1&#41;&":\lock.exe"&#41;<br/>                     while 1<br/>                         sleep&#40;100&#41;<br/>                         if fileexists&#40;stringtrimright&#40;$drives&#91;$var&#93;,1&#41;&":\lock.exe"&#41;=0 then <br/>                             ;gray&#40;&#41;<br/>                             exitloop                            <br/>                         EndIf<br/>                     WEnd<br/>                     <br/>                     exitloop<br/>                 EndIf<br/>                 Next<br/>             EndIf<br/>         EndIf<br/>         sleep&#40;100&#41;<br/> WEnd<br/> <br/> func gray&#40;&#41;<br/>     $gui = guicreate&#40;"zzxxzxz",@DesktopWidth,@DesktopHeight,0,0,$WS_POPUP&#41;<br/>     guisetbkcolor&#40;0x000000&#41;<br/>     guisetstate&#40;@SW_HIDE&#41;<br/>     WinSetTrans&#40;"zzxxzxz","",0&#41;<br/>     guisetstate&#40;@SW_SHOW&#41;<br/>     for $var = 0 to 255 step 15<br/>         WinSetTrans&#40;"zzxxzxz","",$var&#41;<br/>     Next<br/>     sleep&#40;5000&#41;<br/>     guidelete&#40;&#41;<br/> endfunc</pre><br/> 		</div><br/> <br/> Khuyến cáo khi dùng... Bạn chỉ nên dùng khi sử dụng công cụ lưu trữ là USB mà thôi.</div>
						</td>
					</tr>

					<tr>
						<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/readingRoom/item/17414.hva"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/readingRoom/item/17414.hva"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/readingRoom/item/17414.hva"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/readingRoom/item/17414.hva"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/readingRoom/item/17414.hva"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/17414.hva"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/readingRoom/item/17414.hva"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
					</tr>
				</table>
			</td>
		</tr>

		<tr>
			<td align="left" colspan="2" class="readingborderBottom">
				<table cellspacing="0" cellpadding="10" width="95%" align="center" border="0">
					<tr>
						<td align="left">
						<div class="postbody"><b>Other posts in the same group:</b></div><br />
									<div class="gen"><a href="/hvaonline/readingRoom/item/17407.hva">Viết ứng dụng đơn giản với AutoIt</a></div>
									<div class="gen"><b>Khoá và Mở máy tính của bạn bằng USB</b></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/17420.hva">AIM Bot cho Shooting Flash Game</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/17777.hva">Mega Tokyo Comic Ripper</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/17778.hva">Windows Space Screensaver</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/17780.hva">Gradient Effects on Text</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/17781.hva">Tailchat FTP</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/17783.hva">Virtual Desktops</a></div>
									<div class="gen"><a href="/hvaonline/readingRoom/item/30517.hva">Sodoku Game</a></div>
						</td>
					</tr>
				</table>
			</td>
		</tr>


		<tr>
			<td align="left" valign="top">
				<a href="#topPage"><img src="/hvaonline/templates/viet/images/goup.gif" align="absbottom" border="0" alt="Go to top" title="Go to top"></a>
				<a href="/hvaonline/posts/list/0/3102.hva#17414" target="_blank"><img src="/hvaonline/templates/viet/images/goright.gif" border="0" align="absbottom" alt="Go to original post" title="Go to original post"></a> 
				&nbsp;
			</td>
			<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/readingRoom/show/'+ this.options[this.selectedIndex].value +'.hva'; }" name="select">
						<option value="0" selected="selected">Go to Category</option>	
						<option value="0">------------------------</option>	
								<option value="1">Defense</option>
								<option value="2">Exploit</option>
								<option value="3">Reverse Engineering</option>
								<option value="4">*nix</option>
								<option value="5">Windows</option>
								<option value="6">Networking</option>
								<option value="7">Others</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
		</tr>
</table>
<script type="text/javascript">
		var ctlTop = false;
		var ctlBt = false;

		function activateControllerTop()
		{
			ctlTop = !ctlTop;
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");
			document.getElementById("controllerTop").style.display = (ctlTop ? "" : "none");

			if (ctlTop) {
				document.location = document.location + "#ctlTop";
			}
		}

		function activateControllerBottom()
		{
			ctlBt = !ctlBt;
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");
			document.getElementById("controllerBottom").style.display = (ctlBt ? "" : "none");

			if (ctlBt) {
				document.location = document.location + "#ctlBt";
			}
		}
</script>

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
