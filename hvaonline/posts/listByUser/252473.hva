<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by tuanksor, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by tuanksor - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.hva">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.hva">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.hva">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.hva">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.hva">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.hva"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.hva">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.hva">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.hva">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.hva', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/252473.hva" name="top" class="maintitle" id="top">Messages posted by: tuanksor</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/252473.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/252473.hva">Profile for tuanksor</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/252473.hva">Messages posted by tuanksor</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45758.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45758/281403.hva#281403,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">cảm ơn myquartz đã giải thích rõ ràng cho mình hiểu vấn đề,<br/> như myquartz nói việc phân rõ ràng mount point nào cho dạng truy cập nào thì mình thấy nó thích hợp nếu ứng dụng web là của mình, mình điều chỉnh thế nào cũng đc. Nhưng do hiện tại nó là mô hình shared host, việc điều chỉnh cho từng host tương ứng chắc là k khả thi, <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">. nó đúng như là cái nồi lẩu thật <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"><br/> Không biết là có ứng dụng nào có thể cache lại php file lên trên web server để nó có thể đọc từ local cho lần thứ 2 thay vì phải truy xuất vào nfs k nhỉ<br/> mình có dùng cachefs nhưng thấy nó cache tùm lum hết, mà hiệu năng cũng k cải thiện đc mấy<br/> xin cảm ơn mọi ng đã xem và tư vấn giúp mình</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45758.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45758/281358.hva#281358,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">myquartz wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">tuanksor wrote:</cite><br>
<blockquote><br/> - Source code đặt tại NFS (mount nfs v3)<br/> &nbsp;
</blockquote><br/><br/> <p></p>
<cite class="blockquote">tuanksor wrote:</cite><br>
<blockquote><br/> 2. Mình có test qua performance giữa apache, php, local storage(1) vs apache, php, nfs storage(2) thì thấy performance (1) &gt; (2), sử dụng strace php-cgi để count syscall khi chạy trên nfs thì thấy các <b>syscall access, open có % lớn hơn</b> khi chạy local storage (<b>ở local storage thì syscall munmap lớn</b>). Sử dụng cachefs & nhưng cũng không ăn thua. Nên có nghĩ đến việc đổi mô hình, nhưng mắc phải vấn đề sync, dữ liệu hosting rất nhiều. với lại đang là mô hình production, thay đổi thì chắc rất cực.<br/> Mình tập trung vấn đề load avg tại web server do chỉ có 1 con server ấy bị, các con khác còn lại chạy bình thường&nbsp;
</blockquote><br/><br/> Có vẻ như 2 phần bôi đậm kia, kết hợp thông tin NFS v3 là vấn đề của bạn.<br/> Ứng dụng của bạn khi chạy local storage nó sử dụng IO kiểu mmap/munmap, một kiểu IO có tốc độ cao và trễ thấp.<br/><br/> Khi mount với NFS v3, thì mmap không được hỗ trợ, phải fail-back về kiểu open/read bình thường (nên syscall 2 cái này nhiều hơn). Có vài thảo luận về vấn đề NFS liên quan đến mmap này.<br/><br/> Kể cả khi dùng open/read thì cũng có vấn đề. Do NFS là 1 share file system nên yếu tố concurrency được đảm bảo, chính nó gây nhiều overhead xử lý các IO, nhất là trong trường hợp read+write IO. Đó chính là nguyên nhân dẫn tới IO wait cao hơn local storage.<br/><br/> Bạn không nói rõ ngoài source code ra thì còn content nào khác (ví dụ images, css...) phải lấy ra từ disk không, ứng dụng chỉ source code/content read only hay cả read/write.<br/><br/> Vì thế, giải pháp là<br/> 1. bạn phải từ bỏ NFS, phải dùng local storage + sync.<br/> 2. bạn phải tuning/sửa lại ứng dụng PHP hoặc cách dùng module, sao cho phân rõ kiểu IO với từng module (read hay read/write) để dùng NFS cache được, (kiểm tra lại ứng dụng mount NFS dạng read-only và tùy chọn nolock, bật cache nữa).<br/> 3. Ứng dụng phải sửa hoặc NFS mount option phải chỉnh lại để truy cập IO tối ưu cho open/read, tránh locking hoặc cache-sync giữa các node mount lên NFS server.<br/><br/> Ref: Google 1 lúc thì ra khá nhiều thông tin liên quan đến NFS mmap. Ví dụ có 1 thảo luận:<br/><span class="link"> http://stackoverflow.com/questions/10367577/mmap-file-shared-via-nfs</span><br/> &nbsp;
</blockquote><br/> Cảm ơn myquartz đã tư vấn,<br/> Về source code và tất cả content đều đặt tại 1 folder trên nfs mount, read lẫn write<br/> 1. Vì hiện nó đang vận hành, mô hình xuyên xuốt từ phía khách hàng đến cả phần quản lý, nên việc thay đổi như vậy mình thấy rất khó mặc dù là muốn thế<br/> 2,3. Đây là option mount nfs hiện tại đang sử dụng:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>rw,relatime,vers=3,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,mountaddr=10.0.0.x,mountvers=3,mountport=43882,mountproto=udp,local_lock=none,addr=10.0.0.x 0 0</pre>
</div><br/> trước có dùng option fsc và chạy cachefs nhưng mình bỏ do mình test đi test lại thấy vẫn như nhau k có tác dụng gì lắm.<br/> <blockquote> bạn phải tuning/sửa lại ứng dụng PHP hoặc cách dùng module, sao cho phân rõ kiểu IO với từng module (read hay read/write) để dùng NFS cache được&nbsp;
</blockquote><br/> mình k rõ ý này lắm, myquartz có thể tư vấn thêm ở cái đoạn này ko <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> ?<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45758.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45758/281357.hva#281357,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">Ikut3 wrote:</cite><br>
<blockquote>Hello Tuan (sorry vì mình reply trễ)<br/><br/> Nếu theo các thông số bạn đưa ra trên Webserver này, thì tuyệt nhiên mình không thấy có gì bất thường. Thậm chí là còn nhanh nữa là đằng khác. Đoán già đoán non thôi thì bạn thử gather lại với các thông tin tương tự trên các server khác để so sánh xem có sự chênh lệch ở điểm nào không ? Mình nghĩ nên chạy cho các server ở thời điểm có lượng người truy cập.<br/><br/> Mình chỉ hơi confuse ở 2 điểm này, nếu bạn tiếp tục được cùng mình thì tốt<br/><br/> 1. Bạn có hệ thống monitoring nào để lấy các thông tin của các server không ? Mình nghĩ sử dụng graph trong các trường hợp này sẽ thấy được nhiều mối tương quan hơn là chỉ dựa vào các thông số<br/><br/> 2. Bạn có đảm bảo rằng Server chậm đang cài giống 100% cấu hình cả mềm lẫn cứng đối với các server khác ?<br/><br/> Kinh nghiệm của mình trong những case mà tất cả mọi thứ đều có sự logic như thế này là "so sánh & so sánh". Có thể 1 vài thông số tunning của application dựa vào phần cứng đã bị sai lệch đi khi chạy trên những hardware profile khác nhau ?<br/><br/> Mình có dùng thử 1 công cụ mới được giới thiệu ở Hacker News là <span class="link"> <span class="link"> http://www.sysdig.org/</span></span>. Mình thấy có sự khác biệt rất nhiều so với việc tự gather từ những thông số rời rạc như disk - ram - cpu thông qua các câu lệnh thường dùng. Với sysdig mình nắm được rõ mọi hành vi của bất kì request nào thông suốt từ application đến kernel, tiêu tốn bao nhiêu phần trăm tài nguyên hệ thống. Biết đâu sự bình thường trong những tình huống bất thường diễn ra từ đó.<br/><br/> Thân<br/><br/> &nbsp;
</blockquote><br/> Hi Ikut3,<br/> thanks đã reply<br/> 1. Hệ thống sử dụng nagios & nagios grapth để thu thập các thông tin của server. Nhưng khi dựng server lên và chạy đã xảy ra sự cố như trên, k thể để chạy lâu dài mà mình phải ngắt ra khỏi hệ thống.<br/> 2. Mình không đảm bảo 100% là phần cứng giống nhau nhưng tương đương nhau về lượng (CPU, mem, Disk, ....), 100% về config giống nhau.<br/> Hiện tại đã thay thế 1 con server khác, cũng với những config như vậy nhưng lại chạy bình thường, k vấn đề gì xảy ra. Nên nghĩ chắc vấn đề là ở phần cứng nhưng k biết troubleshoot như thế nào cho chính xác mà thôi <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> Thanks Ikut3 về cái tool sysdig (biết thêm 1 món <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">)</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45758.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45758/281284.hva#281284,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Trước tiên mình xin cảm ơn Ikut3 đã tư vấn cho mình, các vấn đề bạn đặt ra mình xin trả lời:<br/> 1. Kết nối giữa NFS storage & Web server: 1000Mbps, bw dùng iperf để đo (Đo lúc web server chưa có http traffic):<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># iperf -c 10.0.x.y -P 1 -i 1
&#91; ID&#93; Interval Transfer Bandwidth
&#91; 3&#93; 0.0- 1.0 sec 111 MBytes 932 Mbits/sec
&#91; 3&#93; 1.0- 2.0 sec 87.9 MBytes 737 Mbits/sec
&#91; 3&#93; 2.0- 3.0 sec 110 MBytes 925 Mbits/sec
&#91; 3&#93; 3.0- 4.0 sec 110 MBytes 926 Mbits/sec
&#91; 3&#93; 4.0- 5.0 sec 111 MBytes 929 Mbits/sec
&#91; 3&#93; 5.0- 6.0 sec 109 MBytes 916 Mbits/sec
&#91; 3&#93; 6.0- 7.0 sec 110 MBytes 923 Mbits/sec
&#91; 3&#93; 7.0- 8.0 sec 111 MBytes 930 Mbits/sec
&#91; 3&#93; 8.0- 9.0 sec 111 MBytes 930 Mbits/sec
&#91; 3&#93; 9.0-10.0 sec 108 MBytes 909 Mbits/sec
&#91; 3&#93; 0.0-10.0 sec 1.05 GBytes 906 Mbits/sec</pre>
</div><br/> iostat tại NFS server (đang có io từ 3 web server):<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># zpool iostat -v
capacity operations bandwidth
pool alloc free read write read write
rpool 23.1G 905G 0 12 5.25K 115K
c2t0d0s0 23.1G 905G 0 12 5.25K 115K
zpool1 1003G 1.74T 288 119 2.29M 1.25M
c2t1d0 334G 594G 96 18 781K 240K
c2t2d0 334G 594G 96 18 782K 240K
c2t3d0 334G 594G 96 18 780K 240K
logs
c2t75d0 13.9M 111G 0 64 0 556K</pre>
</div><br/> - NFS đang chạy trên bundle ZFS (OS: Unix - Openindiana), chạy raid 1, sử dụng Zil SSD cho logs pool<br/> 2. Mình có test qua performance giữa apache, php, local storage(1) vs apache, php, nfs storage(2) thì thấy performance (1) &gt; (2), sử dụng strace php-cgi để count syscall khi chạy trên nfs thì thấy các syscall access, open có % lớn hơn khi chạy local storage (ở local storage thì syscall munmap lớn). Sử dụng cachefs & nhưng cũng không ăn thua. Nên có nghĩ đến việc đổi mô hình, nhưng mắc phải vấn đề sync, dữ liệu hosting rất nhiều. với lại đang là mô hình production, thay đổi thì chắc rất cực.<br/> Mình tập trung vấn đề load avg tại web server do chỉ có 1 con server ấy bị, các con khác còn lại chạy bình thường</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45758.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45758/281273.hva#281273,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hi mọi người, hiện tại e đang gặp khó khăn về vấn đề troubleshoot high load avg, mong mọi người giúp em.<br/> Mô hình phát thảo của e như sau:<br/> LVS -&gt; Webserver(Apache) -&gt; NFS storage<br/> Web server: - Ram 32G, CPU 2.40GHz, 8 core, HDD raid 1 (nhưng đang chạy 1 ổ do 1 ổ hỏng đã rút ra)<br/> - OS: Centos 6.5, Apache chạy mod worker, suexec, php handler: php-cgi<br/> - Đã rebuild kernel giảm time_wait còn 15s<br/> - Source code đặt tại NFS (mount nfs v3)<br/> load avg sau 2 phút cho http traffic đi vào server này: <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>load average: 44.91, 25.12, 10.04</pre>
</div><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>top - 09:47:36 up 3 days, 11:21, 2 users, load average: 44.91, 25.12, 10.04
Tasks: 261 total, 1 running, 259 sleeping, 0 stopped, 0 zombie
Cpu&#40;s&#41;: 14.9%us, 4.8%sy, 0.0%ni, 14.5%id, 65.1%wa, 0.0%hi, 0.5%si, 0.0%st
Mem: 32869904k total, 2728816k used, 30141088k free, 11176k buffers
Swap: 16777208k total, 0k used, 16777208k free, 951004k cached
PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND
18985 17674 20 0 396m 51m 25m D 14.6 0.2 0:00.81 php-cgi
19296 19037 20 0 448m 89m 11m D 13.0 0.3 0:00.39 php-cgi
19259 10944 20 0 389m 38m 19m D 6.0 0.1 0:00.18 php-cgi
19112 18034 20 0 398m 56m 27m D 5.0 0.2 0:00.64 php-cgi
19244 10944 20 0 395m 50m 25m D 4.7 0.2 0:00.25 php-cgi
19245 10944 20 0 395m 51m 26m D 4.7 0.2 0:00.25 php-cgi
19252 10944 20 0 391m 43m 22m D 4.7 0.1 0:00.21 php-cgi
19256 19389 20 0 382m 27m 14m D 4.3 0.1 0:00.13 php-cgi
19246 12969 20 0 387m 34m 17m D 4.0 0.1 0:00.27 php-cgi
19239 13264 20 0 394m 49m 24m D 3.7 0.2 0:00.24 php-cgi
19241 12969 20 0 387m 34m 17m D 3.7 0.1 0:00.27 php-cgi
19291 18253 20 0 378m 19m 10m D 3.3 0.1 0:00.10 php-cgi
19255 17569 20 0 380m 22m 12m D 3.0 0.1 0:00.09 php-cgi
19290 15184 20 0 378m 19m 10m D 3.0 0.1 0:00.09 php-cgi
19211 10944 20 0 401m 62m 31m D 2.7 0.2 0:00.33 php-cgi
19258 17691 20 0 378m 19m 10m D 2.7 0.1 0:00.08 php-cgi
19292 10544 20 0 379m 19m 10m D 2.7 0.1 0:00.08 php-cgi
19294 18371 20 0 378m 18m 10m D 2.7 0.1 0:00.08 php-cgi
19295 18371 20 0 378m 18m 10m D 2.7 0.1 0:00.08 php-cgi
19311 15905 20 0 379m 20m 11m D 2.7 0.1 0:00.08 php-cgi
19224 19047 20 0 382m 27m 14m D 2.3 0.1 0:00.20 php-cgi
19310 18371 20 0 378m 18m 10m D 2.3 0.1 0:00.07 php-cgi
19313 16031 20 0 378m 18m 10m D 2.3 0.1 0:00.07 php-cgi
19215 15905 20 0 398m 56m 28m D 2.0 0.2 0:00.31 php-cgi
19216 15905 20 0 398m 56m 28m D 2.0 0.2 0:00.30 php-cgi
19217 15530 20 0 386m 34m 17m D 2.0 0.1 0:00.18 php-cgi</pre>
</div><br/> io wait lên rất cao dẫn đến các process chờ lâu nên sinh ra rất nhiều process php-cgi<br/> kết quả e test read/write lên HDD khi không chạy apache;<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># hdparm -I /dev/sda | grep speed
* Gen1 signaling speed &#40;1.5Gb/s&#41;
* Gen2 signaling speed &#40;3.0Gb/s&#41;</pre>
</div><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># hdparm -tT /dev/sda
/dev/sda:
Timing cached reads: 15424 MB in 2.00 seconds = 7724.50 MB/sec
Timing buffered disk reads: 402 MB in 3.01 seconds = 133.72 MB/sec</pre>
</div><br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># dd if=/dev/zero of=/tmp/test.bin bs=8k count=256k
262144+0 records in
262144+0 records out
2147483648 bytes &#40;2.1 GB&#41; copied, 1.84109 s, 1.2 GB/s</pre>
</div><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># dd of=/dev/null if=/tmp/test.bin bs=8k count=256k
262144+0 records in
262144+0 records out
2147483648 bytes &#40;2.1 GB&#41; copied, 0.485696 s, 4.4 GB/s</pre>
</div><br/> Mong mọi người giúp đỡ e vấn đề này để có thể detect đc do đâu, e xin cảm ơn.<br/> PS: Với cấu hình tương tự ở một server khác hoạt động rất bình thường nên nghi ngờ vấn đề từ hardware ^^<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45466.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45466/279821.hva#279821,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Lỗi 502 thường do frontend (nginx as proxy) nhận đc invalid respone từ backend (apache) (có thể apache ko chạy, hay bị drop bởi iptables). Bạn kiểm tra truy cập từ nginx -&gt; apache xem thế nào<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#curl -IL<span class="link"> http://172.20.20.238:8080</span></pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45466.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45466/279813.hva#279813,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Bạn kiểm tra lại xem apache có đang hoạt động bình thường không (truy cập trực tiếp ko qua proxy), kiểm tra iptables tại server apache đã accept port 8080 chưa.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45408.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45408/279483.hva#279483,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>ls -nR &gt; export.txt</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45408.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45408/279477.hva#279477,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Bạn thử dùng<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#find &lt;ten folder&gt; -type d | xargs ls -nd &gt; export.txt</pre>
</div><br/> thử có phải cái bạn cần ko</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45380.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45380/279458.hva#279458,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hiện tại mình đã tìm được file gây ra bottle neck.<br/> Khi xảy ra sự cố, mình tail access log của uid này, và tìm ra được file bot php<br/> Bên trong file đơn giản chỉ là 1 vòng lặp vô tận while(1)<br/> nội dung bên trong while dùng các func fsockopen() , fwrite() và fclose() để mở socket gửi data ra ngoài<br/> data là chuỗi ký tự XXXXX (khớp với payload khi mình capture đc bằng tcpdump)<br/><br/> Cảm ơn quanta rất nhiều</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45380.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45380/279444.hva#279444,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">mình cảm ơn quanta rất nhiều<br/> Sau một buổi nín thở nằm chờ, đã xác định được uid gây ra hiện tượng trên<br/> Khi xảy ra hiện tượng bottle neck tại firewall, xác định được des ip, mình vào webserver bật iptables lên<br/> tạo 1 rule mới:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># iptables -t filter -I OUTPUT -d 112.78.1.194 -j LOG --log-prefix=&quot;tracking: &quot;</pre>
</div><br/> nhằm để xác định thời gian<br/> tiếp tục tạo rule audit:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#auditctl -d exit,always -F arch=b64 -S socket -k SOCKET -F a0=2 -F a1=2</pre>
</div><br/> để im trong ~1 phút<br/> sau đó bỏ 2 rule trên, đổ log audit vào 1 file mới<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#ausearch -sc socket | grep 'a0=2' | grep 'a1=2' &gt; audit.track.log</pre>
</div><br/> hiện tượng xảy ra lúc ~10:54 (theo log kernel), mình lọc khoảng thời gian này<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#grep &quot;^10:5&#91;4-6&#93;&quot; audit.track.log &gt; audit.track1.log</pre>
</div><br/> nhưng lượng log vẫn còn quá lớn<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># grep &quot;^10:5&#91;4-6&#93;&quot; audit.track1.log | wc -l
55921</pre>
</div><br/> nên mình lọc ra xem uid nào mở socket nhiều nhất trong khoảng thời gian 10:54 -10:56<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#grep &quot;^10:5&#91;4-6&#93;&quot; audit.track1.log | awk '{print $15,$16,$24,$25,$26}' | sort -k1 | uniq -c | sort -rn | head
55084 uid=1xxxx gid=x00000 ses=38855 comm=&quot;php-cgi&quot; exe=&quot;/usr/bin/php-cgi&quot;
85 uid=xxxxx gid=x00000 ses=38855 comm=&quot;php-cgi&quot; exe=&quot;/usr/bin/php-cgi&quot;
34 uid=xxxxx gid=x00000 ses=38855 comm=&quot;php-cgi&quot; exe=&quot;/usr/bin/php-cgi&quot;
.....</pre>
</div><br/> lúc này coi như khoanh vùng được là do tên nào<br/> cd đến homedir của uid này: có source web chạy joomla<br/> vẫn chưa thể xác định được file nào<br/> mình thử xem log của những web này, thấy có nhiều request lạ như thế này<br/> 80.242.139.195 - - [10/Jan/2014:10:53:53 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xx<br/> 80.242.139.195 - - [10/Jan/2014:10:55:15 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xx<br/> 80.242.139.195 - - [10/Jan/2014:10:56:36 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xx<br/> 80.242.139.195 - - [10/Jan/2014:10:57:58 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xx<br/> 80.242.139.195 - - [10/Jan/2014:10:59:19 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xx<br/> 80.242.139.195 - - [10/Jan/2014:11:00:41 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xx<br/> 80.242.139.195 - - [10/Jan/2014:11:02:02 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xx<br/> 80.242.139.195 - - [10/Jan/2014:11:03:23 +0700] &quot;POST /tmp/b.php HTTP/1.1&quot; 200 0 &quot;-&quot; &quot;-&quot; 10.0.0.1xxx<br/><br/> trong homedir/tmp, mình tìm ra đc 2 file (file đính kém) trong đó có 1 con webshell <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom"><br/> nhưng không biết có phải file b.php gây ra hiện tượng bottle neck hay ko (còn chính xác file nằm trong homedir của uid trên, vì trong lúc xảy ra hiện tượng, mình đổi tên cái homedir đi thì ngắt ngay hiện tượng bottle neck )<br/> hiện mình định dùng audit track (chờ xảy ra hiện tượng ở lần tiếp theo) toàn bộ file trong homdir của user này,<br/> auditctl -w /homedir-uid/ -p rx<br/> mong sẽ xảy ra hiện tượng trên sớm.<br/> (cho mình hỏi có cách nào tối ưu hơn không <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> )<br/><br/><span class="link"> http://www.mediafire.com/download/dls41n3bdk7uh76/file.zip</span></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45380.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45380/279415.hva#279415,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">mình cảm ơn quanta, mặc dù chưa gặp lại cái hiện tượng trên để mình thực hiện tracking bằng audit, mình có thử nghiệm với rule quanta hướng dẫn, sau khi add rule khoảng 15s, dùng ausearch: # ausearch -sc socket<br/> kết quả quá lớn, và toàn bộ các process hầu như là suexec và php-cgi (vì webserver chạy rất nhiều website)<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># ausearch -sc socket | wc -l
63468</pre>
</div><br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#ausearch -sc socket
time-&gt;Thu Jan 2 20:47:33 2014
type=SYSCALL msg=audit&#40;1388670453.581:284435&#41;: arch=c000003e syscall=41 success=yes exit=3 a0=1 a1=80801 a2=0 a3=ffffffffff
ffffff items=0 ppid=30299 pid=3651 auid=520 uid=48 gid=48 euid=0 suid=0 fsuid=0 egid=48 sgid=48 fsgid=48 tty=&#40;none&#41; ses=388
55 comm=&quot;suexec&quot; exe=&quot;/usr/sbin/suexec&quot; key=&quot;SOCKET&quot;
time-&gt;Thu Jan 2 20:47:33 2014
type=SYSCALL msg=audit&#40;1388670453.584:284436&#41;: arch=c000003e syscall=41 success=yes exit=4 a0=2 a1=2 a2=0 a3=7fff17818960 i
tems=0 ppid=3305 pid=3649 auid=520 uid=15382 gid=200000 euid=15382 suid=15382 fsuid=15382 egid=200000 sgid=200000 fsgid=200
000 tty=&#40;none&#41; ses=38855 comm=&quot;php-cgi&quot; exe=&quot;/usr/bin/php-cgi&quot; key=&quot;SOCKET&quot;</pre>
</div><br/> Nếu xảy ra hiện tượng như ở câu hỏi, khi mình track được dữ liệu với số lượng như trên, không biết phải soi thế nào mới ra đúng cái process hay uid,pid,... mình cần tìm không <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45380.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45380/279382.hva#279382,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cảm ơn myquartz, mà với lệnh netstat bạn đưa ra thì chỉ xem được process nào đang LISTEN thôi, mình cần tìm ra process đã thiết lập kết nối ra bên ngoài.<br/> Thêm thông tin là tại webserver, net.ipv4.ip_forward = 0, nên mình chắc rằng không có kết nối nào đi qua nó được, chỉ có vào ra thôi</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45380.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45380/279363.hva#279363,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Các bạn cho mình hỏi làm sao để tìm được 1 process id nào đang mở 1 udp port.<br/> Mình sử dụng netstat nhưng tại column process_id/process_name hiển thị là <font color='orange'>-</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># netstat -np --protocol=inet | grep 101.99.6.87
udp 0 0 10.0.0.xxx:44431 101.99.6.87:53 ESTABLISHED -</pre>
</div><br/> mình sử dụng lsof, nhưng không ra kết quả gì<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#port=`netstat -np --protocol=inet | grep 101.99.6.87 |awk '{print $4}' | cut -d: -f2` && lsof -i :$port</pre>
</div><br/><br/> (hơi ngoài lề với câu hỏi nhưng cho mình tiện hỏi luôn)<br/> Sở dĩ mình cần tìm process và file đang sử dụng để xác định nguyên nhân của việc mạng bị bottle neck.<br/> Sơ đồ mạng đơn giản như sau: Wan&lt;---&gt; eth0-LVS(nat)-eth1 &lt;---&gt; Webserver, cổng eth0 100Mb, eth1 1000Mb<br/> Tại LVS, mình chạy<br/> # iftop -i eth0<br/> Kết quả show ra top là ip 101.99.6.87 &lt;-&gt; 123.162.233.1 (ip wan lvs) với TX &gt; 90Mb, RX: &lt; 1Mb<br/> # iftop -i eth1<br/> Kết quả show ra top là ip 101.99.6.87 &lt;-&gt; 10.0.0.xxx (ip webserver) với TX &gt; 900Mb, RX: &lt; 1Mb<br/> Mình sử dụng tcpdump tại LVS :<br/> #tcpdump -n -vv host 101.99.6.87 -i eth1 -w 101.99.6.87.pcap<br/> Dùng wireshark xem gói tin thấy có 2 dạng gói tin, trong đó có 1 gói là malform packet dns(mình ko rõ cái dạng gói tin này là gì, tra google 1 tí thì mình đoán có lẽ server mình bị dính con bot gì rồi, <font color='orange'>DNS malformed packet flood</font>,<span class="link"> http://www.iss.net/security_center/reference/vuln/DNS_Malformed_Flood.htm</span> <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom"> ) file chứa gói tin mình export 2 gói ra file txt:<span class="link"> https://www.mediafire.com/?le1d0m6w2zj3h2a</span><br/> Mình đã dùng iptables Drop ip này:<br/> #iptables -t filter -I FORWARD 1 -d 101.99.6.87 -j DROP<br/> Lúc này traffic out từ ip 123.162.233.1 -&gt; 101.99.6.87 ở eth0 ko còn nữa, nhưng traffic out ở eth1 vẫn còn, nhưng RX = 0, TX &gt; 900Mb<br/> À còn ip 101.99.6.87 ko phải lúc nào cũng là ip đó, có lúc nó lại ra ip khác với trường hợp tương tự<br/> Rất mong mọi người có thể xem qua và giúp mình, chân thành cảm ơn <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44853.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44853/276675.hva#276675,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hiện tại mình recompile proftpd với module mod_clamav version 0.11rc<br/><br/> Quá trình biên dịch hoàn toàn bình thường và đã đưa được module clamav vào proftpd<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&#91;root@cntt proftpd-1.3.2&#93;# proftpd -vv
ProFTPD Version: 1.3.2 &#40;stable&#41;
Scoreboard Version: 01040002
Built: Mon Jun 17 14:34:36 ICT 2013
Loaded modules:
mod_cap/1.0
mod_vroot/0.8.5
mod_clamav.c
mod_ident/1.0
mod_facts/0.1
mod_delay/0.6
mod_site.c
mod_log.c
mod_ls.c
mod_auth.c
mod_auth_file/0.8.3
mod_auth_unix.c
mod_xfer.c
mod_core.c</pre>
</div><br/><br/> sau đó mình config file proftpd.config với các tham số:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>...
&lt;Global&gt;
AllowOverwrite yes
&lt;IfModule mod_clamav.c&gt;
ClamAV on
ClamServer 127.0.0.1
ClamPort 3310
&lt;/IfModule&gt;
&lt;/Global&gt;
...</pre>
</div><br/> clamd đã chạy:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&#91;root@cntt proftpd-1.3.2&#93;# netstat -nlp | grep clamd
tcp 0 0 127.0.0.1:3310 0.0.0.0:* LISTEN 3638/clamd</pre>
</div><br/> Sau đó mình chạy proftpd ở chế độ debug level 10, dùng trình ftp client đăng nhập, upload 1 file virus lên server<br/> Kết quả là clamav đã remove file này. Đến đây mọi thứ OK<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>...
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - Going to virus scan absolute filename = '/home/proftpd/eicar.com' with relative filename = '/eicar.com'.
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - Clamd did not respond to fgets &#40;2&#41;: No such file or directory
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - mod_clamav/0.11rc: Connecting to remote Clamd host '127.0.0.1' on port 3310
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - ROOT PRIVS at mod_clamav.c:227
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - ROOT PRIVS: ID switching disabled
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - PRIVS_RELINQUISH: ID switching disabled
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - Successfully reconnected to Clamd.
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - mod_clamav/0.11rc: Virus 'Eicar-Test-Signature' found in '/home/proftpd/eicar.com'
...</pre>
</div><br/><br/> Sau đó e config mod_vroot (đã biên dịch cùng với mod_clamav) cho proftpd:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>...
&lt;IfModule mod_vroot.c&gt;
VRootEngine on
VRootOptions allowSymlinks
&lt;/IfModule&gt;
DefaultRoot ~
...</pre>
</div><br/><br/> Tiếp theo chạy proftpd ở chế độ debug level 10, dùng ftp client upload file virus cũ lên, proftpd có gọi clamd scan, nhưng sai path của file, nên clamd báo no such file or dir...nên ko diệt đươc<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>...
localhost &#40;113.10.2.149&#91;113.160.226.149&#93;&#41; - mod_clamav/0.11rc: Connecting to remote Clamd host '127.0.0.1' on port 3310
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - ROOT PRIVS at mod_clamav.c:227
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - ROOT PRIVS: ID switching disabled
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - PRIVS_RELINQUISH: ID switching disabled
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - Successfully reconnected to Clamd.
localhost &#40;113.10.2.149&#91;113.10.2.149&#93;&#41; - mod_clamav/0.11rc: Clamd Error: /eicar.com: lstat&#40;&#41; failed: No such file or directory. ERROR
...</pre>
</div><br/><br/> Mình có coi qua trang này<span class="link"> https://forums.proftpd.org/smf/index.php?topic=3768.0</span><br/> Nhưng cũng chẳng biết debug cái mod_clamav như thế nào<br/> Mong mọi người giúp đỡ, đê có thể dùng mod_clamav và mod_vroot cho proftpd<br/> Xin cảm ơn </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/43883.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/43883/273525.hva#273525,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Còn phần nữa làm nốt đi ngtrongtri</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44240.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44240/273310.hva#273310,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hi anh quanta, đã fix lỗi này<br/> Do ko tồn tại file /etc/barnyard2/barnyard2.waldo nên bị báo lỗi (nghĩ là nó tự sinh khi chạy)<br/> Thanks anh!!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44240.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44240/273275.hva#273275,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mình cài đặt Snort+Barnyard2+base với các thông số:<br/><br/> <font color='red'>snort-2.9.4-1:</font><br/> <font color='orange'>- /etc/snort/snort.conf:</font><br/> ....<br/> output unified2: filename snort.log, limit 128, mpls_event_types, vlan_event_types<br/> ....<br/><br/> <font color='orange'>- /etc/sysconfig/snort:</font><br/> INTERFACE=eth0<br/> CONF=/etc/snort/snort.conf<br/> USER=snort<br/> GROUP=snort<br/> PASS_FIRST=0<br/> LOGDIR=/var/log/snort<br/> ALERTMODE=fast<br/> DUMP_APP=1<br/> BINARY_LOG=1<br/> NO_PACKET_LOG=0<br/> PRINT_INTERFACE=0<br/> SYSLOG=/var/log/messages<br/> SECS=5<br/><br/> <font color='red'>barnyard2-1.9</font><br/> <font color='orange'>- /etc/barnyard2/barnyard2.conf</font><br/> .....<br/> config hostname: localhost<br/> config interface: eth0<br/> config waldo_file: /etc/barnyard2/barnyard2.waldo<br/> input unified2<br/> output alert_fast: stdout<br/> output database: log, mysql, user=root password=123456 dbname=snortdb host=localhost<br/><br/> Snort đã chạy bình thường và đã alert vào file /var/log/snort/alert<br/><br/> Mình chạy barnyard :<br/> barnyard2 -c /etc/barnyard2/barnyard2.conf -d /var/log/snort -f snort.log -w /etc/barnyard2/barnyard2.waldo<br/><br/> Kết quả :<br/> <font color='orange'><br/> .....v.v<br/> WARNING: Unable to open waldo file '/etc/barnyard2/barnyard2.waldo' (No such file or directory)<br/> Opened spool file '/var/log/snort/snort.log.1358752156'<br/> Closing spool file '/var/log/snort/snort.log.1358752156'. Read 0 records<br/> Opened spool file '/var/log/snort/snort.log.1358754263'<br/> Waiting for new data</font><br/><br/> và barnyard2 cũng ko ghi gì vào db cả.<br/> nên Base cũng ko hiển thị<br/><br/> Mong mọi người giúp đỡ<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44195.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44195/273033.hva#273033,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hiện tại mình có đọc được http://docs.1h.com/Suexec#Limits<br/><br/> Nhưng không biết cách nào để biên dịch httpd có mod_suexec với INCLUDELIMITS.<br/><br/> Mình tìm trong file configure mã nguồn của httpd không thấy tuỳ chọn này.<br/><br/> Mong mọi người giúp đỡ<br/> Xin cảm ơn nhiều!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44018.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44018/272401.hva#272401,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Thanks LNH đã giúp đỡ!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44018.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44018/272323.hva#272323,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Thanks LNH!<br/> Như vậy nếu chạy suexec thì việc còn lại chỉ là giới hạn cho từng user chạy php-cgi.<br/><br/> việc giới hạn cho từng user LNH có thể nói rõ hơn đc không ạ, vì cái này mình chưa biết phải làm như thế nào?<br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44018.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44018/272217.hva#272217,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Thanks anh quanta và emdinoiay.<br/> Google search e có tìm ra được cái này http://httpd.apache.org/docs/current/en/mod/core.html#rlimitcpu<br/><br/> Mọi người có thể xem qua và góp ý giúp e về cái nay đc ko ạ. Vì trình tiếng anh cũng yếu.^^</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.hva">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/43981.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/43981/272194.hva#272194,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">ngtrongtri đổi port management của router từ 443-&gt;4343 (port gì tuỳ thích) , rồi forwarding port 443 -&gt; IP của máy server web https.<br/><br/> Lưu ý là đổi port management trước khi forward port. Chứ ko là phải vào Router bằng cổng console đấy.<br/><br/> Cấu hình trong console bạn có thể tham khảo tại<br/> http://www.fir3net.com/Juniper-SRX-Series-Gateway/juniper-srx-destination-nat-port-forwarding.html</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44018.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44018/272152.hva#272152,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">quanta wrote:</cite><br>
<blockquote>Đố bạn biết: Apache dựa vào cái gì trong HTTP header để chuyển một request đến đúng virtual host cần đến?&nbsp;
</blockquote><br/> Hi anh Quanta, theo e biết thì Apache dựa vào host field (chứa domain name và port nếu khác port default) của http header để chỉ nó đến document root của virtual host.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/44018.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/44018/272087.hva#272087,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cho mình hỏi là có cách nào để mình có thể chỉ định cho mỗi virtual host trong apache chỉ được phép sử dụng bao nhiêu mem, cpu không ạ.<br/><br/> Xin cảm ơn nhiều</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/43960.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/43960/272086.hva#272086,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Thansk anonymous_itop, emdinoiay nhiều.<br/><br/> Cuối cùng cài lại centos 5 thì cài đặt được.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/43960.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/43960/271845.hva#271845,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hiện tại mình đang cài đặt Kloxo cho Centos 6.3 32bit<br/><br/> Mình có download script cài đặt Kloxo. Nhưng khi chạy ./kloxo-installer.sh --type=master --db-rootpassword=123<br/> @123<br/> thì bị lỗi<br/> <font color='orange'>Warning: RPMDB altered outside of yum.<br/> ** Found 2 pre-existing rpmdb problem(s), 'yum check' output follows:<br/> cronie-1.4.4-7.el6.i686 has missing requires of /usr/sbin/sendmail<br/> redhat-lsb-4.0-3.el6.centos.i686 has missing requires of /usr/sbin/sendmail</font><br/><br/> Sau đó mình cài đặt sendmail bằng yum : yum install sendmail*<br/><br/> và chạy lại nhưng vẫn bị lỗi trên. Nhìn lên thì thấy<br/> <font color='orange'>Removing packages sendmail sendmail-cf sendmail-doc sendmail-devel exim vsftpd postfix vpopmail qmail lxphp lxzend pure-ftpd imap...</font> trong quá trình thực thi script.<br/><br/> Cho mình hỏi khắc phục cách nào để cài đặt được Kloxo ạ. Vì ở trên vì remove sendmail, mà ở dưới thì requires sendmail.<br/><br/> Mình xin cảm ơn!!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/43883.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/43883/271767.hva#271767,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Bạn ngtrongtri có thời gian thì viết tiếp bài 2 nhé, để mọi người đọc nửa chừng rồi trốn thế.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/43913.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/43913/271628.hva#271628,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Nếu cài máy ảo thì không máy ảo ko nhận card wireless đâu, bạn dùng usb wireless thì được.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/43895.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/43895/271627.hva#271627,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">quanta wrote:</cite><br>
<blockquote><br/> Thú thật là mình chưa dùng MySQL Cluster trong môi trường thật bao giờ. Bạn dùng rồi có thấy vấn đề gì không? &nbsp;
</blockquote><br/><br/> Thế anh dùng trên môi trưởng ảo hoá hả anh, công nhận việc ảo hoá hệ thống tiện thật</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/252473' + '.hva'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" selected="selected">1</option>	
								<option value="2" >2</option>	
						</select>
						
							<a href="/hvaonline/posts/listByUser/30/252473.hva">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 2" title="Page 2"/>
							</a>
						
						<a href="/hvaonline/posts/listByUser/30/252473.hva">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (2)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
