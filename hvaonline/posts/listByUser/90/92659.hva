<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by mfeng, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by mfeng - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.hva">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.hva">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.hva">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.hva">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.hva">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.hva"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.hva">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.hva">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.hva">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.hva', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/92659.hva" name="top" class="maintitle" id="top">Messages posted by: mfeng</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/92659.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/92659.hva">Profile for mfeng</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/92659.hva">Messages posted by mfeng</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">9</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.hva">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21359.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21359/128474.hva#128474,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">only1bit wrote:</cite><br>
<blockquote>Các bạn thân mến để chứng minh VB6.0 hoàn toàn có thể viết virus.<br/> Con này được viết bởi nhóc bit.killer 1 trong tứ quái nhóm bọn mình.<br/><span class="link"> http://vg.vn2k.net/vr.zip</span><br/><br/> Bạn nào muốn bàn về antidebug thì bài viết sau mình sẽ bàn tiếp.<br/><br/> Hix ! hôm bửa bạn nào nói rằng VB6.0 sử dụng PCODE<br/> Bạn ơi VB5.0 mới sài PCODE thui<br/> Từ VB6.0 thì sử dụng một thứ tương tự như máy tính ảo tương tác qua MSVB60.DLL.<br/> Đọc lại "Bí quyết lập trình VB6.0 (NGỌC ANH THƯ PRESS)".<br/><br/> Còn chuyện AV thì không có chuyện nhận diện virus bằng chuổi đâu bạn ^_^.<br/> &nbsp;
</blockquote><br/><br/> VB (5 hoặc 6) có 2 chế độ dịch: pcode và native code. Native Code là mã chạy thẳng trên x86, nhưng vẫn gọi API thông qua msvbvm{50|60}.dll, còn pcode được đưa thẳng vào virtual machine của msvbvm{50|60}.dll. Cái này thấy rõ khi disassembly file exe viết bằng VB. Nếu pcode, thì decompile ra lại càng dễ <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">.<br/><br/> PS: vr.zip không download được.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.hva">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/16532.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/16532/128370.hva#128370,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><b>Hacker Cracker: A Journey from the Mean Streets of Brooklyn to the Frontiers of Cyberspace</b><br/><br/> <span class="link"> http://www.amazon.com/Hacker-Cracker-Brooklyn-Frontiers-Cyberspace/dp/0066210798/ref=pd_bbs_sr_2?ie=UTF8&s=books&qid=1209571911&sr=8-2</span><br/><br/> <span class="link"> http://rapidshare.com/files/111534001/hcrk.rar</span><br/><br/> Định dạng file: ảnh PNG.<br/><br/> <blockquote>Password: hvaonline.net&nbsp;
</blockquote></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.hva">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21359.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21359/128308.hva#128308,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">vuadapass wrote:</cite><br>
<blockquote><br/> Để em giải thích rõ hơn : em đang nói trong vb6, nó cho phép tạo một file nguồn (resource - .res) để mình lưu trữ các thông số vào đó . Chẳng hạn một bức ảnh, một đoạn media, hay chỉ là một đoạn chữ ... .<br/> Để lây lan virus của mình vào một exe khác, mình sẽ code cho nó đọc hex của exe cần lây rồi bỏ vào resource. Sau đó ghi đè lên tệp exe mình cần lây. File được ghi lên chính là file đã bị nhiễm . Khi mình chạy file bị nhiễm, nó sẽ đọc phần resource mà mình đã lấy của file nguyên bản . Extra ra một góc nào đấy trên máy tính (thông thường là thư mục ~temp) . Tiếp đến công đoạn cuối cùng là tự động chạy nó.<br/> &nbsp;
</blockquote><br/><br/> Phương án này tạm có thể gọi là "virus", nó vác theo file gốc sau lưng, khi cần trả quyền điều khiển cho file gốc thì quăng ra ngoài để chạy. Để phát hiện lớp các "viruses" dạng này không đến nỗi khó:<br/><br/> - <b>Cực đoan</b>: "virus" viết bằng VB dựa vào file msvbvm*.dll, chỉ cần xóa mấy file này khỏi Windows, đảm bảo "virus" chết toi. Tuy nhiên điều này làm các chương trình VB trong sạch bị "vạ lây". <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/><br/> - <b>Khả thi hơn</b>: Chạy một chương trình bị nhiễm "virus", kết quả kiểm tra tiến trình đó lại nằm ở thư mục %temp% nào đó chứ không phải file gốc vừa chạy =&gt; biết ngay chương trình này đã bị "đóng gói"!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.hva">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/19690.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/19690/127047.hva#127047,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>mov ax, @.data
mov ds, ax</pre>
</div><br/><br/> x86 không cho phép truy cập cả thanh ghi đoạn và địa chỉ bộ nhớ trong cùng một lệnh, vì vậy phải lấy thanh ghi ax làm trung gian khi khởi tạo giá trị DS tới địa chỉ segment của vùng nhớ .data</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.hva">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/20837.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/20837/124826.hva#124826,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Để gửi file log (hay bất cứ file gì) kèm theo mail, bạn cần nắm vững giao thức SMTP và định dạng file mail (MIME format), cách mã hóa BASE64 trong MIME...<br/><br/> Mail server của yahoo.com có thể tìm được khi truy cập bản tin MX của domain yahoo.com. Bạn có thể dùng lệnh nslookup với tùy chọn set type=MX để tìm SMTP Server của Yahoo. Nếu muốn tự động hóa khâu tìm mail server, bạn cần lập trình truy xuất DNS service.<br/><br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.hva">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/20993.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/20993/124794.hva#124794,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Bạn đã hỏi về chủ đề này ở <span class="link"> http://www.hvaonline.net/hvaonline/posts/list/20837.hva</span> và đã được trả lời chi tiết. Không nên tạo nhiều chủ đề trùng lặp như vậy. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/123173.hva#123173,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">IPhone sử dụng hệ điều hành Mac OS X, vì vậy các phần mềm trên iphone có cùng định dạng file thực thi với Mac OS, là Mach-O File Format. Có thể dùng IDA để reverse các file thực thi này.<br/><br/> Để lập trình cho iPhone, hiện nay có 2 bộ công cụ là iPhone SDK do Apple phát hành và Toolchain do các hãng thứ 3. Môi trường lập trình của iPhone SDK là Mac OS, còn toolchain có thể là Mac OS, Linux, Cygwin. Chi tiết về toolchain xem <span class="link"> http://www.tuaw.com/2007/09/11/installing-the-iphone-developer-toolchain-a-simple-how-to/</span></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.hva">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/20363.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/20363/120958.hva#120958,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Bạn thử sử dụng các hàm Int 21h dành cho truy nhập file xem sao: Các hàm như mở file (AH=3Dh), đóng file (AH=3Eh), đọc từ file vào buffer (AH=3Fh) ...</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/21.hva">Thảo luận việc định hướng</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/20348.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/20348/120853.hva#120853,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Bạn nên học lập trình C (Visual C++) với WinAPIs (Không phải lập trình VC với thư viện MFC nhé). Ngoài ra nên đọc cuốn "Programming Windows 5th Ed" của Petzold cho dễ hiểu.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.hva">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/19428.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/19428/116502.hva#116502,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">CK wrote:</cite><br>
<blockquote>Khi em "xem" csdl của 1 site, password, username, email của table user đã bị mã hóa. Tất cả đều có 30 ký tự: (A_Z a_z 1_9 + và /) như dưới đây. <font color='orange'>Nhưng khi em view profiles của mình thì có username + email, (password thì bằng thủ thuật mới thấy)</font>.<br/> &nbsp;
</blockquote><br/><br/> Bạn có chắc chắn các dữ liệu về user, email & password được lưu trữ trong 240 bits không?. Chỉ từ 240 bits dữ liệu này có thể giải mã được username, email & password (như bạn nói khi view profiles)? Hay website có lưu các thông tin này ở chỗ khác?<br/><br/> Theo ý kiến cá nhân, 240 bits để lưu user name, email, password có vẻ hơi ít. Nhóm kí tự trong 240 bits là A-Z,a-z,0-9,+,/ cho thấy bước cuối cùng trước khi lưu vào CSDL có thể là encode BASE64.<br/><br/> Trường hợp đây là mã hóa 2 chiều (mã hóa đối xứng - symmetric encryption), nếu website sử dụng các thuật toán đơn giản hoặc DES, khả năng bạn có thể vét cạn để tìm khóa là khả thi (trong trường hợp này bạn phải biết rõ tên thuật toán mã hóa). Còn với 3DES, IDEA, RC4, RC5, RC6 và nhất là AES, khả năng với một cá nhân tìm ra khóa mã là cực khó. Cho nên hướng giải quyết của <b><font color='orange'>gammar95</font></b> có lẽ là khả thi hơn.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.hva">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/19428.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/19428/116213.hva#116213,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Yêu cầu bạn đưa ra thuộc dạng ciphertext-only attack. Thông thường mô hình tấn công này sử dụng thống kê tần suất xuất hiện của ký tự, và chỉ đạt được khi có số lượng ciphertext đủ lớn (như trường hợp bẻ gãy khóa của RC4 trong WEP). Nhưng ở đây, nhiệm vụ dường như khó khăn hơn khi cả thuật toán mã hóa cũng chưa biết <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> (Cũng có thể không phải mã hóa mà chỉ là sử dụng hàm băm (hash function) thì khả năng giải mã gần như bằng 0).</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18602.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18602/114760.hva#114760,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Để chống keygen thì theo em cách sau sẽ hiệu quả:<br/><br/> Input: usr, serial<br/><br/> serial = E(H(usr), private_key)<br/><br/> Check: D(serial, pub_key) == H(usr) ?<br/><br/> Scheme trên bị sơ hở rất dễ bị patch ở đoạn kiểm tra: D(serial, pub_key) == H(usr). Do đó cần có biện pháp chống patch cho hợp lý. Mời mọi người đóng góp ý kiến <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">.<br/><br/> Một số ý kiến chống patch bên cạnh cách anti-debug và code obfuscator:<br/> - Dùng timer check CRC đoạn mã kiểm tra key không thường xuyên<br/> - Không hiện thông báo serial sai, yêu cầu restart soft sau khi nhập user & serial<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.hva">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/19125.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/19125/114221.hva#114221,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Sơ bộ ban đầu về virus này:<br/><br/> - Lợi dụng lỗi MDAC cũ để phát tán virus khi dùng IE chưa cập nhật truy cập vào trang web <span class="link"> hxxp://girltinh.tk.</span><br/> - Virus gồm 2 file: <font color='white'><b>SVCHOST.EXE và SVCHOST32.EXE</b></font> để ở trong thư mục TMP:<br/> <font color='yellow'>TMP=C:\DOCUME~1\[usr]\LOCALS~1\Temp</font><br/> - File SVCHOST32.EXE bị KAV phát hiện ra là Trojan-Spy.Win32.SCKeyLog.au. File còn lại chưa bị phát hiện.<br/><br/> To hack9x: đề nghị cậu không trả lời mấy câu vô nghĩa như trên nữa.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/111872.hva#111872,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Các bạn có thể download phiên bản pdf của bài viết trên ở dưới đây (đã bao gồm 2 file case study)</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/111869.hva#111869,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><font color='orange'><b>3.4. Case study 1: example1.exe</b></font><br/><br/> Trong phần này, chúng ta sẽ thử nghiệm debug file example1.exe, chương trình có nội dung như sau:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/242fa8f6cab9caa61ce36caf506b01b0_92659.jpg' border="0" /></div><br/><br/> Tùy theo giá trị nhập vào, kết quả “Check key” sẽ hiện ra <font color='yellow'>“Correct” </font>hay <font color='yellow'>“Incorrect”</font>.<br/> Mục tiêu của Debug là tìm ra giá trị Key khi nhập vào tên User bất kỳ. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/><br/> <b><font color='white'>Bước 1: Khảo sát</font></b><br/><br/> Chạy example1.exe trên máy ảo Windows Mobile, nhập vào:<br/> <b>User</b>: <font color='yellow'>mfeng-hvaonline</font><br/> <b>Key</b>: <font color='yellow'>123456789</font><br/> và tap <font color='yellow'>“Check Key”</font>, kết quả:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/03dc69b7072c5e1e7302c4fbb6a5616e_92659.jpg' border="0" /></div><br/><br/> <b><font color='white'>Bước 2: Dùng IDA phân tích file example1.exe</font></b><br/><br/> Sau khi mở file example1.exe bằng IDA, một cửa sổ hiện ra như ở hình bên dưới, hãy click OK.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/9ec57d095d5791ca92af40ceb93e0f69_92659.jpg' border="0" /></div><br/><br/> Dùng tab String, tìm tới chuỗi <font color='red'>“Incorrect Key”</font>:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/a252948f834e171acee984541c8f329b_92659.jpg' border="0" /></div><br/><br/> Ta được:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/ea25b2e9824fddb9c2413b4890fe9791_92659.jpg' border="0" /></div><br/><br/> Ngược lên đoạn mã tham chiếu tới chuỗi này, ta sẽ ở đây:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/eef2dbdf6cc340a2ee6b25ddf4f2ff59_92659.jpg' border="0" /></div><br/><br/> và tiếp theo:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/8c2f50dde2e44979c21dff0ad7e7d077_92659.jpg' border="0" /></div><br/><br/> Chú ý tới đoạn code từ <font color='yellow'>0x0001183C </font>tới <font color='yellow'>0x00011848</font>, ta có thể suy ra đoạn mã kiểm tra dạng như sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>if &#40;sub_116F0&#40;&#41; == 0&#41;
//Incorrect key
else
//Correct Key</pre>
</div><br/> Việc cần thiết bây giờ là đặt breakpoint tại <font color='yellow'>0x0001183C </font><img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/><br/> <b><font color='white'>Bước 3: Debug</font></b><br/><br/> Menu <font color='yellow'>Debug -&gt; Process options</font>, đặt các thông số như sau:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/a6e922ec8f2aab17b12a5b89c3830332_92659.jpg' border="0" /></div><br/> Sau đó click OK<br/><br/> Đặt breakpoint tại <font color='yellow'>0x0001183C</font>:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/1ac4bf10a43a1e7046ca391a0a584712_92659.jpg' border="0" /></div><br/><br/> F9 để bắt đầu debug.<br/><br/> Nhập User: <font color='yellow'>mfeng-hvaonline</font> & Key: <font color='yellow'>123456789</font>. Tap “Check Key”, IDA breaks tại vị trí sau:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/534653278c23927ed8836a94c15020d9_92659.jpg' border="0" /></div><br/><br/> Xem giá trị <font color='yellow'>R0 = 0x2404F954</font>, không thấy trỏ tới chuỗi ký tự đặc biệt nào. (Thực chất, R0 là con trỏ this).<br/><br/> Xem giá trị <font color='yellow'>R1 = 0x00055EF0</font>:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/9efa30de02990baa829739581d396e72_92659.jpg' border="0" /></div><br/><br/> Và <font color='yellow'>R2 = 0x00055F30</font><br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/b60cccc176966a8d1df09994fdc99df4_92659.jpg' border="0" /></div><br/><br/> Trace vào bên trong hàm <font color='yellow'><b>sub_116F0</b></font>, đoạn code của hàm này như sau:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/15f7c05003553187e970f44cdce55d20_92659.jpg' border="0" /></div><br/><br/> Tại <font color='yellow'>0x00011704</font>, hàm <font color='white'>wcslen </font>lấy độ dài chuỗi ký tự User: <font color='yellow'>mfeng-hvaonline</font>. Kết quả trả về là <font color='yellow'>R0 = 0x0000000F (15)</font>.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/9f7fd1649770b431cd5f69de1dd0c4fd_92659.jpg' border="0" /></div><br/><br/> Tại <font color='yellow'>0x00011710</font>, độ dài user được so sánh với #4, nếu nhỏ hơn, <b><font color='yellow'>sub_116F0</font></b> trả về giá trị 0 tại 0x00011730.<br/> Tại <font color='yellow'>0x00011720</font>, so sánh hai chuỗi user và key, nếu giống nhau, <b><font color='yellow'>sub_116F0</font></b> trả về giá trị 1, còn lại trả về giá trị 0.<br/> Như vậy, chỉ cần user & key giống hệt nhau, chương trình sẽ cho ra kết quả <font color='red'>“Correct”</font>.<br/> Tóm lại, đoạn debug vừa rồi cho ta thấy hoạt động của example1.exe ở cấp độ assembly, cho biết cách thức kiểm tra giữa User và Key để cho ra kết quả <font color='red'>“Correct” </font>hay <font color='red'>“Incorrect”</font>.<br/><br/> <b><font color='orange'>3.5. Case study 2: example2.exe</font></b><br/> Trong case study này, các bạn hãy tự mình giải quyết cơ chế tìm key theo user. Khác với example1, case study này có đôi chút khó khăn hơn <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/><br/> <b><font color='red'>4. Kết luận</font></b><br/> Bài viết trên đã trình bày các nội dung cơ bản nhất để tiến hành reverse một chương trình trên Windows Mobile, đồng thời minh họa cách thức debug thông qua hai case study đơn giản nhất. Từ các kiến thức này, bạn đọc có thể hoàn toàn tự mình nghiên cứu reverse và phân tích các ứng dụng phức tạp hơn.<br/><br/> <b><font color='red'>5. Greetings </font></b><br/> Greats thanks to all HVA and REA members.<br/><br/> <font color='red'><b>6. Tài liệu tham khảo</b></font><br/><br/> 1. "Hacking Windows CE", Phrack Magazine, Volume 0x0b, Issue 0x3f, Phile #0x06 of 0x14<br/> 2. http://www.ra.informatik.uni-stuttgart.de/~ghermanv/Lehre/SOC02/ARM_Presentation.pdf<br/> 3. http://infocenter.arm.com/help/topic/com.arm.doc.qrc0001l/QRC0001_UAL.pdf<br/> ---<br/> Hết.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/111866.hva#111866,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><b><font color='red'>3. Reverse Engineering trên Windows Mobile</font></b><br/> <b><font color='orange'>3.1 Hàm APIs</font></b><br/><br/> Hàm APIs trên Windows Mobile nhìn chung tương tự như APIs trên Windows for x86. Các hàm quen thuộc với cr@cking như GetWindowTextW, GetDlgItemTextW, MessageBoxW... đều có trên WM. (Chú ý: API của WM hoàn toàn hỗ trợ Unicode). Chi tiết nội dung các hàm này có thể tìm trên MSDN.<br/><br/> <b><font color='white'>Cách thức gọi hàm API cấp độ assembly (calling convention):</font></b><br/> <ul><li>Giá trị trả về được giữ trong thanh ghi <font color='orange'>R0 </font>(tương tự như <font color='orange'>EAX </font>trên x86).</li></ul><br/> <ul><li>Các tham số từ trái qua phải được tải vào các thanh ghi từ R0 tới R3. Nếu nhiều tham số hơn, các giá trị được đẩy vào stack theo thứ tự từ phải qua trái. VD</li></ul><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>.text:00107DB8 LDR R1, =aClsid ; lpSubKey = "CLSID"
.text:00107DBC MOV R6, R0
.text:00107DC0 STR R3, &#91;SP,#0x34+var_34&#93; ;STR R3,&#91;SP&#93;; phkResult
.text:00107DC4 MOV R3, #0 ; samDesired = 0
.text:00107DC8 MOV R2, #0 ; ulOptions = 0
.text:00107DCC MOV R0, #0x80000000 ; hKey = HKEY_CLASS_ROOT
.text:00107DD0 BL RegOpenKeyExW
.text:00107DD4 MOVS R3, R0 ; test operation result
.text:00107DD8 BEQ _OpenFailed</pre>
</div><br/> <b><font color='orange'>3.2 Công cụ</font></b><br/> <b><font color='white'>a) Editor</font></b><br/><br/> Editor dành cho PE file trên Windows for x86 hoàn toàn có thể áp dụng cho Windows Mobile như LordPE, PE Explorer, Exe Scope, Stud PE…. Tuy nhiên, để thay đổi mã lệnh của PE file for WM thì hoàn toàn không thể sử dụng chương trình trên x86 như Hiew. Có hai cách để thay đổi mã lệnh (patch):<br/><br/> <ul><li>Mã hóa lệnh bằng tay sang dạng binary, sau đó sử dụng một hex editor bất kỳ để sửa file binary.</li></ul><br/> Ví dụ, opcodes của một số lệnh rẽ nhánh như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Command Hex
B xxxxxxEA
BEQ xxxxxx0A
BNE xxxxxx1A
BGE xxxxxxAA
BHI xxxxxx8A
BLT xxxxxxBA
BCC xxxxxx3A
BCS xxxxxx2A
BPL xxxxxx5A
BMI xxxxxx4A
BLS xxxxxx9A
BGT xxxxxxCA
BLE xxxxxxDA</pre>
</div><br/> <ul><li>Sử dụng ChARMeD</li></ul><br/> Chương trình này mang chức năng gần tương tự Hiew for x86. Download ChARMeD ở<span class="link"> http://carolos.za.net/software.html</span> (nên dùng phiên bản cho x86 có chức năng sửa code assembly). Một số chức năng:<br/> - Di chuyển tới offset của file exe: F5 -&gt; nhập địa chỉ offset của file theo dạng số hexa.<br/> - Thực hiện thay đổi mã lệnh tại địa chỉ hiện tại: Spacebar -&gt; nhập mã lệnh mới.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/defd526ef81e71f9b697f09a8457ec33_92659.gif' border="0" /></div><br/><br/> <b><font color='white'>b) Disassembler:</font></b><br/><br/> Công cụ disassembler cho Windows Mobile phổ biến và mạnh nhất là IDA Pro Disassembler. Vì các ứng dụng trên WM tuân theo định dạng PE file, cách thức disassemble tương tự như các chương trình trên Windows for x86.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/704e80db31f8cd7ee22b0e47d441b122_92659.gif' border="0" /></div><br/><br/> <b><font color='white'>c) Debuggers</font></b><br/><br/> Có hai debuggers được sử dụng chính trong WM. Debugger thứ nhất là EVC (Embedded Visual C++) của Microsoft. Đây là debugger cơ bản đầu tiên dành cho WM, có nhiều hạn chế so với debugger thứ hai là IDA Pro Disassembler phiên bản từ 4.9 trở lên. Do vậy, phần sau chỉ minh họa cách thức cấu hình và thực hiện debug bằng IDA Pro.<br/><br/> <b><font color='orange'>3.3 Debug trên Windows Mobile</font></b><br/><br/> Môi trường tiến hành debug bao gồm:<br/> • Một PocketPC (hoặc sử dụng Windows Mobile Emulator của Microsoft).<br/> • Microsoft ActiveSync: dùng để đồng bộ giữa thiết bị PPC (thiết bị thật hoặc Emulator ) và PC. <span class="link"> http://www.microsoft.com/windowsmobile/activesync/default.mspx</span><br/> • Trình debugger: IDA Pro Disassembler 4.9 trở lên, có module debug cho WM: <font color='yellow'>wince_remote_arm.dll</font> & <font color='yellow'>wince_stub.plw</font><br/><br/> <b><i><font color='white'>Phần sau đây sẽ hướng dẫn cách cài đặt Windows Mobile Emulator:</font></i></b><br/><br/> Microsoft hỗ trợ nhiều phiên bản Device Emulator tương ứng với các Emulator Images của các phiên bản WM khác nhau. Các thế hệ emulator cũ chỉ mô phỏng cho CPU x86, các phiên bản mới gần đây giả lập hoàn chỉnh CPU ARM, cho phép chạy App như trên thiết bị thật. Có hai phiên bản Device Emulator:<br/> - Version 1.0: dùng để sử dụng cho các Emulator Images của Windows Mobile 5.0 for Pocket PC và Windows Mobile 5.0 for Smartphone.<br/> - Version 2.0: dùng để sử dụng cho các images của WM6.<br/> Ở đây sẽ đề cập tới phiên bản WM5 và Emulator v1.0.<br/><br/> <b><font color='red'>Download</font></b><br/> <ul><li><span class="link"> http://download.microsoft.com/download/c/b/b/cbb8bc58-07b9-46bb-86ba-d12bb0d9b1d9/V1Emulator.zip</span></li></ul><br/> <ul><li><span class="link"> http://download.microsoft.com/download/c/b/b/cbb8bc58-07b9-46bb-86ba-d12bb0d9b1d9/efp.msi</span></li></ul><br/> <ul><li>Virtual Machine Network Driver (VMNet)</li></ul>: driver này có trong Virtual PC 2004 hoặc Virtual PC 2007. Nếu không muốn cài đặt Virtual PC, có thể download riêng VMNet <span class="link"> http://www.memphistech.net/tools/netsvwrap.msi</span>.<br/><br/> <b><font color='red'>Cấu hình</font></b><br/><br/> - Microsoft ActiveSync: menu File  Connection Setting<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/a9321ad6fb6f3810133a5234ac08666c_92659.jpg' border="0" /></div><br/><br/> - Khởi động “Device Emulator Manager”, sau đó khởi động “Pocket PC – Cold Boot”. (Sau khi đã lưu lại trạng thái của image, các lần sau sẽ chọn “Pocket PC – SaveState”). Đặt kết nối giữa Emulator và PC thông qua ActiveSync: right click như ở hình dưới, chọn Cradle:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/a34a13e2afd80374e2eb92e12ed9d72e_92659.jpg' border="0" /></div><br/><br/> Kết quả:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/4cd78e0d99d3d1de324a7a28a4729b7d_92659.gif' border="0" /></div><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/111825.hva#111825,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><b><font color='white'>b) Lệnh copy dữ liệu</font></b><br/><br/> Nhóm lệnh này có chức năng đọc/ghi dữ liệu giữa bộ nhớ và thanh ghi. Có ba nhóm:<br/><br/> - Đọc dữ liệu từ bộ nhớ vào một thanh ghi: dữ liệu là byte, word (32bit) hay half-word (16bit)<br/> - Đọc dữ liệu từ bộ nhớ vào nhiều thanh ghi: dữ liệu là words<br/> - Đổi chỗ giá trị bộ nhớ - thanh ghi.<br/><br/> <b><i><font color='white'>*) Đọc dữ liệu từ bộ nhớ cho một thanh ghi</font></i></b><br/><br/> 32 bits:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>LDR r0, &#91;r1&#93; ; r0 := mem &#91;r1&#93;
STR r0, &#91;r1&#93; ; mem &#91;r1&#93; := r0
LDR r0,&#91;r1, #4&#93; ; r0 := mem&#91;r1+4&#93;</pre>
</div><br/> <i>Giá trị chuyển dịch (như #4 trong vd trên) tối đa là +/- 4KB</i><br/><br/> 8 bits:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>LDRB r0, &#91;r1&#93; ; r0 := mem &#91;r1&#93; &#91;7:0&#93;
STRB r0, &#91;r1&#93; ; mem &#91;r1&#93; &#91;7:0&#93; := r0</pre>
</div><br/><br/> Cập nhật luôn giá trị thanh ghi địa chỉ:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>LDR r0, &#91;r1&#93;, #4 ; r0 := mem&#91;r1&#93;
; r1 := r1 + 4</pre>
</div><br/><br/> <b><i><font color='white'> *) Đọc dữ liệu từ bộ nhớ vào nhiều thanh ghi:</font></i></b><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>LDMIA r1,{r0, r2, r5} ; r0 := mem &#91;r1&#93;
; r2 := mem &#91;r1+4&#93;
; r5 := mem &#91;r1+8&#93;</pre>
</div><br/> Copy khối dữ liệu: trong các lệnh loại này, thanh ghi địa chỉ có thể tăng (Increase), giảm (Decrease) trước (Before) hoặc sau (After) khi dữ liệu được copy. Các lệnh này hay được dùng để quản lý stack.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/d204ba3f9d0e4e54a6693d1187e2dfb7_92659.gif' border="0" /></div><br/><br/> Ví dụ: lệnh sau đây hay được dùng trong code prolog và code epilog của các hàm:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>STMFD SP!, {R4-R6,LR} ; Lưu giá trị R4, R5 & LR
; vào stack, trừ SP đi 4 x 4 = 0x10
SUB SP, SP, #0x24 ; Dành 0x24 bytes cho local vars
....
ADD SP, SP, #0x24 ; Phục hồi trạng thái stack
LDMFD SP!, {R4-R6,PC} ; Phục hồi thanh ghi R4, R6, trả về địa chỉ sau khi gọi BL vào thanh ghi PC &#40;R15&#41;</pre>
</div><br/><br/> <font color='white'><b><i> *) Đổi chỗ giá trị bộ nhớ - thanh ghi.</i></b></font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SWP Rd, Rm, &#91;Rn&#93;</pre>
</div><br/> Ý nghĩa của lệnh này như sau: đọc giá trị từ bộ nhớ [Rn] vào thanh ghi Rd, sau đó ghi giá trị ở thanh ghi Rm vào [Rn].<br/><br/> <font color='white'><b>c) Tập lệnh điều khiển, rẽ nhánh</b></font><br/><br/> Các lệnh rẽ nhánh thực hiện dựa trên trạng thái của các bit trong thanh ghi CPSR, bao gồm bit <font color='red'>N, S, C, V</font>.<br/><br/> <i> - Rẽ nhánh vô điều kiện: </i><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>B LABEL</pre>
</div><br/> <i> - Rẽ nhánh có điều kiện:</i><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>MOV r0, #0 ; initialize counter
LOOP: ...
ADD r0, r0, #1 ; increment counter
CMP r0, #10 ; compare with limit
BNE LOOP ; repeat if not equal
... ; else continue</pre>
</div><br/> <font color='white'><b>Tổng kết các lệnh rẽ nhánh:</b></font><br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Branch Interpretation Normal Uses
--------------------------------------------------------------
B Unconditional Always take this branch
BAL Always Always take this branch
BEQ Equal Comparison equal or zero result
BNE Not equal Comparison not equal or zero result
BPL Plus Result positive or zero
BMI Minus Result minus or negative
BCC Carry clear Arithmetic operation did not give carry-out
BLO Lower Unsigned comparison gave lower
BCS Carry set Arithmetic operation gave carry-out
BHS Higher or same Unsigned comparison gave higher or same
BVC Overflow clear Signed integer operation ; no overflow occurred
BVS Overflow set Signed integer operation ; overflow occurred
BGT Greater than Signed integer comparison gave greater than
BGE Greater or equal Signed integer comparison gave greater or equal
BLT Less than Signed integer comparison gave less than
BLE Less or equal Signed integer comparison gave less than or equal
BHI Higher Unsigned comparison gave highe
BLS Lower or same Unsigned comparison gave lower or same</pre>
</div><br/><br/> <b><i><font color='white'>Chú ý:</font></i></b> các lệnh xử lý dữ liệu có thể bao gồm chức năng điều kiện:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>CMP r0, #5 ; if &#40;r0 != 5&#41; {
ADDNE r1, r1, r0 ; r1 := r1 + r0 - r2
SUBNE r1, r1, r2 ; }</pre>
</div><br/><br/> <b><font color='white'>Mã điều kiện:</font></b><br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Opcode Mnemonic Interpretation Status flag state
&#91;31:28&#93; extension for execution
----------------------------------------------------------------------------------
0000 EQ Equal / equals zero Zset
0001 NE Not equal Zclear
0010 CS/HS Carry set / unsigned higher or same Cset
0011 CC/LO Carry clear / unsigned lower Cclear
0100 MI Minus / negative Nset
0101 Pl Plus / positive or zero Nclear
0110 VS Overflow Vset
0111 VC No overflow Vclear
1000 HI Unsigned higher Cset and Zclear
1001 LS Unsigned lower or same Cclear or Zset
1010 GE Signed greater than or equal N equals V
1011 LT Signed less than N is not Equal to V
1100 GT Signed greater than Z clear and N equals V
1101 LE Signed less than or equal Z set or Nis not equal to
1110 AL Always any
1111 NV Never &#40;do not use!&#41; none</pre>
</div><br/><br/> <b><font color='orange'>Cơ chế gọi hàm của ARM </font></b>: dùng thanh ghi <font color='yellow'>r14 (LR)</font> lưu trữ địa chỉ lệnh kế tiếp sau lệnh <font color='yellow'>BL</font> để quay trở về.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>BL SUBR ; branch to SUBR
... ; return to here
SUBR ... ; subroutine entry point
MOV pc, r14 ; return</pre>
</div><br/> <b>Gọi hàm nhiều lớp (nested subroutines)</b>: thanh ghi R14 (LR) cần được cất vào stack trước khi gọi hàm.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>BL SUB1 ; branch to SUB1
...
SUB1 STMDA r13!, {r0-r2, r14} ; save regs
BL SUB2
...
LDMIB r13!, {r0-r2, pc} ; restore regs + return
SUB2 ...
MOV pc, r14 ; return</pre>
</div><br/><br/> <b><i><font color='orange'>Chú ý</font></i></b>: ARM không có phép toán <font color='yellow'>NOP </font>(như x86). Để thay thế lệnh này, có thể dùng llệnh <font color='yellow'>MOV R0, R0 </font>có opcode là <font color='orange'>0000A0E1</font><br/><br/> Đến đây, với nội dung đã trình bày, bạn đã có thể đọc hiểu mã lệnh assembly của VXL ARM. Phần tiếp theo đề cập tới các công cụ debug, disassembler và editor hỗ trợ cho reverse engineering trên Windows Mobile. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/111823.hva#111823,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">Zombie wrote:</cite><br>
<blockquote>Hiện Zom cũng đang mún vọc thử với Symbian. Nên không biết lão mf rành không thì xin được học hỏi.&nbsp;
</blockquote><br/><br/> Hì hì, em chưa động vào Symbian bao giờ bác ạ. Có cái tut về Symbiancủa ARTeam bác hacnho up lên đó bác <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/111418.hva#111418,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Em định đặt reference ở cuối loạt bài, nhưng để tiện lợi hơn, có lẽ nên đặt dưới mỗi bài post <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.hva">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18695.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18695/111283.hva#111283,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><font color='white'><font size='+1'>Kiến thức cơ bản về Reverse Engineering trên Windows Mobile</font></font><br/> <font color='orange'><br/> <b>Version: 1.0<br/> Last Rev: Jan 2008.<br/> </b></font><br/><br/> <b><font color='cyan'>Tác giả</font></b>: mfeng<br/><br/> HVAOnline:<span class="link"> http://hvaonline.net</span><br/> REAOnline:<span class="link"> http://reaonline.net</span><br/><br/> <b><br/> <font color='red'>Mục lục</font><br/><br/> <font color='red'>1. Kiến trúc Windows Mobile</font><br/> <font color='orange'>1.1. Quản lý bộ nhớ<br/> 1.2. Quản lý tiến trình</font><br/><br/> <font color='red'>2. Kiến trúc hệ xử lý ARM</font><br/> <font color='orange'>2.1 Thanh ghi<br/> 2.2 Mã lệnh (opcodes)</font><br/> - Tập lệnh xử lý dữ liệu<br/> - Tập lệnh copy dữ liệu<br/> - Tập lệnh điều khiển, rẽ nhánh<br/><br/> <font color='red'>3. Reverse Engineering trên Windows Mobile</font><br/> <font color='orange'>3.1 Hàm APIs<br/> 3.2 Công cụ</font><br/> - Editor<br/> - Disassembler<br/> - Debuger<br/> <font color='orange'>3.3 Debug trên Windows Mobile<br/> 3.4. Case study 1: example1.exe<br/> 3.5. Case study 2: example2.exe</font><br/><br/> <font color='red'>4. Kết luận</font><br/><br/> <font color='red'>5. Greetings </font><br/><br/> <font color='red'>6. Tài liệu tham khảo</font><br/> </b><br/> --------<br/><br/> <font color='white'>Bài viết này tổng kết những gì mfeng đã tìm hiểu về Windows Mobile với mục đích tiện việc tra cứu và tham khảo sau này <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> .</font><br/><br/> <b><font color='red'>1. Kiến trúc Windows Mobile</font><br/> <font color='orange'>1.1. Quản lý bộ nhớ</font></b><br/><br/> Mô hình quản lý bộ nhớ của Windows Mobile khác hẳn so với các hệ điều hành Windows khác. Bộ nhớ được chia làm hai loại: ROM & RAM.<br/><br/> ROM chứa toàn bộ hệ điều hành và chương trình đi kèm hệ điều hành. Công dụng của ROM tương tự như một HDD trên PC, ngay cả khi cạn hết pin, dữ liệu trong ROM vẫn bảo toàn. Windows Mobile.NET ứng dụng Execute In Place (XIP) đối với các file DLL nằm trên ROM cho phép tiết kiệm lượng RAM so với trước kia. Đối với các file DLL thông thường nằm trên Flash Memory (SD card) hay RAM (phần Object Store), nội dung các file này cần copy vào RAM và thực thi.<br/><br/> RAM của Windows Mobile chia thành hai phần: Object Store và Program Memory. Object Store có tác dụng như một virtual ram HDD, dùng để chứa tạm thời chương trình và dữ liệu. Khi hết pin, dữ liệu trong Object Store sẽ mất. Program Memory mang công dụng tương tự RAM trên PC, dùng cho hoạt động của HĐH và chương trình.<br/><br/> Không gian bộ nhớ của Windows Mobile như sau [1]<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>+----------------------------------------+ 0xFFFFFFFF
| | | Kernel Virtual Address: |
| | 2 | KPAGE Trap Area, |
| | G | KDataStruct, etc |
| | B | ... |
| | |--------------------------------+ 0xF0000000
| 4 | K | Static Mapped Virtual Address |
| G | E | ... |
| B | R | ... |
| | N |--------------------------------+ 0xC4000000
| V | E | NK.EXE |
| I | L |--------------------------------+ 0xC2000000
| R | | ... |
| T | | ... |
| U |---|--------------------------------+ 0x80000000
| A | | Memory Mapped Files |
| L | 2 | ... |
| | G |--------------------------------+ 0x42000000
| A | B | Slot 32 Process 32 |
| D | |--------------------------------+ 0x40000000
| D | U | ... |
| R | S |--------------------------------+ 0x08000000
| E | E | Slot 3 DEVICE.EXE |
| S | R |--------------------------------+ 0x06000000
| S | | Slot 2 FILESYS.EXE |
| | |--------------------------------+ 0x04000000
| | | Slot 1 XIP DLLs |
| | |--------------------------------+ 0x02000000
| | | Slot 0 Current Process |
+---+---+--------------------------------+ 0x00000000</pre>
</div><br/><br/> Nửa trên 2GB từ <font color='orange'>0x80000000 </font>trở đi là vùng nhớ hệ thống (kernel space) dành cho hệ điều hành. Nửa dưới từ <font color='orange'>0x00000000 </font>cho tới <font color='orange'>0x7FFFFFFF </font>là vùng nhớ cho ứng dụng user (user space), trong đó phần trên <font color='orange'>0x42000000 </font>dùng để quản lý dữ liệu kích thước lớn như memory-mapped files (Ai đã biết lập trình Windows trên PC sẽ quen thuộc đối tượng này). Object Store cũng được ánh xạ trong vùng địa chỉ này. Phần dưới <font color='orange'>0x42000000 </font>chia thành 33 slots, kích thước mỗi slot là <font color='orange'>0x2000000 </font>bytes (32MB).<br/><br/> Slot 0 quản lý tiến trình hiện hành, bao gồm [1]:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>+---+------------------------------------+ 0x02000000
| | DLL Virtual Memory Allocations |
| S | +--------------------------------|
| L | | ROM DLLs:R/W Data |
| O | |--------------------------------|
| T | | RAM DLL+OverFlow ROM DLL: |
| 0 | | Code+Data |
| | +--------------------------------|
| C +------+-----------------------------|
| U | A |
| R V | |
| R +-------------------------+----------|
| E | General Virtual Memory Allocations|
| N | +--------------------------------|
| T | | Process VirtualAlloc&#40;&#41; calls |
| | |--------------------------------|
| P | | Thread Stack |
| R | |--------------------------------|
| O | | Process Heap |
| C | |--------------------------------|
| E | | Thread Stack |
| S |---+--------------------------------|
| S | Process Code and Data |
| |------------------------------------+ 0x00010000
| | Guard Section&#40;64K&#41;+UserKInfo |
+---+------------------------------------+ 0x00000000</pre>
</div><br/><br/> 64KB đầu tiên chứa thông tin của HĐH về tiến trình; mã chương trình từ file exe được nạp từ địa chỉ <font color='orange'>0x10000 </font>(là <font color='orange'>ImageBase </font>của các file exe trên Windows Mobile). Tiếp đó là Stack & Heap dành cho thread chính trong tiến trình. Các thư viện được nạp phần cuối vùng nhớ của slot.<br/><br/> <b><font color='orange'>1.2. Quản lý tiến trình</font></b><br/><br/> Nhìn chung quản lý tiến trình của Windows Mobile khác hẳn so với các bản Windows x86. Số lượng tối đa tiến trình chạy song song là 32. Có 4 tiến trình hệ thống được nạp từ ban đầu: NK.EXE, dành cho kernel service, ở slot 97; FILESYS.EXE, dành cho system services, ở slot2; DEVICE.EXE, quản lý device drivers hệ thống, thường ở slot 3; GWES.EXE, quản lý GUI hệ thống, ở slot 4. Shell process (SHELL.EXE) được nạp ngay sau FILESYS.EXE.<br/><br/> Tương tự Windows truyền thống, mỗi tiến trình có ít nhất một thread chính. Các threads trong cùng tiến trình chia sẻ cùng không gian bộ nhớ, nhưng khác biệt nhau về Heap và Stack. Kích thước Stack mặc định cho mỗi thread là 64KB, trừ khi được thay đổi khi biên dịch chương trình bằng tùy chọn compiler thích hợp.<br/><br/> Khi một chương trình được chạy, hệ thống tìm kiếm một slot còn trống và tải mã lệnh, dữ liệu lên slot đó. Các thư viện DLLs được nạp vào slot. Điều độ tiến trình (task schedule) của HĐH sẽ lần lượt kích hoạt các tiến trình bằng cách ánh xạ tiến trình điều độ vào slot 0, tiến trình không kích hoạt được trả về slot cũ tương ứng.<br/><br/> <b><font color='red'>2. Kiến trúc hệ xử lý ARM</font></b><br/><br/> Hệ vi xử lý ARM (The Advanced RISC Microprocessor) sử dụng kiến trúc RISC 32 bit, thường được sử dụng trong các thiết bị nhỏ, bị giới hạn về nguồn năng lượng như PDA, các thiết bị truyền thông.... Các thiết bị PocketPC sử dụng Windows Mobile sử dụng họ CPU này. Thế hệ CPU dành cho PPC là thế hệ 5, có mã là XScale ARM. Chi tiết về các thế hệ CPU ARM, xin tham khảo ở <span class="link"> http://en.wikipedia.org/wiki/ARM_architecture</span><br/><br/> Phần này không mô tả chi tiết về kiến trúc của vi xử lý Xscale ARM mà chỉ đề cập tới những kiến thức tối thiểu cần thiết cho công việc reverse engineering trên Windows Mobile.<br/><br/> <b><font color='orange'>2.1. Thanh ghi (registers)</font></b><br/><br/> XScale ARM có một số chế độ hoạt động (mode): user mode, fast interrupt handling, general purpose interrupt handling,<br/> supervisor mode, system mode, abort mode và undefined mode. Chế độ hoạt động thông thường cho các ứng dụng trên Windows Mobile là User Mode.<br/><br/> XScale ARM có tổng cộng 31 thanh ghi, trong số đó chỉ 16 thanh ghi từ r0 tới r15 có thể sử dụng tại User Mode. Các thanh ghi đều có độ dài 32 bits, có chức năng như sau [2]:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Reg# APCS Meaning
R0 a1 Working registers
R1 a2 "
R2 a3 "
R3 a4 "
R4 v1 Must be preserved
R5 v2 "
R6 v3 "
R7 v4 "
R8 v5 "
R9 v6 "
R10 sl Stack Limit
R11 fp Frame Pointer
R12 ip
R13 sp Stack Pointer
R14 lr Link Register
R15 pc Program Counter</pre>
</div><font size='-2'><font color='white'>APCS: ARM Procedure Call Standard</font></font><br/><br/> Thanh ghi R15 có chức năng tương tự như thanh ghi IP (Instruction Pointer) trên hệ x86, dùng để trỏ tới địa chỉ chứa lệnh đang thực hiện. R14 chứa giá trị của R15 khi thực hiện lệnh Branch and Link (BL) - Lệnh này tương tự lệnh Call trên x86. R13 là thanh ghi Stack, chức năng tương tự thanh ghi SP trên x86.<br/><br/> ARM có thanh ghi trạng thái CPSR (Current Program Status Register) chứa các bit trạng thái sau [2]:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>31 28| 8 7 6 5| 4 0
N Z C V| I F T| mode</pre>
</div><br/> <ul><li>N - kết quả âm - <font color='red'>N</font>egative</li></ul><br/> <ul><li>Z - kết quả <font color='red'>Z</font>ero</li></ul><br/> <ul><li>C - kết quả có nhớ (<font color='red'>C</font>arry).</li></ul><br/> <ul><li>V - kết quả tràn (o<font color='red'>V</font>erflow).</li></ul><br/><br/> <b><font color='orange'>2.2. Tập lệnh (opcodes)</font></b><br/><br/> Tập lệnh của ARM có thể chia ra các nhóm sau [2]<br/> - Tập lệnh xử lý dữ liệu<br/> - Tập lệnh copy dữ liệu<br/> - Tập lệnh điều khiển, rẽ nhánh<br/><br/> <font color='white'><b>a) Tập lệnh xử lý dữ liệu</b></font><br/><br/> - Phép toán số học<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>ADD r0, r1, r2 ; r0 := r1 + r2
ADC r0, r1, r2 ; r0 := r1 + r2 + C
SUB r0, r1, r2 ; r0 := r1 - r2
SBC r0, r1, r2 ; r0 := r1 - r2 + C - 1
RSB r0, r1, r2 ; r0 := r2 - r1
RSC r0, r1, r2 ; r0 := r2 - r1 + C - 1</pre>
</div><br/> <i><font color='white'>C: là cở carry được lưu trong thanh ghi CPSR</font></i><br/><br/> - Phép toán xử lý bit<span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>AND r0, r1, r2 ; r0 := r1 and r2
ORR r0, r1, r2 ; r0 := r1 or r2
EOR r0, r1, r2 ; r0 := r1 xor r2
BIC r0, r1, r2 ; r0 := r1 and not r2</pre>
</div><br/> <i><font color='white'>BIC viết tăt của Bit Clear</font></i><br/><br/> - Lệnh chuyển dữ liệu giữa các thanh ghi<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>MOV r0, r2 ; r0 := r2
MVN r0, r2 ; r0 := not r2</pre>
</div><br/> <i><font color='white'>Chú ý: MVN (Move Negated)</font></i><br/><br/> - Phép so sánh (Comparison operations): các lệnh này thay đổi trạng thái các cờ N,Z,C,O trong thanh ghi CPSR, dùng làm điều kiện cho các lệnh rẽ nhánh.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>CMP r1, r2 ; set cc on r1 - r2
CMN r1, r2 ; set cc on r1 + r2
TST r1, r2 ; set cc on r1 and r2
TEQ r1, r2 ; set cc on r1 or r2</pre>
</div><br/> Trong các phép toán số học & bit trên, toán hạng thứ 2 (r2) có thể thay bằng hằng số.<br/><br/> - Phép toán dịch bit: được dùng kết hợp như sau, vd:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>ADD r3, r2, r1, LSL #3 ; r3 := r2 + 8*r1
ADD r5, r5, r3, LSL r2 ; r5 += 2r2*r3</pre>
</div><br/><br/> <font color='orange'>LSL, LSR</font> mean '<font color='orange'>logical shift left / right</font>'<br/> <font color='orange'>ASL, ASR</font> mean '<font color='orange'>arithmetic shift left / right</font>'<br/> <font color='orange'>ROR</font> means '<font color='orange'>rotate right</font>'<br/> <font color='orange'>RRX</font> means '<font color='orange'>rotate right extended</font>'<br/><br/> <br>
<div align="center" class="limitview"><img src='http://www.hvaonline.net/hvaonline/upload/2008/1/23/8084e0fe2f42bc0087cd08fc85f90d5c_92659.gif' border="0" /></div><br/><br/> - Phép toán có thay đổi bit trạng thái: các phép toán loai này thường có thêm chữ "S" (Set Condition Codes) ở cuối. Ví dụ cho phép cộng 64-bit, số thứ nhất lưu ở r1:r0, số thứ 2 lưu ở r3:r2, kết quả lưu ở r5:r4<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>ADDS r4,r2,r0 ; 32-bit carry-out -&gt; C
ADC r5,r3,r1 ; added into top 32 bits</pre>
</div><br/><br/> - Phép nhân<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>MUL r4, r3, r2 ; r4 := &#40;r3 *r2&#41;&#91;31:0&#93;</pre>
</div><br/><br/> Phép nhân có tính cả phần tích lũy:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>MLA r4, r3, r2, r1 ; r4 := &#40;r3*r2+r1&#41;&#91;31:0&#93;</pre>
</div><br/><br/> Phép toán 64-bit trên ARM được hỗ trợ bởi thư viện <b>coredll </b>trong hệ điều hành Windows Mobile.<br/><br/> <b>Tổng kết các phép toán của ARM:</b><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Opcode Mnemonic Meaning Effect
&#91;24:21&#93;
0000 AND Logical bit-wise AND Rd:= Rn AND Op2
0001 EOR Logical bit-wise exclusive OR Rd:= Rn EOR Op2
0010 SUB Subtract Rd:= Rn - Op2
0011 RSB Reverse subtract Rd:= Op2 - Rn
0100 ADD Add Rd:= Rn + Op2
0101 ADC Add with carry Rd:= Rn + Op2 + C
0110 SBC Subtract with carry Rd:= Rn - Op2 + C - 1
0111 RSC Reverse subtract with carry Rd:= Op2 - Rn + C - 1
1000 TST Test Scc on Rn AND Op2
1001 TEQ Test equivalence Scc on Rn EOR Op2
1010 CMP Compare Scc on Rn - Op2
1011 CMN Compare negated Scc on Rn + Op2
1100 OPR Logical bit-wise OR Rd:= Rn OR Op2
1101 MOV Move Rd:= Op2
1110 BIC Bit clear Rd:= Rn AND NOT Op2
1111 MVN Move negated Rd:= NOT Op2</pre>
</div><br/> --------<br/> <font size='-1'><font color='white'>1. "Hacking Windows CE", Phrack Magazine, Volume 0x0b, Issue 0x3f, Phile #0x06 of 0x14<br/> 2.<span class="link"> http://www.ra.informatik.uni-stuttgart.de/~ghermanv/Lehre/SOC02/ARM_Presentation.pdf</span><br/> </font></font><br/><br/> <i><font color='white'>&lt;còn tiếp&gt;</font></i></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/17082.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/17082/102708.hva#102708,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Theo tớ biết thì các HĐH *nix có khả năng phần quyền và giới hạn truy cập rất hiệu quả, nên virus trên *nix không nhiều, và thường không gây thiệt hại lớn.<br/><br/> Tham khảo các viruses & worms trên *nix <span class="link"> http://en.wikipedia.org/wiki/List_of_Linux_computer_viruses</span>.<br/><br/> Dĩ nhiên, các virus thuần Windows không thể lây nhiễm trên *nix được <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"> Có virus multi-platform (W32.Winux - Lindose) nhưng mới chỉ ở dạng concept, không có payload <img src="/hvaonline/images/smilies/23621f7b9ade353e3aeff9f9ee30d871.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/92659.hva">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
							
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/0/92659.hva">1</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/30/92659.hva">2</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/60/92659.hva">3</a></span>
							
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/92659' + '.hva'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" >2</option>	
								<option value="3" >3</option>	
								<option value="4" selected="selected">4</option>	
								<option value="5" >5</option>	
								<option value="6" >6</option>	
								<option value="7" >7</option>	
								<option value="8" >8</option>	
						</select>
						
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/120/92659.hva">5</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/150/92659.hva">6</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/180/92659.hva">7</a></span>
								<a href="/hvaonline/posts/listByUser/210/92659.hva">
									<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 8" title="Page 8"/>
								</a>
						
						<a href="/hvaonline/posts/listByUser/210/92659.hva">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (8)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
