<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by seamoun, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by seamoun - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/332.html" name="top" class="maintitle" id="top">Messages posted by: seamoun</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/332.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/332.html">Profile for seamoun</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/332.html">Messages posted by seamoun</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">25</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/32029.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/32029/197766.html#197766,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><font color='red'>V. Kết luận</font><br/> Trong hệ thống chỉ sử dụng hai công cụ phân tích đơn giản là regshot và TCPView, do vậy để hệ thống có thể phân tích tốt hơn và sâu hơn thì sẽ sử dụng những công cụ khác, với nhiều tính tằng hơn và thay đổi kịch bản AutoIt cho tương ứng những công cụ thêm vào.<br/><br/> <font color='red'>VI. Video hệ thống đã thực hiện</font><br/> seamoun đã xây dựng xong và chạy thử nghiệm các bạn có thể download tại đây<br/><br/> Bài viết có tham khảo và sửa đổi kịch bản của tác giả Tyler Hudak<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/32029.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/32029/197762.html#197762,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Như các bạn đã biết, hiện nay có rất nhiều malware xuất hiện, do vậy với lượng malware ngày càng nhiều như vậy thì việc phân tích chúng cũng rất mất nhiều thời gian, chưa kể đến những malware phức tạp. Bài viết này với mong muốn giúp các bạn có thể hiểu sơ lược về hoạt động malware và cách thức xây dựng một hệ thống phân tích malware tự động như thế nào ? Theo ý kiến của seamoun thì không tham vọng xây dựng một hệ thống phân tích malware tự động mà có thể phân tích được tất cả malware xuất hiện, bởi vì malware hiện nay xuất hiện với nhiều hình thức khác nhau và hoạt động của chúng thì rất phức tạp (người phân tích soi còn không ra huống gì hệ thống tự động !!! <img src="/hvaonline/images/smilies/8558d3a641379e9d3e663b443adb34c1.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8558d3a641379e9d3e663b443adb34c1.gif" border="0" alt="smilie" align="absbottom"> ), thứ hai mà hệ thống có thể phân tích được tất cả các malware xuất hiện thì seamoun chắc nộp đơn xin nghỉ việc, vì mình chẳng có việc gì phải làm <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/6a0fe32c3736658bde52846b7df05e01.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/6a0fe32c3736658bde52846b7df05e01.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/6a0fe32c3736658bde52846b7df05e01.gif" border="0" alt="smilie" align="absbottom"> . Nhưng tại sao vẫn phát triển hệ thống phân tích malware tự động ? bởi vì hệ thống này sẽ giúp đỡ cho người phân tích bớt thời gian hơn cho những công đoạn mà người phân tích malware và cũng có cái nhìn tổng quát về những hành động, hành vi ban đầu của malware.<br/><br/> Ví dụ: Khi có một malware mới xuất hiện thì ban đầu để phân tích chúng thì phải chạy malware cho một môi trường độc lập (tức là môi trường khi mà malware thực hiện sẽ không gây hại gì cho hệ thống), môi trường như vậy người ta gọi là sandbox. Tiếp đến người phân tích sử dụng các công cụ phân tích sơ bộ rằng malware thực hiện những hành động gì khi chạy chúng (lưu registry key nào, tạo file gì mới trên hệ thống, thay đổi , tiêm nhiễm gì ....) sau đó sử dụng các công cụ như Ollydbg, IDA, ... để tiến hành phân tích code ... (ngồi đọc code và phân tích mấy con malware này chắc hacnho, mrro, ... các anh em khác trong HVA chắc rành hơn, còn seamoun nhìn thấy là hoa cả mắt <img src="/hvaonline/images/smilies/0ed54260213d71c024f0140fc341b79b.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/0ed54260213d71c024f0140fc341b79b.gif" border="0" alt="smilie" align="absbottom"> ). Như vậy có một số hoạt động phân tích sơ bộ về malware lặp đi lặp lại trong quá trình phân tích malware thì có thể chuyển nó cho một hệ thống phân tích tự động trước khi người phân tích malware tiến hành phân tích sâu hơn.<br/><br/> Ý tưởng và triển khai như sau:<br/> Sẽ có một máy Linux làm master, trên Linux sẽ thực hiện cài đặt một máy ảo (sử dụng VMWare) có cài đặt Windows XP (đây là môi trường để malware chạy và thực hiện phân tích). Linux và máy ảo chỉ kết nối Host-only, tức là chỉ có máy Linux và WMware nói chuyện được với nhau, để khi thực thi malware sẽ không làm ảnh hưởng đến các hệ thống khác. Trên máy Linux sẽ có một kịch bản shell được viết với mục đích thực hiện các phân tích ban đầu đối với malware (sẽ giải thích rõ hơn phần sau), tiếp đến sẽ thực hiện tự động bật VMware lên và đẩy malware vào môi trường VMWare, trên VMware sẽ có sẵn một số công cụ phân tích malware và thực hiện gọi script phân tích (sử dụng AutoIt Script) gọi các công cụ phân tích trên môi trường VMWare để tiến hành phân tích và tất cả các kết quả sau khi phân tích được xuất ra và gửi trở lại cho môi trường Linux và kết thúc quá trình phân tích.<br/><br/> Trên đây mình chỉ giới thiệu sơ bộ, chi tiết các bạn sẽ theo dõi phần sau đây:<br/><br/> <font color='red'>I. Các bước xây dựng một Automatic Malware Ananlysis</font><br/> <font color='orange'>I.1. Sử dụng một master script, script này sẽ chạy trên môi trường Linux và trên Linux có cài đặt sẵn WMWare có Windows XP SP2 (Sử dụng máy ảo này như một sandbox).</font><br/><br/> <font color='orange'>I.2. Trên Windows XP SP2 của máy ảo trong Linux nên chuẩn bị như sau:</font><br/> Cấu hình IP Address tĩnh và để card mạng chỉ là Host-only<br/> Tạo một thư mục chia sẻ VMWare để giao tiếp giữa Linux và WindowsXP<br/> Đặt user và pass cho máy Windows XP<br/> Firewall của Windows XP phải tắt<br/> Windows XP Simple File Sharing nên tắt<br/> Chuẩn bị công cụ SysInternal’s Process Monitor và RegShot, … có thể thêm công cụ phục vụ phân tích tùy thích.<br/> Cài đặt AutoIT để cho kịch bản AutoIt có thể chạy được.<br/><br/><br/> <font color='red'>II. Triển khai ứng dụng</font><br/> <font color='orange'>II.1. Cài đặt Backtrack trên hard disk</font><br/> Sử dụng tiện ích ubiquity<br/><br/> <font color='orange'>II.2. Cài đặt VMWare Workstation trên Linux</font><br/> Sử dụng phiên bản: VMware-Workstation-6.5.3-185404.i386.bundle<br/> Số serial : MVDUJ-TF4DT-284DV-4W9Z7<br/><br/> <font color='orange'>II.3. Cấu hình network trên Linux và máy ảo Windows XP</font><br/> Linux<br/> eth0 ip: 192.168.1.234<br/> vmnet1:192.168.32.1<br/> Windows<br/> Eth0 ip: 192.168.32.2<br/> Gateway: 192.168.32.1<br/><br/> <font color='orange'>II.4. Cài đặt InetSim trên Linux</font><br/> <font color='green'>II.4.1. Giới thiệu</font><br/> InetSim là một gói mà chứa các kịch bản Perl được sử dụng để mô phỏng các dịch vụ thông dụng như DNS, HTTP và FTP. Khi chạy, InetSim sẽ đợi những kết nối và log bất kỳ những gì mà nó nhận được trong định dạng log chuẩn, dễ đọc khi phân tích các kết nối ra ngoài của malware.<br/><br/> <font color='green'>II.4.2. Cài đặt</font><br/> Địa chỉ trang Web: http:/www.inetsim.org.<br/> Xem yêu cầu cần thiết trước khi cài đặt InetSim:<span class="link"> http://www.inetsim.org/requirements.html</span><br/> Giải nén và cài đặt tại /usr/local/inetsim.<br/> Tạo nhóm sử dụng cho InetSim<br/> # groupadd inetsim<br/> # ./setup.sh<br/> Cấu hình<br/> File cấu hình sẽ nằm tại thư mục sau: /usr/local/inetsim/conf/<br/> Thiết lập hai tham số service_bind_address và dns_default_ip là địa chỉ của vmnet1.<br/><br/> <font color='orange'>II.5. Cài đặt Volatility Framework trên Linux</font><br/> <font color='green'>II.5.1. Giới thiệu</font><br/> Để phục vụ cho việc Memory Analysis thì phải cần phải cài đặt Volatility Framework. Vì sao phải thực hiện Memory Analysis ? Bởi vì nhiều chương trình mã độc sử dụng packer để che dấu malware và làm khó khăn trong việc phân tích chúng. Tuy nhiên, packed malware phải unpacked trong bộ nhớ để thực thi. Bằng việc dumping một chương trình malware trong bộ nhớ, có thể kiểm tra nó mà không cần một packer.<br/> Do chúng ta sử dụng máy ảo cho nên việc ngừng tạm thời hoạt động của máy ảo thì chúng ta có thể phân tích memory của máy ảo thông qua file có phần mở rộng là .vmem.<br/><br/> <font color='green'>II.5.2. Cài đặt</font><br/> Địa chỉ Volatility Framework:<span class="link"> https://www.volatilesystems.com/default/volatility</span><br/><br/> <font color='orange'>II.6. Download PEiD và WinExe cho Linux</font><br/> PeiD<br/> Địa chỉ:<span class="link"> http://blog.didierstevens.com/</span><br/> WinExe<br/> winexe thực hiện giống chức năng của chương trình psexec trên Windows, cho phép thực hiện lệnh từ xa.<br/> Địa chỉ:<span class="link"> http://eol.ovh.org/winexe/</span><br/><br/> <font color='orange'>II.7. Cài đặt AutoIt, Regshot, TCPView trên Windows</font><br/> Cài đặt AutoIt<br/> Địa chỉ:<span class="link"> http://www.autoitscript.com/autoit3/</span><br/> Cài đặt Regshot<br/> Địa chỉ:<span class="link"> http://sourceforge.net/projects/regshot</span><br/> Cài đặt TCPView<br/> Địa chỉ:<span class="link"> http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx</span><br/> Lưu ý: công cụ Regshot và TCPView được tải về và cài đặt tại cùng một thư mục sau: c:\tools\<br/> Hiện tại demo chỉ hai công cụ, có thể tích hợp nhiều công cụ khác và khi đó chỉ cần thêm kịch bản chạy trong AutoIt.<br/><br/><br/> <font color='red'>III. Kịch bản trên Linux (analyze.sh)</font><br/> <font color='orange'>III.1. Giải thích biến khởi tạo</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Tên biến Mục dích
ANALYSIS_DIR Thư mục để chứa các report về malware, mỗi thư mục cấp dưới với md5 của malware là thư mục report về malware đã phân tích.
SHARED_FOLDER Thư mực sử dụng để chia sẻ malware cần phân tích giữa mỗi trường Linux và Windows. Malware sẽ được copy đến đây và từ đây sẽ map sang môi trường Windows.
INETSIM_DIR Thư mục cài đặt InetSim
VM_LOAD_TIMEOUT Biến sử dụng để định thời gian load của máy ảo, tùy thuộc vào khả năng load của máy ảo có thể tăng hoặc giảm thời gian timeout, đơn vị thời gian là giây
MALWARE_RUNTIME Là thời gian cho phép malware sẽ thực hiện trên máy ảo, đơn vị tính là giây
TIMEOUT Số lượng thời gian mà script sẽ đợi cho việc dynamic analysis hoàn tất
… Một số biến khác sẽ rõ trong quá trình giải thích chi tiết kịch bản.</pre>
</div><br/><br/> <font color='orange'>III.2. Giải thích chi tiết kịch bản</font><br/> <font color='green'>III.2.1. Giải thích một số đoạn kịch bản ban đầu</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#Kiểm tra nếu như đối số 1 rỗng &#40;tức không chỉ định malware cần phân tích&#41; hoặc file đó không tồn tại và không đọc được thì thông báo và thoát
if &#91; ! -n &quot;$1&quot; -o ! -r &quot;$1&quot; &#93;
then
echo &quot;Usage: 'basename $0' executable&quot;
exit
fi
if &#91; ! -d ${SHARED_FOLDER} &#93;
then
mkdir -p ${SHARED_FOLDER}
fi
MALWARE=&quot;$1&quot;
MD5=`md5sum ${MALWARE} | awk '{print $1}'`
# Malware sẽ được đặt trong thư mục $ANALYSIS_DIR/$MD5 của nó.
if &#91; -d ${ANALYSIS_DIR}/${MD5} &#93; ; then
echo &quot;${ANALYSIS_DIR}/${MD5} already exists. Exiting.&quot;
exit
fi
OUTDIR=&quot;${ANALYSIS_DIR}/${MD5}&quot;
echo ${MALWARE} ${MD5} &gt;&gt; ${ANALYSIS_DIR}/records.txt
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting analysis on ${MALWARE}.
echo `date +&quot;&#91;%F %T&#93;&quot;` Results will be placed in ${OUTDIR}
echo
mkdir ${OUTDIR}
REPORT=${OUTDIR}/${REPORT_NAME}</pre>
</div><br/><br/> <font color='green'>III.2.2. Giải thích phần Static Analysis</font><br/> Trong kịch bản sử dụng dịch vụ của Team Cymru Hash Database. Ý nghĩa của dịch vụ này là gửi MD5 của malware cần phần tích đến dịch vụ và dịch vụ sẽ phản hồi lại: nếu như malware đó được được phát hiện thì nó sẽ hiển thị ngày giờ mà dịch vụ cập nhật và phần trăm phần mềm diệt virus diệt được nó.<br/> Chi tiết về dịch vụ này có thể xem thêm tại:<br/><span class="link"> http://www.team-cymru.org/Services/MHR/</span><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Static Analysis
echo -e &quot;Analysis of ${MALWARE}\n&quot; &gt; ${REPORT}
echo &quot;MD5 Hash: ${MD5}&quot; &gt;&gt; ${REPORT}
echo &quot;Team Cymru Hash Database:&quot; &gt;&gt; ${REPORT}
whois -h hash.cymru.com ${MD5} &gt;&gt; ${REPORT}
# grab both ASCII and UNIcode strings from the sample
echo `date +&quot;&#91;%F %T&#93;&quot;` Running strings.
&#40;strings -a -t x ${MALWARE}; strings -a -e l -t x ${MALWARE}&#41; \
| sort &gt; ${OUTDIR}/strings.txt
# run pecheck.py
echo `date +&quot;&#91;%F %T&#93;&quot;` Running pecheck.py.
python pecheck.py -d ${PEID_DB} ${MALWARE} &gt; ${OUTDIR}/pecheck.txt</pre>
</div><br/><br/> Tiếp theo là thực hiện grab các ASCII và UNION string có trong malware. Trong file thực thi của malware khi chúng ta thu thập các string này có thể giúp ích có một số thông tin về malware như : có thể địa chỉ url mà malware có thể kết nối đến, các tài nguyên mà malware lấy, … Tuy nhiên việc thu thập này chỉ là phần phụ, nhỏ bởi hầu như các malware hiện nay đều được packed, do vậy string sẽ xuất hiện dưới dạng string không tường minh.<br/> Đoạn mã thực hiện python pecheck.py, pecheck.py là một chương trình Python được viết bởi Didier Stevens để xuất thông tin PE header từ malware. Thông tin này sẽ rất hữu ích bởi vì nó cho biết malware được biên dịch khi nào, các phân đoạn thực thi và các hàm được import vào. Hơn nữa nó còn so sánh với PeiD database để biết được malware được pack bởi loại packer nào.<br/><br/> <font color='green'>III.2.3. Khởi động InetSim</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>echo `date +&quot;&#91;%F %T&#93;&quot;` Starting InetSim.
CWD=`pwd`
mkdir -p ${OUTDIR}/inetsim
cd ${INETSIM_DIR}
sudo ./inetsim --session inetsim --config ${INETSIM_DIR}/conf/inetsim.conf \
--log-dir ${OUTDIR}/inetsim --report-dir ${OUTDIR} &gt; /dev/null & cd ${CWD}</pre>
</div><br/><br/> InetSim phải được chạy dưới quyền root, do vậy sử dụng lệnh sudo. Và ý nghĩa của các tham số như sau:<br/> -session: chỉ định tên cho phiên làm việc.<br/> -config: chỉ định nơi cấu hình được nạp.<br/> -log-dir: chỉ định nơi log.<br/> -report-dir: chỉ định nơi xuất ra report.<br/> Sẽ có ba file log được tạo ra đó là debug.log, service.log và main.log. Ý nghĩa của main.log chỉ đề cập đến hoạt động của InetSim (những vấn đề liên quan đến hoạt động của InetSim). Phần chúng ta quan tâm đó là phần mà malware kết nối ra ngoài sẽ được lưu tại service.log.<br/><br/> <font color='green'>III.2.4. Khởi động Tcpdump</font><br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>echo `date +&quot;&#91;%F %T&#93;&quot;` Starting tcpdump.
sudo tcpdump -i vmnet1 -n -s 0 -w ${OUTDIR}/tcpdump.pcap &
TCPPID=`jobs -l | grep &quot;sudo tcpdump&quot; | awk '{ print $2 }'`</pre>
</div><br/><br/> Tác dụng của TCPDump là một sniffer trên Linux, sử dụng nó để quan sát và ghi lại những hoạt động trao đổi của malware với môi trường ngoài, mà ở đây là Linux, do ta cấu hình Linux và Windows XP là Host-only, nên ta thực hiện sniff trên card vmnet1.<br/><br/> <font color='green'>III.2.5. Khởi động VMWare</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Start up VMWare
# First we revert to our base snapshot
vmrun revertToSnapshot &quot;/root/vmware/MalwareAnalysis/sandbox.vmx&quot; base
# Then we start VMWare running
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting VMWare.
vmrun start &quot;/root/vmware/MalwareAnalysis/sandbox.vmx&quot;
sleep ${VM_LOAD_TIMEOUT}
# Move the malware over to the sandbox
cp ${MALWARE} ${SHARED_FOLDER}/malware.exe
# Set up the share and execute the AutoIT script
echo `date +&quot;&#91;%F %T&#93;&quot;` Setting up network share.
winexe -U WORKGROUP/analysis%analysis --interactive=1 --system //192.168.32.2 'cmd /c net use z: \\192.168.32.1\malware'
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting dynamic analysis script.
winexe -U WORKGROUP/analysis%analysis --interactive=1 --system //192.168.32.2 &quot;c:\progra~1\autoit3\autoit3.exe c:\tools\scripts\analyze.au3 z:\malware.exe z:\ ${MALWARE_RUNTIME}&quot;
sleep ${MALWARE_RUNTIME}
LOOP=0
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting check for finished file.
# Check for finished file - if not there, wait
while &#91; ! -f ${SHARED_FOLDER}/_analysis_finished &#93; ; do
echo Checking...
sleep ${TIMEOUT}
LOOP=$&#40;&#40; $LOOP + 1 &#41;&#41;
if &#91; ${LOOP} -gt 5 &#93; ; then
echo `date +&quot;&#91;%F %T&#93;&quot;` ERROR: Sandbox is hung.
break;
fi
done
# Remove the share
echo `date +&quot;&#91;%F %T&#93;&quot;` Removing network share.
winexe -U WORKGROUP/analysis%analysis --interactive=1 --system //192.168.32.2 'cmd /c net use z: /delete'
# Stop the VMWare Image
echo `date +&quot;&#91;%F %T&#93;&quot;` Suspending VMWare.
vmrun suspend &quot;/root/vmware/MalwareAnalysis/sandbox.vmx&quot;</pre>
</div><br/><br/> 1) Trước khi thực hiện chạy kịch bản ta cần phải Take SnapShot VMWare 1 lần và đặt tên nó là base.<br/><br/> 2) vmware revertToSnapShot &quot;/root/vmware/MalwareAnalysis/sandbox.vmx&quot; base sẽ đưa VMWare về trạng thái SnapShot mà chúng ta đã lưu. Cần phải làm như vậy bởi vì VMWare phải luôn đặt trong tình trạng chưa có bất kỳ malware nào thực hiện trước khi chép malware vào máy ảo phân tích.<br/><br/> 3) Khởi động VMWare và copy malware cần phân tích vào thư mục shared trên Linux.<br/><br/> 4) Sau khi khởi động xong máy ảo Windows XP SP2 (trước đó chúng ta đã tạo một user và pass là analysis) chúng ta sẽ thực hiện map thư mục chia sẻ trên Linux vào máy Windows XP. Lưu ý nếu trên Linux không thể chia sẻ được có thể do chưa cài dịch vụ Samba, do vậy cần phải cài dịch vụ Samba để Linux có thể chia sẻ file.<br/><br/> 5) Khởi động script analysis.au3 trên Windows XP để chạy kịch bản phân tích malware tự động trên Windows XP.<br/><br/> 6) Chờ đợi kết quả từ máy ảo Windows XP, việc chờ đợi sẽ kết thúc khi máy ảo Windows XP xuất file _analysis_finished.<br/><br/> 7) Sau khi kết thúc kịch bản analysis.au3 trên Windows XP thì sẽ gỡ bỏ map ổ đĩa trên Windows XP và suppend máy ảo.<br/><br/> <font color='green'>III.2.6. Thực hiện Volatility trên Memory</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Run Volatility on memory
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting Volatility psscan2.
python /usr/local/src/Volatility-1.3_Beta/volatility psscan2 -f &quot;/root/vmware/MalwareAnalysis/sandbox.vmem&quot; \
&gt; ${OUTDIR}/volatility-psscan.txt
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting Volatility connscan2.
python /usr/local/src/Volatility-1.3_Beta/volatility connscan2 -f &quot;/root/vmware/MalwareAnalysis/sandbox.vmem&quot; \
&gt; ${OUTDIR}/volatility-connscan2.txt
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting Volatility dlllist.
python /usr/local/src/Volatility-1.3_Beta/volatility dlllist -f &quot;/root/vmware/MalwareAnalysis/sandbox.vmem&quot; \
&gt; ${OUTDIR}/volatility-dlllist.txt
echo `date +&quot;&#91;%F %T&#93;&quot;` Starting Volatility modscan2.
python /usr/local/src/Volatility-1.3_Beta/volatility modscan2 -f &quot;/root/vmware/MalwareAnalysis/sandbox.vmem&quot; \
&gt; ${OUTDIR}/volatility-modscan2.txt
# Move Results
echo `date +&quot;&#91;%F %T&#93;&quot;` Cleaning up.
mv ${SHARED_FOLDER}/* ${OUTDIR}</pre>
</div><br/><br/> 1) Sẽ thực hiện psscan2 module. Điều này rất hữu ích để phân tích các rootkit thường ẩn các tiến trình của malware trên hệ thống. Bằng việc truy vấn trực tiếp vào các danh sách tiến trình từ bộ nhớ, rootkit không thể ẩn tiến trình của chúng và người phân tích có thể quan sát một cách trực quan các tiến trình chạy trên hệ thống đã nhiễm malware.<br/><br/> 2) Tiếp đến sẽ thực hiện truy vấn các kết nối trên hệ thống bị nhiễm với connscan2 module. Bởi vì những kết nối cũng có thể ẩn bởi rootkit, do vậy truy vấn trực tiếp lấy những kết nối mạng từ bộ nhớ sẽ cho phép người phân tích thấy được những kết nối trong hệ thống bị nhiễm malware.<br/><br/> 3) Cuối cùng sẽ thực hiện xem thử những dll nào được nạp trong quá trình malware thực thi bằng cách sử dụng modscan2, bởi vì malware có thể tự nó nhiễm qua một tiến trình khác như là một DLL hoặc tự nó nạp, …<br/><br/> <font color='green'>III.2.7. Kịch bản kết thúc quá trình phân tích</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Stop tcpdump. Since its running as root we need to sudo to kill it
if &#91; ! -z ${TCPPID} &#93;; then
sudo kill ${TCPPID}
fi
# Stop InetSim
if &#91; -f /var/run/inetsim.pid &#93; ; then
INETPID=`cat /var/run/inetsim.pid`
sudo kill ${INETPID} &gt; /dev/null
wait ${INETPID}
fi
# check to see if malware.exe is in the outdir - if so, delete it
if &#91; -f ${OUTDIR}/malware.exe &#93;; then
rm -f ${OUTDIR}/malware.exe
fi
# Reset permissions on the files
sudo chown -R ${WHOAMI} ${OUTDIR}
echo `date +&quot;&#91;%F %T&#93;&quot;` Analysis finished.</pre>
</div><br/><br/> <font color='red'>IV. Kịch bản trên Windows</font><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>; AutoIT Windows Malware Automation Script
Func startRegshot&#40;$logDir&#41;
; Start up regshot as user analysis
RunAs&#40;&quot;analysis&quot;,&quot;&quot;,&quot;analysis&quot;,0,&quot;c:\tools\regshot\regshot.exe&quot;&#41;
WinActivate&#40;&quot;Regshot&quot;&#41;
WinWaitActive&#40;&quot;Regshot&quot;&#41;
; set to plain text
ControlClick&#40;&quot;Regshot&quot;,&quot;Plain &TXT&quot;,&quot;Button7&quot;&#41;
; set scan dir info
ControlClick&#40;&quot;Regshot&quot;,&quot;&Scan dir1&quot;,&quot;Button9&quot;&#41;
ControlClick&#40;&quot;Regshot&quot;,&quot;&quot;,1027&#41;
send&#40;&quot;{HOME}&quot;&#41;
send&#40;&quot;{LSHIFT}+{END}&quot;&#41;
send&#40;&quot;c:\&quot;&#41;
; set output dir
ControlClick&#40;&quot;Regshot&quot;,&quot;&quot;,1026&#41;
send&#40;&quot;{HOME}&quot;&#41;
send&#40;&quot;{LSHIFT}+{END}&quot;&#41;
send&#40;$logDir&#41;
; set the comment
ControlClick&#40;&quot;Regshot&quot;,&quot;&quot;,1025&#41;
send&#40;&quot;regshot&quot;&#41;
; Start the scan
ControlClick&#40;&quot;Regshot&quot;,&quot;&1st shot&quot;,&quot;Button1&quot;&#41;
send&#40;&quot;s&quot;&#41;
; wait until the scan is done or 30 seconds
WinWaitActive&#40;&quot;Regshot&quot;,&quot;Dirs:&quot;,30&#41;
EndFunc
Func stopRegshot&#40;&#41;
; WinWaitActive&#40;&quot;Regshot&quot;&#41;
WinSetState&#40;&quot;Regshot&quot;,&quot;&quot;,@SW_RESTORE&#41;
WinActivate&#40;&quot;Regshot&quot;&#41;
; stop the scan and run the second shot
WinWaitActive&#40;&quot;Regshot&quot;&#41;
ControlClick&#40;&quot;Regshot&quot;,&quot;&2nd shot&quot;,&quot;Button2&quot;&#41;
send&#40;&quot;s&quot;&#41;
; now compare
WinActivate&#40;&quot;Regshot&quot;&#41;
WinWaitActive&#40;&quot;Regshot&quot;,&quot;c&Ompare&quot;,10&#41;
send&#40;&quot;o&quot;&#41;
; Wait for notepad to pop up
WinWait&#40;&quot;&#91;CLASS:Notepad&#93;&quot;, &quot;&quot;&#41;
WinActivate&#40;&quot;&#91;CLASS:Notepad&#93;&quot;, &quot;&quot;&#41;
WinClose&#40;&quot;&#91;CLASS:Notepad&#93;&quot;, &quot;&quot;&#41;
; Close Regshot
WinActivate&#40;&quot;Regshot&quot;&#41;
WinClose&#40;&quot;Regshot&quot;&#41;
EndFunc
Func startProcmon&#40;&#41;
; Start ProcMon
; Run Procmon as user analysis
RunAs&#40;&quot;analysis&quot;,&quot;&quot;,&quot;analysis&quot;,0,&quot;c:\tools\procmon\procmon.exe&quot;&#41;
WinWaitActive&#40;&quot;Process Monitor - Sysinternals: www.sysinternals.com&quot;&#41;
EndFunc
Func stopProcmon&#40;$logDir&#41;
; stop procmon
WinActivate&#40;&quot;Process Monitor&quot;&#41;
; stop procmon with a CTRL+e and wait for it to finish
Send&#40;&quot;^e&quot;&#41;
WinWaitActive&#40;&quot;Process Monitor - Sysinternals: www.sysinternals.com&quot;&#41;
; save the captured data with CTRL+s
Send&#40;&quot;^s&quot;&#41;
WinActivate&#40;&quot;Save To File&quot;,&quot;Events to save:&quot;&#41;
ControlSetText&#40;&quot;Save To File&quot;,&quot;Events to save:&quot;,1027,$logDir & &quot;procmon.csv&quot;&#41;
; save the output in CSV format
ControlClick&#40;&quot;Save To File&quot;,&quot;Events to save:&quot;,&quot;Button7&quot;&#41;
ControlClick&#40;&quot;Save To File&quot;,&quot;Events to save:&quot;,1&#41;
; If the file already exists, overwrite it
if WinWaitActive&#40;&quot;Process Monitor&quot;,&quot;&Yes&quot;,1&#41; Then
ControlClick&#40;&quot;Process Monitor&quot;,&quot;&Yes&quot;,&quot;Button1&quot;&#41;
EndIf
WinClose&#40;&quot;Process Monitor - Sysinternals: www.sysinternals.com&quot;&#41;
EndFunc
; Main Function
; There are 2 options required – make sure they are there
If $CmdLine&#91;0&#93; &lt;&gt; 3 Then
msgbox&#40;4096,&quot;ERROR&quot;,&quot;Usage: malware.exe dir_to_log pause_time&quot;,10&#41;
Exit
EndIf
; The malware to execute is the 1st parameter
$malware=$CmdLine&#91;1&#93;
$runmalware=&quot;c:\tools\malware\malware.exe&quot;
; The dir to log to is the 2nd parameter
$logdir = $CmdLine&#91;2&#93;
$saveresult=$logdir
$logdir=&quot;c:\tools\malware\&quot;
; The time to pause &#40;in seconds&#41; is the last parameter
$pauseTime = $CmdLine&#91;3&#93;
; start our monitoring tools
filecopy&#40;$malware,$runmalware,1&#41;
startRegshot&#40;$logdir&#41;
startProcmon&#40;&#41;
WinMinimizeAll&#40;&#41;
; run the malware as user analysis
RunAs&#40;&quot;analysis&quot;,&quot;&quot;,&quot;analysis&quot;,0,$runmalware&#41;
; wait – note time is in milliseconds
sleep&#40;$pauseTime * 1000&#41;
; stop our monitoring tools and save the results
stopProcmon&#40;$logdir&#41;
stopRegshot&#40;&#41;
FileDelete&#40;&quot;z:\*.*&quot;&#41;
filecopy&#40;&quot;c:\tools\malware\*.*&quot;,&quot;z:\*.*&quot;,1&#41;
; let them know we're finished by creating a FileChangeDir
$file=FileOpen&#40;$logdir & &quot;_analysis_finished&quot;,10&#41;
FileClose&#40;$file&#41;
FileCopy&#40;$logdir & &quot;_analysis_finished&quot;,&quot;z:\_analysis_finished&quot;,1&#41;</pre>
</div><br/><br/> --------------------------------------------------------------------------------------<br/> From quanta: Bài viết công phu quá. Mình xin phép được enter mấy phát cho dễ đọc.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25210.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25210/187477.html#187477,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">constructor_87 wrote:</cite><br>
<blockquote>@seamoun: vừa học nhưng cũng vừa ....(hehe...) cho nó đỡ nhạt bác à hii<br/> @MrKenichi: chưa biết lỗi của từng loại database như thế nào thì sao mà so sánh hả bác <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> tiện cho em test kiến thức về SQL chút <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SQL query : SELECT * FROM hn_train WHERE N_ID=26 UNION SELECT TOP 1 TABLE_NAME FROM INFORMATION_SCHEMA.TABLES–
SQL Error : &#40;1064&#41; You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the &#91;color=#444444&#93;&#91;color=red&#93;right syntax to u&#91;/color&#93;se near '1 &#91;/color&#93;TABLE_NAME FROM INFORMATION_SCHEMA.TABLES–' at line 1
File : Trainning.php
Line : 100</pre>
</div><br/><br/> =&gt; datbase là SQL server, lỗi là do truy vấn<br/> UNION SELECT <font color='#444444'>[colo</font>r=red]TOP 1[/color] TABLE_NAME FROM INFORMATION_SCHEMA.TABLES–<br/> sai trường và table.<br/> em kết luận vấy chuẩn chưa ạ? &nbsp;
</blockquote><br/><br/> Tôi đã nói là bạn hãy học kỹ SQL đối với từng loại database rồi hãy hỏi. </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25210.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25210/187461.html#187461,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">constructor_87 wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">lyhuuloi wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">constructor_87 wrote:</cite><br>
<blockquote>thôi thì bác chiếu cố bật mí cho em tí. chứ em cũng đang mày mò SQL đâu phải hỏi chơi đâu ạ , huu&nbsp;
</blockquote><br/> Bác conmale nói đúng mà <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> Nếu đúng là đang mò SQL thật, thì chắc hẳn nhìn câu 2 đã trả lời cho câu 1 rồi, học đi trước khi học chạy nhé bạn <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/><br/> PS: Em thích câu trả lời của bác conmale lắm <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">&nbsp;
</blockquote><br/> hỏi là cách học tập nhanh nhất mà.... em đang học chứ có chơi đâu bác lyhuuloi <img src="/hvaonline/images/smilies/007b98d50fd1de35a654e100103ddac6.gif" border="0" alt="smilie" align="absbottom"> &nbsp;
</blockquote><br/> Theo seamoun thì bạn nên học từ cái căn bản nhất, rồi hãy tính đến chuyện security, hack hiếc này nọ, chứ đừng đụng cái gì cũng hỏi, phải học và làm đi, khi đó nếu có trở ngại thì mới hỏi. Đề nghị không hỏi vu vơ trong chủ đề này nữa ! <img src="/hvaonline/images/smilies/8558d3a641379e9d3e663b443adb34c1.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8558d3a641379e9d3e663b443adb34c1.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/18923.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/18923/183389.html#183389,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Sau 1 thời gian không viết tiếp chủ đề này do seamoun bận qué (từ năm ngoái, do cưới vợ --&gt; sinh con --&gt; cho con bú <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> ) nên giờ tranh thủ thời gian viết tiếp. Giống viết truyện Conan quá , 1 năm cho ra 1 cuốn <img src="/hvaonline/images/smilies/6a0fe32c3736658bde52846b7df05e01.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8558d3a641379e9d3e663b443adb34c1.gif" border="0" alt="smilie" align="absbottom"> . Hi hi hi<br/><br/> <font color='orange'><b>Passive OS Fingerprinting</b></font><br/> Kỹ thuật Passive OS Fingerprinting là liên quan đến việc sử dụng sniffing để nhận diện hệ điều hành khác với Active OS Fingerprinting dùng scanning để thực hiện nhận diện hệ điều hành.<br/> Dựa vào đặc tính của packet được sử dụng để nhận biết hệ điều hành. Sau đây là một số thuộc tính của TCP/IP dùng để xét khi thực hiện Passive OS Fingerprinting:<br/> 1. TTL: Dựa vào Time-To-Live của mỗi packet trong hệ điều hành<br/> 2. Window size: Tùy theo hệ điều hành mà có thể set các window size khác nhau.<br/> 3. DF (Don’t Fragment bit): Hệ điều hành có thiết lập việc phân rã bit hay không ?<br/> 4. …<br/> Bằng việc sniffing và phân tích packet có các thuộc tính ở trên, chương trình sẽ so sánh với một database thuộc tính và đưa ra kết quả của hệ điều hành sử dụng là gì. Một số công cụ thực hiện Passive OS Fingerprinting có thể kể đến là siphon <span class="link"> http://packetstormsecurity.org/UNIX/utilities/siphon-v.666.tar.gz</span> ), p0f <span class="link"> http://lcamtuf.coredump.cx/p0f.shtml</span>)<br/> Ví dụ một số dấu hiệu nhận biết hệ điều hành của chương trình p0f<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># ----------------- Windows -----------------
# Windows TCP/IP stack is a mess. For most recent XP, 2000 and
# seem. Luckily for us, almost all Windows 9x boxes have an
8192:32:1:44:M*:.:Windows:3.11 &#40;Tucows&#41;
S44:64:1:64:M*,N,W0,N,N,T0,N,N,S:.:Windows:95
8192:128:1:64:M*,N,W0,N,N,T0,N,N,S:.:Windows:95b
# Windows 98 it is no longer possible to tell them from each other
S44:32:1:48:M*,N,N,S:.:Windows:98 &#40;low TTL&#41; &#40;1&#41;
8192:32:1:48:M*,N,N,S:.:Windows:98 &#40;low TTL&#41; &#40;2&#41;
%8192:64:1:48:M536,N,N,S:.:Windows:98 &#40;13&#41;
%8192:128:1:48:M536,N,N,S:.:Windows:98 &#40;15&#41;
S4:64:1:48:M*,N,N,S:.:Windows:98 &#40;1&#41;
S6:64:1:48:M*,N,N,S:.:Windows:98 &#40;2&#41;
S12:64:1:48:M*,N,N,S:.:Windows:98 &#40;3
T30:64:1:64:M1460,N,W0,N,N,T0,N,N,S:.:Windows:98 &#40;16&#41;
32767:64:1:48:M*,N,N,S:.:Windows:98 &#40;4&#41;
37300:64:1:48:M*,N,N,S:.:Windows:98 &#40;5&#41;
46080:64:1:52:M*,N,W3,N,N,S:.:Windows:98 &#40;RFC1323+&#41;
65535:64:1:44:M*:.:Windows:98 &#40;no sack&#41;
S16:128:1:48:M*,N,N,S:.:Windows:98 &#40;6&#41;
S16:128:1:64:M*,N,W0,N,N,T0,N,N,S:.:Windows:98 &#40;7&#41;
S26:128:1:48:M*,N,N,S:.:Windows:98 &#40;8&#41;
T30:128:1:48:M*,N,N,S:.:Windows:98 &#40;9&#41;
32767:128:1:52:M*,N,W0,N,N,S:.:Windows:98 &#40;10&#41;
60352:128:1:48:M*,N,N,S:.:Windows:98 &#40;11&#41;
60352:128:1:64:M*,N,W2,N,N,T0,N,N,S:.:Windows:98 &#40;12&#41;
T31:128:1:44:M1414:.:Windows:NT 4.0 SP6a &#40;1&#41;
64512:128:1:44:M1414:.:Windows:NT 4.0 SP6a &#40;2&#41;
8192:128:1:44:M*:.:Windows:NT 4.0 &#40;older&#41;
# Windows XP and 2000. Most of the signatures that were
65535:128:1:48:M*,N,N,S:.:Windows:2000 SP4, XP SP1+
%8192:128:1:48:M*,N,N,S:.:Windows:2000 SP2+, XP SP1+ &#40;seldom 98&#41;
S20:128:1:48:M*,N,N,S:.:Windows:SP3
S45:128:1:48:M*,N,N,S:.:Windows:2000 SP4, XP SP1+ &#40;2&#41;
40320:128:1:48:M*,N,N,S:.:Windows:2000 SP4
S6:128:1:48:M*,N,N,S:.:Windows:XP, 2000 SP2+
S12:128:1:48:M*,N,N,S:.:Windows:XP SP1+ &#40;1&#41;
S44:128:1:48:M*,N,N,S:.:Windows:XP SP1+, 2000 SP3
64512:128:1:48:M*,N,N,S:.:Windows:XP SP1+, 2000 SP3 &#40;2&#41;
32767:128:1:48:M*,N,N,S:.:Windows:XP SP1+, 2000 SP4 &#40;3&#41;
# Windows 2003 & Vista
8192:128:1:52:M*,W8,N,N,N,S:.:Windows:Vista &#40;beta&#41;
32768:32:1:52:M1460,N,W0,N,N,S:.:Windows:2003 AS
65535:64:1:52:M1460,N,W2,N,N,S:.:Windows:2003 &#40;1&#41;
65535:64:1:48:M1460,N,N,S:.:Windows:2003 &#40;2&#41;
S52:128:1:48:M1260,N,N,S:.:Windows:XP/2000 via Cisco
65520:128:1:48:M*,N,N,S:.:Windows:XP bare-bone
16384:128:1:52:M536,N,W0,N,N,S:.:Windows:2000 w/ZoneAlarm?
2048:255:0:40:.:.:Windows:.NET Enterprise Server
44620:64:0:48:M*,N,N,S:.:Windows:ME no SP &#40;?&#41;
S6:255:1:48:M536,N,N,S:.:Windows:95 winsock 2
32000:128:0:48:M*,N,N,S:.:Windows:XP w/Winroute?
16384:64:1:48:M1452,N,N,S:.:Windows:XP w/Sygate? &#40;1&#41;
17256:64:1:48:M1460,N,N,S:.:Windows:XP w/Sygate? &#40;2&#41;
*:128:1:48:M*,N,N,S:U:-Windows:XP/2000 while downloading &#40;leak!&#41;
32768:32:1:44:M1460:.:Windows:CE 3
3100:32:1:44:M1460:.:Windows:CE 2.0
*:128:1:52:M*,N,W0,N,N,S:.:@Windows:XP/2000 &#40;RFC1323+, w, tstamp-&#41;
*:128:1:52:M*,N,W*,N,N,S:.:@Windows:XP/2000 &#40;RFC1323+, w+, tstamp-&#41;
*:128:1:52:M*,N,N,T0,N,N,S:.:@Windows:XP/2000 &#40;RFC1323+, w-, tstamp+&#41;
*:128:1:64:M*,N,W0,N,N,T0,N,N,S:.:@Windows:XP/2000 &#40;RFC1323+, w, tstamp+&#41;
*:128:1:64:M*,N,W*,N,N,T0,N,N,S:.:@Windows:XP/2000 &#40;RFC1323+, w+, tstamp+&#41;
*:128:1:48:M536,N,N,S:.:@Windows:98
*:128:1:48:M*,N,N,S:.:@Windows:XP/2000</pre>
</div><br/> Một số dấu hiệu để nhận biết hệ điều hành Linux<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># ----------------- Linux -------------------
S1:64:0:44:M*:A:Linux:1.2.x
512:64:0:44:M*:.:Linux:2.0.3x &#40;1&#41;
16384:64:0:44:M*:.:Linux:2.0.3x &#40;2&#41;
2:64:0:44:M*:.:Linux:2.0.3x &#40;MkLinux&#41; on Mac &#40;1&#41;
64:64:0:44:M*:.:Linux:2.0.3x &#40;MkLinux&#41; on Mac &#40;2&#41;
S4:64:1:60:M1360,S,T,N,W0:.:Linux:2.4 &#40;Google crawlbot&#41;
S4:64:1:60:M1430,S,T,N,W0:.:Linux:2.4-2.6 &#40;Google crawlbot&#41;
S2:64:1:60:M*,S,T,N,W0:.:Linux:2.4 &#40;large MTU?&#41;
S3:64:1:60:M*,S,T,N,W0:.:Linux:2.4 &#40;newer&#41;
S4:64:1:60:M*,S,T,N,W0:.:Linux:2.4-2.6
S3:64:1:60:M*,S,T,N,W1:.:Linux:2.6, seldom 2.4 &#40;older, 1&#41;
S4:64:1:60:M*,S,T,N,W1:.:Linux:2.6, seldom 2.4 &#40;older, 2&#41;
S3:64:1:60:M*,S,T,N,W2:.:Linux:2.6, seldom 2.4 &#40;older, 3&#41;
S4:64:1:60:M*,S,T,N,W2:.:Linux:2.6, seldom 2.4 &#40;older, 4&#41;
T4:64:1:60:M*,S,T,N,W2:.:Linux:2.6 &#40;older, 5&#41;
S4:64:1:60:M*,S,T,N,W5:.:Linux:2.6 &#40;newer, 1&#41;
S4:64:1:60:M*,S,T,N,W6:.:Linux:2.6 &#40;newer, 2&#41;
S4:64:1:60:M*,S,T,N,W7:.:Linux:2.6 &#40;newer, 3&#41;
T4:64:1:60:M*,S,T,N,W7:.:Linux:2.6 &#40;newer, 4&#41;
S20:64:1:60:M*,S,T,N,W0:.:Linux:2.2 &#40;1&#41;
S22:64:1:60:M*,S,T,N,W0:.:Linux:2.2 &#40;2&#41;
S11:64:1:60:M*,S,T,N,W0:.:Linux:2.2 &#40;3&#41;
S4:64:1:48:M1460,N,W0:.:Linux:2.4 in cluster
32767:64:1:60:M16396,S,T,N,W0:.:Linux:2.4 &#40;loopback&#41;
32767:64:1:60:M16396,S,T,N,W2:.:Linux:2.6 &#40;newer, loopback&#41;
S8:64:1:60:M3884,S,T,N,W0:.:Linux:2.2 &#40;loopback&#41;
16384:64:1:60:M*,S,T,N,W0:.<img src="/hvaonline/images/smilies/4f69bf3ec0ad41cad623f5db36cc3a7c.gif" border="0" alt="smilie" align="absbottom">inux:2.2 &#40;Opera?&#41;
32767:64:1:60:M*,S,T,N,W0:.<img src="/hvaonline/images/smilies/4f69bf3ec0ad41cad623f5db36cc3a7c.gif" border="0" alt="smilie" align="absbottom">inux:2.4 &#40;Opera?&#41;
S22:64:1:52:M*,N,N,S,N,W0:.:Linux:2.2 &#40;tstamp-&#41;
S4:64:1:52:M*,N,N,S,N,W0:.:Linux:2.4 &#40;tstamp-&#41;
S4:64:1:52:M*,N,N,S,N,W2:.:Linux:2.6 &#40;tstamp-&#41;
S4:64:1:44:M*:.:Linux:2.6? &#40;barebone, rare!&#41;
T4:64:1:60:M1412,S,T,N,W0:.:Linux:2.4 &#40;rare!&#41;
27085:128:0:40:.:.<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">ell<img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">owerApp cache &#40;Linux-based&#41;</pre>
</div><br/> Ngoài Linux và Windows còn các dấu hiệu đề nhận biết các hệ điều hành khác<br/> Cách thức điều tra hệ điều với kỹ thuật Passive OS Fingerprint<br/> <br>
<div align="center" class="limitview"><img src='http://img14.imageshack.us/img14/9145/pfpsteps.jpg' border="0" /></div><br/> Ngoài việc sử dụng các chương trình trên có thể điều tra hệ điều hành thông qua một trang web nổi tiếng về report các OS:<span class="link"> http://netcraft.com.</span> Khi truy cập trang Web này chỉ cần gõ domain của server đích cần kiểm tra thì Website sẽ thông báo chi tiết các OS sử dụng cũng như ngày giờ và các thông tin về Web Server sử dụng cũng như các thành phần khác…<br/> Ví dụ một điều tra OS đối với domain vnexpress.net<br/> <br>
<div align="center" class="limitview"><img src='http://img31.imageshack.us/img31/9831/netcraft.jpg' border="0" /></div><br/> Ưu điểm của kỹ thuật Passive OS Fingerprint là không thực hiện scanning mà sniffing, và từ kết quả phân tích sniffing với các dấu hiệu tương ứng so với database đưa ra kết quả của OS đang chạy là gì, cho nên không làm “ồn ào” đối với hệ thống đích như là thực hiện Active OS Fingerprinting. Tất nhiên nhược điểm lớn nhất của kỹ thuật này là tính chính xác không cao<br/><br/> (continue ...)</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/332.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
							
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/0/332.html">1</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/30/332.html">2</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/60/332.html">3</a></span>
							
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/332' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" >2</option>	
								<option value="3" >3</option>	
								<option value="4" selected="selected">4</option>	
								<option value="5" >5</option>	
								<option value="6" >6</option>	
								<option value="7" >7</option>	
								<option value="8" >8</option>	
								<option value="9" >9</option>	
								<option value="10" >10</option>	
								<option value="11" >11</option>	
								<option value="12" >12</option>	
						</select>
						
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/120/332.html">5</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/150/332.html">6</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/180/332.html">7</a></span>
								<a href="/hvaonline/posts/listByUser/210/332.html">
									<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 8" title="Page 8"/>
								</a>
						
						<a href="/hvaonline/posts/listByUser/330/332.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (12)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
