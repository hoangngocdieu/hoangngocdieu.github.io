<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by rongdennt, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by rongdennt - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/155387.html" name="top" class="maintitle" id="top">Messages posted by: rongdennt</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/155387.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/155387.html">Profile for rongdennt</a> 
            			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/155387.html">Messages posted by rongdennt</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34891.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34891/214509.html#214509,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Có ai có cho mình xin với, sắp deadline rồi mà chưa biết nên bắt đầu viết ra sao đây</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34891.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34891/214275.html#214275,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">hanthuy wrote:</cite><br>
<blockquote>Cái này là bữa cuối không chịu đi học nè <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> &nbsp;
</blockquote><br/><br/> Đi học đủ đó chứ, hôm cuối, thầy nói mail cho thầy rồi thầy mail lại cho bài mẫu. Mà mail 2 cái, nhắn tin luôn rồi mà mãi không thấy hồi âm, google thì ko thấy. Đành phải tự thân vận động, chứ lỡ thầy quên luôn không có bài nộp thì mình chết .</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34891.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34891/214268.html#214268,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Tình hình là mình học CEH, cuối môn yêu cầu làm báo cáo kiểm tra bảo mật một hệ thống. Mà mình lại không biết nên viết sao. Nên mong mọi người giúp mình 1 bài báo cáo mẫu để mình có cái sườn làm báo cáo (chắc tình hình là dựng máy ảo rồi tự kiểm tra, viết bài)<br/><br/> Chân thành cảm ơn</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34805.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34805/213718.html#213718,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">dangkyweb2001 wrote:</cite><br>
<blockquote>tình hình là em biết vai địa chỉ ip có mở cổng 80. 81.21 .23...(bảo đảm 100% là đang hoạt đông ) nhưng tại sao em ping ip , và scan port lại không được ......... , mình sử dụng ddos để cho lag 1 or rớt 1 mạng vậy yêu cầu ip đó mở những port nào vậy anh<br/> em cần nghiên cứu ddos , ai rành pm nhận em làm đệ tử em xin hậu tạ , nick yahoo em : ngochuong1200 &nbsp;
</blockquote><br/><br/> Bạn đã sử dụng rành rẽ công cụ scan port chưa? bạn scan port với tool nào? câu lệnh ra sao? Bạn hiểu thế nào là DoS, DDoS ? Và mục đích khi bạn muốn "ping ip , và scan port" là gì ?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34723.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34723/213717.html#213717,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Thử xem nếu ai đó vào <b>yahoo.de</b> hay <b>yahoo.jp</b> thì sao? Nếu chỉ cần viết 1 signature để áp dụng cho mọi &quot;yahoo&quot; thì biện pháp nào là tốt nhất?&nbsp;
</blockquote><br/><br/> Em dùng wireshack capture thử gói mình request đến yahoo.com thử xem, kết quả thế này<br/> <br>
<div align="center" class="limitview"><img src='http://img529.imageshack.us/img529/7062/78686370.jpg' border="0" /></div><br/><br/> vậy em thiết lập rule như sau:<br/> alert tcp 192.168.1.0/24 any -&gt; any 80 (content:&quot;.yahoo.com&quot;; http_header;) (giống của bạn trả lời trước)<br/><br/> Nếu như hình trên thì mình có nên giới hạn offset và depth như thế nào anh ? (sẳn hỏi luôn)</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34723.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34723/213644.html#213644,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><br/> <b>alert tcp any 192.168.1.0/24 -&gt; any 80 (content:&quot;yahoo.com&quot;; http_header;)</b><br/><br/> Vậy nếu, người dùng truy cập<span class="link"> http://www.YaHoO.coM</span> thì sao? (chú ý chữ cái và chữ thường trong cụm YaHoO.coM)? Hãy tự tìm hiểu thêm các &quot;Payload Detection Rule Options&quot; của snort.&nbsp;
</blockquote><br/><br/> alert tcp any 192.168.1.0/24 -&gt; any 80 (content:&quot;yahoo.com&quot;; <b>nocase</b>; http_header;)<br/><br/> hì, thử làm bài tập của anh conmale xem có đúng không ?<br/><br/> Nhưng cái đoạn này<br/> <b>alert tcp any 192.168.1.0/24 -&gt; any 80</b><br/><br/> theo em biết rule có dạng <b><i>action Protocol ip_address port_number -&gt; ip_address port_number</i></b><br/> Có phải anh ghi nhầm không?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34784.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34784/213642.html#213642,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Nếu snort chạy trên server riêng biệt chớ không phải chạy ngay trên FW và không lắng nghe trên internal interface hoặc external interface của FW thì tình hình sẽ hoàn toàn khác.<br/><br/> Anh có cảm giác như em hiểu rằng snort là một "active" device (như dạng một cơ chế cản lọc). Tận cùng mà nói, nó là một sniffer và nó có thể sniff bất cứ thứ gì xuất hiện trên NIC. Việc iptables có làm gì là chuyện hoàn toàn không dính dáng gì đến snort hết.<br/><br/> <b>IPS hay không là tuỳ ở chỗ snort làm "cái gì" để cho "cái gì" khác ngăn chặn những gói tin bất hợp pháp. Bản thân snort không phải là IPS</b>.&nbsp;
</blockquote><br/><br/> yeah, ý em là nhu vậy đó, nên em mới dùng câu "có chức năng như 1 IPS" chứ không phải "snort là 1 IPS". Cái "có chức năng như 1 IPS" ở đây chính xác là <b>snort làm "cái gì" để cho "cái gì"</b>, ví như nó gặp 1 gói tin thoả signature, nó làm 2 động tác, alert và đưa cho Iptables "làm cái gì" để ngăn chặn gói tin bất hợp pháp.<br/><br/> Em hiểu vậy có ổn không anh ?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34784.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34784/213634.html#213634,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Lấy ví dụ như sau:<br/> Cái server là giám đốc của cty, còn ông A là bảo vệ, ông B cũng là bảo vệ nốt<br/> Sơ đồ:<br/><br/> Giám đốc &lt;--- B &lt;---- A &lt;---- cái cổng<br/><br/> Vậy gói tin đóng vai trò như người đi vào. Ta đặt 2 trường hợp:<br/> <b>I/ A là snort đừng external inteface, B là FW:</b><br/> 1. A là IDS: Nếu khách hàng C đi vào, qua cổng gặp ông A đầu tiên. ông A chỉ ngó coi rồi báo lại cho giám đốc, ko làm gì hết cho dù có phát hiện được C là ăn trộm, kẻ gian hay đó là một khách hàng hợp lệ đi nữa. Sau khi đi qua mặt ông A, gặp ông B, ông này cũng ngó coi C có phải kẻ gian không? nếu phải thì bắt nó lại, tống cổ ra đường.<br/> ===&gt; Ông A mỏi mắt nhìn hoài mặc dù không xử lý gì hết đối với C cho dù C có là ai đi nữa, ông B vất vả, do phải vừa coi, vừa &quot;đá đít&quot; mấy tên kẻ gian.<br/><br/> 2. A có chức năng như 1 IPS: Khách hàng C cũng đi vào, gặp ông A trước, Ông A cũng coi ngó, thấy vi phạm, cũng bắt nó tống ra ngoài. Nếu không vi phạm cho qua, thì thằng C (khách hàng đã qua được cửa kiểm tra của ông A), sẽ gặp ông B, và bị ông B kiểm tra tiếp, thoã mãn nội quy thì cho vô.<br/><br/> ==== Cả 2 đều mỏi (A và B) nhưng công việc của B có giảm tải được đôi chút do ông A đã làm việc trước đó 1 lần rồi, còn ông A thì mệt hơn so với trường hợp I.1, vì vừa phải coi ngó, vừa phải xử lý C nếu vi phạm.<br/><br/> <b>II/ A là FW, B là snort (internal interface):</b><br/><br/> 1. B là IDS: Cũng tay C đi vào, gặp cái ông B &quot;hắc ám&quot; trước, ông xét 1 lược, vi phạm nội quy thì đuổi ra ngoài, trường hợp này là chưa gặp được ông B là đã bị ông A đuổi rồi, nếu không vi pham thì tiếp vô vòng trong gặp ông B (snort).<br/> ===&gt; Ông B sẽ làm việc khá là nặng, vì ai cũng phải gặp ổng đầu tiên. Còn B khá nhẹ nhàng vì được B &quot;bảo kê&quot; trước 1 lớp rồi. Những khi giám đốc yêu cầu ông B báo cáo tình hình trong ngày, thì ông B không báo cáo đầy đủ (vì 1 số khách hàng vi phạm đã bị A đá ra trước khi gặp B)<br/><br/> 2/ B có chức năng như IPS: Cũng tương tự như tình huống trên (II.1), nhưng sau khi C thoả mãn điều kiện của ông A, thì còn bị ông B này kiểm tra thêm lần nữa, và xử lý nếu có vi phạm<br/> ===&gt; Ông B lúc này cũng nặng nề trách nhiệm hơn, nhưng ông giám đốc đỡ mệt hơn<br/><br/><br/> Cái này là em viết theo kiểu &quot;bình dân học vụ&quot;, anh conmale đừng bắt bẻ chữ nghĩa em nhé <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34784.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34784/213583.html#213583,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote>giả sử ta chỉ có 1 server snort đóng vai trò IDS/IPS&nbsp;
</blockquote><br/><br/> Chắc câu cú của em không rõ ràng. Ý em ở đây là mình chỉ có 1 server snort, 2 cái snort trong hình chỉ là minh hoạ cho vị trí đặt nó (vị trí == snort 1 || vị trí ==snort 2)<br/><br/> Như trong tình huống bị DoS/DDoS thì sao hả anh? Mình nên đặt ở vị trí 1 hay 2 là tốt nhất trong vấn đề phát hiện (IDS) và góp phần "giúp đỡ" FW chống hiệu quả hơn ?<br/><br/> Theo em nghĩ, nếu mình đặt ở vị trí số 2 (ở trước FW, trên external interface) thì khi bị tấn công (cụ thể như DoS/DDoS) thì snort sẽ gánh đầu tiên, nó sẽ nhận request trước và cảnh báo 1 cách chính xác hơn về mức độ tấn công, còn giả như mình cấu hình nó như 1 IPS, thì nó sẽ cản lọc được 1 phần trước khi vào đến FW, vấn đề ở đây là lúc này FW sẽ nhẹ nhàng hơn nhưng snort thì phải chịu hậu quả gì? có quá nặng cho snort không ? ưu khuyết điểm khi đặt ở vị trí này như thế nào? Nhờ anh chỉ điểm giúp.<br/><br/> Còn nếu mình đặt trường hợp ngược lại, đặt snort ở vị trí snort 1, thì FW sẽ cản lọc được 1 phần rồi, phần còn lại, có thể snort sẽ chặn thêm được 1 phần trong đó nữa (IPS), còn nếu là IDS thì nó sẽ không nhận đầy đủ các gói đã đi vào (bị FW dzớt 1 phần rồi, nền phần đó sẽ không vào được đến Snort) dẫn đến mức độ cảnh báo không được chính xác và đầy đủ như trường hợp phía trên.<br/><br/> Em đặt giả thiết:<br/> - Cho tấn công DoS/DDoS ở hình thức cụ thể<br/> - Snort đã có rule cảnh bảo đối với hình thức trên</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34784.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34784/213568.html#213568,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mình có mô hình như sau (đơn giản để minh hoạ)<br/> <br>
<div align="center" class="limitview"><img src='http://img249.imageshack.us/img249/7594/96574614.jpg' border="0" /></div><br/><br/> Trong đó snort 1 và snort 2 là 2 vị trí có thể đặt snort.<br/> Xin mọi người cho ý kiến về vị trí đặt snort cái nào tốt hơn, ưu và khuyết điểm của từng vị trí? Trong trường hợp nào thì đặt ở vị trí số 1 và trường hợp nào đặt vị trí số 2? (giả sử ta chỉ có 1 server snort đóng vai trò IDS/IPS)<br/><br/> Nếu ta cấu hình cho snort có chức năng của 1 IPS (ở đây chỉ đề cập IPS mềm chứ không phải phần cứng chuyên dụng) thì đặt như thế nào là tốt nhất ? nếu chỉ là 1 IDS thì đặt ở vị trí nào ?<br/><br/> Mong mọi người cho ý kiến<br/> Chân thành cảm ơn</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34764.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34764/213565.html#213565,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Chăc bạn ấy bị local attack rồi. Dùng share host thì đầu tiên phải chmod cho kĩ vào, để giảm thiểu cái local attack trước. Share host thì phải chịu vấn đề này. Mình bị mấy lần rồi. Sau là đến mấy cái mod, nên hiểu về code chút, đọc để coi người share cái mod đó có bị lợi dụng, vô tình hay cố ý bị lợi dụng để 1 đoạn code "không trong sáng" không?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34723.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34723/213342.html#213342,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Em mới edit bài trên của mình, theo em hiểu thì offset ở đây là vị trí mà mình xác định của gói tin mà mình điền trong content được tính từ vị trí đầu tiên của gói tin (vị trí đầu tiên nó tính là 0 phải không anh? )<br/> Con depth là chiều dài tính từ vị trí xác định trong offset ?<br/> Ví dụ như gói tin mình bắt được có dạng<br/><br/> 00 11 22 33 44 55 66 77 88 99<br/><br/> thì offset:2;depth:3 là |11 22 33| phải không anh ?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34743.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34743/213340.html#213340,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">acti wrote:</cite><br>
<blockquote>Cám ơn anh conmale đã suggest cho tôi!<br/> Tôi đã contact với bên ISP nhưng họ chỉ đưa ra giải pháp là đổi IP và muốn tôi xem lại có bị tấn công nữa không! Tôi cũng không biết ISP quản lý kiểu gì đây nữa T_T&nbsp;
</blockquote><br/><br/> Đổi IP thì chỉ có thể ngưng DDoS chừng 1 giờ. Sau đó kẻ tấn công phát hiện ra thì cũng quay lại tình trạng cũ. ISP có thể filter dạng tấn công này trên border router của họ hoặc họ phải thoả thuận với bạn là họ không tính &quot;in bound&quot; traffic thì bạn mới chịu nổi.&nbsp;
</blockquote><br/><br/> Nếu như thoả thuận không tính inbound traffic như anh conmale nói, mà kẻ tấn công vẫn &quot;ầm ầm&quot; dội vô, thì tình trạng đường truyền bị bão hoà là có thể xảy &lt;--- thoã mãn mục đích tấn công từ chối dịch vụ.<br/><br/> Nếu IPS không giúp được chuyện này thì chắc bạn phải chuyển qua IPS khác quá <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34723.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34723/213339.html#213339,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">phathuynh26 wrote:</cite><br>
<blockquote><br/> Anh conmale ơi, rule và signature khác nhau chổ nào vậy anh? Em nghĩ <font color='red'>signature nằm trong một rule</font>, rule thì chứa nhiều signature <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">&nbsp;
</blockquote><br/><br/> &quot;Signature nằm trong một rule&quot; là đúng nhưng &quot;rule chứa nhiều signature&quot; thì chưa chính xác. Ví dụ, đây là một rule:<br/><br/> <b>alert <font color='orange'>tcp</font> $EXTERNAL_NET any -&gt; $HTTP_SERVERS <font color='yellow'>$HTTP_PORTS</font> (flags<img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">A; msg:&quot;POST Null frag1 - Flash attack HVA&quot;; flow:to_server; content:&quot;<font color='red'>|68 6F 74 6C 69 6E 6B 73 3D 4F 66 66 69 63 61 6C|</font>&quot;; <font color='green'>offset:30; depth:40</font>; classtype:attempted-FragDataPOST; resp:rst_all; react:block<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"></b><br/><br/> trong đó chỉ có một signature đó là đoạn màu đỏ xác định tính chất của packet cần được nhận diện. Tất nhiên, đoạn màu cam, màu vàng và màu xanh lá ở trên cũng quan trọng để thu hẹp biên độ matching nhưng chúng không phải là những signature.&nbsp;
</blockquote><br/><br/> Anh conmale ơi, anh có thể post kèm với rule trên đoạn stream đã giúp anh hình thành rule này được không ạ?<br/> Em chưa hiểu cái offset và depth lắm. Em có google thì ra thông tin về 2 cái này như sau:<br/> <blockquote>offset<br/><br/> offset: &lt; value&gt;;<br/> Từ khóa offset được sử dụng kết hợp với từ khóa content. Sử dụng từ khóa này, bạn có thể bắt đầu tìm kiếm từ một vị trí xác định so với vị trí bắt đầu của gói tin. Sử dụng một con số như là đối số của từ khóa này.<br/> depth<br/><br/> depth: &lt; value&gt;;<br/> Từ khóa depth cũng được sử dụng kết hợp với từ khóa content để xác định giới hạn trên của việc so sánh mẫu. Sử dụng từ khóa này, bạn có thể xác định một vị trí so với vị trí bắt đầu. Dữ liệu sau vị trí này sẽ không được tìm kiếm để so mẫu. Nếu bạn dùng cả hai từ khóa offset và depth thì bạn có thể xác định một khoảng dữ liệu thực hiện việc so sánh mẫu.&nbsp;
</blockquote><br/><br/> Tiếng anh:<br/> <blockquote>3.5.4 depth<br/> The depth keyword allows the rule writer to specify how far into a packet Snort should search for the specified pattern.<br/> depth modifies the previous ‘content’ keyword in the rule.<br/> A depth of 5 would tell Snort to only look for the specified pattern within the first 5 bytes of the payload.<br/> As the depth keyword is a modifier to the previous ‘content’ keyword, theremust be a content in the rule before ‘depth’<br/> is specified.<br/> Format<br/> depth: &lt;number&gt;;<br/> 3.5.5 offset<br/> The offset keyword allows the rule writer to specify where to start searching for a pattern within a packet. offset<br/> modifies the previous ’content’ keyword in the rule.<br/> An offset of 5 would tell Snort to start looking for the specified pattern after the first 5 bytes of the payload.<br/> As this keyword is a modifier to the previous ’content’ keyword, there must be a content in the rule before ’offset’ is<br/> specified.<br/> Format<br/> offset: &lt;number&gt;;<br/> Example<br/> The following example shows use of a combined content, offset, and depth search rule.<br/> alert tcp any any -&gt; any 80 (content: &quot;cgi-bin/phf&quot;; offset:4; depth:20<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">&nbsp;
</blockquote></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34743.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34743/213334.html#213334,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">acti wrote:</cite><br>
<blockquote>Chủ đề này có vẻ được anh conmale quan tâm! Hiện tôi cũng đang có 1 con server bị tấn công ddos.<br/> Hình thức tấn công là:<br/><br/> Gửi gói tin ICMP đến làm nghẽ đường mạng với số lượng là trên 100packets/s.<br/> Đây là hình mình đã monitor lại trong đợt tấn công<br/><span class="link"> http://i198.photobucket.com/albums/aa281/taolaai1112/ddos.jpg</span><br/><br/> Đây là hình mình đã monitor lại traffic mạng vào lúc đợt tấn công<br/><span class="link"> http://i198.photobucket.com/albums/aa281/taolaai1112/ddos2.png</span><br/><br/> Trong hình sau có 1 đoạn bw rớt xuống là do mình đặt rule xong rồi gỡ ra.<br/><br/> Nguyên nhân gỡ ra là sau khi dặt rule thì cũng không giải quyết được <font color='red'>tình trạng chiếm dụng bw</font> mạng nên mình gỡ ra cho bên phía ISP check lại.<br/><br/> Vì người dos này sử dụng 1 ip tĩnh với đường truyền cao nên phương án hiện nay là mình contact với phía isp nhờ họ giải quyết giủm mà vẫn chưa thấy giải quyết.<br/><br/> Ai có phương pháp có thể suggest cho tôi được không ?&nbsp;
</blockquote><br/><br/> Tình trạng chiếm dụng bw <b>chỉ có thể được ISP (hoặc nhà cung cấp dịch vụ) giải quyết</b>.<br/><br/> Quản lý của máy chủ chỉ có thể áp dụng biện pháp cản packets đi vô trong server.<br/><br/> Nếu bw không phải là vấn đề thì chỉ cần áp dụng luật drop các ICMP đó là xong.&nbsp;
</blockquote><br/><br/> Em thấy trong hình có thêm nhiều gói theo giao thức UDP tràn vô, em nghĩ nên chặn thêm giao thức UDP nếu sever không cần sử dụng giao thức này, nếu sever có sử dụng UDP ví dụ như DNS chẳng hạn thì chặn tất cả gói đi vào sử dụng UDP ngoại trừ port 53 (trường hợp nếu dựng DNS server).</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34501.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34501/212029.html#212029,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Cảm ơn anh nhiều, em đã thử update xinetd và đã "lòi" ra 2 hồ sơ cấu hình trên.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34501.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34501/212011.html#212011,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">em google với từ khoá như trên thì có đọc RFC863, thì hiểu được là khi vào port 9 của discard nó sẽ như rơi vào khoảng không (null)<br/> Nhưng em không tìm thấy cái cài đặt dịch vụ này. Lật lại trong loạt bài kí sự thì có đoạn sau:<br/> <blockquote><br/> T<b>ôi nhớ trước đây tôi đã tạo dịch vụ discard trên firewall</b> của HVA và đã thử nghiệm qua khoản này nhưng chưa đi sâu bởi vì nạn DDoS x-flash ngày ấy (cuối 2005, đầu 2006) không nhằm mục đích saturate đường dẫn như dạng UDP DDoS lần này. Dịch vụ "discard" chỉ có thể access từ trên chính firewall nên không có gì phải ngại. Hơn nữa, nó được chính firewall bảo vệ. Bởi thế, có lẽ nó vẫn còn đó vì tôi nhớ mình chưa hề tắt bỏ nó. &nbsp;
</blockquote><br/><br/> Co em hỏi, anh tạo dịch vụ này sao ạ? hoặc nếu có tài liệu gì anh chỉ giúp em với<br/><br/> Cảm ơn anh</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34359.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34359/211788.html#211788,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Theo ý kiến của mình, hình như bạn hơi sa lầy vào iptables, phụ thuộc nhiều vào nó quá. Nếu mục đích cản lọc của bạn là ở web. Đầu tiên bạn nên kiện toàn ở application trước (cụ thể là lập trình cái web có kiểm tra các giá trị được đưa vào). Sau đó, bạn kiện toàn thêm bằng mod_security cho webserver apache để gia cố thêm bảo mật bằng cản lọc URL, URI chẳng hạn.<br/><br/> Theo mình, iptables nên để chặn ở tầng 3 thật tốt, lên các tầng cao hơn, bạn nên dùng các soft cản lọc tương ứng thì hiệu quả sẽ cao hơn nhiều. Như anh conmale đã nói là kiện toàn bảo mật ở đa tầng (không nhớ chính xác anh nói câu đó từng chữ một, nhưng đại ý là cản lọc ở nhiều tầng, kiện toàn thật tốt ở từng tầng, cố gắng tận dụng chức năng của các soft cho đúng "chuyên môn" của của nó)</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34413.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34413/211257.html#211257,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">panfider wrote:</cite><br>
<blockquote>mình mù về iptable và config server<br/> chi phí nghiên cứu Linux quá cao&nbsp;
</blockquote><br/> Nghiên cứu linux là "rẻ" nhất rồi, toàn mã nguồn mở mà.<br/> Theo mình thấy, bạn chưa hiểu về nguyên tắc các gói tin đi ra / vào trên mạng. Nói ngắn gọn là thế này:<br/> - INPUT của bạn là từ client đến server<br/> - OUTPUT là từ server đến client<br/><br/> Bạn cấu hình iptables input cho phép client kết nối đến port 25 và 110 như vậy là đúng vì như cấu hình trên thì iptables đã "cho qua" gói tin đến port 25 và 110. Nhưng về OUPUT thì bạn làm sai, client gửi request đến port 25 hoặc 110 của server nhưng port mà client mở ra để "giao lưu" là gì ? nó nằm trong khoảng 1024-65535 (port của client hay gọi là source port trong trường hợp của bạn), như vậy server sẽ trả lời đến máy client đến high-port đó.<br/><br/> Bạn thử cấu hình iptables như vậy xem:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>iptables -A OUPUT -p tcp -m tcp --sport 25 --dport 1024:65535 -j LOG
iptables -A OUPUT -p tcp -m tcp --sport 110 --dport 1024:65535 -j LOG
iptables -A OUPUT -p tcp -m tcp --sport 25 --dport 1024:65535 -j ACCEPT
iptables -A OUPUT -p tcp -m tcp --sport 110 --dport 1024:65535 -j ACCEPT</pre>
</div><br/><br/> 2 dòng trên chỉ là ghi log lại cho bạn dễ kiểm tra, đây là rules đơn giản thôi, nếu bạn có nhiều card mạng nên (và luôn nên) chỉ ra card output là card nào, input là card nào bằng -o eth0 (hoặc -i eth0 cho input) eth0 là ví dụ.<br/><br/> Bạn có thể dùng tcpdump ghi lại lúc test và dùng wireshack để xem gói tin nó đi như thế nào.<br/><br/> Có gì sai sót, các bạn chỉ giúp nhé</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/211099.html#211099,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Đúng là có 1 số chổ em vẫn không hiểu rành rẻ lắm. Cảm ơn anh đã chỉ điểm, em vẫn đang cố gắng đọc tài liệu để xung lỗ hổng kiến thức của mình.<br/><br/> apache em để keepAlive off mà anh<br/><br/> Anh giúp em cái phần này với<br/> <blockquote>Hiện giờ cái audit.log của em nó ghi tràn lan hết, em muốn chỉ ghi lại log chỉ những cuộc tấn công thôi thì phải dùng cái nào ạ ? &nbsp;
</blockquote></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/211094.html#211094,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Em dùng iptables với rule như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>-A INPUT -d xxx.xxx.xxx.xxx -p tcp -m tcp --sport 1024:65535 --dport 80 ! --tcp-flags FIN,SYN,RST,ACK SYN -m state --state NEW -j DROP
-A INPUT -d xxx.xxx.xxx.xxx -i eth0 -p tcp -m tcp --sport 1024:65535 --dport 80 --tcp-flags FIN,SYN,RST,ACK SYN -m limit --limit 32/sec -m state --state NEW -j ACCEPT
-A INPUT -d xxx.xxx.xxx.xxx -i eth0 -p tcp -m tcp --sport 1024:65535 --dport 80 ! --tcp-flags FIN,SYN,RST,ACK SYN -m state --state ESTABLISHED -j ACCEPT</pre>
</div><br/><br/> Kèm theo mod_security với rule như trên chặn trên 2 tầng, anh xem giúp em cấu hình vậy có ổn không ạ ? Có gì cần thay đổi để đối phó tốt với tình huống bị DoS như em đang bị không ?<br/><br/> Em thử dùng 1 tool DoS http vô chính web của mình thì trung bình 1s 1 cú chui vô, đến cú thứ 7 thì bị drop bởi mod_security với error code 403.<br/><br/> Có nên giới hạn thêm -m litmit --limit 32/sec không anh?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/211084.html#211084,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Em thử theo cách của anh thì được, không báo lỗi như trước. Em test thử thì nó chặn được nhưng error_log của apache lại phun ra dòng:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&#91;Mon May 17 10:32:23 2010&#93; &#91;error&#93; &#91;client 118.68.31.30&#93; ModSecurity: Access denied with connection close &#40;phase 1&#41;. Operator GT matched 5 at IP:ddos. &#91;file "/etc/httpd/conf/modsecurity/modsec.conf"&#93; &#91;line "10"&#93; &#91;msg "DDoS"&#93; &#91;hostname "accounts.l2tn.net"&#93; &#91;uri "/"&#93; &#91;unique_id "34ImMXsebZIAAFcuHJoAAAAC"&#93;</pre>
</div><br/><br/><br/> A giúp em giải thích cái dòng vừa thay vô với. À, còn nó drop ip của em, em tìm thấy trong /tmp/ip.pag<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>118.68.31.30__nameip00__key
CREATE_TIME
1274067130UPDATE_COUNTER1ddos1__expire_ddos
1274067730LAST_UPDATE_TIME
1274067130118.68.31.30VT102VT102</pre>
</div><br/><br/> Có phải cứ 1 thời gian thì biến ip.ddos nó giảm xuống, IP đó sẽ được nhả ra ạ ?<br/> Hiện giờ cái audit.log của em nó ghi tràn lan hết, em muốn chỉ ghi lại log chỉ những cuộc tấn công thôi thì phải dùng cái nào ạ ?<br/> Chân thành cảm ơn anh<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/211080.html#211080,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><br/> Em mod_security 2.5.12<br/><br/> httpd.conf<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># ================================================= # Basic settings # =================================================
Listen 80
ServerName www.abc.com:80
User apache
Group apache
ServerAdmin &lt;a href="mailto:khanhcan148@gmail.com"&gt;khanhcan148@gmail.com&lt;/a&gt;
UseCanonicalName Off
ServerSignature On
HostnameLookups Off
ServerTokens OS
ServerRoot "/etc/httpd"
DocumentRoot "/var/www/html"
PidFile run/httpd.pid
#ScoreBoardFile /usr/local/apache2/logs/httpd.scoreboard
&lt;IfModule mod_dir.so&gt;
DirectoryIndex index.html
&lt;/IfModule&gt;
&lt;IfModule mod_userdir.c&gt;
UserDir disable
&lt;/IfModule&gt;
# ================================================= # HTTP and performance settings # =================================================
Timeout 120
KeepAlive Off
MaxKeepAliveRequests 100
KeepAliveTimeout 15
IndexOptions FancyIndexing VersionSort NameWidth=* HTMLTable
&lt;IfModule prefork.c&gt;
MinSpareServers 5
MaxSpareServers 10
StartServers 5
MaxClients 150
MaxRequestsPerChild 0
&lt;/IfModule&gt;
&lt;IfModule worker.c&gt;
StartServers 2
MaxClients 150
MinSpareThreads 25
MaxSpareThreads 75
ThreadsPerChild 25
MaxRequestsPerChild 0
&lt;/IfModule&gt;
&lt;IfModule mod_negotiation.c&gt;
&lt;IfModule mod_include.c&gt;
&lt;Directory "/var/www/error"&gt;
AllowOverride None
Options IncludesNoExec
AddOutputFilter Includes html
AddHandler type-map var
Order allow,deny
Allow from all
LanguagePriority en es de fr
ForceLanguagePriority Prefer Fallback
&lt;/Directory&gt;
# ErrorDocument 400 /error/HTTP_BAD_REQUEST.html.var
# ErrorDocument 401 /error/HTTP_UNAUTHORIZED.html.var
# ErrorDocument 403 /error/HTTP_FORBIDDEN.html.var
# ErrorDocument 404 /error/HTTP_NOT_FOUND.html.var
# ErrorDocument 405 /error/HTTP_METHOD_NOT_ALLOWED.html.var
# ErrorDocument 408 /error/HTTP_REQUEST_TIME_OUT.html.var
# ErrorDocument 410 /error/HTTP_GONE.html.var
# ErrorDocument 411 /error/HTTP_LENGTH_REQUIRED.html.var
# ErrorDocument 412 /error/HTTP_PRECONDITION_FAILED.html.var
# ErrorDocument 413 /error/HTTP_REQUEST_ENTITY_TOO_LARGE.html.var
# ErrorDocument 414 /error/HTTP_REQUEST_URI_TOO_LARGE.html.var
# ErrorDocument 415 /error/HTTP_UNSUPPORTED_MEDIA_TYPE.html.var
# ErrorDocument 500 /error/HTTP_INTERNAL_SERVER_ERROR.html.var
# ErrorDocument 501 /error/HTTP_NOT_IMPLEMENTED.html.var
# ErrorDocument 502 /error/HTTP_BAD_GATEWAY.html.var
# ErrorDocument 503 /error/HTTP_SERVICE_UNAVAILABLE.html.var
# ErrorDocument 506 /error/HTTP_VARIANT_ALSO_VARIES.html.var
&lt;/IfModule&gt;
&lt;/IfModule&gt;
&lt;IfModule mod_dav_fs.c&gt;
# Location of the WebDAV lock database.
DAVLockDB /var/lib/dav/lockdb
&lt;/IfModule&gt;
BrowserMatch "Mozilla/2" nokeepalive
BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
BrowserMatch "RealPlayer 4\.0" force-response-1.0
BrowserMatch "Java/1\.0" force-response-1.0
BrowserMatch "JDK/1\.0" force-response-1.0
BrowserMatch "Microsoft Data Access Internet Publishing Provider" wwwect-carefully
BrowserMatch "MS FrontPage" wwwect-carefully
BrowserMatch "^WebDrive" wwwect-carefully
BrowserMatch "^WebDAVFS/1.&#91;0123&#93;" wwwect-carefully
BrowserMatch "^gnome-vfs/1.0" wwwect-carefully
BrowserMatch "^XML Spy" wwwect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" wwwect-carefully
ForceLanguagePriority Prefer Fallback
AddDefaultCharset UTF-8
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddHandler type-map var
AddType text/html .shtml
AddOutputFilter INCLUDES .shtml
AddIconByEncoding &#40;CMP,/icons/compressed.gif&#41; x-compress x-gzip
AddIconByType &#40;TXT,/icons/text.gif&#41; text/*
AddIconByType &#40;IMG,/icons/image2.gif&#41; image/*
AddIconByType &#40;SND,/icons/sound2.gif&#41; audio/*
AddIconByType &#40;VID,/icons/movie.gif&#41; video/*
AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
AddIcon /icons/layout.gif .html .shtml .htm .pdf
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif core
AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^
DefaultIcon /icons/unknown.gif
ReadmeName README.html
HeaderName HEADER.html
IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
# ================================================= # Access control # =================================================
AccessFileName .htaccess
&lt;Files ~ "^\.ht"&gt;
Order allow,deny
Deny from all
&lt;/Files&gt;
&lt;Directory /&gt;
Options None
AllowOverride None
Order deny,allow
Deny from all
&lt;/Directory&gt;
&lt;Directory "/var/www/html"&gt;
Options Indexes FollowSymLinks
AllowOverride None
Order allow,deny
Allow from all
&lt;/Directory&gt;
Alias /error/ "/var/www/error/"
ScriptAlias /cgi-bin/ "/var/www/cgi-bin/"
&lt;Directory "/var/www/cgi-bin"&gt;
AllowOverride None
Options None
Order allow,deny
Allow from all
&lt;/Directory&gt;
Alias /icons/ "/var/www/icons/"
&lt;Directory "/var/www/icons"&gt;
Options Indexes MultiViews
AllowOverride None
Order allow,deny
Allow from all
&lt;/Directory&gt;
# ================================================= # Load Modules # =================================================
LoadModule auth_basic_module modules/mod_auth_basic.so
LoadModule auth_digest_module modules/mod_auth_digest.so
LoadModule authn_file_module modules/mod_authn_file.so
LoadModule authn_alias_module modules/mod_authn_alias.so
LoadModule authn_anon_module modules/mod_authn_anon.so
LoadModule authn_dbm_module modules/mod_authn_dbm.so
LoadModule authn_default_module modules/mod_authn_default.so
LoadModule authz_host_module modules/mod_authz_host.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule authz_owner_module modules/mod_authz_owner.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_dbm_module modules/mod_authz_dbm.so
LoadModule authz_default_module modules/mod_authz_default.so
LoadModule ldap_module modules/mod_ldap.so
LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
LoadModule include_module modules/mod_include.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule logio_module modules/mod_logio.so
LoadModule env_module modules/mod_env.so
LoadModule ext_filter_module modules/mod_ext_filter.so
LoadModule mime_magic_module modules/mod_mime_magic.so
LoadModule expires_module modules/mod_expires.so
LoadModule deflate_module modules/mod_deflate.so
LoadModule headers_module modules/mod_headers.so
LoadModule usertrack_module modules/mod_usertrack.so
LoadModule setenvif_module modules/mod_setenvif.so
LoadModule mime_module modules/mod_mime.so
LoadModule dav_module modules/mod_dav.so
LoadModule status_module modules/mod_status.so
LoadModule autoindex_module modules/mod_autoindex.so
LoadModule info_module modules/mod_info.so
LoadModule dav_fs_module modules/mod_dav_fs.so
LoadModule vhost_alias_module modules/mod_vhost_alias.so
LoadModule negotiation_module modules/mod_negotiation.so
LoadModule dir_module modules/mod_dir.so
LoadModule actions_module modules/mod_actions.so
LoadModule speling_module modules/mod_speling.so
LoadModule userdir_module modules/mod_userdir.so
LoadModule alias_module modules/mod_alias.so
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule proxy_connect_module modules/mod_proxy_connect.so
LoadModule cache_module modules/mod_cache.so
LoadModule suexec_module modules/mod_suexec.so
LoadModule disk_cache_module modules/mod_disk_cache.so
LoadModule file_cache_module modules/mod_file_cache.so
LoadModule mem_cache_module modules/mod_mem_cache.so
LoadModule cgi_module modules/mod_cgi.so
LoadModule version_module modules/mod_version.so
LoadModule unique_id_module modules/mod_unique_id.so
LoadModule security2_module modules/mod_security2.so
Include conf/modsecurity/*.conf
Include conf.d/*.conf
# ================================================= # MIME encoding # =================================================
TypesConfig /etc/mime.types
&lt;IfModule mod_mime.so&gt;
AddEncoding x-compress .Z
AddEncoding x-gzip .gz .tgz
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddType application/x-tar .tgz
&lt;/IfModule&gt;
&lt;IfModule mod_mime_magic.so&gt;
# MIMEMagicFile /usr/share/magic.mime
MIMEMagicFile conf/magic
&lt;/IfModule&gt;
DefaultType text/plain
# ================================================= # Logs # =================================================
LogLevel warn
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common
LogFormat &quot;%{Referer}i -&gt; %U&quot; referer
LogFormat &quot;%{User-agent}i&quot; agent
CustomLog logs/access_log combined
# ================================================= # Virtual hosts # =================================================
&lt;Directory /var/www/html/giamsatluuluong&gt;
Options Indexes Includes FollowSymLinks MultiViews
AllowOverride AuthConfig
Order allow,deny
Allow from all
&lt;/Directory&gt;</pre>
</div><br/><br/> File modsec.conf<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;IfModule security2_module&gt;
# Turn on rule engine and set default action
SecRuleEngine On
SecAuditLog logs/audit.log
SecDataDir /tmp
SecTmpDir /tmp
SecAction initcol:ip=%{REMOTE_ADDR},nolog
SecRule REQUEST_URI "^/$" "nolog,phase:1,setvar:ip.ddos=+1,deprecatevar:ip.ddos=5/60,expirevar:ip.ddos=600"
SecRule IP<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">DOS "@gt 5" "phase:1,log,drop,msg:'DDoS'"
&lt;/IfModule&gt;</pre>
</div><br/><br/> Em bỏ hết các rules, chỉ để rule cho tiện tìm lỗi<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/211049.html#211049,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">File rule của mod security của mình:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;IfModule security2_module&gt;
# Turn on rule engine and set default action
SecRuleEngine On
SecAuditLog logs/audit.log
SecDataDir /tmp
SecTmpDir /tmp
SecAction initcol:ip=%{REMOTE_ADDR},nolog
SecRule REQUEST_URI "^/$" "nolog,phase:1,setvar:ip.ddos=+1,deprecatevar:ip.ddos=5/60,expirevar:ip.ddos=600"
SecRule IP<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">DOS "@gt 5" "phase:1,log,drop,msg:'DDoS'"
&lt;/IfModule&gt;</pre>
</div><br/><br/> Mình tạo 1 file ip.ddos vào /tmp/ip.ddos nhưng nó vẫn báo lỗi như trên. Help<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/211027.html#211027,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cảm ơn anh, em luôn cố gắng tìm hiểu ngọn ngành trước khi áp dụng. Nhưng nhiều cái trừu tượng quá nên em vẫn bị lờ mờ.<br/><br/> Một cái mà em gặp là khi xem error log của apache, nó xuất ra:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&#91;Sun May 16 19:03:06 2010&#93; &#91;error&#93; &#91;client 118.69.64.223&#93; ModSecurity: Could not set variable "ip.ddos" as the collection does not exist. &#91;hostname "accounts.l2tn.net"&#93; &#91;uri "/"&#93; &#91;unique_id "5Ce0@XsebZIAABeyPgMAAAAC"&#93;
&#91;Sun May 16 19:03:06 2010&#93; &#91;error&#93; &#91;client 118.69.64.223&#93; ModSecurity: Could not deprecate variable "ip.ddos" as the collection does not exist. &#91;hostname "accounts.l2tn.net"&#93; &#91;uri "/"&#93; &#91;unique_id "5Ce0@XsebZIAABeyPgMAAAAC"&#93;
&#91;Sun May 16 19:03:06 2010&#93; &#91;error&#93; &#91;client 118.69.64.223&#93; ModSecurity: Could not expire variable "ip.ddos" as the collection does not exist. &#91;hostname "accounts.l2tn.net"&#93; &#91;uri "/"&#93; &#91;unique_id "5Ce0@XsebZIAABeyPgMAAAAC"&#93;</pre>
</div><br/><br/> lên google search cái này thì hoài không có. Giúp em với. Cái này có phải lỗi không ? Cách khắc phục như thế nào? Help</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/210958.html#210958,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">rongdennt wrote:</cite><br>
<blockquote>Hôm nay mình xem log thì phát hiện bị tấn công DoS. Đoạn log như sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>118.69.64.141 - - &#91;13/May/2010:14:06:04 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:09 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:16 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:21 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:26 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:31 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:36 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:41 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:46 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:52 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:57 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:02 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:07 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:12 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:17 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:22 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:27 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:32 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"</pre>
</div><br/><br/> Mong mọi ngừoi giúp đỡ. Có phương án nào đỡ được cái này không ? Giúp mình với&nbsp;
</blockquote><br/><br/> Hôm trước em có tham gia chủ đề mod_security, sao không thử áp dụng nó?&nbsp;
</blockquote><br/><br/> Thú thật với anh, em có cài mod_sercurity nhưng viết rule cho nó không hoạt động. Nên mạn pháp xin mọi người giúp đoạn rule mẫu cho trường hợp này để em có 1 cái ví dụ cụ thể đặng mà áp dụng và mở mang kiến thức.<br/><br/> Chắc do trình độ tự học còn hạn chế nên ngâm cứu hoài mà không xử lý được tình huống này</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34355.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34355/210832.html#210832,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hôm nay mình xem log thì phát hiện bị tấn công DoS. Đoạn log như sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>118.69.64.141 - - &#91;13/May/2010:14:06:04 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:09 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:16 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:21 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:26 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:31 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:36 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:41 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:46 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:52 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:06:57 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:02 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:07 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:12 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:17 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:22 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:27 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;13/May/2010:14:07:32 +0700&#93; "GET / HTTP/1.1" 200 1330 "-" "Microsoft URL Control - 6.00.8862"</pre>
</div><br/><br/> Mong mọi ngừoi giúp đỡ. Có phương án nào đỡ được cái này không ? Giúp mình với</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34093.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34093/210346.html#210346,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">rongdennt wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><b>SecRule REQUEST_URI &quot;/index\.php&quot;</b> ---&gt; cái này có nghĩa là gì?<br/><br/> Và <b>GET /?action=activation&key=48283ea3ec</b> có liên quan gì đến cái ở trên?&nbsp;
</blockquote><br/><br/> Cái đầu tiên em lấy số lượng request đến index.php. Vì cái GET /?action=activation&key=48283ea3ec thực ra là nó lấy index.php?action=activation&key=48283ea3ec, key là một số ngẫu nhiên. Em nghĩ nó đều phải triệu gọi thông qua index.php nên mới áp dụng cho file index.php.<br/> Không biết suy nghĩ em sai ở điểm nào? nhờ anh chỉ giúp&nbsp;
</blockquote><br/><br/> Đối với modsecurity, <font color='red'>"/?action=activation&key=48283ea3ec"</font> chính là URI. Trong khi đó, dòng luật <b>SecRule REQUEST_URI &quot;/index\.php&quot;</b> thì có URI được ấn định là "/index.php". Bởi vậy, modsecurity sẽ... lờ <font color='red'>"/?action=activation&key=48283ea3ec"</font> và không xử lý vì giá trị URI của hai cái hoàn toàn khác nhau.<br/><br/> Để cho luật trên có tác dụng, cần phải đổi thành:<br/> <font color='red'>SecRule REQUEST_URI "/\?action=activation"</font><br/><br/> (để ý có dấu \ nằm trước ? là vì ? là một reverse char của regular expression nên phải "escape" nó - nên nghiên cứu thêm regex thì mới có thể làm việc với mod_security được).&nbsp;
</blockquote><br/><br/> Cảm ơn anh, e có tìm hiểu regex nên có hiểu đoạn anh nói. Em sẽ thử nghiệm với trường hợp của em để tính toán lại thông số cho thích hợp</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34093.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34093/210336.html#210336,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><b>SecRule REQUEST_URI &quot;/index\.php&quot;</b> ---&gt; cái này có nghĩa là gì?<br/><br/> Và <b>GET /?action=activation&key=48283ea3ec</b> có liên quan gì đến cái ở trên?&nbsp;
</blockquote><br/><br/> Cái đầu tiên em lấy số lượng request đến index.php. Vì cái GET /?action=activation&key=48283ea3ec thực ra là nó lấy index.php?action=activation&key=48283ea3ec, key là một số ngẫu nhiên. Em nghĩ nó đều phải triệu gọi thông qua index.php nên mới áp dụng cho file index.php.<br/> Không biết suy nghĩ em sai ở điểm nào? nhờ anh chỉ giúp</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/34093.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/34093/210308.html#210308,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Server mình cũng đang có hiện tượng bị DoS<br/> Log như sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>118.69.64.141 - - &#91;04/May/2010:22:29:56 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:01 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:06 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:11 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:16 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:21 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:26 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:31 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:36 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:41 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:46 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:51 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:30:56 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:01 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:06 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:11 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:16 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:21 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:26 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:31 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:36 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:41 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:46 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:51 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:31:56 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:01 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:06 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:11 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:16 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:21 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:26 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:31 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"
118.69.64.141 - - &#91;04/May/2010:22:32:36 +0700&#93; "GET /?action=activation&key=48283ea3ec HTTP/1.1" 200 1363 "-" "Microsoft URL Control - 6.00.8862"</pre>
</div><br/><br/> Mình đã limit ở iptables nên cứ 5 giây là có 1 chú lọt vào. Tuy không gây ảnh hưởng lớn gì nhưng mình cảm thấy rất khó chịu nên đã cài đặt mod_security. Mình dùng rule cho mod security như sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecAction initcol:ip=%{REMOTE_ADDR},nolog
SecRule REQUEST_URI "/index\.php" "nolog,phase:1,setvar:ip.ddos=+1,deprecatevar:ip.ddos=2/60,expirevar:ip.ddos=600"
SecRule IP<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">DOS "@gt 2" "phase:1,log,drop,msg:'DoS'"
SecAuditLog logs/audit.log</pre>
</div><br/><br/> Nhờ mọi người giúp đỡ hoàn thiện đoạn rule trong tình hưống này. Chân thành cảm ơn</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/155387' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" selected="selected">1</option>	
								<option value="2" >2</option>	
						</select>
						
							<a href="/hvaonline/posts/listByUser/30/155387.html">
								<img src="/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 2" title="Page 2"/>
							</a>
						
						<a href="/hvaonline/posts/listByUser/30/155387.html">
							<img src="/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (2)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
