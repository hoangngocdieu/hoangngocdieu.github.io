<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by tranvanminh, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by tranvanminh - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/25267.html" name="top" class="maintitle" id="top">Messages posted by: tranvanminh</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/25267.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/25267.html">Profile for tranvanminh</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/25267.html">Messages posted by tranvanminh</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">2</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39805.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39805/245263.html#245263,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Có hai dạng nhu cầu và hai giải pháp khác nhau.<br/> 1. Nếu dịch vụ web chỉ có nhiều người dùng chớ không phải bị DDoS.<br/> Cái này cần backend mạnh.<br/> 2. Nếu dịch vụ web không có nhiều người dùng nhưng có thể bị DDoS.<br/> Cái này cần frontend mạnh.<br/> &nbsp;
</blockquote><br/> DDOS hoặc phòng chống các loại tấn công chắc phải làm ở mức độ ...... nào đó thôi, chứ em chắc cũng không làm hoành tráng được như bộ phòng thủ HVA được (vì khả năng có hạn). Tăng cường QuadCore Xeon, RAM 8G rồi RAID chắc hoà bình thế giới rồi. Nhét thêm dàng iptables (anh hướng dẫn trên HVA) với bộ csr của mod_security là yên giấc luôn.<br/><br/> <p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Về khoảng LB và failover thì tất cả phải là x2 theo nguyên tắc. Đối với frontends, LB và failover thì dễ nhưng backend thì hơi căng và <font color='yellow'>phải áp dụng chặt chẽ biện pháp đồng bộ hoá CSDL </font>không thì kẹt. Trong trường hợp tách rời CSDL ra thì không thể dùng UNIX domain socket (ngoại trừ dùng NFS để mount FS).&nbsp;
</blockquote><br/> Ngay thời điểm này em chỉ nghĩ ra vài dạng,<br/> <b>1.</b> Pound + Keepalived+ SQL Cluster để LB + failover. Có điều thằng này em chỉ đọc qua chứ chưa chạy thữ, nên cũng nghi ngờ khả năng xử lý của nó thua xa nginx.<br/> <b>2.</b> Dùng Nginx+fpm rồi chạy SQL Cluster (mysql cluster chẳng hạn). Thêm vào DNS Round robin, cùng lắm là kết hợp monit và giảm TTL khoản 60giây chắc cũng được.<br/> <b>3. </b>Không có tiền nên như thằng F5 thì không tính vào được.<br/> <b>4.</b> Dùng NFS mount lên rồi làm sao sync dữ liệu vậy anh ? Nếu dùng chung 1 DB, không có Master/Slave thì em thấy cũng kẹt.<br/> <b>5. </b>Dùng dịch vụ heartbeat tạo ra mô hình Cold standby em thấy cũng hay, có điều, chạy cái này có vẻ hơi uổng resource, lỡ có bị DDOS, thằng slave đợi thằng master toi mới ngốc đầu dậy được, rồi sau đó đi đời theo thằng master luôn.<br/><br/> Ngồi nghĩ một hồi, trong trường hợp em chỉ có 3 server với cấu hình như trên, em thấy cái <b><font color='yellow'>2.</font></b> hơi hợp lý, cả 3 sever đều đóng 2 la` vài trò frontend+backend, hổ trợ lẫn nhau, đề phòng khi nào toi 1 con, giảm TTL thấp xuống 1 tí để bớt thời gian bị down.<br/><br/> Không biết anh nghĩ sao ?<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39805.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39805/245241.html#245241,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Dpm trả lời hoàn toàn chính xác.<br/><br/> Em có thể delare backend bao nhiêu php-fpm instances cũng được và trong <b>location ~ .*.php$ {}</b> thì em chỉ cần pass backend là xong. Cái em bị kẹt là syntax chớ không phải là mô hình. Anh cũng coi lướt nên không nhận ra cái mớ http em nhét vô <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">.<br/><br/> Với câu hỏi của em, em có thể configure nhiều backend nhưng quan trọng là những backend này ở đâu và cần làm những gì? Nếu những backend này chỉ có một mớ php đơn giản để thao tác thì nhiều backend không khác gì mấy bởi vì chính nginx có nhiều workers và php-fpm cũng có nhiều workers. Cả hai có thể handle concurrent và async requests. <font color='yellow'>Cái chính là bottleneck trong việc truy vấn tới CSDL</font>. Em có thể thiết kế để tạo ra hai backends (php-fpm engines) và mỗi backend connect đến 1 CSDL riêng biệt (nằm ở server khác) thì có thể improve rõ. Nếu csdl chạy trên cùng một server thì nên configure db connections để sử dụng luôn UNIX domain socket vì nó nhanh gọn hơn rất nhiều (cái này anh đã test nhiều lần).&nbsp;
</blockquote><br/><br/> Chu choa, then chốt của vấn đề là đây, em cũng đã đang định làm thữ mà anh trả lời luôn rồi. Em cũng nghi là sẽ bị bottleneck, mà không làm thì lại chả biết làm cách nào khác, nên định nhắm mắt làm đại.<br/><br/> Vậy bây giờ muốn làm 2 webserver, 1DB server thì chắc tiêu bởi bottleneck rồi.<br/><br/> anh nói <b>"Nếu csdl chạy trên cùng một server thì nên configure db connections để sử dụng luôn UNIX domain "</b> socket" thì tất là chỉ chạy 1 con server, không load blance mà cũng không HA được. Cách này có thể tốt, nhưng lỡ con server này teo thi tính sao anh.<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39805.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39805/245239.html#245239,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">Dpm wrote:</cite><br>
<blockquote>to anh Minh: theo em hiểu thì anh đang muốn loadbalance 2 thằng php-fpm,nếu như vậy có lẽ anh nên bỏ proxy_pass trong location / đi,và loadbalance trên fastcgi_pass:<br/><br/> location ~ .*.php$ {<br/> include /etc/nginx/fastcgi.conf;<br/> fastcgi_pass backend;<br/> fastcgi_index index.php;<br/> include fastcgi_params;<br/> fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br/> }&nbsp;
</blockquote><br/><br/> Chào Dpm,<br/> Cám ơn bạn đã trả lời cho mình, mình lo cái proxypass hoài mà không ngờ có thể viết thành <b>fastcgi_pass backend;</b>, cám ơn bạn giúp mình.<br/><br/> Trước khi cài thêm VM bạn cho mình hỏi, nếu có nhiều backend bên trong, nhưng vì một lý do nào đó, 1 trong số đó không access vào được thì có ảnh hưỡng gì đến client không ? Có khi nào nginx báo không thể truy cập không nhỉ.<br/><br/> Ngoài ra, mô hình mình đang làm hiện nay, từ kết quả benchmark cho thấy 1 nginx+fpm rất hiệu quả. Nhưng loadblance 2 thằng này thì liệu có hiệu quả hay có melit gì không nhỉ ? Hay từ ban đầu làm mô hình reverse proxy luôn ?<br/><br/> ps: Cám ơn anh conmale luôn, em đang làm thữ để mai mốt nhờ anh làm còn biết về nginx để ...... start/stop :-D<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39805.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39805/245235.html#245235,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Có hai chuyện:<br/><br/> 1. Nếu em đã sử dụng UNIX domain socket trong php-fpm rồi thì không thể dùng server 127.0.0.1:9000 cho "upstream backend" được vì TCP socket cho port 9000 hoàn toàn không hiện diện. Em chỉ có thể chọn UNIX domain socket hoặc TCP socket chớ không thể chọn cả hai.<br/> &nbsp;
</blockquote><br/> Đúng rồi, em cũng đã kiểm tra nhưng không thấy port được mỡ.<br/> Ok, cái này em hiểu rồi, để cho dễ hiểu, em tạm dùng 127.0.0.1:9000 để mô tả cái em muốn làm.<br/><br/> <blockquote><br/> 2. Hình như anh hiểu lầm ý em. Cấu hình ở đây em chỉ muốn chạy web service trên nginx chớ không phải dùng nginx làm proxy phải không? Nếu nginx làm web thì nó là web service chớ không phải là proxy service. Em không thể proxy vô backend vì chẳng có backend nào hết. Trong trường hợp của em, "backend" chính là php-fpm chớ không có gì khác.<br/><br/> Nếu em có 2 con apache bên trong thì mới sử dụng nginx làm proxy. Nếu không, không thể chính nginx làm proxy web service của nó được.&nbsp;
</blockquote><br/> Nếu em muốn cho nginx chạy web sever, có thể load blance cho 1 con backend bên trong thì có làm được không ạ ?Theo như anh nói, thì phải tắt chức năng proxy của nginx để nó chạy làm webserver thì mới được, nhưng để thực hiện load blance thì phải dùng đến proxypass, <font color='yellow'>chỗ này em không hiểu lắm</font>.<br/><br/> Nói một cách khác, bây giờ em có 1 con nginx IP của nó là 192.168.1.35 và 1 backend là 192.168.1.36.<br/> Giờ em muốn con 192.168.1.35 có thể tự xử lý như một webserver và đồng thời nó cũng roundrobin đến 192.168.1.36 được.<br/><br/> Em setup nginx như thế này(em tạm dùng tcp để mô ta) ,<br/> <blockquote>upstream backend {<br/> ip_hash;<br/> server 192.168.1.35:9000;<br/> server 192.168.1.36:9000;<br/> } &nbsp;
</blockquote><br/> Bên dưới đó có thể em setup là,<br/> <blockquote># LoadBlance to backend<br/> proxy_pass<span class="link"> http://backend;&nbsp;</span>
</blockquote><br/> Em nghĩ FPM của 192.168.1.35 là nó phải thế này,<br/> <blockquote>location ~ .*.php$ {<br/> include /etc/nginx/fastcgi.conf;<br/> fastcgi_pass 127.0.0.1:9000;<br/> fastcgi_index index.php;<br/> include fastcgi_params;<br/> fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br/> }<br/> &nbsp;
</blockquote><br/> Còn bên 192.168.1.36,thì làm sao để nó nhận request của phía nginx bên 192.168.1.35 ạ ?<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39805.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39805/245232.html#245232,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Em thử bỏ <b>listen.allowed_clients = 127.0.0.1</b> ra khỏi www pool coi thử?<br/><br/> Nên tận dụng UNIX domain socket vì nó efficient hơn TCP socket.<br/><br/> Thử đổi trong php-fpm config<br/> <b>listen = 127.0.0.1:9000</b><br/><br/> thành:<br/> <b>listen = /path/to/a.sock</b><br/><br/><br/> rồi trỏ nó trong nginx.conf từ:<br/> <b>fastcgi_pass 127.0.0.1:9000; </b><br/><br/> thành:<br/> <b>fastcgi_pass unix:/path/to/a.sock;</b><br/> &nbsp;
</blockquote><br/><br/> Em làm thành thế này,<br/><br/> <blockquote> location ~ .*.php$ {<br/> include /etc/nginx/fastcgi.conf;<br/> #fastcgi_pass 127.0.0.1:9000;<br/> <font color='yellow'> fastcgi_pass unix:/tmp/fpm.sock;</font><br/> fastcgi_index index.php;<br/> include fastcgi_params;<br/> fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br/> }<br/> &nbsp;
</blockquote><br/><br/> Trong www của php-fpm.conf thành như thế này,<br/> <blockquote>[www]<br/> <font color='yellow'>listen = /tmp/fpm.sock</font><br/> listen.backlog = -1<br/> &nbsp;
</blockquote><br/><br/> [root@localhost ~]# ls /tmp/<br/> <blockquote><font color='yellow'>fpm.sock</font> mapping-root scim-bridge-0.3.0.socket-0@localhost:0.0 virtual-root.1rn7IL<br/> &nbsp;
</blockquote><br/><br/> <p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Em dùng <b>proxy_pass<span class="link"> http://backend;</span></b> nhưng em declare "backend" ở đâu?&nbsp;
</blockquote><br/> Cái đoạn upstream backend trong nginx.conf không phải nó hả anh.<br/> <blockquote><br/> #<br/> # backend<br/> #<br/> upstream backend {<br/> ip_hash;<br/> server 127.0.0.1:9000;<br/> #server 192.168.1.36:9000;<br/> }&nbsp;
</blockquote><br/><br/> Hiện em làm như anh nói nhưng vẫn bị error sau,<br/><br/> <blockquote>[root@localhost ~]#<font color='yellow'> tail -f /var/log/nginx/access.log</font><br/> 192.168.1.3 - - [18/Aug/2011:15:12:55 +0900] "GET / HTTP/1.1" 502 575 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.112 Safari/535.1" "-"<br/><br/> [root@localhost ~]#<font color='yellow'> tail -f /var/log/nginx/error.log</font><br/> 2011/08/18 15:12:55 [error] 3445#0: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.1.3, server: test1, request: "GET / HTTP/1.1", upstream: "http://127.0.0.1:9000/", host: "192.168.1.35"<br/> &nbsp;
</blockquote><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39805.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39805/245226.html#245226,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Chào cả nhà,<br/><br/> Nghe thiện hạ đồn nginx khá lắm nên hôm nay đang thử dùng nginx với php-fpm chạy thử dịch vụ. Sau khi cài xong benchmark khá ngon. Cũng chưa rành lắm nhưng đại khái có thể giảm được 1/2 cho đến 1/3 Ram khi thử với ab của apache.<br/><br/> Chạy apache với stagic HTML<br/> <blockquote>Total transferred: 7499000 bytes<br/> HTML transferred: 7227000 bytes<br/> Requests per second: 352.94 [#/sec] (mean)<br/> Time per request: 14.167 [ms] (mean)<br/> Time per request: 2.833 [ms] (mean, across all concurrent requests)<br/> Transfer rate: 2584.61 [Kbytes/sec] received<br/> &nbsp;
</blockquote><br/> Chạy nginx với Stagic HTML<br/> <blockquote>Total transferred: 7454000 bytes<br/> HTML transferred: 7227000 bytes<br/> Requests per second: 2679.47 [#/sec] (mean)<br/> Time per request: 1.866 [ms] (mean)<br/> Time per request: 0.373 [ms] (mean, across all concurrent requests)<br/> Transfer rate: 19503.87 [Kbytes/sec] received&nbsp;
</blockquote><br/><br/> đọc thêm 1 chút tài liệu thì thấy nginx có các ưu diểm về bảo mật cũng như cơ chế chạy nhiều process xịn? hơn hoặc tương đương với worker của apache,<br/><br/> <u>vd:</u><br/> +quản lý dịch vụ bằng worker rất xịn, bao gồm start/stop dịch vụ nhẹ nhàng(graceful),<br/> +Chạy worker riêng biệt uid/gid/chroot/environment, và dùng php.ini kiểu khác,<br/> +Khi cache opcode bị hư, sẽ tự động restart,<br/> +Sử dụng tính năng upload xịn ,<br/> +Xử dụng ptrace hoặc các tính năng để execute_date các php backtrace để xuất slowlog,<br/> +Có SAPI giống như mod_status,<br/> +Cái chổ mình thấy ghê nhất là khi cần upgrade binary của nginx, chỉ cần gửi USR2 signal nó sẽ tự động chuyển file nginx.pid thành nginx.pid.oldbin. Sau đó 2 binary sẽ chạy song song, rồi gửi winch signal thì các thread củ đang chạy sẽ tắt êm đềm. Không biết có còn nhớ vụ này khi upgrade hay không nữa.<br/> etc....<br/><br/> mình thử, sửa vài phần trong php-fpm và nginx và bench thì được kết quả như sau:<br/><br/> <blockquote><font color='yellow'>/ab -n 1000 -c 20 -t 10<span class="link"> http://localhost/index.html</span></font><br/><br/> # <font color='yellow'>free -m</font><br/> total used free shared buffers cached<br/> Mem: 497 346 151 0 11 126<br/> -/+ buffers/cache: 208 289<br/> Swap: 1027 9 1017&nbsp;
</blockquote><br/><br/> avg cũng lên cao nhưng không như apache dùng prefork.<br/> <blockquote><br/> top - 17:16:48 up 7 days, 2:56, 3 users, load average: 4.12, 1.24, 0.44<br/> Tasks: 107 total, 23 running, 75 sleeping, 8 stopped, 1 zombie<br/> Cpu(s): 89.5%us, 4.5%sy, 0.0%ni, 0.0%id, 0.0%wa, 2.5%hi, 3.5%si, 0.0%st<br/> Mem: 509792k total, 299092k used, 210700k free, 12056k buffers<br/> Swap: 1052248k total, 10232k used, 1042016k free, 102124k cached<br/><br/> PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND<br/> 11823 nginx 16 0 124m 23m 15m R 63.8 4.7 0:02.69 php-fpm<br/> 11810 nginx 16 0 124m 23m 15m R 31.9 4.6 0:02.31 php-fpm<br/> 11805 nginx 16 0 124m 23m 15m R 25.9 4.6 0:03.59 php-fpm<br/> 11824 nginx 16 0 125m 23m 15m R 21.9 4.8 0:01.19 php-fpm<br/> 11806 nginx 16 0 124m 23m 15m R 19.9 4.6 0:03.96 php-fpm<br/> 11807 nginx 16 0 125m 23m 15m R 15.0 4.8 0:02.25 php-fpm<br/> 11825 nginx 16 0 125m 23m 15m R 15.0 4.8 0:01.55 php-fpm<br/> 10715 nginx 15 0 21728 2180 756 S 5.0 0.4 0:01.02 nginx<br/> 11123 mysql 15 0 452m 50m 5684 S 1.0 10.1 0:01.65 mysqld&nbsp;
</blockquote><br/><br/> Chỉ có CPU tăng cao nhưng RAM thì không bị giảm quá đáng.<br/> <blockquote># <font color='yellow'>vmstat 1</font><br/> procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu------<br/> r b swpd <font color='yellow'> free</font> buff cache si so bi bo in cs us sy id wa st<br/> 1 0 10144 73552 54424 147776 0 0 1 3 2 16 0 0 99 0 0<br/> 31 0 10144 59592 54424 147776 0 0 0 0 2099 858 57 10 33 0 0<br/> 31 0 10144 60948 54424 147792 0 0 0 0 1744 762 94 6 0 0 0<br/> 31 0 10144 58468 54424 147868 0 0 0 4 1897 681 94 6 0 0 0<br/> 31 0 10144 59212 54424 147876 0 0 0 0 1904 842 94 6 0 0 0<br/> 34 0 10144 59708 54428 147948 0 0 0 460 1777 828 94 6 0 0 0<br/> 32 0 10144 59832 54428 147944 0 0 0 0 1785 835 94 6 0 0 0<br/> 32 0 10144 59212 54428 148020 0 0 0 0 1971 763 93 7 0 0 0<br/> 31 0 10144 59832 54428 148024 0 0 0 0 1891 896 94 6 0 0 0<br/> 31 0 10144 59708 54428 148100 0 0 0 0 2010 769 94 6 0 0 0<br/> 32 0 10144 59832 54436 148080 0 0 0 480 1943 855 93 7 0 0 0<br/> 34 0 10144 70760 54436 148232 0 0 0 0 2099 1320 92 9 0 0 0<br/> 35 0 10144 69560 54436 148444 0 0 0 0 1020 1727 95 5 0 0 0&nbsp;
</blockquote><br/><br/> Cảm thấy, php-fpm rút RAM cũng khá nhiều(chạy <font color='yellow'>pmap</font>) nhưng cũng mãn nguyện với kết quả trên,bởi vì khi chỉnh sữa các parm trong php-fpm.conf, thì kết quả ab có cải thiện rỏ rệch. Có điều, khi tăng quá nhiều các trong số của ab, thì phía nginx sẽ báo <b>Too many open files</b>, nên mình phải tăng thêm <b>worker_rlimit_nofile 10240;</b> vào <font color='yellow'>/etc/security/limits.conf</font> .<br/> <blockquote>cat /etc/security/limits.conf<br/> nginx soft nofile 10240<br/> nginx hard nofile 10240&nbsp;
</blockquote><br/><br/> Nhìn tổng thể, cho thấy nginx cũng khá tuyệt, nên mình quyết dùng nginx chạy dịch vụ <b>joomla+sql+fpm+nginx</b>, và thữ cho nginx loadblance theo hướng dẫn trên trang của nginx <span class="link"> http://wiki.nginx.org/NginxLoadBalanceExample</span>). Có điều tới đây thì .... bí. Không hiểu cách ấn định backend của mình có vấn đề gì mà khi bắt đầu sử dụng <font color='yellow'>proxy_pass </font> bị báo lỗi như sau:<br/> <blockquote>2011/08/18 11:36:33 [error] 2723#0: *4 recv() failed (104: Connection reset by peer) while reading response header from upstream, client: 192.168.1.3, server: test1, <font color='yellow'>request: "GET / HTTP/1.1", upstream: "http://127.0.0.1:9000/", host: "192.168.1.35</font>"&nbsp;
</blockquote><br/><br/> (<font color='yellow'>Đã tắt sạch iptables + selinux</font>)<br/> Tắt cái <font color='yellow'>proxypass</font> đi thì hoạt được bình thường, request của client chạy tới nginx và nginx đưa đến fpm ngon lành.<br/> <blockquote>192.168.1.3 - - [18/Aug/2011:11:30:43 +0900] "GET / HTTP/1.1" 502 575 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.112 Safari/535.1" "-"<br/> 192.168.1.3 - - [18/Aug/2011:11:30:43 +0900] "GET /favicon.ico HTTP/1.1" 404 201 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.112 Safari/535.1" "-"&nbsp;
</blockquote><br/><br/> Cấu hình của php 5.3.6 khi compile<br/> <blockquote>#! /bin/sh<br/> #<br/> # Created by configure<br/><br/> './configure' \<br/> '--program-prefix=' \<br/> '--prefix=/usr' \<br/> '--exec-prefix=/usr' \<br/> '--disable-debug' \<br/> '--with-pic' \<br/> '--disable-rpath' \<br/> '--with-pear' \<br/> '--with-bz2' \<br/> '--with-exec-dir=/usr/bin' \<br/> '--with-freetype-dir=/usr' \<br/> '--with-png-dir=/usr' \<br/> '--with-xpm-dir=/usr' \<br/> '--enable-gd-native-ttf' \<br/> '--without-gdbm' \<br/> '--with-gettext' \<br/> '--with-gmp' \<br/> '--with-iconv' \<br/> '--with-jpeg-dir=/usr' \<br/> '--with-openssl' \<br/> '--with-pcre-regex=/usr' \<br/> '--with-zlib' \<br/> '--with-layout=GNU' \<br/> '--enable-exif' \<br/> '--enable-ftp' \<br/> '--enable-magic-quotes' \<br/> '--enable-sockets' \<br/> '--enable-fpm' \<br/> '--with-kerberos' \<br/> '--enable-ucd-snmp-hack' \<br/> '--enable-shmop' \<br/> '--enable-calendar' \<br/> '--without-sqlite' \<br/> '--with-libxml-dir=/usr' \<br/> '--enable-xml' \<br/> '--with-libdir=lib64' \<br/> '--with-mysql' \<br/> '--with-gd' \<br/> '--enable-dom' \<br/> '--enable-dba' \<br/> '--without-unixODBC' \<br/> '--enable-pdo' \<br/> '--disable-xmlreader' \<br/> '--disable-xmlwriter' \<br/> '--with-sqlite3' \<br/> '--disable-phar' \<br/> '--disable-fileinfo' \<br/> '--without-pspell' \<br/> '--disable-wddx' \<br/> '--with-curl' \<br/> '--enable-mbstring' \<br/> "$@"&nbsp;
</blockquote><br/><br/> Cấu hình của <font color='yellow'>php-fpm.conf</font><br/> <blockquote>[global]<br/> pid = /var/run/php-fpm.pid<br/> error_log = /var/log/php-fpm.log<br/> log_level = notice<br/> emergency_restart_threshold = 0<br/> emergency_restart_interval = 0<br/> process_control_timeout = 0<br/> daemonize = yes<br/><br/> [www]<br/> <font color='yellow'>listen = 127.0.0.1:9000</font><br/> listen.backlog = -1<br/> <font color='yellow'>listen.allowed_clients = 127.0.0.1<br/> </font><br/> listen.owner = nginx<br/> listen.group = nginx<br/> listen.mode = 0666<br/><br/> user = nginx<br/> group = nginx<br/><br/> pm = dynamic<br/> # Mấy cái này phải dựa vào kết quả của benchmark trên của ab, nên mình đưa tạm các tham số này, chạy cũng ổn.<br/> <font color='yellow'>pm.max_children = 30<br/> pm.start_servers = 11<br/> pm.min_spare_servers = 10<br/> pm.max_spare_servers = 25<br/> pm.max_requests = 500</font><br/> pm.status_path = /status<br/><br/> request_slowlog_timeout = 2<br/> # Cái thằng này quan trọng cực, khi default nó được set là 5? hay sao đó, nhưng chạy dịch vụ gì cũng bị timeout hay bất ổn định, nên phải set thành 10. Bà con nào chạy dịch vụ nào cùng với SQL thì để ý.<br/> <font color='yellow'>request_terminate_timeout= 10</font><br/> slowlog = /var/log/$pool.log.slow<br/><br/> # do phpinfo() cảnh báo nên phải set cho nó, không có gì đâu.<br/> <font color='yellow'>php_admin_value[date.timezone]=Asia/Tokyo</font><br/> &nbsp;
</blockquote><br/><br/> Cấu hình của <font color='yellow'>nginx.conf</font> (nginx/0.8.54)<br/> Hiện backend mình chỉ để 1 server, nhưng do lỗi trên nên không hoạt động được. Không biết có cần phải làm gì thêm để nginx có thể proxy_pass có thể round robin khi có php-fpm đến 2 server không.<br/> <blockquote>#<br/> user nginx;<br/> worker_processes 2;<br/> # Log file of nginx<br/> error_log /var/log/nginx/error.log;<br/> pid /var/run/nginx.pid;<br/><br/> events {<br/> worker_connections 1024;<br/> }<br/><br/> #----------------------------------------------------------------------<br/> # HTTP Core Module<br/> #<br/> # <span class="link"> http://wiki.nginx.org/NginxHttpCoreModule</span><br/> #<br/> #----------------------------------------------------------------------<br/><br/> http {<br/> include /etc/nginx/mime.types;<br/> default_type application/octet-stream;<br/><br/> log_format main '$remote_addr - $remote_user [$time_local] "$request" '<br/> '$status $body_bytes_sent "$http_referer" '<br/> '"$http_user_agent" "$http_x_forwarded_for"';<br/><br/> access_log /var/log/nginx/access.log main;<br/><br/> sendfile on;<br/> keepalive_timeout 0;<br/><br/> #Gzip<br/> gzip on;<br/> gzip_http_version 1.0;<br/> gzip_disable "MSIE [1-6]\.";<br/> gzip_disable "Mozilla/4";<br/> gzip_comp_level 2;<br/> gzip_vary on;<br/> gzip_proxied any;<br/> gzip_buffers 4 8k;<br/> server_names_hash_bucket_size 128; # 32/64/128<br/><br/> # Proxy cache (FastCGI)<br/> proxy_buffering on;<br/> proxy_buffer_size 8k;<br/> proxy_buffers 100 8k;<br/> proxy_cache_path /var/cache/nginx/nginx_cache levels=1:2 keys_zone=czone:4m max_size=50m inactive=120m;<br/> proxy_temp_path /var/cache/nginx/nginx_tmp;<br/> proxy_connect_timeout 60;<br/> proxy_read_timeout 90;<br/> proxy_send_timeout 60;<br/> proxy_cache_valid 200 2h;<br/> proxy_cache_valid 302 2h;<br/> proxy_cache_valid 301 4h;<br/> proxy_cache_valid any 1m;<br/><br/> #<br/> # set header<br/> #<br/> proxy_set_header Host $http_host;<br/> proxy_set_header X-Remote-Addr $remote_addr;<br/> proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br/><br/> #<br/> # backend<br/> #<br/> upstream backend {<br/> ip_hash;<br/> <font color='yellow'>server 127.0.0.1:9000;</font><br/> # server 192.168.1.36:9000;<br/> }<br/><br/> #<br/> # The default server<br/> #<br/> server {<br/> listen 80;<br/> server_name test1;<br/><br/> root /opt/public_html;<br/> index index.php;<br/><br/> # Support Clean (aka Search Engine Friendly) URLs<br/> <font color='yellow'> location / </font>{<br/> # try_files $uri $uri/ /index.php?q=$request_uri;<br/><br/> # LoadBlance to backend<br/> <font color='yellow'>proxy_pass<span class="link"> http://backend;</span></font><br/> #proxy_cache_key $scheme://$backend$request_uri$is_args$args;<br/><br/> }<br/><br/> index index.php index.html index.htm;<br/><br/> # deny running scripts inside writable directories<br/> location ~* /(images|cache|media|logs|tmp)/.*\.(php|pl|py|jsp|asp|sh|cgi)$ {<br/> return 403;<br/> error_page 403 /403_error.html;<br/> }<br/><br/> # The parameter fastcgi_pass is set to 127.0.0.1:9000, corresponding to the port that fpm is configured to listen to.<br/> location ~ .*.php$ {<br/> include /etc/nginx/fastcgi.conf;<br/> fastcgi_pass <font color='yellow'>127.0.0.1:9000;</font><br/> fastcgi_index index.php;<br/> include fastcgi_params;<br/> fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<br/> }<br/><br/> # caching of files<br/> location ~* \.(ico|pdf|flv)$ {<br/> expires 30d;<br/> }<br/><br/> location ~* \.(js|css|png|jpg|jpeg|gif|swf|xml|txt)$ {<br/> expires 7d;<br/> }<br/><br/> }<br/><br/> # Load config files from the /etc/nginx/conf.d directory<br/> include /etc/nginx/conf.d/*.conf;<br/> }&nbsp;
</blockquote><br/><br/> Cám ơn đã chú ý.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39791.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39791/245089.html#245089,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Sao không dùng CentOS6 luôn ?<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39641.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39641/244602.html#244602,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mỗi lần HVA gặp nạn là chạy ra một đống anh em, chiến hữu rút đao tương trợ.<br/><br/> HVA nên bị DDOS nhiều thì mới nhộn nhịp, xôm tụ được.<br/><br/> (mình không nói nhảm nha, mình đang phân tích tính chất vài trận DDoS HVA vừa qua à )<br/><br/> <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39641.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39641/244520.html#244520,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote>He he, cái botnet mới này đấm không nhanh và nhiều như cái cũ mà đấm chậm, chắc và âm ỉ, kiểu như bên ngoài không thấy bị trầy xước nhưng bên trong lục phủ ngũ tạng bị bấy nhầy vậy . Đúng là anh em ta chủ quan quá. Cứ nhắm vô cái botnet đã lộ để phòng thủ nên bị chết là phải.&nbsp;
</blockquote><br/><br/> Anh mô tả mà em đọc như chiêu "Đại lực kim cương chỉ" của thiếu lâm <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">)</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/5.html">Góp ý và Hỏi đáp thắc mắc chung</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39339.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39339/243498.html#243498,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">ít ra cũng ... Thanh Niên giùm cái cho đỡ thẹn hehe</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/5.html">Góp ý và Hỏi đáp thắc mắc chung</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39339.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39339/243314.html#243314,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">JAL dang o VN roi ban oi<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.html">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38818.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38818/241033.html#241033,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><blockquote>2 tranvanminh: anh viết toàn bộ buồn cười hay anh khoe nó buồn cười.&nbsp;
</blockquote><br/><br/> Dạ, là như anh conmale trình bày, thấy vui với cách hành văn của anh thôi, chứ không phải nói nội dung kỹ thuật của anh buồn cười (mà thật ra là em hoàn toàn không hiểu về kỹ thuật anh viết ) .<br/><br/> Thân mến. </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/36.html">Thủ thuật reverse engineering</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38818.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38818/240726.html#240726,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote>Khoe một chút: Thấy font và color của OllyDbg em đang dùng đẹp không. Font: Raize, color: Alex Black.&nbsp;
</blockquote><br/><br/> Đọc mà chỉ buồn cưới <img src="/hvaonline/images/smilies/aa694503e005b7e28b579defab48c1a7.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38694.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38694/237090.html#237090,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mình định đọc sơ qua phần 1 thôi, mà đọc một hồi thì đã xong phần 3 .<br/> Cám ơn bản đã bỏ công viết giới thiệu MS cụ thể, chính xác và đầy đủ .<br/><br/> Thân </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/5.html">Góp ý và Hỏi đáp thắc mắc chung</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38499.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38499/236762.html#236762,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cái này là facebook của bạn xnohat, đâu phải của HVA đâu chờy . </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38309.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38309/235373.html#235373,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Đã giải quyết, như anh conmale nói, tại gw nó có cái gì đó chặn lại .<br/><br/> Em dùng máy ảo đã xác nhận được cấu hình không sai .<br/><br/> Cám ơn cả nhà.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38309.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38309/235315.html#235315,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hì, cám ơn nhiều nha.<br/> Để mình test lại trên virtual box xem, chắc là config không sai thì mới dám mạnh dạng đem vào môi trường chính chạy ^^ </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38309.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38309/235313.html#235313,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">tranhuuphuoc wrote:</cite><br>
<blockquote>Thử chỉ định dòng listen_addresses='*' thành listen_addresses='113.110.220.10' và restart lại Postgresql thử xem coi còn có hiện tượng này không. Lão cho xem mấy cái log để tìm nguyên nhân thử.<br/><br/> &nbsp;
</blockquote><br/><br/> Mình thử cách đó rồi, không hết bệnh bác ạ. Rồi thử chuyển SSH sang port 5432 thì cũng không chạy được (22 thì OK) . Chắc nó có firewall ở GW của cái dịch vụ hosting chổ mình, nên không vào được.<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38309.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38309/235310.html#235310,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">anh conmale :<br/><br/> Em dump nó không ra gì thiệt, chắc là cái server VPS kia ở GW nó có cái gì đó rồi . Chắc được là không phải tại config của mình là được, để em tạo máy ảo check lại xem, nếu nó chạy được thì Ok.<br/><br/> Cám ơn anh.<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38309.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38309/235306.html#235306,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Chào cả nhà,<br/><br/> Mình lại bị bí về vấn đề kết nối từ remote đến postgresql, không biết nhà mình có ai rành vụ này thì xin ý kiến. Hiện mụốn tuy cập từ một Server nằm ngoài internet (global IP) đến server chạy dịch vụ postgresql nhưng không thực hiện được.<br/> Mình cài postgresql8.1.22 trên centos5, thông tin config như sau:<br/><br/> /var/lib/pgsql/data/pg_hba.conf<br/> <blockquote>host all all 0.0.0.0/0 trust&nbsp;
</blockquote><br/> /var/lib/pgsql/data/postgresql.conf<br/> <blockquote>listen_addresses = '*'<br/> port = 5432 &nbsp;
</blockquote><br/><br/> Sau đó restart SQL và kiểm tra bằng netstat .<br/> <blockquote>/etc/rc.d/init.d/postgresql start<br/> &nbsp;
</blockquote><br/> <blockquote><br/> [root@hva minh]# netstat -nat<br/> Active Internet connections (servers and established)<br/> Proto Recv-Q Send-Q Local Address Foreign Address State<br/> <b>tcp 0 0 0.0.0.0:5432 0.0.0.0:* LISTEN</b><br/> &nbsp;
</blockquote><br/><br/> Ghi chú : iptables đã được tắt, và máy chủ của postgresql không có firewall nào nằm ở ngoài cả , phía client thì cũng tắt firewall, và antivirus nhưng cũng không có tác dụng. </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/26.html">Thảo luận các loại thiết bị máy tính</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/37675.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/37675/231833.html#231833,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Giống đăng tin mất CMND quá , hehe</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/28451.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/28451/231780.html#231780,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Khắc phục được sự có chứ anh, con server đó cho em cũng không thèm, mang về kiểm tra HW rồi cũng phải bê đi cho người ta dùng chứ em đâu có được dùng nó để chat hay chít đâu ạ <img src="/hvaonline/images/smilies/bde7cf9049e122a728d29f2213bb2b67.gif" border="0" alt="smilie" align="absbottom"><br/><br/> Sướng là vì bình thường dùng net, nó không bị gì cũng chê lên chê xuống, nhưng mà khi bị sự cố rồi mới biết không có nó thì mình khổ bao nhiêu<img src="/hvaonline/images/smilies/b4028a94b255f1e2b9bb6e172b05f60b.gif" border="0" alt="smilie" align="absbottom"> chỉ là cảm nhận nhỏ nhoi thôi anh hehe</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/28451.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/28451/231718.html#231718,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Báo cáo,<br/><br/> Sau những ngày vật lộn với HP, chính thức có kết quả NIC bị hư .<br/><br/> Hôm nay nhân viên HP đến thay mainboard thì đã hoạt động lại được, không ngờ có net lại sướng như thế này .</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/28451.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/28451/231659.html#231659,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">tranvanminh wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">tranvanminh wrote:</cite><br>
<blockquote>Dạ đây anh ,<br/><br/> driver : bnx2<br/> vesion: 2.0.8-rh<br/> firmware-version : bc 5.2.3 NCSI 2.0.6<br/> bus-info : 0000:04:00.0<br/><br/> Anh nói vậy làm em nghi ngờ quá, chắc thàng của em cũng dính chưỡng rồi <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">( &nbsp;
</blockquote><br/><br/> Phương án 1:<br/><br/> Vô đây download driver từ chính broadcom và tải về cái pdf hướng dẫn để cài driver lại:<span class="link"> http://www.broadcom.com/support/ethernet_nic/netxtremeii.php</span><br/><br/><br/> Phương án 2:<br/><br/> Download vanilla kernel mới hơn và compile lại kernel.&nbsp;
</blockquote><br/><br/> Em làm cả 2 phương án , kết quả cũng không thay đổi anh ơi .<br/><br/> Phương án 1 : Khi compile source ra có bị lỗi, nhưng sữa code của nó cho nó compile được nhưng không modprobe nó được , lỗi này em chưa copy lại, nếu anh cần thì em làm lại (File bnx2.h, hàm VLAN_GROUP_ARRAY_SPLIT của broadcom và kernel trùng nhau, nên phải comment out từ include/bnx2.h, source của kernel thì mới make được).<br/> Phương án 2 : Sau khi compile kernel, kết quả của ethtool cho thấy driver có thay đổi version nhưng vẫn bị .<br/> <blockquote>driver : bnx2<br/> vesion: 2.0.17<br/> firmware-version : bc 5.2.3 NCSI 2.0.6<br/> bus-info : 0000:04:00.0<br/> &nbsp;
</blockquote><br/><br/> <blockquote>uname -r<br/> 2.6.36.1&nbsp;
</blockquote><br/> &nbsp;
</blockquote><br/><br/> Vậy thì có thể chính network card đó có vấn đề rồi. Em thử thay network card vô coi có ok không?&nbsp;
</blockquote><br/><br/> Em da~ giai quyet cai nay roi a.<br/><br/> NIC co 4 ports, em thu enable len het thi eth3 la.i len, sau do dieu tra thi em biet duoc MAC cua eth0 da bi doi (noi dung file config bi doi) qua eth3 nen no moi len, do do' eth0 khong boot len duoc .<br/><br/> Nguyen nhan noi dung file config cua eth0 bi thay doi thi lai khong ro lam.<br/><br/> Da giai quyet duoc van de, cam on anh conmale va quanta .<br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/37594.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/37594/231604.html#231604,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote>switchroot: mount failed: No such file or directory ... Kernel panic - not syncing: Attempted to kill init<br/> &nbsp;
</blockquote><br/> Từ dòng kernel 2.6.25 là có vụ này, bạn compile 2.6.3x thì phải cho nó support udev , phải làm các bước sau, mình vừa bị dính xong, chia sẻ cho bạn .<br/><br/> 1. Lấy config từ kernel đang chạy<br/> cp /boot/config-2.6.18-194.11.3.el5 .config<br/> 2. Sử dụng nó<br/> make oldconfig (Nó hiện lên màng hình đối thoại thì cứ bấm Enter riết)<br/> 3. make menuconfig<br/> Kernel panic là do thằng này, nên bạn cần phải enable chức năng này .<br/> [General setup]-[enable deprecated sysfs features to support old userspace tools]<br/> (Nếu config trực tiếp thì vào file .config, CONFIG_SYSFS_DEPRECATED_V2=y)<br/> Chọn các mục trong này để nó support iptables , nếu không biết thì cứ chọn hết .<br/> [Networking support]-[Networking options]-[Network packet filtering framework (NetFilter)]-[Core Netfilter Configuration]<br/> [Networking support]-[Networking options]-[Network packet filtering framework (NetFilter)]-[IP: Netfilter Configuration]<br/> [Networking support]-[Networking options]-[Network packet filtering framework (NetFilter)]-[IPv6: Netfilter Configuration]<br/><br/> 4. make bzImage modules modules_install<br/> 5. make install<br/> 6. Vào grub để chọn default kernel để boot<br/><br/> Mình chỉ compile được trên kernel 2.6.36.4, còn 2.6.37.1 thì chưa làm được . Vẫn bị panic . </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/28451.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/28451/231582.html#231582,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">tranvanminh wrote:</cite><br>
<blockquote>Dạ đây anh ,<br/><br/> driver : bnx2<br/> vesion: 2.0.8-rh<br/> firmware-version : bc 5.2.3 NCSI 2.0.6<br/> bus-info : 0000:04:00.0<br/><br/> Anh nói vậy làm em nghi ngờ quá, chắc thàng của em cũng dính chưỡng rồi <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">( &nbsp;
</blockquote><br/><br/> Phương án 1:<br/><br/> Vô đây download driver từ chính broadcom và tải về cái pdf hướng dẫn để cài driver lại:<span class="link"> http://www.broadcom.com/support/ethernet_nic/netxtremeii.php</span><br/><br/><br/> Phương án 2:<br/><br/> Download vanilla kernel mới hơn và compile lại kernel.&nbsp;
</blockquote><br/><br/> Em làm cả 2 phương án , kết quả cũng không thay đổi anh ơi .<br/><br/> Phương án 1 : Khi compile source ra có bị lỗi, nhưng sữa code của nó cho nó compile được nhưng không modprobe nó được , lỗi này em chưa copy lại, nếu anh cần thì em làm lại (File bnx2.h, hàm VLAN_GROUP_ARRAY_SPLIT của broadcom và kernel trùng nhau, nên phải comment out từ include/bnx2.h, source của kernel thì mới make được).<br/> Phương án 2 : Sau khi compile kernel, kết quả của ethtool cho thấy driver có thay đổi version nhưng vẫn bị .<br/> <blockquote>driver : bnx2<br/> vesion: 2.0.17<br/> firmware-version : bc 5.2.3 NCSI 2.0.6<br/> bus-info : 0000:04:00.0<br/> &nbsp;
</blockquote><br/><br/> <blockquote>uname -r<br/> 2.6.36.1&nbsp;
</blockquote><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/28451.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/28451/231350.html#231350,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Em cám ơn anh, em sẽ làm thữ và sẽ báo kết quả lên đây cho mọi người tham khảo .<br/><br/> Minh<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/28451.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/28451/231330.html#231330,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Dạ đây anh ,<br/><br/> driver : bnx2<br/> vesion: 2.0.8-rh<br/> firmware-version : bc 5.2.3 NCSI 2.0.6<br/> bus-info : 0000:04:00.0<br/><br/> Anh nói vậy làm em nghi ngờ quá, chắc thàng của em cũng dính chưỡng rồi <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">( </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/25267.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
							<a href="/hvaonline/posts/listByUser/0/25267.html">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_prev_page.gif" width="5" height="9" alt="Page 1" title="Page 1"/>
							</a>
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/25267' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" selected="selected">2</option>	
								<option value="3" >3</option>	
								<option value="4" >4</option>	
								<option value="5" >5</option>	
								<option value="6" >6</option>	
								<option value="7" >7</option>	
								<option value="8" >8</option>	
								<option value="9" >9</option>	
								<option value="10" >10</option>	
								<option value="11" >11</option>	
								<option value="12" >12</option>	
								<option value="13" >13</option>	
								<option value="14" >14</option>	
								<option value="15" >15</option>	
								<option value="16" >16</option>	
								<option value="17" >17</option>	
								<option value="18" >18</option>	
						</select>
						
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/60/25267.html">3</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/90/25267.html">4</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/120/25267.html">5</a></span>
								<a href="/hvaonline/posts/listByUser/150/25267.html">
									<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 6" title="Page 6"/>
								</a>
						
						<a href="/hvaonline/posts/listByUser/510/25267.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (18)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
