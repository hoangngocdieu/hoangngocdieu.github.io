<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by tanviet12, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by tanviet12 - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/220642.html" name="top" class="maintitle" id="top">Messages posted by: tanviet12</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/220642.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/220642.html">Profile for tanviet12</a> 
            			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/220642.html">Messages posted by tanviet12</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39641.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39641/244044.html#244044,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><blockquote>Nếu người dùng chỉ là "standard user" chớ chẳng phải là user với chủ quyền "administrator" thì hai động tác trên không thể xảy ra được. Trên Windows 7 càng khó hơn vì càng không thể "silently" thực thi việc này. Bởi vậy, với tổng cộng gần 100 ngàn IP tấn công HVA mấy ngày vừa qua (số lượng máy con thật sự đằng sau các IP này có lẽ còn nhiều hơn rất nhiều) toàn là những máy con chạy với chủ quyền "Administrator". Đây là sự thật đáng sợ. Cho dùng Windows 7 có bảo mật như thế nào đi chăng nữa mà người dùng sử dụng máy với account có chủ quyền cao nhất thì coi như tính bảo mật của Windows 7 cũng bỏ đi. &nbsp;
</blockquote><br/><br/> Hix, ngày xưa em cũng từng cài rất nhiều máy windows. Toàn cho người dùng với quyền administrator, bởi không bị giới hạn trong cài đặt phần mềm... Nhưng lâu rồi thì mới biết, những mấy như thế rất dễ bị virus, "mèo què" gây hại, bởi hiểu một cách đơn giản: dễ với mình thì cũng dễ với mã độc.<br/><br/> Bởi vậy, nếu có cách anh chị nào hay cài đặt PC cho bạn bè, người thân, máy tính của công ty mình. Lưu ý nên cài với user bình thường, tạo các policy để giới hạn quyền... Phòng bênh trước khi chữa bệnh!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39641.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39641/244028.html#244028,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hì. HVA ta cũng có mấy huynh bên VNCERT nữa mà. Hy vọng các anh sẽ can thiệp sớm ..</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39641.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39641/243988.html#243988,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Không biết mấy anh chị bên VNCERT vào cuộc chưa. Chưa thấy động tĩnh gì hết</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/26.html">Thảo luận các loại thiết bị máy tính</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39603.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39603/243726.html#243726,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Bạn làm sao để biết win 7-64 chỉ nhận 3.24G RAM?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39599.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39599/243678.html#243678,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Perl à... hì. Mới upload cho sư huynh đây. Đọc cả năm không hết <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"><br/><br/> http://www.mediafire.com/?01f7y5q50q53k</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39549.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39549/243235.html#243235,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Tình hình là mấy bữa nay em thức xuyên đêm để cài <b>Gentoo</b>. Nhưng đến bước <b>Code Listing 2.30: Reboot</b> , reboot lại thì bị lỗi. (em cài đặt theo hướng dẫn ở<span class="link"> http://www.gentoo.org/doc/en/gentoo-x86-quickinstall.xml</span>).<br/><br/> Cụ thể lỗi như sau:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://cC0.upanh.com/24.858.31978969.XES0/gentooerr.jpg' border="0" /></div><br/><br/> Mong các anh, các chú giúp khắc phục lỗi này với!<br/> Em cảm ơn.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39233.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39233/242638.html#242638,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">URL wrote:</cite><br>
<blockquote>Mọi người ai có Demo (hay tài liệu) về công nghệ mạng chuyển tải không đồng bộ ATM ,xin giúp em với.<br/> Em xin cảm ơn mọi người. <img src="/hvaonline/images/smilies/bde7cf9049e122a728d29f2213bb2b67.gif" border="0" alt="smilie" align="absbottom"> &nbsp;
</blockquote><br/><br/> ATM mà demo thì thường trên GNS3, còn tài liệu thì trên mạng nhiều mà.. Mình đang dùng 3G.. tiết là không upload được..<br/> Bạn thử tìm cuốn Building Broadband Networks, ở chapter 2 có trình bày về ATM...</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39159.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39159/240769.html#240769,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Bạn tham khảo ở đây:<br/> http://2mit.org/forum/showthread.php/4810-Chong-mat-cap-laptop-voi-laptop-alarm?s=be633ac0db5ad4432bd762704e3b8d79</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/39159.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/39159/240767.html#240767,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cái phần mềm hoạt động theo cơ chế của bạn có rồi đó. Được viết riêng cho chống trộm labtop (có wc).. Bạn lên tìm ở google</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38690.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38690/239717.html#239717,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">xlove wrote:</cite><br>
<blockquote>Cảm ơn bạn. Vấn đề của mình đã được giải quyết.<br/> Mình đã cài được mod_security thành công.<br/> Mình đổi hostname thành localhost thì start được apache<br/> Nhưng mỗi lần viết rule thì mình lại phải reboot lại server. Ai có cách nào nhanh hơn không<br/> <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">&nbsp;
</blockquote><br/><br/> Không phải reboot server đâu bạn. Chỉ cần khởi động lại dịch vụ<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>/etc/init.d/httpd restart</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38690.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38690/239654.html#239654,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Theo mình vấn đề nằm ở hostname và file hosts của bạn. Bạn nên xem lại thử hostname của máy bạn là gì. Và file hosts nội dung ra sao.<br/> - Hostname: Để kiểm tra có thể gõ lệnh <font color='orange'>hostname </font>hoặc vào file cấu hình <font color='orange'>/etc/sysconfig/network</font><br/> - File hosts: <font color='orange'>/etc/hosts<br/> </font><br/> VD: Nếu hostname của máy bạn là localhost.localdomain thì nội dung file /etc/sysconfig/network thông thường sẽ là<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>NETWORKING=yes
HOSTNAME=localhost.localdomain</pre>
</div><br/><br/> Và file hosts thường sẽ là<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Do not remove the following line, or various programs
# that require network functionality will fail.
127.0.0.1 localhost.localdomain localhost</pre>
</div></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38977.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38977/238403.html#238403,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">Search_IT wrote:</cite><br>
<blockquote>Em đã thử dump 2 gói. 1 gói dùng IP thật. 1 gói dùng Sock5 để fake. Kết quả khi dùng Wireshark để đọc thì tìm mãi không thấy phần nào chứa <font color='orange'>X-Forwarded-For</font> cả.<br/><br/> Anh có thể giải thích hoặc nói rỏ hơn ko ạ?&nbsp;
</blockquote><br/><br/> Bạn nói rõ mô hình thử nghiệm của bạn xem. Bạn bắt gói tin kiểu gì <img src="/hvaonline/images/smilies/e8ca093a66c371dc3f8f254c2643f40d.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38977.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38977/238390.html#238390,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Đối với phương diện web webserver. Bạn có thể tham khảo chủ đề này /hvaonline/posts/list/38694.html<br/><br/> Phần 3.2. NGĂN CHẶN CÁC REQUEST TỪ PROXY SERVER<br/><br/> Thân!</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38788.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38788/237466.html#237466,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Server windows mà sao bạn lại cat /etc/passwd<br/> bạn gõ như thế để làm gì?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38788.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38788/237464.html#237464,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">guard_dawn1403 wrote:</cite><br>
<blockquote>Mình dùng lệnh<br/> cat /etc/passwd<br/> cat /etc/domains&nbsp;
</blockquote><br/><br/> web server IIS? <img src="/hvaonline/images/smilies/66974540156c425dcc8bdd09f8dd4821.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38788.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38788/237461.html#237461,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><blockquote>Chiếm server khi đã có shell&nbsp;
</blockquote><br/><br/> Bạn liên hệ với chủ server. Rồi hỏi server đặt ở đâu rồi đột nhập vào mà rinh về.... thế là chiếm đó! <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38704.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38704/237142.html#237142,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Nếu bạn dùng CentOS 5 vàc cài snort 2.9 thì có rất nhiều vấn đề xảy ra. Mình cũng đã từng cài và có ghi lại một số lưu ý. Bạn xem thử có giúp được gì không.<br/><br/> - Để cài libpcap 1.1.1 : gỡ bỏ gói rpm, sau đó cài bằng file .tar.gz rồi copy toàn bộ libpcap từ /usr/local/lib tới /usr/lib hoặc có thể tạo ln để chỏ tới.<br/><br/> - Nếu trong quá trình thực hiện cài bị lỗi.. có thể thử gỡ và cài lại bằng cách<br/><br/> cd vào thư mục cài đặt:<br/><br/> make clean<br/> make uninstall<br/><br/> sau đó thử lại<br/><br/> ./configure —enable-zlib —with-mysql<br/> make<br/> make check<br/> make install<br/><br/> now work for you!<br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38257.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38257/237097.html#237097,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Không biết có bạn nào download hết về chưa. Nếu download hết về thì tổng cộng là 604Mb.. <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38694.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38694/237096.html#237096,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cảm ơn anh và chú commale đã động viên.. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> Mong bài viết sẽ có ích cho những ai đang bắt đầu với ModSecurity</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38694.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38694/237063.html#237063,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><font color='orange'><b><font size='+1'>3.6. TẤN CÔNG DIRECTORY TRAVERSAL</font></b></font><br/><br/> Thông thường, web server sẽ từ chối client truy cập vào các tài nguyên không nằm trong thư mục gốc của web server.<br/><br/> Ví dụ: Nếu thư mục gốc của web server là<font color='yellow'> /home/www</font>, client yêu cầu truy cập vào tài nguyên <font color='yellow'>/etc/passwd </font>thì sẽ bị web server từ chối vì tài nguyên trên không nằm trong <font color='yellow'>/home/www</font>. Tuy nhiên, có một hình thức tấn công có thể truy cập vào tài nguyên này mà không cần sử dụng một công cụ nào, chỉ đơn thuần thao tác với các biến với <font color='yellow'>../ </font>(dot-dot-slash) để thực hiện liên kết mềm (symbolic) truy cập đến các file nằm trong thư mục cha của thư mục hiện hành. Đó là tấn công Directory Traversal.<br/><br/> Dưới đây là một ví dụ cụ thể về loại hình tấn công này.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>http://example.com/getpage.php?page=../../../etc/passwd</pre>
</div><br/><br/> Như ta thấy trên URI, thực hiện chèn biến<font color='yellow'> ../ </font>ba lần để liên kết mềm về thư mục gốc<font color='yellow'> /</font> . Sau đó thêm vào etc/passwd để tạo thành request đến thư mục /etc/passwd. Nếu không cấu hình cản lọc để request này, nội dung của file <font color='yellow'>/etc/passwd</font> sẽ được hiển thị trên trình duyệt của hacker.<br/> Hacker có thể không chèn trực tiếp biến <font color='yellow'>../</font> mà thực hiện chèn các biến đã được mã hoá như <font color='yellow'>%2e%2e%2f</font>, khi giải mã thì nội dung vẫn là <font color='yellow'>../</font><br/><br/> Dưới dây là danh sách các chuỗi chúng ta cần chặn:<br/><br/> - ../<br/> - ..%2f<br/> - %2e%2e/<br/> - %2e%2e%2f<br/> - %2e./<br/><br/> Với ModSecurity, chỉ cần sử dụng chức năng chuyển đổi <font color='yellow'>t:urlDecode </font>để chuyển tất cả chuỗi được mã hoá thành giá trị nguyên thuỷ của nó. Dưới đây là rule để chặn hình thức tấn công này:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_URI "../" "t:urlDecode,deny"</pre>
</div><br/><br/> <font color='orange'><b><font size='+1'>3.7. TẤN CÔNG SQL INJECTION</font></b></font><br/> <b><font color='orange'>3.7.1. Giới thiệu</font></b><br/><br/> Các cuộc tấn công SQL injection có thể xảy ra nếu hacker cung cấp dữ liệu cho ứng dụng web mà các dữ liệu này không được cản lọc, làm sai lệch các câu lệnh SQL khi thực thi. Điển hình là nhập vào các chuỗi đặc biệt để bỏ qua bước kiểm tra mật khẩu của người dùng và làm cho đăng nhập hợp lệ:<br/><br/> Ví dụ, chúng ta xét câu lệnh truy vấn khi thực hiện đăng nhập dưới đây:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SELECT * FROM user WHERE username = '%s' AND password = '%s';</pre>
</div><br/><br/> Với truy vấn trên, nếu hacker muốn đăng nhập vào với tài khoản admin mà chưa biết mật khẩu, hacker sẽ thực hiện nhập tên đăng nhập là admin và mật khẩu là <font color='yellow'>‘ OR ‘1’ = ‘1 --</font> Khi thực hiện truy vấn, thông tin đăng nhập được đưa vào sẽ trở thành:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SELECT * FROM user WHERE username = 'admin' AND password = '’ OR ‘1’ = ‘1’;</pre>
</div><br/><br/> Câu lệnh trên có nghĩa: Truy vấn lấy thông tin tất cả các trường từ bảng user với điều kiện trường username có giá trị là admin và mật khẩu là trống <font color='yellow'>‘’ </font>hoặc <font color='yellow'>1 = 1.</font> Mà <font color='yellow'>1 = 1 </font>là luôn đúng nên mặc dù mật khẩu không đúng, câu lệnh trên vẫn được thực thi và truy vấn lấy thông tin user admin thành công. Đăng nhập sẽ được chấp nhận.<br/><br/> <font color='orange'><b>3.7.2. Các hình thức tấn công SQL injection thông thường</b></font><br/> <font color='orange'><b>3.7.2.1. Lấy dữ liệu từ nhiều bảng với UNION</b></font><br/><br/> Câu lệnh SQL UNION có thể được sử dụng để lấy dữ liệu từ hai bảng khác nhau. Ví dụ: Nếu có một bảng có tên cooking_recipes và bảng khác có tên <font color='yellow'>ser_credentials</font>, lệnh SQL sau sẽ lấy dữ liệu từ cả hai bảng:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SELECT dish_name FROM cooking_recipe UNION SELECT username, password FROM user_credentials;</pre>
</div><br/><br/> Một câu lệnh SQL tương tự là <font color='yellow'>UNION ALL</font>, hoạt động gần giống như UNION. Sự khác biệt duy nhất là UNION ALL sẽ không loại bỏ các dòng bị trùng lặp trong kết quả trả về.<br/><br/> <font color='orange'><b>3.7.2.2. Nhiều truy vấn trong một lời gọi</b></font><br/><br/> Nếu SQL engine cho phép nhiều câu lệnh SQL trong một truy vấn SQL đơn, ta sẽ thấy nguy cơ bảo mật xuất hiện. Ví dụ sau có thể giải thích nguy cơ này.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SELECT * FROM products WHERE id = %d;</pre>
</div><br/><br/> Nếu hacker cung cấp ID bằng một đoạn lệnh <font color='yellow'>1;DROP TABLE products;</font> câu lệnh SQL sẽ trở thành:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SELECT * FROM products WHERE id = 1; DROP TABLE products;</pre>
</div><br/><br/> Khi câu lệnh này được thực hiện, đầu tiên nó sẽ truy vấn tất cả các trường trong bảng products có id bằng 1, sau đó bảng products sẽ bị xoá.<br/><br/> <b><font color='orange'>3.7.2.3. Đọc nội dung của một file</font></b><br/><br/> MySQL có thể được sử dụng để đọc nội dung của một file trên hệ thống bằng cách sử dụng hàm LOAD_FILE(). Ví dụ:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SELECT LOAD_FILE&#40;“/etc/passwd”&#41;;</pre>
</div><br/><br/> Lệnh sẽ trả về nội dung của file /etc/passwd nếu tiến trình MySQL có quyền truy cập.<br/><br/> <font color='orange'><b>3.7.2.4. Ghi dữ liệu vào tập tin</b></font><br/><br/> MySQL cũng hỗ trợ lệnh ghi dữ liệu vào tập tin với <font color='yellow'>OUTFILE</font>. Rất nguy hiểm nếu hacker lợi dụng và khai thác được lệnh này, bởi thực thi OUTFILE không những ảnh hưởng đến cơ sở dữ liệu mà còn ảnh gây hưởng đến tập tin hệ thống.<br/><br/> Dưới đây là một ví dụ đơn giản sử dụng MySQL để ghi dữ liệu vào file text.txt<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SELECT "vi du ghi du lieu" INTO OUTFILE "test.txt";</pre>
</div><br/><br/> <font color='orange'><b>3.7.3. Ngăn chặn tấn công SQL injection</b></font><br/><br/> Có ba bước quan trọng để ngăn chặn tấn công SQL injection:<br/><br/> 1. Làm “trong sáng” câu lệnh SQL trong ứng dụng web.<br/> 2. Lọc dữ liệu người dùng đưa lên.<br/> 3. Sử dụng ModSecurity để chặn mã SQL injection khi hacker khai thác lỗi ứng dụng web.<br/><br/> Trong ba bước trên, quan trọng nhất vẫn là bước đầu tiên. Sử dụng các câu lệnh SQL “trong sáng” nghĩa là sử dụng các câu lệnh chuẩn, không không gây ra lỗ hổng SQL injection cho ứng dụng web.<br/> Bước thứ hai là đảm bảo tất cả dữ liệu người dùng cung cấp cho truy vấn SQL đểu được cản lọc, tránh bị chèn vào các đoạn mã nguy hiểm như dấu ngoặc đơn, dấu nháy đơn… Nếu ứng dụng web viết bằng PHP, có thể sử dụng các <font color='yellow'>mysql_real_escape_string()</font> để cản lọc.<br/><br/> Và cuối cùng, sử dụng ModSecurity để ngăn chặn triệt để tấn công SQL injection.<br/><br/> Dưới đây là bảng liệt kê danh sách các lệnh thường được sử dụng trong tấn công SQL injection cùng với các biểu thức chính quy dùng để ngăn chặn.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/6.jpg' border="0" /></div><br/> Bảng 3.3 Các lệnh thường được sử dụng trong tấn công SQL injection<br/><br/> Ví dụ về rule để chặn tấn công SQL injection ghi dữ liệu vào tập tin.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS "into\s+outfile" "t:lowercase,deny,msg:'SQL Injection'"</pre>
</div><br/><br/> Cú pháp <font color='yellow'>\s+</font> cho phép phát hiện tất các hình thức nhập vào của ký tự trắng (space) ví dụ như <font color='yellow'>INTO%20%20OUTFILE</font>.<br/><br/> <font size='+1'><b><font color='orange'>3.8. TẤN CÔNG BRUTE FORCE</font></b></font><br/><br/> Với tấn công Brute Force, hacker thực hiện đoán các thông tin đăng nhập như tên người dùng, mật khẩu, email… và thực hiện đăng nhập liên tục đến khi nào thông tin đăng nhập là đúng. Hầu hết người dùng đều sử dụng thông tin đăng nhập giống nhau trên tất cả các website mà họ thường đăng nhập, dẫn đến tài khoản của họ bị xâm nhập trên hàng loạt các website khi thông tin đăng nhập bị lộ bởi một website khác.<br/><br/> Cách tốt nhất để ngăn chặn hình thức tấn công này là giới hạn số lần đăng nhập không đúng. Ví dụ nếu người sử dụng đăng nhập không đúng quá 3 lần, thực hiện khoá đăng nhập của người này trong 5 phút.<br/><br/> Dưới đây là các rule của ModSecurity cho phép chúng ta thực hiện điều này<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Khoa dang nhap sau 3 lan dang nhap khong thanh cong
#
&lt;LocationMatch ^/login&gt;
# Khoi tao collection ip
SecAction "initcol:ip=%{REMOTE_ADDR},pass,nolog"
# Phat hien dang nhap khong thanh cong
SecRule RESPONSE_BODY "Username does not exist" "phase:4,pass,setvar:
ip.failed_logins=+1,expirevar:ip.failed_logins=300"
# Khoa dang nhap khi so lan dang nhap khong thanh cong bang 3
SecRule IP:FAILED_LOGINS "@gt 3" deny
&lt;/Location&gt;</pre>
</div><br/><br/> Các rule trên dựa vào đặt điểm trả về của website khi người truy cập đăng nhập không thành công: <font color='yellow'>Username does not exist</font><br/><br/> Các rule trên sẽ khởi tạo collection IP và tăng giá trị biến <font color='yellow'>ip.failed_login</font> lên một đơn vị sau mỗi lần đăng nhập không thành công. Action <font color='yellow'>expirevar</font> sẽ thiết lập biến ip.failed_login về 0 sau 5 phút. Vì vậy, khi biến <font color='yellow'>ip.failed</font> lớn hơn hoặc bằng 3, rule cuối sẽ khoá đăng nhập của người dùng trong 5 phút.<br/><br/> Hoặc chúng ta có thể thực hiện trì hoãn (hay dừng) request của người dùng khi số lần đăng nhập sai vượt quá quy định. Do đó, không cần phải từ chối truy cập như các rule được nêu ở trên. Sau đây là rule thực hiện điều trên:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># tri hoan request 3 giay sau 3 lan dang nhap khong thanh cong
&lt;LocationMatch ^/login&gt;
SecAction "initcol:ip=%{REMOTE_ADDR},pass,nolog"
SecRule RESPONSE_BODY "Username does not exist" "phase:4,pass,setvar:
ip.failed_logins=+1,expirevar:ip.failed_logins=10"
SecRule IP:FAILED_LOGINS "@gt 3" "phase:4,allow,pause:3000"
&lt;/Location&gt;</pre>
</div><br/><br/> Thời gian trì hoãn được tính bằng mili giây, các rule trên sẽ trì hoãn response trong 3 giây khi số lần truy cập không thành công lớn hơn hoặc bằng 3.<br/><br/> <font size='+1'><b><font color='orange'>3.9. DIRECTORY INDEXING</font></b></font><br/><br/> Khi người sử dụng request đến URL như<span class="link"> http://example.com,</span> URL này không request cụ thể đến một tập tin nào trên web server (ví dụ<span class="link"> http://example.com/page.html</span> request cụ thể đến <font color='yellow'>page.html</font>), vì vậy Apache sẽ tìm đọc tập tin theo cấu hình DirectoryIndex (thường là index.html, index.php …). Nếu không có tập tin nào có trong danh sách tập tin đã được cấu hình trong DirectoryIndex., Apache xem xét tuỳ chọn Indexes có được kích hoạt hay không. Tuỳ chọn này có thể được kích hoạt theo cách sau<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;Directory /home/www/rangdong1&gt;
Options +Indexes
&lt;/Directory&gt;</pre>
</div><br/><br/> Nếu cấu hình tuỳ chọn Indexes cũng không được tìm thấy hoặc không kích hoạt. Apache sẽ liệt kê ra tất cả các thư mục và tập tin hiển thị cho người dùng.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/7.jpg' border="0" /></div><br/> Hình 3.4 Liệt kê thư mục và tập tin với Indexes<br/><br/> Với việc liệt kê ra danh sách các thư mục, tập tin sẽ làm cho người dùng có thể xem được cấu trúc của mã nguồn website, có thể tải về các tập tin không được phép…Vì vậy, chúng ta có thể tắt indexes bằng cách khai báo trong httpd.conf:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;Directory /home/www&gt;
Options -Indexes
&lt;/Directory&gt;</pre>
</div><br/><br/> Hoặc cũng có thể tắt indexes bằng cách cấu hình không cho chạy module mod_autoindex.so<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Disable directory indexing
# LoadModule autoindex_module modules/mod_autoindex.so</pre>
</div><br/><br/> Lưu ý: Một số module của Apache yêu cầu mod_autoindex.so hoạt động, vì vây nếu tắt module này có thể dẫn đến Apache không khởi động được.<br/><br/> Để đảm bảo chắc chắc rằng người dùng không thể liệt kê được các file và thư mục. Chúng ta có thể sử dụng ModSecurity với rule:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_URI "/$" "phase:4,deny,chain,log, msg:'Directory index returned'"
SecRule RESPONSE_BODY "&lt;h1&gt;Index of /"</pre>
</div><br/><br/> Khi người dùng thực hiện liệt kê file, thư mục. Apache sẽ trả về response body có chứa <font color='yellow'>&lt;h1&gt;Index of /</font>, vì vậy rule trên sẽ chặn lại và ghi log với nội dung Directory index returned<br/><br/> <b>Kết thúc chủ đề <font color='orange'>Bào mật web server Apache với ModSecurity</font></b><br/><br/> Cảm ơn đã quan tâm theo dõi.. :D</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38694.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38694/237061.html#237061,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">----------------------------------------------------------------------------------<br/> Phần 1:<span class="link"> /hvaonline/posts/list/38687.html</span><br/> Phần 2:<span class="link"> /hvaonline/posts/list/38690.html</span><br/> ----------------------------------------------------------------------------------<br/><br/> <font size='+2'><font color='orange'><b>PHẦN 3. NGĂN CHẶN MỘT SỐ HÌNH THỨC TẤN CÔNG THƯỜNG GẶP VỚI MODSECURITY</b></font></font><br/><br/> Chương này sẽ trình bày một số hình thức tấn công phổ biến nhất vào web application và web server. Tiếp theo là ngăn chặn các hình thức tấn công đó với ModSecurity. Để thực hiện ngăn chặn được, đầu tiên chúng ta phải hiểu rõ đặc điểm của các hình thức tấn công này.<br/><br/> Web application có thể bị tấn công từ nhiều góc độ khác nhau, vì vậy việc ngăn chặn các cuộc tấn công dưới phương diện web application không hề dễ dàng.<br/><br/> Đối với web server, việc phục vụ các request cũng rất dễ bị khai thác, ngay trong cả web server Apache – một trình web server được đánh giá là bảo mật. Ban đầu, web server chỉ phục vụ yêu cầu các trang HTML. Theo thời gian, các ngôn ngữ khác ra đời như JavaScript, PHP… đi kèm theo các nguy cơ bảo mật. Chẳng hạn như mod_php được sử dụng để chạy các script PHP, có thể bị lỗ hổng bảo mật ở chính ngôn ngữ PHP.<br/><br/> <font size='+1'><b><font color='orange'>3.1. HTTP FINGERPRINTING </font></b></font><br/><br/> Chỉ có những hacker nghiệp dư mới thực hiện tấn công một server mà không biết server đó có hoạt động hay không. Phức tạp hơn, hacker sẽ thu thập càng nhiều thông tin càng tốt về kiến trúc mạng và phần mềm đang chạy trên server. Cụ thể với web server, phương thức tìm kiếm thông tin này gọi là <font color='yellow'>HTTP Fingerprinting</font> (dấu vân tay HTTP).<br/><br/> HTTP Fingerprinting hoạt động bằng cách kiểm tra các đặc tính riêng của web server bằng các response khi được thăm dò và lấy “dấu vân tay” của server từ những thông tin thu thập được. Sau đó dấu vân tay này được so sánh với một cơ sở dữ liệu về “dấu vân tay” cho các web server được biết đến để xác định tên web server và phiên bản mà nó đang chạy.<br/><br/> Trong bài viết này sử dụng công cụ HTTP Fingerprinting là httprecon. Phiên bản đầu tiên của phần mềm này được phát hành vào năm 2007. Chạy trên hệ điều hành Windows.<br/><br/> Thực hiện thăm dò một server đang chạy Apache 2.2.3 với httprecon, ta thấy kết quả trả về chính xác.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/1.jpg' border="0" /></div><br/> Hình 3.1 Phần mềm httprecon<br/><br/> <font color='orange'><b>3.1.1. Cách thức HTTP Fingerprinting hoạt động</b></font><br/><br/> Có nhiều cách để các phần mềm HTTP Fingerprinting có thể phát hiện phiên bản của web server đang chạy trên hệ thống. Chúng ta sẽ xem xét một số phương pháp phổ biến sau:<br/><br/> <font color='orange'><b>3.1.1.1. Server banner</b></font><br/><br/> Server banner là một chuỗi được trả về bởi server trong response header (ví dụ: <font color='yellow'>Apache/1.3.3(Unix) (Red Hat/ Linux)</font>) mang thông tin của phần mềm chạy web server cũng như hệ điều hành của web server đó.<br/><br/> Giả sử một hacker muốn tấn công web server của chúng ta, bước đầu tiên của hacker sẽ là gì? Câu trả lời là tìm hiểu hệ điều hành và phần mềm web server đang chạy trên hệ điều hành đó. Vì vậy, ta có thể tạo ra các thông tin “giả” về web server để cho hacker tự do thăm dò..<br/><br/> Để thay đổi được server banner là điều rất khó. Apache không cung cấp lệnh để thay đổi thông tin về về server banner (trừ khi chúng ta thay đổi mã nguồn và biên dịch Apache ngay từ đầu).<br/><br/> Đề thay đổi, chúng ta phải sử dụng ModSecurity. Khi sử dụng ModSecurity, chúng ta có thể thay đổi hoàn toàn thông tin về máy chủ. Ví dụ như Apache 2.2 thành <font color='yellow'>Microsoft-IIS/5.0</font>. Tuy nhiên, để thú vị hơn thì chúng ta nên thay đổi nó thành thông tin của một máy chủ phiên bản cũ có nhiều lỗi bảo mật.<br/><br/> Đầu tiên, chúng ta cần phải “nói” cho Apache để Apache gởi thông tin đầy đủ phiên bản của máy chủ trong response header. Sau đó ModSecurity có thể nhận ra và thay đổi thiết lập.<br/><br/> Đơn giản là trong httpd.conf, thêm vào dòng.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Goi full server signature de ModSecurity co the thay doi no
ServerTokens Full</pre>
</div><br/><br/> Sau đó, thêm dòng sau vào file cấu hình của ModSecurity (ở đây đặt là modsecurity.conf). Khởi động lại apache khi hoàn thành.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Thay doi web server signature goi boi Apache
SecServerSignature "Apache 1.3.24"</pre>
</div><br/><br/> Apache 1.3.24 là phiên bản củ của Apache với rất nhiều lỗ hổng bảo mật. Thấy vậy các hacker rất thích thú và bỏ rất nhiều thời gian và công sức để khai thác các lỗ hổng bảo mật của phiên bản này.. Hy vọng sẽ làm nản chí các đối tượng muốn khai thác hệ thống của chúng ta (nhưng đối với các hacker kinh nghiệm, sẽ có các biện pháp để phát hiện phiên bản thật của máy chủ web).<br/> Bây giờ, chúng ta kiểm tra kết quả của các bước trước đã cấu hình.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/2.jpg' border="0" /></div><br/> Hình 3.2 Kết quả thay đổi server banner với ModSecurity<br/><br/> <b><font color='orange'>3.1.1.2. Các response của giao thức HTTP</font></b><br/><br/> Để lấy được thông tin web server, có thể sử dụng các request phi tiêu chuẩn (non-standard) hoặc request bất thường để web server gởi về các response kèm theo thông tin về server cần thu thập.<br/> Các request có thể sử dụng để lấy thông tin từ web server:<br/><br/> <font color='orange'><i><b>Request HTTP DELETE không hợp lệ</b></i></font><br/><br/> Như phần 2.3.2 của chương 2 đã trình bày, <font color='yellow'>HTTP DELETE</font> dùng để xoá dữ liệu từ web server. Lệnh này chủ yếu được thực hiện với người dùng đã được chứng thực. Vì vậy đối với người dùng chưa được chứng thực, thông báo lỗi sẽ được trả về. Trong thông báo lỗi có thể có các thông tin về web server.<br/><br/> Ví dụ ở đây sử dụng Netcat để gởi request DELETE đến web server Apache:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>c:\nc&gt;nc ptnd.com 80
DELETE /HTTP/1.0
............
&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;405 Method Not Allowed&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Method Not Allowed&lt;/h1&gt;
&lt;p&gt;The requested method GET is not allowed for the URL /HTTP/1.0.&lt;/p&gt;
&lt;p&gt;Additionally, a 404 Not Found
error was encountered while trying to use an ErrorDocument to handle the reques.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache 1.3.24 PHP/5.1.6 mod_python/3.2.8 Python/2.4.3 mod_perl/2.0.4 Prl/v5.8.8 Server at ptnd.com Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;</pre>
</div><br/><br/> Kết quả trả về lỗi 405 Method Not Allowed. Lỗi trên cho thấy phương thức request DELETE không cho phép request các URL /index.html. Thông báo lỗi này kèm theo thông tin về máy chủ Apache 1.3.24 PHP/5.1.6 mod_python/3.2.8 Python/2.4.3 mod_perl/2.0.4 Prl/v5.8.8.<br/><br/> <i><font color='orange'><b>Request sai phiên bản HTTP</b></font></i><br/><br/> Thực hiện ví dụ tương tự như phần trên bằng cách gởi request GET đế web server với thông số phiên bản của giao thức HTTP không đúng.<br/><br/> Dưới đây là kết quả thực hiện GET với phiên bản HTTP là 5.0<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>c:\nc&gt;nc ptnd.com 80
GET /HTTP/5.0
...........
&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /HTTP/5.0 was not found on this server.&lt;/p&gt;
&lt;p&gt;Additionally, a 404 Not Found
error was encountered while trying to use an ErrorDocument to handle the request
.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache 1.3.24 PHP/5.1.6 mod_python/3.2.8 Python/2.4.3 mod_perl/2.0.4 Perl/v5.8.8 Server at ptnd.com Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;</pre>
</div><br/><br/> <font color='orange'><i><b>Request sai giao thức</b></i></font><br/><br/> Ví dụ dưới đây thực hiện GET với tên giao thức không phải là HTTP mà là VIETHANIT. Kết quả báo lỗi tương tự.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>c:\nc&gt;nc ptnd.com 80
GET /VIETHANIT/1.0
..........
&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL /VIETHANIT/1.0 was not found on this server.&lt;/p&gt;
&lt;p&gt;Additionally, a 404 Not Found
error was encountered while trying to use an ErrorDocument to handle the request
.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache 1.3.24 PHP/5.1.6 mod_python/3.2.8 Python/2.4.3 mod_perl/2.0.4 Perl/v5.8.8 Server at ptnd.com Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;</pre>
</div><br/><br/> <b><i><font color='orange'>Giới thiệu về ETag HTTP header</font></i></b><br/><br/> Chúng ta có thể quen thuộc với thông số<font color='yellow'> HTTP Last-Modified</font> trong response header. Thông số này cho phép trình duyệt xác định có tải về nội dung web hay sử dụng bộ nhớ cache để hiển thị cho người dùng (chẳng hạn như các file hình ảnh..) để tránh tải về các nội dung không thay đổi kể từ lần truy cập cuối. Các Etag header (viết tắt của "Entity Tag") hoạt động theo cách tương tự, nhưng sử dụng thêm thông tin về tập tin là số inode (inode là số đại điện cho mỗi tập tin trong hệ thống tập tin Unix, số này chỉ thay đổi khi tập tin mà nó đại điện thay đổi thuộc tính như người sở hữu, kiểu tệp, quyền truy cập…).<br/><br/> Etag header cũng được các phần mềm Fingerprinting dùng để xác định cấu hình web server. Ngoài ra, nếu sử dụng Etags có thể làm giảm hiệu suất hoạt động của web server.<br/><br/> Ví dụ: Nếu chúng ta đang chạy nhiều web server để cân bằng tải và cấu hình Apache cho phép response Etag (mặc định Apache cho phép), các web server khác nhau sẽ trả về giá trị ETag khác nhau ngay cả khi thuộc tính của tập tin không thay đổi (do số inode trên các server khác nhau sẽ khác nhau). Điều này sẽ làm cho trình duyệt tải về các nội dung không cần thiết ngay cả khi thuộc tính của tập tin không thay đổi từ lần truy cập trước.<br/><br/> Vô hiệu hoá ETag trong response của Apache sẽ có lợi cho hiệu năng của web server và làm cho HTTP Fingerprinting khó khăn hơn trong việc thăm dò. Để vô hiệu hoá ETag, trong file cấu hình httpd.conf thực hiện thêm vào dòng.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Header unset ETag</pre>
</div><br/><br/> Lưu ý: Nếu web server đang chạy <font color='yellow'>WebDAV </font>với mod_dav_fs, chúng ta không nên vô hiệu hoá ETag vì mod_dav_fs sử dụng nó để xác định các tập tin đã thay đổi.<br/><br/> <b><font color='orange'>3.1.2. Sử dụng ModSecurity để ngăn chặn HTTP Fingerprinting</font></b><br/><br/> Chúng ta sẽ cung cấp đầy đủ các thông tin cho hacker tìm hiểu, nhưng không phải là thông tin chính xác. ModSecurity cho phép chúng ta tuỳ chỉnh và đánh lừa các công cụ HTTP Fingerprinting. Ví dụ cụ thể:<br/><br/> - Chỉ cho phép các phương thức GET, HEAD, và POST<br/> - Chặn tất cả các request với các giao thức ngoại trừ giao thức HTTP 1.0 và 1.1<br/> - Chặn các request không chứa Host header<br/> - Chặn tất cả các request không chứa Accept header<br/> - Đặt chữ ký là Microsoft-IIS/6.0<br/> - Thêm X-Powered-By: ASP.NET 2.0 header<br/> - Gỡ bỏ Etag header<br/><br/> Dưới đây là các rule để thực hiện<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Thay doi chu ky server
SecServerSignature "Microsoft-IIS/6.0"
# Tu choi cac request khong chua host header
SecRule &REQUEST_HEADERS:Host "@eq 0" "phase:1,deny"
# Tu choi cac request khong chua request header
SecRule &REQUEST_HEADERS:Accept "@eq 0" "phase:1,deny"
# Chi cho phep GET HEAD va POST
SecRule REQUEST_METHOD !^&#40;get|head|post&#41;$ "phase:1,t:lowerCase,deny"
# Chi cho phep HTTP phien ban 1.0 va 1.1
SecRule REQUEST_PROTOCOL !^http/1\.&#40;0|1&#41;$ "phase:1,t:lowercase,deny"
# Them X-Powered-By header
Header set X-Powered-By "ASP.NET 2.0"
# Go bo ETag header
Header unset ETag</pre>
</div><br/><br/> Và đây là kết quả của phần mèm Acunetix khi thực hiện scan:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/3.jpg' border="0" /></div><br/> Hình 3.3 Kết quả dùng Acunetix khi scan<br/><br/> <font size='+1'><font color='orange'><b>3.2. NGĂN CHẶN CÁC REQUEST TỪ PROXY SERVER</b></font></font><br/><br/> Các request từ proxy server thường không tốt đối với một số website. Ví dụ nếu chúng ta đang chạy một diễn đàn thảo luận VBB hoặc PHPBB… Hacker thường sử dụng các proxy làm trung gian để ẩn dấu vết của mình và thực hiện các hành động như spam các bài viết lên diễn đàn, thực hiện các cuộc tấn công từ chối dịch vụ Ddos.. Do đó, chúng ta có thể chặn những người truy cập từ các proxy này.<br/><br/> Đặc điểm nhận dạng của các proxy khi request vào web server là có sự hiện diện của chuỗi X-Forwarded-For trong request header, chúng ta có thể dựa vào đặc điểm này để viết rule ngăn chặn.<br/> Rule được viết như sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule &REQUEST_HEADERS:X-Forwarded-For "@gt 0" deny</pre>
</div><br/><br/> Lưu ý: Phải xem xét kỹ lưỡng trước khi quyết định chặn các proxy truy cập vào server. Bởi không phải tất cả website đều không nên cho proxy server truy cập vào.<br/><br/> <font color='orange'><b><font size='+1'>3.3. CROSS-SITE SCRIPTING</font></b></font><br/> <b><font color='orange'>3.3.1. Định nghĩa</font></b><br/><br/> Cross-Site Scripting hay còn được gọi tắt là XSS (thay vì gọi tắt là CSS để tránh nhầm lẫn với CSS-Cascading Style Sheet của HTML) là một kĩ thuật tấn công bằng cách chèn vào các website động (ASP, PHP, CGI, JSP ...) những thẻ HTML hay những đoạn mã script nguy hiểm có thể gây nguy hại cho những người sử dụng khác. Trong đó, những đoạn mã nguy hiểm được chèn vào hầu hết được viết bằng các Client-Site Script như JavaScript, JScript, DHTML và cũng có thể là cả các thẻ HTML.<br/> Kĩ thuật tấn công XSS đã nhanh chóng trở thành một trong những lỗi phổ biến nhất của Web Applications và mối đe doạ của chúng đối với người sử dụng ngày càng lớn.<br/><br/> <font color='orange'><b>4.3.2. Hoạt động của XSS</b></font><br/><br/> Về cơ bản XSS cũng như SQL Injection hay Source Injection (sẽ được giới thiệu ở phần sau), nó cũng là các request được gửi từ các máy client tới server nhằm chèn vào đó các thông tin vượt quá tầm kiểm soát của server. Nó có thể là một request được gửi từ các form dữ liệu hoặc cũng có nằm trong request URI, ví dụ:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>http://www.example.com/search.cgi?query=&lt;script&gt;alert&#40;'XSS was found !'&#41;;&lt;/script&gt;</pre>
</div><br/><br/> Nếu truy cập vào địa chỉ trên, rất có thể trình duyệt sẽ hiện lên một thông báo <font color='yellow'>XSS was found !</font>. Các đoạn mã trong thẻ &lt;script&gt; không hề bị giới hạn bởi chúng hoàn toàn có thể thay thế bằng một file nguồn trên một server khác thông qua thuộc tính src của thẻ &lt;script&gt;. Cũng chính vì lẽ đó mà chúng ta chưa thể lường hết được độ nguy hiểm của các lỗi XSS.<br/><br/> Nhưng nếu như các kĩ thuật tấn công khác có thể làm thay đổi được dữ liệu nguồn của web server (mã nguồn, cấu trúc, cơ sở dữ liệu) thì XSS chỉ gây tổn hại đối với website ở phía client mà nạn nhân trực tiếp là những người khách duyệt site đó. Tất nhiên đôi khi các hacker cũng sử dụng kĩ thuật này đề chiếm quyền điều khiển các website nhưng đó vẫn chỉ tấn công vào bề mặt của website. Thật vậy, XSS là những Client-Side Script, những đoạn mã này sẽ chỉ chạy bởi trình duyệt phía client do đó XSS không làm ảnh hưởng đến hệ thống website nằm trên server.<br/><br/> Mục tiêu tấn công của XSS không ai khác chính là những người sử dụng khác của website, khi họ vô tình vào các trang có chứa các đoạn mã nguy hiểm do các hacker để lại, họ có thể bị chuyển tới các website khác, đặt lại homepage, hay nặng hơn là mất mật khẩu, mất cookie thậm chí máy tính người truy cập có thể sẽ bị cài các loại virus, backdoor, worm ..<br/><br/> <font color='orange'><b>3.3.3. Ngăn chặn tấn công XSS</b></font><br/><br/> Đề ngăn chặn tấn công XSS, chúng ta phải đảm bảo tất cả dữ liệu mà người dùng gởi lên đều được cản lọc. Cụ thể, chúng ta có thể thay thế hoặc loại bỏ các ký tự, các chuỗi thường được dùng trong tấn công XSS như đấu ngoặc góc (&lt; và &gt;), script...<br/> Dưới đây là danh sách các ký tự nên mã hoá khi được client cung cấp để lưu vào cơ sở dữ liệu.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/8.jpg' border="0" /></div><br/> Bảng 3.1 Các ký tự nên mã hoá để ngăn chặn tấn công XSS<br/><br/> Nếu chúng ta muốn ngăn chặn tấn công với ModSecurity, dưới đây là các đoạn script XSS phổ biến và các biểu thức chính quy để ngăn chặn người dùng request chứa các chuỗi này.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/9.jpg' border="0" /></div><br/> Bảng 3.2 Các script XSS và biểu thức chính quy<br/><br/> Dưới đây là ví dụ về một rule dùng để chặn XSS đã được trình bày ở phần 2.4.5<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS "&lt;script" "deny,t:lowercase"</pre>
</div><br/><br/> <font color='orange'><b><font size='+1'>3.4. TẤN CÔNG THỰC THI CÁC LỆNH SHELL</font></b></font><br/><br/> Như chúng ta đã biết, chấp nhận dữ liệu đầu vào từ client mà không cản lọc có thể gây ra nguy hiểm cho ứng dụng web. Cụ thể của việc này là người dùng gởi các request trái phép đến server để hiển thị hoặc thực thi một tập tin nào đó mà người dùng không có quyền.<br/><br/> Hacker thường kết hợp nhiều yếu tố để đạt được hiệu quả tối đa. Các ứng dụng web rất ít sử dụng các lệnh shell bởi nó thực hiện gọi <font color='yellow'>exec()</font> đến hệ thống. Tuy nhiên, chúng ta hãy xem xét quy trình sau đây:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/4.jpg' border="0" /></div><br/><br/> Quy trình trên là sự kết hợp giữa khai thác lỗi SQL injection để tạo ra các file PHP với việc thực thi các lệnh shell. Nếu việc cản lọc dữ liệu đầu vào của web server không thành công, hacker sẽ thực thi scripts thucthi.php và toàn bộ dữ liệu trên thư mục gốc của web server sẽ bị xoá.<br/><br/> Điều này cho thấy, cản lọc thực thi các lệnh shell là công việc hết sức cần thiết đối với người làm bảo mật web server.<br/> Dưới đây là một số lệnh, tên chương trình và đường dẫn thông thường của hệ thống Unix có thể chặn để tránh tấn công thực thi lệnh shell:<br/><br/> - rm<br/> - ls<br/> - kill<br/> - mail<br/> - sendmail<br/> - cat<br/> - echo<br/> - /bin/<br/> - /etc/<br/> - /tmp/<br/><br/> Để chặn các request với đối số là các chuỗi trên, ta có rule sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS “rm|ls|kill&#40;send&#41;?mail|cat|echo|/bin/|/etc/|/tmp/&#41;” “deny”</pre>
</div><br/><br/> <b><font size='+1'><font color='orange'>3.5. TẤN CÔNG NULL BYTE</font></font></b><br/><br/> Kiểu tấn công null byte (byte rỗng) thực sự bắt nguồn từ ngôn ngữ lập trình C (và các ngôn ngữ liên quan), sử dụng một byte rỗng (0x00) để biểu thị kết thúc một chuỗi. Ví dụ về cách lưu trữ chuỗi viethanit trong bộ nhớ của ngôn ngữ C:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan3/5.jpg' border="0" /></div><br/><br/> Với các ngôn ngữ lập trình khác như Java, các chuỗi được lưu trữ trong mảng, và giá trị tổng chiều dài của chuỗi (total length) được lưu trữ ở một vị trí riêng biệt. Vì vậy hoàn toàn có thể lưu trữ được các byte rỗng ở giữa chuỗi.<br/> Lợi dụng sự khác biệt trong việc lưu trữ và xử lý chuỗi giữa các ngôn ngữ lập trình, hacker có thể thực hiện tấn công khai thác lỗi null byte bằng cách đánh lừa các phần của hệ thống để phần này nghĩ rằng chuỗi đã kết thúc (vì gặp byte rỗng) và phần kia của hệ thống lại nghĩ rằng chuỗi được nhập đầy đủ.<br/><br/> Xét trang JSP đơn giản được viết để hiển thị nội dung tập tin văn bản cho client truy cập bằng cách sử dụng tên tập tin làm tham số:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&gt;&lt;%
String filename = request.getParameter&#40;"file"&#41;;
if &#40;filename.endsWith&#40;".txt"&#41;&#41; {
// Include text file in output page
}
%&gt;</pre>
</div><br/><br/> Với ví dụ trên, website sẽ đảm bảo tên tập tin yêu cầu hiển thị cho người truy cập phải có phần mở rộng là .txt . Tuy nhiên, nếu hacker sử dụng hình thức tấn công là null byte, hacker sẽ nhập vào đối số tên tập tin là<font color='yellow'> /etc/passwd%00.txt</font> .<br/><br/> Mặt khác, Java lại có khả năng chứa các byte rỗng trong chuỗi, vì vậy yêu cập hiển thị nội dung tập tin trên là hợp lệ và sẽ vượt qua được hàm kiểm tra <font color='yellow'>filename.endsWith(".txt").</font> Khi yêu cầu hiển thị tập tin được chuyển vào cho hệ thống, chức năng mở tập tin sẽ hoạt động. Một vấn đề phát sinh nếu chức năng đọc tên tập tin của hệ thống dừng khi gặp byte rỗng, hệ điều hành sẽ không mở tập tin <font color='yellow'>/etc/passwd%00.txt</font> mà thay vào đó sẽ mở tập tin <font color='yellow'>/etc/passwd </font>(tập tin hệ thống chứa thông tin về người dùng của các hệ thống Unix). Và nội dung của tập tin này sẽ được hiển thị trên trình duyệt của hacker.<br/><br/> ModSecurity có hai chức năng chuyển đổi đề đối phó với các byte rỗng được gởi lên từ người truy cập đó là <font color='yellow'>replaceNulls </font>và <font color='yellow'>removeNulls</font>. Với replaceNulls, khi thực thi sẽ thay thế byte rỗng bằng khoảng trắng, trong khi đó removeNulls lại thực hiện loại bỏ hoàn toàn byte rỗng. Byte rỗng rất hiếm khi cần thiết cho dữ liệu nhập vào của website, vì vậy có thể thiết lập chuyển đổi byte rỗng trong <font color='yellow'>SecDefaultAction</font>:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecDefaultAction "phase:2,deny,log,status:403,t:removeNulls"</pre>
</div><br/><br/> Rule trên từ chối các request boby có chứa byte rỗng. Nếu chúng ta muốn cho phép các request này, thực hiện dùng chức năng chuyển đổi để gỡ bỏ hoặc thay thế byte rỗng với rule:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS:data "pass,t:-removeNulls"</pre>
</div><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38690.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38690/237044.html#237044,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><font size='+1'><b><font color='orange'>2.4.2. Giới thiệu về biểu thức chính quy – Regular expressions</font></b></font><br/> <font color='orange'><b>2.4.2.1. Ví dụ về các biểu thức chính quy</b><br/> </font><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/3.jpg' border="0" /></div><br/> Bảng 2.1 Các biểu thức chính quy<br/><br/> Trong trường hợp muốn cả từ <font color='yellow'>favorite</font> và <font color='yellow'>favourite</font> đều đúng thì có thể dùng dấu chấm hỏi <font color='yellow'>?</font>để quy định có thể có hoặc có thể không ký tự <font color='yellow'>u</font>. Cú pháp sẽ là <font color='yellow'>favou?rite</font><br/><br/> Trường hợp trên đối với một ký tự u, nếu có nhiều hơn một ký tự chúng ta có thể nhóm lại bởi hai dấu ngoặc đơn (). Ví dụ với hai từ<font color='yellow'> previous</font> và <font color='yellow'>previously</font>. Cú pháp sẽ là <font color='yellow'>previous(ly)?</font><br/><br/> <font color='orange'><b>2.4.2.2. Các biểu thức chính quy khác</b></font><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/4.jpg' border="0" /></div><br/> Bảng 2.2 Các biểu thức chính quy khác<br/><br/> Vd:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REMOTE_USER "@within tim,john,alice"</pre>
</div><br/><br/> <font color='orange'><b>2.4.2.3. Sử dụng @ rx để chặn một server từ xa </b></font><br/><br/> Ví dụ chúng ta có 2 rule như sau<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Rule 1
SecRule REMOTE_HOST "@rx \.microsoft\.com$" deny
# Rule 2
SecRule REMOTE_HOST "\.microsoft\.com$" deny</pre>
</div><br/><br/> Cả hai rule đề có tác dụng như sau là chặn các host truy cập từ xa từ tập đoàn Microsoft. Mục tiêu của <font color='yellow'>@rx</font> mà bỏ qua rule thứ hai bởi hai rule đều có mục đích như nhau.<br/><br/> <font color='orange'><b>2.4.3. So sánh số (matching number)</b></font><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/5.jpg' border="0" /></div><br/> Bảng 2.3 So sánh số<br/><br/> <font color='orange'><b>2.4.4. Phases và sắp xếp rule</b></font><br/><br/> Điều quan trọng là hiểu được việc sắp xếp rule của ModSecurity. Điều này tránh các tình huống mà mọi phương thức, hoạt động đều bất ngờ bị chặn(deny) hoặc cho phép (allow) trái với ý định.<br/><br/> Có 5 giai đoạn (phase)<br/><br/> 1. REQUEST_HEADERS (phase 1)<br/> 2. REQUEST_BODY (phase 2)<br/> 3. RESPONSE_HEADERS (phase 3)<br/> 4. RESPONSE_BODY (phase 4)<br/> 5. LOGGING (phase 5)<br/><br/> Một rule được thực hiện đúng từng phase theo thứ tự . Điều này có nghĩa là ModSecurity duyệt tất cả các rule trong phase 1 ("REQUEST_HEADERS"). Sau đó, đến phase 2…<br/><br/> Trong mỗi phase, rule được xử lý theo thứ tự mà chúng xuất hiện trong các tập tin cấu hình. Chúng ta có thể hiểu khi có action, ModSecurity sẽ duyệt các tập tin năm lần, một lần cho từng phase.<br/><br/> Trong thời gian xử lý ModSecurity chỉ xem xét rule thuộc pha hiện đang xử lý, và những rule được áp dụng theo thứ tự chúng xuất hiện trong các tập tin cấu hình.<br/><br/> Phase LOGGING đặc biệt ở chỗ nó luôn luôn được thực hiện cả khi request đã được cho phép hay từ chối trong các phase trước đó. Ngoài ra, một khi phase LOGGING bắt đầu, chúng ta không thể thực hiện bất kỳ action ngăn chặn nào vì response đã được gửi cho người truy cập.<br/><br/> Vì vậy, chúng ta phải cẩn thận không để cho bất kỳ action nào trái quy định được truyền vào rule ở phase 5. Nếu không sẽ gây lỗi làm Apache không khởi động được. Nếu chúng ta đặt rule sau đây trước các rule thuộc phase 5 sẽ ngăn chặn được lỗi này xảy ra. (nhưng phải đặt sau các rule của phase trước đó).<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecDefaultAction "phase:5,pass"</pre>
</div><br/><br/> <b><font color='orange'>2.4.5. Chức năng chuyển đổi</font></b><br/><br/> ModSecurity cung cấp một số chức năng chuyển đổi mà chúng ta có thể áp dụng cho các biến và các collection. Những biến đổi được thực hiện trên một bản sao của dữ liệu được kiểm tra, có nghĩa là các HTTP request hoặc response ban đầu vẫn được giữ nguyên, không thay đổi.<br/><br/> Chức năng này rất quan trọng. Nếu chúng ta muốn phát hiện tấn công XSS (cross-site scripting), chúng ta phải phát hiện mã JavaScript bất kể trường hợp nó được viết in hay viết thường. Để làm điều này, chức năng chuyển đổi có thể được áp dụng để so sánh một chuỗi viết hoa với chuỗi viết thường.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS "&lt;script" "deny,t:lowercase"</pre>
</div><br/><br/> Rule trên sẽ chặn tất cả các URL chứa chuỗi <font color='yellow'>&gt;</font>;<font color='yellow'>&lt;</font>;<font color='yellow'>script</font> bất kể chữ hoa thường, vd<font color='yellow'> sCript</font>; <font color='yellow'>&gt;</font>;<font color='yellow'>&lt;</font>;<font color='yellow'>scripT</font> ..<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/6.jpg' border="0" /></div><br/> Bảng 2.4 Một số chức năng chuyển đổi của ModSecurity<br/><br/> <font color='orange'>2.4.5.1. Thiết lập so sánh với @pm và @pmFromFile</font><br/><br/> Vd: thay vì sử dụng <font color='yellow'>red|blue|green</font> ta có thể sử dụng<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS "@pm red green blue" deny</pre>
</div><br/><br/> Nếu có quá nhiều chuỗi muốn đặt vào, ta có thể liệt kê các chuỗi này vào một file và dùng <font color='yellow'>@pmFromFile</font><br/><br/> Vd: Trong file /usr/log/alo.txt chứa nội dung <font color='yellow'>red green blue yellow magenta cyan orange maroon pink black white gray grey violet purple brown tan olive</font>. Ta có rule:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS “@pmFromFile /usr/log/alo.txt”</pre>
</div><br/><br/> <font color='orange'><b>2.4.6. Khoá một số request thông thường</b></font><br/><br/> Giả sử một website khai báo thuế của chính phủ muốn tăng độ bảo mật, website này chỉ mở cửa vào ban ngày (từ 8 giờ sáng đến 5 giờ chiều). Chúng ta có thể sử dụng biến TIME_HOUR cùng với biểu thức chính quy để thực hiện rule này.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule TIME_HOUR !^&#40;8|9|10|11|1213|14|15|16|17&#41;$ deny</pre>
</div><br/><br/> <font color='orange'><b>2.4.7. Khoá một số request không thông thường</b></font><br/><br/> Ba phương thức (method) HTTP thường được sử dụng cho request là GET, POST và HEAD. Chúng ta có thể ngạc nhiên khi biết rằng HTTP thực sự thực có rất nhiều phương thức, nếu một web server hỗ trợ WebDAV (Web-based Distributed Authoring và Versioning), tổng số method trở nên gần như 30.<br/><br/> Ví dụ, ở đây là những phương thức request thực hiện bởi phiên bản mới nhất của Apache:<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/7.jpg' border="0" /></div><br/> Bảng 2.5 Các phương thức request của Apache<br/><br/> Trừ khi chúng ta có một lý do nào đó để cho phép một số phương thức không phổ biến được vận hành. Các phương thức không phổ biến còn lại nên ngăn chặn để đề phòng các lỗ hổng trong Apache gây ra bở các phương thức này.<br/><br/> Ví dụ: về ngăn chặn tất cả phương thức request không thông thường, chỉ để lại <b>GET, POST, HEAD</b>.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_METHOD “!^&#40;GET|POST|HEAD&#41;” “deny,status:405”</pre>
</div><br/><br/> <font color='orange'><b>2.4.8. Phát hiện rò rỉ thẻ tín dụng</b></font><br/> <font color='orange'><b>2.4.8.1. Phát hiện rò rỉ thẻ tín dụng</b></font><br/><br/> Giả sử website bán hàng của chúng ta có chứa thông tin nhạy cảm của khách hàng như địa chỉ, số thẻ tín dụng… mà họ cung cấp khi mua hàng. Sẽ rất nguy hiểm nếu hacker có thể khai thác các lỗ hổng của website và xem được những thông tin này.<br/><br/> Cụ thể, một số lỗi như SQL injection, hacker có thể làm cho các thông tin này hiển thị trên website. Rất may mắn, ModSecurity có thể giải quyết vấn đề trên.<br/><br/> Ý tưởng là viết rule để kiểm tra HTTP response. ModSecurity có chứa một toán tử gọi là @verifiCC dùng để kiểm tra một chuỗi số có phải là số thẻ tín dụng hay không. Nếu toán tử trả về true, chúng ta có thể chặn các response không cho gởi đến hacker, bởi vì nó có thể chứa số thẻ tín dụng. Ví dụ một rule như sau<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecResponseBodyAccess On
SecRule RESPONSE_BODY "@verifyCC \d{13,16}" "phase:4,deny,t:removeWhitespace,log,msg:'Possible credit card number leak detected'"</pre>
</div><br/><br/> Chú thích: <font color='yellow'>{13,16}</font> nghĩa là kiểm tra các dãy số từ 13 đến 16 chữ số (số thẻ tín dụng từ 13 đến 16 số)<br/><br/> <font color='orange'><b>2.4.8.2. Thuật toán Luhn – Kiểm tra số thẻ tín dụng</b></font><br/><br/> ModSecurity sử dụng thuật toán Luhn để kiểm tra một dãy số liệu có phải là số thẻ tín dụng hay không<br/> Thuật toán này rất đơn giản. Chúng ta có một dãy số được xem xét có phải là số thẻ tín dụng hay không. Thực hiện đảo ngược dãy số, rồi lần lượt nhân số thứ nhất với 1, số thứ hai với 2, số thứ ba với 1, số thứ tư với 2…. Nhân đến khi hết dãy số. Sau đó tách các kết quả thu được thành các số riêng biệt có một chữ số. Rồi cộng các số này lại. Nếu kết quả đạt được chia hết cho 10 thì dãy số đó là số thẻ tín dụng.<br/> Để rõ hơn chúng ta xem một ví dụ. Xét số thẻ tín dụng <font color='yellow'>4012888888881881</font>. Thực hiện đảo ngược dãy số thành <font color='yellow'> 1 8 8 1 8 8 8 8 8 8 8 8 2 1 0 4</font><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/8.jpg' border="0" /></div><br/><br/> Kết quả đạt được là chuỗi <font color='yellow'>116828168168168162208</font>. Cộng từng chữ số lại ta được kết quả 90<br/> <font color='yellow'>1+1+6+8+2+8+1+6+8+1+6+8+1+6+8+1+6+2+2+0+8 = 90</font><br/><br/> Kết quả 90 chia hết cho 10, vì vậy dãy số <font color='yellow'>4012888888881881</font> là số thẻ tín dụng.<br/><br/> <font color='orange'><b>2.4.9. Theo dõi vị trí địa lý của khách truy cập</b></font><br/><br/> Một địa chỉ IP có thể cung cấp thông tin về địa điểm của người truy cập vào web server trên bản đồ thế giới. Với phiên bản 2.5, ModSecurity hỗ trợ kiểm tra vị trí địa lý của khách truy cập bằng cách tham chiếu đến một cơ sở dữ liệu địa lý (cụ thể là quốc gia).<br/><br/> Điều này rất hữu ích cho nhiều ứng dụng. Nếu như chúng ta xử lý thanh toán thẻ tín dụng và muốn vị trí người truy cập phải phù hợp với vị trí địa lý (các quốc gia) mà thẻ tín dụng đã được ban hành. Nếu một thẻ tín dụng Việt Nam đột nhiên được sử dụng tại Đài Loan, chúng ta có thể nghi ngờ và từ chối đơn đặt hàng này.<br/> ModSecurity sử dụng GEO collection để lưu trữ thông tin địa lý. Chúng ta hãy xem xét kỹ hơn collection này và các trường mà nó hỗ trợ.<br/><br/> <b><font color='orange'>2.4.9.1. Các trường trong collection GEO</font></b><br/><br/> - COUNTRY_CODE<br/> - COUNTRY_CODE3<br/> - COUNTRY_NAME<br/> - COUNTRY_CONTINEN<br/> - REGION<br/> - CITY<br/> - POSTAL_CODE<br/> - LATITUDE<br/> - LONGITUDE<br/> - DMA_CODE (US only)<br/> - AREA_CODE (US only)<br/><br/> Trường COUNTRY_CODE là mã quốc gia gồm hai chữ cái theo tiêu chuẩn ISO 3166. Ví dụ, mã quốc gia của Hoa Kỳ là US. COUNTRY_CODE3 chứa mã quốc gia ba ký tự, ví dụ Hoa Kỳ là USA. Trường COUNTRY_CONTINENT chứa châu lục, ví dụ như EU cho người sử dụng từ châu Âu và AS cho châu Á.<br/><br/> <b><font color='orange'>2.4.9.2. Cấm các người dùng từ các quốc gia được chỉ định</font></b><br/><br/> Đầu tiên, chúng ta cần download GEO database. Thực hiện theo các bước<br/> 1. Truy cập vào<span class="link"> http://www.maxmind.com</span> và click vào GeoLocation Technology.<br/> 2. Click vào GeoLite Country, với phiên bản miễn phí của database.<br/> 3. Copy link các phiên bản nhị phân (binary)của GeoLite database.<br/><br/> Sử dụng wget để download về,<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>wget <span class="link"> http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz</span>
gunzip GeoIP.dat.gz
mkdir /usr/local/geoip
mv GeoIP.dat /usr/local/geoip</pre>
</div><br/><br/> Ví dụ. Viết rule để chặn các khách truy cập từ Nga(RU) Pakistan(PK) và Trung Quốc(TQ)<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecGeoLookupDb "/usr/local/geoip/GeoIP.dat"
SecRule REMOTE_ADDR “@geoLookup” “deny,nolog,chain,status:500”
SecRule GEO:COUNTRY_CODE “@pm RU PK CN”</pre>
</div><br/><br/> Để chặn nhiểu quốc gia hơn, có thể dùng @pmFromFile thay cho @pm<br/><br/> <font color='orange'><b>2.4.9.3. Cân bằng tải giữa các server trên các châu lục khác nhau</b></font><br/><br/> Nếu chúng ta đang cung cấp dữ liệu cho khách truy cập download, chúng ta sẽ tính đến bài toán để người truy cập có được tốc độ download tốt nhất có thể. Giả sử chúng ta có một Server ở Mỹ và một Server ở châu Âu. Bằng cách sử dụng ModSecurity với operator là @geoLookup, ta có thể xác định nơi khách truy cập và chuyển vị trí download đến server gần nhất, vì vậy tốc độ download sẽ cải thiện cũng như cân bằng tải cho Server. Rule trong trường hợp này được viết như sau:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_URI “^/download/&#40;.*&#41;$” “phase:1,capture,chain, wwwect:http://sveu.example.com/download/%{TX.1}”
SecRule REMOTE_ADDR “@geoLookup” “chain”
SecRule GEO:COUNTRY_CONTINENT “@streq EU”</pre>
</div><br/><br/> Rule đầu tiên sẽ phù hợp với bất kỳ request nào đến thư mục<font color='yellow'> /download/.</font> Sử dụng dấu chấm(.) và dấu sao<img src="/hvaonline/images/smilies/76ec624536d56442d32f4d929544379e.gif" border="0" alt="smilie" align="absbottom"> để đại diện cho tất cả các file có trong thư mục. ModSecurity sẽ nắm bắt tất cả các giá trị này và lưu nó vào trong biến <font color='yellow'>TX:1</font>. Nếu người truy cập từ Châu Âu, ModSecurity sẽ chuyển hướng request đến server sveu.example.com với đường dẫn thư mục và file request như REQUEST _URI ở rule đầu tiên.<br/><br/> <font color='orange'><b>2.4.10. Thực hiện các shell scripts với ModSecurity</b></font><br/><br/> ModSecurity có thể thực thi một shell scripts khi khớp (math) với một rule. Điều này được thực hiện thông qua actions <font color='yellow'>exec()</font> . Đây là một kỹ thuật rất mạnh cho phép chúng ta sử dụng toàn bộ sức mạnh của shell scripts khi một rules được kích hoạt.<br/><br/> Các file shell scripts phải được thực thi bởi user Apache, vì vậy phải chắc chắn rằng user Apache có quyền thực thi scripts. Nếu thực hiện shell scripts không thành công, ModSecurity sẽ ghi lỗi vào file log lỗi của Apache. Dưới đây là một số ứng dụng thông thường khi sử dụng Modsecurity thực hiện Shell scripts.<br/><br/> <b><font color='orange'>2.4.10.1. Giởi email cảnh báo</font></b><br/><br/> Ví dụ, giả sử rằng chúng ta muốn thực hiện một script để gởi cho người quản trị web server email cảnh báo ModSecurity phát hiện hacker đang khai thác lỗi SQL injection. Để làm điều này, chúng ta cần hai bước:<br/><br/> 1. Viết một file script có khả năng gởi email cảnh báo đến một địa chỉ email chỉ định.<br/> 2. Một rule có tác dụng sẽ gọi script khi phát hiện tấn công.<br/> Đối với script, chúng ta có thể sử dụng một standard shell script gọi /bin/sh, (có thể sử dụng Perl script hoặc bất kỳ ngôn ngữ khác). Vd ở đây sử dụng standard shell script và gửi email thông báo cho <a href="mailto:tanviet12@example.com">tanviet12@example.com</a><br/> Tạo một file có tên email.sh trong thư mục /usr/local/bin có nội dung<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#!/bin/sh
echo "Mot cuoc tan cong sql injection da bi chan"|mail –s "ModSecurity Alert" &lt;a href="mailto:tanviet12@example.com"&gt;tanviet12@example.com&lt;/a&gt;
echo Done.</pre>
</div><br/><br/> Nếu được kích hoạt, script sẽ gởi email đến địa chỉ <a href="mailto:tanviet@example.com">tanviet@example.com</a> với tiêu đề <font color='yellow'>ModSecurity Alert.</font> Cuối script là chuỗi <font color='yellow'>Done </font> để ModSecurity nhận biết đã thực thi script thành công.<br/><br/> Tiếp theo, viết rule để kích hoạt script khi có tấn công sql injection<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS “drop table” “deny,exec:/usr/local/bin/email.sh”</pre>
</div><br/><br/> Bây giờ chúng ta có thể thử nghiệm rule bằng cách truy cập vào đường dẫn<span class="link"> http://example.com/test=drop%20table.</span><br/><br/> <b><font color='orange'>2.4.10.2. Gởi nhiều thông tin hơn đến email</font></b><br/><br/> Email cảnh báo có thể rất hữu ích cho người quản trị web server để nhanh chóng khắc phục được sự cố khi gặp tấn công…Tuy nhiên, chúng ta có thể làm cho các email được gởi chứa nhiều thông tin hơn về cuộc tấn công (các thông tin như IP, request URI,..).<br/><br/> ModSecurity cho phép chúng ta thiết lập các biến môi trường thông qua action setenv. Giả sử chúng ta muốn thu thập các thông tin sau khi phát hiện tấn công SQL injection:<br/><br/> - Tên máy của server nơi xảy ra cảnh báo<br/> - Địa chỉ IP và tên máy của hacker<br/> - Các request URI<br/> - Các giá trị của tất cả các đối số, cho dù được gửi bằng phương thức GET hay POST<br/> - Các ID của request để chúng ta dễ dàng tìm thấy đoạn request trong file log,<br/><br/> Đặt các thông tin trên vào sáu biến môi trường riêng biệt: <b>HOSTNAME, REMOTEIP, REMOTEHOST, REQUESTURI, ARGS, và UNIQUEID</b>.<br/><br/> Rule được viết như sau:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS "drop table" "deny,t:lowercase,setenv:HOSTNAME=%{SERVER_NAME}, setenv:REMOTEIP=%{REMOTE_ADDR},setenv:REQUESTURI=%{REQUEST_URI},setenv:ARGS=%{ARGS}, setenv:UNIQUEID={%UNIQUE_ID},exec:/usr/local/bin/email.sh"</pre>
</div><br/><br/> File shell script được viết lại như sau<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#!/bin/sh
echo "Mot cuoc tan cong sql injection da bi chan:
Server: $HOSTNAME
Attacking IP: $REMOTEIP
Attacking host: $REMOTEHOST
Request URI: $REQUESTURI
Arguments: $ARGS
Unique ID: $UNIQUEID
Time: `date '+%D %H:%M'`
"|mail –s 'ModSecurity Alert' &lt;a href="mailto:tanviet12@example.com"&gt;tanviet12@example.com&lt;/a&gt;
echo Done.</pre>
</div><br/><br/> <font color='orange'><b>2.4.10.3. Chặn tấn công đoán mật khẩu – brute-force</b></font><br/><br/> Bây giờ chúng ta sẽ dùng collection IP để chặn tấn công brute-force. Dưới đây là một rule viết để chặn tấn công brute-fore.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre># Khoi tao ip collection
SecAction "initcol:ip=%{REMOTE_ADDR},pass,phase:1"
# kiem tra truy cap den thu muc administrator
SecRule REQUEST_URI "^/administrator/" "pass,phase:1,setvar:ip.attempts=+1,expirevar:ip.attempts=600"
# Da duoc xac thuc hay chua?
SecRule REQUEST_URI "^/administrator/" "chain,pass,phase:3"
# Neu da duoc xac thu, set counter to 0
SecRule RESPONSE_STATUS "^2..$" "setvar:ip.attempts=0"
# Deny neu 5 lan xac thuc khong thanh cong
SecRule IP:ATTEMPTS "@gt 5" "phase:1,deny"</pre>
</div><br/><br/> <b><font color='orange'>2.4.11. Chèn dữ liệu vào response</font></b><br/><br/> ModSecurity cho phép chúng ta đưa dữ liệu vào response gửi lại cho client nếu SecContentInjection được thiết lập On. Được sử dụng để đưa ra một lời cảnh báo cho hacker khi hành động tấn công được phát hiện.<br/> Với ví dụ dưới đây, chúng ta sẽ đưa ra thông báo “Hoc di dung hack nua!” khi ModSecurity phát hiện tấn công XSS.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecContentInjection On
SecRule ARGS:username "%" "phase:1,allow,t:urlDecode,append:'&gt;&lt;script type=text/javascript&gt;alert&#40;\"Hoc di dung hack nua!\"&#41;;&lt;/script&gt;',log,msg:'phat hien tan cong'"</pre>
</div><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/9.jpg' border="0" /></div><br/> Hình 2.3 Ví dụ về chèn dữ liệu vào Response<br/><br/> <b> <font color='orange'>2.4.12. Kiểm tra các tập tin được upload lên</font></b><br/><br/> Một tính năng rất hữu ích ModSecurity là khả năng kiểm tra các file đã được upload lên thông qua một POST request.<br/> Vì vậy, chỉ cần thiết lập <font color='yellow'>RequestBodyBuffering On</font> là chúng ta có thể kiểm tra chúng bằng cách sử dụng toán tử <font color='yellow'>@inspectFile</font>.<br/><br/> Cần viết một shell script chặn các file được upload lên và quét chúng bằng ClamAV. ClamAV là một antivirus được sử dụng rất phổ biến trên môi trường Unix <span class="link"> http://clamav.net</span>) Khi ClamAV đã được cài đặt, sử dụng lệnh <font color='yellow'>clamscan &lt;tenfile&gt;</font> để quét file.<br/><br/> Đầu tiên cần thiết lập vị trí thư mục lưu file tạm<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecUploadDir “/tmp/mosecurity”
SecTmpDir “/tmp/mosecurity”</pre>
</div><br/><br/> Lưu ý: User apache phải có quyền read và write trên thư mục trên<br/><br/> Tiếp theo viết script /usr/local/bin/filescan.sh để thực hiện quét mã độc khi có file upload lên server.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#!/bin/sh
/usr/bin/clamscan $1 &gt; /dev/null 2&gt;&1
if &#91; "$?" -eq "1" &#93;; then
echo "An infected file was found!"
fi</pre>
</div><br/><br/> Dòng đầu tiên của script để kích hoạt ClamAV quét thư mục /tmp/ModSecurity. Câu lệnh tiếp theo sẽ kiểm tra giá trị trả về của lệnh thực hiện trước. ClamAV sẽ trả về 1 nếu virus được tìm thấy và 0 nếu ngược lại.<br/> Dưới đây là Rule để chặn các file được upload lên và kích hoạt script quét virus.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule FILES_TMPNAMES “@inspectFile /usr/local/bin/filescan.sh” “phase:2,deny,status:418”</pre>
</div><br/><br/> <font color='orange'><b>Kết thúc Phần 2</b></font><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38690.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38690/237042.html#237042,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">---------------------------------------------------------------------------------------------------------------------<br/> Xem các phần khác tại<br/> Phần 1:<span class="link"> /hvaonline/posts/list/38687.html</span><br/> Phần 3:<span class="link"> /hvaonline/posts/list/38694.html</span><br/> ---------------------------------------------------------------------------------------------------------------------<br/> <font size='+2'><b><font color='orange'>PHẦN 2: MODSECURITY</font></b></font><br/><br/> <font color='orange'><font size='+1'><b>2.1. GIỚI THIỆU MODSECURITY</b></font></font><br/><br/> ModSecurity là một Opensource web application firewall được Ivan Ristic phát triển dành cho Web Server Apache. Ivan Ristic cũng là tác giả quyển sách “Mod Security Handbook”. Ông là một người có rất nhiều kinh nghiệm trong bảo vệ Web Server Apache. Ông đã có nhiều thời gian nghiên cứu Web Application Security, Web Intrusion Detection, và Security Patterns. Trước khi chuyển sang lĩnh vực security, Ivan đã có nhiều năm làm việc như một Developer, System Architect, Technical Director trong phát triển phần mềm. Ông là người sáng lập ra công ty ThinkingStone làm các dịch vụ liên quan đến web application security.<br/> Hiện tại ModSecurity sử dụng giấy phép GPL, hoàn toàn miễn phí<br/><br/> <font size='+1'><font color='orange'><b>2.2. CÁC KHẢ NĂNG CỦA MODSECURITY </b></font></font><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/1.jpg' border="0" /></div><br/> Hình 2.1 Mô hình tổng quan của ModSecurity<br/><br/> - <b>Request filtering</b>: Tất cả các request gửi đến web server đều được phân tích và cản lọc (filter) trước khi chúng được đưa đến các modules khác để xử lý<br/> - <b>Understanding of the HTTP protocol:</b> ModSecurity là một tường lửa ứng dụng nên nó có khả năng hiểu được giao thức HTTP. ModSecurity có khả năng cản lọc dựa trên các thông tin ở HTTP Header hay có thể xem xét đến từng thông số hay cookies của các request...vv<br/> - <b>POST payload analysis</b>: Ngoài việc cản lọc dựa trên HTTP Header, ModSecurity có thể dựa trên nội dung (payload) của POST requests.<br/> - <b>Audit logging</b>: Mọi requests đều có thể được ghi lại (bao gồm cả POST) để người quản trị có thể theo dõi nếu cần.<br/> - <b>HTTPS filtering:</b> ModSecurity có thể phân tích HTTPS.<br/> - Compressed content filtering: ModSecurity sẽ phân tích sau khi đã giải nén các các dữ liệu được yêu cầu.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan2/2.jpg' border="0" /></div><br/> Hình 2.2 Quá trình xử lý các request của Apache và ModSecurity<br/><br/> Modsecurity cho phép chúng ta đặt rule tại một trong năm thời điểm trong chu kỳ xử lý của Apache như sau:<br/><br/> 1. <b>Phase Request Header:</b> Rule được đặt tại đây sẽ được thực hiện ngay say khi Apache đọc request header, lúc này phần request body vẫn chưa được đọc.<br/> 2. <b>Phase Request Body:</b> Đây là thời điểm các thông tin chức năng chung đưa vào vào được phân tích và xem xét, các rule mang tính ứng dụng hướng kết nối (application-oriented) thường được đặt ở đây. Ở thời điểm này, Server đã nhận đủ các thông số của request và phần request body đã được đọc. Modsecurity hỗ trợ ba loại mã hoá request body<br/> + <b>application/x-www-form-urlencoded:</b> Dùng để truyền form dữ liệu<br/> + <b>multipart/form-data</b>: Dùng để truyền file<br/> + <b>text/xml</b>: Dùng để phân tích dữ liệu XML<br/> 3. <b>Phase Response Header:</b> Đây là thời điểm ngay sau khi phần response header được gửi trả về cho client. Chúng ta đặt rule ở đây nếu muốn giám sát quá trình sau khi phần response được gửi đi.<br/> 4. <b>Phase Response Body</b>: Đây là thời điểm chúng ta muốn kiểm tra những dữ liệu HTML gửi trả về.<br/> 5. <b>Phase logging: </b>Là thời điểm các hoạt động log được thực hiện, các rules đặt ở đây sẽ định rõ việc log sẽ như thế nào, nó sẽ kiểm tra các error message log của Apache. Đây cũng là thời điểm cuối cùng để chúng ta chặn các kết nối không mong muốn, kiểm tra các response header mà chúng ta không thể kiểm tra ở phase 3 và phase 4.<br/><br/> <font size='+1'><b><font color='orange'>2.3. CÀI ĐẶT VÀ CẤU HÌNH</font></b></font><br/><br/> (phần cài đặt được tham khảo từ một bài viết của forum ceh.vn, có một số chỉnh sửa cho phù hợp...)<br/><br/> Trước khi cài đặt, chúng ta phải đảm bảo web server Apache đã hoạt động tốt. Distro Linux sử dụng là CentOS5 và phiên bản ModSecurity sử dụng là 2.5. Có thể thực hiện trên các Distro khác như Ubuntu, Fedora...<br/> - Thực hiện tải mã nguồn về<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>wget<span class="link"> http://www.modsecurity.org/download/modsecurity-apache_2.5.11.tar.gz</span>
.......
01:52:06 &#40;161 KB/s&#41; - `modsecurity-apache_2.5.11.tar.gz' saved &#91;1338425/1338425&#93;</pre>
</div><br/><br/> - Thực hiện tra tính toàn vẹn của mã nguồn (việc này không bắt buộc nhưng chúng ta nên có thói quen kiểm tra để đảm bảo rằng mã nguồn đã không bị can thiệp vào dưới bất kỳ hình thức nào). Có thể sử dụng MD5 hay PGP để làm việc này. Ở đây sử dụng PGP<br/> + Đầu tiên cần download chữ ký :<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>wget<span class="link"> http://www.modsecurity.org/download/modsecurity-apache_2.5.11.tar.gz.asc</span>
......
02:04:38 &#40;14.8 MB/s&#41; - `modsecurity-apache_2.5.11.tar.gz.asc' saved &#91;189/189&#93;</pre>
</div><br/><br/> + Download Publick Key:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>gpg --keyserver pgp.mit.edu --recv-key E77B534D
.....
gpg: Total number processed: 1
gpg: imported: 1</pre>
</div><br/><br/><br/> + Kiểm tra chữ ký:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>gpg --verify modsecurity-apache_2.5.11.tar.gz.asc
......
gpg: Good signature from "Brian Rectanus &#40;work&#41; &lt;brian.rectanus@breach.com&gt;"
gpg: aka "Brian Rectanus &lt;brian@rectanus.net&gt;"
gpg: aka "Brian Rectanus &#40;personal&#41; &lt;brectanu@gmail.com&gt;"</pre>
</div><br/><br/> - Kiểm tra thành công. Thực hiện giải nén mã nguồn:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>tar xfvz modsecurity-apache_2.5.11.tar.gz</pre>
</div><br/><br/> - <b>Kiểm tra các gói thư viện cần thiết, ModSecurity yêu cầu có 4 thành phần sau trước khi biên dịch :</b><br/><br/> + <b>apxs</b> : Kiểm tra bằng cách :<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>whereis -b apxs
......
apxs: /usr/sbin/apxs</pre>
</div><br/><br/> Nếu chưa có, chúng ta phải cài thêm gói httpd-devel (hay apache2-dev đối với dòng debian,ubuntu.. )<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>yum install httpd-devel &#40;hoặc apt-get install apache2-dev&#41;</pre>
</div><br/><br/> + <b>libxml2: </b>Kiểm tra bằng cách :<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>whereis -b libxml2
......
libxml2: /usr/lib/libxml2.a /usr/lib/libxml2.so /usr/include/libxml2</pre>
</div><br/><br/> Nếu chưa có, chúng ta phải cài thêm gói libxml2-devel (hay libxml2-dev đối với debian,ubuntu...)<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>yum install libxml2-devel &#40;hoặc apt-get install libxml2-dev&#41;</pre>
</div><br/><br/> + <b>pcre: </b>Kiểm tra bằng cách :<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>whereis pcre
......
pcre: /usr/include/pcre.h /usr/share/man/man3/pcre.3.gz</pre>
</div><br/><br/> Nếu chưa có thì chúng ta phải cài thêm gói pcre-devel :<br/> yum install pcre-devel (hoặc apt-get install pcre-dev)<br/><br/> + <b>mod_unique_id:</b> Là mod thường đã được biên dịch cùng Apache. Có thể kiểm tra lại bằng cách tìm trong httpd.conf dòng:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>LoadModule unique_id_module modules/mod_unique_id.so</pre>
</div><br/><br/> Nếu chưa có, chúng ta phải thêm vào với nội dung như trên.<br/> - Chuyển vào thư mục chứa mã nguồn và tiến hành biên dịch :<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>cd modsecurity-apache_2.5.11/apache2/</pre>
</div><br/><br/> + Tạo Make file :<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>./configure
......
configure: creating ./config.status
config.status: creating Makefile
config.status: creating build/apxs-wrapper
config.status: creating mlogc-src/mlogc-batch-load.pl
config.status: creating t/run-unit-tests.pl
config.status: creating t/run-regression-tests.pl
config.status: creating t/gen_rx-pm.pl
config.status: creating t/csv_rx-pm.pl
config.status: creating t/regression/server_root/conf/httpd.conf
config.status: creating ../tools/rules-updater.pl
config.status: creating mlogc-src/Makefile
config.status: creating mod_security2_config.h</pre>
</div><br/><br/> + Tiến hành biên dịch<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>make</pre>
</div><br/><br/> Sau khi biên dịch thành công file mod_security2.so sẽ được tạo ra trong thư mục libs.<br/><br/> - Tích hợp ModSecurity vào Apache<br/><br/> Để Apache nhận ra sự tồn tại của ModSecurity chúng ta cần copy mod_security2.so đến thư mục chứa<br/> modules của apache, đối với distro CentOS là /etc/httpd/modules<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>cp /libs/mod_security2.so /etc/httpd/modules/</pre>
</div><br/><br/> Sửa lại file httpd.conf để thực hiện load module ModSecurity:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>vi /etc/httpd/conf/httpd.conf</pre>
</div><br/><br/> Thêm dòng<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>LoadModule security2_module modules/mod_security2.so</pre>
</div><br/><br/> - Quy định file cấu hình ModSecurity<br/><br/> Chúng ta có thể cấu hình trực tiếp các thông số và rule của ModSecurity vào file httpd.conf. Nhưng để cho rõ ràng và đảm bảo không sai sót trong quá trình thực hiện - gây ảnh hưởng Apache, Chúng ta nên tạo một file cấu hình riêng và sau đó include vào.<br/> Trong CentOS các file cấu hình riêng mặc định chứa trong /etc/httpd/conf.d/<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>vi /etc/httpd/conf.d/modsecurity.conf</pre>
</div><br/><br/> Thêm vào các thông số cấu hình cơ bản<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>&lt;IfModule security2_module&gt;
# Bat che do loc cua Modsecurity
SecRuleEngine On
# Thiet lap action mac dinh
SecDefaultAction "phase:2,deny,log,status:404"
# rule thu nghiem block tat ca request co uri chua "hacker"
SecRule REQUEST_URI "hacker"
&lt;/IfModule&gt;</pre>
</div><br/><br/> Thực hiện thử nghiệm để kiểm tra hoạt động của ModSecurity. Tiến hành tạo 2 file trong thư mục web, hacker.html và index.html chẳng hạn. Khi chúng ta truy cập vào file index.html thì trình duyệt trả về kết quả bình thường<br/> Còn khi truy cập vào hacker.html thì trình duyệt báo lỗi :<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>404 – Forbidden</pre>
</div><br/><br/> Đó là kết quả do ModSecurity đã chặn những URI có chứa chuỗi hacker và cũng đồng nghĩa với việc ModSecurity đã hoạt động.<br/><br/> <font size='+1'><b><font color='orange'>2.4. VIẾT RULES</font></b></font><br/><br/> <font size='+1'><font color='orange'><b>2.4.1. Cú pháp SecRule</b></font></font><br/><br/> SecRule được sử dụng để tạo các rule cho ModSecurity . Cú pháp rất đơn giản<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule Target Operator &#91;Actions&#93;</pre>
</div><br/><br/> <b>Target (mục tiêu)</b>: Quy định cụ thể mục tiêu của request hoặc response mà chúng ta muốn kiểm tra. Trong ví dụ kiểm cơ bản được đưa ra trong phần trước, sử dụng biến có tên <b>REQUEST_URI</b>, trong đó có các URI được request trên server, để nhận diện và chặn bất cứ Client nào truy cập vào các vị trí <i>/hacker.html</i>. Hiện có hơn 70 biến có thể được sử dụng để tạo rule.<br/><br/> Ngoài ra còn có một loại biến đặc biệt được gọi là biến collection có thể chứa nhiều đối số. Một ví dụ về collection là <b>ARGS</b>, trong đó có chứa tất cả các đối số được truyền trong một chuỗi truy vấn hoặc thông qua một request POST.<br/><br/> Phần <b>Operator</b> xác định phương pháp và so sánh khớp dữ liệu để kích hoạt Action. Với Operator, mặc định là <i>@rx</i><br/><br/> Cuối cùng, <b>Actions </b>(hành động) là một danh sách các hành động được thực hiện nếu phù hợp (matching) rule. Action có thể là allow (cho phép) hoặc deny (từ chối) các request; và quy định cụ thể các mã trạng thái (status code) khi trả về (response) cho client. Nếu không có action nào được quy định, các action mặc định của action SecDefaultAction sẽ được sử dụng (rule chứa action này thường được khai báo đầu tiên).<br/><br/> Để làm rõ hơn, chúng ta xem ví dụ. Giả sử chúng ta là một chủ doanh nghiệp nhỏ bán sách dạy nấu ăn ở định dạng file PDF trên website. Để lôi kéo khách hàng mua sách, chúng ta cung cấp một chương mẫu có chứa các công thức nấu ăn ngon nhất trong cuốn sách, mà họ có thể tải về miễn phí để xem trước khi quyết định mua.<br/><br/> Công việc kinh doanh đang ổn định, nhưng sau đó đột nhiên chúng ta nhận được đơn khiếu nại qua email nói rằng trang web của chúng ta rất chậm hoặc không truy cập được.<br/><br/> Khi nhìn vào log chúng ta nhận thấy rằng, một IP kết nối tới server web tràn ngập với các request cho các chương mẫu. Các chuỗi user-agent thấy được có tên <font color='yellow'>Red Bullet Downloader </font>. <b>User-agent</b> này của các chương trình Download nhanh.<br/><br/> Giải pháp đưa ra để giải quyết vấn đề này là dùng Mod Securiry để ngăn chặn các user-agent này download. Rules được viết như sau.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_HEADERS:User-Agent "Red Bullet" "deny,nolog"</pre>
</div><br/><br/> Trong ví dụ trên, <b>REQUEST_HEADERS</b> là một Collection chứa tất cả các trường trong thông điệp header (message header) được gởi đến bởi client và trong header này chứa User-agent. Vì vậy, ta sử dụng từ khoá cho user-agent là “Red Bullet” vì từ Red Bullet này thường xuyên xuất hiện trong các header được gởi đển từ client. Và Action là deny – là từ chối và nolog là không ghi lại log<br/><br/> <font color='orange'><b>2.4.1.1. Biến và bộ chọn lọc Collection</b></font><br/><br/> Hiện khoản hơn 70 biến có sẵn. ModSecurity sử dụng hai loại biến: biến Standard, đơn giản chỉ chứa một giá trị duy nhất, và biến Collection, có thể chứa nhiều hơn một giá trị. Một ví dụ về một Collection là REQUEST_HEADERS, trong đó chứa tất cả các trường trong thông điệp header mà Client gởi tới Server, chẳng hạn như User-agent hoặc Referer.<br/><br/> Để truy cập vào một trường trong collection, chúng ta ghi tên collection, tiếp theo là dấu hai chấm và sau đó là tên của trường hoặc tuỳ chọn mà chúng ta muốn truy cập. Ví dụ:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_HEADERS:Referer "bad-referer.com"</pre>
</div><br/><br/> Trong trường hợp kiểm tra toàn bộ dữ liệu trên tất cả các collection. Ví dụ, nếu chúng ta muốn kiểm tra sự hiện diện của chuỗi script có thể sử dụng rules sau đây:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS "script"</pre>
</div><br/><br/> Nếu muốn kiểm tra thêm các chuỗi truy vấn được gửi là <i>username=john&login=yes</i> , chúng ta có thể mở rộng rule bằng cách.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS:john|ARGS:login "script"</pre>
</div><br/><br/> Các collection có sẵn trong ModSecutity 2.5<br/> - ARGS<br/> - ENV<br/> - FILES<br/> - FILES_NAMES<br/> - FILES_SIZES<br/> - FILES_TMPNAMES<br/> - GEO<br/> - IP<br/> - REQUEST_COOKIES<br/> - REQUEST_COOKIES_NAMES<br/> - REQUEST_HEADERS<br/> - REQUEST_HEADERS_NAMES<br/> - RESPONSE_HEADERS<br/> - RESPONSE_HEADERS_NAMES<br/> - SESSION<br/> - TX<br/> - USER<br/><br/> <font color='orange'><b>2.4.1.2. Chuyển đổi giữa các Collection</b></font><br/><br/> TX Collection còn được gọi là các Transaction collection. Chúng ta có thể sử dụng nó để tạo ra các biến phục vụ riêng cho mình.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_URI “passwd” “pass,setvar:tx.hackscore=+5”
SecRule TX:HACKSCORE “@gt 10” deny</pre>
</div><br/><br/> Trong hai rule đầu tiên sử dụng action setvar để thiết lập các biến collection. Thực hiện tạo biến hackscore và tăng giá trị lên 5 nếu rule được thực thi (matching rule). Đến khi biến hackscore có giá trị bằng 10 thì thực thi rule thứ hai sẽ được thực thi với action là deny.<br/><br/> (Có thể loại bỏ biến bằng cách sử dụng setvar cú pháp setvar:!tx.hackscore)<br/><br/> <font color='orange'><b>2.4.1.3. Lưu trữ các Request</b></font><br/><br/> Có ba loại collection trong ModSecurity được sử dụng để lưu trữ liên tục( persistent storage). Như phần trước đã trình bày, setvar giúp tạo ra một biến và gán giá trị cho nó. Tuy nhiên, biến sẽ hết hạn và không còn nữa khi các request hiện tại đã được xử lý. Trong một số trường hợp chúng ta muốn lưu trữ giá trị biến và truy cập nó cho các request sau này, có thể sử dụng kiểu lưu trữ này.<br/><br/> Có ba collection có thể được sử dụng cho mục đích này:<br/> - IP<br/> - SESSION<br/> - USER<br/><br/> Collection <b>IP </b>được sử dụng để lưu trữ thông tin về IP của người sử dụng. Nó có thể được sử dụng để lưu trữ IP ở các trường hợp như: Số lần truy cập không thành công vào tài nguyên trên server, hoặc số lượng các request của người dùng…<br/> Trước khi sử dụng một trong các collection, chúng ta cần khởi tạo nó. Điều này được thực hiện bằng cách sử dụng các action <font color='yellow'>initcol</font>:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecAction initcol:ip=%{REMOTE_ADDR},nolog,pass</pre>
</div><br/><br/> Để thực hiện được rule trên, phải chắc chắn đã khai báo đường dẫn đến thư mục lưu trữ cho ModSecurity<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecDataDir /var/log/httpd/modsec_data</pre>
</div><br/><br/> <font color='orange'><b>2.4.1.4. Kiểm tra nhiều biến</b></font><br/><br/> ModSecurity có thể kiểm tra nhiều biến cùng một lúc, mục đích để kết hợp so sánh (matching) một chuỗi.<br/> Ví dụ:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS|REQUEST_HEADERS "park" deny</pre>
</div><br/><br/> Dấu (|) được sử dụng để tách các tên biến. Nó cũng có nhiều chức năng logic giống như “or” trong lập trình.<br/><br/> <font color='orange'><b>2.4.1.5. Sử dụng dấu “ khi viết rule</b></font><br/><br/> Chúng ta xem xét các rule sau<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_URI "secret" "deny"
SecRule REQUEST_URI secret deny
SecRule REQUEST_URI "secret place" deny</pre>
</div><br/><br/> Hai rule đầu đều đúng và có tác dụng như nhau. Dấu (“) được sử dụng để chứa các cụm từ cách nhau bởi có dấu space. Các đơn từ thì có thể dùng hoặc không dùng.<br/> Sử dụng (“) còn để nhóm các thông điệp ghi log.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_URI "secret place" "deny,log,msg:'Someone tried to access the secret place!'"</pre>
</div><br/><br/> Nếu chúng ta muốn đặt dấu (‘) trong thông điệp cần ghi log. Thực hiện chèn dấu (\) trước dấu (‘).<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_URI "secret place" "deny,log,msg:'Someone\'s trying to hack us!'"</pre>
</div><br/><br/> <font color='orange'><b>2.4.1.6. Tạo rule kết chuỗi – chain</b></font><br/><br/> Để kết hợp nhiều rule hoạt động liên tiếp với nhau, ta sử dụng chain.<br/><br/> Ví dụ: Người quản trị web server muốn chặn một số người download nhiều file gây ảnh hưởng đến web server, nhưng một số khách hàng khác cũng download mà không gây ảnh hưởng đến webserver bởi họ chỉ download vài file là xong và ta không chặn những người này. Và người quản trị server quyết định chặn những người có user-agent có chứa “Red Bullet” và IP của người này nằm trong dãy IP của một ISP xác định. Với từ chain trong action. Sử dụng nó, chúng ta có thể tạo ra một chain rule mà nếu phù hợp tất cả các rule trong chain thì action của chain sẽ được thực hiện.<br/><br/> Ví dụ đây là rule cấm người dùng với user-agent có từ “Red Bullet”<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_HEADERS:User-agent “Red Bullet” deny</pre>
</div><br/><br/> Rule thứ hai là chỉ những client nằm trong dãy IP 192.168.1.0-192.168.1.255:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REMOTE_ADDR “^192\.168\.1\.”</pre>
</div><br/><br/> Để thoả mãn điều kiện đặt ra như trên, ta sử dụng rule chain để kết hợp hai rule trên:<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_HEADERS:User-agent “Red Bullet” “chain,deny” SecRule REMOTE_ADDR “^192\.168\.1\.”</pre>
</div><br/><br/> Có thể thêm nhiều rule vào chain rule. Nếu chúng ta muốn thêm điều kiện là các rule chỉ hoạt động trước 6:00 giờ tối, ta sẽ thêm một rule thứ ba<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule REQUEST_HEADERS:User-agent “Red Bullet” “chain,deny”
SecRule REMOTE_ADDR “^192\.168\.1\.” “chain”
SecRule TIME_HOUR “@lt 18”</pre>
</div><br/><br/> Từ<font color='yellow'> @lt</font> viết tắt của “less-than” là nhỏ hơn. Thuộc cú pháp so sánh số (matching number), sẽ được trình bày chi tiết ở phần 2.4.3.<br/><br/> <b><font color='orange'>2.4.1.7. Rule IDs</font></b><br/><br/> Chúng ta có thể quản lý các rule bằng cách đặt ID cho mỗi rule.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>SecRule ARGS "login" "deny,id:1000"</pre>
</div><br/><br/> Một số cú pháp thông thường<br/> - SecRuleRemoveById:Gỡ bỏ rule có ID là<br/> - SecRuleUpdateActionById: Cập nhật rule có ID là<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38687.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38687/237029.html#237029,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">---------------------------------------------------------------------------------------------------------------------<br/> Xem các phần tiếp theo tại<br/> Phần 2:<span class="link"> /hvaonline/posts/list/38690.html</span><br/> Phần 3:<span class="link"> /hvaonline/posts/list/38694.html</span><br/> ---------------------------------------------------------------------------------------------------------------------<br/> Chào các chú, các anh chị, các bạn trong HVA.<br/> Trước giờ tham gia diễn đàn chỉ có hỏi và thảo luận, chưa viết bài nào. Vì vậy hôm nay mạo muội viết một chủ đề về "<font color='orange'><b>Bảo mật web server Apache với mod Security</b></font>" - đây cũng là đề tài thực tập mình mới vừa hoàn thành xong.<br/><br/> Mình thực tập ở một trung tâm chuyên về an ninh mạng, tuy thời gian tiếp xúc với mấy anh trong nghề không nhiều lắm, nhưng qua mấy lần trò chuyện với anh giám đốc và các lần trao đổi với anh phụ trách hướng dẫn, mình thấy được nhiều điều hơn về thực tế của nghề bảo mật, và đặc biệt là bảo mật web server.<br/><br/> Không biết mấy anh trong trung tâm có đọc được chủ đề này không, nhưng xin phép mượn chủ đề này, cho em gởi lời cảm ơn đến trung tâm, nơi đã hướng dẫn và giúp đỡ em rất nhiều trong thời gian thực tập.<br/><br/> <b>Bắt đầu vào chủ đề nhé.</b><br/> (PS: Lần đầu tiên viết bài về ... bảo mật, kiến thức và trình độ còn kém, mong các anh, chị, cô, chú bỏ qua và góp ý các sai sót.)<br/><br/> ---------------------------------------------------------------------------------------------------------------------<br/> <font color='orange'><b>Các phần dự kiến sẽ trình bày:</b></font><br/><br/> <font color='orange'><b>PHẦN 1: CƠ BẢN VỀ GIAO THỨC HTTP</b></font><br/> Phần này sẽ giới thiệu sơ lược về giao thức HTTP và hoạt động của nó.<br/><br/> <font color='orange'><b>PHẦN 2: MODSECURITY</b></font><br/> Phần này sẽ trình bày về MODSECURITY, gồm các phần nhỏ như: Giới thiệu, cài đặt và đặt biệt là viết rule<br/><br/> <b><font color='orange'>PHẦN 3: NGĂN CHẶN MỘT SỐ HÌNH THỨC TẤN CÔNG THÔNG THƯỜNG VỚI MODSECURITY</font></b><br/> Phần này sẽ trình bày lý thuyết về một số hình thức tấn công thông thường vào web aplication, web server và cách chặn các hình thức tấn công đó với MODSECURITY<br/><br/> Các tài liệu dùng để tham khảo:<br/><br/> <b>----- Sách</b><br/> [1]. HTTP Essentials - Protocols for Secure, Scaleable Web Sites, John Wiley & Sons Inc, Stephen A. Thomas.<br/> [2]. ModSecurity 2.5 - Securing your Apache installation and web applications, Packt Publishing Ltd, Magnus Mischel (11-2009).<br/> [3]. ModSecurity Handbook, Ivan Ristic.<br/> [4]. Một bài báo cáo về modsecurity của sinh Hiên học viện Kỹ thuật Mật mã (mình không biết rõ họ tên sv).<br/><br/> <b>-----Internet</b><br/> [5]. http://www.modsecurity.org/documentation/<br/> [6]. /hvaonline/posts/list/1754.html<br/> [7]. /hvaonline/posts/list/25210.html<br/> [8]. /hvaonline/posts/list/25352.html<br/> [9]. http://www.newstar.vn/forum/showthread.php?2364-ModSecurity-to%E0n-t%26%237853%3Bp<br/> [10]. http://en.wikipedia.org/<br/> [11]. http://www.maxmind.com/app/ip-location<br/><br/> ---------------------------------------------------------------------------------------------------------------------<br/> <font color='orange'><font size='+2'>PHẦN 1: CƠ BẢN VỀ GIAO THỨC HTTP</font></font><br/><br/> Phần này chỉ giới thiệu sơ lược các kiến thức <b>cơ bản</b> về giao thức HTTP, tạo tiền đề để phần 2 trình bày về MODSECURITY. Vì vậy, nếu bạn nào cần tìm hiểu sâu hơn, hãy tham khảo RFC hoặc cuốn <b>HTTP Essentials</b><br/><br/> <font color='orange'><font size='+1'>11. Giới thiệu chung</font></font><br/> <font color='orange'><b>1.1.1. Lớp của giao thức HTTP</b></font><br/><br/> HTTP (Hypertext Transfer Protocol) là giao thức thuộc lớp ứng dụng trong mô hình tham chiếu OSI. Hoạt động thông thường ở port 80 và là giao thức hướng kết nối. Nói cách khác, trước khi thực hiện phiên làm việc, giao thức HTTP sẽ thực hiện bắt tay ba bước.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/1.jpg' border="0" /></div><br/> Hình 1.1 Lớp của giao thức HTTP<br/><br/><br/> <font color='orange'><b>1.1.2. URI – Uniform Resource Identifiers</b></font><br/><br/> Thông thường, chúng ta thường quen thuộc với định nghĩa URL (Uniform Resource Locators) Địa chỉ<span class="link"> http://www.example.com.vn</span> là một ví dụ về URL. Trên thực tế, không có nhiều khác biệt giữa hai khái niệm URL và URI, URL một chỉ là một loại của URI.<br/> URI là một đặc điểm kỹ thuật của giao thức HTTP. Như hình dưới cho thấy một URI chứa rất nhiều các thành phần, không đơn giản như URL.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/2.jpg' border="0" /></div><br/> Hình 1.2 Cấu trúc đầy đủ của URI<br/><br/> - <b>Protocol:</b> Xác định các giao thức và các ứng dụng cần thiết để truy cập tài nguyên, trong trường hợp này là giao thức HTTP<br/> - <b>Username:</b> Nếu giao thức hỗ trợ khái niệm về tên người dùng thì username cung cấp tên người dùng để chứng thực truy cập tài nguyên<br/> - <b>Password:</b> Mật khẩu truy cập tài nguyên<br/> - <b>Host:</b> Tên miền truyền thông cho webserver,<br/> - <b>Port: </b>Là port cho các giao thức lớp ứng dụng, ví dụ như HTTP là cổng 80 (có thể bỏ qua tham số này).<br/> - <b>Path:</b> đường dẫn phân cấp đến tài nguyên được đặt trên Server<br/> - <b>File: </b>Tên các tập tin tài nguyên trên Server<br/> - <b>Query:</b> Các tuy vấn thêm thông tin về tài nguyên của Client<br/> - <b>Fragment: </b>Một vị trí nào đó trong tài nguyên<br/><br/> <font color='orange'><font size='+1'><b>1.2. Hoạt động HTTP</b></font></font><br/> <font color='orange'><b>1.2.1. Kết nối</b></font><br/><br/> HTTP thuộc giao thức TCP, vì vậy trước khi tiến hành truyền thông phải thực hiện phiên kết nối TCP.<br/> Trước đây, mỗi kết nối TCP sẽ thực hiện chỉ 1 request HTTP và 1 response, nghĩa là nếu client request 2 lần thì sẽ cần 2 phiên kết nối TCP. Điều này gây ra nhiều bất cập, ảnh hưởng rất nhiều đến hiệu năng hoạt động của server.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/3.jpg' border="0" /></div><br/> Hình 1.3 Hoạt động của HTTP<br/><br/> Hiện nay, giao thức HTTP đã hỗ trợ một phiên kết nối TCP cho phép nhiều HTTP request..<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/4.jpg' border="0" /></div><br/> Hình 1.4 Hoạt động kết nối của HTTP<br/><br/> <font color='orange'><b>1.2.2. Pipelining </b></font><br/><br/> Pipelining cũng nhằm mục đích cải thiện hiệu năng của HTTP. Client không cần phải chờ Server response mới có thể request và ngược lại.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/5.jpg' border="0" /></div><br/> Hình 1.5 Hoạt động Pipelining của HTTP<br/><br/> <font color='orange'><b>1.2.3. Web Page Retrieval – GET</b></font><br/><br/> Hoạt động HTTP đơn giản nhất là GET. Đó là cách để Client lấy một đối tượng hoặc tài nguyên nào đó trên Server. Các trình duyệt sẽ yêu cầu một website từ Server với GET.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/6.jpg' border="0" /></div><br/> Hình 1.6 Hoạt động GET của HTTP<br/><br/> Với ví dụ trên, Client khởi tạo và gởi thông điệp GET đến Server, thông điệp này định danh đối tượng mà Client yêu cầu Server đáp ứng bằng một URI (Uniform Resource Identifier). Server có thể trả về tài nguyên mà Client yêu cầu với một mã trạng thái 200 OK. Nếu Server không đáp ứng được yêu cầu Client thì nó sẽ gởi về một số mã trạng thái khác được mô tả ở bảng bên dưới.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/7.jpg' border="0" /></div><br/> Bảng 1.1 Mã trạng thái được trả về của HTTP<br/><br/><br/> <font color='orange'><b>1.2.4. Web Forms – POST </b></font><br/><br/> Trong khi GET cho phép một Server gửi thông tin đến Client, thì hoạt động POST cung cấp một cách để Client gửi thông tin đến các Server. Trình duyệt sử dụng POST để gởi nội dung các Form đến Web Server. Hình dưới cho thấy một ví dụ như vậy.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/8.jpg' border="0" /></div><br/> Hình 1.7 Ví dụ về Web Forms POST<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/9.jpg' border="0" /></div><br/> Hình 1.8 Hoạt động POST của HTTP<br/><br/> Như hình trên cho thấy, hoạt động POST đơn giản như GET. Client gửi một thông điệp POST và bao gồm thông tin mà nó muốn gửi đến server. Cũng giống như GET, một phần của thông điệp POST là URI. Nhưng trong trường hợp này, URI xác định các đối tượng trên Server có thể xử lý thông tin.<br/><br/> Cũng như GET, Server có thể trả về thông tin cho client. Đối với trình duyệt web, thông tin thường là một trang web mới để hiển thị.<br/><br/><br/> <font color='orange'><b>1.2.5. File Upload – PUT </b></font><br/><br/> Các hoạt động PUT cũng cung cấp một cách để client gửi thông tin đến các Server. Hay nói cách khác, PUT dùng để upload dữ liệu lên server.<br/><br/> Như hình dưới cho thấy, hai hoạt động nhìn rất giống nhau. Với POST, Client gửi bao gồm một URI và dữ liệu. Web Server về mã trạng thái, tuỳ chọn kèm theo và dữ liệu. Sự khác biệt giữa POST và PUT ở chỗ URI : Với POST, các URI xác định một đối tượng trên Server mà có thể xử lý dữ liệu. Với một PUT, các URI xác định đối tượng trong đó các Server nên đặt dữ liệu (ví dụ đường dẫn cho Server đặt dữ liệu).<br/><br/> Trong khi một POST URI thường chỉ ra một chương trình, script.. thì PUT uri thường là đường dẫn và tên cho tập tin.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/10.jpg' border="0" /></div><br/> Hình 1.9 Hoạt động PUT của HTTP<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/11.jpg' border="0" /></div><br/> Hình 1.10 Ví dụ về File Upload - PUT<br/><br/> <font color='orange'><b>1.2.6. File Deletion – DELETE </b></font><br/><br/> Với GET và PUT, giao thức HTTP trở thành một giao thức chuyển file đơn giản. Hoạt động DELETE sẽ hoàn thành chức năng này bằng cách giúp client xoá các đối tượng, tài nguyên từ các server.<br/> Như hình dưới cho thấy, client gửi một thông điệp DELETE cùng với các URI của đối tượng mà server nên xoá. Các server đáp ứng với một mã trạng thái và dữ liệu kèm theo.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/12.jpg' border="0" /></div><br/> Hình 1.11 Hoạt động File Delection - DELETE<br/><br/> <b><font color='orange'>1.2.7. Trạng thái - HEAD</font></b><br/><br/> Các hoạt động của HEAD giống như GET, ngoại trừ Server không trả lại đối tượng thực tế yêu cầu. Cụ thể, server sẽ trả về một mã trạng thái nhưng không có dữ liệu. (HEAD có nghĩa là "tiêu đề," nghĩa là server chỉ trả về thông điệp chứa tiêu đề chứ không chứa dữ liệu) .<br/> Client có thể sử dụng thông điệp HEAD khi muốn xác minh rằng một đối tượng có tồn tại hay không,.<br/><br/> Ví dụ: Có thể sử dụng thông điệp HEAD để đảm bảo liên kết đến một đối tượng hợp lệ mà không tiêu tốn băng thông.<br/> Cache trong trình duyệt cũng có thể sử dụng thông điệp HEAD để xem một đối tượng đã thay đổi hay không, nếu không thay đổi thì hiển thị thông tin đã được lưu trước đây, nếu thay đổi thì sẽ thực hiện GET để lấy dữ liệu về từ Server<br/><br/><br/> <font size='+1'><b><font color='orange'>1.3. Thông điệp HTTP</font></b></font><br/><br/> Các phần trước đã trình bày hoạt động của HTTP, và chúng ta đã xem xét từng thông điệp cụ thể. Không giống như các giao thức truyền thông khác, các thông điệp HTTP chủ yếu là các văn bản tiếng Anh. Thay vì lo lắng về các bit và byte, trong phần này chúng ta xem xét những từ mà HTTP định dạng.<br/> Phần này sẽ trình bày cấu trúc tổng thể của thông điệp HTTP. Chúng ta sẽ thấy, một thông điệp HTTP bắt đầu với một “line” hay một mã trạng thái, có thể được theo sau bởi các tiêu đề (header) khác nhau và phần thân (body) của thông điệp.<br/><br/> <font color='orange'><b>1.3.1. Cấu trúc của thông điệp HTTP</b></font><br/><br/> HTTP có hai tác nhân là client và server. Các client gởi yêu cầu (request) và server trả lời (response). Vì vậy, chúng ta sẽ phân tích hai thông điệp chính là HTTP Requests và HTTP Responses.<br/><br/> <font color='orange'><b>a. HTTP Request </b></font><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/13.jpg' border="0" /></div><br/> Hình 1.12 Cấu trúc thông điệp HTTP Request<br/><br/> Hình trên cho thấy cấu trúc cơ bản của HTTP Requests. Một HTTP Requests. bắt đầu bởi Request-Line. Request-Line có thể được theo sau bởi một hoặc nhiều header và body.<br/> Để cụ thể hơn, hình bên dưới cho thấy một thông điệp http (dưới dạng văn bản) do Internet Explorer của Microsoft gửi khi người dùng truy cập vào trang www.ft.com. Dòng đầu tiên là Request-Line, và tiêu đề thông điệp tạo nên phần còn lại của văn bản.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/14.jpg' border="0" /></div><br/> Hình 1.13 Một ví dụ về nội dung thông điệp HTTP<br/><br/> Hình dưới phân tích cụ thể hơn Request-Line, bao gồm 3 phần: Method – phương thức của thông điệp, URI, và Version- phiên bản của HTTP<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/15.jpg' border="0" /></div><br/> Hình 1.14 Ví dụ cụ thể về Request-Line<br/><br/> Phương thức (method) cụ thể xuất hiện đầu tiên trong Request-Line. Trong ví dụ trên đây là một phương thức GET<br/> Mục tiếp theo trong Request-Line là Request-URI. Request-URI chứa nguồn tài nguyên cần truy cập. Trong ví dụ trên, Request-uri là (/), chỉ ra một yêu cầu đối với các nguồn tài nguyên gốc. Phần cuối cùng của Request-Line là phiên bản HTTP. Như ví dụ trên cho thấy, HTTP phiên bản 1.1.<br/><br/> <font color='orange'><b>b. HTTP Response:</b></font><br/><br/> Request Resonse bắt đầu bởi Status-Line (dòng mã trạng thái). Sau đó là phần thông tin của Header và một dòng trắng. Cuối cùng là phần body.<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/16.jpg' border="0" /></div><br/> Hình 1.15 Cấu trúc thông điệp HTTP Response<br/><br/> Status-Line bắt đầu bởi số phiên bản của HTTP (trường hợp này là HTTP/1.1), sau đó là mã trạng thái(trường hợp này là 200 OK)<br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/17.jpg' border="0" /></div><br/> Hình 1.16 Cụ thể trường Status-Line<br/><br/> <font color='orange'><b>1.3.2. Các trường trong HTTP header</b></font><br/><br/><br/> <br>
<div align="center" class="limitview"><img src='http://i483.photobucket.com/albums/rr193/buitanviet/shareforum/phan1/18.jpg' border="0" /></div><br/> Hình 1.17 Ví dụ về HTTP header<br/><br/> Như chúng ta đã thấy ở các phần trước, HTTP Request và HTTP Response có thể bao gồm một hoặc nhiều thông điệp header (message header). Message header bắt đầu với một tên trường và dấu hai chấm (:).<br/> Như ví dụ trên, các Message header là Accept: , Accept-Language…<br/><br/> Trong HTTP header có rất nhiều trường đảm nhận các tính năng, mục đích khác nhau. Bài viết này chỉ mang tính giới thiệu nên sẽ không trình bày. Các bạn có thể tham khảo ở<span class="link"> http://tools.ietf.org/html/rfc2068</span><br/><br/> <font color='orange'><b>Kết thúc phần 1</b></font><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/44.html">Người tìm việc - Việc tìm người</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38345.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38345/236668.html#236668,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Có khi nào nhân viên của anh <b>vikjava</b> và nhân viên của anh <b>gamma95</b> "giao lưu " với nhau không nhỉ <img src="/hvaonline/images/smilies/6a0fe32c3736658bde52846b7df05e01.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38532.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38532/236420.html#236420,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">EithreE wrote:</cite><br>
<blockquote><br/> POST là phương thức trong PHP, cũng như GET. <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"><br/> Em gà chỉ biết thế. <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">&nbsp;
</blockquote><br/><br/> POST là một trong các phương thức của giao thức HTTP. Còn nhiều phương thức khác như GET, PUT, HEAD....<br/><br/> Khi bạn đăng ký, ấn submit là trình duyệt sẽ thực hiện POST, gởi thông tin lên máy chủ web của đối phương. Nếu thông tin bạn điền vào là "Hợp lệ" thì đăng ký thành công, máy chủ sẽ gởi về code trạng thái (200) và kèm dữ liệu để hiển thị thông báo cho bạn.<br/><br/> Vì vậy, muốn "Hợp lệ" thì phải điền capcha đúng, mà muốn không điền capcha mà đăng ký được thì... gọi là vượt capcha <img src="/hvaonline/images/smilies/2e4dbae43873d9c4000502fac3c29d73.gif" border="0" alt="smilie" align="absbottom"> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38394.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38394/236009.html#236009,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cảm ơn anh rongchaua.<br/> Kết quả vẫn như vậy anh à, nếu rules như trên thì nó sẽ direct qua<br/> http://svrcn.vncert.vn%{TX.x}”<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38394.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38394/235914.html#235914,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Dạ, vẫn không được chú à. cháu xin lỗi về đoạn log trên cháu thử sửa rule %{TX.1} thành %{TX.0} thử<br/> SecRule REQUEST_URI “^/download/(.*)$” “phase:1,capture,chain, wwwect:http://svrcn.vncert.vn/download/<font color='red'>%{TX.0}</font>”<br/><br/> Và nó ghi log là<br/><br/> [9] Resolved macro <font color='red'>%{TX.0}</font>to "/download/exam.rar"<br/><br/> Nếu rule là %{TX.1}<br/><br/> SecRule REQUEST_URI “^/download/(.*)$” “phase:1,capture,chain, wwwect:http://svrcn.vncert.vn/download/<font color='red'>%{TX.1}</font>”<br/><br/> Thì nó sẽ ghi log là<br/><br/> [9] Resolved macro<font color='red'> %{TX.1}</font> to "/download/exam.rar"<br/><br/> Và link direct vẫn là<span class="link"> http://svrcn.vncert.vn/download/{TX.1}</span><br/><br/> Về lý thuyết thì sách cũng nói đúng như chú nói. Nhưng thực tế lại không thực hiện được. <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom"> . Cháu cũng thử hết các trường hợp nhưng cũng không có kết quả</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38394.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38394/235881.html#235881,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Cảm ơn chú rất nhiều.. Cháu đã tìm ra nguyên nhân sau khi enable debug logging. Nguyên nhân bới cháu vô tình xoá đoạn khai báo GEO database<br/> <b>SecGeoLookupDb &quot;/usr/local/geoip/GeoIP.dat&quot;</b><br/><br/> Rule đã thực hiện chuyển hướng link được, nhưng cháu lại gặp vấn đề ở phần màu đỏ mà chú thắc mắc từ trước.<br/><br/> <blockquote><br/> SecRule REQUEST_URI “^/download/(.*)$” “phase:1,capture,chain, wwwect:http://svrcn.vncert.vn/download/<font color='red'>%{TX.1}</font>”<br/> SecRule REMOTE_ADDR “@geoLookup” “chain”<br/> SecRule GEO:COUNTRY_CODE “@streq CN”&nbsp;
</blockquote><br/><br/> Vd cháu truy cập vào link<span class="link"> http://vncert.vn/download/exam.zip</span> thì link tự động chuyển sang<span class="link"> http://svrcn.vncert.vn/download/</span><font color='red'>%{TX.1}</font> chứ không wwwect sang<span class="link"> http://svrcn.vncert.vn/download/</span><font color='red'>exam.zip</font><br/><br/> Còn đây là log<br/><br/> [9] Target value: &quot;VN&quot;<br/> [6] Ignoring regex captures since &quot;capture&quot; action is not enabled.<br/> [4] Operator completed in 16 usec.<br/> [9] Resolved macro %{TX.0} to &quot;/download/exam.rar&quot;<br/> [4] Rule returned 1.<br/> [9] Match, intercepted -&gt; returning.<br/> [1] Access denied with wwwection to<span class="link"> http://svrcn.vncert.vn/download/%{TX.1}</span> using status 302 (phase 1). Pattern match &quot;CN&quot; at GEO:COUNTRY_CODE. [file &quot;/etc/httpd/conf.d/modsecurity.conf&quot;] [line &quot;59&quot;]<br/><br/> Cháu 2 dòng log khả nghi là<br/> <font color='yellow'>[6] Ignoring regex captures since &quot;capture&quot; action is not enabled</font>. Nhưng cháu thấy <font color='red'>%{TX.1}</font> không có vấn đề gì (TX.0 dùng cho @pm và @pmFromFile, còn lại dùng TX.1 đến TX.9).<br/><br/> Và<br/> Access denied with wwwection to<span class="link"> http://svrcn.vncert.vn/download/%{TX.1}</span> using status 302 (phase 1). Pattern match &quot;CN&quot; at GEO:COUNTRY_CODE. [file &quot;/etc/httpd/conf.d/modsecurity.conf&quot;] [line &quot;59&quot;]<br/><br/> Dòng trên cháu không biết vì sao lại Access denied.<br/><br/> Mong chú giúp đỡ.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/38367.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/38367/235801.html#235801,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mình đang dùng Avast - Free - Chất lượng - Nhẹ - Update nhanh <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
						<a href="/hvaonline/posts/listByUser/220642.html">
							<img src="/hvaonline/templates/viet/images/icon_first_page.gif" width="8" height="9" alt="First Page" title="First Page"/>
						</a>
							<a href="/hvaonline/posts/listByUser/0/220642.html">
								<img src="/hvaonline/templates/viet/images/icon_prev_page.gif" width="5" height="9" alt="Page 1" title="Page 1"/>
							</a>
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/220642' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" >1</option>	
								<option value="2" selected="selected">2</option>	
								<option value="3" >3</option>	
								<option value="4" >4</option>	
								<option value="5" >5</option>	
						</select>
						
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/60/220642.html">3</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/90/220642.html">4</a></span>
								<span class="gensmall"><a href="/hvaonline/posts/listByUser/120/220642.html">5</a></span>
						
						<a href="/hvaonline/posts/listByUser/120/220642.html">
							<img src="/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (5)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
