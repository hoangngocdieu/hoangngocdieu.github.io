<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by crazym, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by crazym - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.hva?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.hva">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.hva">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.hva">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.hva">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.hva">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.hva"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.hva">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.hva">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.hva">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.hva', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/232937.hva" name="top" class="maintitle" id="top">Messages posted by: crazym</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/232937.hva"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/232937.hva">Profile for crazym</a> 
            			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/232937.hva">Messages posted by crazym</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246522.hva#246522,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Gói tin sẽ như thế này:<br/><br/> Từ LAN (<font color='red'>SRC: INT</font>;<font color='yellow'> DES: EXT</font>) ===&gt; Di chuyển đến SQUID<br/> lúc này sẽ: (<font color='red'>SRC: INT</font>; DES: SQUID) ===&gt; DNAT để đổi địa chỉ đích thành SQUID và ép chạy sang DMZIF<br/> tiếp tục (SRC: SQUID; <font color='yellow'>DES: EXT</font>) ==== SNAT để đổi địa chỉ nguồn thành EXTIP và địa chỉ đích giữ nguyên<br/> Xuyên suốt có các rule cho phép từ <font color='violet'>INT -- SQUID -- EXT</font>. Cụ thể hoá bằng rule trên vẫn chết là thế nào nhỉ??? Sắp phát khùng rồi</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246520.hva#246520,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Tình hình sau khi nghiên cứu các gợi ý của anh Conmale và các bạn, rule đã đựoc điều chỉnh như sau:<br/><br/> I) Loại bỏ trong TCP_OUT port 80. thêm rule:<br/><br/> <blockquote>1. $IPT -t nat -A PREROUTING -i $INTIF -s $INTNET -p tcp --dport 80 -j DNAT --to $SQUID_BOX:8080&nbsp;
</blockquote><br/> =&gt; Rule này áp dụng đối với traffic đi vào $INTIF (LAN) có port nguồn 80 bất kỳ sẽ phải đổi src thành $SQUID:8080<br/><br/> <blockquote>2. $IPT -t nat -A POSTROUTING -o $DMZIF -s $SQUID_BOX -d $EXTNET -j SNAT --to $DMZIP&nbsp;
</blockquote><br/> =&gt; Tiếp tục đổi địa chỉ nguồn của gói tin đi đến DMZIF(ở đây là SQUID) thành DMZIP<br/> =&gt; Tiếp tục di chuyển, gói tin sẽ đi vào DMZIF để ra EXTIF<br/><br/> <blockquote>3. $IPT -t nat -A POSTROUTING -o $EXTIF -p tcp --dport 80 -j SNAT --to $EXTIP&nbsp;
</blockquote><br/> =&gt; Tiếp tục thay đổi địa chỉ nguồn để gói tin ra ngoài internet<br/><br/> Ngoài các rule trên, bổ sung thêm các rule sau:<br/> <blockquote>4. $IPT -A FORWARD -s $INTNET -d $SQUID_BOX -i $INTIF -o $EXTIF -s $INTNET -d $EXTNET --dport 80 -j ACCEPT&nbsp;
</blockquote><br/><br/> Đã ép được traffic từ LAN đến port 80 bất kì sang SQUID(DMZIF) tuy nhiên client vẫn không thể duyệt web được. <img src="/hvaonline/images/smilies/915344bf9a44319064482ef0ef54f213.gif" border="0" alt="smilie" align="absbottom"> Bế tắc quá <img src="/hvaonline/images/smilies/b4028a94b255f1e2b9bb6e172b05f60b.gif" border="0" alt="smilie" align="absbottom"><br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246358.hva#246358,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Tớ đang thử viết lại. Thank cậu.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246328.hva#246328,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">MickyNQN wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">crazym wrote:</cite><br>
<blockquote>Hôm nay tiến hành thử 3 kiểu:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>| LAN | Eth0&#40;1.40&#41;---------------- Eth0&#40;1.10&#41; | IPTABLE | Eth1&#40;2.100&#41; ------------- | INTERNET |
========
| Eth2&#40;10.10.10.1&#41;
|
| Eth0 &#40;10.10.10.10&#41;
========
| SQUID |
========</pre>
</div><br/><br/><br/> &nbsp;
</blockquote><br/> Xin lỗi bữa trước mình không để ý mô hình của bạn <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom"> Mình correct như sau:<br/><br/> 1: Các gói tin qua eth0 được DNAT tới SQUID.<br/> 2: Cho phép các gói tin này được chuyển tiếp giữa eth0 và eth2.<br/> 3: Cho phép SQUID ra ngoài Internet.<br/><br/> Nhìn lại cấu hình SQUID của bạn nữa: <font color='orange'>acl src home_work <b>10.10.10.0/24</b> </font>, home_work ở đây là LAN chứ phải không bạn ??? Sao bạn lại để dải địa chỉ này !<br/><br/> @crazym: Hình như bạn không nhớ địa chỉ và các interface mà cũng không nhìn mô hình khi viết rule thì phải.<br/><br/> &nbsp;
</blockquote><br/> #Tớ có nhớ chứ, vụ home_work thì tớ viết thiếu, phải thêm cả dải của mạng LAN vào nữa <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">, thực ra tớ biết các mục 1),2),3) bạn đề cập cũng như a Conmale nói rồi nhưng cụ thể hoá nó bằng rule thì thật sự không đơn giản. Thank bạn đã giúp đỡ nhé.<br/> P/S: <u><b>1: Các gói tin qua eth0 được DNAT tới SQUID. </b></u>==&gt; Eth0 này là INTIF nhỉ <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> (trên kia có 3 cái Eth0 lận mà).</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246267.hva#246267,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Em hiểu rồi anh ạ. Em cũng không thích và không muốn "xin Rule". Có điều gợi ý này:<br/><br/> <blockquote>Trọng tâm nằm ở chỗ traffic đi từ LAN đến cổng 80 bất kỳ phải đi xuyên qua DMZ_IF thì mới có thể đến SQUID được. Nếu em không có luật nào để ép traffic như vậy thì nó cứ việc đi thẳng ra ngoài EXT_IF chớ chẳng có lý do gì phải đi xuyên qua DMZ_IF hết. Em cần thiết lập thêm luật.&nbsp;
</blockquote><br/><br/> không đơn giản đối với người vừa bắt đầu tìm hiểu để biến nó thành Rule cụ thể. Điều mà các newbie cần là gợi ý sát sườn để cụ thể hoá thành Rule. Em cám ơn anh đã hỗ trợ em. Rất mong trong tương lai tiếp tục nhận đc sự giúp đỡ của anh và các bạn ở đây.<br/><br/> P/S: bài hướng dẫn của anh coi như là một tutorial nên hoàn toàn có thể copy&paste được chứ <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">, có điều cần hiểu rõ toàn bộ đoạn copy&paste đúng không ạ. Thanks anh phát nữa.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246240.hva#246240,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><blockquote>Đây là dạng DMZ thường thấy. Trong trường hợp mô hình mạng không có DMZ, bạn có thể gắn thêm một NIC thứ ba trên firewall và ấn định một IP thuộc subnet khác cho NIC thứ ba này để nối tiếp với squid cache server bằng cross cable. Đây là một dạng 'mini' DMZ thường thấy ở các công ty nhỏ.<br/><br/> Tôi không đi sâu vào chi tiết thiết kế topology ở đây. Những dạng trên chỉ là các gợi ý tổng quát. Điểm chính yếu bạn cần lưu tâm là firewall server và squid cache server phải liên lạc được với nhau trên căn bản nối tiếp.<br/><br/> Giả định squid đang "lắng nghe" trên cổng 8080 của IP 10.10.10.10, trên một server riêng biệt và được kết nối với firewall server xuyên qua cross cable, &nbsp;
</blockquote><br/> Em cứ nghĩ hướng dẫn trên của anh có sử dụng thêm một card IF(eth2) gắn với SQUID, nếu thế thì nó rơi vào trường hợp SQUID nối tiếp với Firewall và ra mạng Internet hoặc SQUID nằm giữa mạng LAN và Firewall.<br/> # Em hiểu ý anh về vấn đê ép lưu thông đến SQUID từ mạng LAN rồi nhưng a gợi ý thêm cho em về RULE đó một chút nữa được không ạ? <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom"><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246191.hva#246191,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Quyết tâm chờ tin các bác.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246158.hva#246158,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hôm nay tiến hành thử 3 kiểu:<br/> # IPTABLES -F: flush hết các rule trong iptables. từ client tiến hành truy cập một website bằng ip thì Access.log của SQUID đã Gen ra.<br/> # Trong RULE của IPTABLES, -P FORWARD ACCEPT chứ không DROP ==&gt; SQUID đã cache,log, truy cập đến web bằng IP thì ok còn domain thì không được?<br/> # Thử tiếp với rule như trên nhưng tại RULE : $IPT -P FORWARD DROP -&gt; ACCEPT --&gt; SQUID tiếp tục GEN ra access.log, tuy nhiên trình duyệt thông báo Access Denied, mặc dù trong cấu hình SQUID đã thực hiện:<br/><br/> acl src home_work 10.10.10.0/24<br/> acl bhour ......<br/> http_access allow home_work bhour<br/><br/> =&gt; tuy nhiên vẫn không truy cập web đựoc<br/> =&gt; Điều đó chứng tỏ ở FORWARD của hệ thống RULE trên có vấn đề.<br/> Em muốn hỏi anh commale chút là em đã thực hiện cấu hình như đúc của anh nhưng vẫn không vào đựoc, liệu các cấu hình trên có cần bổ sung gì thêm không ạ?<br/><br/> Mô hình của em là như thế này<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>| LAN | Eth0&#40;1.40&#41;---------------- Eth0&#40;1.10&#41; | IPTABLE | Eth1&#40;2.100&#41; ------------- | INTERNET |
========
| Eth2&#40;10.10.10.1&#41;
|
| Eth0 &#40;10.10.10.10&#41;
========
| SQUID |
========</pre>
</div><br/><br/> chắc là sẽ khác với cấu hình cho mô hình này :http://www.skullbox.net/squid.php đúng không ạ? Rất mong đựoc sự giúp đỡ của anh và các bạn.<br/> P/S: Hiện tại khi chạy script của firewall, xuất hiện report này:<br/> Using intrapositioned negation (`--option ! this`) is deprecated in favor of extrapositioned (`! --option this`).<br/> Hình như là một bug của IPTABLES?<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/246038.hva#246038,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">crazym wrote:</cite><br>
<blockquote>Theo em hiểu nó sẽ là:<br/><br/> 1) Mọi gói tin đi vào $DMZIF (ở đây là eth2 - tiếp diện SQUID của iptables) và có port đích là 80 (request http) thì được chuyển đến port 8080 của SQUID(eth0). Trong đó DNAT để đổi đích của gói tin(từ nội mạng - INTNET - &quot;là một đích http nào đó&quot<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"> thành IP của SQUID<br/><br/> 2) Mọi gói tin đi ra từ $DMZIF (ở đây là eth2 - tiếp diện SQUID của iptables) có nguồn là nội mạng ($INTNET) và có đích là IF của SQUID sẽ được thay đổi địa chỉ nguồn(SNAT) trước khi chuyển đến $DMZIP.<br/><br/> 3) Theo anh hướng dẫn thì &quot;gói tin từ mạng Lan đến đích mà đích không phải là firewall thì phải qua FORWARD CHAIN&quot; nên cần phải có thiết lập này để chuyển mọi gói tin từ $INTNET đến DMZIF<br/> Như vậy, khi gói tin bắt đầu vào đi vào $INTIF, iptables sẽ check &quot;đích của gói tin&quot; đó. Nếu là http request ---&gt; Bắt đầu đổi đích (ip nào đó) thành IP của SQUID trên port 8080, sau khi đi vào SQUID, SQUID lại đổi nguồn của gói tin này(đang là IP nội mạng --&gt; thành IP SQUID) và đi ra DMZIF.<br/> Đến đây thì em loạn luôn. <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">(.<br/><br/><br/> &nbsp;
</blockquote><br/><br/> Và cái gì khiến cho traffic đi từ LAN đến cổng 80 bất kỳ phải đi xuyên qua DMZIF để buộc phải đến SQUID?&nbsp;
</blockquote><br/><br/> #Theo em hiểu là em chưa có rule này trong cấu hình firewall của em <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">, đúng ko anh?<br/><br/> <p></p>
<cite class="blockquote">MickyNQN wrote:</cite><br>
<blockquote>Mình cũng mới tìm hiểu IPtables. Có gì chưa chuẩn bạn correct dùm nhé.<br/><br/> Các dòng bạn nói và rule tại chain POSTROUTING (qua External interface của firewall ) cho phép các gói tin từ toàn mạng LAN (PROXY và clients) được ra ngoài mạng.<br/> Bạn Drop dòng đó thì mặc định toàn bộ gói tin từ trong mạng ra ngoài mạng sẽ bị drop tại chain FORWARD.<br/> Nếu bạn muốn kiểm tra thì chỉ việc ACCEPT các gói tin từ PROXY forward qua firewall thôi. Còn mặc định các gói tin từ LAN ra (trừ PROXY) sẽ bị drop.<br/> Nhưng việc này không cần thiết vì rule cho chain PREROUTING đã ép các gói tin tới proxy rồi. Mình không thạo cách đọc tcp dump, bạn cho mình hỏi, mấy dấu hiệu trên là do bạn ping tới domain nào đó hay là bạn duyệt web ? Bởi vì icmp và request port 53 ở ngoài không bị ép đi qua PROXY.&nbsp;
</blockquote><br/> #Dấu hiệu trên khi tớ duyệt web thì tcpdump trên IF của SQUID xuất ra thế bạn a.<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/245948.hva#245948,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Cấu hình của tớ ở trên, bản thân cấu hình này đã là chuẩn của anh Comale rồi nên chưa biết điều chỉnh như thế nào?<br/> Về ý kiến của bạn tớ thử không đựoc rùi, bỏ hết các điều kiện ở dòng 58,63,68 thì client không vào đựoc mạng luôn.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/245930.hva#245930,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Theo em hiểu nó sẽ là:<br/><br/> 1) Mọi gói tin đi vào $DMZIF (ở đây là eth2 - tiếp diện SQUID của iptables) và có port đích là 80 (request http) thì được chuyển đến port 8080 của SQUID(eth0). Trong đó DNAT để đổi đích của gói tin(từ nội mạng - INTNET - &quot;là một đích http nào đó&quot<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"> thành IP của SQUID<br/><br/> 2) Mọi gói tin đi ra từ $DMZIF (ở đây là eth2 - tiếp diện SQUID của iptables) có nguồn là nội mạng ($INTNET) và có đích là IF của SQUID sẽ được thay đổi địa chỉ nguồn(SNAT) trước khi chuyển đến $DMZIP.<br/><br/> 3) Theo anh hướng dẫn thì &quot;gói tin từ mạng Lan đến đích mà đích không phải là firewall thì phải qua FORWARD CHAIN&quot; nên cần phải có thiết lập này để chuyển mọi gói tin từ $INTNET đến DMZIF<br/> Như vậy, khi gói tin bắt đầu vào đi vào $INTIF, iptables sẽ check &quot;đích của gói tin&quot; đó. Nếu là http request ---&gt; Bắt đầu đổi đích (ip nào đó) thành IP của SQUID trên port 8080, sau khi đi vào SQUID, SQUID lại đổi nguồn của gói tin này(đang là IP nội mạng --&gt; thành IP SQUID) và đi ra DMZIF.<br/> Đến đây thì em loạn luôn. <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">(.<br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/245917.hva#245917,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Vẫn đang chờ tin các bác <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/245817.hva#245817,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Liệu có phải nó đã &quot;used&quot; và &quot;transparent&quot; không nhỉ? Vì thực tế khi kiểm tra trên eth2(card nối tiếp với SQUID của IPTABLES) bằng:<br/> #tcpdump -i eth2<br/> thì thấy dấu hiệu gói tin chạy qua đây khi client duyệt web:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>14:21:46.331585 IP6 fe80::76ea:3aff:fe86:22ba.mdns &gt; ff02::fb.mdns: 0 PTR &#40;QM&#41;? 200.1.1.10.in-ddr.arpa.&#40;41&#41;
14:21:46.449230 IP6 fe80::76ea:3aff:fe86:22ba.mdns &gt; ff02::fb.mdns: 0 PTR &#40;QM&#41;? 99.142.148.180.in-addr.arpa. &#40;45&#41;
14:21:47.450055 IP6 fe80::76ea:3aff:fe86:22ba.mdns &gt; ff02::fb.mdns: 0 PTR &#40;QM&#41;? 99.142.148.180.in-addr.arpa. &#40;45&#41;
14:21:48.332715 IP6 fe80::76ea:3aff:fe86:22ba.mdns &gt; ff02::fb.mdns: 0 PTR &#40;QM&#41;? 200.1.1.10.in-addr.arpa. &#40;41&#41;
14:21:49.451613 IP6 fe80::76ea:3aff:fe86:22ba.mdns &gt; ff02::fb.mdns: 0 PTR &#40;QM&#41;? 99.142.148.180.in-addr.arpa. &#40;45&#41;</pre>
</div><br/> Bên hướng SQUID server, TCPDump cũng bắt gói tin như vậy. Tuy nhiên check access_log và cache_log của SQUID lại không có gì???<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/245755.hva#245755,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mô hình của em thế này:<br/><br/> LAN (A) ----- (eth0) iptables(C) (eth1) ----- Internet (D)<br/> ===========||(eth2)<br/> ---------------- ||<br/> ---------------|| squid (B)<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/245754.hva#245754,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">@Conmale: Thanks anh. Bản Squid em install có complied &quot;--enable-linux-netfilter&quot;. Hiện tại Squid đã listen ok ở port 8080.<br/> Có một điều em muốn hỏi, em đã cấu hình như mô hình QUANTA đưa ra, về rule thì gần giống anh hứong dẫn nhưng sau khi cài đặt tất cả xong, Em duyệt client ra mạng internet nhưng cảm thấy vẫn &quot;bình thừong&quot;<br/> và hình như gói tin không bị &quot;ép&quot; chạy qua proxy. Liệu em có làm sai ở đâu không anh? Rất mong hồi âm của anh<br/> ============<br/> Đây là bảng định tuyến<img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">trên firewall Iptables + Trên này em có config DHCP cấp ip cua nội mạng)<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>Kernel IP routing table
Destination Gateway Genmask Flags Metric Ref Use Iface
192.168.2.0 * 255.255.255.0 U 0 0 0 eth1
10.10.10.0 * 255.255.255.0 U 0 0 0 eth2
10.1.1.0 * 255.255.255.0 U 0 0 0 eth0
default 192.168.2.1 0.0.0.0 UG 0 0 0 eth1</pre>
</div><br/> ============<br/> Cấu hình ITABLES RULE:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>#!/bin/sh
IPT=&quot;/sbin/iptables&quot;
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward
INTIF=&quot;eth0&quot;
INTIP=&quot;10.1.1.10&quot;
INTNET=&quot;10.1.1.0/24&quot;
LOIF=&quot;lo&quot;
LOIP=&quot;127.0.0.1&quot;
EXTIF=`/sbin/route | grep -i 'default' | awk '{print$8}'`
EXTIP=`/sbin/ifconfig $EXTIF | grep &quot;inet addr&quot; | awk -F&quot;:&quot; '{print$2}' | awk '{print $1}'`
EXTNET=any/0
DMZIF=&quot;eth2&quot;
DMZIP=&quot;10.10.10.1&quot;
SQUID_BOX=&quot;10.10.10.10&quot;
OK_ICMP=&quot;0 3 4 8 11&quot;
TCP_OUT=&quot;80 110 443 5000 5010 5100 8800 8081&quot;
UDP_OUT=&quot;53&quot;
OK_MAC=&quot;00:23:8b:3d:f1:50&quot;
NOTOK_MAC=&quot;90:FB:A6:90:43<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">4&quot;
HI_PORTS=&quot;1024:65535&quot;
DNS=&quot;208.67.222.222 208.67.220.220&quot;
$IPT -F
$IPT -F -t nat
$IPT -F -t filter
$IPT -F -t mangle
$IPT -t mangle -X
$IPT -t nat -X
$IPT -X
$IPT -Z INPUT
$IPT -Z OUTPUT
$IPT -Z FORWARD
$IPT -P INPUT DROP
$IPT -P OUTPUT DROP
$IPT -P FORWARD DROP
#$IPT -A INPUT -i $INTIF -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
# Allow firewall to access Internet
$IPT -A OUTPUT -o $EXTIF -p tcp -m state --state NEW,ESTABLISH,RELATED -j ACCEPT
$IPT -A INPUT -i $EXTIF -p tcp -m state --state ESTABLISHED,RELATED -j ACCEPT
#Allow client to access FIREWALL
$IPT -A INPUT -i $INTIF -p tcp -s $INTNET -d $INTIP --dport 22 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
$IPT -A OUTPUT -o $INTIF -p tcp -s $INTIP --sport 22 -d $INTNET -m state --state RELATED,ESTABLISHED -j ACCEPT
$IPT -A INPUT -i $LOIF -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
$IPT -A OUTPUT -o $LOIF -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
for dns in $DNS; do
$IPT -A INPUT -i $EXTIF -p udp -s $dns --sport 53 -m state --state RELATED,ESTABLISHED -j ACCEPT
$IPT -A OUTPUT -o $EXTIF -p udp -d $dns --dport 53 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
$IPT -A INPUT -i $EXTIF -p udp -s $EXTNET --sport 53 -d $EXTIP --dport $HI_PORTS -m state --state RELATED,ESTABLISHED -j ACCEPT
$IPT -A OUTPUT -o $EXTIF -p udp -s $EXTIP --sport $HI_PORTS -d $EXTNET --dport 53 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
$IPT -A INPUT -i $INTIF -p udp -s $INTNET --dport 53 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
$IPT -A OUTPUT -o $INTIF -p udp -d $INTNET --sport 53 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
$IPT -A INPUT -i $LOIF -p udp -s $INTNET --dport 53 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
$IPT -A OUTPUT -o $LOIF -p udp -d $INTNET --sport 53 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
done
for icmp in $OK_ICMP; do
$IPT -A FORWARD -p icmp --icmp-type $icmp -i $INTIF -o $EXTIF -s $INTNET -d $EXTNET -j ACCEPT
echo &quot;Allowed ICMP types: $icmp&quot;
done
for ports in $TCP_OUT; do
$IPT -A FORWARD -p tcp -i $INTIF -o $EXTIF -s $INTNET -d $EXTNET --dport $ports -j ACCEPT
echo &quot;Allowed forward port $ports&quot;
done
for ports in $UDP_OUT; do
$IPT -A FORWARD -p udp -i $INTIF -o $EXTIF -s $INTNET -d $EXTNET --dport $ports -j ACCEPT
echo &quot;Allowed forward port $ports&quot;
done
for macs in $OK_MAC; do
$IPT -A FORWARD -p tcp -i $INTIF -o $EXTIF -m mac --mac-source $macs -d $EXTNET --dport 20:22 -j ACCEPT
echo &quot;Allowed forward mac $macs to ftp&quot;
done
for banmac in $NOTOK_MAC; do
$IPT -A FORWARD -p tcp -i $INTIF -o $EXTIF -m mac --mac-source $banmac -d $EXTNET -j REJECT
echo &quot;Banned MAC adddress $banmac is applied&quot;
done
$IPT -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT
$IPT -t nat -A POSTROUTING -o $EXTIF -j SNAT --to $EXTIP
#DANH CHO SQUID
$IPT -t nat -A PREROUTING -i $DMZIF -p tcp -s !$SQUID_BOX --dport 80 -j DNAT --to $SQUID_BOX:8080
$IPT -t nat -A POSTROUTING -o $DMZIF -s $INTNET -d $SQUID_BOX -j SNAT --to $DMZIP
$IPT -A FORWARD -p tcp -s $INTNET -d $SQUID_BOX -i $DMZIF -o $DMZIF --dport 8080 -j ACCEPT
$IPT -A INPUT -i $INTIF -j LOG --log-prefix &quot;BAD_INPUTS: &quot;
$IPT -A INPUT -i $INTIF -j DROP
$IPT -A OUTPUT -o $EXTIF -j LOG --log-prefix &quot;BAD_OUTPUTS: &quot;
$IPT -A OUTPUT -o $EXTIF -j DROP
$IPT -A FORWARD -i $INTIF -o $EXTIF -j LOG --log-prefix &quot;BAD_FORWARD_OUT: &quot;
$IPT -A FORWARD -i $INTIF -o $EXTIF -j DROP
$IPT -A FORWARD -i $EXTIF -o $INTIF -j LOG --log-prefix &quot;BAD_FORWARD_IN: &quot;
$IPT -A FORWARD -i $EXTIF -o $INTIF -j DROP</pre>
</div><br/> ====================================================<br/> Cấu hình SQUID:<br/> Hiên tại đang defaule, em chỉ để mỗi:<br/> http_port 8080 transparent<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/245674.hva#245674,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Lại phải up cái bài này lên.<br/> khi cấu hình Squid theo mô hình như Quanta &quot;vẽ&quot; ở trên, tớ config Squid như hướng dẫn của anh Commale nhưng xuất hiện lỗi như sau:<br/><br/> parseConfigFile: unrecognized 'httpd_accel_host virtual'<br/> parseConfigFile: unrecognized 'httpd_accel_port 80'<br/> parseConfigFile: unrecognized 'httpd_accel_with_proxy on'<br/> parseConfigFile: unrecognized 'httpd_accel_uses_host_header on'<br/><br/> Squid 2.7 stable9 cài trên DEBIAN SQZ:<br/> + Các cài đặt thì apt-get install squid<br/> + Vào config thêm các dòng trên của Anh Commale và thêm cái visible_hostname thôi.<br/><br/> Đọc một số hướng dẫn và comment:<br/> http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=377950 -&gt; ở đây nói là bị bug ở versions trước 2.6<br/> We believe that the bug you reported is fixed in the latest version of squid<br/> + Mặc dù đã điều chỉnh như: http_port 8080 transparent nhưng khi restart services Squid vẫn bị thông báo lỗi như trên.<br/> Ý nghĩa của các thông số trên:<br/> + httpd_accel_host virtual: Squid will use the request header information to figure out what server the user wants to access and Squid will behave as a web server when dealing with the client.<br/> + httpd_accel_port 80 configures Squid to send out requests to origin servers on port 80, even though it may be receiving requests on another port, 3128 for example.<br/> + httpd_accel_with_proxy on allows you to continue using Squid as a traditional proxy as well as a transparent proxy.<br/> + httpd_accel_uses_host_header on tells Squid that it should figure out what server to fetch content from based on the host name found in the header. This option must be configured this way for transparency.<br/><br/> Rất mong đựoc sự hỗ trợ của các bạn.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/29559.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/29559/244492.hva#244492,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Diễn đàn bảo trì lâu quá không pm được.<br/> Nói như Secmask đây không phải là Sync flood vậy thì nó là một kiểu attack gì? Hay là giả mạo User-agent.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/29559.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/29559/244427.hva#244427,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Tớ hiểu ý Secmask rồi và cũng biết là SYNC flood attack sẽ chỉ có các kết nối chưa hoàn thành. Vậy:<br/><br/> #Phía máy Attack(1 client):<br/><br/> TCP ***-xp:1930 10.1.1.60:http SYN_SENT<br/> TCP ***-xp:1931 10.1.1.60:http SYN_SENT<br/> TCP ***-xp:1932 10.1.1.60:http SYN_SENT<br/> TCP ***-xp:1933 10.1.1.60:http SYN_SENT<br/> TCP ***-xp:1934 10.1.1.60:http SYN_SENT<br/><br/> #Phía máy server:<br/><br/> C:\Documents and Settings\home&gt;netstat -a | find /C &quot;TIME_WAIT&quot;<br/> 1345<br/> Nếu nói không liên quan nhau sau số TIME_WAIT lên vùn vụt vậy và phải chăng tool tớ đang test không phải là SYNC flood, thôi tớ đưa link tool luôn nhé<span class="link"> http://www.mediafire.com/?giykj25zizg</span>)<br/> ===============================<br/> Một ít log apache server.<br/> ===============================<br/> 10.1.1.101 - - [29/Jul/2011:09:04:42 +0700] &quot;GET / HTTP/1.1&quot; 500 626 &quot;-&quot; &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT<br/> 5.1; .NET CLR 1.0.3705)&quot;<br/> 10.1.1.101 - - [29/Jul/2011:09:04:42 +0700] &quot;GET / HTTP/1.1&quot; 500 626 &quot;-&quot; &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT<br/> 5.1; .NET CLR 1.0.3705)&quot;<br/> 10.1.1.101 - - [29/Jul/2011:09:04:42 +0700] &quot;GET / HTTP/1.1&quot; 500 626 &quot;-&quot; &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT<br/> 5.1; .NET CLR 1.0.3705)&quot;<br/> =&gt; &quot;GET / HTTP/1.1&quot; 500 626 &quot; =&gt; Cái này do mình chặn bằng mod_security (SecRule Request header) vì mình nghĩ nó fake USER-AGENT<br/><br/> Đoạn này thực sự là tớ rối lắm, Secmask nếu rảnh thì hướng dẫn cụ thể tớ phát nhé.<br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/29559.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/29559/244404.hva#244404,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">secmask wrote:</cite><br>
<blockquote>@crazym: Vấn đề bạn test thử sync flood và TIME_WAIT có vẻ không ăn nhập với nhau lắm.<br/> sync flood thông thường thì bạn chỉ cần enable sync cookie lên là được rồi, TIME_WAIT thì kết nối đã hình thành rồi, không còn liên quan đến sync flood nữa, TIME_WAIT khoảng 1000 như của bạn nhưng nếu ổn định không tăng và hệ thống vẫn chạy thông suốt thì không cần phải lo lắng.&nbsp;
</blockquote><br/><br/> @Secmask: Tớ đã enable SynAttackProtect lên rồi nên mới giảm xuống ý chứ. Bạn Secmask giải thích hộ tớ phát này cái.<br/> =&gt;TIME_WAIT thì kết nối đã hình thành rồi =&gt; cái này chuẩn<br/> =&gt; không còn liên quan đến sync flood nữa =&gt; là sao? Không liên quan tức là &quot;SYN flood cứ đến&quot; và &quot;TIME_WAIT&quot; sinh ra nhiều là 2 vấn đề khác nhau à?<br/> Vì tại máy client tớ test vẫn bắn ầm ầm vào server và lượng TIME_WAIT cứ vọt lên xuống liên tục. Nếu có gì chưa đủ thì góp ý tớ nhé.<br/><br/><br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/29559.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/29559/244287.hva#244287,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">mfeng wrote:</cite><br>
<blockquote>TIME_WAIT là trạng thái cuối cùng của một kết nối tcp trước khi đóng kết nối chủ động (chủ động gửi FIN). Hiện tượng nhiều TIME_WAIT thực ra không phải lỗi của OS hay TCP/IP stack mà nguyên nhân thường bắt nguồn từ tốc độ mở socket mới quá nhanh so với tốc độ giải phóng socket: mỗi socket sẽ đợi ở tình trạng TIME_WAIT 1 khoảng thời gian là 2 *MSL (thông thường là 120s, trên CentOS là 60s).<br/><br/> Để khắc phục vấn đề này có các hướng sau:<br/> - Điều chỉnh tcp/ip stack nhằm giảm thời gian time_out để đóng socket time_wait và tái sử dụng socket: như quanta và secmask đang làm.<br/><br/> - Xem xét ở tầng app xem tại sao client sinh ra nhiều socket tới server tới vậy (thường là do lỗi lập trình). Ở đây là kết nối http, thử xem xét vấn đề về keep-alive để tiết kiệm số sockets xem sao.<br/><br/> - Search google: có một số giải pháp ở tầng TCP hoặc HTTP cho phép chủ động đóng bớt TIME_WAIT (Client chủ động gửi RST; thêm method CLOSE ở giao thức HTTP), nhưng có vẻ là khó triển khai với trường hợp này.<br/> &nbsp;
</blockquote><br/> Sory vì mình có *khơi* vấn đề này lên. Hệ thống của mình run webserver Apache trên w2003. Với ipfw và mod_security được build cùng. Mình test thử bằng SYN Flood tool mà chỉ với 2 client thôi, server của mình đã vọt lên 7-10%cpu, socket time_wait lên tới vài nghìn (2000-3000) (không ngờ server thảm thế).<br/> Mình đã điều chỉnh theo các hướng:<br/> + Giảm time_out -&gt; vẫn bị<br/> + Điều chỉnh trên OS:<span class="link"> http://technet.microsoft.com/en-us/library/cc938209.aspx</span> theo phương pháp enable SynAttackProtect -&gt; Vẫn bị<br/> + Trên ipfw có cách limit connection/ip(tớ cũng đã làm) nhưng cũng chỉ là phương pháp thiếu chủ động, dù có giảm xuống 4-8 connection/ip nhưng nếu clientAttack tăng lên thì vẫn die?<br/> Bạn Mfeng và các AE hỗ trợ mình phát này với nhé. Thanks.<br/> P/S: Sory AE vì trong phân mục cho Linux mà hỏi về windows vì vấn đề này giống với tình trạng tớ đang gặp quá.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/235001.hva#235001,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Thanks Quanta nhiều nhiều. Vậy là đầu óc thông thoáng hơn rùi. he he.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/234995.hva#234995,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Thanks Quanta nhiều.<br/><br/> - Tớ biết cái tớ hỏi không thuộc phạm trù trong bài viết của anh Conmale <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> nhưng tớ tìm hiểu thêm một tí thôi.<br/><br/> - nếu gói tin đi từ mạng LAN đến điểm đích mà đích này không phải là firewall chúng ta đang thiết lập thì gói tin này phải đi qua FORWARD chain.<br/> ===&gt; Câu này mở mang được nhiều vấn đề rồi.<br/><br/> Nhưng Quanta cho tớ hỏi thêm câu nữa, đúng là gói tin từ mang LAN đến điểm đích mà đích không phải là firewall(nằm giữa) thì gói tin phải đi qua FORWARD chain, vậy những INPUT chain và OUTPUT chain thì có ảnh hưởng đến gói tin đi qua FORWARD chain không? Vì tuy nó là đi từ A -&gt; C, nhưng nó vẫn phải input vào B rồi output ra C. Hay iptables đã ấn định với gói tin dạng như thế sẽ chỉ đi qua FORWARD chain thôi.<br/><br/> Có gì mở mang cho tớ đoạn này với nhé. Sory vì hỏi hơi ngu tí. Thanks Quanta phát nữa.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/234979.hva#234979,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Quanta không trả lời post của mình với nhỉ. Mình đang bí đoạn này bạn ơi. Mô hình của mình không có Squid <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/25676.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/25676/234889.hva#234889,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Bài lâu quá rồi nhưng anh Conmale và các bạn cho em hỏi:<br/> + Em muốn từ EXTNET ssh vào webserver(INTNET) đặt sau firewall Iptables thì rules phải như thế nào ạ? Rules này em áp dụng nhưng không được.<br/><br/> $IPT -A INPUT -i $EXTIF -p tcp -s $EXTNET -d $INTIP --dport 22 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT<br/> =&gt;Mọi gói tin đi vào $EXTIF từ mạng $EXTNET đến đích là $INTIP(ip của webserver trong nội mạng) với port là 22 thì được phép<br/><br/> $IPT -A OUTPUT -o $EXTIF -p tcp -s $INTIP --sport 22 -d $INTNET -m state --state RELATED,ESTABLISHED -j ACCEPT<br/><br/> $IPT -A FORWARD -s 0/0 -i $INTIF -p tcp -o $EXTIF -d 192.168.0.xxx --sport 22 -j ACCEPT<br/> Rất mong được anh giúp đỡ.<br/> Em cám ơn ạ.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.hva">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/5463.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/5463/234281.hva#234281,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Dạo này có một xu hướng mới rất lạ trong việc quản lí web và network là thảo luận và ứng dụng rất nhiều về Iptables, <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">. Đặc biệt chuyên dùng để test. Lạ quá chăng?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/37997.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/37997/234280.hva#234280,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Một số link bạn có thể tham khảo:<br/><br/> http://vnexperts.net/bai-viet-ky-thuat/nix/793-vi-d-v-cach-cu-hinh-iptables.html<br/> http://congdongit.org/linux-unix/1215-cau-hinh-cho-iptables-firewall.html<br/><br/> Đặt biệt là:<br/> http://www.hvaonline.net/hvaonline/posts/list/105.hva<br/> http://www.hvaonline.net/hvaonline/posts/list/154.hva<br/> http://www.hvaonline.net/hvaonline/posts/list/25676.hva<br/> Các tiểu tiết khác như làm thế nào để chạy script rules cho iptables thì chắc là bạn biết rùi. Chúc thành công.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/37997.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/37997/234279.hva#234279,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Mô hình như bạn thì cũng ko quá khó để thực hiện nhưng đòi hỏi phải đọc qua tài liệu về Routing và iptables.<br/> Tớ góp ý thế này(dựa theo kinh nghiệm từ các bác ở đây hướng dẫn):<br/> #Bạn có 2 mạng:<br/> 192.168.1.0/24(INTNET)<br/> 172.16.1.0/24(EXTNET)<br/> Yêu cầu đặt ra, máy ở EXTNET có thể truy cập các dịch vụ tại máy cài dịch vụ ở INTNET.<br/> Đầu tiên phải cho 2 mạng thông nhau tức là bạn phải NAT để 2 mạng "nhìn thấy nhau". Sau đó<br/> mới tính chuyện truy cập dịch vụ này, dịch vụ kia. Vậy tìm hiểu về NAT bằng iptables đi nhá.<br/> Thân</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/37953.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/37953/233331.hva#233331,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Em hiểu ý anh rồi. Thanks anh rất nhiều.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/37953.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/37953/233327.hva#233327,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Không biết là câu hỏi của mình dở hơi, hay ntn mà dù view 75 nhưng không một ai comment trả lời cả. Mình biết hvaonline là nơi giúp đỡ trao đổi nhau rất tận tình nên mình post bài lên đây để được các bạn hỗ trợ.<br/> Hi vọng bài post này đến tay được mod hoặc admin.<br/><br/> Thực ra mình ko cần phải chỉ dẫn từng câu lệnh, cái mình cần là các bạn có thể giải thích mình sẽ phải làm ntn, cần những gì để cấu hình được như thế! Thanks all.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/24.hva">Thảo luận hệ điều hành *nix</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/37953.hva">Empty</a></span>
				<span class="topmenu"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/37953/233269.hva#233269,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Up lên cho các bác giúp đỡ </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/232937' + '.hva'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" selected="selected">1</option>	
								<option value="2" >2</option>	
						</select>
						
							<a href="/hvaonline/posts/listByUser/30/232937.hva">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 2" title="Page 2"/>
							</a>
						
						<a href="/hvaonline/posts/listByUser/30/232937.hva">
							<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (2)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
