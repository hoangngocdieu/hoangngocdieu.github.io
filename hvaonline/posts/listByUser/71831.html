<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Messages posted by lama, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Messages posted by lama - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript">
<!--

function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}

-->
</script>

<table cellspacing="0" cellpadding="10" width="98%" align="center" border="0">
	<tr>
		<td class="bodyline">
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					<td valign="middle" align="left" colspan="2">
						<span class="maintitle"><a href="/hvaonline/posts/listByUser/71831.html" name="top" class="maintitle" id="top">Messages posted by: lama</a></span>
						&nbsp;<a href="/hvaonline/rss/showPostsByUser/71831.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML" /></a>
					</td>
				</tr>
			</table>
			
			<table cellspacing="2" cellpadding="2" width="100%" border="0">
				<tr>
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						<a href="/hvaonline/user/profile/71831.html">Profile for lama</a> 
            			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"><a href="/hvaonline/posts/listByUser/71831.html">Messages posted by lama</a>
						</span>
					</td>
										
					<td valign="middle" align="right">
						<span class="nav">[ number of posts not being displayed on this page: <span class="moderator">0</span> ]</span>
					</td>
				</tr>
			</table>

			
      <table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0">
        <tr>
          <th height="26" nowrap="nowrap" class="thleft">&nbsp;</th>
        </tr>

				
        <!-- POST LISTING -->
         
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/40309.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/40309/248626.html#248626,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">.lht. wrote:</cite><br>
<blockquote>Bạn không truy cập được vào google.com.vn, bạn thử truy cập vào 1 số domain google của quốc gia khác xem ?<br/><br/> google.com.ph<br/> google.de<br/> ...<br/> &nbsp;
</blockquote><br/><br/> Các địa chỉ trên thì lại được. Như vậy nguyên nhân do đâu vậy bạn có biết không ?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/40309.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/40309/248606.html#248606,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hi,<br/><br/> Máy của mình tự nhiên không vào được www.google.com.vn. Hễ cứ vào là nó đều kêu download file là google_com_vn. Mình đã thử với trình duyệ IE, Chrome đều tương tự.<br/><br/> Các máy khác trong mạng vẫn vào được bình thường.<br/> Mình thử gán DNS trên máy mình lại là 8.8.8.8, flushdns và phân giải thử địa chỉ google.com.vn, google.com, yahoo.com thì thấy ra kết quả với đuôi là domain của mình (google, yahoo hay bất cứ domain nào cũng vậy.Thật là lạ.<br/> Mình check thử file host trên máy mình thì thấy bình thường, không có record lạ nào. Mà mặc dù phân giải vậy nhưng yahoo.com vẫn vào được, chỉ có google.com.vn là đòi download file, không cho vào.<br/><br/><br/> Gán lại DNS của công ty kiểm tra thì không bị tình trạng add thêm domain như trên khi phân giải, tuy nhiên vào trang google.com.vn vẫn bị lỗi download.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>C:\Users\nguyennp&gt;nslookup
Default Server: google-public-dns-a.google.com
Address: 8.8.8.8
&gt; yahoo.com
Server: google-public-dns-a.google.com
Address: 8.8.8.8
Non-authoritative answer:
Name: yahoo.com.mydomain.com
Address: 222.239.76.238</pre>
</div><br/><br/> Vào Proxy của IE, Chrome thì thấy không có gì lạ.<br/><br/> Vậy bạn nào có bị tình trạng như trên không, có thể chia sẻ không ?<br/><br/> Có phải máy mình nhiễm virus ?<br/><br/> Mình cài chương trình quét Virus và nó luôn update/chạy nên mình không nghĩ do virus.<br/><br/> Cám ơn các bạn nhiều.<br/><br/> NPN<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21249.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21249/218132.html#218132,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">myquartz wrote:</cite><br>
<blockquote>Bạn check xem Mdaemon của bạn đã cấu hình đúng để gửi mail theo kiểu gọi là "SmartHost" chưa? Có thể Mdaemon vẫn chạy như bình thường, IP cơ quan bạn là IP động nên Spamhaus nó liệt vào dạng "không gửi mail server-to-server" được. Việc gửi mail đúng ra là phải relay qua SMTP của ISP khi bạn xài mail offline. Nếu chính SMTP của ISP chặn bạn lại, thì bạn phải check lại coi đã thiết lập xác thực chưa (thường cách này để kiểm tra hợp lệ khi gửi mail relay qua ISP), ISP của bạn hỗ trợ ra sao?&nbsp;
</blockquote><br/><br/> Mdaemon mình cấu hình gởi thông qua Hosting (Relay), có Authenticate luôn, xem log thấy gởi transfer completed luôn mà vẫn không tới được.<br/> Liên hệ Hosting thì nó cứ một mực nói là nó không có block IP của mình.<br/><br/> <p></p>
<cite class="blockquote">invalid-password wrote:</cite><br>
<blockquote><br/> Post nguyên văn cái câu log đó lên xem nào, xem nó liệt vào danh sách nào của Spamhaus.<br/> &nbsp;
</blockquote><br/><br/> Giờ thì mình reset IP lại đã gởi được (gởi relay qua Hosting). Nhưng chiều chắc lại gởi không tới (mặc dù xem log là gởi tới, không thấy báo lỗi gì trả về cả).<br/><br/> IP bị liệt kê vào XBL của Spamhaus.org<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21249.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21249/218021.html#218021,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hi,<br/><br/> Vấn đề này mình đã hỏi trước kia, lúc trước là do bị virus. Gần đây bị lại, quét virus không có, mình cài mới lại Windows W2K3SP2 luôn, cài Symantec Endpoint với update mới nhất nhưng vẫn trục trặc.<br/><br/> Thử gởi mail ở 1 mạng khác thì được. Cho mình hỏi lại là :<br/><br/> 1. Hơi ngạc nhiên, vì khi mình gởi mail thông qua Mail Server trên Hosting (mà thằng này thì xịn rồi), liên quan gì đến IP (public, dynamic) của mình ? Sao nó có thể căn cứ vào đó để block không cho email đến được.<br/> --&gt; Mình rất mong được giải thích rõ câu hỏi này, lúc đó thì mới có căn cứ để kiểm tra tiếp được.<br/><br/> 2. Mình đã dùng các tool mà trang Spamhaus này khuyến cáo để diệt mass mail worm nhưng không tìm ra con nào cả. Rồi dùng TCPView để xem, dùng các Tool quét Conficker của Kaspersky, Sophos, Mcafee (Stinger) bản mới nhất quét cũng không thấy gì.<br/><br/> Khi reset lại IP mới thì kiểm tra trong Spamhaus không nằm Blacklist --&gt; gởi được. Xong rồi cũng bị lại.<br/> IP của Mail Server trên Hosting mà mình Relay thì không nằm trong Blacklist.<br/> NCC : www.startlogic.com<br/><br/> Bên Hosting cung cấp dịch vụ tệ quá, support không giải thích được, cứ nói là sao bên nó gởi được mà bên mình gởi không được, vậy liên hệ ISP (FPT) đi. Liên hệ ISP thì nói là reset lại IP cho anh thôi (cũng không thỏa đáng).<br/><br/> Mong ai biết chia sẻ kinh nghiệm kiểm tra và xử lý giúp mình với.<br/><br/> Cám ơn rất nhiều.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/35132.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/35132/216428.html#216428,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hi all,<br/><br/> Rất cám ơn mọi người đã chia sẻ, đóng góp. Xin báo 1 tin vui. Sau khi tham khảo nhiều góp ý trên diễn đàn, mình đã kiểm tra theo hướng nào dễ thực hiện trước, và đã kiểm tra theo hướng DeadLock. Các câu lệnh SELECT đáng lý phải dùng WITH(UNLOCK) --&gt; Cả ngày hôm qua sau khi add code SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED vào Stored Proc để toàn bộ câu lệnch SELECT trong Stored đều sử dụng là WITH(UNLOCK) thì User không phàn nàn chậm như lúc trước nữa. Hy vọng sau khi tối ưu lại các Stored Proc và share bớt trên App nữa thì sẽ càng tốt hơn về performance. Phần tách SQL Server ra riêng có cách nào để mình chứng minh cho các Sếp và đề nghị thay đổi không nhỉ?<br/><br/> Mình cũng đã theo dõi Ổ cứng, Memory, và Network Interface theo hướng dẫn trang <blockquote>www.computerperformance.co.uk&nbsp;
</blockquote> thì hình như là ổ cứng bị overload thì phải. Memory cũng có vấn đề hay sao đó, Mình đã Enable PAE, restart server, gán Permission cho User để Lock Page, rồi Enable AWE lên 4GB, restart SQL nhưng thấy SQL vẫn không sử dụng bao nhiêu RAM (Tổng cộng cứ ở mức 2.3 GB là cao nhất, trong đó SQL sử dụng 1.6GB). Link : <blockquote>http://msdn.microsoft.com/en-us/library/ms190673.aspx&nbsp;
</blockquote><br/><br/> Xem Performance của Memory thì Page Faults/Sec hình như hơi bị nhiều, không biết có phải RAM bị hư không nữa.<br/><br/> Nhờ mọi người tiếp tục giúp đỡ và chia sẻ xem mình có nên thêm ổ cứng và thay RAM không ?<br/><br/> Ổ cứng cho chạy RAID10 chắc OK hơn RAID5 không ? Mình cũng nghĩ đến giải pháp SAN nhưng tốn kém quá, mà không lý nào Server vậy, với vài chục GB database mà chạy không nổi. Hic.<br/><br/> Phần rebuild index thì mình không dám đụng vào dưới SQL vì chương trình có cung cấp công cụ rebuild index và chỉ dám thực hiện trên đó.<br/> Hiện tại với Server cấu hình trên, SELECT 1 bảng có 59 cột, 1triêu2 dòng thì mất 1 phút 20 giây thì có chấp nhận được không nhỉ ?<br/><br/> P/S : Mình có đính kèm file theo dõi Performance của HDD, Memory và Network bên dưới.<br/> <blockquote>http://www.mediafire.com/?c74o54winr338ir&nbsp;
</blockquote><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/35132.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/35132/215997.html#215997,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Rất cám ơn mọi người đã nhiệt tình giúp đỡ, chia sẻ. Nhờ mọi người mà Nguyên sáng ra nhiều điều ( VD lại mới biết là tách SQL Server ra cho chạy 64 bit chẳng hạn, trước giờ cứ trong đầu là App không hỗ trợ thì SQL cũng phải chạy 32bit không à). Nguyên sẽ lần lượt test hết các trường hợp. Hy vọng sẽ có tin vui báo lại sớm.<br/><br/> Tuy vậy, nếu mọi người ai còn có thể chia sẻ gì về vấn đề này cứ tiếp tục chia sẻ nha :-P Tập hợp các chia sẻ này sẻ là 1 kinh nghiệm rất đáng quý cho Nguyên cũng như nhiều anh/em khác.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/35132.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/35132/215984.html#215984,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote>Nhìn chung mấy cái storeproc này có những đoạn query quá rộng (SELECT *) và có quá nhiều sub-queries. Đây là nguyên do tạo ra kém hiệu suất nếu xét trên bình diện truy vấn CSDL. Cách cải thiện là nên tối ưu lại storeproc và nên trao bớt trách nhiệm trên tầng ứng dụng (applications) việc hình thành các query statements cụ thể thay vì phó mặc cho storeproc thực hiện quá nhiều sub-queries.<br/><br/> MSSQL chạy trên nền 32-bit mà phục vụ cho lượng truy vấn cao và nặng thì hoạt động cực kỳ kém. Cách có thể cải thiện trên bình diện này là migrate sang một máy chủ chạy 64-bit và MSSQL 64-bit.&nbsp;
</blockquote><br/><br/> Các câu lệnh SELECT * em thấy là đúng theo nhu cầu mà ? Từ bảng dữ liệu khoảng trăm mấy cột, mình đã select đúng các cột cần đưa vào 1 bảng tạm để xử lý (chắc cũng có vấn đề ở đây, em đang check).<br/><br/> Rất cám ơn anh đã góp ý trao bớt trách nhiệm cho App, so sánh với cách tổ chức của ứng dụng hiện tại (không thấy các stored truy vấn dữ liệu như em nói bên trên) thì chắc đây cũng chính là 1 trong những nguyên nhân chính rồi.<br/><br/> Ứng dụng này hiện tại thì chưa hỗ trợ 64 bit nên em chỉ có thể cài 32 bit thôi.<br/><br/> Thông tin thêm :<br/><br/> Hic, tối qua em thức tới 1h30 chạy trace thử thì thấy với dữ liệu in trong 1 tháng cho 93 mặt hàng thì in khỏang 10 giây à. Nhưng khi chọn in trong 3 tháng thì mất hơn 1 phút, chọn in từ đầu năm đến giờ cho 250 mặt hàng thì chờ hơn 30 phút chưa thấy ra luôn.<br/><br/> Lúc chạy trace và cả Active Monitor thấy thời gian gọi stored proc xảy ra cũng nhanh lắm, lâu thì có vài giây, còn lúc chạy nó có lock không cũng không biết, không thấy tình trạng là LOCKED. Các xử lý trong Active Monitor có Request là LOCK (không phải LOCKED) ngay cả khi thử SELECT 1 bảng đơn giản.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/35132.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/35132/215951.html#215951,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mình post 1 stored proc dùng để Liệt kê các thành phẩm xuất kho. Mỗi ngày có khoảng 200-300 Hoá đơn, mỗi Hoá đơn có khoảng 10 dòng --&gt; khoảng 2000-3000 dòng trong bảng chứa nghiệp vụ xuất kho mỗi ngày (chưa tính nghiệp vụ khác như nhập, chuyển kho (2 nghiệp vụ này ít hơn) .... cũng nằm cúng 1 bảng nghiệp vụ kho này).<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>set ANSI_NULLS ON
set QUOTED_IDENTIFIER ON
go
ALTER PROCEDURE &#91;dbo&#93;.&#91;GL_BK_ThanhPhamXuat&#93;
@Para1 NVARCHAR&#40;20&#41; --@CompID
,@Para2 NVARCHAR&#40;20&#41; --@FYear
,@Para3 NVARCHAR&#40;20&#41; --CustCodeFrom
,@Para4 NVARCHAR&#40;20&#41; --CustCodeTo
,@Para5 NVARCHAR&#40;20&#41; --StockFrom
,@Para6 NVARCHAR&#40;20&#41; --StockTo
,@Para7 NVARCHAR&#40;20&#41; --@FromDate
,@Para8 NVARCHAR&#40;20&#41; --@ToDate
AS
--&#91;GL_BK_ThanhPhamXuat&#93; '01','10','','','M6009','M6009','100420','100426'
SET NOCOUNT ON
BEGIN
---==DECLARE AND INTINITIALIZE THE GLOBAL VARIANCE==--
DECLARE @CompID as NVARCHAR&#40;20&#41;
SET @CompID = @Para1
DECLARE @FYear as NVARCHAR&#40;20&#41;
SET @FYear = @Para2
DECLARE @CustCodeFrom as NVARCHAR&#40;20&#41;
SET @CustCodeFrom = @Para3
DECLARE @CustCodeTo as NVARCHAR&#40;20&#41;
SET @CustCodeTo = @Para4
DECLARE @StockFrom as NVARCHAR&#40;20&#41;
SET @StockFrom = @Para5
DECLARE @StockTo as NVARCHAR&#40;20&#41;
SET @StockTo = @Para6
DECLARE @FromDate as NVARCHAR&#40;20&#41;
SET @FromDate = @Para7
DECLARE @ToDate as NVARCHAR&#40;20&#41;
SET @ToDate = @Para8
DECLARE @SqlStr NVARCHAR&#40;4000&#41;
IF EXISTS &#40;SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbThanhPhamXuat&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbThanhPhamXuat&#93;
IF EXISTS &#40;SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbBangLuuHoaDonChoTPXuat&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbBangLuuHoaDonChoTPXuat&#93;
CREATE TABLE tbBangLuuHoaDonChoTPXuat
&#40;
SoHoaDon nvarchar&#40;50&#41;
&#41;
SET @SqlStr = &quot; INSERT INTO tbBangLuuHoaDonChoTPXuat SELECT &quot;
+&quot; distinct SL03002 from SL03&quot; + @CompID + &quot;00 &quot;
+ &quot; where SL03005 BETWEEN '&quot; + CONVERT&#40;NVARCHAR&#40;10&#41;,convert&#40;datetime,@FromDate&#41;,112&#41; + &quot;'&quot;
+ &quot; AND '&quot; + CONVERT&#40;NVARCHAR&#40;10&#41;,convert&#40;datetime,@ToDate&#41;,112&#41; + &quot;'&quot;
EXECUTE sp_executesql @SqlStr
update tbBangLuuHoaDonChoTPXuat
set SoHoaDon=Replace &#40;SoHoaDon,'R',''&#41;
--select * from tbBangLuuHoaDonChoTPXuat
CREATE TABLE tbThanhPhamXuat
&#40;
MA_KH NVARCHAR&#40;20&#41;
,MA_HANG NVARCHAR&#40;20&#41;
,TEN_HANG NVARCHAR&#40;50&#41;
,QUY_CACH NVARCHAR&#40;100&#41;
,DON_VI_TINH NVARCHAR&#40;50&#41;
,TAI_KHOAN_DU NVARCHAR&#40;50&#41;
,SO_LUONG FLOAT
,DON_GIA_BAN FLOAT
-- ,GIA_VON FLOAT
,THANH_TIEN FLOAT
-- ,THANH_TIEN_VON FLOAT
,MA_KHO NVARCHAR&#40;50&#41;
-- ,TEN_KHO NVARCHAR&#40;50&#41;
-- ,LOAI_NV NVARCHAR&#40;50&#41; bo 5/8/09
-- ,TEN_NV NVARCHAR&#40;50&#41; bo 5/8/09
,SO_DON_HANG NVARCHAR&#40;50&#41;
,SO_HOA_DON NVARCHAR&#40;50&#41;
,GHI_CHU NVARCHAR&#40;50&#41;
,LOAI_NHAP_XUAT NVARCHAR&#40;50&#41;
,TI_LE_CK NVARCHAR&#40;50&#41;
,NGAY_HOA_DON DATETIME
--,SO_LO NVARCHAR&#40;50&#41;
&#41;
SET @SqlStr = &quot; INSERT INTO tbThanhPhamXuat SELECT &quot;
+ &quot; SC07006 AS &#91;MA_KH&#93;&quot;
+ &quot;, SC07003 AS &#91;MA_HANG&#93;&quot;
+ &quot;, SC01002 AS &#91;TÊN_HÀNG&#93;&quot;
+ &quot;, SC01003 AS &#91;QUY_CACH&#93;&quot;
+ &quot;, SC01135 AS &#91;DON_VI_TINH&#93;&quot;
+ &quot;, '' AS &#91;TAI_KHOAN_DU&#93;&quot;
+ &quot;, SC07004 AS &#91;SO_LUONG&#93;&quot;
+ &quot;, ROUND&#40;SC07010,2&#41; AS &#91;DON_GIA_BAN&#93;&quot;
-- + &quot;, SC07005 AS &#91;GIA_VON&#93;&quot;
+ &quot;, 0 AS &#91;THANH_TIEN&#93;&quot;
-- + &quot;, 0 AS &#91;THANH_TIEN_VON&#93;&quot;
+ &quot;, SC07009 AS &#91;MA_KHO&#93;&quot;
-- + &quot;, SC23002 AS &#91;TEN_KHO&#93;&quot;
-- + &quot;, SUBSTRING&#40;SC07012,49,2&#41; AS &#91;LOAI_NV&#93;&quot; bo 5/8/09
-- + &quot;, '' AS &#91;TEN_NV&#93;&quot; bo 5/8/09
+ &quot;, SC07007 AS &#91;SO_DON_HANG&#93;&quot;
+ &quot;, SC07056 AS &#91;SO_HOA_DON&#93;&quot;
+ &quot;, SC07055 AS &#91;GHI_CHU&#93;&quot;
+ &quot;, CONVERT&#40;INT, SC07013&#41; AS &#91;LOAI_NHAP_XUAT&#93;&quot;
+ &quot;, '' AS &#91;TI_LE_CK&#93;&quot;
+ &quot;, '1900/01/01' AS &#91;NGAY_HOA_DON&#93;&quot;
--+&quot;,SC07029 &quot;
+ &quot; FROM SC07&quot; + @CompID + &quot;00 INNER JOIN SC01&quot; + @CompID + &quot;00 ON SC07003 = SC01001&quot;
-- + &quot; INNER JOIN SC23&quot; + @CompID + &quot;00 ON SC07009 = SC23001&quot;
-- + &quot; INNER JOIN SL03&quot; + @CompID + &quot;00 ON SC07056 = SL03002 OR RTRIM&#40;SC07007&#41; + 'R' = SL03002&quot;
+ &quot; WHERE SC07001 = '01'&quot;
+ &quot; AND LEFT&#40;SC07003,1&#41; in &#40; 'A','M'&#41;&quot;
-- + &quot; AND &#40;CONVERT&#40;INT, SC07013&#41; = 49&quot; -- XUAT BAN
-- + &quot; OR &#40;CONVERT&#40;INT, SC07013&#41; NOT IN &#40;66&#41; AND SC07004 &gt; 0&#41;&#41;&quot; --TRA HANG TRONG STOCK ISSUED VOI SO LUONG AM
-- + &quot; AND &#40;CONVERT&#40;INT, SC07013&#41; NOT IN &#40;66&#41; AND SC07004 &gt; 0&#41;&#41;&quot; --TRA HANG TRONG STOCK ISSUED VOI SO LUONG AM
-- + &quot; AND SC07009 BETWEEN '&quot; + @WareCodeFrom + &quot;' AND '&quot; + @WareCodeTo + &quot;'&quot;
-- + &quot; AND SL03005 BETWEEN '&quot; + CONVERT&#40;NVARCHAR&#40;10&#41;,@FromDate,112&#41; + &quot;'&quot;
--+ &quot; AND '&quot; + CONVERT&#40;NVARCHAR&#40;10&#41;,@ToDate,112&#41; + &quot;'&quot;
+&quot; and SC07056 in &#40;select SoHoaDon from tbBangLuuHoaDonChoTPXuat&#41;&quot;
+ &quot; AND SUBSTRING&#40;SC07012,49,2&#41; &lt;&gt; '92'&quot;
--if @CustCodeFrom&lt;&gt;''
--SET @SqlStr =@SqlStr + &quot; and SC07006 between '&quot; +@CustCodeFrom+&quot;' and '&quot;+@CustCodeTo+&quot;'&quot;
--
if @StockFrom &lt;&gt;''
SET @SqlStr =@SqlStr + &quot; and SC07003 between '&quot; +@StockFrom+&quot;' and '&quot;+@StockTo+&quot;'&quot;
SET @SqlStr =@SqlStr + &quot; ORDER BY SC01002&quot;
print @SqlStr
EXECUTE sp_executesql @SqlStr
--SELECT * FROM tbThanhPhamXuat ORDER BY SO_DON_HANG
/*
UPDATE tbThanhPhamXuat
SET THANH_TIEN_VON = SO_LUONG * GIA_VON
*/
SET @SqlStr = &quot; UPDATE tbThanhPhamXuat&quot;
+ &quot; SET SO_HOA_DON = OR20021&quot;
+ &quot; ,TI_LE_CK = OR20051&quot;
+ &quot; ,NGAY_HOA_DON = OR20022&quot;
+ &quot; FROM tbThanhPhamXuat, OR20&quot; + @CompID + &quot;00&quot;
+ &quot; WHERE SO_DON_HANG = OR20001&quot;
EXECUTE sp_executesql @SqlStr
/*
SELECT * FROM tbThanhPhamXuat
WHERE SO_DON_HANG = '0309000040'
*/
UPDATE tbThanhPhamXuat
SET SO_HOA_DON = SO_DON_HANG
WHERE SO_HOA_DON = ''
-----------------------------------
--GIA DUOI KHO KHAC TREN DON HANG--
-----------------------------------
UPDATE tbThanhPhamXuat
SET DON_GIA_BAN = 0
WHERE SO_HOA_DON = '08/0109319'
UPDATE tbThanhPhamXuat
SET DON_GIA_BAN = 368.6
WHERE SO_HOA_DON = '08/083294'
DELETE tbThanhPhamXuat
WHERE SO_DON_HANG = '08/076853' --ĐIỀU CHỈNH HỦY HĐ CỦA THÁNG KHÁC
-----------------------------------
UPDATE tbThanhPhamXuat
SET THANH_TIEN = SO_LUONG * ROUND&#40;DON_GIA_BAN, 2&#41;
SET @SqlStr = &quot; UPDATE tbThanhPhamXuat&quot;
+ &quot; SET GHI_CHU = OR22008&quot;
+ &quot; FROM tbThanhPhamXuat, OR22&quot; + @CompID + &quot;00&quot;
+ &quot; WHERE SO_DON_HANG = OR22001&quot;
EXECUTE sp_executesql @SqlStr
-- SET @SqlStr = &quot; UPDATE tbThanhPhamXuat&quot; -- bo 5/8/09
---- + &quot; SET TEN_NV = GL03003&quot;--, MO_TA = GL03004&quot; -- doan nay
-- + &quot; FROM tbThanhPhamXuat, GL03&quot; + @CompID + @FYear --
---- + &quot; WHERE LOAI_NV = GL03002&quot; --
-- + &quot; AND GL03001 = 'J'&quot; --
--
-- EXECUTE sp_executesql @SqlStr --
---------------------------------------------------
/* Dinh nghia bang tam luu don vi tinh &#40;Unit&#41; */
---------------------------------------------------
IF EXISTS&#40;SELECT name FROM sysobjects WHERE name = 'tbUnitText_ThahPhamXuat'&#41;
DROP TABLE tbUnitText_ThahPhamXuat
DECLARE @dem AS INT
SET @dem = 1
CREATE TABLE tbUnitText_ThahPhamXuat
&#40;
idcol int primary key
,UnitText nvarchar&#40;50&#41;
&#41;
SET @dem = 0
WHILE @dem &lt;= 40
BEGIN
IF @dem &lt;= 7
SET @SqlStr = &quot; INSERT INTO tbUnitText_ThahPhamXuat &quot;
+ &quot; SELECT '&quot; + CONVERT&#40;nvarchar, @dem&#41; + &quot;', SC0900&quot; + CONVERT&#40;nvarchar,&#40;@dem + 2&#41;&#41;
+ &quot; FROM SC09&quot; + @CompID + &quot;00 WHERE SC09001 = 'AME'&quot;
ELSE
SET @SqlStr = &quot;INSERT INTO tbUnitText_ThahPhamXuat &quot;
+ &quot; SELECT '&quot; + CONVERT&#40;nvarchar, @dem&#41; + &quot;', SC090&quot; + CONVERT&#40;nvarchar,&#40;@dem + 2&#41;&#41;
+ &quot; FROM SC09&quot; + @CompID + &quot;00 WHERE SC09001 = 'AME'&quot;
EXECUTE sp_executesql @SqlStr
SET @dem = @dem + 1
END
UPDATE tbThanhPhamXuat
SET DON_VI_TINH = UnitText
FROM tbThanhPhamXuat, tbUnitText_ThahPhamXuat
WHERE DON_VI_TINH = idcol
SET @SqlStr = &quot; UPDATE tbThanhPhamXuat&quot;
+ &quot; SET TAI_KHOAN_DU = SUBSTRING&#40;SL04006, 1, 4&#41;&quot;
+ &quot; FROM tbThanhPhamXuat, SL04&quot; + @CompID + @FYear --CO DINH MA CONG TY, NAM TAI CHINH
+ &quot; WHERE SO_HOA_DON = SL04013&quot;
+ &quot; AND LEFT&#40;SL04006,4&#41; IN &#40;'5112', '5122', '5312','5111'&#41;&quot;
EXECUTE sp_executesql @SqlStr
SET @SqlStr = &quot; UPDATE tbThanhPhamXuat&quot;
+ &quot; SET TAI_KHOAN_DU = SUBSTRING&#40;GL06001, 1, 4&#41;&quot;
+ &quot; FROM tbThanhPhamXuat, GL06&quot; + @CompID + @FYear --CO DINH MA CONG TY, NAM TAI CHINH
+ &quot; WHERE SO_HOA_DON = GL06007&quot;
+ &quot; AND LEFT&#40;GL06001,4&#41; IN &#40;'5112', '5122', '5312','5111'&#41;&quot;
+ &quot; AND TAI_KHOAN_DU = ''&quot;
EXECUTE sp_executesql @SqlStr
-------------------------------------
--DON GIA = 0 LA HOA DON KHUYEN MAI, UPDATE LAI TK--
-------------------------------------
UPDATE tbThanhPhamXuat
SET TAI_KHOAN_DU = '5122'
WHERE DON_GIA_BAN = 0
-----------------------------------------------
--UPDATE TAI KHOAN DO MAT BUT TOAN TRONG SL04--
-----------------------------------------------
UPDATE tbThanhPhamXuat
SET TAI_KHOAN_DU = '5112'
WHERE SO_HOA_DON = '08/112567'
-------------------------------------
--GET RESULT--
-------------------------------------
SELECT *--MA_HANG, TEN_HANG, QUY_CACH, DON_VI_TINH, TAI_KHOAN_DU, SUM&#40;SO_LUONG&#41; AS SO_LUONG, SUM&#40;THANH_TIEN&#41; AS THANH_TIEN
FROM tbThanhPhamXuat
order by MA_HANG
-- WHERE SO_HOA_DON = '08/153030'
-- WHERE TAI_KHOAN_DU &lt;&gt; '' --AND THANH_TIEN &lt;&gt; 0
-- AND MA_HANG = 'A0245'
-- GROUP BY MA_HANG, TEN_HANG, QUY_CACH, DON_VI_TINH, TAI_KHOAN_DU
-- ORDER BY TAI_KHOAN_DU
IF EXISTS &#40;SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbThanhPhamXuat&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbThanhPhamXuat&#93;
IF EXISTS &#40;SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbSupplier&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbSupplier&#93;
END</pre>
</div><br/><br/> 1 báo cáo khác cũng làm treo máy : Báo cáo xuất nhập tồn kho (có thêm giá trị) dành cho Kế toán.<br/><br/> <span class="quotetxt"><b>Code:</b></span><br/>
<div class="coded"">
<pre>set ANSI_NULLS ON
set QUOTED_IDENTIFIER ON
go
----*******************************************----
--Made Date: 01/01/2005
--Updating Date: 19/04/2007 &#40; Version:1000.0002 &#41;
--For Purpose: Bao Cao Xuat Nhap Ton -&gt; For Design Template
--For Company: Designed Template
--Description: In this store procedure, we used three tables such as
-- SC07 -&gt; Stock Transaction File I/O
-- SC09 -&gt; Get Unit of Measure
--Note:
-- @Para1 nvarchar&#40;50&#41; -- @CompID
--,@Para2 nvarchar&#40;50&#41; -- @FYear
--,@Para3 nvarchar&#40;50&#41; -- @Language
--,@Para4 nvarchar&#40;50&#41; -- @StockFrom
--,@Para5 nvarchar&#40;50&#41; -- @StockTo
--,@Para6 nvarchar&#40;50&#41; --,@WHFrom
--,@Para7 nvarchar&#40;50&#41; --,@WHTo
--,@Para8 nvarchar&#40;50&#41; --,@DateFrom
--,@Para9 nvarchar&#40;50&#41; --,@DateTo
----*******************************************----
ALTER PROCEDURE &#91;dbo&#93;.&#91;SC_XuatNhapTon_KeToan&#93;
@Para1 nvarchar&#40;50&#41; -- @CompID
,@Para2 nvarchar&#40;50&#41; -- @FYear
,@Para3 nvarchar&#40;50&#41; -- @Language
,@Para4 nvarchar&#40;50&#41; -- @StockFrom
,@Para5 nvarchar&#40;50&#41; -- @StockTo
,@Para6 nvarchar&#40;50&#41; --,@WHFrom
,@Para7 nvarchar&#40;50&#41; --,@WHTo
,@Para8 nvarchar&#40;50&#41; --,@DateFrom
,@Para9 nvarchar&#40;50&#41; --,@DateTo
WITH RECOMPILE
-- &#91;XuatNhapTon_KeToan&#93; '01','10','AME','A0144','A0144','K1','KTGC12','100401','100430'
AS
BEGIN
/* ************************************************* */
DECLARE @CompID AS NVARCHAR&#40;50&#41; SET @CompID = @Para1
DECLARE @FYear AS NVARCHAR&#40;50&#41; SET @FYear = @Para2
DECLARE @Language AS NVARCHAR&#40;50&#41; SET @Language = @Para3
DECLARE @StockFrom AS NVARCHAR&#40;50&#41; SET @StockFrom = @Para4
DECLARE @StockTo AS NVARCHAR&#40;50&#41; SET @StockTo = @Para5
DECLARE @WHFrom AS NVARCHAR&#40;50&#41; SET @WHFrom = @Para6
DECLARE @WHTo AS NVARCHAR&#40;50&#41; SET @WHTo = @Para7
DECLARE @DateFrom AS NVARCHAR&#40;50&#41; SET @DateFrom = @Para8
DECLARE @DateTo AS NVARCHAR&#40;50&#41; SET @DateTo = @Para9
DECLARE @SqlStr as nvarchar&#40;4000&#41;
DECLARE @dem as INT
SET @dem = 0
SET ANSI_WARNINGS OFF
SET ARITHABORT OFF
SET QUOTED_IDENTIFIER OFF
END
BEGIN
CREATE TABLE #TempUnitTable
&#40;
idcol int PRIMARY KEY,
UnitText nvarchar&#40;512&#41;
&#41;
--DROP TABLE #tbStock
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;#tbStock&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;#tbStock&#93;
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;#tbStockEnd&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;#tbStockEnd&#93;
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;#tbStockBegin&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;#tbStockBegin&#93;
--DROP TABLE QRYTMP_StockImMid
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbStockImMid&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbStockImMid&#93;
--DROP TABLE QRYTMP_StockExMid
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbStockExMid&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbStockExMid&#93;
CREATE TABLE #tbStockEnd
&#40;
WarehouseNo nvarchar&#40;50&#41;,
WHName nvarchar&#40;50&#41;,
StockCode nvarchar&#40;50&#41;,
Description1 nvarchar&#40;512&#41;,
Description2 nvarchar&#40;512&#41;,
UnitConvStoc nvarchar&#40;50&#41;, --DON VI TINH
UnitCodeMPC nvarchar&#40;50&#41;, --DON VI TINH NHO NHAT
UnitConvMPC INT, --HE SO QUI DOI
-- LotID nvarchar&#40;20&#41;, --SO LO
ExpiryDate DATETIME,
UserDefFld1 NVARCHAR&#40;50&#41;, --SO PHIEU KIEM NGHIEM
UserDefFld2 NVARCHAR&#40;50&#41;, --DO AM
UserDefFld3 NVARCHAR&#40;50&#41;, --HAM LUONG
ImQtyMid numeric&#40;30,4&#41;, --SO LUONG HANG NHAP
ImTransfPrice1Mid numeric&#40;30,4&#41;, --GIA TIEN HANG NHAP
ExQtyMid numeric&#40;30,4&#41;, --SO LUONG HANG XUAT
ExTransfPrice1Mid numeric&#40;30,4&#41;, --GIA TIEN HANG XUAT
QtyEnd numeric&#40;30,4&#41;, --SO LUONG HANG CON LAI TRONG KHO
TransfPrice1End numeric&#40;30,4&#41;, --GIA TIEN HANG CON LAI TRONG KHO
CurrName nvarchar&#40;50&#41;,
FromDate datetime,
ToDate datetime
,QtyBegin numeric&#40;30,4&#41;
, TransfPrice1Begin numeric&#40;30,4&#41;
&#41;
CREATE TABLE #tbStockBegin
&#40;
WarehouseNo nvarchar&#40;50&#41;,
WHName nvarchar&#40;50&#41;,
StockCode nvarchar&#40;50&#41;,
Description1 nvarchar&#40;512&#41;,
Description2 nvarchar&#40;512&#41;,
UnitConvStoc nvarchar&#40;50&#41;, --DON VI TINH
UnitCodeMPC nvarchar&#40;50&#41;, --DON VI TINH NHO NHAT
UnitConvMPC INT, --HE SO QUI DOI
-- LotID nvarchar&#40;20&#41;, --SO LO
ExpiryDate DATETIME,
UserDefFld1 NVARCHAR&#40;50&#41;, --SO PHIEU KIEM NGHIEM
UserDefFld2 NVARCHAR&#40;50&#41;, --DO AM
UserDefFld3 NVARCHAR&#40;50&#41;, --HAM LUONG
ImQtyMid numeric&#40;30,4&#41;, --SO LUONG HANG NHAP
ImTransfPrice1Mid numeric&#40;30,4&#41;, --GIA TIEN HANG NHAP
ExQtyMid numeric&#40;30,4&#41;, --SO LUONG HANG XUAT
ExTransfPrice1Mid numeric&#40;30,4&#41;, --GIA TIEN HANG XUAT
QtyBeGin numeric&#40;30,4&#41;, --SO LUONG HANG CON LAI dau ki TRONG KHO
TransfPrice1Begin numeric&#40;30,4&#41;, --GIA TIEN HANG CON LAI TRONG KHO
CurrName nvarchar&#40;50&#41;,
FromDate datetime,
ToDate datetime
&#41;
----*******************************************----
--Insert the Unit Text into the temporary table
----*******************************************----
WHILE @dem &lt; 40
BEGIN
INSERT INTO #TempUnitTable &#40;idcol, UnitText&#41; VALUES &#40;@dem,' '&#41;
SET @dem = @dem + 1
END
SET @dem = 0
WHILE @dem &lt; 8
BEGIN
SET @SqlStr = &quot; UPDATE #TempUnitTable &quot;
+ &quot; SET #TempUnitTable.UnitText = T1.SC0900&quot; + convert&#40;nvarchar&#40;3&#41;, @dem + 2&#41;
+ &quot; FROM #TempUnitTable, SC09&quot; + @CompID + &quot;00 T1&quot;
+ &quot; WHERE T1.SC09001 = '&quot; + @Language + &quot;'&quot;
+ &quot; AND #TempUnitTable.idcol = &quot; + convert&#40;nvarchar&#40;3&#41;, @dem&#41;
EXECUTE sp_executesql @SqlStr
SET @dem = @dem + 1
END
WHILE @dem &lt; 40
BEGIN
SET @SqlStr = &quot; UPDATE #TempUnitTable &quot;
+ &quot; SET #TempUnitTable.UnitText = T1.SC090&quot; + convert&#40;nvarchar&#40;3&#41;, @dem + 2&#41;
+ &quot; FROM #TempUnitTable, SC09&quot; + @CompID + &quot;00 T1&quot;
+ &quot; WHERE T1.SC09001 = '&quot; + @Language + &quot;'&quot;
+ &quot; AND #TempUnitTable.idcol = &quot; + convert&#40;nvarchar&#40;3&#41;, @dem&#41;
EXECUTE sp_executesql @SqlStr
SET @dem = @dem + 1
END
----*******************************************----
----tbTmp lay du lieu hoan toan tu bang SC07
----nhung duoc cap nhat lai voi TransPrice theo TransType
----*******************************************----
CREATE TABLE #tbStock
&#40;
WareNo nvarchar&#40;50&#41; collate Latin1_General_BIN,
WareNoTo nvarchar&#40;50&#41; collate Latin1_General_BIN,
TransDate datetime ,
TransType nvarchar&#40;50&#41; collate Latin1_General_BIN,
StockCode nvarchar&#40;512&#41; collate Latin1_General_BIN,
LotID nvarchar&#40;512&#41; collate Latin1_General_BIN,
Qty numeric&#40;30,4&#41;,
TransPrice numeric&#40;30,4&#41;,
Amount NUMERIC&#40;30,4&#41;,
Reference nvarchar&#40;50&#41; collate Latin1_General_BIN ,
OrderNumber nvarchar&#40;50&#41; collate Latin1_General_BIN ,
Invoice NVARCHAR&#40;50&#41; collate Latin1_General_BIN ,
Receiver NVARCHAR&#40;50&#41; collate Latin1_General_BIN ,
GLTransaction NVARCHAR&#40;50&#41; collate Latin1_General_BIN
&#41;
SET @SqlStr = &quot; SELECT &quot;
+ &quot; T2.SC07009 WareNo&quot;
+ &quot;, T2.SC07027 WareNoTo&quot;
+ &quot;, T2.SC07002 TransDate&quot;
+ &quot;, T2.SC07001 TransType&quot;
+ &quot;, T2.SC07003 StockCode&quot;
+ &quot;, T2.SC07021 LotID&quot;
-- + &quot;, T2.SC07021 BatchID&quot;
+ &quot;, T2.SC07004 Qty&quot;
+ &quot;, T2.SC07005 TransPrice&quot;
+ &quot;, T2.SC07005*T2.SC07004 Amount&quot;
+ &quot;, T2.SC07007 Reference&quot;
+ &quot;, T2.SC07006 OrderNumber&quot;
+ &quot;, T2.SC07056 Invoice&quot;
+ &quot;, T2.SC07011 Receiver&quot;
+ &quot;, T2.SC07020 GLTransaction&quot;
-- + &quot; INTO #tbStock&quot;
+ &quot; FROM SC07&quot; + @CompID + &quot;00 T2&quot;
+ &quot; WHERE T2.SC07009 BETWEEN '&quot; + @WHFrom + &quot;' AND '&quot; + @WHTo + &quot;'&quot;
+ &quot; AND T2.SC07003 BETWEEN '&quot; + @StockFrom + &quot;' AND '&quot; + @StockTo + &quot;'&quot;
+ &quot; AND T2.SC07002 &lt;= '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 112&#41; + &quot;'&quot;
-- + &quot; AND T2.SC07006 &lt;&gt; 'DDCK2008'&quot;
+ &quot; ORDER BY T2.SC07003, T2.SC07002 ASC&quot;
insert #tbStock execute sp_executesql @SqlStr
PRINT @SqlStr
--XOA DI CAC DONG CHUYEN KHO TU KN-&gt;KT HOAC KT-&gt;KN : HANG KIEM NGHIEM
--DELETE #tbStock
--SELECT * FROM #tbStock
-- WHERE Reference = 'X0513/09'
--SELECT * FROM #tbStock WHERE StockCode = 'B0131'
--SELECT * FROM #tbStock WHERE StockCode = 'B0027'
--delete #tbStock where Reference = 'DD001/08'-- OR OrderNumber = 'DDCK2009'
--SELECT * FROM #tbStock WHERE StockCode = 'C0047'
-- SET @SqlStr = &quot; UPDATE #tbStock&quot;
-- + &quot; SET TransDate = PL03005&quot;
-- + &quot; FROM PL03&quot; + @CompID + &quot;00&quot;
-- + &quot; WHERE Invoice = PL03002 AND Receiver = PL03001&quot;
-- execute sp_executesql @SqlStr
UPDATE #tbStock
SET Amount = TransPrice
WHERE TransType = '03' OR TransType = '10'
UPDATE #tbStock
SET Amount = &#40;-1&#41;* TransPrice
WHERE TransType = '07'
--SELECT * FROM #tbStock WHERE StockCode = 'B0651' --AND &#40;TransType = '01' OR &#40;TransType = '04' AND Qty &lt; 0&#41;&#41;
----*******************************************----
----##tbStockEnd tính số lượng và giá cuối kỳ
----Bang nay la bang chính để lấy dữ liệu
----*******************************************----
SET @SqlStr = &quot; INSERT INTO #tbStockEnd &quot;
+ &quot; SELECT DISTINCT&quot;
+ &quot; T2.WareNo &quot;
+ &quot;, T3.SC23002 &quot;
+ &quot;, T2.StockCode &quot;
+ &quot;, T1.SC01002 Description1&quot;
+ &quot;, SUBSTRING&#40;T1.SC01003, 1, ABS&#40;CHARINDEX&#40;'TH',T1.SC01003,1&#41; - 1&#41;&#41; Description2&quot;
+ &quot;, T4.UnitText UnitText&quot;
-- + &quot;, T2.LotID LotID&quot;
+ &quot;, T1.SC01136 UnitCodeMPC&quot;
+ &quot;, T1.SC01142 UnitConvMPC&quot;
+ &quot;, NULL&quot;
+ &quot;, ' '&quot;
+ &quot;, ' '&quot;
+ &quot;, ' '&quot;
+ &quot;, 0 &quot;
+ &quot;, 0 &quot;
+ &quot;, 0 &quot;
+ &quot;, 0 &quot;
+ &quot;, SUM&#40;T2.Qty&#41; &quot;
+ &quot;, SUM&#40;T2.Amount&#41; &quot;
+ &quot;, SY.SYCD009 CurrName&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateFrom, 1&#41; + &quot;'&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 1&#41; + &quot;'&quot;
+&quot;,0&quot;
+&quot;,0&quot;
+ &quot; FROM SC01&quot; + @CompID + &quot;00 T1, #tbStock T2&quot;
+ &quot;, SC23&quot; + @CompID + &quot;00 T3, #TempUnitTable T4&quot;
+ &quot;, SYCD&quot; + @CompID + &quot;00 SY&quot;
+ &quot; WHERE T2.WareNo BETWEEN '&quot; + @WHFrom + &quot;' AND '&quot; + @WHTo + &quot;'&quot;
+ &quot; AND T2.StockCode BETWEEN '&quot; + @StockFrom + &quot;' AND '&quot; + @StockTo + &quot;'&quot;
+ &quot; AND T2.WareNo = T3.SC23001&quot;
+ &quot; AND T1.SC01001 = T2.StockCode&quot;
+ &quot; AND T2.TransDate &lt;= '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 112&#41; + &quot;'&quot;
+ &quot; AND T4.idcol = T1.SC01133&quot;
+ &quot; AND SY.SYCD001 = 0 &quot;
+ &quot; GROUP BY T2.StockCode, T2.WareNo, T3.SC23002, T1.SC01002, T1.SC01003,&quot;
+ &quot; T1.SC01136, T1.SC01142, T4.UnitText, SY.SYCD009&quot;--- T2.LotID&quot;
+ &quot; ORDER BY T2.StockCode ASC&quot;
EXECUTE sp_executesql @SqlStr
--SELECT * FROM #tbStockEnd
SET @SqlStr = &quot; INSERT INTO #tbStockBegin &quot;
+ &quot; SELECT DISTINCT&quot;
+ &quot; T2.WareNo &quot;
+ &quot;, T3.SC23002 &quot;
+ &quot;, T2.StockCode &quot;
+ &quot;, T1.SC01002 Description1&quot;
+ &quot;, SUBSTRING&#40;T1.SC01003, 1, ABS&#40;CHARINDEX&#40;'TH',T1.SC01003,1&#41; - 1&#41;&#41; Description2&quot;
+ &quot;, T4.UnitText UnitText&quot;
-- + &quot;, T2.LotID LotID&quot;
+ &quot;, T1.SC01136 UnitCodeMPC&quot;
+ &quot;, T1.SC01142 UnitConvMPC&quot;
+ &quot;, NULL&quot;
+ &quot;, ' '&quot;
+ &quot;, ' '&quot;
+ &quot;, ' '&quot;
+ &quot;, 0 &quot;
+ &quot;, 0 &quot;
+ &quot;, 0 &quot;
+ &quot;, 0 &quot;
+ &quot;, SUM&#40;T2.Qty&#41; &quot;
+ &quot;, SUM&#40;T2.Amount&#41; &quot;
+ &quot;, SY.SYCD009 CurrName&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateFrom, 1&#41; + &quot;'&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 1&#41; + &quot;'&quot;
+ &quot; FROM SC01&quot; + @CompID + &quot;00 T1, #tbStock T2&quot;
+ &quot;, SC23&quot; + @CompID + &quot;00 T3, #TempUnitTable T4&quot;
+ &quot;, SYCD&quot; + @CompID + &quot;00 SY&quot;
+ &quot; WHERE T2.WareNo BETWEEN '&quot; + @WHFrom + &quot;' AND '&quot; + @WHTo + &quot;'&quot;
+ &quot; AND T2.StockCode BETWEEN '&quot; + @StockFrom + &quot;' AND '&quot; + @StockTo + &quot;'&quot;
+ &quot; AND T2.WareNo = T3.SC23001&quot;
+ &quot; AND T1.SC01001 = T2.StockCode&quot;
+ &quot; AND T2.TransDate &lt; '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateFrom, 112&#41; + &quot;'&quot;
+ &quot; AND T4.idcol = T1.SC01133&quot;
+ &quot; AND SY.SYCD001 = 0 &quot;
+ &quot; GROUP BY T2.StockCode, T2.WareNo, T3.SC23002, T1.SC01002, T1.SC01003,&quot;
+ &quot; T1.SC01136, T1.SC01142, T4.UnitText, SY.SYCD009&quot;--- T2.LotID&quot;
+ &quot; ORDER BY T2.StockCode ASC&quot;
EXECUTE sp_executesql @SqlStr
--select * from #tbStockBegin
print @SqlStr
DELETE #tbStock
WHERE &#40;&#40;WareNo = 'KN' AND WareNoTo = 'KT'&#41; OR &#40;WareNo = 'KT' AND WareNoTo = 'KN'&#41;
OR &#40;WareNo = 'KB' AND WareNoTo = 'KT'&#41; OR &#40;WareNo = 'KB' AND WareNoTo = 'KT'&#41;&#41;
AND Receiver = '20'
AND TransDate BETWEEN '20090201' AND '20091230'
----*******************************************----
----tbStockImMid tính số lượng và giá nhập trong kỳ
----ĐK: theo TransType
----*******************************************----
SET @SqlStr = &quot; SELECT DISTINCT&quot;
+ &quot; T2.WareNo WarehouseNo&quot;
+ &quot;, T2.StockCode StockCode&quot;
+ &quot;, T1.SC01002 Description1&quot;
+ &quot;, SUBSTRING&#40;T1.SC01003, 1, ABS&#40;CHARINDEX&#40;'TH',T1.SC01003,1&#41; - 1&#41;&#41; Description2&quot;
+ &quot;, T4.UnitText UnitText&quot;
-- + &quot;, T2.LotID LotID&quot;
+ &quot;, T1.SC01136 UnitCodeMPC&quot;
+ &quot;, T1.SC01142 UnitConvMPC&quot;
+ &quot;, SUM&#40;T2.Qty&#41; Qty&quot;
+ &quot;, SUM&#40;round&#40;T2.Amount,4&#41;&#41; Amount&quot;
+ &quot;, 0 ExQty&quot;
+ &quot;, 0 ExAmount&quot;
+ &quot;, 0 EndQty&quot;
+ &quot;, 0 EndAmount&quot;
+ &quot;, SY.SYCD009 CurrName&quot;
-- + &quot;, T2.GLTransaction GLTransaction&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateFrom, 1&#41; + &quot;' DateFrom&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 1&#41; + &quot;' DateTo&quot;
+ &quot; INTO tbStockImMid&quot;
+ &quot; FROM SC01&quot; + @CompID + &quot;00 T1, #tbStock T2&quot;
+ &quot;, SC23&quot; + @CompID + &quot;00 T3, #TempUnitTable T4&quot;
+ &quot;, SYCD&quot; + @CompID + &quot;00 SY&quot;
+ &quot; WHERE T2.WareNo BETWEEN '&quot; + @WHFrom + &quot;' AND '&quot; + @WHTo + &quot;'&quot;
+ &quot; AND T2.StockCode BETWEEN '&quot; + @StockFrom + &quot;' AND '&quot; + @StockTo + &quot;'&quot;
+ &quot; AND T2.WareNo = T3.SC23001&quot;
+ &quot; AND T1.SC01001 = T2.StockCode&quot;
+ &quot; AND T4.idcol = T1.SC01133&quot;
+ &quot; AND SY.SYCD001 = 0 &quot;
+ &quot; AND &#40;T2.TransType IN &#40;'00','03'&#41; OR &#40;T2.Qty &gt; 0 AND T2.TransType = '04'&#41;&quot; --Điều kiện để lấy
+ &quot; OR &#40;T2.TransType = '02' AND T2.Qty &gt; 0&#41;&#41;&quot; --hàng nhập kho
-- + &quot; OR &#40;T2.TransType = '01' AND T2.Qty &gt; 0&#41;&#41;&quot;
+ &quot; AND T2.TransDate &gt;= '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateFrom, 112&#41; + &quot;'&quot;
+ &quot; AND T2.TransDate &lt;= '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 112&#41; + &quot;'&quot;
+ &quot; GROUP BY T2.StockCode, T2.WareNo, T3.SC23002, T1.SC01002, T1.SC01003,&quot;
+ &quot; T1.SC01136, T1.SC01142, T4.UnitText, SY.SYCD009&quot;--, T2.GLTransaction&quot;--, T2.LotID&quot;
+ &quot; ORDER BY T2.StockCode ASC&quot;
EXECUTE sp_executesql @SqlStr
--SELECT * FROM tbStockImMid --WHERE StockCode LIKE 'A0281%' --AND WarehouseNo = 'KN'
-- AND SC25002 = GLTransaction
----*******************************************----
----tbStockExMid tính số lượng và giá xuất trong kỳ
----ĐK: theo TransType
----*******************************************----
SET @SqlStr = &quot; SELECT DISTINCT&quot;
+ &quot; T2.WareNo WarehouseNo&quot;
+ &quot;, T2.StockCode StockCode&quot;
+ &quot;, T1.SC01002 Description1&quot;
+ &quot;, SUBSTRING&#40;T1.SC01003, 1, ABS&#40;CHARINDEX&#40;'TH',T1.SC01003,1&#41; - 1&#41;&#41; Description2&quot;
+ &quot;, T4.UnitText UnitText&quot;
+ &quot;, T1.SC01136 UnitCodeMPC&quot;
+ &quot;, T1.SC01142 UnitConvMPC&quot;
-- + &quot;, T2.LotID LotID&quot;
+ &quot;, 0 ImQty&quot;
+ &quot;, 0 ImAmount&quot;
+ &quot;, SUM&#40;T2.Qty&#41; Qty&quot;
+ &quot;, SUM&#40;round&#40;T2.Amount,4&#41;&#41; Amount&quot;
+ &quot;, 0 EndQty&quot;
+ &quot;, 0 EndAmount&quot;
+ &quot;, SY.SYCD009 CurrName&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateFrom, 1&#41; + &quot;' DateFrom&quot;
+ &quot;, '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 1&#41; + &quot;' DateTo&quot;
+ &quot; INTO tbStockExMid&quot;
+ &quot; FROM SC01&quot; + @CompID + &quot;00 T1, #tbStock T2&quot;
+ &quot;, SC23&quot; + @CompID + &quot;00 T3, #TempUnitTable T4&quot;
+ &quot;, SYCD&quot; + @CompID + &quot;00 SY&quot;
+ &quot; WHERE T2.WareNo BETWEEN '&quot; + @WHFrom + &quot;' AND '&quot; + @WHTo + &quot;'&quot;
+ &quot; AND T2.StockCode BETWEEN '&quot; + @StockFrom + &quot;' AND '&quot; + @StockTo + &quot;'&quot;
+ &quot; AND T2.WareNo = T3.SC23001&quot;
+ &quot; AND T1.SC01001 = T2.StockCode&quot;
+ &quot; AND T4.idcol = T1.SC01133&quot;
+ &quot; AND SY.SYCD001 = 0 &quot;
+ &quot; AND &#40;T2.TransType IN &#40;'01','07','10'&#41; OR &#40;T2.Qty &lt; 0 AND T2.TransType = '04'&#41;&quot; --Điều kiện để lấy
+ &quot; OR &#40;T2.TransType = '02' AND T2.Qty &lt; 0&#41;&#41;&quot;
-- + &quot; OR &#40;T2.TransType = '01' AND T2.Qty &lt; 0&#41;&#41;&quot; --hàng xuất kho
+ &quot; AND T2.TransDate &gt;= '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateFrom, 112&#41; + &quot;'&quot;
+ &quot; AND T2.TransDate &lt;= '&quot; + CONVERT&#40;nvarchar&#40;50&#41;, @DateTo, 112&#41; + &quot;'&quot;
+ &quot; GROUP BY T2.StockCode, T2.WareNo, T3.SC23002, T1.SC01002, T1.SC01003,&quot;
+ &quot; T1.SC01136, T1.SC01142, T4.UnitText, SY.SYCD009&quot;--, T2.LotID&quot;
+ &quot; ORDER BY T2.StockCode ASC&quot;
EXECUTE sp_executesql @SqlStr
--SELECT * FROM tbStockExMid WHERE StockCode = 'A0281'
--Them điều kiện kết LotID-
UPDATE #tbStockEnd
SET #tbStockEnd.ImQtyMid = tbStockImMid.Qty
,#tbStockEnd.ImTransfPrice1Mid = tbStockImMid.Amount
FROM #tbStockEnd, tbStockImMid
WHERE #tbStockEnd.WarehouseNo collate Latin1_General_BIN = tbStockImMid.WarehouseNo
AND #tbStockEnd.StockCode collate Latin1_General_BIN = tbStockImMid.StockCode
-- AND #tbStockEnd.LotID = tbStockImMid.LotID --LotID
UPDATE #tbStockEnd
SET #tbStockEnd.ExQtyMid = tbStockExMid.Qty
,#tbStockEnd.ExTransfPrice1Mid = tbStockExMid.Amount
FROM #tbStockEnd, tbStockExMid
WHERE #tbStockEnd.WarehouseNo collate Latin1_General_BIN = tbStockExMid.WarehouseNo
AND #tbStockEnd.StockCode collate Latin1_General_BIN = tbStockExMid.StockCode
UPDATE #tbStockEnd
SET #tbStockEnd.QtyBegin = #tbStockBegin.QtyBegin
,#tbStockEnd.TransfPrice1Begin = #tbStockBegin.TransfPrice1Begin
FROM #tbStockEnd, #tbStockBegin
WHERE #tbStockEnd.WarehouseNo collate Latin1_General_BIN = #tbStockBegin.WarehouseNo
AND #tbStockEnd.StockCode collate Latin1_General_BIN = #tbStockBegin.StockCode
-- AND #tbStockEnd.LotID = tbStockExMid.LotID --LotID
--UPDATE NEU HS QUI DOI = 0--
/*
UPDATE #tbStockEnd
SET UnitConvMPC = 1
WHERE UnitConvMPC = 0
--NHAN SL VOI HE SO QUI DOI--
UPDATE #tbStockEnd
SET ImQtyMid = ImQtyMid * UnitConvMPC,
ExQtyMid = ExQtyMid * UnitConvMPC,
QtyEnd = QtyEnd * UnitConvMPC
*/
--NHAN SL VOI HE SO QUI DOI--
/*
UPDATE #tbStockEnd
SET ImQtyMid = ImQtyMid * ISNULL&#40;QDGBB, 1&#41;,
ExQtyMid = ExQtyMid * ISNULL&#40;QDGBB, 1&#41;,
QtyEnd = QtyEnd * ISNULL&#40;QDGBB, 1&#41;
FROM #tbStockEnd, SCGCD0000
WHERE StockCode = MAHH
*/
UPDATE #tbStockEnd
SET UnitCodeMPC = &#40; SELECT UnitText FROM #TempUnitTable WHERE UnitCodeMPC = idcol&#41;
--UPDATE Do am, ham luong, Phieu KN --
--UPDATE MA PHAN XUONG, TEN PHAN XUONG--
SET @SqlStr = &quot; UPDATE #tbStockEnd&quot;
+ &quot; SET UserDefFld1 = SC01010&quot;
+ &quot; FROM #tbStockEnd, SC01&quot; + @CompID + &quot;00&quot;
+ &quot; WHERE StockCode collate Latin1_General_BIN = SC01001&quot;
EXECUTE sp_executesql @SqlStr
SET @SqlStr = &quot; UPDATE #tbStockEnd&quot;
+ &quot; SET UserDefFld1 = SY24003&quot;
+ &quot; FROM #tbStockEnd, SY24&quot; + @CompID + &quot;00&quot;
+ &quot; WHERE UserDefFld1 collate Latin1_General_BIN = SY24002&quot;
+ &quot; AND SY24001 = 'IQ'&quot;
EXECUTE sp_executesql @SqlStr
---------------------------------------
/*
SET @SqlStr = &quot; UPDATE #tbStockEnd&quot;
+ &quot; SET LotID = SC33009&quot;
+ &quot; FROM #tbStockEnd, SC33&quot; + @CompID + &quot;00&quot;
+ &quot; WHERE WarehouseNo = SC33002 AND StockCode = SC33001 AND LotID = SC33003&quot;
EXECUTE sp_executesql @SqlStr
*/
--**********GET RESULT*************--
/*SELECT WarehouseNo, WHName, StockCode, Description1, Description2, UnitConvStoc
,LotID, ExpiryDate, UserDefFld1, UserDefFld2, UserDefFld3,
SUM&#40;ImQtyMid&#41; as ImQtyMid, SUM&#40;ExQtyMid&#41; AS ExQtyMid, SUM&#40;QtyEnd&#41; AS QtyEnd, CurrName, FromDate, ToDate
FROM #tbStockEnd
WHERE ImQtyMid &lt;&gt; 0.0 OR ExQtyMid &lt;&gt; 0.0 OR QtyEnd &lt;&gt; 0.0
group by WarehouseNo, WHName, StockCode, Description1, Description2, UnitConvStoc
,LotID, ExpiryDate, UserDefFld1, UserDefFld2, UserDefFld3, CurrName, FromDate, ToDate
-- AND LotID = '0030408'
*/
IF @StockFrom LIKE 'A%'
SELECT *
FROM #tbStockEnd
WHERE &#40;ImQtyMid &lt;&gt; 0.0 OR ExQtyMid &lt;&gt; 0.0 OR QtyEnd &lt;&gt; 0.0
OR ImTransfPrice1Mid &lt;&gt; 0.0 OR ExTransfPrice1Mid &lt;&gt; 0.0 OR TransfPrice1End &lt;&gt; 0.0&#41;
AND WarehouseNo IN &#40;'K1','K2','K8','K13','K6','K9','K14','K7'&#41;
ELSE
SELECT *
FROM #tbStockEnd
WHERE &#40;ImQtyMid &lt;&gt; 0.0 OR ExQtyMid &lt;&gt; 0.0 OR QtyEnd &lt;&gt; 0.0
OR ImTransfPrice1Mid &lt;&gt; 0 OR ExTransfPrice1Mid &lt;&gt; 0 OR TransfPrice1End &lt;&gt; 0&#41;
SELECT StockCode,ImTransfPrice1Mid
FROM #tbStockEnd
WHERE &#40;ImTransfPrice1Mid &lt;&gt; 0.0 &#41;
--SELECT StockCode, SUM&#40;ExTransfPrice1Mid&#41; FROM #tbStockEnd --WHERE TransDate BETWEEN '090301' AND '090331'
--GROUP BY StockCode
--SELECT StockCode, SUM&#40;ExTransfPrice1Mid&#41; FROM #tbStockEnd --WHERE TransDate BETWEEN '090301' AND '090331'
--w
--GROUP BY StockCode
--SELECT * FROM #tbStock WHERE TransDate BETWEEN '090601' AND '090630' AND StockCode = 'B0005'
DROP TABLE #tbStock
DROP TABLE #tbStockEnd
DROP TABLE tbStockImMid
DROP TABLE tbStockExMid
--DROP TABLE tbStock
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;#tbStock&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;#tbStock&#93;
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;#tbStockEnd&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;#tbStockEnd&#93;
--DROP TABLE QRYTMP_StockImMid
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbStockImMid&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbStockImMid&#93;
--DROP TABLE QRYTMP_StockExMid
IF EXISTS &#40; SELECT * FROM dbo.sysobjects WHERE id = object_id&#40;N'&#91;dbo&#93;.&#91;tbStockExMid&#93;'&#41;
AND OBJECTPROPERTY&#40;id, N'IsUserTable'&#41; = 1&#41;
DROP TABLE &#91;dbo&#93;.&#91;tbStockExMid&#93;
END
--&#91;XuatNhapTon_KeToan&#93; '01','09','AME','B0001','B9999','KN','KN','090801','090831'</pre>
</div><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/35132.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/35132/215947.html#215947,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">cvhainb wrote:</cite><br>
<blockquote><b>Mình chỉ có thể góp ý thêm một chút về các vấn đề về truy vấn (query).<br/><br/> Đối với package lớn như bạn mô tả thì việc các câu truy vấn dữ liệu như thế nào cũng rất quan trọng. Với dữ liệu lớn mà báo cáo khi in ra là trong khoảng thời gian là 1, 2 năm thì việc treo máy cũng là thường.<br/><br/> Để dễ dàng bạn chỉ nên xem lại đoạn code chỗ nhập liệu, thử xem.<br/><br/> Thân<br/> <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></b>&nbsp;
</blockquote><br/><br/> Cám ơn bạn đã chia sẻ. Ứng dụng ERP này của 1 tập đoàn nước ngoài nên mình không có xem code chổ nhập liệu được.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/35132.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/35132/215942.html#215942,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">conmale wrote:</cite><br>
<blockquote><br/> W2k3 và MSSQL này chạy phiên bản 32-bit hay 64-bit?<br/><br/> Phương thức kết nối và "commit data" từ các applications đến CSDL cụ thể như thế nào?&nbsp;
</blockquote><br/><br/> Dạ, W2k3 và SQL thì đều đang chạy 32 bit. Em không rõ lắm cách "commit data" của Application. Nhưng biết là ứng dụng gọi các COM+ App và DCOM, trong database thì em không thấy lưu các Stored Proc phục vụ insert,update,delete dữ liệu gì cả, chỉ có 1 vài stored phục vụ đăng nhập, phân quyền, ... Đây là 1 ứng dụng ERP cũng ở tầm trung và brochure thì cũng có nói là dữ liệu được mã hoá gởi giữa Client đến Server (ứng dụng chạy Client/Server). Không đề cập đến cơ chế hoạt động bên dưới nên em không được biết.<br/><br/> <p></p>
<cite class="blockquote">qtra004 wrote:</cite><br>
<blockquote><br/> Ngoài những thông tin anh conmale hỏi? Bạn có thể dùng Activity Monitor trên SQL Management Studio để xem lúc application chạy report, những query gì đang chạy và những process có bị lock không? Loại lock là gì? Nếu bạn biết được sql query của process để generate report thì bạn thảy lên đây để mình xem thử xem query đó có optimised cho performance chưa?<br/> &nbsp;
</blockquote><br/><br/> Mình sẽ thử xem sao, có gì sẽ post lên đây nhờ mọi người giúp đỡ.<br/><br/> À, quên nói 1 vấn đề quan trọng là Các báo cáo mà mình đề cập bên trên là Báo cáo do công ty Customize, mình nghĩ chắc cách viết không tối ưu, gây lock table hay sao (trình độ coding của người customize báo cáo có hạn, mình cũng không rành nên đọc code cũng không tìm ra chổ nào để tối ưu được). Các báo cáo có sẵn của chương trình thì mặc dù in lâu nhưng không làm treo các máy con nhập liệu Hoá đơn.<br/><br/> Cám ơn mọi người nhiều lắm.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/35132.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/35132/215867.html#215867,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Chào mọi người,<br/><br/> Mình đang gặp khó khăn với ứng dụng ERP có dữ liệu lớn (hiện tại khỏang 20GB/company, tổng file .mdf bao gồm nhiều company là 50GB)<br/> Khi in các báo cáo Tồn kho và Doanh số thì truy xuất hệ thống chậm và thậm chí treo 1 số máy ở bộ phận nhập liệu Đơn hàng/hóa đơn.<br/> Mình không chuyên sâu về SQL và không tìm được nguyên nhân gây ra vấn đề ở đây. Vậy có bạn nào hiểu sâu về SQL cũng như cách thức tìm nguyên nhân, tối ưu hóa SQL thì giúp mình với.<br/><br/> Nếu vấn đề này không thể chia sẻ trên diễn đàn, bạn có thể liên hệ trực tiếp mình cũng được. Xem như là mình đang tìm dịch vụ vậy mà.<br/><br/> Mọi người ai biết ai rành thì cũng chỉ giúp mình nhé.<br/><br/> Cám ơn nhiều.<br/><br/> Thông tin thêm :<br/><br/> Server IBM x3650 2x3.0Ghz Quad Core, 6GB RAM, 5x146GB SAS RAID5, Windows 2003 Ent SP1, SQL Server 2005 Ent.<br/> Lúc bị treo đó thì thấy RAM, CPU trên Server cũng ở mức thấp (chừng 20%=30%), không bị overload.<br/><br/> Nguyễn Phúc Nguyên<br/> 0909.899.235<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/32954.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/32954/203913.html#203913,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mình cũng đã quần 2 ngày (chủ yếu là cài đặt lại chương trình) cho các máy laptop trong công ty mình do bị nhiễm virus này.<br/> Triệu chứng các máy như sau : không nhận thiết bị, USB, bị dump, ... chậm, Skype tự động gởi message.<br/> Lúc đầu mình quét bằng Hirenboot + BKAV Home và tự tay xóa các file imPlayok.exe gì đó, xong tiêu Windows luôn --&gt; mình cho chạy repair nhưng repair cực kỳ lâu (khỏang 4-5 giờ).<br/> Cuối cùng mình quyết định cài lại hết cho xong.<br/><br/> Theo mình thì hình như virus kiểm sóat luôn phần driver thiết bị hay sao đó.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/32706.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/32706/202134.html#202134,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hic, mong mọi người giúp đỡ. Bị vậy hòai chắc bị đuổi việc luôn quá.....<br/><br/> Bên hosting báo IP mình bị đưa vào blacklist, tuy nhiên, theo mình hiểu thì nếu đã gởi mail ra ngòai thông qua mail server của họ thì xem như IP của mail server của họ, sao lại check ip của mình làm gì rồi block ?<br/> Giờ bên Hosting đá qua ISP, ISP đá qua Hosting, mình không biết đường đâu mà lần.<br/><br/> Do bên mình dùng IP động nên mình đã kiểm tra như sau : khi gởi mail không được, mình reset modem --&gt; có IP mới --&gt; lúc này lại gởi mail được. Tuy nhiên, kiểm tra thì IP mới này cũng vẫn bị liệt vào blacklist mặc dù vẫn đang gởi được. ???<br/> Mình kiểm tra IP có bị blacklist không ở đây :<br/> http://www.mxtoolbox.com/blacklists.aspx<br/><br/> Đã thử dùng tool ở trang này : http://mynetwatchman.com/ thì thấy các máy đều clean hết.<br/><br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/32706.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/32706/201827.html#201827,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hi,<br/><br/> Mình đóan là vấn đề này do virus nên post ở đây. Mình đang quản lý 1 Mail Server Mdaemon Offline, Host thì của 1 NCC ở Mỹ. Chạy cũng ổn định. Nhưng gần đây lại bị tình trạng rất lạ là gởi mail không đến được người nhận. Vấn đề này lặp đi lặp lại hòai cả 2 tháng nay làm mình mệt quá.<br/><br/> Mình đã test như nhau :<br/> 1. Trong network của mình, log on vào hộp mail catch-all của NCC hosting gởi thử mail đến Yahoo, Gmail ---&gt; không nhận được.<br/> 2. Mình remote vào 1 network khác, làm tương tự thì nhận được bình thường.<br/> 3. Liên hệ NCC Hosting thì họ nói họ test thấy cũng gởi nhận bình thường.<br/><br/> Mình đóan là có vấn đề với network của mình, cụ thể là IP, chắc là bị mail server block hay sao đó, nhưng bên NCC thì 1 mực khẳng định họ không block gì cả. Tuy nhiên, mỗi khi nhờ họ kiểm tra thì buổi chiều hoặc ngày hôm sau thì lại gởi được bình thường.<img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom"><br/><br/> Vậy theo bạn thì vấn đề có phải do network của mình không, do virus không ? Và có cách nào để mình check ?<br/><br/> Cám ơn và mong nhận được sự góp ý từ mọi người.<br/><br/> NPN</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/31423.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/31423/193900.html#193900,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hi,<br/><br/> Khỏang 1 năm trước mình có bị 1 số con virus làm rớt mạng (kavo.exe hay amo.exe gì đó), cứ máy có virus vô mạng là kể như rớt Internet luôn. Ngòai ra cũng bị dính con gì mà giả gateway --&gt; cũng làm rớt mạng luôn. Nhưng trong tình huống gần đây mình bị lại khác :<br/> Máy của Sếp mình mỗi lần về công ty gắn vô là làm rớt mạng, lúc đầu mình chẳng để ý, tưởng là Modem bị điên điên nên tắt nguồn và mở lại (kỹ thuật FPT hướng dẫn vậy hòai hà) thì khỏang 2 phút sau là vào mạng được. Tuy nhiên, nếu để không tắt, mở modem thì bị rớt mạng đến khỏang 15-20 phút.<br/><br/> Mình đã test thì khỏang 10 lần đều giống vậy :<br/> Lúc máy Sếp bật lên và lấy IP từ DHCP là lúc bắt đầu rớt mạng (IP lấy từ DHCP trên Server DC luôn, Access Point chỉ làm Bridge). Sau khi máy Sếp lấy IP thành công, lúc này mình kiểm tra thấy :<br/> 1. Máy Sếp Ping Modem được, vào Internet được.<br/> 2. Các máy khác không Ping Modem được, không vào Internet được luôn, chứ không có vụ chậm hay có độ trễ gì hết.<br/><br/> Thiệt kỳ lạ, giống như máy đó vô là giành để sử dụng mạng 1 mình vậy.<br/><br/> Trong 1 lần Sếp không logon được vào máy do virus, mình đã tranh thủ quét virus trên máy Sếp bằng Kaspersky trong MiniXP bản HirenBoot 10.0, ra 1 đóng Worm (dính đến forever.exe, romantic.exe, userinit.exe). Mình cho delete hết.<br/> Tuy nhiên tình trạng vẫn còn.<br/> Mình cũng đã kiểm tra các cấu hình card mạng Wireless và Ethernet của máy Sếp, không bị trùng IP với Gateway.<br/><br/> Chẳng hiểu bị gì nữa, có bạn nào bị giống mình không ? Hay có bạn nào có ý kiến hay giải pháp gì không, cho mình biết với.<br/><br/> Cám ơn nhiều.<br/><br/> Mình thử dùng log của Firewall Windows khi máy Sếp mới bật lên --&gt; thấy 1 số thông tin bên dưới (máy Sếp : 192.168.1.19, máy mình : 192.168.1.15) nhưng không biết vậy có gì bất bình thường không nữa.<br/><br/> 2009-09-23 08:20:27 DROP UDP 192.168.1.23 192.168.1.255 137 137 78 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:39 DROP UDP 192.168.1.2 192.168.1.255 520 520 72 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:44 DROP UDP 0.0.0.0 255.255.255.255 68 67 334 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:45 DROP UDP 0.0.0.0 255.255.255.255 68 67 328 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:46 DROP UDP 0.0.0.0 255.255.255.255 68 67 340 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:51 DROP UDP 0.0.0.0 255.255.255.255 68 67 340 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:55 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:56 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:57 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:57 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:58 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:20:59 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:00 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:01 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:01 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:02 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:04 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:04 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:05 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:06 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:06 DROP UDP 192.168.1.19 192.168.1.255 138 138 237 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:09 DROP UDP 192.168.1.2 192.168.1.255 520 520 72 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:17 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:18 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:19 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:19 DROP UDP 192.168.1.19 192.168.1.255 137 137 96 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:20 DROP UDP 192.168.1.19 192.168.1.255 138 138 237 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:20 DROP UDP 192.168.1.19 192.168.1.255 138 138 207 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:20 DROP UDP 192.168.1.10 192.168.1.255 138 138 229 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:24 DROP UDP 192.168.1.19 239.255.255.250 1039 1900 161 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:27 DROP UDP 192.168.1.19 239.255.255.250 1039 1900 161 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:30 DROP UDP 192.168.1.19 239.255.255.250 1039 1900 161 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:39 DROP UDP 192.168.1.2 192.168.1.255 520 520 72 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:42 DROP UDP 192.168.1.19 239.255.255.250 1050 1900 165 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:43 DROP UDP 192.168.1.19 255.255.255.255 68 67 328 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:44 DROP UDP 192.168.1.19 239.255.255.250 1050 1900 160 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:55 DROP UDP 192.168.1.200 239.255.255.250 3075 1900 166 - - - - - - - RECEIVE<br/> 2009-09-23 08:21:55 DROP UDP 192.168.1.200 239.255.255.250 3075 1900 166 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:09 DROP UDP 192.168.1.2 192.168.1.255 520 520 72 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1614 1900 312 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1615 1900 321 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1616 1900 384 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1617 1900 376 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1618 1900 321 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1619 1900 360 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1620 1900 392 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1621 1900 321 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:28 DROP UDP 192.168.1.7 239.255.255.250 1622 1900 380 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:33 DROP TCP 192.168.1.19 192.168.1.15 1113 445 48 S 689072128 0 16384 - - - RECEIVE<br/> 2009-09-23 08:22:36 DROP TCP 192.168.1.19 192.168.1.15 1113 445 48 S 689072128 0 16384 - - - RECEIVE<br/> 2009-09-23 08:22:40 DROP UDP 192.168.1.19 192.168.1.255 138 138 202 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:40 DROP UDP 192.168.1.19 192.168.1.255 137 137 78 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:40 DROP UDP 192.168.1.10 192.168.1.255 137 137 78 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:41 DROP UDP 192.168.1.19 192.168.1.255 137 137 78 - - - - - - - RECEIVE<br/> 2009-09-23 08:22:42 DROP UDP 192.168.1.19 192.168.1.255 137 137 78 - - - - - - - RECEIVE</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21369.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21369/127071.html#127071,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">thangnhochathanh wrote:</cite><br>
<blockquote>Các bạn giúp mình vời máy mình không thể mở ổ đĩa theo cách bình thường là nhấn kép vào là mở lên được mà nó mở ra màn hình tìm kiềm. các bạn giúp mình với. Thanks<br/><br/> &nbsp;
</blockquote><br/><br/> Bạn show hết các file ẩn, kể cả các file được HĐH bảo vệ. Tìm xem có file autorun.inf thì xóa đi. Mình đoán trong file Autorun.inf này chỉ đường dẫn để gọi chương trình search.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21371.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21371/127067.html#127067,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Theo như tình huống đó thì hình như modem của bạn cấp dãy khác dãy 192.168.1.0/24 mà bạn set IP tĩnh.<br/> Khi các máy đều kết nối Internet được nghĩa là các máy đã "thấy" nhau rồi đó. Bạn thử truy cập lẫn nhau xem.<br/> Còn muốn biết cấu hình cho máy làm Server hay Client thì trước hết bạn phải hiểu khái niệm Server và Client đã.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21336.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21336/127065.html#127065,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mail online mà bạn có địa chỉ IP tĩnh không ? Và từ địa chỉ này có reverse lại ra domain của bạn được ? Nếu chưa thì bạn nhờ bên cung cấp IP làm cho. Xong thì test lại thử.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21336.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21336/127033.html#127033,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">vuahung103 wrote:</cite><br>
<blockquote><p></p>
<cite class="blockquote">lama wrote:</cite><br>
<blockquote>Bạn vào menu Setup, Primary Domain, tab Delivery, chọn Always send every outbound email to the server specified below. Nhập các giá trị cần thiết vào Mail Server, username/pass cho Requires Authentication. Chúc bạn thành công.&nbsp;
</blockquote><br/><br/> Lama cho mình hỏi thêm: Trong phần mail server thì mình biết là nhập IP của mailserver rồi. Vậy còn phần username/pass cho Requires Authentication mình sẽ phải nhập user và pass nào? Khi mình cài Mdaemon nó có bắt thiết lập 1 user làm admin và mình cũng có tạo 1 acc admin+pass, mình hỏi có phải là khai báo user này hay là user nào?<br/> Thanks!&nbsp;
</blockquote><br/> Đây là username/pass của 1 account mail trên Mail Server nơi bạn Hosting (bạn có thể dùng account mà bạn POP mail về đó). À, mà bạn đang dùng Mail Offline chứ ?</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/27.html">Thông tin về các địa chỉ và tài liệu hữu ích</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/19573.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/19573/126863.html#126863,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hi,<br/><br/> Mình đang tìm cuốn IT Manager's Handbook. Ai có share cho mình với. Cám ơn.<br/> Link : http://www.itmanagershandbook.com/</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21336.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21336/126858.html#126858,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Bạn vào menu Setup, Primary Domain, tab Delivery, chọn Always send every outbound email to the server specified below. Nhập các giá trị cần thiết vào Mail Server, username/pass cho Requires Authentication. Chúc bạn thành công.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/21.html">Thảo luận việc định hướng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21124.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21124/126271.html#126271,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody"><p></p>
<cite class="blockquote">No_Way wrote:</cite><br>
<blockquote> ĐHQG - ĐH Khoa Học Tự Nhiên ( đối diện nhà sách Nguyễn Văn Cừ Q5, quên địa chỉ rài nhưng ko khó kiếm cứ hỏi đường lên nhà sách NVC rùi nhìn qua mé bên kia đường là nó đó <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> )<br/> Thân &nbsp;
</blockquote><br/> ĐH Khoa học Tự nhiên nào mà đối diện nhà sách Nguyễn Văn Cừ trời. Đối diện nhà sách Nguyễn Văn Cừ là đường An Dương Vương. <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> Vì mình học ĐHKHTN ra mà. Cái trung tâm tin học ĐHKHTN nằm ngay sát trường KHTN luôn (227 Nguyễn Văn Cừ). Ở trong là đào tạo theo chương trình dài hạn : KTV, ..., ở phía trước là đào tạo theo chương trình quốc tế gì đó : MCSA, MCSE, MCDBA, .. và 1 số chương trình về lập trình viên.<br/><br/> Riêng học MCSA thì mình nghĩ bạn nên học Nhất nghệ, mình đã học ở đây và thấy kiến thức tiếp thu được là rất nhiều. Hiện nay thì Nhất nghệ cũng là Gold Partner của Microsoft rồi. Bạn vào trang web và diễn đàn của Nhất nghệ để tham khảo thêm.<br/><br/> Còn học CCNA thì mình nghĩ VNPRO là tốt nhất. Tuy nhiên, hơi xa nếu bạn ở trung tâm.<br/><br/> www.nhatnghe.com/forum<br/> www.vnpro.org/forum<br/><br/> P/S : Mình cũng là thành viên của cả 2 diễn đàn trên <img src="/hvaonline/images/smilies/3019f422209a6593f02fad5560f36b79.gif" border="0" alt="smilie" align="absbottom"> .</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/31.html">Thảo luận mạng và thiết bị mạng</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21249.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21249/126138.html#126138,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hi,<br/><br/> Công ty mình sử dụng mail Mdaemon offline, gởi mail thông qua Mail server trên hosting, trước đây vẫn gởi nhận bình thường. Gần đây lại có trường hợp xem trong log của Mdaemon thì mail đã đến người nhận, tuy nhiên, thật sự lại không đến được. Thử cho gởi mail trực tiếp không thông qua Mail server của hosting, xem trong log thì thấy báo là IP của mình nằm trong database của tụi Spamhaus và kêu vào đó remove ra. Vào trang www.spamhaus.org, đọc 1 hồi thì thấy nó giảng giải là có thể trong mạng mình có máy nào đó gởi mail hàng loạt ra do đó tụi nó sẽ đánh dấu IP của mình và không cho đến tay người nhận.<br/><br/> Thử gởi mail ở 1 mạng khác thì được.<br/><br/> 1. Hơi ngạc nhiên, vì khi mình gởi mail thông qua Mail Server trên Hosting (mà thằng này thì xịn rồi), liên quan gì đến IP (public, dynamic) của mình ? Sao nó có thể căn cứ vào đó để block không cho email đến được.<br/><br/> 2. Mình đã dùng các tool mà trang Spamhaus này khuyến cáo để diệt mass mail worm nhưng không tìm ra con nào cả.<br/> Cũng có thử gỡ Modem ra, lấy 1 máy laptop cài Etheral, gán IP cho máy này là IP của Modem, rồi chạy Etheral bắt traffic port 25 nhưng cũng chỉ thấy có máy mail Server gởi. Mà máy Mail Server đã scan bằng các tool trên, không thấy con worm nào cả. Mail Server có cài Symantec 10, luôn update.<br/><br/> Khi tắt Modem để lấy IP mới thì lại gởi được. Tuy nhiên, thật sự không an tâm vì mình vẫn chưa tìm được nguyên nhân.<br/><br/> Có bạn nào biết cách tìm ra nguyên nhân thì chỉ mình với. Cám ơn nhiều lắm.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21140.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21140/126092.html#126092,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hầu hết virus lây lan hiện nay ở VN là qua USB mà.<br/> Vô đây đầy nhóc --&gt; www.bkav.com.vn</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/28.html">Thảo luận virus, trojan, spyware, worm...</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/21236.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/21236/126088.html#126088,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Bạn thử gỡ ổng cứng ra, đem đến 1 máy khác sạch và cài chương trình Antivirus nào mà diệt được con này. Diệt xong, nếu không vào Windows được thì mới phải cài lại Windows.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/10759.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/10759/61967.html#61967,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Hi,<br/><br/> Mình muốn lưu Event log ( trên DC và trên các Server khác) 1 cách tự động. VD: Ngày 27/5/2007 Application log sẽ được lưu là App_270507.log<br/> Search trên mạng thì được 1 số tool của Microsoft như dumpel.exe, elogdmp.exe, psloglist.exe, ... nhưng không thể nào lập lịch lưu thành tên file như mình mong muốn.<br/><br/> Ai đã từng làm vụ lưu log lại ra file như vậy xin chỉ giúp. Thanks so much.<br/><br/> P/S: Hình như dumpel.exe không hỗ trở DNS log và Active Directory Log, nhưng tìm mãi chẳng thấy chổ download elogdmp.exe đâu. Ai biết chổ download chỉ dùm mình luôn. Thanks.<br/> </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/8206.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/8206/47839.html#47839,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Hi,<br/><br/> Mình sử dụng Mdaemon v8.0.3. Đang gặp vấn đề là user không nhận được mail nếu họ trong danh sách BCC list.<br/><br/> Mình tìm được thông tin sau trên MDaemon<br/> <i><br/> BCC Headers in MDaemon<br/> KBA-01291<br/><br/> Summary<br/><br/> --------------------------------------------------------------------------------<br/><br/><br/> BCC by definition is blind. The header should never be created by a mail client because the message should not display that it was sent to anyone in the BCC field. Here's what the headers look like when composing a message with a BCC:<br/><br/> Received: from robin ([127.0.0.1]) by test.mail ([127.0.0.1]) with SMTP (MDaemon.PRO.v6.0.5.R); Tue, 20 Aug 2002 10:09:15 -0400<br/> Reply-To: 'Robin' &lt;test@company.mail&gt;<br/> From: 'Robin' &lt;test@company.mail&gt;<br/> To: &lt;yep@company.mail&gt;<br/> Subject: test<br/><br/> There is no BCC info in the message even before it goes out to the Internet for delivery. (I BCCed <a href="mailto:robin@isp.com">robin@isp.com</a>.)<br/><br/> The way that BCC mail is routed is via the SMTP envelope information. Mail servers pass the message along via SMTP and the delivery information is kept in tact.<br/><br/> When you download the message via DomainPOP, MDaemon does not have the SMTP delivery information any longer. It has to make the best guess as to where the message should go.<br/><br/> Some ISPs stamp a header so that the SMTP delivery information is available for parsing, but it's not required. These headers may be “Envelope-To” or “Delivered-To” or something similar. Your ISP may be able to do something along these lines. Alternatively you could ask them if you could receive mail via ATRN instead of POP because then the SMTP envelope is still there. </i><br/><br/> Như vậy, để nhận được mail, mình phải nhờ bên Hosting Mail Server chèn thông tin vô Header ? ATRN thì mình không rành.<br/><br/> Trường hợp này theo mình cũng thường gặp lắm, bạn nào giải quyết rồi xin chia sẻ.<br/><br/> Cám ơn nhiều.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/8061.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/8061/47103.html#47103,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Mở port 3000. Trỏ vô máy MDaemon.</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/7953.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/7953/46707.html#46707,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row1" valign="top">
			<span class="postbody">Bạn nói rõ hơn về hệ thống mail bên bạn ra sao đi. Mọi người sẻ cùng góp ý để tìm ra hướng giải quyết. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">) </span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
	
					
        <tr>		
          <td class="postInfo">
			<table width="100%">				
              <tr>								
                <td align="left" >
				<span class="topmenu"><a href="/hvaonline/forums/show/23.html">Thảo luận hệ điều hành Windows</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/list/7953.html">Empty</a></span>
				<span class="topmenu"><img src="/hvaonline/templates/viet/images/en_US/arrow.gif">&nbsp;<a href="/hvaonline/posts/preList/7953/46308.html#46308,">Go to message</a></span>
              </tr>
			</table>
			</td>
        </tr>

        <tr>
        <!-- Message -->
          	<td class="row2" valign="top">
			<span class="postbody">Trong Mdaemon mặc định nó sẽ chọn chế độ gởi trực tiếp từ Mail Server nội bộ của bạn do đó dễ bị đưa vào Bulk. Để không bị trường hợp này, chỉnh lại gởi thông qua 1 Mail Server nào đó. ( Trong Primary DNS, tab Delivery).</span>
				
        <!-- Attachments -->
			</td>
        </tr>
		
					
        <tr>		
          <td class="spacerow" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
        </tr>
				
        <!-- END OF POST LISTING -->
			
				

			
      </table>
		
			<table cellspacing="2" cellpadding="2" width="100%" align="center" border="0">
				<tr>					
					
					<td valign="middle" align="left" colspan="0">
						<span class="nav">
						&nbsp;
						</span>
					</td>

					<td valign="middle" align="right">					
		<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap" align="right">
				<form action="" name="p" id="p" accept-charset="UTF-8"> 
					
					<span class="gensmall">Go to Page:&nbsp;</span>
					
					
						<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/posts/listByUser/'+ ( (this.options[this.selectedIndex].value - 1) * 30)  + '/71831' + '.html'; }" name="select2">
							<option value="-1" selected="selected">---</option>		
							
								<option value="1" selected="selected">1</option>	
								<option value="2" >2</option>	
						</select>
						
							<a href="/hvaonline/posts/listByUser/30/71831.html">
								<img src="/hvaonline/templates/viet/images/icon_next_page.gif" width="5" height="9" alt="Page 2" title="Page 2"/>
							</a>
						
						<a href="/hvaonline/posts/listByUser/30/71831.html">
							<img src="/hvaonline/templates/viet/images/icon_last_page.gif" width="8" height="9" alt="Last Page" title="Last Page (2)"/>
						</a>
				</form>
			</td>
		</tr>
		</table>
</td>
				</tr>
				
				<tr>
					<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="1" /></td>
				</tr>			
			</table>
		</td>
	</tr>
</table>


	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
