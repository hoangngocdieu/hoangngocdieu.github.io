<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Fogring HTTP request header with flash actionscript, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Fogring HTTP request header with flash actionscript - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<!-- navigator -->
<table cellspacing="2" cellpadding="2" width="100%" border="0" align="center">
	<tr>
		<td valign="baseline" align="left" colspan="0">
			<span class="nav">
			<a class="nav" href="/hvaonline/forums/list.html">Forum Index </a> 
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/forums/show/12.html">Thảo luận thâm nhập </a>
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/posts/list/2176.html" name="top" id="top">Fogring HTTP request header with flash actionscript</a>
				&nbsp;<a href="/hvaonline/rss/topicPosts/2176.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML"></a>
			</span>
		
		</td>

		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- poll show -->

  <!-- POST LISTING -->


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Fogring HTTP request header with flash actionscript<a name="11127" id="11127"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">31/07/2006 01:14:20 (+0700) | <a href="/hvaonline/posts/list/2176.html#11127">#1</a> | 11127 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/c815caa6693f1190d8d9226afd79b36e.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/56204.html"><b>hakuso</b></a><br>
	<font color="#3366CC">HVA Friend</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 04/01/2004 13:28:06<br>
		Messages: 287<br>
	
		Location: làng Đo Đo<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/56204.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/56204.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><font size='3'><b>Fogring HTTP request header with flash actionscript</b></font><br/> Nguồn:<span class="link"> http://www.derkeiler.com/Mailing-Lists/Securiteam/2006-07/msg00066.html</span><br/> Tác giả: <b>Amit Klein</b><br/> <br/> This write-up presents the mechanism that can be used to send arbitrary <br/> HTTP requests via Flash ActionScript. The security consequences for this <br/> ability are also discussed here.<br/> <br/> DETAILS<br/> <br/> Flash - Introduction<br/> -===================<br/> <br/> Flash player is a very popular browser add-on from Adobe (actually, Flash <br/> was invented by Macromedia, which was acquired<br/> by Adobe). This write-up covers mostly Flash 7 and Flash 8, together <br/> covering more than 94% of the Internet-enabled desktops (according to NPD <br/> Online Survey conducted April 2006, quoted in Adobe's website [1], [2]). <br/> Flash movies are delivered as SWF (ShockWave File) files. Adobe developed <br/> a rich Javascript-like language called ActionScript to provide scripting <br/> capabilities to Flash. One of the interesting features of ActionScript is <br/> its ability to send HTTP requests to 3rd party sites through the browser <br/> which invoked it. This is where Flash becomes interesting security-wise. <br/> With Flash it is possible to shape an outgoing request to a 3rd party site <br/> in ways not available from within "standard" Javascript. Specifically of <br/> interest is Flash's ability to send arbitrary HTTP request headers with <br/> outgoing HTTP requests.<br/> <br/> <br/> Sending arbitrary HTTP request headers with Flash<br/> -================================================<br/> <br/> The following is ActionScript 2.0 syntax for sending out a GET request (in <br/> this example, to<span class="link"> http://www.vuln.site/some/page.cgi?p1=v1&p2=v2</span>) with an <br/> arbitrary HTTP header (Foo: Bar). This code works with Flash 7 and Flash 8 <br/> (probably with Flash 6 as well):<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var req:LoadVars=new LoadVars&#40;&#41;;
req.addRequestHeader&#40;"Foo","Bar"&#41;;
req.send&#40;"http://www.vuln.site/some/page.cgi?p1=v1&p2=v2",
         "_blank","GET"&#41;;</pre>
		</div><br/> <br/> A similar syntax will send POST request (with the same header, to the same <br/> URL, and with body a=b&c=d):<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var req:LoadVars=new LoadVars&#40;&#41;;
req.addRequestHeader&#40;"Foo","Bar"&#41;;
req.decode&#40;"a=b&c=d"&#41;;
req.send&#40;"http://www.vuln.site/some/page.cgi?p1=v1&p2=v2",
         "_blank","POST"&#41;;</pre>
		</div><br/> <br/> (note: the LoadVars.decode() method was added in Flash 7, yet it's <br/> probably possible to compose an arbitrary POST body without it, so Flash 6 <br/> may be covered as well by this variant).<br/> <br/> The request is sent from the browser invoking the Flash object. Any <br/> cookies the browser normally sends, will be sent in those cases as well. <br/> The browser's User-Agent is sent, as well as all browser standard headers. <br/> HTTPS links are supported.<br/> <br/> This was successfully demonstrated with Microsoft IE 6.0, Microsoft IE 6.0 <br/> SP2 and FireFox 1.5.0.4, running Flash 8.0.22.0 and Flash 7.0.19.0.<br/> <br/> In IE, it is possible to overwrite some "normal" browser headers by simply <br/> calling addRequestHeader with the new value. This is applicable to both <br/> Referer and User-Agent. In FireFox 1.5.0.4, such headers, when used in <br/> addRequestHeader() will be appended to the HTTP request header section.<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>// One UA in IE 6.0 SP2, two UAs in FF 1.5.0.4
req.addRequestHeader&#40;"User-Agent","Hacker/1.0"&#41;;

// One Referer in IE 6.0 SP2, two Referers in FF 1.5.0.4
req.addRequestHeader&#40;"Referer","http://somewhere/"&#41;;</pre>
		</div><br/> <br/> In IE, it is also possible to overwrite some more sensitive headers (e.g. <br/> Host and Content-Length) by appending colon to the header name (this <br/> technique was described in [3] in the context of XmlHttpRequest):<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>req.addRequestHeader&#40;"Host:","foobar.site"&#41;;</pre>
		</div><br/> <br/> This technique doesn't appear to work in FireFox 1.5.0.4.<br/> <br/> Note: when the target URL is in the same domain with the Flash movie, <br/> LoadVars may be used to read the HTTP response data, thus making LoadVars <br/> the basis for many Flash-based AJAX-like frameworks (in analogy to <br/> Javascript's XmlHttpRequest object).<br/> <br/> <br/> The security implications<br/> -========================<br/> <br/> The ability of an attacker to force a victim's browser to send HTTP <br/> requests to 3rd party sites with arbitrary HTTP request headers has impact <br/> on our understanding of web application security - both on assessment of <br/> security-related phenomena, and on the validity of some security <br/> mechanisms.<br/> <br/> It is important to understand that the attacks described here are (in <br/> themselves) not cross-site scripting attacks, neither are they (strictly <br/> speaking) any breach of cross-domain trust in the Flash object or between <br/> the Flash object and the embedding HTML page. They merely make use of the <br/> fact that it's possible to send requests from a Flash object to any URL, <br/> with almost any HTTP headers the attacker needs. This in itself is the <br/> problem, as it enables an attacker to send a link (to an HTML page <br/> embedding a Flash object, or directly to a Flash object residing at the <br/> attacker's website) that will cause a Flash object to be executed in the <br/> victim's browser. This Flash object will send the HTTP request (with HTTP <br/> headers chosen by the attacker) to a target website, and this in turn will <br/> compromise the security of the browser (victim).<br/> <br/> In other words, the implicit assumption made by many software developers <br/> (and probably also by many security researchers) that most HTTP headers <br/> cannot be forced to have arbitrary values by an attacker who serves data <br/> to the victim browser is shown to be in error in this write-up.<br/> <br/> Example 1 - The "Expect" header<br/> -------------------------------<br/> <br/> In [4], an injection problem was described wherein Apache 1.3.34, 2.0.57 <br/> and 2.2.1 are vulnerable to injecting HTML data (including malicious <br/> Javascript code) through the Expect header. In [5], yours truly commented, <br/> with respect to this issue, that "Regarding XSS This phenomenon is not XSS <br/> per-se. Unless someone can show me how it is possible to force a browser <br/> to send the Expect header to the target site". But using a Flash object, <br/> the attack is trivial (the author is therefore answering his own question <br/> here...). Consider a victim (browser) that clicks the following link: <br/><span class="link"> http://www.evil.site/attack.swf</span><br/> <br/> This URL represents a Flash object that runs the following ActionScript <br/> code:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var req:LoadVars=new LoadVars&#40;&#41;;
  req.addRequestHeader&#40;"Expect",
                       "&lt;script&gt;alert&#40;'gotcha!'&#41;&lt;/script&gt;"&#41;;
  req.send&#40;"http://www.target.site/","_blank","GET"&#41;;</pre>
		</div><br/> <br/> This ActionScript sends a request from the victim's browser, to the target <br/> website<span class="link"> www.target.site</span>) with an Expect header containing malicious HTML <br/> (Javascript) code. If the target website runs a vulnerable version of <br/> Apache, the net result is cross site scripting. So to be clear - there's a <br/> working XSS attack against Apache 1.3.34, 2.0.57 and 2.2.1 (as long as the <br/> client browser is IE or Firefox, and it supports Flash 6/7+). As noted in <br/> [5], for Apache 2.0/2.2 the XSS response is returned by the server only <br/> after the request timeout elapses (typically few minutes). Please note <br/> though that a fix for the Apache server is available at all 3 branches (as <br/> Apache 1.3.35, 2.0.58 and 2.2.2 respectively).<br/> <br/> Example 2 - CSRF and Referer<br/> ----------------------------<br/> <br/> CSRF (Cross Site Request Forgery) attack is in essence the ability of an <br/> attacker to force a victim (browser) to effectively perform an action <br/> (send HTTP request) in a target site. This concept emerged several times, <br/> the first one probably on the Zope mailing list (as "Client Side Trojans", <br/> [6], and another time on BugTraq, under its now de-facto standard name, <br/> CSRF [7]. Both references suggest, among other measures, to rely on the <br/> HTTP Referer header as evidence that the browser emits the HTTP request <br/> from a link originating in the website. Indeed, considering the <br/> capabilities of HTML+Javascript, effectively spoofing the Referer is <br/> nearly impossible (one exception is [8], but it is effective only in a <br/> limited subset of scenarios; e.g. it is not effective when HTTPS is used). <br/> However, as can clearly be understood, with Flash this no longer holds, <br/> and Referer can be spoofed for requests to HTTPS resources, all the while <br/> having the browser send the site's cookies with the request. As <br/> demonstrated above, both GET requests (with arbitrary host and query <br/> parts) and POST requests (with arbitrary host and query parts, and body in <br/> the standard Content-Type format of "application/x-www-form-urlencoded") <br/> can be sent.<br/> <br/> Note: there are many other reasons not to rely on the Referer header, and <br/> this text is by no means the first one to warn against this practice.<br/> It should be obvious that any reasonable header (and combinations thereof) <br/> can be spoofed. In IE's case, the header provided by the attacker can <br/> replace the browser-provided header (e.g. Referer).<br/> In Firefox's case, the Referer spoofing technique may fail because Firefox <br/> adds the header at the bottom of the HTTP request headers. Still, some web <br/> applications may use the last value of the header, and as such be <br/> vulnerable to this technique.<br/> <br/> Plainly put, all this means that (reflective) cross site scripting attacks <br/> that make use of HTTP request headers (e.g. Referer, User-Agent, Expect, <br/> Host, Content-Type) to send the payload are now possible.<br/> <br/> <br/> Flash 9<br/> -======<br/> <br/> Flash 9 was announced June 28th, 2006 [9] (i.e. less than a month ago). In <br/> Flash 9, the techniques described above (for the LoadVars class) do not <br/> work for any browser-provided header (e.g. User-Agent, Host and Referer), <br/> nor probably for many "protected" headers such as Content-Length. Still, <br/> headers like Expect can be sent, so some attacks (e.g. Example 1 above) <br/> are still effective with Flash 9.<br/> <br/> <br/> Limitations of the technique<br/> -===========================<br/> <br/>  * The URL and the body part will always be URL-encoded. That is, it is <br/> impossible (so it seems) to force SP, HT, CR and   LF (and probably many <br/> other characters) to appear in their raw form in the request URL and body.<br/>  * Only GET and POST methods can be used.<br/>  * In IE, only one instance of each header can be sent.<br/> <br/>  * At large, the header section cannot be completely controlled, e.g. an <br/> attacker may have problems when attempting to send special characters <br/> inside headers.<br/> <br/> Partial solution<br/> -===============<br/> <br/> Notice the first limitation of the technique - it states that no raw CR <br/> and LF can be placed in the body section. This means that the technique <br/> cannot be used to send (POST) requests whose body complies with the <br/> "multipart/form-data" content-type format (this format uses raw CRs and <br/> LFs to mark headers and boundaries). In other words, a (POST) request <br/> whose body is a valid "multipart/form-data" stream is guaranteed (as far <br/> as today's knowledge extends) not to be sent from a Flash player. Web <br/> application authors can therefore use HTML forms whose ENCTYPE attribute <br/> is set to "multipart/form-data", and enforce that the submission contains <br/> a valid multipart/form-data body. Once these mechanisms are in place, and <br/> a request passes through, it is known not to originate from a Flash <br/> player, so the attack<br/> described here is irrelevant.<br/> <br/> This solution is of course intrusive - both the HTML pages and the <br/> receiving scripts must be altered to use (and enforce) <br/> multipart/form-data. With some web development platforms, this is trivial, <br/> yet in others (e.g. raw Perl, and ASP) it is not. Furthermore, in cases <br/> such as Example 1 above, the HTTP headers are interpreted and used by the <br/> (Apache) web server, and the control never reaches the web application <br/> layer, so in such cases, this solution is not applicable.<br/> <br/> Future directions<br/> -================<br/> <br/> HTTP Request Splitting ([8]) and HTTP Request Smuggling ([10]) - in IE + <br/> Flash 7/8 it is possible to send a Content-Length header with any value. <br/> This opens up an opportunity to perform HTTP Request Splitting attacks. <br/> Also, injecting Transfer-Encoding header, or a second Content-Length <br/> header may open up HTTP Request Smuggling. Further research is needed in <br/> order to understand whether these directions lead to viable exploitation <br/> techniques.<br/> <br/> Flash 9 - while experiments show that Flash 9 is more strict concerning <br/> which headers can be specified through LoadVars.addRequestHeader(), it's <br/> ActionScript 3.0 language is much richer than ActionScript 2.0. As such, <br/> it may open up several interesting opportunities at the HTTP level, e.g. <br/> the ability to send various HTTP methods, not just GET and POST (WebDAV <br/> anyone?). Flash 9 and ActionScript 3.0 should be studied better in order <br/> to understand what is their potential with respect to crafting HTTP <br/> requests.<br/> <br/> <br/> Conclusions<br/> -==========<br/> <br/> Relying on the authenticity of HTTP request headers when they are sent <br/> from a browser is not a good idea. Practically every header can be spoofed <br/> if the client can be forced to run a malicious Flash movie, and this is <br/> probably applicable to over 80% of the Internet desktops (i.e. Internet <br/> desktops running IE + Flash 7/ 8 ). Consequently, the applicability of cross <br/> site scripting attacks based on such headers, as well as cross site <br/> request forgery attacks (against sites which protect themselves by <br/> checking the Referer header) is higher than many people may perceive.<br/> <br/> A partial solution to the latter case was suggested in the write-up, <br/> however it is strongly tied to the specific technology used - Flash, and <br/> as such may not provide any protection against variants that make use of a <br/> different technology, or against developments in Flash itself. For <br/> cross-site request forgery, therefore, different solutions, not relying on <br/> Referer, should be considered.<br/> <br/> References<br/> -=========<br/> <br/> [1] "Technology Breakdown" (Adobe website)  <br/><span class="link"> http://www.adobe.com/products/player_census/flashplayer/tech_breakdown.html</span><br/> <br/> [2] "Macromedia Flash Player Version Penetration" (Adobe website)  <br/><span class="link"> http://www.adobe.com/products/player_census/flashplayer/version_penetration.html</span><br/> <br/> [3] "Re: 'Exploiting the XmlHttpRequest object in IE' - paper by Amit <br/> Klein" by Anonymous, BugTraq posting, September 27th, 2005 <br/><span class="link"> http://www.securityfocus.com/archive/1/411823</span><br/> <br/> [4] "Unfiltered Header Injection in Apache 1.3.34/2.0.57/2.2.1" by Thiago <br/> Zaninotti, BugTraq posting, May 8th, 2006  <br/><span class="link"> http://www.securityfocus.com/archive/1/433280</span><br/> <br/> [5] "Re: Unfiltered Header Injection in Apache 1.3.34/2.0.57/2.2.1" by <br/> Amit Klein, BugTraq posting, May 18th, 2006  <br/><span class="link"> http://www.securityfocus.com/archive/1/434729</span><br/> <br/> [6] "Client Side Trojans", Zope developers mailing list, May 2000  <br/><span class="link"> http://www.zope.org/Members/jim/ZopeSecurity/ClientSideTrojan</span><br/> <br/> [7] "Cross Site Request Forgeries" by Peter Watkins, BugTraq posting, June 15th, 2001  <br/><span class="link"> http://www.tux.org/~peterw/csrf.txt</span><br/> <br/> [8] "Exploiting the XmlHttpRequest object in IE - Referrer spoofing, and a <br/> lot more..." by Amit Klein, BugTraq posting, September 24th, 2005  <br/><span class="link"> http://www.securityfocus.com/archive/1/411585</span><br/> <br/> [9] "Adobe Flash Player 9 Leads a New Generation of Dynamic Media and Rich Internet Applications" (Adobe website), June 28th, 2006  <br/><span class="link"> http://www.adobe.com/aboutadobe/pressroom/pressreleases/200606/062806Flash9.html</span><br/> <br/> [10] "HTTP Request Smuggling" by Chaim Linhart, Amit Klein, Ronen Heled <br/> and Steve Orrin, June 6th, 2005  <br/><span class="link"> http://www.cgisecurity.com/lib/HTTP-Request-Smuggling.pdf</span><br/> <br/> <br/> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">Live, fight, work and study</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Fogring HTTP request header with flash actionscript<a name="11128" id="11128"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">31/07/2006 01:18:17 (+0700) | <a href="/hvaonline/posts/list/2176.html#11128">#2</a> | 11128 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/c815caa6693f1190d8d9226afd79b36e.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/56204.html"><b>hakuso</b></a><br>
	<font color="#3366CC">HVA Friend</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 04/01/2004 13:28:06<br>
		Messages: 287<br>
	
		Location: làng Đo Đo<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/56204.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/56204.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><br/> <br/> <font size='3'><b>Gửi các header của HTTP request bằng ActionScript trong Flash</b></font><br/> <br/> Bài viết này sẽ trình bày cơ chế dùng để gửi các HTTP request bất kì bằng ActionScript trong Flash. Hậu quả về khía cạnh bảo mật của kỹ thuật này cũng được bàn đến trong đây<br/> <br/> Thông tin về Flash<br/> ==========================<br/> Flash Player là môt tiện ích phụ trợ (add-on) rất phổ biến ,dùng cho trình duyệt Web , do Adoble đưa ra (thật ra thì ban đầu hãng Macromedia phát minh ra Flash, sau này được Adobe mua lại). Bài viết sẽ nhắm đến Flash ở phiên bản 7 và 8, cùng với hầu như 94% các máy tính để bàn có kết nối Internet (theo NPD Online Survey cung cấp vào tháng 4/2006, trích ở website của Adobe [1],[2]). Các phim dạng flash (flash movies) được truyền tải theo định dạng SWF (ShockWave File). Adobe đã phát triển một ngôn ngữ rất mạnh và giống như Javascript gọi là ActionScript. Ngôn ngữ này (ActionScript) cho phép khả năng dùng nó để soạn thảo các chương trình nhỏ ( Script ) chạy bên trong Flash . Một trong những đặc điểm thú vị của ActionScript là khả năng gửi HTTP request đến những site thứ ba ,thông qua trình duyệt đang chạy ActionScript này. Chính đặc điểm này làm cho Flash trở thành góc độ bảo mật thú vị.  Với Flash có thể sửa đổi đươc (nội dung) các yêu cầu (request) gửi đến môt site thứ ba , trong khi các 'STANDARD' JavaScript không làm đươc như vậy . Khả năng gửi các HTTP header cùng với HTTP request chính là điểm quan trọng đặc biệt của Flash.<br/> <br/> <br/> Gửi các HTTP header bằng Flash<br/> ================================================<br/> Mã ActionScript 2.0 dưới đây sẽ thực hiện việc gửi một request dạng GET (giả sử đến website<span class="link"> http://www.vuln.site/some/page.cgi?p1=v1&p2=v2</span>) cùng với một HTTP header bất kì (Foo:Bar). Mã này hoạt động trong Flash 7 và 8 (cũng như là Flash 6)<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var req:LoadVars=new LoadVars&#40;&#41;;
req.addRequestHeader&#40; "Foo", "Bar" &#41;;
req.send&#40; "http://www.vuln.site/some/page.cgi?p1=v1&p2=v2",
        "_blank", "GET" &#41;;</pre>
		</div><br/> <br/> Đoạn mã dưới đây cũng tương tự như trên nhưng với request dạng POST (cùng URL và tham số là a=b&c=d)<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var req:LoadVars=new LoadVars&#40;&#41;;
req.addRequestHeader&#40; "Foo", "Bar" &#41;;
req.decode&#40; "a=b&c=d" &#41;;
req.send&#40; "http://www.vuln.site/some/page.cgi?p1=v1&p2=v2",
          "_blank", "POST" &#41;;</pre>
		</div><br/>  <br/> (chú ý: phương thức LoadVars.decode() được bổ sung trong Flash 7, nếu không dùng phương thức này ta cũng có thể tự thực hiện, ở Flash 6 thì làm khác nhau một chút).<br/> <br/> Đối tượng Flash nằm trong trình duyệt thực hiện việc gửi request, đồng thời nó cũng gửi kèm theo cookie (giống như trình duyệt vẫn làm khi gửi request). Flash cũng gửi User-Agent của trình duyệt cùng với mọi header chuẩn khác. Nó cũng hỗ trợ liên kết HTTPS.<br/> <br/> Các công việc trên đã thực hiện thành công ở Microsoft IE 6.0, Microsoft IE 6.0 SP2 và Firefox 1.5.0.4, các trình duyệt đó đều chạy Flash 8.0.22.0 và Flash 7.0.19.0<br/>  <br/> Trong IE, lời gọi hàm addRequestHeader sẽ thay thế giá trị các header thông thường của trình duyệt, bao gồm cả Referer và User-Agent. Trong Firefox 1.5.0.4, khi dùng các header đó trong hàm addRequestHeader thì chúng (header) sẽ được đưa vào cuối sector header của HTTP request<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>// tạo một header UA trong IE 6.0 SP2 và 2 header UA trong FF 1.5.0.4
req.addRequestHeader&#40;"User-Agent","Hacker/1.0"&#41;;
 
// tạo một header Referer trong IE 6.0 SP2 và 2 header Referer trong FF 1.5.0.4
req.addRequestHeader&#40;"Referer","http://somewhere/"&#41;;</pre>
		</div><br/> <br/> Cũng có thể thay giá trị của nhiều header quan trọng khác trong IE bằng cách thêm dấu hai chấm ( : ) sau tên header (kĩ thuật này sẽ mô tả ở [3] trong nội dung XmlHttpRequest)<br/>  <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>req.addRequestHeader&#40;"Host:","foobar.site"&#41;;</pre>
		</div><br/>  <br/> Tuy nhiên cách này sẽ không làm được trên Firefox 1.5.0.4<br/> <br/> Chú ý: khi URL truy cập đến là nằm trong cùng domain với Flash, ta có thể dùng LoadVars để đọc dữ liệu HTTP response, thấy rõ rằng cách dùng LoadVars là điểm cơ bản trong nhiều framework dạng AJAX mà dựa trên Flash (tựa như đối tượng XmlHttpRequest trong Javascript)<br/> <br/>  <br/> The security implications<br/>  ========================<br/>  <br/> Khả năng một kẻ tấn công buộc trình duyệt của nạn nhân gởi HTTP request chứa các header bất kì đến các site khác đã tạo ấn tượng mạnh đến sự hiểu biết về bảo mật ứng dụng web của chúng tôi - kể cả việc đánh giá hiện tượng liên quan bảo mật lẫn tính minh xác của một số cơ chế bảo mật.<br/> <br/> Điều quan trọng là phải hiểu những cách tấn công được mô tả ở đây không phải là tấn công cross-site scripting, không phải dạng cross-site-scripting (nói một cách chính xác) mà cũng chẳng phải dạng xâm phạm tín thực liên vùng (cross-domain trust) trong object của Flash hoặc giữa các Flash object và các trang nhúng HTML<br/> <br/> Sự thật thì đối tượng Flash có thể gửi request đến bất kì URL nào và với bất kì HTTP header nào mà kẻ tấn công muốn. Vấn đề chính là điều này, nó cho phép kẻ tấn công gửi một liên kết (đến một trang HTML có nhúng đối tượng Flash, hay đến thẳng đối tượng Flash nằm trên website của kẻ tấn công), liên kết này cho phép đối tượng Flash sẽ chạy trên trình duyệt của nạn nhân. Chính đối tượng Flash này sẽ gửi HTTP request (cùng với các HTTP header mà kẻ tấn công đã chọn trước) đến website mong muốn và điều này sẽ làm hại đến trình duyệt (của nạn nhân)<br/>  <br/> Nói cách khác, nhiều nhà phát triển phần mềm (và cũng có thể là các nhà nghiên cứu bảo mật) luôn cho rằng hầu hết các HTTP header không thể bị kẻ tấn công thay đổi bằng một giá trị bất kì. Bài viết sẽ chỉ ra sự sai lầm và cũng là lỗi trong cách hiểu này<br/>  <br/> VD 1: header "Expect"<br/> ------------------------------------<br/> <br/> Trong [4], một lỗi nằm trong trong Apache 1.3.34, 2.0.57 và 2.2.1 xem là nguy hiểm vì có thể chèn dữ liệu HTML vào trong header Expect. Tại [5], những lời góp ý chân thành, liên quan đến "Nói về XSS, hiện tượng này không phải là XSS như đã thấy. Trừ phi ai đó cho tôi thấy rằng làm thế nào để làm cho trình duyệt gửi header Expect đến website mong muốn". Nhưng khi dùng đối tượng Flash, việc tấn công trở nên dễ dàng. Hãy xem khi nạn nhân click vào link dưới đây:<span class="link"> http://www.evil.site/attack.swf</span><br/> <br/> URL này là một đối tượng Flash, đối tượng này sẽ chạy các ActionScript sau<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>var req:LoadVars=new LoadVars&#40;&#41;;
req.addRequestHeader&#40; "Expect",
                        "&lt;script&gt;alert&#40;'gotcha!'&#41;&lt;/script&gt;" &#41;;
req.send&#40; "http://www.target.site/", "_blank", "GET" &#41;;</pre>
		</div><br/>  <br/> ActionScript này gửi một request từ trình duyệt nạn nhân đến website www.target.site, trong request có header Expect chứa mã HTML (Javascript) gây hại. Nếu website bị tấn công<span class="link"> www.target.site</span>) chạy phiên bản Apache bị lỗi, kết quả tiếp theo sẽ là cross-site scripting. Vì thế đã rõ ràng - Apache phiên bản 1.3.34, 2.0.57 và 2.2.1 sẽ bị tấn công XSS (cùng với trình duyệt là IE hay Firefox và hỗ trợ Flash 6, 7). Trong [5] cũng lưu ý với Aapche 2.0/2.2, server trả về XSS response chỉ sau khi hết thời gian timeout của request. Xin nói thêm là Apache đã sửa lỗi này trên cả 3 phiên bản trên<br/> <br/>  VD 2 - CSRF và Referer<br/> ------------------------------------------<br/>  <br/> Tấn công CSRF (Cross Site Request Forgery) là kĩ năng cần thiết để một kẻ tấn công buộc trình duyệt nạn nhân thực hiện một thao tác (gửi HTTP request) đến website mong muốn. Khái niệm này được nói đến một vài lần, đầu tiên là trên mailing list Zope (với tiêu đề "Client Side Trojans", [6], và một lần khác tại BugTraq, dưới tiêu đề này, bây giờ nó đã trở thành tên bán tiêu chuẩn, CSRF [7]. Cả 2 bài góp ý trên, đều dựa trên header Referer như là dấu hiệu để trình duyệt sinh ra HTTP request có liên kết bắt nguồn từ trong website. Thật ra, nếu chỉ dùng HTML và Javascript thì không thể giả mạo Referer (trừ ngoại lệ trong [8], nhưng điều này chỉ hiệu quả trong một số điều kiện giới hạn; như khi sử dụng HTTPS thì không hiệu quả). Tuy nhiên, rõ ràng rằng với Flash thì đièu này không thành vấn đề, và Referer có thể bị giả mạo để yêu cầu các tài nguyên HTTPS, mọi thứ trong khi trình duyệt gởi cookie của site với request. Như phía trên đã minh hoạ, cả request dạng GET (với host và query bất kì) và POST (với phần host, query và phần thân theo định dạng chuẩn Content-Type là "application/x-www-form-urlencoded") đều gửi đi được.<br/> <br/> Chú ý: đoạn phân tích trên không có nghĩa là chỉ có header Referer là bị giả mạo. Nên thấy rõ rằng bất kì header nào cũng có thể bị giả mạo. Trong trường hợp của IE, kẻ tấn công tạo các header giả để thay đổi header của trình duyệt (như là Referer). <br/> Với Firefox, kỹ thuật giả mạo Referer không thể làm được vì Firefox thêm header vào bên dưới cùng của các header HTTP request. Tuy nhiên, một số ứng dụng web vẫn có thể vẫn dùng giá trị cuối của header, và như thế vẫn có thể bị nguy hiểm đối với kỹ thuật này<br/> <br/> Hiện nay, mọi khả năng tấn công cross-site scripting qua các header HTTP request (Referer, User-Agent, Expect, Host, Content-Type) đều làm được.<br/>  <br/> Flash 9<br/> ==============<br/> <br/> Flash 9 được thông báo vào ngày 28/06/2006 [9]. Ở Flash 9, những kĩ thuật đã nói trên (như dùng lớp LoadVars) không hỗ trợ các header mà trình duyệt dùng (như User-Agent, Host and Referer) và các header được bảo vệ như Content-Length. Tuy nhiên, các header như Expect vẫn được gữi đi và một vào kiểu tấn công (như VD 1 trên) vẫn hiệu quả trong Flash 9<br/>  <br/>  <br/>  <br/> Những giới hạn<br/> ===========================<br/>  <br/>  * URL và phần body luôn ở dạng URL-encoded (URL được mã hoá). Tức là không thể cho các kí tự SP, HT, CR và LF (và nhiều kí tự khác) hiển thị ở dạng raw trong request URL và body.<br/>  * Chỉ có thể dùng GET và POST<br/>  * Trong IE, chỉ có header của mỗi lần truy cập được gởi một lần<br/> <br/>  * Tổng quát, không thể điều chỉnh hoàn toàn section header (kẻ tấn công sẽ gặp rắc rối khi muốn gửi những kí tự đặc biệt trong các header)<br/> <br/> Giải pháp đơn phần<br/> ===============<br/> <br/> Hãy chú ý hạn chế đầu tiên của kĩ thuật này - kí tự CR và LF không thể đặt trong section body ở định dạng raw. Nghĩa là cơ chế này không thể dùng để gửi request POST mà phần body của request này được biên dịch thành content-type là  "multipart/form-data" (định dạng này dùng các kí tự CR,LF ở dạng raw để đánh dấu phần header với body). Nói cách khác, một Flash player không thể gửi đi POST request mà phần body của nó là một luồng "multipart/form-data" hợp lệ được. Vì thế, tác giả của những ứng dụng web có thể dùng các HTML form và đặt thuộc tính ENCTYPE là "multipart/form-data", điều này đảm bảo rằng thông tin đưa lên web với body multipart/form-data hoàn toàn hợp lệ. Một khi dùng cách này thì ta có thể biết được request đi đến có xuất phát từ Flash player hay không, và việc phá hoại sẽ trở nên vô tác dụng.<br/> <br/> <br/> Giải pháp này dĩ nhiên hơi áp đặt - cả trang HTML và script phải được sửa đồi để dùng multipart/form-data. Với vài nền tảng phát triển web, điều này là bình thường, còn với số khác (raw Perl, ASP) thì không. Hơn nữa, trong trường hợp như VD 1 trên, web server (Apache) thông dịch rồi sử dụng các HTTP header, và tiến trình này sẽ không đi đến lớp ứng dụng web, vì vậy trong những trường hợp như thế, giải pháp này không áp dụng được<br/> <br/>  Hướng dẫn thêm<br/> ================<br/> <br/> HTTP Request Splitting ([8]) và HTTP Request Smuggling ([10]) trong IE với Flash 7/8 có thể gữi header Content-Length với bất kì giá trị nào. Điều này cho phép thực hiện tấn công HTTP Request Splitting. Cũng như thế, việc chèn header Transfer-Encoding, hay thêm một header Content-Length thứ hai sẽ mơ ra cơ hội cho HTTP Request Smuggling. Cần phải nghiên cứu xa hơn để nắm rõ những cách thực hiện như vậy có đưa đến khả năng khai thác lỗi hay không<br/>  <br/> Các kinh nghiệm đã cho phép Flash 9 giới hạn nhiều hơn những header sẽ dùng trong LoadVars.addRequestHeader(), ngôn ngữ ActionScript 3.0 sẽ mạnh hơn là 2.0. Như thế, phiên bản mới này cung cấp những tính năng đáng giá tại mức HTTP, như là khả năng gửi nhiều loại HTTP, không chĩ GET và POST. Tốt hơn nên tìm hiểu Flash 9 và ActionScript 3.0 để nắm rõ những tiềm năng của chúng, lưu ý về các mẹo trong HTTP request<br/>  <br/> <br/>  Kết luận<br/>  -==========<br/>  <br/> Việc xác thực dựa trên các header của HTTP request mà trình duyệt gửi đi không phải là ý hay. Thực tế thì mọi header có thể bị giả nếu client đang phải chạy một Flash movie xấu, và điều này hoàn toàn đúng với trên 80% máy tính để bàn truy cập Internet. Do đó, khả năng tấn công cross-site scripting trên những header như trên, cũng như tấn công bằng các request giả để cross site (cho những site mà tự bảo vệ bằng cách kiểm tra header Referer) là cao hơn so với những gì người ta nhận thấy<br/> <br/> Bài viết khuyên nên dùng giải pháp đơn phần cho trường hợp về sau, tuy nhiên giải pháp này phụ thuộc rất nhiều vào Flash, và như thế có thể không cung cấp phần bảo vệ chống đỡ những biến thái được sử dụng với các công nghệ khác, hoặc những phát triển khác trong Flash. Vì thế, với giả mạo request cross site, nên xem xét những giải pháp khác mà không dựa vào Referer<br/> <br/> <br/>  Tham khảo<br/>  -=========<br/>  <br/>  [1] "Technology Breakdown" (Adobe website)  <br/><span class="link"> http://www.adobe.com/products/player_census/flashplayer/tech_breakdown.html</span><br/>  <br/>  [2] "Macromedia Flash Player Version Penetration" (Adobe website)  <br/><span class="link"> http://www.adobe.com/products/player_census/flashplayer/version_penetration.html</span><br/>  <br/>  [3] "Re: 'Exploiting the XmlHttpRequest object in IE' - paper by Amit <br/>  Klein" by Anonymous, BugTraq posting, September 27th, 2005 <br/><span class="link"> http://www.securityfocus.com/archive/1/411823</span><br/>  <br/>  [4] "Unfiltered Header Injection in Apache 1.3.34/2.0.57/2.2.1" by Thiago <br/>  Zaninotti, BugTraq posting, May 8th, 2006  <br/><span class="link"> http://www.securityfocus.com/archive/1/433280</span><br/>  <br/>  [5] "Re: Unfiltered Header Injection in Apache 1.3.34/2.0.57/2.2.1" by <br/>  Amit Klein, BugTraq posting, May 18th, 2006  <br/><span class="link"> http://www.securityfocus.com/archive/1/434729</span><br/>  <br/>  [6] "Client Side Trojans", Zope developers mailing list, May 2000  <br/><span class="link"> http://www.zope.org/Members/jim/ZopeSecurity/ClientSideTrojan</span><br/>  <br/>  [7] "Cross Site Request Forgeries" by Peter Watkins, BugTraq posting, June <br/>  15th, 2001  <br/><span class="link"> http://www.tux.org/~peterw/csrf.txt</span><br/>  <br/>  [8] "Exploiting the XmlHttpRequest object in IE - Referrer spoofing, and a <br/>  lot more..." by Amit Klein, BugTraq posting,<br/>  September 24th, 2005  <br/><span class="link"> http://www.securityfocus.com/archive/1/411585</span><br/>  <br/>  [9] "Adobe Flash Player 9 Leads a New Generation of Dynamic Media and Rich <br/>  Internet Applications" (Adobe website), June 28th, 2006  <br/><span class="link"> http://www.adobe.com/aboutadobe/pressroom/pressreleases/200606/062806Flash9.html</span><br/>  <br/>  [10] "HTTP Request Smuggling" by Chaim Linhart, Amit Klein, Ronen Heled <br/>  and Steve Orrin, June 6th, 2005  <br/> <span class="link"> http://www.cgisecurity.com/lib/HTTP-Request-Smuggling.pdf</span><br/> <br/> <br/> Người dịch: hakuso - Nhóm dịch thuật HVA<br/> <br/> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">Live, fight, work and study</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- quick reply -->
<table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0" align="center">
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left">
			<!-- watch - unwatch -->
			<!-- add bookmark -->

		</td>
		<td align="right" valign="bottom">			
		</td>
	</tr>
</table>

<!-- mod -->

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- combo navigator -->
<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left"><a href="http://digg.com/submit?phrase=2&url=/hvaonline/posts/list/2176.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=/hvaonline/posts/list/2176.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=/hvaonline/posts/list/2176.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=/hvaonline/posts/list/2176.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=/hvaonline/posts/list/2176.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=/hvaonline/posts/list/2176.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=/hvaonline/posts/list/2176.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
		<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<span class="gensmall">Go to:&nbsp;</span>
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/forums/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Select a forum</option>				
							<option value="0">-------------</option>
									<option value="2" >Thông báo từ HVA</option>
									<option value="41" >FAQ - Các câu hỏi thường gặp</option>
									<option value="5" >Góp ý và Hỏi đáp thắc mắc chung</option>
									<option value="6" >Kiểm tra bảo mật</option>
							<option value="0">-------------</option>
									<option value="8" >Thảo luận bảo mật</option>
									<option value="12" selected="selected">Thảo luận thâm nhập</option>
									<option value="28" >Thảo luận virus, trojan, spyware, worm...</option>
									<option value="36" >Thủ thuật reverse engineering</option>
									<option value="13" >Thông tin new bugs và exploits</option>
									<option value="51" >Case Studies</option>
							<option value="0">-------------</option>
									<option value="23" >Thảo luận hệ điều hành Windows</option>
									<option value="24" >Thảo luận hệ điều hành *nix</option>
									<option value="26" >Thảo luận các loại thiết bị máy tính</option>
									<option value="31" >Thảo luận mạng và thiết bị mạng</option>
									<option value="27" >Thông tin về các địa chỉ và tài liệu hữu ích</option>
							<option value="0">-------------</option>
									<option value="44" >Người tìm việc - Việc tìm người</option>
									<option value="21" >Thảo luận việc định hướng</option>
									<option value="19" >Những thảo luận khác</option>
									<option value="50" >Hình minh họa</option>
									<option value="33" >Trash</option>
							<option value="0">-------------</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- list users in -->
<table class="forumline" cellspacing="3" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<th class="thright"  nowrap="nowrap" height="26" valign="middle">&nbsp;Users currently in here&nbsp;</th>
	</tr>
		<tr>
			<td class="gensmall" valign="middle" align="left">
				1 Anonymous 
				
			</td>	
		</tr>
</table>
<a name="quick"></a>

<table cellspacing="0" cellpadding="0" width="100%" border="0"  align="center">

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
</table>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/avim.js"></script>
<script type="text/javascript">
<!--
function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}




function maxImg(foto, maxSize){
w = foto.width;
if (w > maxSize){
	foto.width = maxSize;
	}
} 

-->
</script>
