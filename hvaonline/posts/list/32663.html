<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Thiết lập DNS server với DJBDNS trên nền FreeBSD, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Thiết lập DNS server với DJBDNS trên nền FreeBSD - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<!-- navigator -->
<table cellspacing="2" cellpadding="2" width="100%" border="0" align="center">
	<tr>
		<td valign="baseline" align="left" colspan="0">
			<span class="nav">
			<a class="nav" href="/hvaonline/forums/list.html">Forum Index </a> 
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix </a>
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/posts/list/32663.html" name="top" id="top">Thiết lập DNS server với DJBDNS trên nền FreeBSD</a>
				&nbsp;<a href="/hvaonline/rss/topicPosts/32663.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML"></a>
			</span>
		
		</td>

		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- poll show -->

  <!-- POST LISTING -->


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Thiết lập DNS server với DJBDNS trên nền FreeBSD<a name="201556" id="201556"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">21/12/2009 23:53:10 (+0700) | <a href="/hvaonline/posts/list/32663.html#201556">#1</a> | 201556 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/75472.html"><b>facialz</b></a><br>
	<font color="#33CC33">Elite Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 20/07/2004 03:48:17<br>
		Messages: 197<br>
	
		Location: HoChiMinh city<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/75472.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/75472.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><font size='+1'><b>THIẾT LẬP DNS SERVER<br/> với DJBDNS trên nền FreeBSD</b></font><br/> <br/> <br/> <b>1  Vì sao, khi nào dùng DJBDNS</b><br/> <br/> Gói <b>djbdns</b>, gói phần mềm DNS server nổi tiếng của Daniel J. Bernstein, có nhiều ưu điểm:<br/> <ul><li>Nhanh: trong một benchmark [6], djbdns mất bình quân 327 ms để giải xong một tên miền, trong khi BIND mất 5179 ms.</li><li> Gọn: djbdns chỉ có 7000 lệnh, BIND có 100000 [6, 8].</li><li> Yêu cầu thấp: djbdns chỉ chiếm dụng khoảng 2 MB khi mới khởi động và khoảng 10 MB sau nửa triệu truy vấn, trong khi ở BIND con số tương ứng lần lượt là 30 MB và 57 MB [6]. </li><li> Bảo mật cao: trong suốt lịch sử 19 năm của mình (1991 – 2009) djbdns chỉ có 2 lỗi đã được phát hiện. Còn BIND chỉ trong 19 năm (1983 – 2002) đã có 672 lỗi [9].</li><li> Thông dụng: theo một thống kê tháng 11/2008, Internet có 78,1 triệu tên miền .com, trong đó ít nhất 4,6 triệu được đặt trên các máy chủ sử dụng <b>djbdns</b>. Với số lượng đó, <b>djbdns</b> đứng thứ tư về độ thông dụng, chỉ sau <b>BIND</b> (20,6 triệu), <b>MyDNS</b> (17,8 triệu), và <b>PowerDNS</b> (6,6 triệu) [7].</li></ul><br/> Với các ưu điểm đó, <b>djbdns</b> có thể dùng được trong mọi trường hợp, và đặc biệt thích hợp trong trường hợp phần cứng thấp và tải lớn.<br/> <br/> <br/> <br/> <b>2  Cấu hình tổng thể</b><br/> <br/> Gói phần mềm <b>djbdns</b> có vài chương trình, trong đó chúng ta sẽ cài đặt hai chương trình chính: <b>tinydns</b> và <b>dnscache</b>. <u>Tinydns</u> là chương trình chuyên dùng để làm DNS server <u>có thẩm quyền</u> (authoritative), nghĩa là có nhiệm vụ công bố các địa chỉ Internet của miền nào đó mà chúng ta sở hữu, ví dụ, mycompany.com.<u>Dnscache</u> là chương trình chuyên dùng để làm DNS cache, nghĩa là có nhiệm vụ tìm hộ địa chỉ Internet của mọi miền, kể cả mycompany.com.<br/> <br/> Hai chương trình này sẽ được cài đặt lên cùng một máy tính có 1 NIC, mà chúng ta sẽ gọi là <u>máy chủ DNS</u>, và sẽ được cấu hình cùng lắng nghe trên cổng 53 nhưng phải là trên các interface khác nhau (nói chính xác hơn, trên các địa chỉ IP khác nhau). Chương trình <b>dnscache</b> sẽ được cấu hình lắng nghe trên interface chính (ví dụ, 192.168.12.10) và chỉ phục vụ các client cục bộ (ví dụ, 192.168.0.0/16 và 10.0.0.0/24). Chương trình <b>tinydns</b> sẽ được cấu hình lắng nghe trên loopback interface (ví dụ, 127.0.0.1).<br/> <br/> Mọi DNS client cục bộ, kể cả resolver (DNS client của chính bản thân máy chủ DNS), sẽ được cấu hình để truy vấn địa chỉ Internet ở interface chính. Tại đó, <b>dnscache</b> sẽ tìm kiếm câu trả lời trong cache và nếu không tìm thấy, sẽ lần lượt truy vấn theo dây chuyền bắt đầu từ các DNS server có thẩm quyền giải tên <u>miền gốc</u> (root) lần đến tận DNS server có thẩm quyền giải tên miền cần hỏi để có câu trả lời cuối cùng. <br/> <br/> Có một ngoại lệ mà chúng ta sẽ thực hiện là nếu tên miền cần tìm thuộc mycompany.com hoặc nếu địa chỉ IP cần giải (ngược) là địa chỉ IP mạng cục bộ (ví dụ, 192.168.18.10), <b>dnscache</b> sẽ không lần theo dây chuyền các DNS server có thẩm quyền mà sẽ lập tức chuyển truy vấn sang loopback interface (127.0.0.1) cho <b>tinydns</b> giải đáp ngay. Ngoại lệ như thế là không cần thiết nếu như <b>tinydns</b> của chúng ta đã <u>được uỷ quyền</u> (delegated) của nhà đăng ký DNS cho phép quản lý miền mycompany.com. Nhưng thực tế do hợp đồng với nhà đăng ký, chúng ta không được uỷ quyền quản lý miền mycompany.com. <b>Tinydns</b> của chúng ta không tồn tại trong cơ sở dữ liệu của nhà đăng ký và do đó, chính thức mà nói thì nó không phải là DNS server có thẩm quyền giải tên mycompany.com cho bất kỳ DNS client nào. Muốn <b>tinydns</b> có thể phục vụ được thì phải làm ra ngoại lệ. Cũng vì lý do đó, <b>tinydns</b> chỉ phục vụ riêng cho những client trong mạng cục bộ chứ không thể phục vụ công chúng được. Ngoại lệ trên đây là duy nhất. Ta sẽ không cấu hình <b>dnscache</b> dùng bất cứ DNS forwarder nào khác, dù là server của ISP hay là server có uy tín như OpenDNS,...<br/> <br/> Do tính năng đã được lập trình sẵn, <b>dnscache</b> sẽ lưu lại mọi câu trả lời trong cache để phục vụ cho những truy vấn về sau và để bảo mật, cache này chỉ nằm trong RAM và sẽ bị xoá khi khởi động. Tuy vậy, trong trường hợp (hết sức đặc biệt) nào đó ta vẫn có thể cho <b>dnscache</b> lưu cache ra đĩa cứng bằng miếng vá tính năng PERSISTENT CACHE.<br/> <br/> Bài này ghi chép quy trình cài đặt và cấu hình <b>djbdns v.1.05</b> trên hệ điều hành <b>FreeBSD v.8</b>. Các lý giải sâu về cấu hình tổng thể, các giải thích chi tiết từng bước của quá trình cài đặt, hay các phương pháp kiểm tra và giải quyết trục trặc có thể tìm thấy ở trong những nguồn trực tuyến, rất đầy đủ và phong phú, kể cả bằng tiếng Việt (xem danh mục tài liệu tham khảo).<br/> <br/> <br/> <br/> <b>3  Cài đặt và cấu hình chi tiết</b><br/> <br/> <b>3.1. Cài đặt, tạo môi trường</b><br/> <br/> 1. Cập nhật port collection.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>portsnap fetch install</pre>
		</div> <br/> <br/> 2. Biên dịch và cài đặt gói hỗ trợ <b>ucspi-tcp</b>.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>cd /usr/ports/sysutils/ucspi-tcp/; make install clean</pre>
		</div> <br/> <br/> 3. Biên dịch và cài đặt gói hỗ trợ <b>daemontools</b>.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>cd /usr/ports/sysutils/daemontools/; make install clean</pre>
		</div> <br/> <br/> 4. Biên dịch và cài đặt djbdns.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>cd /usr/ports/dns/djbdns
make install clean</pre>
		</div> <br/> <br/> Chú ý, khi <b>make config</b>, có thể chọn một số miếng vá bổ sung tính năng cần thiết. Chẳng hạn như PERSISTENT NMAP, SRV RECORD (hỗ trợ SRV record), PERSISTENT CACHE (hỗ trợ DNS cache trên ổ cứng), IPV6 (hỗ trợ giao thức IP v.6), v.v... mà chúng ta có thể chọn thêm, nếu cần. Bài này hướng dẫn này thực hiện <b>với cấu hình mặc định</b>, không có miếng vá thêm nào.<br/> <br/> 5. Cấu hình svscan – bộ quản lý service trong gói phụ trợ daemontools. <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>mkdir /var/service 
fetch -o /usr/local/etc/rc.d/services.sh \<span class="link"> http://www.tnpi.biz/internet/mail/toaster/start/services.txt</span> 
chmod 755 /usr/local/etc/rc.d/services.sh 
ln -s /usr/local/etc/rc.d/services.sh /usr/local/sbin/services 
rehash</pre>
		</div><br/> <br/> 6. Khởi động các dịch vụ. Chú ý hiện thời ta chưa cài đặt dịch vụ nào. Lệnh “khởi động” này thuần túy chỉ để kiểm tra rằng svscan đã thực sự hoạt động được. Sau khi kiểm tra ta lại tắt các dịch vụ. Nếu gặp trục trặc với <b>svscan</b> thì giải quyết trục trặc trước khi đi tiếp.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>services start 
ps -aux | grep sv
services stop</pre>
		</div><br/> <br/> 7. Các service sẽ sử dụng ba account khác nhau, mà ta sẽ đặt tên là <b>dnscache</b>, <b>tinydns</b>, <b>dnslog</b>. (Không nhất thiết phải đặt tên account như thế này mà có thể chọn những tên khác bất kỳ.) Mỗi account thuộc nhóm riêng của nó, với tên nhóm cùng tên với account. Hãy tạo ba nhóm này trước, bằng cách viết thêm trong file /etc/group ba dòng<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>dnscache:*:54: 
tinydns:*:55: 
dnslog:*:56:</pre>
		</div> <br/> <br/> rồi tạo ba account tương ứng bằng lệnh <b>adduser</b>. <br/> <br/> Trong đó, 54, 55, 56 là các số hiệu GID và UID mà chúng ta chọn đặt cho các account và nhóm mới. Nếu các số này đã bị chiếm dụng thì chúng ta có thể dùng số khác bất kỳ.<br/> <br/> 9. Tạo thư mục làm việc cho <b>djbdns</b>.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>mkdir /var/dns</pre>
		</div> <br/> <br/> <br/> <br/> <b>3.2. Cấu hình dnscache</b><br/> <br/> 1. Cấu hình dnscache để nó dùng hai trong số ba account vừa tạo (<b>dnscache</b> và <b>dnslog</b>), làm việc trong thư mục con <b>/var/dns/dnscache</b> (mà nó sẽ tự tạo ra), và lắng nghe trên interface chính (192.168.12.10).<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>dnscache-conf dnscache dnslog /var/dns/dnscache 192.168.12.10</pre>
		</div> <br/> <br/> Chú ý. <b>dnscache-conf</b> là lệnh ngoại trú nằm trong <b>/usr/local/bin</b>. Nếu thư mục đó không nằm trong PATH thì hãy gõ lệnh trên đầy đủ đường dẫn.<br/> <br/> 2. Đưa <b>dnscache</b> vào danh mục service quản lý bởi <b>svscan</b> bằng cách tạo trong <b>/var/service</b> một soft link đến <b>/var/dns/dnscache</b>.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>ln -s /var/dns/dnscache /var/service</pre>
		</div><br/> <br/> 3. Trong thư mục <b>/var/dns/dnscache/root/ip</b> đã có một file rỗng tên là <b>127.0.0.1</b>. Ý nghĩa của file này là <b>dnscache</b> đã (mặc định) được phép phục vụ localhost (127.0.0.1). Để cho phép nó phục vụ các client thuộc mạng cục bộ, ví dụ, 192.168.0.0/16 và 10.0.0.0/24, ta cũng tạo ra các file rỗng tương tự như thế.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>touch /var/dns/dnscache/root/ip/192.168 
touch /var/dns/dnscache/root/ip/10.0.0</pre>
		</div> <br/> <br/> 4. Cấu hình resolver (tức DNS client trên chính bản thân máy chủ DNS) để nó sử dụng dịch vụ của <b>dnscache</b> bằng cách viết lại file <b>/etc/resolv.conf</b> với nội dung mới như sau. <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>nameserver 192.168.12.10</pre>
		</div><br/> <br/> 5. Khởi động dịch vụ bằng lệnh <b>services start</b> hoặc <b>services restart</b>. Kiểm tra khẳng định rằng <b>dnscache</b> đã hoạt động đúng, nghĩa là đã giải được các tên Internet ngoại trừ các tên mycompany.com và giải ngược được các địa chỉ IP Internet ngoại trừ các địa chỉ IP cục bộ bằng các lệnh như <b>ping</b>, <b>host</b>, <b>dig</b>,... hay các client chuyên dùng khác trong bộ <b>djbdns</b> như <b>dnsip</b>, <b>dnsname</b>,... chạy trên máy chủ DNS và trên mọi máy khác trong mạng cục bộ.<br/> <br/> <br/> <br/> <b>3.3. Cấu hình tinydns</b><br/> <br/> 1. Cấu hình tinydns để nó dùng hai trong ba account dịch vụ vừa tạo (<b>tinydns</b> và <b>dnslog</b>), làm việc trong thư mục con <b>/var/dns/tinydns</b> (mà nó sẽ tự tạo ra), và lắng nghe trên loopback interface  (127.0.0.1).<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>tinydns-conf tinydns dnslog /var/dns/tinydns 127.0.0.1</pre>
		</div> <br/> <br/> Chú ý. Tương tự như ở đoạn trên, <b>tinydns-conf</b> là lệnh ngoại trú trong <b>/usr/local/bin</b>. Nếu thư mục ấy không nằm trong PATH thì hãy gõ lệnh trên có đường dẫn.<br/> <br/> 2. Đưa tinydns vào danh mục dịch vụ quản lý bởi svscan bằng cách tạo trong <b>/var/service</b> một softlink đến <b>/var/dns/tinydns</b>.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>ln -s /var/dns/tinydns /var/service</pre>
		</div> <br/> <br/> 3. Soạn thảo file dữ liệu chứa các địa chỉ DNS, có tên là <b>/var/dns/tinydns/root/data</b>. Ví dụ một file dữ liệu sẽ được trình bày trong đoạn tiếp theo.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>cd /var/dns/tinydns/root 
le data</pre>
		</div> <br/> <br/> Chú ý. FreeBSD v.8 được cài đặt mặc định với các trình biên tập <b>vi</b> và <b>ee</b>. Còn <b>le</b> là một trong số hàng trăm trình biên tập khác mà muốn dùng thì phải cài riêng. <br/> <br/> 4. Dịch file dữ liệu dạng văn bản nói trên thành một file cơ sở dữ liệu dạng nhị phân có tên là data.cdb cất trong cùng thư mục. <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>make</pre>
		</div> <br/> <br/> 5. Khởi động dịch vụ bằng lệnh <b>services restart</b>. Kiểm tra khẳng định rằng <b>tinydns</b> đã hoạt động đúng, nghĩa là đã giải được các tên của mycompany.com và giải ngược được các địa chỉ IP tương ứng của miền này bằng một client chạy ngay trên máy chủ DNS.<br/> <br/> <br/> <br/> <b>3.4. Một file dữ liệu cho tinydns</b><br/> <br/> Đây là file <b>/var/dns/tinydns/root/data</b> soạn thảo ở bước 3 trong thủ tục 3.3 nói trên.  Thay vì viết ra các luật cú pháp dài dòng, ta đưa ra một ví dụ so sánh một BIND zone file với một file dữ liệu tương đương cho <b>tinydns</b>. <br/> <br/> Nếu giả sử dùng BIND để thiết lập DNS server cho một vùng mycompany.com mà file dữ liệu <b>/etc/namedb/mycompany.com.hosts</b> có nội dung<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$ttl 38400
mycompany.com.     IN    SOA    ns1.mycompany.com. itdept.mycompany.com. &#40;
	1245253211
	10800
	3600
	604800
	38400 &#41;
mycompany.com.     IN    NS     ns1.mycompany.com.
mycompany.com.     IN    MX  10 mx1.mycompany.com.
ns1.mycompany.com. IN    A      127.0.0.1
mx1.mycompany.com. IN    A      192.168.12.16
dc1.mycompany.com. IN    A      192.168.10.11
dc2.mycompany.com. IN    A      192.168.10.12
...
web.mycompany.com. IN    A      192.168.18.10
www.mycompany.com. IN    CNAME  web.mycompany.com
ntp.mycompany.com. IN    CNAME  mx1.mycompany.com</pre>
		</div><br/> <br/> thì khi dùng tinydns để thiết lập DNS server có thẩm quyền cho miền này, file dữ liệu <b>/var/dns/tinydns/root/data</b> tương đương sẽ có nội dung sau đây.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>.mycompany.com::ns1.mycompany.com:604800
.0.168.192.in-addr.arpa::ns1.mycompany.com:604800
.1.168.192.in-addr.arpa::ns1.mycompany.com:604800
...
.18.168.192.in-addr.arpa::ns1.mycompany.com:604800

@mycompany.com::mx1.mycompany.com:86400
=ns1.mycompany.com:127.0.0.1
=mx1.mycompany.com:192.168.12.16
=dc1.mycompany.com:192.168.10.11
=dc2.mycompany.com:192.168.10.12
...
=web.mycompany.com:192.168.18.10
+www.mycompany.com:192.168.18.10
+ntp.mycompany.com:192.168.12.16</pre>
		</div> <br/> <br/> Trong ví dụ trên, file dữ liệu của <b>djbdns</b> đã chứa cả danh sách các mạng mà <b>tinydns</b> có thẩm quyền giải ngược địa chỉ IP. <br/> <br/> <br/> <br/> <b>3.5. Cấu hình dnscache để chuyển truy vấn mycompany.com sang tinydns</b> <br/> <br/> 1. Ta sẽ cấu hình <b>dnscache</b> để forward sang <b>tinydns</b> mọi truy vấn liên quan đến các miền mà <b>tinydns</b> phụ trách. Hãy xác định thư mục làm việc.<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>cd /var/dns/dnscache/root/servers</pre>
		</div><br/> <br/> 2. Để forward các truy vấn về tên, ta tạo ra trong thư mục này một file có tên là tên miền cần giải (mycompany.com) và có nội dung là địa chỉ IP của <b>tinydns</b> (127.0.0.1).<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>echo 127.0.0.1 &gt; mycompany.com</pre>
		</div><br/> <br/> 3. Để forward các truy vấn về địa chỉ IP, ta tạo ra trong thư mục này các file có tên là tên miền cần giải ngược và có cùng nội dung như trên. Chú ý rằng mỗi tên file như thế tận cùng bằng dấu chấm. <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>echo 127.0.0.1 &gt; 0.168.192.in-addr.arpa.
echo 127.0.0.1 &gt; 1.168.192.in-addr.arpa.
... 
echo 127.0.0.1 &gt; 18.168.192.in-addr.arpa.</pre>
		</div><br/> <br/> 4. Khởi động các dịch vụ bằng lệnh <b>services restart</b>. Kiểm tra rằng cơ chế forward <b>dnscache</b> → <b>tinydns</b> đã hoạt động đúng, tức là đã giải được các tên của miền mycompany.com và giải ngược được các địa chỉ IP tương ứng của miền này cho tất cả các client trong mạng cục bộ.<br/> <br/> <br/> <br/> <br/> <b>4  Tài liệu tham khảo</b><br/> <br/> [1] FreeBSD handbook: 29.6 Domain Name System (DNS)<br/> [2] ISC: BIND 9 Administrator Reference Manual (9.3.2) <br/> [3] Simerson M.: DJBDNS on FreeBSD HOW-TO <br/> [4] Wagner G.: Installing djbdns on a FreeBSD server  <br/> [5] Hoàng Ngọc Diêu: Thay thế BIND với djbdns <br/> [6] Steniger J.: BIND v DJBDNS: Comparison of Performance, Ease of Config and Security <br/> [7] Bernstein D.J.: DJBDNS Blurbs <br/> [8] Bernstein D.J.: DJBDNS Security <br/> [9] Bernstein D.J.: BIND, the Buggy Internet Name Daemon </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- quick reply -->
<table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0" align="center">
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left">
			<!-- watch - unwatch -->
			<!-- add bookmark -->

		</td>
		<td align="right" valign="bottom">			
		</td>
	</tr>
</table>

<!-- mod -->

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- combo navigator -->
<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left"><a href="http://digg.com/submit?phrase=2&url=/hvaonline/posts/list/32663.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=/hvaonline/posts/list/32663.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=/hvaonline/posts/list/32663.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=/hvaonline/posts/list/32663.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=/hvaonline/posts/list/32663.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=/hvaonline/posts/list/32663.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=/hvaonline/posts/list/32663.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
		<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<span class="gensmall">Go to:&nbsp;</span>
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/forums/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Select a forum</option>				
							<option value="0">-------------</option>
									<option value="2" >Thông báo từ HVA</option>
									<option value="41" >FAQ - Các câu hỏi thường gặp</option>
									<option value="5" >Góp ý và Hỏi đáp thắc mắc chung</option>
									<option value="6" >Kiểm tra bảo mật</option>
							<option value="0">-------------</option>
									<option value="8" >Thảo luận bảo mật</option>
									<option value="12" >Thảo luận thâm nhập</option>
									<option value="28" >Thảo luận virus, trojan, spyware, worm...</option>
									<option value="36" >Thủ thuật reverse engineering</option>
									<option value="13" >Thông tin new bugs và exploits</option>
									<option value="51" >Case Studies</option>
							<option value="0">-------------</option>
									<option value="23" >Thảo luận hệ điều hành Windows</option>
									<option value="24" selected="selected">Thảo luận hệ điều hành *nix</option>
									<option value="26" >Thảo luận các loại thiết bị máy tính</option>
									<option value="31" >Thảo luận mạng và thiết bị mạng</option>
									<option value="27" >Thông tin về các địa chỉ và tài liệu hữu ích</option>
							<option value="0">-------------</option>
									<option value="44" >Người tìm việc - Việc tìm người</option>
									<option value="21" >Thảo luận việc định hướng</option>
									<option value="19" >Những thảo luận khác</option>
									<option value="50" >Hình minh họa</option>
									<option value="33" >Trash</option>
							<option value="0">-------------</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- list users in -->
<table class="forumline" cellspacing="3" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<th class="thright"  nowrap="nowrap" height="26" valign="middle">&nbsp;Users currently in here&nbsp;</th>
	</tr>
		<tr>
			<td class="gensmall" valign="middle" align="left">
				1 Anonymous 
				
			</td>	
		</tr>
</table>
<a name="quick"></a>

<table cellspacing="0" cellpadding="0" width="100%" border="0"  align="center">

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
</table>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/avim.js"></script>
<script type="text/javascript">
<!--
function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}




function maxImg(foto, maxSize){
w = foto.width;
if (w > maxSize){
	foto.width = maxSize;
	}
} 

-->
</script>
