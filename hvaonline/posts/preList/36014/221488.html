<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Các vấn đề Nagios on CentOS 5.5 Final , jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Các vấn đề Nagios on CentOS 5.5 Final  - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<!-- navigator -->
<table cellspacing="2" cellpadding="2" width="100%" border="0" align="center">
	<tr>
		<td valign="baseline" align="left" colspan="0">
			<span class="nav">
			<a class="nav" href="/hvaonline/forums/list.html">Forum Index </a> 
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix </a>
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/posts/list/36014.html" name="top" id="top">Các vấn đề Nagios on CentOS 5.5 Final </a>
				&nbsp;<a href="/hvaonline/rss/topicPosts/36014.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML"></a>
			</span>
		
		</td>

		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- poll show -->

  <!-- POST LISTING -->


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221299" id="221299"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">23/09/2010 13:57:21 (+0700) | <a href="/hvaonline/posts/list/36014.html#221299">#1</a> | 221299 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/170946.html"><b>lendz</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 11/06/2008 01:12:00<br>
		Messages: 8<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/170946.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/170946.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Hiện tại mình đang nghiên cứu để triển khai Nagios trên CentOS nhưng do kiến thức về Unix và Nagios còn hạn chế nên gặp khá nhiều vấn đề. Mọi người ai đã đang hay có ý muốn làm và trong quá trình làm nếu có vấn đề gì thì mọi người post lên đây rồi cùng thảo luận nhe. Thanks.<br/> Hiện tại mình gặp một số vấn đề sau:<br/> Mình check traffic của Router Cisco <br/> <br/> <i>define service{<br/> 	use             	generic-service<br/> 	host_name       	Router 2961<br/> 	service_description     Traffic Load F0/0<br/> 	check_command           check_iftraffic! -H 192.168.0.1 -C public -i FastEthernet0/0 -b 100 -u m <br/> 	max_check_attempts      1<br/> 	normal_check_interval    5<br/> 	retry_check_interval     5<br/> }</i><br/> <br/> thì lỗi trả về là (Return code of 255 is out of bounds) mặc dù check bằng console thì được. <br/> <br/> Đối với check_mrtg<br/> <br/> <i>define service{<br/> 	use			generic-service	; Inherit values from a template<br/> 	host_name		Router 2961<br/> 	service_description	Port 1 Bandwidth Usage<br/> 	check_command		check_local_mrtgtraf!/var/lib/mrtg/2691.log!AVG!1000000,2000000!5000000,5000000!10<br/> <br/> 	}</i><br/> <br/> thì trả về lỗi check_mrtgtraf: Unable to open MRTG log file. Đã check lại đường dẫn nhưng vẫn không thấy file log sinh ra.<br/> <br/> Đã search khá nhiều nhưng vẫn chưa giải quyết được. <br/> <br/> Mình còn thắc mắc là nếu muốn check_by_ssh trên windows thì phải cấu hình sinh khoá trên windows như thế nào. Và có cách nào theo dõi log của webserver bằng nagios không?<br/> Cám ơn mọi người đã đọc.<br/> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221308" id="221308"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">23/09/2010 15:23:43 (+0700) | <a href="/hvaonline/posts/list/36014.html#221308">#2</a> | 221308 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/3f44f3018ff71ff4a7d22a98f3babb55.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/128502.html"><b>quanta</b></a><br>
	<font color="#FF9900">Moderator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 28/07/2006 14:44:21<br>
		Messages: 7265<br>
	
		Location: $ locate `whoami`<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/128502.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/128502.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Mình check traffic của Router Cisco <br/> <br/> <i>define service{<br/> 	use             	generic-service<br/> 	host_name       	Router 2961<br/> 	service_description     Traffic Load F0/0<br/> 	check_command           check_iftraffic! -H 192.168.0.1 -C public -i FastEthernet0/0 -b 100 -u m <br/> 	max_check_attempts      1<br/> 	normal_check_interval    5<br/> 	retry_check_interval     5<br/> }</i><br/> <br/> thì lỗi trả về là (Return code of 255 is out of bounds) mặc dù check bằng console thì được. <br/> &nbsp;
		</blockquote><br/> Dòng cấu hình check_command của bạn sai rồi. Trong service section thì bạn phải gọi dưới dạng: <b>check_iftraffic!para1!para2!...</b> chứ (như ở dưới ấy), còn trong commands.cfg bạn mới khai báo dưới dạng: <b>check_iftraffic.pl -H $HOSTADDRESS$ -C $ARG1$ ...<br/> </b><br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Đối với check_mrtg<br/> <br/> <i>define service{<br/> 	use			generic-service	; Inherit values from a template<br/> 	host_name		Router 2961<br/> 	service_description	Port 1 Bandwidth Usage<br/> 	check_command		check_local_mrtgtraf!/var/lib/mrtg/2691.log!AVG!1000000,2000000!5000000,5000000!10<br/> <br/> 	}</i><br/> <br/> thì trả về lỗi check_mrtgtraf: Unable to open MRTG log file. Đã check lại đường dẫn nhưng vẫn không thấy file log sinh ra.<br/> <br/> Đã search khá nhiều nhưng vẫn chưa giải quyết được. <br/> &nbsp;
		</blockquote><br/> Theo bạn, file log kia do cái gì sinh ra?<br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Mình còn thắc mắc là nếu muốn check_by_ssh trên windows thì phải cấu hình sinh khoá trên windows như thế nào. <br/> &nbsp;
		</blockquote><br/> Bạn có thể dùng NSClient++<br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Và có cách nào theo dõi log của webserver bằng nagios không?<br/> &nbsp;
		</blockquote><br/> Web server này nằm trên local hay ở xa? Bạn muốn theo dõi log để phát hiện điều gì?<br/> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"><font color='orange'>Let's build on a great foundation!</font></span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221394" id="221394"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/09/2010 15:25:05 (+0700) | <a href="/hvaonline/posts/list/36014.html#221394">#3</a> | 221394 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/170946.html"><b>lendz</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 11/06/2008 01:12:00<br>
		Messages: 8<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/170946.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/170946.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Cám ơn vì reply mình. Mình có cấu hình một check service như sau và vẫn chạy được<br/> <br/> <i>define service{<br/> 	use			generic-service	; Inherit values from a template<br/> 	host_name		Router 2961<br/> 	service_description	Port Content<br/> 	check_command		check_ifstatus! -C public  -H 192.168.0.1 -x1<br/> 	}</i><br/> <br/> Mình đã fix lại service như sau <br/> <br/> <i>define service{<br/> 	use             	generic-service<br/> 	host_name       	Router 2961<br/> 	service_description     Traffic Load F0/0<br/> 	check_command           check_iftraffic!192.168.0.1!public!FastEthernet0/0!100!m <br/> 	max_check_attempts      1<br/> 	normal_check_interval    5<br/> 	retry_check_interval     5<br/> }</i><br/> <br/> nhưng vẫn báo cùng kết quả nên mình nghĩ không phải do check_command.<br/> <br/> Đối với check_mrtg, mình nghĩ file log là do mrtg sinh ra không biết đúng không (đã set permisson trên folder chứa log)<br/> <br/> Webserver mình nằm trên LAN luôn, mình muốn đổ log về nagios để check (dạng như mấy tool web server log analysis) không biết được không?<br/> <br/> Còn hay gặp 1 vấn đề nữa là khi restart nagios service thì hay gặp vấn đề này <br/> <i>Warning - nagios did not exit in a timely manner </i><br/> và <i>Stopping nagios: No lock file found in /usr/local/nagios/var/nagios.lock (vẫn có file nagios.lock)</i><br/> <br/> Thanks</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221397" id="221397"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/09/2010 15:57:16 (+0700) | <a href="/hvaonline/posts/list/36014.html#221397">#4</a> | 221397 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/3f44f3018ff71ff4a7d22a98f3babb55.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/128502.html"><b>quanta</b></a><br>
	<font color="#FF9900">Moderator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 28/07/2006 14:44:21<br>
		Messages: 7265<br>
	
		Location: $ locate `whoami`<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/128502.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/128502.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote>Cám ơn vì reply mình. Mình có cấu hình một check service như sau và vẫn chạy được<br/> <br/> <i>define service{<br/> 	use			generic-service	; Inherit values from a template<br/> 	host_name		Router 2961<br/> 	service_description	Port Content<br/> 	check_command		check_ifstatus! -C public  -H 192.168.0.1 -x1<br/> 	}</i><br/> <br/> Mình đã fix lại service như sau <br/> <br/> <i>define service{<br/> 	use             	generic-service<br/> 	host_name       	Router 2961<br/> 	service_description     Traffic Load F0/0<br/> 	check_command           check_iftraffic!192.168.0.1!public!FastEthernet0/0!100!m <br/> 	max_check_attempts      1<br/> 	normal_check_interval    5<br/> 	retry_check_interval     5<br/> }</i><br/> <br/> nhưng vẫn báo cùng kết quả nên mình nghĩ không phải do check_command.<br/> &nbsp;
		</blockquote><br/> À, OK, mình nhầm.<br/> <br/> Bạn post đoạn khai báo check_iftraffic lên đi. Copy luôn output bạn nhận được khi chạy từ command line.<br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Đối với check_mrtg, mình nghĩ file log là do mrtg sinh ra không biết đúng không (đã set permisson trên folder chứa log)<br/> &nbsp;
		</blockquote><br/> Đúng rồi, file log đó chứa dữ liệu của MRTG, nó phải tồn tại trước thì bạn mới monitor được chứ.<br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Webserver mình nằm trên LAN luôn, mình muốn đổ log về nagios để check (dạng như mấy tool web server log analysis) không biết được không?<br/> &nbsp;
		</blockquote><br/> Bạn nên tìm một công cụ khác thích hợp hơn.<br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Còn hay gặp 1 vấn đề nữa là khi restart nagios service thì hay gặp vấn đề này <br/> <i>Warning - nagios did not exit in a timely manner </i><br/> và <i>Stopping nagios: No lock file found in /usr/local/nagios/var/nagios.lock (vẫn có file nagios.lock)</i><br/> &nbsp;
		</blockquote><br/> Post file init script (/etc/init.d/nagios) của bạn lên.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"><font color='orange'>Let's build on a great foundation!</font></span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221405" id="221405"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/09/2010 18:46:16 (+0700) | <a href="/hvaonline/posts/list/36014.html#221405">#5</a> | 221405 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/170946.html"><b>lendz</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 11/06/2008 01:12:00<br>
		Messages: 8<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/170946.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/170946.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Thanks quanta<br/> Đây là đoạn khai báo check_ifstatus<br/> <br/> <i>define command{<br/> command_name    check_ifstatus<br/> command_line    $USER1$/check_ifstatus -H $HOSTADDRESS$ -C public -x $ARG1$<br/> }</i><br/> <br/> Kết quả khi chạy bằng command<br/> <br/> <i>[root@localhost libexec]# ./check_ifstatus -C public  -H 192.168.0.1 -x1<br/> OK: host '192.168.0.1', interfaces up: 3, down: 0, dormant: 0, excluded: 1, unused: 0 |up=3,down=0,dormant=0,excluded=1,unused=0</i><br/> <br/> Đối với mrtg, vậy mình phải tạo log trước bằng tay hay sao? <br/> <br/> Bạn monitor log của các server bằng tool gì? Có thể recommend cho mình được không?<br/> <br/> Đây là file init của nagios<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/bin/sh
# 
# chkconfig: 345 99 01
# description: Nagios network monitor
#
# File : nagios
#
# Author : Jorge Sanchez Aymar &#40;jsanchez@lanchile.cl&#41;
# 
# Changelog :
#
# 1999-07-09 Karl DeBisschop &lt;kdebisschop@infoplease.com&gt;
#  - setup for autoconf
#  - add reload function
# 1999-08-06 Ethan Galstad &lt;egalstad@nagios.org&gt;
#  - Added configuration info for use with RedHat's chkconfig tool
#    per Fran Boon's suggestion
# 1999-08-13 Jim Popovitch &lt;jimpop@rocketship.com&gt;
#  - added variable for nagios/var directory
#  - cd into nagios/var directory before creating tmp files on startup
# 1999-08-16 Ethan Galstad &lt;egalstad@nagios.org&gt;
#  - Added test for rc.d directory as suggested by Karl DeBisschop
# 2000-07-23 Karl DeBisschop &lt;kdebisschop@users.sourceforge.net&gt;
#  - Clean out redhat macros and other dependencies
# 2003-01-11 Ethan Galstad &lt;egalstad@nagios.org&gt;
#  - Updated su syntax &#40;Gary Miller&#41;
#
# Description: Starts and stops the Nagios monitor
#              used to provide network services status.
#
  
status_nagios &#40;&#41;
{

	if test -x $NagiosCGI/daemonchk.cgi; then
		if $NagiosCGI/daemonchk.cgi -l $NagiosRunFile; then
		        return 0
		else
			return 1
		fi
	else
		if ps -p $NagiosPID &gt; /dev/null 2&gt;&1; then
		        return 0
		else
			return 1
		fi
	fi

	return 1
}


printstatus_nagios&#40;&#41;
{

	if status_nagios $1 $2; then
		echo &quot;nagios &#40;pid $NagiosPID&#41; is running...&quot;
	else
		echo &quot;nagios is not running&quot;
	fi
}


killproc_nagios &#40;&#41;
{

	kill $2 $NagiosPID

}


pid_nagios &#40;&#41;
{

	if test ! -f $NagiosRunFile; then
		echo &quot;No lock file found in $NagiosRunFile&quot;
		exit 1
	fi

	NagiosPID=`head -n 1 $NagiosRunFile`
}


# Source function library
# Solaris doesn't have an rc.d directory, so do a test first
if &#91; -f /etc/rc.d/init.d/functions &#93;; then
	. /etc/rc.d/init.d/functions
elif &#91; -f /etc/init.d/functions &#93;; then
	. /etc/init.d/functions
fi

prefix=/usr/local/nagios
exec_prefix=${prefix}
NagiosBin=${exec_prefix}/bin/nagios
NagiosCfgFile=${prefix}/etc/nagios.cfg
NagiosStatusFile=${prefix}/var/status.dat
NagiosRetentionFile=${prefix}/var/retention.dat
NagiosCommandFile=${prefix}/var/rw/nagios.cmd
NagiosVarDir=${prefix}/var
NagiosRunFile=${prefix}/var/nagios.lock
NagiosLockDir=/var/lock/subsys
NagiosLockFile=nagios
NagiosCGIDir=${exec_prefix}/sbin
NagiosUser=nagios
NagiosGroup=nagios
          

# Check that nagios exists.
if &#91; ! -f $NagiosBin &#93;; then
    echo &quot;Executable file $NagiosBin not found.  Exiting.&quot;
    exit 1
fi

# Check that nagios.cfg exists.
if &#91; ! -f $NagiosCfgFile &#93;; then
    echo &quot;Configuration file $NagiosCfgFile not found.  Exiting.&quot;
    exit 1
fi
          
# See how we were called.
case &quot;$1&quot; in

	start&#41;
		echo -n &quot;Starting nagios:&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			su - $NagiosUser -c &quot;touch $NagiosVarDir/nagios.log $NagiosRetentionFile&quot;
			rm -f $NagiosCommandFile
			touch $NagiosRunFile
			chown $NagiosUser:$NagiosGroup $NagiosRunFile
			$NagiosBin -d $NagiosCfgFile
			if &#91; -d $NagiosLockDir &#93;; then touch $NagiosLockDir/$NagiosLockFile; fi
			echo &quot; done.&quot;
			exit 0
		else
			echo &quot;CONFIG ERROR!  Start aborted.  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	stop&#41;
		echo -n &quot;Stopping nagios: &quot;

		pid_nagios
		killproc_nagios nagios

 		# now we have to wait for nagios to exit and remove its
 		# own NagiosRunFile, otherwise a following &quot;start&quot; could
 		# happen, and then the exiting nagios will remove the
 		# new NagiosRunFile, allowing multiple nagios daemons
 		# to &#40;sooner or later&#41; run - John Sellens
		#echo -n 'Waiting for nagios to exit .'
 		for i in 1 2 3 4 5 6 7 8 9 10 ; do
 		    if status_nagios &gt; /dev/null; then
 			echo -n '.'
 			sleep 1
 		    else
 			break
 		    fi
 		done
 		if status_nagios &gt; /dev/null; then
 		    echo ''
 		    echo 'Warning - nagios did not exit in a timely manner'
 		else
 		    echo 'done.'
 		fi

		rm -f $NagiosStatusFile $NagiosRunFile $NagiosLockDir/$NagiosLockFile $NagiosCommandFile
		;;

	status&#41;
		pid_nagios
		printstatus_nagios nagios
		;;

	checkconfig&#41;
		printf &quot;Running configuration check...&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			echo &quot; OK.&quot;
		else
			echo &quot; CONFIG ERROR!  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	restart&#41;
		printf &quot;Running configuration check...&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			echo &quot;done.&quot;
			$0 stop
			$0 start
		else
			echo &quot; CONFIG ERROR!  Restart aborted.  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	reload|force-reload&#41;
		printf &quot;Running configuration check...&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			echo &quot;done.&quot;
			if test ! -f $NagiosRunFile; then
				$0 start
			else
				pid_nagios
				if status_nagios &gt; /dev/null; then
					printf &quot;Reloading nagios configuration...&quot;
					killproc_nagios nagios -HUP
					echo &quot;done&quot;
				else
					$0 stop
					$0 start
				fi
			fi
		else
			echo &quot; CONFIG ERROR!  Reload aborted.  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	*&#41;
		echo &quot;Usage: nagios {start|stop|restart|reload|force-reload|status|checkconfig}&quot;
		exit 1
		;;

esac
  
# End of this script</pre>
		</div><br/> Thanks</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221416" id="221416"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/09/2010 20:34:28 (+0700) | <a href="/hvaonline/posts/list/36014.html#221416">#6</a> | 221416 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/3f44f3018ff71ff4a7d22a98f3babb55.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/128502.html"><b>quanta</b></a><br>
	<font color="#FF9900">Moderator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 28/07/2006 14:44:21<br>
		Messages: 7265<br>
	
		Location: $ locate `whoami`<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/128502.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/128502.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Đây là đoạn khai báo check_ifstatus<br/> ...<br/> &nbsp;
		</blockquote><br/> Chán quá, mình nhìn nhầm. Mình cần đoạn khai báo check_iftraffic thì mới liên quan đến service trên của bạn. (cả khi chạy từ command line nữa nhé)<br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Đối với mrtg, vậy mình phải tạo log trước bằng tay hay sao? <br/> &nbsp;
		</blockquote><br/> Bạn phải làm quen với MRTG trước:<br/><span class="link"> http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch22_:_Monitoring_Server_Performance#MRTG</span><br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Bạn monitor log của các server bằng tool gì? Có thể recommend cho mình được không?<br/> &nbsp;
		</blockquote><br/> Mình dùng OSSEC.<br/> <p></p>
		<cite class="blockquote">lendz wrote:</cite><br>
		<blockquote><br/> Đây là file init của nagios<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#!/bin/sh
# 
# chkconfig: 345 99 01
# description: Nagios network monitor
#
# File : nagios
#
# Author : Jorge Sanchez Aymar &#40;jsanchez@lanchile.cl&#41;
# 
# Changelog :
#
# 1999-07-09 Karl DeBisschop &lt;kdebisschop@infoplease.com&gt;
#  - setup for autoconf
#  - add reload function
# 1999-08-06 Ethan Galstad &lt;egalstad@nagios.org&gt;
#  - Added configuration info for use with RedHat's chkconfig tool
#    per Fran Boon's suggestion
# 1999-08-13 Jim Popovitch &lt;jimpop@rocketship.com&gt;
#  - added variable for nagios/var directory
#  - cd into nagios/var directory before creating tmp files on startup
# 1999-08-16 Ethan Galstad &lt;egalstad@nagios.org&gt;
#  - Added test for rc.d directory as suggested by Karl DeBisschop
# 2000-07-23 Karl DeBisschop &lt;kdebisschop@users.sourceforge.net&gt;
#  - Clean out redhat macros and other dependencies
# 2003-01-11 Ethan Galstad &lt;egalstad@nagios.org&gt;
#  - Updated su syntax &#40;Gary Miller&#41;
#
# Description: Starts and stops the Nagios monitor
#              used to provide network services status.
#
  
status_nagios &#40;&#41;
{

	if test -x $NagiosCGI/daemonchk.cgi; then
		if $NagiosCGI/daemonchk.cgi -l $NagiosRunFile; then
		        return 0
		else
			return 1
		fi
	else
		if ps -p $NagiosPID &gt; /dev/null 2&gt;&1; then
		        return 0
		else
			return 1
		fi
	fi

	return 1
}


printstatus_nagios&#40;&#41;
{

	if status_nagios $1 $2; then
		echo &quot;nagios &#40;pid $NagiosPID&#41; is running...&quot;
	else
		echo &quot;nagios is not running&quot;
	fi
}


killproc_nagios &#40;&#41;
{

	kill $2 $NagiosPID

}


pid_nagios &#40;&#41;
{

	if test ! -f $NagiosRunFile; then
		echo &quot;No lock file found in $NagiosRunFile&quot;
		exit 1
	fi

	NagiosPID=`head -n 1 $NagiosRunFile`
}


# Source function library
# Solaris doesn't have an rc.d directory, so do a test first
if &#91; -f /etc/rc.d/init.d/functions &#93;; then
	. /etc/rc.d/init.d/functions
elif &#91; -f /etc/init.d/functions &#93;; then
	. /etc/init.d/functions
fi

prefix=/usr/local/nagios
exec_prefix=${prefix}
NagiosBin=${exec_prefix}/bin/nagios
NagiosCfgFile=${prefix}/etc/nagios.cfg
NagiosStatusFile=${prefix}/var/status.dat
NagiosRetentionFile=${prefix}/var/retention.dat
NagiosCommandFile=${prefix}/var/rw/nagios.cmd
NagiosVarDir=${prefix}/var
NagiosRunFile=${prefix}/var/nagios.lock
NagiosLockDir=/var/lock/subsys
NagiosLockFile=nagios
NagiosCGIDir=${exec_prefix}/sbin
NagiosUser=nagios
NagiosGroup=nagios
          

# Check that nagios exists.
if &#91; ! -f $NagiosBin &#93;; then
    echo &quot;Executable file $NagiosBin not found.  Exiting.&quot;
    exit 1
fi

# Check that nagios.cfg exists.
if &#91; ! -f $NagiosCfgFile &#93;; then
    echo &quot;Configuration file $NagiosCfgFile not found.  Exiting.&quot;
    exit 1
fi
          
# See how we were called.
case &quot;$1&quot; in

	start&#41;
		echo -n &quot;Starting nagios:&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			su - $NagiosUser -c &quot;touch $NagiosVarDir/nagios.log $NagiosRetentionFile&quot;
			rm -f $NagiosCommandFile
			touch $NagiosRunFile
			chown $NagiosUser:$NagiosGroup $NagiosRunFile
			$NagiosBin -d $NagiosCfgFile
			if &#91; -d $NagiosLockDir &#93;; then touch $NagiosLockDir/$NagiosLockFile; fi
			echo &quot; done.&quot;
			exit 0
		else
			echo &quot;CONFIG ERROR!  Start aborted.  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	stop&#41;
		echo -n &quot;Stopping nagios: &quot;

		pid_nagios
		killproc_nagios nagios

 		# now we have to wait for nagios to exit and remove its
 		# own NagiosRunFile, otherwise a following &quot;start&quot; could
 		# happen, and then the exiting nagios will remove the
 		# new NagiosRunFile, allowing multiple nagios daemons
 		# to &#40;sooner or later&#41; run - John Sellens
		#echo -n 'Waiting for nagios to exit .'
 		for i in 1 2 3 4 5 6 7 8 9 10 ; do
 		    if status_nagios &gt; /dev/null; then
 			echo -n '.'
 			sleep 1
 		    else
 			break
 		    fi
 		done
 		if status_nagios &gt; /dev/null; then
 		    echo ''
 		    echo 'Warning - nagios did not exit in a timely manner'
 		else
 		    echo 'done.'
 		fi

		rm -f $NagiosStatusFile $NagiosRunFile $NagiosLockDir/$NagiosLockFile $NagiosCommandFile
		;;

	status&#41;
		pid_nagios
		printstatus_nagios nagios
		;;

	checkconfig&#41;
		printf &quot;Running configuration check...&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			echo &quot; OK.&quot;
		else
			echo &quot; CONFIG ERROR!  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	restart&#41;
		printf &quot;Running configuration check...&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			echo &quot;done.&quot;
			$0 stop
			$0 start
		else
			echo &quot; CONFIG ERROR!  Restart aborted.  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	reload|force-reload&#41;
		printf &quot;Running configuration check...&quot;
		$NagiosBin -v $NagiosCfgFile &gt; /dev/null 2&gt;&1;
		if &#91; $? -eq 0 &#93;; then
			echo &quot;done.&quot;
			if test ! -f $NagiosRunFile; then
				$0 start
			else
				pid_nagios
				if status_nagios &gt; /dev/null; then
					printf &quot;Reloading nagios configuration...&quot;
					killproc_nagios nagios -HUP
					echo &quot;done&quot;
				else
					$0 stop
					$0 start
				fi
			fi
		else
			echo &quot; CONFIG ERROR!  Reload aborted.  Check your Nagios configuration.&quot;
			exit 1
		fi
		;;

	*&#41;
		echo &quot;Usage: nagios {start|stop|restart|reload|force-reload|status|checkconfig}&quot;
		exit 1
		;;

esac
  
# End of this script</pre>
		</div><br/> &nbsp;
		</blockquote><br/> - Đoạn mã nên được đưa vào [ code ] [ /code ] tag để giữ được định dạng.<br/> - Mình nghĩ bạn nên tìm hiểu một chút xem đoạn script trên làm những gì.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"><font color='orange'>Let's build on a great foundation!</font></span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221422" id="221422"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/09/2010 21:11:49 (+0700) | <a href="/hvaonline/posts/list/36014.html#221422">#7</a> | 221422 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/170946.html"><b>lendz</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 11/06/2008 01:12:00<br>
		Messages: 8<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/170946.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/170946.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Mình khai báo check_iftraffic thế này<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>define command{
command_name check_iftraffic
command_line    $USER1$/check_iftraffic.pl -H $HOSTADDRESS$ -C $USER3$ -i $ARG1$ -b $ARG2$ -u $ARG3$
}</pre>
		</div><br/> <br/> Kết quả trên command line<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&#91;root@localhost libexec&#93;# ./check_iftraffic.pl -H 192.168.0.1 -C public -i FastEthernet0/0 -b 100 -u m 
Total RX Bytes: 528526.00 B, Total TX Bytes: 531682.00 B&lt;br&gt;Average Traffic: 3.30 B/s &#40;0.0%&#41; in, 3.15 B/s &#40;0.0%&#41; out|inUsage=0.0%;85;98;; outUsage=0.0%;85;98;; inAbsolut=156283B;10625000;12250000;; outAbsolut=175653B;10625000;12250000;;</pre>
		</div><br/> <br/> Thanks</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221424" id="221424"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/09/2010 21:55:53 (+0700) | <a href="/hvaonline/posts/list/36014.html#221424">#8</a> | 221424 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/3f44f3018ff71ff4a7d22a98f3babb55.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/128502.html"><b>quanta</b></a><br>
	<font color="#FF9900">Moderator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 28/07/2006 14:44:21<br>
		Messages: 7265<br>
	
		Location: $ locate `whoami`<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/128502.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/128502.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">$USER3$ bạn đã định nghĩa trong <i>resource.cfg</i> chưa? Nếu chưa, thì bạn có thể sửa hết thành $ARGx$ cũng được:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>$USER1$/check_iftraffic.pl -H $HOSTADDRESS$ -C $ARG1$ -i $ARG2$ -b $ARG3$ -u m</pre>
		</div><br/> rồi định nghĩa một host cho router của bạn, và gọi với:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>check_iftraffic!public!FastEthernet0/0!100</pre>
		</div><br/> Thử lại xem nhé.<br/> <br/> <br/> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"><font color='orange'>Let's build on a great foundation!</font></span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221464" id="221464"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">25/09/2010 19:13:24 (+0700) | <a href="/hvaonline/posts/list/36014.html#221464">#9</a> | 221464 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/170946.html"><b>lendz</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 11/06/2008 01:12:00<br>
		Messages: 8<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/170946.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/170946.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Mình đã khai báo USER3 vẫn không được, rồi đổi lại thành ARGX như cách của quanta nhưng vẫn vậy (Return code of 255 is out of bound).<br/> <br/> Thanks quanta cái OSSEC, thấy có vẻ hay, thử triển khai thêm xem sao. Rồi so sánh với con CS-MARS của cisco xem thế nào  <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"></span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221475" id="221475"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">25/09/2010 22:40:34 (+0700) | <a href="/hvaonline/posts/list/36014.html#221475">#10</a> | 221475 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/3f44f3018ff71ff4a7d22a98f3babb55.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/128502.html"><b>quanta</b></a><br>
	<font color="#FF9900">Moderator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 28/07/2006 14:44:21<br>
		Messages: 7265<br>
	
		Location: $ locate `whoami`<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/128502.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/128502.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Nagios có quy định Return codes như sau:<br/> <blockquote>0: OK<br/> 1: Warning<br/> 2: Critical<br/> 3: Unknown&nbsp;
		</blockquote><br/> <br/> Về lỗi trên, bạn có thể tham khảo:<span class="link"> http://support.nagios.com/knowledgebase/faqs/index.php?option=com_content&view=article&id=52&catid=35&faq_id=17&expand=false&showdesc=true</span><br/> <br/> Bạn gửi output của <b>`ls /tmp`</b> lên mình xem thử.<br/> <br/> Bạn disable embedded Perl interpreter trong nagios.cfg đi rồi thử lại xem:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># grep -i embedded /usr/local/nagios/etc/nagios.cfg | grep -v ^#
enable_embedded_perl=1
use_embedded_perl_implicitly=1</pre>
		</div></span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"><font color='orange'>Let's build on a great foundation!</font></span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221488" id="221488"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">26/09/2010 09:42:58 (+0700) | <a href="/hvaonline/posts/list/36014.html#221488">#11</a> | 221488 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/e101c9ae473b1eeb13745d045d60d917.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/130809.html"><b>giobuon</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 10/09/2006 06:25:46<br>
		Messages: 72<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/130809.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/130809.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">1. Đừng bao giờ test plugin của nagios với user root. Nhiều khi nó chả có vấn đề gì, nhưng nhiều lúc khiến mình mất cả ngày debug (Trust me, I learned it the hard way <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">). Theo mình trong trường hợp của bạn có thể khi bạn chạy script với quyền root đã tạo ra các file tạm trong thư mục tmp với quyền root, sau đó khi bạn chạy với quyền nagios thì không thể đọc ghi các file này nữa.<br/> 2. Trong phần lớn trường hợp các plugin của nagios đều có source code. Bạn có thể edit và print ra các thông tin debug một các dễ dàng (ví dụ như các giá trị file đọc vào, giá trị có được từ query SNMP...)<br/> 3. Giữ mọi thứ đơn giản và theo chuẩn. Từ việc đặt tên, dùng biến, command... Việc này sẽ có ích rất lớn nếu bạn làm với số lượng lớn.<br/> <br/> //Không đọc kĩ, quanta bài trước  trả lời cùng ý mình rồi. Thực ra cách đo traffic bằng SNMP hiện nay mà hầu hết các chương trình monitor hay plugin của nagios dùng là lấy kết quả 1 lần đầu, lưu ra file, chạy tiếp lần 2, lấy chênh lệch rồi chia cho interval giữa hai lần chạy.<br/> <br/> -giobuon</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#33CC33">[Discussion]</font></span>&nbsp;&nbsp; Các vấn đề Nagios on CentOS 5.5 Final <a name="221503" id="221503"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">26/09/2010 13:38:26 (+0700) | <a href="/hvaonline/posts/list/36014.html#221503">#12</a> | 221503 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/170946.html"><b>lendz</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 11/06/2008 01:12:00<br>
		Messages: 8<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/170946.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/170946.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Thanks quanta và giobuon. Đúng là vấn đề nằm ở permission của tmp. Khi check plugin bằng user nagios là nó báo ngay. Vậy mà làm hoài không ra.<br/> Sẽ ghi nhớ lời giobuon, không bao giờ dùng root để check plugin, hix, nó vật mấy ngày vì cái này...<br/> Many thanks... <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"><br/> By the way, có kinh nghiệm gì trong triển khai cái này với OSSEC thì share với ha (Mình triển khai trên hệ thống của cisco, windows, linux...etc). <br/> Một lần nữa cám ơn 2 bạn.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- quick reply -->
<table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0" align="center">
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left">
			<!-- watch - unwatch -->
			<!-- add bookmark -->

		</td>
		<td align="right" valign="bottom">			
		</td>
	</tr>
</table>

<!-- mod -->

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- combo navigator -->
<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left"><a href="http://digg.com/submit?phrase=2&url=/hvaonline/posts/list/36014.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=/hvaonline/posts/list/36014.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=/hvaonline/posts/list/36014.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=/hvaonline/posts/list/36014.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=/hvaonline/posts/list/36014.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=/hvaonline/posts/list/36014.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=/hvaonline/posts/list/36014.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
		<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<span class="gensmall">Go to:&nbsp;</span>
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/forums/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Select a forum</option>				
							<option value="0">-------------</option>
									<option value="2" >Thông báo từ HVA</option>
									<option value="41" >FAQ - Các câu hỏi thường gặp</option>
									<option value="5" >Góp ý và Hỏi đáp thắc mắc chung</option>
									<option value="6" >Kiểm tra bảo mật</option>
							<option value="0">-------------</option>
									<option value="8" >Thảo luận bảo mật</option>
									<option value="12" >Thảo luận thâm nhập</option>
									<option value="28" >Thảo luận virus, trojan, spyware, worm...</option>
									<option value="36" >Thủ thuật reverse engineering</option>
									<option value="13" >Thông tin new bugs và exploits</option>
									<option value="51" >Case Studies</option>
							<option value="0">-------------</option>
									<option value="23" >Thảo luận hệ điều hành Windows</option>
									<option value="24" selected="selected">Thảo luận hệ điều hành *nix</option>
									<option value="26" >Thảo luận các loại thiết bị máy tính</option>
									<option value="31" >Thảo luận mạng và thiết bị mạng</option>
									<option value="27" >Thông tin về các địa chỉ và tài liệu hữu ích</option>
							<option value="0">-------------</option>
									<option value="44" >Người tìm việc - Việc tìm người</option>
									<option value="21" >Thảo luận việc định hướng</option>
									<option value="19" >Những thảo luận khác</option>
									<option value="50" >Hình minh họa</option>
									<option value="33" >Trash</option>
							<option value="0">-------------</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- list users in -->
<table class="forumline" cellspacing="3" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<th class="thright"  nowrap="nowrap" height="26" valign="middle">&nbsp;Users currently in here&nbsp;</th>
	</tr>
		<tr>
			<td class="gensmall" valign="middle" align="left">
				1 Anonymous 
				
			</td>	
		</tr>
</table>
<a name="quick"></a>

<table cellspacing="0" cellpadding="0" width="100%" border="0"  align="center">

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
</table>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/avim.js"></script>
<script type="text/javascript">
<!--
function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}




function maxImg(foto, maxSize){
w = foto.width;
if (w > maxSize){
	foto.width = maxSize;
	}
} 

-->
</script>
