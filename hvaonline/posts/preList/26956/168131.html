<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Vài câu hỏi về Null routing, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Vài câu hỏi về Null routing - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<!-- navigator -->
<table cellspacing="2" cellpadding="2" width="100%" border="0" align="center">
	<tr>
		<td valign="baseline" align="left" colspan="0">
			<span class="nav">
			<a class="nav" href="/hvaonline/forums/list.html">Forum Index </a> 
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/forums/show/8.html">Thảo luận bảo mật </a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/posts/list/26956.html" name="top" id="top">Vài câu hỏi về Null routing</a>
				&nbsp;<a href="/hvaonline/rss/topicPosts/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML"></a>
			</span>
		
		</td>

		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- poll show -->

  <!-- POST LISTING -->


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Vài câu hỏi về Null routing<a name="164100" id="164100"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">27/12/2008 13:27:04 (+0700) | <a href="/hvaonline/posts/list/26956.html#164100">#1</a> | 164100 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Chào mọi người,<br/> <br/> Hiện tại server mình đang quản lí bị ddos rất nặng nề, mặc dù đã cản lọc bằng iptables và nhiều giải pháp khác, tuy nhiên có vẻ không mấy khả thi, hoặc do mình chưa đủ kinh nghiệm đối với dạng DDOS từ rất nhiều nguồn như thế này. Mình đang nghĩ đến giải pháp null routing, nhưng nếu ngồi xem log để tìm ra IP nào đang DDOS rồi add route thì không khả quan lắm, vì IP DDOS đến từ nhiều nguồn khác nhau, và thay đổi liên tục.<br/> <br/> Câu hỏi của mình: Ta đặt ra một giới hạn nào đó cho các cú request, kiểu như vượt quá số request này trên 1s thì đặt ra một biến blacklist. Sau đó add route cho biến này<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># route add $blacklist gw 127.0.0.1 lo</pre>
		</div><br/> <br/> và định một khoảng thời gian nào đó thì delete route này đi. <br/> <br/> Làm sao ta đếm và tạo biến, kiểu như tao một recent list và deny list này, hoặc cho vào blackhole, hay một private service nào đó như trong bài kí sự DDOS của anh conmale chẳng hạn, request này không thể chặn như chặn các gói tin UDP được, dùng iptables chặn thì mỗi cái rule làm việc cũng đủ làm server load cao và sụm (Hoặc bão hoà đường truyền).<br/> <br/> Xin mọi người giúp đỡ.<br/> <br/> Cám ơn!</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164115" id="164115"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">27/12/2008 16:01:59 (+0700) | <a href="/hvaonline/posts/list/26956.html#164115">#2</a> | 164115 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Xin lỗi, mình hỏi thêm trong topic này: Hiện tại mình dùng iptables để match string nhưng vẫn không lọc được các request mang các string "lạ", ví dụ mình dùng:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -A INPUT -p tcp --dport 80 -m string --string "string" -j DROP --algo bm</pre>
		</div><br/> Nhưng các request với dấu hiệu trên vẫn vô tư vào tới apache mà không hề bị cản lọc. Mình đã kiểm tra modprobe ipt_string và nó đã được tự động loaded.<br/> <br/> <br/> Vậy xin cho hỏi lí do vì sao iptables ko match được string trên? Liệu ipt_string của mình có quá cũ <b>(Centos 5.2, Kernel 2.6.18-92.1.22.el5-x86_64)</b>.<br/> <br/> Chân thành cảm ơn. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164119" id="164119"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">27/12/2008 21:00:58 (+0700) | <a href="/hvaonline/posts/list/26956.html#164119">#3</a> | 164119 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote>Xin lỗi, mình hỏi thêm trong topic này: Hiện tại mình dùng iptables để match string nhưng vẫn không lọc được các request mang các string "lạ", ví dụ mình dùng:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -A INPUT -p tcp --dport 80 -m string --string "string" -j DROP --algo bm</pre>
		</div><br/> Nhưng các request với dấu hiệu trên vẫn vô tư vào tới apache mà không hề bị cản lọc. Mình đã kiểm tra modprobe ipt_string và nó đã được tự động loaded.<br/> <br/> <br/> Vậy xin cho hỏi lí do vì sao iptables ko match được string trên? Liệu ipt_string của mình có quá cũ <b>(Centos 5.2, Kernel 2.6.18-92.1.22.el5-x86_64)</b>.<br/> <br/> Chân thành cảm ơn. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> &nbsp;
		</blockquote><br/> <br/> Thử nghĩ xem, dòng luật này khác dòng luật trên ở điểm nào? Lý do tạo sao? <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/> <b>iptables -t nat -A PREROUTING -p tcp --dport 80 -m string --string "string" --algo bm -j REDIRECT --to-ports 9</b><br/> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164136" id="164136"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/12/2008 10:09:06 (+0700) | <a href="/hvaonline/posts/list/26956.html#164136">#4</a> | 164136 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Anh,<br/> Dòng luật của em:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -A INPUT -p tcp --dport 80 -m string --string "string" -j DROP --algo bm</pre>
		</div><br/> <br/> Sẽ đặt một luật vào bảng Filter chỉ định: bất cứ gói tin nào đi vào cổng 80, mà request có mang theo string "string" thì lập tức bị drop.<br/> <br/> Dòng luật của anh<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -t nat -A PREROUTING -p tcp --dport 80 -m string --string "string" --algo bm -j REDIRECT --to-ports 9</pre>
		</div><br/> <br/> Sẽ đặt một luật vào bảng Nat định cơ chế Prerouting, tất cả các gói tin nhắm vào cổng 80, mà request có mang theo string "string" sẽ wwwect đến port 9 (discard service) và throws away nó <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"><br/> <br/> Còn câu hỏi tại sao là em đang thắc mắc muốn hỏi anh đó? Theo em nghĩ nếu dòng luật của em không match được string bên trên thì dòng luật của anh cũng vậy, hoặc có lí do nào khác mà em không biết đến, anh giải thích dùm em. Để em thử áp dụng luật trên với discard service xem kết quả thế nào.<br/> <br/> Mặc dù rule này giải quyết được cả bài toán, nhưng em vẫn muốn anh trả lời câu hỏi trên cùng <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">. <br/> <br/> Cám ơn anh!</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164200" id="164200"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/12/2008 14:40:31 (+0700) | <a href="/hvaonline/posts/list/26956.html#164200">#5</a> | 164200 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Lí thú thật, sao rule của anh match được string mà rule của em nó cho qua tất, em thật sự chưa rõ chỗ này, tìm lên tìm xuống, mãi chẳng ra lí do <img src="/hvaonline/images/smilies/a44dcbdf68b83dc02b23d480580ebf64.gif" border="0" alt="smilie" align="absbottom"><br/> Cho em hỏi thêm: iptables có lúc nào bặt "hụt" không? Vì em theo dõi thì lâu lâu cũng có request mang string đã bị em match lọt vào được? <br/> <br/> Cám ơn anh nhiều.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164205" id="164205"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/12/2008 15:40:51 (+0700) | <a href="/hvaonline/posts/list/26956.html#164205">#6</a> | 164205 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/1099262d08ad760566784006371a19d1.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/92651.html"><b>secmask</b></a><br>
	<font color="#33CC33">Elite Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 29/10/2004 13:52:24<br>
		Messages: 553<br>
	
		Location: graveyard<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/92651.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/92651.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://www" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote>Xin lỗi, mình hỏi thêm trong topic này: Hiện tại mình dùng iptables để match string nhưng vẫn không lọc được các request mang các string "lạ", ví dụ mình dùng:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -A INPUT -p tcp --dport 80 -m string --string "string" -j DROP --algo bm</pre>
		</div><br/> Nhưng các request với dấu hiệu trên vẫn vô tư vào tới apache mà không hề bị cản lọc. Mình đã kiểm tra modprobe ipt_string và nó đã được tự động loaded.<br/> <br/> <br/> Vậy xin cho hỏi lí do vì sao iptables ko match được string trên? Liệu ipt_string của mình có quá cũ <b>(Centos 5.2, Kernel 2.6.18-92.1.22.el5-x86_64)</b>.<br/> <br/> Chân thành cảm ơn. <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"> &nbsp;
		</blockquote><br/> <br/> bạn có thể cho mình hỏi là có phải bạn đặt iptables và web server trên cùng một host không ? hay là bạn muốn dùng iptables để lọc cho một host khác ?</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164210" id="164210"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/12/2008 16:57:01 (+0700) | <a href="/hvaonline/posts/list/26956.html#164210">#7</a> | 164210 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Hi Secmask,<br/> Mình chỉ được quản lí một server thôi <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">, chắc bạn thắc mắc vì thấy iptables không match được string, và trong rule mình không chỉ định Destination IP.<br/> <br/> Sau khi sử dụng discard service, dùng rule của anh conmale, kết quả:<br/> <br/> <br/>  <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># iptables -t nat -L -v -n 
Chain PREROUTING &#40;policy ACCEPT 661K packets, 33M bytes&#41;
 pkts bytes target     prot opt in     out     source               destination         
   661K   33M REDIRECT   tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:80 STRING match "muviet" ALGO name bm TO 65535 www ports 9 
........
........</pre>
		</div><br/> String mà mình match là <b>muviet</b><br/> Khá là hoàn hảo.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164211" id="164211"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/12/2008 17:59:34 (+0700) | <a href="/hvaonline/posts/list/26956.html#164211">#8</a> | 164211 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/104713.html"><b>StarGhost</b></a><br>
	<font color="#33CC33">Elite Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 29/03/2005 20:34:22<br>
		Messages: 662<br>
	
		Location: The Queen<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/104713.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/104713.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">@mR.Bi: bồ để ý xem cái cái rule của bồ có bị qua mặt bởi các rule (equally/more specific) nào khác không, vì bồ sử dụng "iptables -A INPUT". Thứ nữa, <b>secmask</b> hỏi vậy chắc không phải vì không thấy dest IP, mà vì các rule trong INPUT chỉ áp dụng với local box, còn rule trong PREROUTING áp dụng với các packet đầu vào xuất hiện trên NIC, tức là mức độ cover rộng hơn.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">Mind your thought.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164212" id="164212"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/12/2008 21:21:00 (+0700) | <a href="/hvaonline/posts/list/26956.html#164212">#9</a> | 164212 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote>Hi Secmask,<br/> Mình chỉ được quản lí một server thôi <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">, chắc bạn thắc mắc vì thấy iptables không match được string, và trong rule mình không chỉ định Destination IP.<br/> <br/> Sau khi sử dụng discard service, dùng rule của anh conmale, kết quả:<br/> <br/> <br/>  <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># iptables -t nat -L -v -n 
Chain PREROUTING &#40;policy ACCEPT 661K packets, 33M bytes&#41;
 pkts bytes target     prot opt in     out     source               destination         
   661K   33M REDIRECT   tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:80 STRING match "muviet" ALGO name bm TO 65535 www ports 9 
........
........</pre>
		</div><br/> String mà mình match là <b>muviet</b><br/> Khá là hoàn hảo.&nbsp;
		</blockquote><br/> <br/> StarGhost đã trả lời câu phía trên rất ngắn gọn và chính xác.<br/> <br/> Riêng thắc mắc của em về phần "string match" thì thế này. String match sẽ rất kém hiệu suất nếu như em không giới hạn offset (từ byte nào đến byte nào trên packet). Luật của em đưa ra buộc trọn bộ packet bị xét. Bởi thế hiệu suất rất kém. Có những packet sẽ không match bởi vì chúng bị chẻ nhỏ ra (đặc biệt nếu em cho phép "KeepAlive" trên apache).<br/> <br/> Dòng luật anh đưa ra về khía cạnh "match string" y hệt như dòng luật của em. Tuy nhiên dòng luật của anh lại match và đẩy packets bị "matched" về discard port nhiều hơn em là vì ở biên độ prerouting rộng hơn biên độ filter (sau khi packet đã được xác định destination là gì). Ở biên độ này, netfilter không bị bận rộn cho việc filter packet gì cả. Nó chỉ đơn thuần làm công tác "match" và sau đó wwwect packet này đi đến một điểm đích nào đó nên nó làm việc hữu hiệu hơn rất nhiều. Nếu là anh, anh sẽ sniff một mớ packets đang dùng để tấn công host của em. Sau đó, anh sẽ xác định offset của string được matched nằm ở khoảng nào để giúp cho công tác "match string" nhanh chóng và hiệu quả hơn.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164338" id="164338"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">29/12/2008 11:17:26 (+0700) | <a href="/hvaonline/posts/list/26956.html#164338">#10</a> | 164338 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">@Conmale,StarGhost: Cám ơn 2 anh, em cũng phần nào hiểu được cơ chế hoạt động của PREROUTING, và "match string" rồi.<br/> <br/> Riêng về phần xác định offset của string để em tìm hiểu, sẽ cố gắng trả bài sau. Nếu được anh cho em một ví dụ thì sẽ học được nhanh hơn <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">. Trước giờ em toàn giới hạn offset theo kiểu đoán và "mò" không <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">.<br/> <br/> À, em còn câu hỏi đầu bài chưa tìm ra lời đáp, vì trong trường hợp này, nếu không có dấu hiệu để nhận biết bằng match string, thì em nghĩ giải pháp null routing là rất khả dụng. Liệu cách đó có thể thực hiện được không?<br/> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164414" id="164414"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">29/12/2008 23:40:12 (+0700) | <a href="/hvaonline/posts/list/26956.html#164414">#11</a> | 164414 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote>@Conmale,StarGhost: Cám ơn 2 anh, em cũng phần nào hiểu được cơ chế hoạt động của PREROUTING, và "match string" rồi.<br/> <br/> Riêng về phần xác định offset của string để em tìm hiểu, sẽ cố gắng trả bài sau. Nếu được anh cho em một ví dụ thì sẽ học được nhanh hơn <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">. Trước giờ em toàn giới hạn offset theo kiểu đoán và "mò" không <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">.<br/> &nbsp;
		</blockquote><br/> OK, packet offset theo yêu cầu <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom"><br/> <br/> <br>
			<div align="center" class="limitview"><img src='/hvaonline/posts/downloadAttach/753.html' border="0"  /></div><br/> <br/> Như em thấy trên bức hình, đoạn "string" anh cần tìm là: "<b>/?anz</b>....." và packet được chọn đó là một HTTP (ở dạng GET). Khi bấm vào dòng (khoanh màu đỏ) thì hai khung bên dưới sẽ hiển thị chi tiết của packet này. Phần offset là phần nằm ở khung cuối. Trên khung này, nếu dựa vào cột đầu tiên (bên tay trái) thì em có thể xác định được offset của string "/?anz" nằm ở khoảng nào. Cái này chỉ là cách sử dụng Wireshark (Ethereal) mà thôi. Em nên xem phần help của nó để hiểu hơn về cách sử dụng.<br/> <br/> Điều quan trọng cần bàn ở đây là làm mọi cách để gia tăng hiệu suất. Bất cứ thao tác tìm kiếm nào cũng mất thời gian, tốn tài nguyên và... chậm nếu như biên độ tìm quá rộng. Bởi thế, thay vì buộc netfilter tìm một string nào đó trong cả một packet lớn, mình nên thu hẹp biên độ tìm cho nó. netfilter / iptables có một module "length", dùng nó để giới hạn như sau:<br/> <b>-m length --length &lt;start_offset&gt;:&lt;end_offset&gt;</b><br/> <br/> Gia tăng hiệu suất không chỉ nằm trong biên độ tìm kiếm mà còn nằm ở chỗ giúp netfilter / iptables xác định dạng packet nào thì mới "tốn sức" làm việc. Với packet trên, khi phân tích ở khung thứ nhì của Wireshark, em sẽ xác định được packet này là một packet có ACK, PSH flags được set. Nếu quan sát kỹ những packets tương tự, em sẽ thấy chúng toàn là ACK, PSH cả. Bởi thế, giúp netfilter / iptables trong trường hợp này có thể bằng cách ấn định cụ thể thêm dạng packet mà chúng cần điều tra và thực thi công tác:<br/> <b>-p tcp --tcp-flags ACK,PSH ACK,PSH</b><br/> <br/> Điều này giúp netfilter / iptables cực kỳ nhiều bởi vì nó không phải inspect mọi packet đi qua mà chỉ inspect các gói tin có flags là ACK, PSH. Nó giúp giảm khối lượng công việc đến 70% hoặc hơn và không phí tài nguyên vô ích. Đối với hoàn cảnh bị DDoS, mọi chi tiết giúp nâng cao hiệu suất và tiết kiệm tài nguyên đều quý giá vô ngần.<br/> <br/> (Anh để em tự hình thành một dòng luật mới dựa trên 2 điểm ở trên thì mới vui và có gặt hái).<br/> <br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> À, em còn câu hỏi đầu bài chưa tìm ra lời đáp, vì trong trường hợp này, nếu không có dấu hiệu để nhận biết bằng match string, thì em nghĩ giải pháp null routing là rất khả dụng. Liệu cách đó có thể thực hiện được không?<br/> &nbsp;
		</blockquote><br/> Cũng ở phân mục này đã có một chủ đề thảo luận về null routing (sau khi anh gởi bài ký sự DDoS thứ 23). Em nên đọc lại. Cá nhân anh cho rằng null routing không hiệu suất vì DDoS thay đổi source IP liên tục. Nếu ứng dụng một bộ phận theo dõi các IP gởi request và chọn ra các IP "vi phạm" để từ đó thay đổi routing table liên tục thì quá chậm và quá tốn kém tài nguyên. Điểm cốt lõi của cách chống DDoS bằng cách đẩy các packet mang tính vi phạm vào /dev/null nằm ở chỗ nó giúp việc nhận ra chúng nhanh nhất và triệt chúng một cách gọn nhẹ nhất. null routing có thể có ích cho một số hoàn cảnh khác và có lẽ không được thực dụng lắm cho việc chống DDoS.<br/> <br/> Thân mến.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164493" id="164493"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">30/12/2008 12:01:15 (+0700) | <a href="/hvaonline/posts/list/26956.html#164493">#12</a> | 164493 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Em thử trả bài, không chắc cú cho lắm rule của em<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -t nat -A PREROUTING -p tcp --tcp-flags ACK,PSH ACK,PSH --dport 80 -m string --string "/?anz" -m length --length 47:81 --algo bm -j REDIRECT --to-ports 9</pre>
		</div><br/> <br/> Em đang đọc bài viết về null routing anh nhắc tới.<br/> <br/> Cám ơn anh.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164662" id="164662"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">31/12/2008 13:19:14 (+0700) | <a href="/hvaonline/posts/list/26956.html#164662">#13</a> | 164662 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Kì quặc 1 điều là xong bài post ở trên thì kẻ tấn công lột luôn cái string nhận diện của em, không hiểu có ai đó trong đây muốn mình mất việc không mà làm thế  <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> (j/k) , do vậy hiện tại dòng rule với string match trên trở nên vô dụng.<br/> <br/> Em capture một mớ packet, cụ thể nó như thế này:<br/> <br>
			<div align="center" class="limitview"><img src='http://img129.imageshack.us/img129/4584/screenshot301208wireshaks7.png' border="0"  /></div><br/> <br/> <i><font size='-1'>cái hình làm hơi vội, có vài thông tin mình ko muốn đưa lên, mong mọi người thông cảm</font></i><br/> <br/> Request DDOS từ IP 203.162.3.155 có referer là<span class="link"> http://www.yahoo.com,</span> string offset nằm trong đoạn từ 00c0 đến 00d0, em thử đặt ra một rule wwwect nó về port 9:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -t nat -A PREROUTING -i $IF -p tcp --dport 80 -m string --string 'www.yahoo.com' -m length --length 191:209 --algo bm -j REDIRECT --to-port 9</pre>
		</div><br/> <br/> Nhưng không có packet nào bị "match" cả. <br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># iptables -t nat -v -n -L 
Chain PREROUTING &#40;policy ACCEPT 73684 packets, 4933K bytes&#41;
 pkts bytes target     prot opt in     out     source               destination         
    0     0 REDIRECT   tcp  --  * *       0.0.0.0/0            0.0.0.0/0           tcp dpt:80 STRING match "www.yahoo.com" ALGO name bm TO 65535length 191:209 www ports 9</pre>
		</div><br/> <br/> Xem log thì nó chỉ bị cản bởi ModSec<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&#91;Tue Dec 30 10:12:48 2008&#93; &#91;error&#93; &#91;client 203.162.3.155&#93; ModSecurity: Access denied with code 406 &#40;phase 2&#41;. Pattern match "www\\.yahoo\\.com" at REQUEST_HEADERS:Referer. &#91;file "/usr/local/apache/conf/modsec2.conf"&#93; &#91;line "20"&#93; &#91;hostname "www.mysite.com"&#93; &#91;uri "/path/index.php"&#93; &#91;unique_id "3Mz3W9ArllsAAGPkV1wAAAMz"&#93;</pre>
		</div><br/> <br/> <br/> Em vẫn không tin tưởng lắm về độ chính xác của rule mình đưa ra. Không hiểu nó sai chỗ nào? Mong mọi người giúp đỡ.<br/> <br/> Cám ơn!</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="164926" id="164926"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">02/01/2009 23:58:32 (+0700) | <a href="/hvaonline/posts/list/26956.html#164926">#14</a> | 164926 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Mr. Bi thân mến,<br/> <br/> Mấy hôm nay anh "bị" liên hoan triền miên, xỉn triền miên nên không vào diễn đàn  <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">  nên không hồi báo sớm hơn.<br/> <br/> "Vấn nạn" của em gặp phải cũng là vấn nạn mà HVA gặp phải trước đây. Kỹ thuật "detect" dấu hiệu bị tấn công phụ thuộc vào những điểm <b>đặc thù</b> để dựa vào đó mà xử lý. Lần trước, điểm đặc thù em có thể tìm thấy là string "muviet". String này có thể sẽ thay đổi thường xuyên, thậm chí thay đổi random trong mỗi request. Bởi thế, khi chọn lựa một thứ "vũ khí" để chống đỡ, em cần suy nghĩ đến biên độ rộng nhất mà "vũ khí" này có thể bảo vệ em.<br/> <br/> Trong trường hợp không còn "string" (dấu hiệu cụ thể) nào cả thì cần xét kỹ hơn: điểm nào là điểm đặt thù của các packets trên? Nếu em chọn dấu hiện referer www.yahoo.com thì em vô tình cản luôn các request hợp lệ chuyển từ trang tìm kiếm của yahoo vào site của em. Đây là cách không tối ưu.<br/> <br/> Hãy xét xem, tâng số của các requests tấn công em khác các request bình thường thế nào? Các request bình thường (đi từ 1 IP) có khi nào gởi liên tục 10, 20, 30, 40 requests trong 1 giây không? --&gt; đây cũng là điểm đặc thù em có thể dùng để chọn "vũ khí" mới để tự vệ vậy.<br/> <br/> Anh giới thiệu em một đoạn "adaptive" rule dùng module recent để "trị" dạng DDoS không có dấu hiệu (string) gì ngoài tầng số tấn công:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># create an incoming table to control packets base on recent rules
iptables -N incominghttp

# create a conn table to control maximum connection per IP
iptables -N conn
iptables -A conn -j DROP

# create a blacklist table
iptables -N blacklist
iptables -A blacklist -j LOG --log-prefix "BLACKLISTING: "
iptables -A blacklist -m recent --name BLACKLIST --set -j DROP


# create a httpnormal to control normal flow of http if above is satisfied
iptables -N httpnormal

# now add rules into it &#40;httpnormal&#41;
iptables -A httpnormal -p tcp ! --syn -s $NET --sport $HI_PORTS -d $IP --dport 80 -m state --state NEW -m limit --limit 1/m -j LOG --log-prefix "NEWNOTSYN_HTTP: "
iptables -A httpnormal -p tcp ! --syn -s $NET --sport $HI_PORTS -d $IP --dport 80 -m state --state NEW -j DROP

iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m limit --limit 10/m --limit-burst $BURST_ME -j LOG --log-prefix "SYNFLOOD: "
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m state --state NEW -m limit --limit $SYN_ME --limit-burst $BURST_ME -j ACCEPT
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m state --state NEW -j ACCEPT
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m limit --limit $SYN_ME --limit-burst $BURST_ME -j LOG --log-prefix "OVER_BURST: "
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m limit --limit $SYN_ME --limit-burst $BURST_ME -j conn

iptables -A httpnormal -p tcp -s $NET -d $IP --dport 80 -m state --state ESTABLISHED -m connlimit --connlimit-above $GLOBAL -m limit --limit 2/m -j LOG --log-prefix "OVERCONNLIMIT: "
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -d $IP --dport 80 -m conntrack --ctstate INVALID -j LOG --log-prefix "INVALID: "
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -d $IP --dport 80 -m conntrack --ctstate INVALID -j DROP
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -m state --state ESTABLISHED -d $IP --dport 80 -m connlimit ! --connlimit-above $GLOBAL -j ACCEPT
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -m state --state ESTABLISHED -d $IP --dport 80 -m connlimit --connlimit-above $GLOBAL -j conn
echo "connlimit is defined"

# After defining INPUT, only allow OUTPUT as ESTABLISHED state
# There should be no SYN packet from port 80 of HTTP server
# Using own server to initiate request to other sites is impossible
iptables -A OUTPUT -p tcp -s $IP --sport 80 -d $NET --dport $HI_PORTS -m state --state ESTABLISHED -j ACCEPT

# then allow all ESTABLISHED INPUT without SYN
# Once the connection is ESTABLISHED &#40;passed all the rules above&#41; - should not restrict rate to maximise performance
iptables -A httpnormal -p tcp ! --syn -s $NET --sport $HI_PORTS -d $IP --dport 80 -m state --state ESTABLISHED -j ACCEPT

# rate limiting on incoming http packets and keep a blacklist for 60 seconds
# this rule drops *any* packet if the IP is in the blacklist
iptables -A incominghttp -m recent --name BLACKLIST --update --seconds 60 -j DROP

# all *established* http connections are allowed to continue
iptables -A incominghttp -p tcp --dport 80 -m state --state ESTABLISHED,RELATED -j httpnormal

# all *new* http connections are all put into a list 'httpconn'
# if there are 20 SYN packets in 30 seconds &#40;as defined in variables SECS and HITS above&#41;
# we send the package to chain 'blacklist ' which puts the IP in the blacklist
iptables -A incominghttp -p tcp --dport 80 -m state --state NEW -m recent --name httpconn --rcheck --seconds $SECS --hitcount $HITS -j blacklist

# if we have seen less then 20 such packets in the last 30 seconds we accept
# and direct the packets to the normal http chain httpnormal
iptables -A incominghttp -p tcp --dport 80 -m state --state NEW -m recent --name httpconn --set -j httpnormal

echo "Start the actual http rule..."
$IPTABS -A INPUT -p tcp -s $NET -d $IP --dport 80 -j incominghttp
echo "The HTTP service is provided"
}</pre>
		</div><br/> <br/> Em xem và suy nghĩ về đoạn rule trên và cho anh biết em đã đúc kết được những gì nhá? <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="165031" id="165031"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">03/01/2009 15:42:09 (+0700) | <a href="/hvaonline/posts/list/26956.html#165031">#15</a> | 165031 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/122389.html"><b>mR.Bi</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 22/03/2006 13:17:49<br>
		Messages: 812<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/122389.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/122389.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://vndev.net" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Anh, <br/> <br/> Đầu năm có vẻ anh ăn chơi thả cửa nhỉ  <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom"> <br/> <br/> Nhìn vào đoạn script iptables của anh, công đoạn được thực hiện theo cách thức: log sau đó dựa vào log để drop. Và hầu như tất cả các rules anh đưa ra đều có những giá trị được anh "pre-define" cụ thể từ trước, mà những giá trị này không phải ông System Admin nào cũng biết rõ và đưa ra những con số ngay được. <br/> <br/> Đoạn rule của anh là kết quả của quá trình nghiên cứu các phương thức tấn công, và...có lẽ anh trải nghiệm nhiều trong việc đối phó với tấn công từ chối dịch vụ, ví dụ như em nếu gặp trường hợp bị A tấn công bằng phương thức 1, em chỉ cố găng bằng cách nào đó đưa ra những rule để đối phó với A, mà nếu tiếp theo có ông B thì cách thức dùng để đối phó với A trở nên vô dụng với B, em lại mày mò cách đối phó với B. Nói chung em không có kế hoạch rõ ràng, và không tính đến một bài toán mang tính toàn vẹn...như anh.<br/> <br/> Điều em thắc mắc là rõ ràng ta không thể cùng một lúc vừa log vừa drop, nên anh chỉ định các user-define-table, list, log-prefix để dựa vào đó lọc ra các packet "vi phạm". Nhưng liệu việc ghi log như thế có thực sự bền bỉ? Vì cũng như anh từng nói việc ghi log liên tục như thế chiếm dụng rất nhiều tài nguyên của server, cho dù anh có đưa ra giá trị <b>--limit-burst</b>, theo em con số này có vẻ khá quan trọng trong đoạn iptables script của anh. Em chưa nghĩ ra anh đặt là bao nhiêu, trước giờ em toàn không ấn định cụ thể (5).<br/> <br/> Và những rule bên trên cũng không thể chống đối với dạng tấn công liên tục từ rất nhiều nguồn, làm bão hoà đường truyền. Tác vụ ghi log làm firewall tốn khá nhiều thời gian, và nếu như em đặt ra một rule thế này:<br/> <br/> <b>iptables -A INPUT -p tcp --syn -m limit --limit 1/s –j ACCEPT</b><br/> <br/> thì em kiểm tra, có lúc chính nó làm server load tăng vọt, có khi hoàn toàn trì trệ. Vậy log + drop sẽ chậm hơn rất nhiều và tác vụ xử lí sẽ tốn server load hơn so với chỉ drop, phải không anh?<br/> <br/> Đọc xong đoạn rule của anh em nghĩ mình phải học lại kiến thức căn bản về iptables, nhiều rule em đọc xong google từng option mới mườn tượng ra được cách thức hoạt động của nó. Em đang đọc phần conntract:<br/> <span class="link"> http://www.faqs.org/docs/iptables/theconntrackentries.html</span><br/> <br/> Hiện tại server bên em được bên cung cấp đặt sau lưng con Pix firewall, nhưng chả hiểu bên đấy config thế nào packet vẫn vào như nhà không cửa <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">.<br/> <br/> Em thử áp dụng script của anh lại gặp phải lỗi iptables:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#iptables -A INPUT -p tcp -d $myip --dport 80 -m state --state ESTABLISHED -m connlimit --connlimit-above 4 -j DROP
iptables: Unknown error 18446744073709551615</pre>
		</div><br/> <br/> Có lẽ em nên post vào box khác hợp lí hơn. Cám ơn anh rất nhiều, đang bị bội thực kiến thức <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"> All of my life I have lived by a code and the code is simple: "honour your parent, love your woman and defend your children"</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="165068" id="165068"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">04/01/2009 05:53:55 (+0700) | <a href="/hvaonline/posts/list/26956.html#165068">#16</a> | 165068 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote>Anh, <br/> <br/> Đầu năm có vẻ anh ăn chơi thả cửa nhỉ  <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom"> <br/> &nbsp;
		</blockquote><br/> Mỗi năm chỉ có vài ngày thôi em <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">.<br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> Nhìn vào đoạn script iptables của anh, công đoạn được thực hiện theo cách thức: log sau đó dựa vào log để drop. Và hầu như tất cả các rules anh đưa ra đều có những giá trị được anh "pre-define" cụ thể từ trước, mà những giá trị này không phải ông System Admin nào cũng biết rõ và đưa ra những con số ngay được. <br/> <br/> Đoạn rule của anh là kết quả của quá trình nghiên cứu các phương thức tấn công, và...có lẽ anh trải nghiệm nhiều trong việc đối phó với tấn công từ chối dịch vụ, ví dụ như em nếu gặp trường hợp bị A tấn công bằng phương thức 1, em chỉ cố găng bằng cách nào đó đưa ra những rule để đối phó với A, mà nếu tiếp theo có ông B thì cách thức dùng để đối phó với A trở nên vô dụng với B, em lại mày mò cách đối phó với B. Nói chung em không có kế hoạch rõ ràng, và không tính đến một bài toán mang tính toàn vẹn...như anh.<br/> &nbsp;
		</blockquote><br/> Các pre-defined values không quan trọng bởi vì tùy hoàn cảnh, những value này sẽ thay đổi. Đó là lý do anh không kèm theo những values ấy (và để tránh tình trạng copy & paste và dùng không suy nghĩ).<br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> Điều em thắc mắc là rõ ràng ta không thể cùng một lúc vừa log vừa drop, nên anh chỉ định các user-define-table, list, log-prefix để dựa vào đó lọc ra các packet "vi phạm". Nhưng liệu việc ghi log như thế có thực sự bền bỉ? Vì cũng như anh từng nói việc ghi log liên tục như thế chiếm dụng rất nhiều tài nguyên của server, cho dù anh có đưa ra giá trị <b>--limit-burst</b>, theo em con số này có vẻ khá quan trọng trong đoạn iptables script của anh. Em chưa nghĩ ra anh đặt là bao nhiêu, trước giờ em toàn không ấn định cụ thể (5).<br/> &nbsp;
		</blockquote><br/> Nếu em xem kỹ thì sẽ thấy giới hạn và tầng số log rất thấp. Log quá nhiều thì hại nhưng log đúng mức (tùy theo hoàn cảnh) thì lợi.<br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> Và những rule bên trên cũng không thể chống đối với dạng tấn công liên tục từ rất nhiều nguồn, làm bão hoà đường truyền. Tác vụ ghi log làm firewall tốn khá nhiều thời gian, và nếu như em đặt ra một rule thế này:<br/> <br/> <b>iptables -A INPUT -p tcp --syn -m limit --limit 1/s –j ACCEPT</b><br/> <br/> thì em kiểm tra, có lúc chính nó làm server load tăng vọt, có khi hoàn toàn trì trệ. Vậy log + drop sẽ chậm hơn rất nhiều và tác vụ xử lí sẽ tốn server load hơn so với chỉ drop, phải không anh?<br/> &nbsp;
		</blockquote><br/> Đúng. Không có một thứ luật nhiệm mầu nào cả. Cùng một luật đưa ra có thể làm việc hoàn chỉnh cho một server này nhưng có thể hoàn toàn vô dụng cho server kia. Bởi thế, anh luôn luôn nhấn mạnh: <b>tùy hoàn cảnh</b>.<br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> Đọc xong đoạn rule của anh em nghĩ mình phải học lại kiến thức căn bản về iptables, nhiều rule em đọc xong google từng option mới mườn tượng ra được cách thức hoạt động của nó. Em đang đọc phần conntract:<br/> <span class="link"> http://www.faqs.org/docs/iptables/theconntrackentries.html</span><br/> &nbsp;
		</blockquote><br/> Cũng không đến nỗi vậy đâu <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">. Nếu em đọc và phân tích từng dòng luật ở trên, em sẽ thấy được lý do tại sao chúng hiện hữu như thế. Đến lúc ấy, mọi chuyện sẽ trở nên đơn giản.<br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> Hiện tại server bên em được bên cung cấp đặt sau lưng con Pix firewall, nhưng chả hiểu bên đấy config thế nào packet vẫn vào như nhà không cửa <img src="/hvaonline/images/smilies/274a01ad7ad7ad7d73d5f0b399ae5db2.gif" border="0" alt="smilie" align="absbottom">.<br/> &nbsp;
		</blockquote><br/> Nếu con PIX chẳng cản lọc cái gì liên quan đến packet rate thì "vào như nhà không cửa" là chuyện tự nhiên.<br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> Em thử áp dụng script của anh lại gặp phải lỗi iptables:<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>#iptables -A INPUT -p tcp -d $myip --dport 80 -m state --state ESTABLISHED -m connlimit --connlimit-above 4 -j DROP
iptables: Unknown error 18446744073709551615</pre>
		</div><br/> &nbsp;
		</blockquote><br/> Vì iptables của em thiếu module "connlimit" mà ra thôi.<br/> <br/> <p></p>
		<cite class="blockquote">mR.Bi wrote:</cite><br>
		<blockquote><br/> Có lẽ em nên post vào box khác hợp lí hơn. Cám ơn anh rất nhiều, đang bị bội thực kiến thức <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> &nbsp;
		</blockquote><br/> Hì hì. Lúc đầu thì choáng 1 tí thôi. Từ từ, thong thả thì sẽ tiêu hóa.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="167675" id="167675"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">29/01/2009 07:17:27 (+0700) | <a href="/hvaonline/posts/list/26956.html#167675">#17</a> | 167675 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/8473446b734702b73ac2972b7bbf7bf7.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/140396.html"><b>Phó Hồng Tuyết</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 20/04/2007 20:02:10<br>
		Messages: 275<br>
	
		Location: Nơi Sâu Thẳm Tâm Hồn<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/140396.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/140396.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http:// ???-những gì còn lại !" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
			<a href="http://edit.yahoo.com/config/send_webmesg?.target=codervietnam&amp;.src=pg"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_yim.gif" alt="[Yahoo!]" title="[YIM]"></a>
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">mong năm mới anh conmale cho thêm vài đoạn nữa.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">"Một người thành công không có ý nghĩ đổ thừa  thất bại do ...."</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="167725" id="167725"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">30/01/2009 20:33:08 (+0700) | <a href="/hvaonline/posts/list/26956.html#167725">#18</a> | 167725 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">Phó Hồng Tuyết wrote:</cite><br>
		<blockquote>mong năm mới anh conmale cho thêm vài đoạn nữa.&nbsp;
		</blockquote><br/> <br/> Vài đoạn gì em?</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="168085" id="168085"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">04/02/2009 07:55:46 (+0700) | <a href="/hvaonline/posts/list/26956.html#168085">#19</a> | 168085 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/8473446b734702b73ac2972b7bbf7bf7.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/140396.html"><b>Phó Hồng Tuyết</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 20/04/2007 20:02:10<br>
		Messages: 275<br>
	
		Location: Nơi Sâu Thẳm Tâm Hồn<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/140396.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/140396.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http:// ???-những gì còn lại !" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
			<a href="http://edit.yahoo.com/config/send_webmesg?.target=codervietnam&amp;.src=pg"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_yim.gif" alt="[Yahoo!]" title="[YIM]"></a>
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><p></p>
		<cite class="blockquote">conmale wrote:</cite><br>
		<blockquote>Mr. Bi thân mến,<br/> <br/> Mấy hôm nay anh "bị" liên hoan triền miên, xỉn triền miên nên không vào diễn đàn  <img src="/hvaonline/images/smilies/575eda61e93c7ad9d05928580213fd9b.gif" border="0" alt="smilie" align="absbottom">  nên không hồi báo sớm hơn.<br/> <br/> "Vấn nạn" của em gặp phải cũng là vấn nạn mà HVA gặp phải trước đây. Kỹ thuật "detect" dấu hiệu bị tấn công phụ thuộc vào những điểm <b>đặc thù</b> để dựa vào đó mà xử lý. Lần trước, điểm đặc thù em có thể tìm thấy là string "muviet". String này có thể sẽ thay đổi thường xuyên, thậm chí thay đổi random trong mỗi request. Bởi thế, khi chọn lựa một thứ "vũ khí" để chống đỡ, em cần suy nghĩ đến biên độ rộng nhất mà "vũ khí" này có thể bảo vệ em.<br/> <br/> Trong trường hợp không còn "string" (dấu hiệu cụ thể) nào cả thì cần xét kỹ hơn: điểm nào là điểm đặt thù của các packets trên? Nếu em chọn dấu hiện referer www.yahoo.com thì em vô tình cản luôn các request hợp lệ chuyển từ trang tìm kiếm của yahoo vào site của em. Đây là cách không tối ưu.<br/> <br/> Hãy xét xem, tâng số của các requests tấn công em khác các request bình thường thế nào? Các request bình thường (đi từ 1 IP) có khi nào gởi liên tục 10, 20, 30, 40 requests trong 1 giây không? --&gt; đây cũng là điểm đặc thù em có thể dùng để chọn "vũ khí" mới để tự vệ vậy.<br/> <br/> Anh giới thiệu em một đoạn "adaptive" rule dùng module recent để "trị" dạng DDoS không có dấu hiệu (string) gì ngoài tầng số tấn công:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre># create an incoming table to control packets base on recent rules
iptables -N incominghttp

# create a conn table to control maximum connection per IP
iptables -N conn
iptables -A conn -j DROP

# create a blacklist table
iptables -N blacklist
iptables -A blacklist -j LOG --log-prefix "BLACKLISTING: "
iptables -A blacklist -m recent --name BLACKLIST --set -j DROP


# create a httpnormal to control normal flow of http if above is satisfied
iptables -N httpnormal

# now add rules into it &#40;httpnormal&#41;
iptables -A httpnormal -p tcp ! --syn -s $NET --sport $HI_PORTS -d $IP --dport 80 -m state --state NEW -m limit --limit 1/m -j LOG --log-prefix "NEWNOTSYN_HTTP: "
iptables -A httpnormal -p tcp ! --syn -s $NET --sport $HI_PORTS -d $IP --dport 80 -m state --state NEW -j DROP

iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m limit --limit 10/m --limit-burst $BURST_ME -j LOG --log-prefix "SYNFLOOD: "
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m state --state NEW -m limit --limit $SYN_ME --limit-burst $BURST_ME -j ACCEPT
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m state --state NEW -j ACCEPT
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m limit --limit $SYN_ME --limit-burst $BURST_ME -j LOG --log-prefix "OVER_BURST: "
iptables -A httpnormal -p tcp --syn -s $NET -d $IP --dport 80 -m limit --limit $SYN_ME --limit-burst $BURST_ME -j conn

iptables -A httpnormal -p tcp -s $NET -d $IP --dport 80 -m state --state ESTABLISHED -m connlimit --connlimit-above $GLOBAL -m limit --limit 2/m -j LOG --log-prefix "OVERCONNLIMIT: "
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -d $IP --dport 80 -m conntrack --ctstate INVALID -j LOG --log-prefix "INVALID: "
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -d $IP --dport 80 -m conntrack --ctstate INVALID -j DROP
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -m state --state ESTABLISHED -d $IP --dport 80 -m connlimit ! --connlimit-above $GLOBAL -j ACCEPT
iptables -A httpnormal -p tcp -s $NET --sport $HI_PORTS -m state --state ESTABLISHED -d $IP --dport 80 -m connlimit --connlimit-above $GLOBAL -j conn
echo "connlimit is defined"

# After defining INPUT, only allow OUTPUT as ESTABLISHED state
# There should be no SYN packet from port 80 of HTTP server
# Using own server to initiate request to other sites is impossible
iptables -A OUTPUT -p tcp -s $IP --sport 80 -d $NET --dport $HI_PORTS -m state --state ESTABLISHED -j ACCEPT

# then allow all ESTABLISHED INPUT without SYN
# Once the connection is ESTABLISHED &#40;passed all the rules above&#41; - should not restrict rate to maximise performance
iptables -A httpnormal -p tcp ! --syn -s $NET --sport $HI_PORTS -d $IP --dport 80 -m state --state ESTABLISHED -j ACCEPT

# rate limiting on incoming http packets and keep a blacklist for 60 seconds
# this rule drops *any* packet if the IP is in the blacklist
iptables -A incominghttp -m recent --name BLACKLIST --update --seconds 60 -j DROP

# all *established* http connections are allowed to continue
iptables -A incominghttp -p tcp --dport 80 -m state --state ESTABLISHED,RELATED -j httpnormal

# all *new* http connections are all put into a list 'httpconn'
# if there are 20 SYN packets in 30 seconds &#40;as defined in variables SECS and HITS above&#41;
# we send the package to chain 'blacklist ' which puts the IP in the blacklist
iptables -A incominghttp -p tcp --dport 80 -m state --state NEW -m recent --name httpconn --rcheck --seconds $SECS --hitcount $HITS -j blacklist

# if we have seen less then 20 such packets in the last 30 seconds we accept
# and direct the packets to the normal http chain httpnormal
iptables -A incominghttp -p tcp --dport 80 -m state --state NEW -m recent --name httpconn --set -j httpnormal

echo "Start the actual http rule..."
$IPTABS -A INPUT -p tcp -s $NET -d $IP --dport 80 -j incominghttp
echo "The HTTP service is provided"
}</pre>
		</div><br/> <br/> Em xem và suy nghĩ về đoạn rule trên và cho anh biết em đã đúc kết được những gì nhá? <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">.&nbsp;
		</blockquote><br/> <br/> em đã áp dụng thử nhưng nó bão lôi thế này anh à.<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>root@i3network:/etc/init.d# sh entry-conmale
iptables: Chain already exists
iptables: Chain already exists
iptables: Chain already exists
iptables: Chain already exists
Bad argument `limit'
Try `iptables -h' or 'iptables --help' for more information.
Bad argument `ACCEPT'
Try `iptables -h' or 'iptables --help' for more information.
Bad argument `conn'
Try `iptables -h' or 'iptables --help' for more information.
connlimit is defined
Start the actual http rule...
entry-conmale: 65: -A: not found
The HTTP service is provided</pre>
		</div><br/> <br/> em chưa hiểu các lỗi trên mong anh bớt chút thời gian giải thích hộ em.<br/> <br/> <br/> <blockquote>Phó Hồng Tuyết wrote:<br/> <br/>     mong năm mới anh conmale cho thêm vài đoạn nữa.  <br/> <br/> <br/> <br/> Vài đoạn gì em?&nbsp;
		</blockquote><br/> ý là em mong anh cho thêm vài đoạn script. giống như trong topic này nè anh.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">"Một người thành công không có ý nghĩ đổ thừa  thất bại do ...."</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="168131" id="168131"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">04/02/2009 15:11:35 (+0700) | <a href="/hvaonline/posts/list/26956.html#168131">#20</a> | 168131 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/124987.html"><b>Mr.Khoai</b></a><br>
	<font color="#FF9900">Moderator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 27/06/2006 01:55:07<br>
		Messages: 954<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/124987.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/124987.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Phó Hồng Tuyết,<br/> <br/> Đừng có lấy cái iptables script của anh conmale mà chạy đại. Bạn chỉ nên đọc để tham khảo thêm cách anh conmale triển khai firewall cho một forum như HVA là thế nào, sau đó tự bạn nên viết lại một cái firewall để thích hợp với yêu cầu cá nhân của bạn. Chạy script của ảnh thì chả hiểu thêm được gì đâu.<br/> <br/> Trước tiên nên tìm hiểu về iptables đã. Các chains, các rules được áp dụng thế nào? Các modules nào trong kernel hỗ trợ cho iptables? Và hỗ trợ như thế nào?<br/> <br/> khoai</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Vài câu hỏi về Null routing<a name="168136" id="168136"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">04/02/2009 20:25:39 (+0700) | <a href="/hvaonline/posts/list/26956.html#168136">#21</a> | 168136 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Chính xác nội dung của cái "entry-conmale" là gì?<br/> <br/> Anh có đưa ra 100 đoạn script cũng vô nghĩa vì nó không để phục vụ cái gì cả.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- quick reply -->
<table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0" align="center">
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left">
			<!-- watch - unwatch -->
			<!-- add bookmark -->

		</td>
		<td align="right" valign="bottom">			
		</td>
	</tr>
</table>

<!-- mod -->

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- combo navigator -->
<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/posts/list/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/posts/list/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/posts/list/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/posts/list/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/posts/list/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/posts/list/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/posts/list/26956.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
		<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<span class="gensmall">Go to:&nbsp;</span>
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/forums/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Select a forum</option>				
							<option value="0">-------------</option>
									<option value="2" >Thông báo từ HVA</option>
									<option value="41" >FAQ - Các câu hỏi thường gặp</option>
									<option value="5" >Góp ý và Hỏi đáp thắc mắc chung</option>
									<option value="6" >Kiểm tra bảo mật</option>
							<option value="0">-------------</option>
									<option value="8" selected="selected">Thảo luận bảo mật</option>
									<option value="12" >Thảo luận thâm nhập</option>
									<option value="28" >Thảo luận virus, trojan, spyware, worm...</option>
									<option value="36" >Thủ thuật reverse engineering</option>
									<option value="13" >Thông tin new bugs và exploits</option>
									<option value="51" >Case Studies</option>
							<option value="0">-------------</option>
									<option value="23" >Thảo luận hệ điều hành Windows</option>
									<option value="24" >Thảo luận hệ điều hành *nix</option>
									<option value="26" >Thảo luận các loại thiết bị máy tính</option>
									<option value="31" >Thảo luận mạng và thiết bị mạng</option>
									<option value="27" >Thông tin về các địa chỉ và tài liệu hữu ích</option>
							<option value="0">-------------</option>
									<option value="44" >Người tìm việc - Việc tìm người</option>
									<option value="21" >Thảo luận việc định hướng</option>
									<option value="19" >Những thảo luận khác</option>
									<option value="50" >Hình minh họa</option>
									<option value="33" >Trash</option>
							<option value="0">-------------</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- list users in -->
<table class="forumline" cellspacing="3" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<th class="thright"  nowrap="nowrap" height="26" valign="middle">&nbsp;Users currently in here&nbsp;</th>
	</tr>
		<tr>
			<td class="gensmall" valign="middle" align="left">
				1 Anonymous 
				
			</td>	
		</tr>
</table>
<a name="quick"></a>

<table cellspacing="0" cellpadding="0" width="100%" border="0"  align="center">

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
</table>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/avim.js"></script>
<script type="text/javascript">
<!--
function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}




function maxImg(foto, maxSize){
w = foto.width;
if (w > maxSize){
	foto.width = maxSize;
	}
} 

-->
</script>
