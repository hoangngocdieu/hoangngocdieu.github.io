<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Snort - Detecting Intrusions, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Snort - Detecting Intrusions - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<!-- navigator -->
<table cellspacing="2" cellpadding="2" width="100%" border="0" align="center">
	<tr>
		<td valign="baseline" align="left" colspan="0">
			<span class="nav">
			<a class="nav" href="/hvaonline/forums/list.html">Forum Index </a> 
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/forums/show/8.html">Thảo luận bảo mật </a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/posts/list/167.html" name="top" id="top">Snort - Detecting Intrusions</a>
				&nbsp;<a href="/hvaonline/rss/topicPosts/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML"></a>
			</span>
		
		</td>

		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- poll show -->

  <!-- POST LISTING -->


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - Detecting Intrusions<a name="569" id="569"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">21/06/2006 14:34:28 (+0700) | <a href="/hvaonline/posts/list/167.html#569">#1</a> | 569 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/88ae6372cfdc5df69a976e893f4d554b.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/761.html"><b>Mulan</b></a><br>
	<font color="#3366CC">HVA Friend</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 01/02/2002 15:09:07<br>
		Messages: 274<br>
	
		Location: 127.0.0.1<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/761.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/761.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><font color='violet'><b>Phát hiện xâm nhập - Detecting Intrusions</b></font><br/> <br/> Phát hiện xâm nhập đơn giản là phát hiện những tín hiệu , biểu hiện của người xâm nhập trước khi thiệt hại xảy ra như các services bị denied hay mất dữ liệu và chúng ta có thể ngăn chặn thông qua các kĩ thuật khác nhau. Config những log của hệ thống mà lưu giữ những thông tin về services, user hay data. Người quản trị có thể phát hiện những thông tin lý thú trong các log này, nó thực sự quan trọng khi coi các log và là bước đầu tiên cơ bản nhất để phát hiện xâm nhập và system log đã cho thấy giá trị thực sự của nó<br/> <br/> Kế tiếp của sự phát hiện xâm nhập là dùng các tools tự động thường được xem là 1 HIDS ( host-based intrusion detection).HIDS tools bao gồm các software antivirus, persional firewall, NIDS đựơc cài đặt trên các host và nhiều software bảo vệ chống tràn bộ đệm hoặc sự cố gắng bẻ gãy policy của attacker<br/> <br/> Và cuối cùng là NIDS<br/> <br/> Ví dụ về các HIDS<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263299_thumb.jpg' border="0"  /></div><br/> <br/> <font color='violet'>NIDS - Network Instrusion Detection System là gì ? </font><br/> Trên cấp độ căn bản, phát hiện xâm nhập được xem như là 1 tiến trình được quyết định khi 1 người không xác chứng thực đang cố gắng để bẻ gãy hệ thống của bạn. Phát hiện những kết nối không hợp lệ là bước khởi đầu tốt nhưng không phải là tẩt cả câu chuyện. Những hệ thống như Snort có thể phát hiện những sự cố gắng đang login vào hệ thống, truy cập vào những vùng share không được bảo vệ và nhiều điều khác nữa, nhưng nhiều loại xâm nhập không rõ ràng để chúng ta có thể phát hiện dễ dàng như là các các cuộc tấn công dùng phương pháp DoS tuy nó không thiệt hại nhiều chỉ chiếm bandwidth và Cpu, dung lượng ổ cứng trên IDS nhưng nó cũng là tín hiệu để có biện pháp phòng chống hữu hiệu<br/> <br/> NIDS như Snort có thể scan network traffic để phát hiện những tín hiệu nghi ngờ và các gói dữ liệu xấu, và bạn cũng có thể dùng những tools khác như Tcpdump hay ethereal để để xem các luồng thông tin trên các subnet khác nhau, từ những tools này chúng ta có thể sniff các packet để phân tích và debug hệ thống<br/> <br/> Một IDS sẽ kiểm tra tất cả các packet đi qua hệ thống và quyết định packet có vấn đề khả nghi. Bằng cách nào nó có thể biết packet đó khả nghi ? như Snort sẽ có các danh sách các loại packet được mô tả tỷ mỉ giúp hệ thống dựa vào đó mà phán quyết packet nào khả nghi ví dụ như nếu bạn nhận được 1 gói ICMP có kích thước lớn hơn bình thường và bạn có thể đoán được 1 người nào đó đang cố gắng ping of death vào mạng của bạn hoặc như bạn nhận đuợc các packet đựơc phân mảnh ra cực kì ngắn bạn cũng có thể suy ra rằng ai đó đang dùng kĩ thuật tấn công phản hồi làm đảo lộn các gói để lừa firewall thường đuợc gọi là fragmentation attack. Snort cũng như các IDS khác đuợc trang bị hàng ngàn tình huống để nhận dạng tấn công và đuợc cập nhật thường xuyên trên Snort website. Snort và các IDS khác thực sự quan trọng và là lựa chọn hàng đầu để phòng thủ, nếu một attacker xâm nhập và Server của bạn, bạn có thể phát hiện ở system log, mặc dù nhiều attacker tinh ranh xóa đi log của bạn<br/> <br/> Ví dụ đây là mô hình của NIDS<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263853_thumb.jpg' border="0"  /></div><br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263923_thumb.jpg' border="0"  /></div><br/> <br/> Trong đó:<br/> <br/> - IDS sensor: Giám sát các traffic ở các segment / zone, gửi dữ liệu về centralize database server<br/> - Centralize database server: nơi tập trung các dữ liệu lấy từ sensor vào database (mysql chẳng hạn)<br/> - User interface: admin dùng giao diện web UI để giám sát<br/> <br/> Và đây là các module của nó ở mức luận lý<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136263980_thumb.jpg' border="0"  /></div><br/> <br/> Giải thích cụ thể hơn 1 chút:<br/> <br/> Gói tin bị capture từ sensor - host system or network sniffer (có thể là ở cấp độ host hoặc là cấp độ mạng) sẽ được chuyển qua pre-processing<br/> Pre-processing: gồm bộ phận decoder và preprocess:<br/> <br/> - Decoder: đọc packet, nhận biết các trường trong packet<br/> - Preprocess: sắp xếp hoặc modify lại packet trước khi đi vào detection engine. Một số module này có khả năng phát hiện các packet dị thường trong header và sinh ra alert. Ngoài ra, nó có thể tái định dạng gói tin (defragment), sắp xếp lại chuỗi.<br/> <br/> Detection engine: xảy ra quá trình phân tích packet: so sánh mẫu (signature matching) hoặc phân tích các dị thường trong packet (statictical analysis) để đưa ra output (alert manager) quyết định.<br/> <br/> Knowledge base: database signature.<br/> <br/> Long-term storage: nơi chứa các phát hiện dị thường của packet (không được định nghĩa trước)<br/> <br/> Response manager: thực thi đáp ứng của alert manager như: ghi log, popup....<br/> GUI: giao diện đồ họa tương tác.<br/> Nhìn vào các sơ đồ trên ta có thể hình dung được phần nào về hệ thống của IDS, IDS can thiệp vào phần payload của các packet sâu hơn là các firewall, hình minh hoạ sau giúp ta phần biệt firewall và IDS dễ dàng hơn, rất dễ hiểu phần đầu là việc của firewall còn phần sau IDS làm tiếp việc kiểm tra của nó<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136264064_thumb.jpg' border="0"  /></div><br/> <br/> <font color='violet'><b>Tại sao Snort là một NIDS ?</b></font><br/> <br/> Snort được coi như là NIDS mang lại nhiều lợi ích và là 1 NIDS mạnh mẽ phù hợp cho nhiều công ty vì nhiều lý do<br/> <br/> Giá cả<br/> <br/> Là một software mã nguồn mở và tất nhiên là free nhưng dễ dùng đựơc đóng gói thành nhiều sản phẩm phù hợp cho từng doanh nghiệp. Snort đuợc phát triển do công ty Soucefire điều hành bởi Martin Roesch. Hiện tại công ty Check point đã mua lại Soucefire với giá 225 triệu USD<br/> <br/> Ổn định, Nhanh, Mạnh mẽ<br/> <br/> Ngay từ đầu đây là mục đích chính để các nhà phát triển Snort luôn luôn giữ nó nhỏ gọn, nhanh, và trong sáng dễ dùng, không chiếm dụng nhiều đường truyền.<br/> <br/> Tính năng tiền xử lý<br/> <br/> Dùng để xử lý trước các message trong network ở thời gian thực tăng khả năng nhận dạng các packet nghi ngờ, tăng khả năng nhận diện attacker dùng các kĩ thuật tấn công nhằm đánh lạc hướng IDS<br/> <br/> Tính Uyển Chuyển<br/> <br/> Có thể dễ dàng thiết lập những rules trên những mode khác nhau phù hợp với thực trạng của công ty. Có thể dùng các tools để quản lý tập trung như ACID hay SnortCenter. Nhiều Scripts có thể plug-ins để mở rộng chức năng Snort có thể tạo những Access Control List tự động trên các thiết bị Cisco routers là 1 ví dụ điển hình<br/> <br/> Được Support mạnh mẽ<br/> <br/> Nhiều công ty thường xuyên test và kiểm tra các lỗ hổng của Snort đưa ra nhiều biện pháp khắc phục như CERT và SANS. Là sản phẩm nguồn mở nên được support rất nhiều bởi cộng đồng người sử dụng trên internet và các thông báo sẽ gửi đến từng người sử dụng qua mail nếu đăng kí và quan tâm đến Snort.<br/> <br/> <font color='red'>TÀI LIỆU THAM KHẢO: SNORT COOKBOOK---OREILLY, SNORT INSTRUSION DETECTION 2.0--- SYNGRESS<br/> Bài viết sử dụng 1 số hình ảnh của omicron trong bài IDS/IDP vs firewall</font><br/> <br/> <br/> <b><font color='violet'>::: Phần 2 Cài Đặt Và Cấu Hình Snort:::</font></b><br/> <br/> Trong phần này em sẽ trình bày các kĩ thuật thường dùng để bắt các packet và phân tích nội dung của chúng, các kinh nghiệm cài đặt và sử dụng. Em sẽ bắt đầu với cách sử dụng Snort như là Sniffer, Packet logger và cuối cùng là sử dụng Snort thực sự là NIDS<br/> <br/> 2.1.Vài dòng về Snort<br/> <br/> Ngày nay Snort có lẽ là sản phẩn IDS mã nguồn mở nổi tiếng nhất. Snort đuợc thiết kế dùng command line và nó có thể tích hợp chung với các sản phẩm khác và được dùng trên nhiều platforms khác nhau .<br/> Snort lần đầu tiên được phát triển năm 1998 lúc đó chức năng chính của nó là sniff các packet và đến nay nó phát triển vượt bậc với nhiều tính năng mạnh như đã biết. Hàng tuần Snort được download bởi hàng ngàn người và các nhà phát triển.Hiện nay nó được sử dụng như là IDS từ người dùng nhỏ đến các công ty lớn trên toàn thế giới trên nhiều platform khác nhau như Windows,FreeBSD,Linux,Solaris..<br/> <br/> 2.2.Cài Đặt Snort<br/> <br/> Chúng ta có thể cài đặt Snort từ Souce code hay là các gói RPM .Theo kinh nghiệm nên download source code và sau đó biên dịch để cài đặt hơn là dùng các gói binary có sẵn. Ta có thể config Snort kết hợp với MySQL. Hiện tại phiên bản mới nhất của Snort là 2.4.3 ngày 18/10/05 và khuyên nên dùng bản này trước đó ngày 6/10/05 CERT và SANS đã phát hiện lỗ hổng của Snort trong phần tiền xử lý Back Orifice. <br/> <br/> 2.2.1Cài đặt từ Source code<br/> <br/> Cài Snort khá dễ dàng, có nhiều tuỳ chọn phù hợp với nhu cầu ngừơi dùng; phần quan trọng nhất của Snort là kết hợp với nhiều database để lưu trữ. Download và giải nén Snort từ địa chỉ<span class="link"> http://www.Snort.org</span> . tôi thường cài đặt vào thư mục /usr/local/src bạn có thể sử dụng các lệnh sau để cài đặt<br/> <br/> $ tar -xvft Snort-2.4.3.tar.gz<br/> $ cd Snort-2.4.3<br/> $ ./ configure<br/> $ make<br/> $ make install<br/> <br/> Nó sẽ cài vào thư mục /usr/local/bin, mọi user có thể chạy nó. Nếu nó không chạy lệnh configure sẽ thông báo cho bạn biết. Hầu hết các trường hợp đều do 2 thư viện libpcap và PCRE ( pert-compatible regular Expression ) có thể download libpcap ở<span class="link"> http://www.tcpdump.org</span> và PCRE ở<span class="link"> http://www.pcre.org</span><br/> <br/> 2.2.2 Cài đặt trên windows<br/> <br/> Nếu muốn sử dụng Snort trên Windows bạn phải download thư viện winpcap từ địa chỉ<span class="link"> http://winpcap.polito.it.</span> Sau khi cài đặt winpcap rồi ta sẽ download bản cho windows ỏ<span class="link"> http://www.Snort.org/dl/binaries/win32.</span> Snort sẽ chạy với các dòng lệnh trên windows<br/> Một phiên bản khác có thể download từ địa chỉ<span class="link"> http://winSnort.com</span> được quản lý bởi Michael E.Steele và tất nhiên cũng free. Bản dùng cho windows làm việc tốt với cơ sở dữ liệu Microsoft SQL server và cũng có rất nhiều tài liệu về Snort trên website này rất bổ ích.<br/> Nhiều cuộc thảo luận dài diễn ra bàn luận về các hệ điều hành dùng Snort cái nào nhanh nhất. Tổng hợp từ nhiều nguồn tin từ các người dùng bằng cách đo điểm benchmarks chỉ ra rằng bản dùng cho windows nhanh hơn trên Linux và BSD<br/> <br/> Các option trong câu lệnh của Snort<br/> <br/> Các option này cũng được mô tả rất kĩ trong file config của Snort ,nếu chỉ muốn thử và tìm hiểu thì ta nên dùng các command line còn nếu muốn lưu giữ luôn trong file lúc setting nên vào config file<br/> <br/> -A altert-mode<br/> <br/> Nhiều mode được hỗ trợ ở đây như : fast , full, none, unsock<br/> -b<br/> <br/> Log packet dạng tcpdump. file với format dạng tcmdump sẽ nhỏ hơn và là phương pháp tốt nhất khi cần lưu trữ với số luợng lớn log data và packet. dĩ nhiên nhỏ sẽ nhanh hơn và là sự lựa chọn trên các mạng tốc độ cao<br/> <br/> -B address-conversion-mask<br/> <br/> Giúp ẩn địa chỉ thực sự của internal network trong binary logs<br/> <br/> -c config-file<br/> <br/> Chỉ định conifg file nào muốn sử dụng, cần thiết khi Snort chạy ở mode NIDS<br/> <br/> -C<br/> <br/> In ra những kí tự tìm thấy trong packet payload, có thể hiển thị ở dạng hex<br/> <br/> -d<br/> <br/> Hiển thị dữ liệu ở tầng application khi dùng chế độ hiển thị đầy đủ hoặc trong packet logging mode<br/> <br/> -D<br/> <br/> Chạy Snort ở mode daemon. Daemon mode cần thiết khi ta cần chạy Snort tự động mỗi khi startup và sẽ hiển thị trong event khi ta khởi động, không có message nào được hiển thị trong console khi chạy ở mode này<br/> <br/> -e<br/> <br/> Hiển thị hoặc log các lớp liên kết paket headers. thường dùng khi capture packet khi chạy Snort ở chế độ Sniffing<br/> <br/> -F bpf-file<br/> <br/> Đọc Berkeley Packet Filters (BPF) từ bpf file.<br/> <br/> -g group<br/> <br/> Thay đổi group ID hoặc GID mặc định. Thường dùng khi ta muốn Snort chỉ cho dùng bởi những group đặc biệt mục đích để security hơn<br/> <br/> -h home-net<br/> <br/> Thiết lập "home network" chỉ định địa chỉ trong định dạng CIDR. Thường sử dụng để tạo biến HOME_NET trong file config<br/> <br/> -i interface<br/> <br/> Chỉ định interface nào Snort sẽ lắng nghe<br/> <br/> -I<br/> Trong thông báo, hiển thị interface nào mỗi packet khi packet đến nếu ta có nhiều interface cùng lúc sử dụng nhìêu sensor và các sensor gửi các packet đến database quản lý cùng 1 lúc<br/> <br/> -k checksum-mode<br/> <br/> Điều khiển các packet checksums Snort. Nhiều giá trị checksum mode bao gồm all,noip,notcp,noudp,noicmp,none<br/> <br/> -l logging-directory<br/> <br/> Chỉ định thư mục để log các alter. Mặc định thư mục log là /var/log/Snort, nhưng mặc định chỉ sử dụng khi Snort chạy ở -A mode<br/> <br/> -L binary-log-file<br/> <br/> Thiết lập filename của file binary, mặc định sẽ là thời gian thêm vào trước chữ Snort.log được lưu trong log<br/> <br/> -m umask<br/> <br/> Thiết lập chế độ tạo mặt nạ file, đơn giản chỉ là ngăn chặn xem log file trong khi đang capture packet, tránh hacker xoá log<br/> <br/> -n packet-count<br/> <br/> Đếm số luợng packet đang tồn tại. thường dùng khi muốn capture một traffic ở mạng nhỏ trong thời gian ngắn<br/> <br/> -N <br/> <br/> Tắt packet logging nhưng chế độ alert vẫn hoạt động và chỉ hiển thị trên màn hình console. thường dùng để test những file cấu hình mới<br/> <br/> -o<br/> Thay đổi thứ tự các rules đựoc áp đặt đến packet. Thay vì các rules áp đặt theo dạng chuẩn alert  pass  Log, ta có thể áp đặt lại Pass  Alert  Log. Khuyên dùng đối với người dùng chạy SnortCenter hoặc các web interfaces khác. Option này thường sử dụng khi chắc chắn rằng nhựng pass rules sẽ applied trước những detection rules.<br/> <br/> -O<br/> Khi ở mode ASCII, nó sẽ thay thế địa chỉ ip hiển thị trên màn hình hoặc logfile với dạng”xxx.xxx.xxx.xxx”. nếu home-net đựoc set ở -h , chỉ có ip của home-net được hiển thị còn lại sẽ được thay thế. Sử dụng khi capture nhưng packet dùng để làm mẫu và share với mọi người trong các cuộc thảo luận ỏ các group hoặc qua mailing list<br/> <br/> -p<br/> <br/> Tắt chế độ sniff hỗn tạp, chỉ dùng để bảo vệ 1 host duy nhất.<br/> <br/> -P snap-length<br/> <br/> Thiết lập chiều dài tối đa cho các packet capture.Thiết lập để có thể bắt hết các packet, nếu thiết lập chiều dài quá ngắn có thể không coi hết được nội dung của packet khi cần thiết<br/> <br/> -q<br/> <br/> Không hiển thi banner hay những thông tin khi khởi động<br/> <br/> -r tcpdump-file<br/> <br/> Sử dụng option này khi dùng với file định dạng tcpdump<br/> <br/> -s<br/> <br/> Gửi alert message đến syslog server. Có thể gửi ở local hay remote server<br/> <br/> -S variable=value<br/> <br/> Gán giá trị cho biết ví dụ home-net, dn-server….<br/> <br/> -t chroot<br/> <br/> Thay đổi thư mục root của Snort là chroot sau khi khởi động. đường dẫn cho logfiles và các files alert sẽ liên quan trực tiếp đến thư mục mới này<br/> <br/> -T<br/> <br/> Khởi động Snort ơ chế độ selt-test. Hữu ích khi debug Snort trước khi chạy ở chế độ deamon<br/> <br/> -u user<br/> <br/> Thay đổi ID và UID của user giống như –g phía trước<br/> <br/> -U<br/> <br/> Áp đặt thời gian vào log files. Dùng trong các truờng hợp capture từ nhiều sources trên 1 syslog server và các sensor gửi thông qua WAN<br/> <br/> -v<br/> <br/> In toàn bộ packet trên console. Cẩn thận khi dùng, nó làm cho Snort chậm đi khi drop packet<br/> <br/> -V<br/> <br/> Hiển thị Version của Snort<br/> -x<br/> <br/> Hiển thị các packet “thô” cần dùng khi xem các ethernet headers và trailers<br/> <br/> -y<br/> <br/> Bao gồm năm trong log files<br/> <br/> -z<br/> <br/> Bật chức năng stream4<br/> <br/> -?<br/> <br/> Danh sách các option và thoát<br/> <br/> <br/> 2.3. Các chế độ hoạt động của Snort<br/> <br/> Trong phần này, em sẽ trình bày tại sao cần Snort trong khi nó có vẻ giống các phần mềm khác như tcpdump cũng sniff packet và có thể đọc từ định dạng của libpcap. Sau đây là những lý do chứng tỏ Snort có nhiều điểm tốt trong giải pháp sniffing và phát hiện xâm nhập.<br/>  Mô tả sâu sắc về các dòng dữ liệu<br/>  Linh hoạt hơn tcpdump về khả năng đọc và output<br/>  Có thể dễ dàng chỉnh sửa , hiển thị nhiều trường đa dạng trong các headers<br/>  Viết các rules liên quan dễ dàng dễ hiểu và dễ chỉnh sửa<br/>  Có thể report trên các mạng wireless riêng biệt bằng cách sử dụng những patches đặc biệt<br/> <br/> Nhìn tổng quan về cơ chế hoạt động của snort<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-67588-1136455684_thumb.jpg' border="0"  /></div><br/> <br/> <br/> channhua - HVA</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - A Sniffer<a name="570" id="570"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">21/06/2006 14:47:53 (+0700) | <a href="/hvaonline/posts/list/167.html#570">#2</a> | 570 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/88ae6372cfdc5df69a976e893f4d554b.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/761.html"><b>Mulan</b></a><br>
	<font color="#3366CC">HVA Friend</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 01/02/2002 15:09:07<br>
		Messages: 274<br>
	
		Location: 127.0.0.1<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/761.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/761.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><b><font color='violet'>2.3.1 Snort là một Sniffer</font></b><br/> <br/> Snort rất dễ dàng sử dụng để sniff và ta cũng dễ dàng nhìn ra các thông tin từ các packet captured. Một đặc tính rất hay của Snort là bảng tóm tắt về traffic của mạng trong phần cuối của bảng capture nó rất hữu ích cho Adminstrator để troubleshooting mạng của mình.<br/> <br/> Bật chức năng Sniffer bằng cờ -v:<br/> <br/> Snort –v<br/> <br/> <br/> Running in packet dump mode<br/> <br/> Log directory = /var/log/Snort<br/> <br/> <br/> Initializing Network Interface eth0<br/> <br/> <br/>         --== Initializing Snort ==--<br/> <br/> Initializing Output Plugins!<br/> <br/> Decoding Ethernet on interface eth0<br/> <br/> <br/>         --== Initialization Complete ==--<br/> <br/> <br/> -*&gt; Snort! &lt;*-<br/> <br/> Version 2.1.x (Build 72)<br/> <br/> By Martin Roesch (roesch@sourcefire.com, www.Snort.org)<br/> <br/> 06/24-11:19:32.257859 64.147.136.193:3131 -&gt; 192.168.0.15:9100<br/> <br/> TCP TTL:128 TOS:0x0 ID:21742 IpLen:20 DgmLen:48 DF<br/> <br/> ******S* Seq: 0x5DB36D37  Ack: 0x0  Win: 0xFAF0  TcpLen: 28<br/> <br/> TCP Options (4) =&gt; MSS: 1460 NOP NOP SackOK<br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> <br/> 06/24-11:19:32.261606 64.147.136.5 -&gt; 224.0.0.10<br/> <br/> EIGRP TTL:2 TOS:0x0 ID:0 IpLen:20 DgmLen:60<br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> 06/24-11:19:34.470931 64.147.136.1 -&gt; 224.0.0.10<br/> <br/> EIGRP TTL:2 TOS:0xC0 ID:0 IpLen:20 DgmLen:60<br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> 06/24-11:19:34.482799 64.147.136.1 -&gt; 224.0.0.10<br/> <br/> EIGRP TTL:2 TOS:0xC0 ID:0 IpLen:20 DgmLen:60<br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> <br/> ===========================================================================<br/> <br/> Snort analyzed 38 out of 38 packets, dropping 0(0.000%) packets<br/> <br/> <br/> <br/> Breakdown by protocol:                Action Stats:<br/> <br/>     TCP: 1          (2.632%)          ALERTS: 0<br/> <br/>     UDP: 0          (0.000%)          LOGGED: 0<br/> <br/>   ICMP: 0          (0.000%)          PASSED: 0<br/> <br/>     ARP: 0          (0.000%)<br/> <br/>   EAPOL: 0          (0.000%)<br/> <br/>   IPv6: 0          (0.000%)<br/> <br/>     IPX: 0          (0.000%)<br/> <br/>   OTHER: 37        (97.368%)<br/> <br/> DISCARD: 0          (0.000%)<br/> <br/> ===========================================================================<br/> <br/> Wireless Stats:<br/> <br/> Breakdown by type:<br/> <br/>     Management Packets: 0          (0.000%)<br/> <br/>     Control Packets:    0          (0.000%)<br/> <br/>     Data Packets:      0          (0.000%)<br/> <br/> ===========================================================================<br/> <br/> Fragmentation Stats:<br/> <br/> Fragmented IP Packets: 0          (0.000%)<br/> <br/>     Fragment Trackers: 0<br/> <br/>   Rebuilt IP Packets: 0<br/> <br/>   Frag elements used: 0<br/> <br/> Discarded(incomplete): 0<br/> <br/>   Discarded(timeout): 0<br/> <br/>   Frag2 memory faults: 0<br/> <br/> ===========================================================================<br/> <br/> TCP Stream Reassembly Stats:<br/> <br/>         TCP Packets Used: 0          (0.000%)<br/> <br/>         Stream Trackers: 0<br/> <br/>           Stream flushes: 0<br/> <br/>           Segments used: 0<br/> <br/>   Stream4 Memory Faults: 0<br/> <br/> ===========================================================================<br/> <br/> <br/> <br/> Snort exiting<br/> <br/> <br/> Trong phần đầu Snort sẽ hiển thị đang chạy ở mode nào, thư mục chứa log, interface nào đang lắng nghe. Khi bắt đầu chạy và bắt gói tin hiển thị lên màn hình. Phần hiển thị ra chỉ ở mức độ đơn giản, nó chỉ hiện thị ip và TCP/UDP/ICMP headers và 1 số ít khác. Để thoát khỏi chế độ sniffer bấm CTRL - C Snort sẽ thoát hiển thị bảng tóm tắt tổng hợp về các packet bao gồm các protocols, tình trạng packet fragmentation, dòng dữ liệu tập hợp. Để xem ở tầng application ta sử dụng cờ -d thên vào sau:<br/> <br/> #Snort –vd<br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> <br/> 06/24-11:27:35.408290 ARP who-has 64.147.136.1 tell 64.147.136.144<br/> <br/> <br/> <br/> 06/24-11:27:35.408860 64.147.136.144:50507 -&gt; 64.147.130.2:53<br/> <br/> UDP TTL:64 TOS:0x0 ID:0 IpLen:20 DgmLen:57 DF<br/> <br/> Len: 29<br/> <br/> E8 0A 01 00 00 01 00 00 00 00 00 00 03 6E 73 31  .............ns1<br/> <br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01          .ksl.com.....<br/> <br/> <br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> <br/> 06/24-11:27:35.408838 ARP reply 64.147.136.1 is-at 0<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">0:BC:ED:15:E4<br/> <br/> <br/> <br/> 06/24-11:27:35.409465 64.147.130.2:53 -&gt; 64.147.136.144:50507<br/> <br/> UDP TTL:63 TOS:0x0 ID:0 IpLen:20 DgmLen:121 DF<br/> <br/> Len: 93<br/> <br/> E8 0A 85 80 00 01 00 01 00 02 00 01 03 6E 73 31  .............ns1<br/> <br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01 C0 0C 00  .ksl.com........<br/> <br/> 01 00 01 00 00 70 80 00 04 40 93 82 02 C0 10 00  .....p...@......<br/> <br/> 02 00 01 00 00 70 80 00 02 C0 0C C0 10 00 02 00  .....p..........<br/> <br/> 01 00 00 70 80 00 06 03 6E 73 32 C0 10 C0 47 00  ...p....ns2...G.<br/> <br/> 01 00 01 00 00 70 80 00 04 40 93 82 03          .....p...@...<br/> <br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> <br/> Để xem chi tiết hơn và kết quả giống như tcpdump gồm cả phần header của lớp data link và cả tầng application, sử dụng với cờ -e<br/> <br/> #Snort –vde<br/> <br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> <br/> 06/24-11:34:00.840645 0:8:74:F3:CC:F9 -&gt; 0<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">0:BC:ED:15:E4 type:0x800 len:0x47<br/> <br/> 64.147.136.144:50507 -&gt; 64.147.130.2:53 UDP TTL:64 TOS:0x0 ID:0 IpLen:20 DgmLen:57 DF<br/> <br/> Len: 29<br/> <br/> 28 BF 01 00 00 01 00 00 00 00 00 00 03 6E 73 31  (............ns1<br/> <br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01          .ksl.com.....<br/> <br/> <br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> <br/> 06/24-11:34:00.841157 0<img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">0:BC:ED:15:E4 -&gt; 0:8:74:F3:CC:F9 type:0x800 len:0x87<br/> <br/> 64.147.130.2:53 -&gt; 64.147.136.144:50507 UDP TTL:63 TOS:0x0 ID:0 IpLen:20 DgmLen:121 DF<br/> <br/> Len: 93<br/> <br/> 28 BF 85 80 00 01 00 01 00 02 00 01 03 6E 73 31  (............ns1<br/> <br/> 03 6B 73 6C 03 63 6F 6D 00 00 01 00 01 C0 0C 00  .ksl.com........<br/> <br/> 01 00 01 00 00 70 80 00 04 40 93 82 02 C0 10 00  .....p...@......<br/> <br/> 02 00 01 00 00 70 80 00 02 C0 0C C0 10 00 02 00  .....p..........<br/> <br/> 01 00 00 70 80 00 06 03 6E 73 32 C0 10 C0 47 00  ...p....ns2...G.<br/> <br/> 01 00 01 00 00 70 80 00 04 40 93 82 03          .....p...@...<br/> <br/> <br/> <br/> =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br/> <br/> <br/> Các thông tin hiển thị với dạng hex. địa chỉ MAC được ẩn, chỉ thấy được địa chỉ IP. Khi chỉ cần test mạng, hoặc đơn giản thử sử dụng để capture dữ liệu trên Snort thì sử dụng với –vde đã hiển thị gần như đầy đủ các thông tin.<br/> <br/> Với nhiều mạng lơn có lưu luợng thông tin cao, khi bắt gói tin với Snort nó sẽ hiển thị rất nhanh và có thể ta theo dõi không kịp, để giải quyết vần đề trên ta có thể lưu nó vào trong log file với câu lệnh đơn giản Snort –dev &gt;temp.log<br/> <br/> Đây là vài lựa chọn trong mode sniffer của Snort:<br/> <br/> -v Đưa ra packet headers trong phần output<br/> -d Hiển thị packet payload<br/> -a Hiển thị ARP packets<br/> -e Hiển thị dữ liệu lớp data link<br/> <br/> Mô hình minh hoạ sniffing của snort<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136454351_thumb.jpg' border="0"  /></div><br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136454377_thumb.jpg' border="0"  /></div><br/> <br/> <b><font color='violet'>2.3.2 Snort là một packet logger</font></b><br/> <br/> Phần tiếp theo sau khi bắt gói tin là lưu chúng lại vào trong log, để log chỉ đơn giản them cờ -l vào sau đó chỉ đường dẫn thư mục cần log. Mặc định nó sẽ log ở thư mục /var/log/Snort . Nếu ta chỉ định thư mục log mà không tồn tại nó sẽ báo lỗi. Ví dụ câu lệnh sau đây để log<br/> <br/> #Snort –l /usr/local/log/Snort –d<br/> <br/> Khi chạy ở chế độ này, Snort sẽ tập hợp tất cả các packet nó thấy được và đưa vào log theo cấu trúc phân tầng. Nói cách khác, 1 thư mục mới sẽ được tạo ra ứng với mỗi địa chỉ nó bắt đựơc, và dữ liệu sẽ phụ thuộc vào địa chỉ mà nó lưu trong thư mục đó. Snort đặt các packet vào trong files ASCII, với tên liên quan tới protocol và port. Sự sắp xếp này dễ dàng nhận ra ai đang connect vào network của mình và protocol và port nào đang sử dụng, đơn giản sử dụng ls - R hoặc (dir /s trong windows) để hiện danh sách các thư mục.Tuy nhiên sự phân cấp này sẽ tạo ra nhiều thư mục trong giờ cao điểm , thật khó có thể coi hết với hàng đống thư mục và files này. Nếu ai đó có ý định dùng chế độ full scan toàn mạng với 65536 Tcp ports và 65535 Udp ports, và sẽ tạo ra 131000 hoặc hơn từng ấy file như thế trong 1 thư mục , để xem hết đống này thì dùng thêm vài viên thuốc đau đầu nữa.<br/> <br/> Log với dạng nhị phân (binary) tất cả những gì có thể đọc được bời Snort, nó làm tăng đốc độ khả năng bắt gói tin của Snort. Hầu hết các hệ thống có thể capture và log ở tốc độ 100Mbps mà không có vấn đề gì.<br/> <br/> Để log packet ở chế độ nhị phân, sự dụng cờ -b.<br/> <br/> #Snort -b -l /usr/local/log/Snort/temp.log<br/> <br/> Khi đã capture, ta có thể đọc lại file mới vừa tạo ra ngay với cỡ -r và phần hiển thị giống như ở mode sniffer<br/> <br/> #Snort -r /usr/local/log/Snort/temp.log<br/> <br/> Trong phần này Snort không giới hạn để dọc các file binary trong chế độ sniffer. Ta có thể chạy Snort ở chế độ NIDS với việc set các rules hoặc filters để tìm những traffic nghi ngờ<br/> <br/> <br/> <b><font color='violet'>2.3.3 Snort là NIDS:</font></b><br/> <br/> Trong khi Snort là sniffer tốt nó còn là 1 tools rất xuất sắc trong phát hiện xâm nhập. Khi sử dụng như NIDS, Snort cung gần thời gian thực nhất về khả năng xâm nhập. Ta sẽ trãi qua nhiều thời gian để tìm hiểu nhiều cách khác nhau về Snort với chức năng NIDS và các option của nó<br/> <br/> 2.2.3.1 Lấy những rules mới nhất<br/> <br/> Ta thường lưu các rules ở vị trí nào đó có thể dễ dang theo dõi và thay đổi ngay lập tức khi cần, ví dụ ta tạo 1 thư mục để chứa các rules /usr/local/share, trong thư mục này ta sẽ tạo nhiều thư mục con với tháng và năm ví dụ November_2005 và khi update các rules ta lưu nó vào các vị trí đã tạo sẵn đó<br/> Nếu sử dụng Snort version là 2.4.3 ta có thể download những rules mới nhất từ địa chỉ<br/><span class="link"> http://www.Snort.org/dl/rules/Snortrules-snapshot-2.4.tar.gz</span><br/> Sau khi down về và giải nén ta có được khoảng 60 files, mỗi file có phần mở rộng là .rules chứa những tín hiệu (signatures) để Snort dựa vào đó mà nhận dạng nội dung của các packet. File Snort.conf chứa các thiết lập khi Snort chạy ở chế độ IDS. Các files này đã đuợc viết sẵn và test khá kĩ càng nên ta không cần config lại<br/> <br/> 2.2.3.2 Khởi đầu cấu hình với file Snort.conf<br/> <br/> Ở chế độ báo động ( alert ), Snort yêu cầu phải có file cấu hình, files cấu hình mặc định lưu ở thư mục /etc/Snort.conf, nếu file nằm ở chỗ khác ta phải dùng cờ -c để chỉ tới files đó. Các báo động sẽ lưu ở thư mục /var/log/Snort ( mặc định ).Snort sẽ thoát ra nếu file .conf và thư mục log không có. Ta có thể chỉ định loại báo động nào ví dụ như full, fast,none hoặc Unix sockets bằng cách thêm cờ -A vào dòng lệnh<br/> <br/> Lần đầu nhìn vào file Snort.conf ta có thể nhìn thấy nhiều dòng chú thích rất dễ hiểu với màu sắc dễ phân biệt, ví dụ như tạo các biến, set các đường dẫn RULE_PATH để chỉ Snort các files rules <br/> ví dụ:<br/> <br/> var RULE_PATH ../rules<br/> <br/> Thay đổi đường dẫn đầy đủ nơi chứa các rules<br/> <br/> var RULE_PATH /usr/local/share/Snort_rules/november_2005/rules<br/> <br/> Để cho Snort khởi động, sử dụng dòng lệnh:<br/> <br/> Snort -c /usr/local/share/Snort_rules/november_2005/rules/Snort.conf<br/> <br/> Nó sẽ hiển thị ra màn hình console<br/> <br/> <br/> Running in IDS mode<br/> <br/> Log directory = /var/log/Snort<br/> <br/> <br/> <br/> Initializing Network Interface eth0<br/> <br/> <br/> <br/>         --== Initializing Snort ==--<br/> <br/> Initializing Output Plugins!<br/> <br/> Decoding Ethernet on interface eth0<br/> <br/> Initializing Preprocessors!<br/> <br/> Initializing Plug-ins!<br/> <br/> Parsing Rules file /usr/local/share/Snort_rules/rules/Snort.conf<br/> <br/> <br/> <br/> +++++++++++++++++++++++++++++++++++++++++++++++++++<br/> <br/> Initializing rule chains...<br/> <br/> ,-----------[Flow Config]----------------------<br/> <br/> | Stats Interval:  0<br/> <br/> | Hash Method:    2<br/> <br/> | Memcap:          10485760<br/> <br/> | Rows  :          4099<br/> <br/> | Overhead Bytes:  16400(%0.16)<br/> <br/> `----------------------------------------------<br/> <br/> No arguments to frag2 directive, setting defaults to:<br/> <br/>     Fragment timeout: 60 seconds<br/> <br/>     Fragment memory cap: 4194304 bytes<br/> <br/>     Fragment min_ttl:  0<br/> <br/>     Fragment ttl_limit: 5<br/> <br/>     Fragment Problems: 0<br/> <br/>     Self preservation threshold: 500<br/> <br/>     Self preservation period: 90<br/> <br/>     Suspend threshold: 1000<br/> <br/>     Suspend period: 30<br/> <br/> Stream4 config:<br/> <br/>     Stateful inspection: ACTIVE<br/> <br/>     Session statistics: INACTIVE<br/> <br/>     Session timeout: 30 seconds<br/> <br/>     Session memory cap: 8388608 bytes<br/> <br/>     State alerts: INACTIVE<br/> <br/>     Evasion alerts: INACTIVE<br/> <br/>     Scan alerts: INACTIVE<br/> <br/>     Log Flushed Streams: INACTIVE<br/> <br/>     MinTTL: 1<br/> <br/>     TTL Limit: 5<br/> <br/>     Async Link: 0<br/> <br/>     State Protection: 0<br/> <br/>     Self preservation threshold: 50<br/> <br/>     Self preservation period: 90<br/> <br/>     Suspend threshold: 200<br/> <br/>     Suspend period: 30<br/> <br/> Stream4_reassemble config:<br/> <br/>     Server reassembly: INACTIVE<br/> <br/>     Client reassembly: ACTIVE<br/> <br/>     Reassembler alerts: ACTIVE<br/> <br/>     Zero out flushed packets: INACTIVE<br/> <br/>     flush_data_diff_size: 500<br/> <br/>     Ports: 21 23 25 53 80 110 111 143 513 1433 <br/> <br/>     Emergency Ports: 21 23 25 53 80 110 111 143 513 1433 <br/> <br/> HttpInspect Config:<br/> <br/>     GLOBAL CONFIG<br/> <br/>       Max Pipeline Requests:    0<br/> <br/>       Inspection Type:          STATELESS<br/> <br/>       Detect Proxy Usage:      NO<br/> <br/>       IIS Unicode Map Filename: /usr/local/share/Snort_rules/rules/unicode.map<br/> <br/>       IIS Unicode Map Codepage: 1252<br/> <br/>     DEFAULT SERVER CONFIG:<br/> <br/>       Ports: 80 8080 8180 <br/> <br/>       Flow Depth: 300<br/> <br/>       Max Chunk Length: 500000<br/> <br/>       Inspect Pipeline Requests: YES<br/> <br/>       URI Discovery Strict Mode: NO<br/> <br/>       Allow Proxy Usage: NO<br/> <br/>       Disable Alerting: NO<br/> <br/>       Oversize Dir Length: 500<br/> <br/>       Only inspect URI: NO<br/> <br/>       Ascii: YES alert: NO<br/> <br/>       Double Decoding: YES alert: YES<br/> <br/>       %U Encoding: YES alert: YES<br/> <br/>       Bare Byte: YES alert: YES<br/> <br/>       Base36: OFF<br/> <br/>       UTF 8: OFF<br/> <br/>       IIS Unicode: YES alert: YES<br/> <br/>       Multiple Slash: YES alert: NO<br/> <br/>       IIS Backslash: YES alert: NO<br/> <br/>       Directory: YES alert: NO<br/> <br/>       Apache WhiteSpace: YES alert: YES<br/> <br/>       IIS Delimiter: YES alert: YES<br/> <br/>       IIS Unicode Map: GLOBAL IIS UNICODE MAP CONFIG<br/> <br/>       Non-RFC Compliant Characters: NONE<br/> <br/> rpc_decode arguments:<br/> <br/>     Ports to decode RPC on: 111 32771 <br/> <br/>     alert_fragments: INACTIVE<br/> <br/>     alert_large_fragments: ACTIVE<br/> <br/>     alert_incomplete: ACTIVE<br/> <br/>     alert_multiple_requests: ACTIVE<br/> <br/> telnet_decode arguments:<br/> <br/>     Ports to decode telnet on: 21 23 25 119 <br/> <br/> 1652 Snort rules read...<br/> <br/> 1652 Option Chains linked into 152 Chain Headers<br/> <br/> 0 Dynamic rules<br/> <br/> +++++++++++++++++++++++++++++++++++++++++++++++++++<br/> <br/> <br/> <br/> <br/> <br/> +-----------------------[thresholding-config]----------------------------------<br/> <br/> | memory-cap : 1048576 bytes<br/> <br/> +-----------------------[thresholding-global]----------------------------------<br/> <br/> | none<br/> <br/> +-----------------------[thresholding-local]-----------------------------------<br/> <br/> | gen-id=1      sig-id=2275      type=Threshold tracking=dst count=5  seconds=60 <br/> <br/> +-----------------------[suppression]------------------------------------------<br/> <br/> -------------------------------------------------------------------------------<br/> <br/> Rule application order: -&gt;activation-&gt;dynamic-&gt;alert-&gt;pass-&gt;log<br/> <br/> <br/> <br/>         --== Initialization Complete ==--<br/> <br/> <br/> <br/> -*&gt; Snort! &lt;*-<br/> <br/> Version 2.1.x (Build 24)<br/> <br/> By Martin Roesch (roesch@sourcefire.com, www.Snort.org)<br/> <br/> Tới đây ta có thể kết thúc dùng lệnh CTRL – C sẽ xuất hiện các bảng tóm tắt: <br/> <br/> <br/> <br/> ===============================================================================<br/> <br/> Snort analyzed 3210 out of 3807 packets, dropping 597(15.682%) packets<br/> <br/> <br/> Breakdown by protocol:                Action Stats:<br/> <br/>     TCP: 2602      (68.348%)        ALERTS: 6        <br/> <br/>     UDP: 2          (0.053%)          LOGGED: 6        <br/> <br/>   ICMP: 8          (0.210%)          PASSED: 0        <br/> <br/>     ARP: 0          (0.000%)<br/> <br/>   EAPOL: 0          (0.000%)<br/> <br/>   IPv6: 0          (0.000%)<br/> <br/>     IPX: 0          (0.000%)<br/> <br/>   OTHER: 0          (0.000%)<br/> <br/> DISCARD: 0          (0.000%)<br/> <br/> ===============================================================================<br/> <br/> Wireless Stats:<br/> <br/> Breakdown by type:<br/> <br/>     Management Packets: 0          (0.000%)<br/> <br/>     Control Packets:    0          (0.000%)<br/> <br/>     Data Packets:      0          (0.000%)<br/> <br/> ===============================================================================<br/> <br/> Fragmentation Stats:<br/> <br/> Fragmented IP Packets: 0          (0.000%)<br/> <br/>     Fragment Trackers: 0        <br/> <br/>   Rebuilt IP Packets: 0        <br/> <br/>   Frag elements used: 0        <br/> <br/> Discarded(incomplete): 0        <br/> <br/>   Discarded(timeout): 0        <br/> <br/>   Frag2 memory faults: 0        <br/> <br/> ===============================================================================<br/> <br/> TCP Stream Reassembly Stats:<br/> <br/>         TCP Packets Used: 2602      (68.348%)<br/> <br/>         Stream Trackers: 1559      <br/> <br/>           Stream flushes: 0        <br/> <br/>           Segments used: 0        <br/> <br/>   Stream4 Memory Faults: 0        <br/> <br/> ===============================================================================<br/> <br/> Final Flow Statistics<br/> <br/> ,----[ FLOWCACHE STATS ]----------<br/> <br/> Memcap: 10485760 Overhead Bytes 16400 used(%2.287951)/blocks (239909/1564) Overhead <br/> <br/> blocks: 1 Could Hold: (73326)<br/> <br/> IPV4 count: 1563 frees: 0 low_time: 1080162455, high_time: 1080162458, diff: 0h:00:<br/> <br/> 03s<br/> <br/>     finds: 2612 reversed: 1022(%39.127106) <br/> <br/>     find_sucess: 1049 find_fail: 1563 percent_success: (%40.160796) new_flows: 1563<br/> <br/> Protocol: 1 (%0.306279) finds: 8  reversed: 3(%37.500000) <br/> <br/>   find_sucess: 5 find_fail: 3 percent_success: (%62.500000) new_flows: 3<br/> <br/> Protocol: 6 (%99.617152) finds: 2602  reversed: 1018(%39.123751) <br/> <br/>   find_sucess: 1043 find_fail: 1559 percent_success: (%40.084550) new_flows: 1559<br/> <br/> Protocol: 17 (%0.076570) finds: 2  reversed: 1(%50.000000) <br/> <br/>   find_sucess: 1 find_fail: 1 percent_success: (%50.000000) new_flows: 1<br/> <br/> Snort exiting<br/> <br/> <br/> <br/> <br/> Bây giờ đã có 1 file báo động trong thư mục /var/log/Snort. File sẽ bao gồm các báo động từ Snort khi đang chạy ( trong bài này có sử dụng nmap SYN scan để cho Snort báo động )<br/> <br/> <br/> [**] [1:469:1] ICMP PING NMAP [**]<br/> <br/> [Classification: Attempted Information Leak] [Priority: 2] <br/> <br/> 03/24-15:07:35.187504 192.168.1.2 -&gt; 192.168.1.105<br/> <br/> ICMP TTL:51 TOS:0x0 ID:23210 IpLen:20 DgmLen:28<br/> <br/> Type:8  Code:0  ID:1290  Seq:0  ECHO<br/> <br/> [Xref =&gt;<span class="link"> http://www.whitehats.com/info/IDS162]</span><br/> <br/> <br/> <br/> [**] [1:618:5] SCAN Squid Proxy attempt [**]<br/> <br/> [Classification: Attempted Information Leak] [Priority: 2] <br/> <br/> 03/24-15:07:35.583826 192.168.1.2:49641 -&gt; 192.168.1.105:3128<br/> <br/> TCP TTL:44 TOS:0x0 ID:56810 IpLen:20 DgmLen:40<br/> <br/> ******S* Seq: 0x4EB5A7C6  Ack: 0x0  Win: 0x400  TcpLen: 20<br/> <br/> <br/> <br/> [**] [1:1421:3] SNMP AgentX/tcp request [**]<br/> <br/> [Classification: Attempted Information Leak] [Priority: 2] <br/> <br/> 03/24-15:07:35.589463 192.168.1.2:49641 -&gt; 192.168.1.105:705<br/> <br/> TCP TTL:44 TOS:0x0 ID:54050 IpLen:20 DgmLen:40<br/> <br/> ******S* Seq: 0x4EB5A7C6  Ack: 0x0  Win: 0x400  TcpLen: 20<br/> <br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://</span><br/> <br/> cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]<br/> <br/> <br/> <br/> [**] [1:615:5] SCAN SOCKS Proxy attempt [**]<br/> <br/> [Classification: Attempted Information Leak] [Priority: 2] <br/> <br/> 03/24-15:07:35.674332 192.168.1.2:49641 -&gt; 192.168.1.105:1080<br/> <br/> TCP TTL:44 TOS:0x0 ID:9794 IpLen:20 DgmLen:40<br/> <br/> ******S* Seq: 0x4EB5A7C6  Ack: 0x0  Win: 0x400  TcpLen: 20<br/> <br/> [Xref =&gt;<span class="link"> http://help.undernet.org/proxyscan/]</span><br/> <br/> <br/> <br/> [**] [1:1420:3] SNMP trap tcp [**]<br/> <br/> [Classification: Attempted Information Leak] [Priority: 2] <br/> <br/> 03/24-15:07:35.696925 192.168.1.2:49641 -&gt; 192.168.1.105:162<br/> <br/> TCP TTL:44 TOS:0x0 ID:41259 IpLen:20 DgmLen:40<br/> <br/> ******S* Seq: 0x4EB5A7C6  Ack: 0x0  Win: 0x400  TcpLen: 20<br/> <br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]</span><br/> <br/> <br/> <br/> [**] [1:1418:3] SNMP request tcp [**]<br/> <br/> [Classification: Attempted Information Leak] [Priority: 2] <br/> <br/> 03/24-15:07:35.827022 192.168.1.2:49641 -&gt; 192.168.1.105:161<br/> <br/> TCP TTL:44 TOS:0x0 ID:37753 IpLen:20 DgmLen:40<br/> <br/> ******S* Seq: 0x4EB5A7C6  Ack: 0x0  Win: 0x400  TcpLen: 20<br/> <br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]</span><br/> <br/> <br/> <br/> Ví dụ phân tích một báo động của Snort<br/> <br/> Đây là tên của báo động:<br/> <br/> [**] [1:1418:3] SNMP request tcp [**]<br/> <br/> Snort sẽ chia ra nhiều lớp cho từng loại báo động , ví dụ cái này là thuộc dang đang cố gắng đánh lừa thông tin “Attempted Information Leak” và mức độ ưu tiên của từng báo động<br/> <br/> <br/> [Classification: Attempted Information Leak] [Priority: 2] <br/> <br/> Đây là phần header và thông tin của packet là nguyên nhân gây ra báo đông:<br/> <br/> <br/> 03/24-15:07:35.827022 192.168.1.2:49641 -&gt; 192.168.1.105:161<br/> <br/> TCP TTL:44 TOS:0x0 ID:37753 IpLen:20 DgmLen:40<br/> <br/> ******S* Seq: 0x4EB5A7C6  Ack: 0x0  Win: 0x400  TcpLen: 20<br/> <br/> <br/> <br/> Snort sẽ báo động bao gồm các đường dẫn tới mô tả các rules gây ra báo động <br/> <br/> [Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0013]</span>[Xref =&gt;<span class="link"> http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0012]</span><br/> <br/> link này rất hữu ích khi xem xét lại có bị báo động lỗi hay không.<br/> <br/> <br/> <b><font color='violet'>2.4. File Snort.conf</font></b><br/> <br/> File Snort.conf điều khiển mọi thứ mà Snort thấy được, làm cách nào nó có thể chống lại các cuộc tấn công, những rules nào được sử dụng khi thấy nghi ngờ, và làm cách nào nó có thể phát hiện ra được những dấu hiệu nguy hiểm tìm tàng mặc dù nó không có các tín hiệu nhận dạng cụ thể để so sánh. Để hiểu và cấu hình nó thành công khi phát triển Snort thành 1 công cụ IDS thật sự. Tôi sẽ trình bày cụ thể những kinh nghiệm hiểu biết về Snort sau đây. Để tìm hiểu nó 1 cách nhanh nhất và dễ dàng nên mở sẵn nó ra trên máy tính hoặc in nó ra giấy theo dõi cho dễ dàng.<br/> Ví dụ file Snort.conf mở ra bằng gedit<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136454922_thumb.jpg' border="0"  /></div><br/> <br/> File conf được chia ra thành nhiều đoạn và có chú thích rất rõ ràng cho từng đoạn, những nội dung chính của nó gồm:<br/> <br/> • Thiết lập mạng và cấu hình các biến<br/> • Cấu hình phần giải mã (decoder) 1và phát hiện<br/> • Cấu hình tiền xử lý (preprocessor)<br/> • Cấu hình phần output<br/> • File được trỏ tới<br/> <br/> 2.4.1 Thiết lập mạng và cấu hình các biến<br/> <br/> Các biến trong file conf được tạo ra thường để dễ dàng hơn trong việc theo dõi các địa chỉ IP, hoặc các port TCP,UDP được chỉ định mà nó đang lắng nghe.<br/> Mặc định các biến thường để giá trị là any chỉ tất cả các địa chỉ IP mà nó nhận được, nó cũng có thể là nguyên nhân gây ra nhiều báo động sai.<br/> <br/> Để chị định 1 địa chỉ ip, đơn gian chỉ làm theo cách sau:<br/> <br/> Var HOME_NET 192.168.1.1<br/> <br/> Hoặc khi muốn chỉ định nhiều địa chỉ cùng lúc, phải có dấu ngoặc vuông để chỉ định cho cả nhóm:<br/> <br/> Var HOME_NET [192.168.1.1,192.168.14.1,10.0.0.2]<br/> <br/> Ta cũng có cách khác để chỉ định luôn cả mạng:<br/> <br/> Var HOME_NET 10.10.10.0/24<br/> <br/> Hoặc cũng có thể gộp cả 2 cách trên vào chung 1 nhóm:<br/> <br/> Var HOME_NET [192.168.1.1,10.10.10.0/24,172.168.1.5/16,187.1.1.1/19]<br/> <br/> Nếu muốn chỉ định không dùng các ip này ngoại trừ … thì dùng thêm dấu “than” ! nghĩa là NOT<br/> <br/> Var EXTERNAL_NET !$HOME_NET<br/> <br/> Để chỉ định cho các port cũng làm tương tự ví dụng<br/> <br/> Var ORACLE_PORTS 1521<br/> <br/> Hoặc các port không phải là port 80<br/> <br/> Var SHELLCODE_PORTS !80<br/> <br/> 2.4.1.1 Các biến mặc định trong Snort.conf<br/> <br/> HOME_NET : chỉ định địa chỉ mạng của mình đang bảo vệ<br/> EXTERNAL_NET: các mạng bên ngoài.<br/> <br/> Các biến để chỉ định các server đang chạy các service phục vụ cho hệ thống<br/> <br/> DNS_SERVERS<br/> SMTP_SERVERS<br/> HTTP_SERVERS<br/> SQL_SERVERS<br/> TELNET_SERVERS<br/> SNMP_SERVERS<br/> ……<br/> <br/> Các port mặc định các biến khác:<br/> <br/> HTTP_PORTS<br/> SHELLCODE_PORTS<br/> ORACLE_PORTS<br/> AIM_SERVERS <br/> RULES_PATH<br/> <br/> 2.4.2 Cấu hình phần giải mã ( decoder ) và phát hiện ( detection )<br/> <br/> Snort sẽ giải mã cấu trúc các packet và so sánh cấu trúc theo những dấu hiệu đã được trang bị. Nếu packet có kích thước lạ, nhìêu cấu hình lạ không bình thường, Snort sẽ báo động. Nếu không báo động thì sẽ có 1 luợng lớn lỗi báo động sai. Ta có thể tắt chức năng này. Mặc định tất cả báo động đều bật. Để tắt 1 loại báo động cụ thể nào đó, ta nên để dấu thăng # vào trước dòng lệnh thành dòng comment ghi chú<br/> <br/> # config disable_decode_alerts<br/> <br/> # config disable_tcpopt_experimental_alerts<br/> <br/> # config disable_tcpopt_obsolete_alerts<br/> <br/> # config disable_tcpopt_ttcp_alerts<br/> <br/> # config disable_tcpopt_alerts<br/> <br/> # config disable_ipopt_alerts<br/> <br/> <br/> Mô hình làm việc của decode<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455089_thumb.jpg' border="0"  /></div><br/> <br/> Mô hình detect các packet<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455127_thumb.jpg' border="0"  /></div><br/> <br/> Ta cũng có thể thêm vào nhiều dòng lênh của Snort trong phần này của file Snort.conf<br/> <br/> <br/> Cấu Hình Option Của Snort.conf <br/> <br/> <br/> <br/> Option ----------- Mô tả<br/> <br/> config order: [pass, alert, log, activation, or dynamic]  ----------- Thay đổi các giá trị điều khỉên của rules<br/> config alertfile: alerts  ----------- Thiết lập output của file báo động<br/> config decode_arp  -----------  Bật chức năng arp decoding (Snort -a).<br/> config dump_chars_only  ----------- Bật chức năng character dumps (Snort -C).<br/> config dump_payload  ----------- Hiện thông tin lớp application(Snort -d).<br/> config decode_data_link  ----------- giải mã  Layer2 headers (Snort -e).<br/> config bpf_file: filters.bpf  ----------- Chỉ định dùng bộ lọc BPF (Snort -F).<br/> config set_gid: 30  ----------- Thay đổi GID  đến GID khác (Snort -g).<br/> config daemon  -----------Chạy  Snort ở chế độ daemon (Snort -D).<br/> config interface: &lt;interface name&gt;  ----------- Thiết lập interface  (Snort -i).<br/> config alert_with_interface_name  ----------- Chỉ định interface cần báo động (Snort -I).<br/> config logdir: /var/log/Snort  ----------- Thiết lập lại thư mục log (Snort -l).<br/> config umask: &lt;umask&gt;  ----------- Thiết lập umask khi chạy (Snort -m).<br/> config pkt_count: N ----------- Thoát ra sau N packets (Snort -n).<br/> config nolog  ----------- Tăt  chế độ log  (Snort -N).<br/> config obfuscate  ----------- Ẩn địa chỉ  IP (Snort -O).<br/> config no_promisc ----------- Tắt chế độ cho chạy lẫn lộn (Snort -p).<br/> config quiet  ----------- Tắt banner và report trạng thái (Snort -q).<br/> config chroot: /home/Snort  ----------- Thay đổi lại thư mục root  (Snort-T).<br/> config checksum_mode : all  ----------- Các loại packet dùng để tính toán lại checksums: none, noip, notcp, noicmp, noudp, or all.<br/> config set_uid: &lt;id&gt;  ----------- Thay đổi UID ra uid mới  (Snort-u).<br/> config utc  ----------- Sử dụng UTC thay vì dùng thời gian máy local gán cho timestamps (Snort -U).<br/> config verbose  ----------- Sử dụng chế độ xem chi tiết  (Snort -v.)<br/> config dump_payload_verbose  ----------- Hiển thị những packet "thô" bắt đầu ở lớp linkdata (Snort-X ).<br/> config show_year  ----------- Hiển thị timestamps năm (Snort-y).<br/> <br/>  channhua - HVA</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - A Preprocessor<a name="572" id="572"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">21/06/2006 15:00:03 (+0700) | <a href="/hvaonline/posts/list/167.html#572">#3</a> | 572 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/88ae6372cfdc5df69a976e893f4d554b.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/761.html"><b>Mulan</b></a><br>
	<font color="#3366CC">HVA Friend</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 01/02/2002 15:09:07<br>
		Messages: 274<br>
	
		Location: 127.0.0.1<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/761.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/761.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><b><font color='violet'>2.4.3 Cấu hình tiền xử lý (preprocessor)</font></b><br/> <br/> Tiền xử lý phục vụ cho nhiều mục đích. Nó “bình thường hoá” traffic cho các services, để chắc chắn rằng dữ liệu trong các packet Snort đang theo dõi sẽ có cơ hội tốt nhất để so sánh với các tín hiệu nhận dạng (signatures ) mà Snort đuợc trang bị. Chức năng khác của quá trình tiền xử lý là tự phòng thủ. Các cuộc tấn công được phát triển để lẩn tránh hoặc làm tràn ngập NIDS sensor, vì thế attacker có thể lợi dụng làm những công việc mình cần. Chức năng frag2 và stream4 tiền xử lý có chức năng chính để chống lại các phương pháp này.<br/> Và chức năng cuối cùng cũng là chức năng quan trọng nhất là làm cho Snort có thêm chút thông minh để phát hiện ra các cuộc tấn công mang phong cách không bình thuờng mà Snort không được trang bị trong rules.<br/> <br/> Mô hình các gói tin đi vào ở mode preprocessor<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455634_thumb.jpg' border="0"  /></div><br/> <br/> 2.4.3.1 FLOW<br/> <br/> Flow preprocessor có một module là flow-portscan. Flow theo dõi tất cả traffic và giữ các track kết nối giữa hệ thống và port lạ, khi có 1 flow lạ mới thông tin sẽ chuyển qua hash (làm cho các track nhỏ hơn , nhanh hơn trong tracking các địa chỉ IP và PORTS) được lưu trữ trong bảng bộ nhớ dành sẵn. Các option cho flow preprocessor<br/> <br/> Memcap<br/> <br/> Chỉ định mức tối đa cho bộ nhớ khi tracking, mặc định là 10MB, thông số này để điều khỉên bộ nhớ của Snort khi cần<br/> <br/> Rows<br/> <br/> Chỉ định số dòng trên bảng hash, mặc định là 4,099 dòng<br/> <br/> Stats_interval<br/> <br/> Có thể chuyển tình trạng của flow preprocessor qua stdout, giá trị là một số nguyên đại diện cho thời gian tính bằng giây (s) , rất hữu ích khi dùng cho mục đích test<br/> <br/> Hash<br/> Phương pháp sử dụng hash thông tin vào bảng, có thể set hash có giá trị là 1 (byte) hoặc 2 (số nguyên ) dùng hash 2 nhanh hơn<br/> <br/> Đây là cấu hình khuyên của các nhà phát triên dùng cho flow:<br/> <br/> Preprocessor flow: stats_interval 0 hash 2<br/> <br/> 2.4.3.2 frag2<br/> <br/> Khi một packet đi từ mạng này qua mạng khác, nó thường cần phân mảnh thành các packet nhỏ hơn, bởi vì mạng thứ 2 sẽ giới hạn kích thuớc của packet và tất nhiên nhỏ hơn mạng đầu tiên. Và tất cả các packet nhỏ sẽ đuợc sắp xếp lại khi đến nơi. Một trong những phương pháp của attacker là dùng các packet nhỏ để lừa firewall hoặc IDS. Ví dụ: rules của Snort đang dò tìm chuỗi /users.pwd trong các section của packet, một attacker có thể tạo ra một dãy các packet rất nhỏ chỉ chứa vài byte trong data của packet, mảnh đầu tiên có thể chứa /user , và cái packet phân mảnh thứ 2 có thể chứa s.pwd, các packet này sẽ không kích hoạt báo động bởi vì nó không giống các rules nào cả, frag2 preprocessor sẽ sắp xếp sự phân mảnh này vào chung và nó sẽ dễ dàng phát hiện sự ẩn dấu đó. Hoặc một ví dụ khác các attacker có thể đưa ra 1 dung lượng quá lớn các packet đã phân mảnh nó sẽ chiếm dung lưonng của hệ thống và làm overload có thể Snort sẽ từ chối tất cả và ảnh hưởng tới các packet không liên quan, các tools mà attacker thường dùng là Fragroute, frag2 có các options để chống lại các dạng tấn công này<br/> <br/> Timeout:<br/> <br/> Số dây trước khi tắt các sension để flush lại bộ nhớ, mặc định là 60s<br/> <br/> Memcap<br/> <br/> Số luợng bytes của memory set aside, mặc định là 4MB<br/> <br/> Detect_state_problems<br/> <br/> Bật chức năng báo động khi phát hiện điều kiện không bình thường trong các packet phân mảnh, nó nên được bật cho hầu hết các trường hợp<br/> <br/> Min_ttl<br/> <br/> Thiết lập time to live (TTL) tối thiểu đuợc chấp nhận của tiền xử lý, mặc định là 0<br/> <br/> Ttl_limit<br/> <br/> Thiết lập ttl maximum, nó không nên quá lớn ,mặc định là 5<br/> <br/> Thiết lập khuyến cáo nên dùng:<br/> <br/> Preprocessor frag2<br/> <br/> 2.4.3.3 stream4<br/> <br/> stream4 được thiết kế để bảo vệ Snort từ 1 dạng tấn công mới của attacker tới các NIDS sensor bằng cách gửi tràn ngập các packet chứa các chuỗi dữ liệu giống như trong rules để kích các báo động, cũng có khá nhiều tools dùng cho việc này nhưng Snort của có cách chống lại.<br/> <br/> stream4 có 2 nhiệm vụ chính: sateful inspection ( kiểm tra tính nguyên ven ), awareness and session reassembly ( nhận biết và sắp xếp các session )<br/> <br/> Các option của stream4<br/> <br/> Detect_scans<br/> <br/> Mặc định là tắt. nó sẽ báo động khi phát hiện các tools scan ports<br/> <br/> Detect_state_problems<br/> <br/> Mặc định tắt. sẽ báo động khi có vấn đề về tình trạng của cuộc thoại bị phát hiện<br/> <br/> Disable_evasion_alerts<br/> <br/> Cũng mặc định tắt luôn. nếu bật nó có thể phát hiện attacker đang cố gắng từ chối IDS bằng cách gởi các packet đuơc sắp xếp lộn xộn, hoặc các packet là SYN trong data<br/> <br/> Min_ttl<br/> <br/> Thiết lập thời gian sống ít nhất để chấp nhận các packet vào stream4 preprocessor<br/> <br/> Ttl_limit<br/> <br/> Giống như trong phần của frag2<br/> <br/> keepstats [machine, binary]<br/> <br/> Mặc định tắt, nếu bật nó sẽ hiển thị tình trạng các senssion đã theo dõi ở 2 chế độ machine là text file, định dạng binary và dùng tools barnyard để thống nhất<br/> <br/> Noinspect<br/> <br/> Mặc định cũng off. tắt chức năng statefull inspection của tất cả các packets<br/> Ta có thể tham khảo về các tiến trình stateful ở hình này<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136455673_thumb.jpg' border="0"  /></div><br/> <br/> Timeout mặc định là 30s<br/> <br/> log_flushed_streams<br/> <br/> Nếu một packet đang bị theo dõi và là nguyên nhân gây ra báo động, ta có thể dump session này và lưu thông tin từ stream4 vào đĩa cứng<br/> <br/> Memcap<br/> <br/> Giống phần frag2<br/> <br/> Đây là câu lệnh khuyến cáo nên dùng<br/> <br/> preprocessor stream4: detect scans, disable_evasion_alerts, timeout 60, ttl_limit 10<br/> <br/> 2.4.3.4 stream4_reassemble<br/> <br/> Snort phản hồi những chuỗi kí tự nó đọc đuợc trong các gói tin đi qua nếu nó trùng với các kí tự nhận dạng trong signatures. Nếu attacker có thể phân chia các kí tự thành nhiều gói tin để tránh báo động của Snort, stream4_reassemble đóng vài trò sắp xếp lại các traffic giữa 2 hệ thống đàm thoại ( conversation ) của network, gia tăng khả năng match các signatures<br/> <br/> Các conversation network thường là các chương trình dùng bằng command line như Telnet, Ftp, Smtp có thể là các nguyên nhân nội dung của các packet lọt qua được hệ thống. Reassemble các traffic các services này là cần thiết để ngăn chặn các báo động lầm hoặc bỏ sót.<br/> Một kĩ thuật khác của attacker là nhúng các gói tin với các kí tự gây lỗi, reassemble vẫn có thể phát hiện được<br/> <br/> Các option của reassemble<br/> <br/> Clientonly<br/> <br/> Chỉ bật chức năng này trên client<br/> <br/> Serveronly<br/> <br/> Chỉ bật chức năng này trên server<br/> <br/> Both<br/> <br/> Bật trên cả server và client<br/> <br/> Noalerts<br/> <br/> Chế độ báo động vẫn hoạt động nhưng chỉ tắt chức năng reassembly<br/> <br/> Ports [list]<br/> <br/> Chỉ định những ports cụ thể để reassembly<br/> <br/> Câu lệnh khuyên dùng:<br/> <br/> Preprocessor stream4_reassemble: both<br/> <br/> <br/> 2.4.3.5 Tiền xử lý các http inspect <br/> <br/> Có nhiều cách thông tin có thể định dạng sang các http session và cũng có nhiều loại khác nhau biểu diễn các thông tin như là các http session như multimedia, .xml, .HTML, .asp, .php, .java,….và kết quả Snort phải “massage” nội dung của các HTTP conversation để định dạng lại data phục vụ cho quá trình phát hiện tốt nhất<br/> <br/> Có 2 kiểu cấu hình http_inspect là global và server. Global ảnh huởng trực tiếp tới http traffic ,cấu hình Server chứa các phần setting cho 1 máy server và các group servers như vậy, cái này rất thường dùng để cấu hình cho web server dùng apache hoặc IIS<br/> <br/> http_inspect ( global )<br/> <br/> Có 3 option trong phần này dùng để config http traffic:<br/> <br/> iis_unicode_map &lt;filename&gt; [codemap &lt;interger]<br/> <br/> Chỉ đuờng dẫn tới map file unicode.map. Nó sẽ chỉ cho bộ tiền xử lý biết làm cách nào để map các kí tự unicode sang ASCII dạng text đê match các signatures. Ta phải chỉ ra code dể map ví dụ 1252 là latin code<br/> <br/> detect_anomalous_servers<br/> <br/> Sẽ báo động khi gặp các ports lạ không tiêu chuẩn. thường không bật chế độ này<br/> <br/> proxy_alert<br/> <br/> Nếu bạn sử dụng proxy server cho các internet user, bật chức năng này để giám sát các user không dùng proxy để kết nối internet<br/> <br/> Đề nghị setting cho mode này:<br/> <br/> preprocessor http_inspect: global iis_unicode_map unicode.map 1252<br/> <br/> http_inspect_server<br/> <br/> Có thể dùng option này cho servers bất kì hoặc các servers trong môi truờng làm việc của mình. hầu hết các administrator đều dùng 1 server riêng dùng cho IIS và cái khác dùng Apache servers. Trong phần trình bày này sẽ có ví dụ cụ thể.<br/> <br/> Có 2 kiều cấu hình cho http_inspetct_server là “default” và “by IP address”, kiểu “default” chỉ cấu hình cho tất cả web traffic không liên quan gì đến IP address, còn kiểu “IP address” chỉ cấu hình cho các IP đựơc chỉ định hoặc 1 dãy các IP. Có các option là:<br/> <br/> Default hoặc &lt; IP address &gt;<br/> <br/> Như đã trình bày ở trên<br/> <br/> Profile &lt;all | apache | iis &gt;<br/> <br/> Có thể dùng apache hoặc chỉ dùng cho iis ta cũng có thể dùng all cho cả 2. Các bảng sau sẽ trình bày cụ thể của profile khi dùng từng loại <br/> <br/> Bảng setting cho profile "all"<br/> <br/> <br/> Option                                            Setting<br/> <br/> flow_depth                                300<br/> chunk_encoding                            Báo động khi các chunks lớn hơn 500,000 bytes<br/> lis_unicode_map                            Map sử dụng cho mode globle<br/> ascii                                              No<br/> non_refc_char                              On<br/> multi_slash                                  No<br/> directory                                    No<br/> apache_whitespace                  Yes<br/> double_decode                            Yes<br/> j_encode                                  Yes<br/> bare_byte                                Yes<br/> lis_unicode                                  Yes<br/> lis_backslash                                No<br/> lis_delimiter                                  Yes<br/> <br/> <br/> Bảng setting cho profile "apache"<br/> <br/> <br/> Option                                          Setting<br/> <br/> flow_depth                              300<br/> chunk_encoding                          Báo động khi các chunks lớn hơn 500,000 bytes<br/> ascii                                            No<br/> non_rfc_char                            On<br/> multi_slash                              No<br/> directory                                No<br/> apache_whitespace              Yes<br/> <br/> <br/> <br/> Bảng setting cho profile "iis"<br/> <br/> <br/> Option                                          Setting<br/> <br/> flow_depth                              300<br/> lis_unicode_map                          Map sử dụng cho mode globle<br/> ascii                                            No<br/> multi_slash                                No<br/> directory                                  No<br/> double-decode                            Yes<br/> u_encode                              Yes<br/> bare_byte                              Yes<br/> lis_unicode                                Yes<br/> lis_backslash                              No<br/> lis_delimiter                                Yes<br/> apache_whitespace                Yes<br/> <br/> utf_8                                          No<br/> non_strict                                On<br/> <br/> <br/> <br/> Đây là phần cấu hình mặc định cho http_inspect_server:<br/> <br/> Preprocessor http_inspect_server: server default profile all ports {80 8080 }<br/> <br/> Đây là phần cấu hình cho IIS server http_inspect_server :<br/> <br/> Preprocessor http_inspect_server: server 10.10.10.33 profile iis ports { 80 8080 }<br/> <br/> Còn đây là cấu hình điển hình cho Apache server:<br/> <br/> Preprocessor http_inspect_server 10.1.1.125 profile apache ports { 80 8080 }<br/> <br/> <b><font color='violet'>2.4.3.6 rpc_decode</font></b><br/> <br/> RPC’s traffic có thể phân chia ra nhiều packet và mã hoá theo nhiều kiểu khác nhau. Rpc_decode preprocessor sẽ bình thường hoá các traffic này cũng chỉ mục đích giúp nhận diện tốt hơn trong singnatures list. List của các ports mà RPC services đang chạy đuợc cung cấp trong các dòng cấu hình. Ở đây có 4 options cho rpc_decode<br/> <br/> Alert_fragments<br/> <br/> Báo động khi có fragmented RPC traffic<br/> <br/> No_alert_multiple_requests<br/> <br/> Không báo động khi nhiều hơn một RPC request đuợc chứa trong một packet.<br/> <br/> No_alert_large_fragments<br/> <br/> RPC fragments có thể lớn hơn size của các fragment hiện hành. Nếu bạn tìm lỗi xác thực, ta phải dùng chức năng này để disable<br/> <br/> No_alert_incomplete<br/> <br/> RPC messages có thể rất lớn, có khi nó lớn hơn có MTU của mạng nó đang đi qua, nó có thể gây nhiều lỗi cho các RPC network services. Có thể tắt chức năng này để phát hiện lỗi<br/> <br/> Đây là đề nghị config rpc_decode<br/> <br/> Preprocessor rpc_decode: 111 32771 1024<br/> <br/> <br/> 2.4.3.7 bo<br/> <br/> Bo- Back orifice con virust nổi tiếng của các hacker trong các năm qua, dùng để điều khiển từ xa các client bị nhiễm nó, Snort có option để ngăn chặn điều này và phát hiện khá dễ dàng chỉ bằng một dòng lệnh ngắn gọn.<br/> <br/> Preprocessor bo<br/> <br/> 2.4.3.8 telnet_decode<br/> <br/> Dùng chức năng này để bình thuờng hoá các kí tự ,chuổi không tiêu chuẩn , lạ của traffic FTP và telnet cũng đơn giản dùng 1 câu lệnh đơn giản.<br/> <br/> Preprocessor telnet_decode<br/> <br/> 2.4.3.9 flow-portscan<br/> <br/> Flow-portscan thay thế portscan2 nó nhiều chức năng hơn và mạnh hơn. Có 3 components cơ bản cho flow-portscan<br/> <br/> Scoreboards<br/> <br/> Nó phát hiện đuợc 2 loại khác nhau của host , talker và scanner. Talker là tất cả các host đang active trong mạng. còn scanner là host đang connection tới 1 port trên server ở trong mạng<br/> <br/> Uniqueness tracker<br/> <br/> Theo dõi nếu có duy nhất 1 kết nối<br/> <br/> Server statistics tracker<br/> <br/> Sử dụng để theo dõi thời gian của các service trên các server nhằm theo dõi các kết nối<br/> <br/> Để phát hiện các attacker scan port rất khó vì hacker có thể dùng nhiều cách khác nhau: <br/> Sau đây là các option ta có thể dùng để nâng cao hiệu quả của flow-portscan<br/> <br/> <br/> scoreboard-memcap-talker &lt; bytes&gt;<br/> scoreboard-rows-talker &lt; count&gt;<br/> scoreboard-rows-scanner &lt; count&gt;<br/> scoreboard-memcap-scanner &lt; bytes&gt;<br/> scanner-fixed-threshold &lt; integer&gt;<br/> scanner-sliding-threshold &lt; integer&gt;<br/> scanner-fixed-window &lt; integer&gt;<br/> scanner-sliding-window &lt; integer&gt;<br/> scanner-sliding-scale-factor &lt; float&gt;<br/> talker-fixed-threshold &lt; integer&gt;<br/> talker-sliding-threshold &lt; integer&gt;<br/> talker-fixed-window &lt; integer&gt;<br/> talker-sliding-window &lt; integer&gt;<br/> talker-sliding-scale-factor &lt; float&gt;<br/> unique-memcap &lt; bytes&gt;<br/> unique-rows &lt; integer&gt;<br/> server-memcap &lt; bytes&gt;<br/> server-rows &lt; integer&gt;<br/> server-watchnet &lt; ip list in Snort notation&gt;<br/> src-ignore-net &lt; ip list in Snort notation&gt;<br/> dst-ignore-net &lt; ip list in Snort notation&gt;<br/> tcp-penalties &lt;on|off&gt;<br/> server-learning-time &lt; seconds&gt;<br/> server-ignore-limit &lt; hit count&gt;<br/> server-scanner-limit &lt; hit count&gt;<br/> alert-mode &lt;once|all&gt;<br/> output-mode &lt;msg|pktkludge&gt;<br/> base-score &lt; integer&gt;<br/> dumpall &lt;1&gt;<br/> <br/> <br/> <br/> Đây là dòng cấu hình mẫu cho flow-portscan<br/> <br/> preprocessor flow-portscan: server-watchnet [10.10.10.0/24,10.10.20.0/24]<br/> <br/> 2.4.3.10 arpspoof<br/> <br/> Arpspoof được thiết kế cho preprocessor dể detech các hoạt động spoof arp bất hợp pháp trên local nétwork. Các hacker dùng các tools man-in-the-middle attacks như ettercap hoặc arpspoof để nghe trộm giữa các máy trong mạng nội bộ. để cấu hình administrator phải biết địa chỉ MAC của card mạng, điều này thì quá dễ dàng:<br/> <br/> Sau đây là cấu hình đề nghị:<br/> <br/> # preprocessor arpspoof<br/> <br/> # preprocessor arpspoof_detect_host: 192.168.1.1 F0:AB:GH:10:12:53<br/> <br/> <br/> <br/> 2.4.3.11 perfmonitor<br/> <br/> Một trong những khả năng rất hay của Snort là monitor tình trạng hiện tại của hể điều hành các thông số nó thể hiện nêu lên nhiều ý nghĩa mà dựa vào đó ta có thể đoán được nhiều đìều và đưa ra nhiều biện pháp điều chỉnh theo ý muốn, các thông số Snort monitor<br/> <br/> <br/> Packets received <br/> Packets dropped <br/> Percentage of packets dropped <br/> Packets Received  <br/> Kpackets per second <br/> Average bytes per packets <br/> Mbits per second (wire) <br/> Mbits per second (rebuilt) (Mbits trung bình Snort nhúng vào sau khi rebuil các packet) <br/> Mbits per second (total) <br/> Pattern-matching percent (Phần trăm dữ liệu average percent of data received that Snort processes <br/> in pattern matching) <br/> CPU usage (user time, system time, idle time) <br/> Alerts per second <br/> SYN packets per second <br/> SYN/ACK packet per second <br/> New sessions per second <br/> Deleted sessions per second <br/> Total sessions <br/> Max sessions during time interval <br/> Stream flushes per second <br/> Stream faults per second <br/> Stream timeouts <br/> Frag completes per second <br/> Frag inserts per second <br/> Frag deletes per second <br/> Frag flushes per second <br/> Frag timeouts <br/> Frag faults<br/> <br/> <br/> Khi dùng thêm từ “flow” , nó sẽ hiển thị tình trạng các traffic của protocal mà Snort dang soi, dùng “event” Snort sẽ mở chức năng reporting và hiển thị trạng thái số lượng signatures match, dùng từ “max” sẽ kích hoạt Snort hoạt động hết sức để nâng cao hiệu quả, dùng tư “pktcnt” điều chỉnh số lượng packets đang thực thi trước khi check thời gian sample mặc định set là 10,000.<br/> <br/> Ví dụ config và bật chức năng perfmonitor preprocessor:<br/> <br/> Preprocessor perfmonitor : time 30 events flow file stats.profile max console pktcnt 10000<br/> <br/> Preprocessor perfmonitor: time 30 file /var/tmp/Snortstat pktcnt 10000<br/> <br/> <b><font color='violet'>2.4.4 Cấu hình OUTPUT</font></b><br/> <br/> Snort có thể output vào các file log hoặc output ra console, nhiều administrator thích dùng các phần mềm của hãng thứ 3 (third party ) để tăng thêm chức năng giám sát của Snort, các phần mềm data database đều có thể dùng được, lưu ý trước khi cài đặt Snort muốn dùng database nào thì cần chỉ rõ khi cài đặt ví dùng dùng MySQL , khi biên dịch source thêm vào - -mysql <br/> ví dụ: ./configure  - -  mysql<br/> <br/> <br>
			<div align="center" class="limitview"><img src='http://cartoyvn.com/image/SNORT/post-30356-1136530751_thumb.jpg' border="0"  /></div><br/> <br/> 2.4.4.1 alert_syslog<br/> <br/> Output cấu hình theo kiểu<br/> <br/> Output alert_syslog : &lt;facility&gt; &lt;priority&gt;<br/> <br/> Các option sau là một trong nhưng syslog chuẩn và syslog mặc định là <br/> <br/> LOG_AUTH<br/> <br/> LOG_AUTH<br/> LOG_AUTHPRIV<br/> LOG_DAEMON<br/> LOG_LOCAL0<br/> LOG_LOCAL1<br/> LOG_LOCAL2<br/> LOG_LOCAL3<br/> LOG_LOCAL4<br/> LOG_LOCAL5<br/> LOG_LOCAL6<br/> LOG_LOCAL7<br/> LOG_USER<br/> <br/> Các option ưu tiên sau cũng là các syslog ưu tiên chuẩn, mặc định là LOG_ALERT<br/> <br/> LOG_EMERG<br/> LOG_ALERT<br/> LOG_CRIT<br/> LOG_ERR<br/> LOG_WARNING<br/> LOG_NOTICE<br/> LOG_INFO<br/> LOG_DEBUG<br/> <br/> Đây là câu cấu hình mẫu cho alert_syslog<br/> <br/> output alert_syslog: LOG_AUTH LOG_ALERT<br/> <br/> và câu lệnh này dành cho bản windows của Snort nhìn vào cũng dễ hiểu<br/> <br/> output alert_syslog: host=192.168.1.100:80 LOG_AUTH LOG_ALERT<br/> <br/> 2.4.4.2 log_tcpdump<br/> <br/> Log này sẽ định dạng sang dạng log_tcpdump, do có rất nhiều phần mềm có thể đọc được dạng log này, khi log sẽ có timestamp đính vào file name<br/> <br/> ví dụ: câu lệnh cấu hình<br/> <br/> output log_tcpdump /var/log/Snort/tcpdump.out<br/> <br/> 2.4.4.3 database<br/> <br/> Khi log vào database , một khối luơng lớn thông tin của Snort sẽ được lưu trữ như các báo động (alert) , các host liên quan, các packet gây ra báo động, và ta dễ dàng log các báo động thật sự và các báo động lỗi, sai nhanh và nhiều hơn<br/> Đôi khi log vào database cũng quá tải gây ra hiện tượng thắt cổ chai dẫn đến 1 alert chỉ có thể được log trong một thời gian. Và phương pháp cấu hình Snort làm sao hợp lý nhất là các kinh nghiệm của các admin sau này ví dụ có thể dùng tuning hoặc thresholding để tạo hiệu quả hơn.<br/> <br/> Cấu trúc của câu lệnh output ra database<br/> <br/> output database: &lt;log | alert&gt;,&lt;database type&gt;,&lt;parameter list&gt;<br/> <br/> Câu lệnh trên nhìn vào ta có thể hiểu ngay được ý nghĩa của nó, còn &lt;parameter list&gt; bao gồm các phần sau :<br/> <br/> host<br/> <br/> Địa chỉ IP của database server<br/> <br/> port <br/> Port của database đang lắng nghe<br/> <br/> dbname=&lt;database name&gt;<br/> <br/> Loại database ta đang logging<br/> <br/> user<br/> <br/> username Snort sử dụng để log trong database<br/> <br/> password<br/> <br/> Tất nhiên là có user phải có pass để vào rồi<br/> <br/> sensor_name<br/> <br/> Tên của sensor cấu hình, có thể thểm -I trong command line sử dụng IP address thay cho tên <br/> <br/> encoding<br/> <br/> Sử dụng mã hoá để log vào database, ví dụ kiểu hex,base64,ascii và khuyên dùng ascii <br/> <br/> detail<br/> <br/> Có thể chỉ định details level nào log vào database, ví dụ dùng full,fast và full được khuyên dùng nhất<br/> <br/> Với các loại database cụ thể ta phải biên dịch cho đúng khi cài đặt như đã nói phần trước<br/> <br/> CODEMySQL<br/> ./configure - -with-mysql<br/> <br/> POSTGRESQL<br/> ./configure - -with-postresql<br/> <br/> ODBC<br/> ./configure - -with-odbc<br/> <br/> MSSQL<br/> Chỉ dùng cho bản windown, dùng odbc để log vào MSMSQL server<br/> <br/> ORACLE<br/> ./configure - -with-oracle<br/> <br/> và các log khác ta sẽ coi trong phần khuyến cáo của database kèm theo<br/> <br/> 2.4.5 File Inclusion<br/> <br/> Trong file Snort.conf, câu lệnh include chỉ cho Snort đọc các file sau từ include được lưu trong filesystem của Snort sensor, giống như trong lập trình vậy<br/> <br/> ví dụ : <br/> <br/> $ include $RULE_PATH/bad-traffic.rules<br/> $ include $RULE_PATH/exploit.rules<br/> $ include $RULE_PATH/scan.rules<br/> <br/> Các rules trên ta có thể download trên internet, khi down về ta muốn phân nhóm hoặc chỉnh sửa,độ ưu tiên các rules ta có thể cấu hình trong file classification.config, file reference.config gồm các links tới web site với các thông tin cho tất cả các alerts, include nó rất hữu tích , nhanh gọn<br/> ví dụ:<br/> <br/> # include classification & priority settings<br/> <br/> include classification.config<br/> <br/> # include reference systems<br/> <br/> include reference.config<br/> <br/>  channhua - HVA</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - Detecting Intrusions<a name="203641" id="203641"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">20/01/2010 18:42:19 (+0700) | <a href="/hvaonline/posts/list/167.html#203641">#4</a> | 203641 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/155387.html"><b>rongdennt</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 08/12/2007 10:19:36<br>
		Messages: 55<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/155387.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/155387.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Các link hình đều không có. Mong mod edit lại các link hình. Mình đọc bài nhưng không thấy cái hình nào hết.<br/> Cảm ơn</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">Cổ nhân dạy: Vĩ nhân bàn ý tưởng, thường dân bàn sự kiện, tiểu nhân bàn con người.  </span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - Detecting Intrusions<a name="209849" id="209849"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">27/04/2010 00:21:24 (+0700) | <a href="/hvaonline/posts/list/167.html#209849">#5</a> | 209849 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/9dea08176fa590cfec6ce188e697ff88.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/151537.html"><b>tuan1912ha</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 24/10/2007 21:31:40<br>
		Messages: 55<br>
	
		Location: Nhà em <br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/151537.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/151537.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
			<a href="http://edit.yahoo.com/config/send_webmesg?.target=tuan1912ha&amp;.src=pg"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_yim.gif" alt="[Yahoo!]" title="[YIM]"></a>
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Ai có bài này đầy đủ hình ảnh thì cho mình xin với nhé, nhiều đoạn mô tả bằng hình nhưng lại không có nên -&gt; không hiểu. </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - Detecting Intrusions<a name="209947" id="209947"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/04/2010 13:38:12 (+0700) | <a href="/hvaonline/posts/list/167.html#209947">#6</a> | 209947 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/d868798b2ea504bb701c366564937109.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/218555.html"><b>phathuynh26</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 10/04/2010 08:55:38<br>
		Messages: 93<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/218555.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/218555.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Hình ảnh ko thấy là do chính sách bảo mật của diễn đàn?</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">Genius is 1% inspiration and 99% perspiration - Thomas Edison</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - Detecting Intrusions<a name="209969" id="209969"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">28/04/2010 20:28:23 (+0700) | <a href="/hvaonline/posts/list/167.html#209969">#7</a> | 209969 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/3f44f3018ff71ff4a7d22a98f3babb55.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/128502.html"><b>quanta</b></a><br>
	<font color="#FF9900">Moderator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 28/07/2006 14:44:21<br>
		Messages: 7265<br>
	
		Location: $ locate `whoami`<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/128502.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/128502.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><p></p>
		<cite class="blockquote">phathuynh26 wrote:</cite><br>
		<blockquote>Hình ảnh ko thấy là do chính sách bảo mật của diễn đàn?&nbsp;
		</blockquote><br/> Không phải đâu, bạn có thể thử nhấp vào phần "Trích" để biết rằng đường dẫn đến ảnh không còn tồn tại.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall"><font color='orange'>Let's build on a great foundation!</font></span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - Detecting Intrusions<a name="210315" id="210315"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">04/05/2010 22:29:53 (+0700) | <a href="/hvaonline/posts/list/167.html#210315">#8</a> | 210315 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/d868798b2ea504bb701c366564937109.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/218555.html"><b>phathuynh26</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 10/04/2010 08:55:38<br>
		Messages: 93<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/218555.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/218555.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Bạn Mod có thể share tài liệu này không?<br/> <br/> Trích:<br/> Bài viết sử dụng 1 số hình ảnh của omicron trong bài <b>IDS/IDP vs firewall </b></span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">Genius is 1% inspiration and 99% perspiration - Thomas Edison</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#FF3333">[Article]</font></span>&nbsp;&nbsp; Snort - Detecting Intrusions<a name="234548" id="234548"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">03/04/2011 20:49:59 (+0700) | <a href="/hvaonline/posts/list/167.html#234548">#9</a> | 234548 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/184876.html"><b>lee_rae_ri</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 23/11/2008 18:56:08<br>
		Messages: 1<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/184876.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/184876.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Chào bạn MULAN , cám ơn bạn đã dịch rất chi tiết nhưng minh xin hỏi bạn : <br/> 1)Bạn đã thực hiện việc xây dựng hệ thống GIDS/IPS dưới hình thức  snort-inline trên centos 5.5 chưa bạn ?<br/> 2)Nếu bạn đã thực hiện rồi mình mong bạn có thể đưa ra vài ý kiến được không ?</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- quick reply -->
<table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0" align="center">
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left">
			<!-- watch - unwatch -->
			<!-- add bookmark -->

		</td>
		<td align="right" valign="bottom">			
		</td>
	</tr>
</table>

<!-- mod -->

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- combo navigator -->
<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/posts/list/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/posts/list/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/posts/list/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/posts/list/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/posts/list/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/posts/list/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/posts/list/167.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
		<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<span class="gensmall">Go to:&nbsp;</span>
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/forums/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Select a forum</option>				
							<option value="0">-------------</option>
									<option value="2" >Thông báo từ HVA</option>
									<option value="41" >FAQ - Các câu hỏi thường gặp</option>
									<option value="5" >Góp ý và Hỏi đáp thắc mắc chung</option>
									<option value="6" >Kiểm tra bảo mật</option>
							<option value="0">-------------</option>
									<option value="8" selected="selected">Thảo luận bảo mật</option>
									<option value="12" >Thảo luận thâm nhập</option>
									<option value="28" >Thảo luận virus, trojan, spyware, worm...</option>
									<option value="36" >Thủ thuật reverse engineering</option>
									<option value="13" >Thông tin new bugs và exploits</option>
									<option value="51" >Case Studies</option>
							<option value="0">-------------</option>
									<option value="23" >Thảo luận hệ điều hành Windows</option>
									<option value="24" >Thảo luận hệ điều hành *nix</option>
									<option value="26" >Thảo luận các loại thiết bị máy tính</option>
									<option value="31" >Thảo luận mạng và thiết bị mạng</option>
									<option value="27" >Thông tin về các địa chỉ và tài liệu hữu ích</option>
							<option value="0">-------------</option>
									<option value="44" >Người tìm việc - Việc tìm người</option>
									<option value="21" >Thảo luận việc định hướng</option>
									<option value="19" >Những thảo luận khác</option>
									<option value="50" >Hình minh họa</option>
									<option value="33" >Trash</option>
							<option value="0">-------------</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- list users in -->
<table class="forumline" cellspacing="3" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<th class="thright"  nowrap="nowrap" height="26" valign="middle">&nbsp;Users currently in here&nbsp;</th>
	</tr>
		<tr>
			<td class="gensmall" valign="middle" align="left">
				1 Anonymous 
				
			</td>	
		</tr>
</table>
<a name="quick"></a>

<table cellspacing="0" cellpadding="0" width="100%" border="0"  align="center">

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
</table>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/avim.js"></script>
<script type="text/javascript">
<!--
function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}




function maxImg(foto, maxSize){
w = foto.width;
if (w > maxSize){
	foto.width = maxSize;
	}
} 

-->
</script>
