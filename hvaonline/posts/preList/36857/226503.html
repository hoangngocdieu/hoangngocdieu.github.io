<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Chống local attack bằng ModSecurity, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Chống local attack bằng ModSecurity - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="" title="[Logo]">
								<img src="/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<!-- navigator -->
<table cellspacing="2" cellpadding="2" width="100%" border="0" align="center">
	<tr>
		<td valign="baseline" align="left" colspan="0">
			<span class="nav">
			<a class="nav" href="/hvaonline/forums/list.html">Forum Index </a> 
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/forums/show/24.html">Thảo luận hệ điều hành *nix </a>
			<img src="/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/posts/list/36857.html" name="top" id="top">Chống local attack bằng ModSecurity</a>
				&nbsp;<a href="/hvaonline/rss/topicPosts/36857.html"><img src="/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML"></a>
			</span>
		
		</td>

		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- poll show -->

  <!-- POST LISTING -->


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Chống local attack bằng ModSecurity<a name="226503" id="226503"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">06/12/2010 23:13:26 (+0700) | <a href="/hvaonline/posts/list/36857.html#226503">#1</a> | 226503 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/197503.html"><b>CuteFTP</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 25/05/2009 02:07:45<br>
		Messages: 60<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/197503.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/197503.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody"><font color='orange'>Chào các anh chị.<br/> <br/> 1. Em đang nghiên cứu về một số chống tấn công bằng ModSecurity. Không biết đối với kiểu tấn công local attack thì chống kiểu gì? Cơ chế ra sao? Mong mọi người chỉ rỏ.<br/> <br/> 2. Vấn đề về iptables. Em đã gỏ luật sau<br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>iptables -A FORWARD -d 192.168.1.10 -i eth0 -p icmp -m icmp --icmp-type echo-request -m length --length 60:65535 -j ACCEPT
iptables -A FORWARD -s 192.168.1.10 -i eth1 -p icmp -m icmp --icmp-type echo-reply -m length --length 60:65535 -j ACCEPT</pre>
		</div><br/> nhưng gặp vấn đề là khi client ping với tham số -l 32 lại ping bình thường trong khi đó length cho phép là từ 60 đến 65535 byte?<br/> <br/> Em cảm ơn ạ.</font></span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Chống local attack bằng ModSecurity<a name="226507" id="226507"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">07/12/2010 01:28:39 (+0700) | <a href="/hvaonline/posts/list/36857.html#226507">#2</a> | 226507 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">- Tấn công "local" là tấn công cụ thể ra làm sao? Nếu không biết "local" là cái gì thì chống nó là chống cái gì? Trước tiên, bồ cần liệt kê và phân tích ra hết những dạng "local" và tính chất cụ thể của những dạng này. Sau đó mới coi thử mod_security có khả năng nào để ngăn chặn từng loại. Thông thường, nếu bồ dùng shared host thì việc chống "local" là việc của nhà cung cấp dịch vụ bởi vì bồ không có đủ chủ quyền. Nếu nhà dịch vụ không bảo toàn chuyện này thì tìm nhà cung cấp khác. Nếu bồ là người cung cấp dịch vụ thì việc ngăn chặn local không nên sử dụng mod_security mà nên sử dụng các biện pháp "isolation" thật sự (ví dụ, chroot, SuExec cho từng virtualhost, tạo virtual machine cho từng virtual host....).<br/> <br/> - 2 rules ở trên là cho "FORWARD" chớ đâu phải cho "INPUT". Khi nào thì cần thiết lập rule cho "FORWARD" và khi nào thì cần thiết lập rule cho "INPUT"? Bồ muốn thiết lập rule cho ping.... từ đâu? từ bên ngoài vô hay từ bên trong ra? Máy nào dùng để ping tới máy có IP 192.168.1.10 kia có được iptables kiểm soát hay không hay là nó có thể ping thằng tới đích?<br/> <br/>  Nên <b>tìm hiểu căn bản iptables</b> trước khi soạn rule và hiểu rõ cấu trúc mạng mình muốn tạo râ vì lay hoay kiểu này không đi tới đâu hết. </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Chống local attack bằng ModSecurity<a name="226524" id="226524"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">07/12/2010 09:22:55 (+0700) | <a href="/hvaonline/posts/list/36857.html#226524">#3</a> | 226524 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/197503.html"><b>CuteFTP</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 25/05/2009 02:07:45<br>
		Messages: 60<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/197503.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/197503.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Trước tiên cảm ơn anh đã đọc và reply.<br/> <br/> 1. Tấn công local em hỏi trường hợp này là tấn công qua webshell (ví dụ r57, c99) thôi ạ. Việc tích hợp nhiều phần mềm trên một máy chủ sẻ gây tốn tài nguyên. Vì vậy em muốn ModSecurity chống lại cách này luôn. Các tools hổ trợ mạnh và nghiệp vụ khác thì em sẻ tìm hiểu sau. Trước mắt em muốn MS chặn như nào và có mấy kiểu mà thôi <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">.<br/> <br/> 2. Mô hình của em gồm <br/> + 1 máy chủ CentOS làm Server Web (SV)(192.168.1.10).<br/> + 1 máy cũng CentOS làm firewall (dựa vào iptables sẵn có).<br/> <br/> Firewall này là đơn dịch vụ và nó có 1 card tiếp xúc với mạng Internet (eth0: tiếp xúc với External, eth1 tiếp xúc với Internal)<br/> <br/> Mọi truy vấn đến firewall đều bị DROP. Nếu truy vấn ko qua Firewall mà trực tiếp đến SV cũng bị DROP hết.<br/> Firewall chỉ có chức năng là chuyển tiếp và NAT gói tin từ mạng ngoài đi vào và ngược lại mà thôi.<br/> <br/> Vấn đề ở đây em ko hiểu cho dù client ping với length là 32 byte vào SV lại được. Trong khi đó đặt length là từ 60 đến 65535 byte? (thử ping 31 byte lại ko đc :&quot;&gt<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">.<br/> <br/> Chờ ý kiến của anh và mọi người.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Chống local attack bằng ModSecurity<a name="226560" id="226560"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">07/12/2010 14:47:16 (+0700) | <a href="/hvaonline/posts/list/36857.html#226560">#4</a> | 226560 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">CuteFTP wrote:</cite><br>
		<blockquote>Trước tiên cảm ơn anh đã đọc và reply.<br/> <br/> 1. Tấn công local em hỏi trường hợp này là tấn công qua webshell (ví dụ r57, c99) thôi ạ. Việc tích hợp nhiều phần mềm trên một máy chủ sẻ gây tốn tài nguyên. Vì vậy em muốn ModSecurity chống lại cách này luôn. Các tools hổ trợ mạnh và nghiệp vụ khác thì em sẻ tìm hiểu sau. Trước mắt em muốn MS chặn như nào và có mấy kiểu mà thôi <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">.<br/> &nbsp;
		</blockquote><br/> Nguyên tắc bảo mật là <b>phòng</b> hiểm hoạ rồi mới <b>chống</b> hiểm hoạ <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom">. Điều này có nghĩa em nên phòng làm sao không cho phép những thứ như r57, c99 được upload lên máy chủ. Tiếp theo mới đến chuyện chống làm sao cho những thứ như vậy có thể thực thi được.<br/> <br/> <b><font color='orange'>- Phòng:</font></b> Có nhiều cách phòng và nguyên tắc phòng hoàn toàn dựa vô cấu trúc của trang web của em. Cách phòng upload files hữu hiệu nhất có lẽ là chế độ chmod trên file system. Ví dụ, em có file system là: /path/to/myweb/, trong đó myweb chứa forum, modules, includes, images, js chẳng hạn.<br/> <br/> Nếu em không cho phép upload hình lên thì cách hay nhất là <font color='red'>chmod -R ugo-w</font> (chỉ là read-only) cho tất cả mọi người.<br/> <br/> Nếu em cho phép upload hình lên thì em chỉ cho phép account nào đó chạy apache được quyền "w" trong một thư mục là images chẳng hạn thì nên <font color='red'>chmod -R u+w /path/to/myweb/images/</font>. Tất nhiên, phải vào thư mục images đó và <font color='red'>chown &lt;account_chay_apache&gt; .</font><br/> <br/> Ngoài ra, phòng còn có thể siết chặt trên php chẳng hạn như trên httpd.conf của em, em xác định thư mục images kia chỉ chứa các hình ảnh, js chỉ chứa javascripts và php không được quyền execute từ các thư mục ấy, em có thể áp đặt:<br/> <b>&lt;LocationMatch /myweb/(images|js)/&gt;<br/>      RemoveHandler .php<br/>      php_flag engine off<br/>      Options -Includes -Indexes<br/> &lt;/LocationMatch&gt;</b><br/> <br/> Nếu em dùng 1 apache nhưng host nhiều virtual hosts thì nên áp dụng suExec (nên đọc tài liệu trên trang<span class="link"> http://httpd.apache.org</span> để nắm thêm suExec làm cái gì) và mỗi thư mục cho mỗi account chỉ có account đó có quyền rw mà thôi.<br/> <br/> <font color='Orange'><b>- Chống</b></font>:  Có nhiều cách chống nhưng với đề nghị dùng mod_security cụ thể của em thì có hai chuyện có thể làm được.<br/> <br/> <b>1. Áp dụng biện pháp lọc theo tên của các php được phép thực thi:</b><br/> Giả sử trong /path/to/myweb/ có 100 php files và có các tên đặc thù nào đó. Em có thể liệt kê các tên này trong một file okphp.txt có nội dung như:<br/> <br/> a.php<br/> b.php<br/> c.php<br/> .....<br/> <br/> và áp dụng hai mod_security rules như:<br/> <font color='red'>&lt;Location /myweb/&gt;<br/>    SecRule REQUEST_FILENAME "[color=red]!</font>@pmFromFile /path/to/okphp.txt" "t:lowercase,<font color='red'>deny</font>,msg:'UnauthorizedFile'"<br/>    SecRule REQUEST_FILENAME "\.js|\.css|\.gif|\.jpeg|\.jpg|\.png|\.doc|\.pdf|\.txt|\.zip|\.rar" <font color='red'>allow</font><br/> &lt;/Location&gt;[/color]<br/> <br/> Để cản các php không thuộc danh sách cho phép trên và cho phép các .js, .css.... thực thi. Cách này có cái lợi và hại. Em thử suy nghĩ xem nó lợi hại như thế nào? <img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">.<br/> <br/> <b>2. Áp dụng biện pháp cản "RESPONSE":</b><br/> Áp dụng một mod_security luật để cản một response nào đó match một string đặc thù nào đó. Ví dụ:<br/> <br/> <b>SecRule RESPONSE_BODY "Coded-by-Hacker" "<font color='red'>deny</font>,msg:'match_shell'"</b><br/> <br/> String đặc thù đó tuỳ em xét và chọn lựa cho từng loại shell. Con shell nào cũng có một số điểm đặc thù và em nên chọn string nào đặc thù nhất để cho vào luật trên. Khi ai đó "may sao" upload được shell rồi và thực thi thì vẫn có những "response" match với string đặc thù kia thì sẽ bị mod_security cản.<br/> <br/> Anh chỉ đưa ra phương hướng ở đây. Chuyện em cần làm là tìm hiểu các điểm đặc thù và tự thử nghiệm + điều chỉnh.<br/> <br/> <p></p>
		<cite class="blockquote">CuteFTP wrote:</cite><br>
		<blockquote><br/> 2. Mô hình của em gồm <br/> + 1 máy chủ CentOS làm Server Web (SV)(192.168.1.10).<br/> + 1 máy cũng CentOS làm firewall (dựa vào iptables sẵn có).<br/> <br/> Firewall này là đơn dịch vụ và nó có 1 card tiếp xúc với mạng Internet (eth0: tiếp xúc với External, eth1 tiếp xúc với Internal)<br/> <br/> Mọi truy vấn đến firewall đều bị DROP. Nếu truy vấn ko qua Firewall mà trực tiếp đến SV cũng bị DROP hết.<br/> Firewall chỉ có chức năng là chuyển tiếp và NAT gói tin từ mạng ngoài đi vào và ngược lại mà thôi.<br/> <br/> Vấn đề ở đây em ko hiểu cho dù client ping với length là 32 byte vào SV lại được. Trong khi đó đặt length là từ 60 đến 65535 byte? (thử ping 31 byte lại ko đc :&quot;&gt<img src="/hvaonline/images/smilies/068ae40523a24c9ef54edefd375e542d.gif" border="0" alt="smilie" align="absbottom">.<br/> <br/> Chờ ý kiến của anh và mọi người.&nbsp;
		</blockquote><br/> <br/> Nếu vậy thì 2 dòng iptables ở trên dành riêng cho người dùng từ trong LAN ping đến web server 192.168.1.10?  Hai rules này chỉ có tác dụng với người dùng từ trong LAN mà thôi. Em biết lý do tại sao không?<br/> <br/> Hãy thử đổi 2 rules ấy thành:<br/> <b>iptables -A FORWARD -d 192.168.1.10 -i eth0 -p icmp -m icmp --icmp-type echo-request -m length <font color='red'>!</font> --length 60:65535 -j DROP<br/>  iptables -A FORWARD -s 192.168.1.10 -i eth1 -p icmp -m icmp --icmp-type echo-reply -m length <font color='red'>!</font> --length 60:65535 -j DROP</b><br/> <br/> coi thử?</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- quick reply -->
<table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0" align="center">
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left">
			<!-- watch - unwatch -->
			<!-- add bookmark -->

		</td>
		<td align="right" valign="bottom">			
		</td>
	</tr>
</table>

<!-- mod -->

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- combo navigator -->
<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left"><a href="http://digg.com/submit?phrase=2&url=/hvaonline/posts/list/36857.html"><img src="/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=/hvaonline/posts/list/36857.html"><img src="/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=/hvaonline/posts/list/36857.html"><img src="/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=/hvaonline/posts/list/36857.html"><img src="/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=/hvaonline/posts/list/36857.html"><img src="/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=/hvaonline/posts/list/36857.html"><img src="/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=/hvaonline/posts/list/36857.html"><img src="/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
		<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<span class="gensmall">Go to:&nbsp;</span>
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/forums/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Select a forum</option>				
							<option value="0">-------------</option>
									<option value="2" >Thông báo từ HVA</option>
									<option value="41" >FAQ - Các câu hỏi thường gặp</option>
									<option value="5" >Góp ý và Hỏi đáp thắc mắc chung</option>
									<option value="6" >Kiểm tra bảo mật</option>
							<option value="0">-------------</option>
									<option value="8" >Thảo luận bảo mật</option>
									<option value="12" >Thảo luận thâm nhập</option>
									<option value="28" >Thảo luận virus, trojan, spyware, worm...</option>
									<option value="36" >Thủ thuật reverse engineering</option>
									<option value="13" >Thông tin new bugs và exploits</option>
									<option value="51" >Case Studies</option>
							<option value="0">-------------</option>
									<option value="23" >Thảo luận hệ điều hành Windows</option>
									<option value="24" selected="selected">Thảo luận hệ điều hành *nix</option>
									<option value="26" >Thảo luận các loại thiết bị máy tính</option>
									<option value="31" >Thảo luận mạng và thiết bị mạng</option>
									<option value="27" >Thông tin về các địa chỉ và tài liệu hữu ích</option>
							<option value="0">-------------</option>
									<option value="44" >Người tìm việc - Việc tìm người</option>
									<option value="21" >Thảo luận việc định hướng</option>
									<option value="19" >Những thảo luận khác</option>
									<option value="50" >Hình minh họa</option>
									<option value="33" >Trash</option>
							<option value="0">-------------</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- list users in -->
<table class="forumline" cellspacing="3" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<th class="thright"  nowrap="nowrap" height="26" valign="middle">&nbsp;Users currently in here&nbsp;</th>
	</tr>
		<tr>
			<td class="gensmall" valign="middle" align="left">
				1 Anonymous 
				
			</td>	
		</tr>
</table>
<a name="quick"></a>

<table cellspacing="0" cellpadding="0" width="100%" border="0"  align="center">

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.html" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
</table>

<script type="text/javascript" src="/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript" src="/hvaonline/templates/viet/js/avim.js"></script>
<script type="text/javascript">
<!--
function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}




function maxImg(foto, maxSize){
w = foto.width;
if (w > maxSize){
	foto.width = maxSize;
	}
} 

-->
</script>
